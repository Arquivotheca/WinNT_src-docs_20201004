<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtl/lookasid.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>lookasid.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>
<code>#include "<a class="el" href="../../d4/d8/heap_8h-source.html">heap.h</a>"</code><br>
<code>#include "<a class="el" href="../../d0/d9/heappriv_8h-source.html">heappriv.h</a>"</code><br>

<p>
<a href="../../d1/d5/rtl_2lookasid_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a0">MINIMUM_LOOKASIDE_DEPTH</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a1">MINIMUM_ALLOCATION_THRESHOLD</a>&nbsp;&nbsp;&nbsp;25</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a2">RtlpInitializeHeapLookaside</a> (IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a> Lookaside, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Depth)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a3">RtlpDeleteHeapLookaside</a> (IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a4">RtlpAdjustHeapLookasideDepth</a> (IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a5">RtlpAllocateFromHeapLookaside</a> (IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/rtl_2lookasid_8c.html#a6">RtlpFreeToHeapLookaside</a> (IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a> Lookaside, IN PVOID Entry)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="rtl/lookasid.c::MINIMUM_ALLOCATION_THRESHOLD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MINIMUM_ALLOCATION_THRESHOLD&nbsp;&nbsp;&nbsp;25          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00036">36</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="rtl/lookasid.c::MINIMUM_LOOKASIDE_DEPTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MINIMUM_LOOKASIDE_DEPTH&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00030">30</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="rtl/lookasid.c::RtlpAdjustHeapLookasideDepth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpAdjustHeapLookasideDepth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00130">130</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.
<p>
References <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00039">MINIMUM_ALLOCATION_THRESHOLD</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00033">MINIMUM_LOOKASIDE_DEPTH</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/rtl_2heap_8c-source.html#l01316">RtlAllocateHeap()</a>.
<p>
<pre class="fragment"><div>00136                    :
00137 
00138     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called periodically to adjust <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum depth of
00139     a single heap lookaside list.
00140 
00141 Arguments:
00142 
00143     Lookaside - Supplies a pointer to a heap lookaside list structure.
00144 
00145 Return Value:
00146 
00147     None.
00148 
00149 --*/
00150 
00151 {
00152     ULONG Allocates;
00153     ULONG Misses;
00154 
00155     <span class="comment">//</span>
00156     <span class="comment">// Compute the total number of allocations and misses for this scan</span>
00157     <span class="comment">// period.</span>
00158     <span class="comment">//</span>
00159 
00160     Allocates = Lookaside-&gt;TotalAllocates - Lookaside-&gt;LastTotalAllocates;
00161     Lookaside-&gt;LastTotalAllocates = Lookaside-&gt;TotalAllocates;
00162     Misses = Lookaside-&gt;AllocateMisses - Lookaside-&gt;LastAllocateMisses;
00163     Lookaside-&gt;LastAllocateMisses = Lookaside-&gt;AllocateMisses;
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">// Compute target depth of lookaside list.</span>
00167     <span class="comment">//</span>
00168 
00169     {
00170         ULONG Ratio;
00171         ULONG Target;
00172 
00173         <span class="comment">//</span>
00174         <span class="comment">// If the allocate rate is less than the mimimum threshold, then lower</span>
00175         <span class="comment">// the maximum depth of the lookaside list. Otherwise, if the miss rate</span>
00176         <span class="comment">// is less than .5%, then lower the maximum depth. Otherwise, raise the</span>
00177         <span class="comment">// maximum depth based on the miss rate.</span>
00178         <span class="comment">//</span>
00179 
00180         <span class="keywordflow">if</span> (Misses &gt;= Allocates) {
00181             Misses = Allocates;
00182         }
00183 
00184         <span class="keywordflow">if</span> (Allocates == 0) {
00185             Allocates = 1;
00186         }
00187 
00188         Ratio = (Misses * 1000) / Allocates;
00189         Target = Lookaside-&gt;Depth;
00190         <span class="keywordflow">if</span> (Allocates &lt; <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a2">MINIMUM_ALLOCATION_THRESHOLD</a>) {
00191             <span class="keywordflow">if</span> (Target &gt; (<a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a> + 10)) {
00192                 Target -= 10;
00193 
00194             } <span class="keywordflow">else</span> {
00195                 Target = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a>;
00196             }
00197 
00198         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ratio &lt; 5) {
00199             <span class="keywordflow">if</span> (Target &gt; (<a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a> + 1)) {
00200                 Target -= 1;
00201 
00202             } <span class="keywordflow">else</span> {
00203                 Target = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a>;
00204             }
00205 
00206         } <span class="keywordflow">else</span> {
00207             Target += ((Ratio * Lookaside-&gt;MaximumDepth) / (1000 * 2)) + 5;
00208             <span class="keywordflow">if</span> (Target &gt; Lookaside-&gt;MaximumDepth) {
00209                 Target = Lookaside-&gt;MaximumDepth;
00210             }
00211         }
00212 
00213         Lookaside-&gt;Depth = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)Target;
00214     }
00215 
00216     <span class="keywordflow">return</span>;
00217 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="rtl/lookasid.c::RtlpAllocateFromHeapLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlpAllocateFromHeapLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00222">222</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d9/ntrtlp_8h.html#a46">RtlpInterlockedPopEntrySList()</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/rtl_2heap_8c-source.html#l01316">RtlAllocateHeap()</a>, <a class="el" href="../../d6/d8/heapdll_8c-source.html#l02530">RtlValidateHeap()</a>, and <a class="el" href="../../d6/d8/heapdll_8c-source.html#l03714">RtlWalkHeap()</a>.
<p>
<pre class="fragment"><div>00228                    :
00229 
00230     This function removes (pops) the first entry from the specified
00231     heap lookaside list.
00232 
00233 Arguments:
00234 
00235     Lookaside - Supplies a pointer to a paged lookaside list structure.
00236 
00237 Return Value:
00238 
00239     If an entry is removed from the specified lookaside list, then the
00240     address of the entry is returned as the function value. Otherwise,
00241     NULL is returned.
00242 
00243 --*/
00244 
00245 {
00246 
00247     PVOID Entry;
00248 
00249     Lookaside-&gt;TotalAllocates += 1;
00250 
00251     <span class="comment">//</span>
00252     <span class="comment">//  We need to protect ourselves from a second thread that can cause us</span>
00253     <span class="comment">//  to fault on the pop. If we do fault then we'll just do a regular pop</span>
00254     <span class="comment">//  operation</span>
00255     <span class="comment">//</span>
00256 
00257 <span class="preprocessor">#if defined(_X86_)</span>
00258 <span class="preprocessor"></span>
00259     <span class="keywordflow">if</span> (USER_SHARED_DATA-&gt;ProcessorFeatures[PF_COMPARE_EXCHANGE_DOUBLE]) {
00260 
00261 <span class="preprocessor">#endif // defined(_X86_)</span>
00262 <span class="preprocessor"></span>
00263         <span class="keywordflow">try</span> {
00264 
00265             Entry = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a46">RtlpInterlockedPopEntrySList</a>(&amp;Lookaside-&gt;ListHead);
00266 
00267         } except (EXCEPTION_EXECUTE_HANDLER) {
00268 
00269             Entry = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00270         }
00271 
00272         <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00273 
00274             <span class="keywordflow">return</span> Entry;
00275         }
00276 <span class="preprocessor">#if defined(_X86_)</span>
00277 <span class="preprocessor"></span>
00278     }
00279 
00280 <span class="preprocessor">#endif // defined(_X86_)</span>
00281 <span class="preprocessor"></span>
00282     Lookaside-&gt;AllocateMisses += 1;
00283     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00284 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="rtl/lookasid.c::RtlpDeleteHeapLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpDeleteHeapLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00101">101</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.
<p>
<pre class="fragment"><div>00107                    :
00108 
00109     This function frees any entries specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lookaside structure.
00110 
00111 Arguments:
00112 
00113     Lookaside - Supplies a pointer to a heap lookaside list structure.
00114 
00115 Return Value:
00116 
00117     None.
00118 
00119 --*/
00120 
00121 {
00122 
00123     PVOID Entry;
00124 
00125     <span class="keywordflow">return</span>;
00126 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="rtl/lookasid.c::RtlpFreeToHeapLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlpFreeToHeapLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00288">288</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d9/ntrtlp_8h.html#a47">RtlpInterlockedPushEntrySList()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00431">RtlpQueryDepthSList</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/rtl_2heap_8c-source.html#l02931">RtlFreeHeap()</a>.
<p>
<pre class="fragment"><div>00295                    :
00296 
00297     This function inserts (pushes) the specified entry into the specified
00298     paged lookaside list.
00299 
00300 Arguments:
00301 
00302     Lookaside - Supplies a pointer to a paged lookaside list structure.
00303 
00304     Entry - Supples a pointer to the entry that is inserted in the
00305         lookaside list.
00306 
00307 Return Value:
00308 
00309     BOOLEAN - TRUE if the entry was put on the lookaside list and FALSE
00310         otherwise.
00311 
00312 --*/
00313 
00314 {
00315     Lookaside-&gt;TotalFrees += 1;
00316 
00317 <span class="preprocessor">#if defined(_X86_)</span>
00318 <span class="preprocessor"></span>
00319     <span class="keywordflow">if</span> (USER_SHARED_DATA-&gt;ProcessorFeatures[PF_COMPARE_EXCHANGE_DOUBLE]) {
00320 
00321 <span class="preprocessor">#endif // defined(_X86_)</span>
00322 <span class="preprocessor"></span>
00323         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a14">RtlpQueryDepthSList</a>(&amp;Lookaside-&gt;ListHead) &lt; Lookaside-&gt;Depth) {
00324 
00325             <span class="comment">//</span>
00326             <span class="comment">//  We need to protect ourselves from a second thread that can</span>
00327             <span class="comment">//  cause us to fault on the push.  If we do fault then we'll</span>
00328             <span class="comment">//  just do a regular free operation</span>
00329             <span class="comment">//</span>
00330 
00331             <span class="keywordflow">try</span> {
00332 
00333                 <a class="code" href="../../d5/d9/ntrtlp_8h.html#a47">RtlpInterlockedPushEntrySList</a>(&amp;Lookaside-&gt;ListHead,
00334                                               (PSINGLE_LIST_ENTRY)Entry);
00335 
00336             } except (EXCEPTION_EXECUTE_HANDLER) {
00337 
00338                 Lookaside-&gt;FreeMisses += 1;
00339 
00340                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00341             }
00342 
00343             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00344         }
00345 
00346 <span class="preprocessor">#if defined(_X86_)</span>
00347 <span class="preprocessor"></span>
00348     }
00349 
00350 <span class="preprocessor">#endif // defined(_X86_)</span>
00351 <span class="preprocessor"></span>
00352     Lookaside-&gt;FreeMisses += 1;
00353 
00354     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00355 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="rtl/lookasid.c::RtlpInitializeHeapLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpInitializeHeapLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d6/struct__HEAP__LOOKASIDE.html">PHEAP_LOOKASIDE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Depth</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html#l00045">45</a> of file <a class="el" href="../../d1/d5/rtl_2lookasid_8c-source.html">rtl/lookasid.c</a>.
<p>
References <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00033">MINIMUM_LOOKASIDE_DEPTH</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00405">RtlpInitializeSListHead</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/rtl_2heap_8c-source.html#l00191">RtlCreateHeap()</a>.
<p>
<pre class="fragment"><div>00052                    :
00053 
00054     This function initializes a heap lookaside list structure
00055 
00056 Arguments:
00057 
00058     Lookaside - Supplies a pointer to a heap lookaside list structure.
00059 
00060     Allocate - Supplies a pointer to an allocate function.
00061 
00062     Free - Supplies a pointer to a free function.
00063 
00064     <a class="code" href="../../d4/d6/memory_8c.html#a15">HeapHandle</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> heap that backs <span class="keyword">this</span> lookaside list
00065 
00066     Flags - Supplies a set of heap flags.
00067 
00068     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lookaside list entries.
00069 
00070     Depth - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum depth of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lookaside list.
00071 
00072 Return Value:
00073 
00074     None.
00075 
00076 --*/
00077 
00078 {
00079 
00080     <span class="comment">//</span>
00081     <span class="comment">// Initialize the lookaside list structure.</span>
00082     <span class="comment">//</span>
00083 
00084     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a13">RtlpInitializeSListHead</a>(&amp;Lookaside-&gt;ListHead);
00085 
00086     Lookaside-&gt;Depth = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a>;
00087     Lookaside-&gt;MaximumDepth = 256; <span class="comment">//Depth;</span>
00088     Lookaside-&gt;TotalAllocates = 0;
00089     Lookaside-&gt;AllocateMisses = 0;
00090     Lookaside-&gt;TotalFrees = 0;
00091     Lookaside-&gt;FreeMisses = 0;
00092 
00093     Lookaside-&gt;LastTotalAllocates = 0;
00094     Lookaside-&gt;LastAllocateMisses = 0;
00095 
00096     <span class="keywordflow">return</span>;
00097 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:33 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
