<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: pnpiop.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>pnpiop.h</h1><a href="../../d9/d0/pnpiop_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1995  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    pnpsubs.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the plug-and-play macros and constants.</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Shie-Lin Tzong (shielint) 29-Jan-1995</span>
00016 <span class="comment">    Andrew Thornton (andrewth) 5-Sept-1996</span>
00017 <span class="comment"></span>
00018 <span class="comment">Environment:</span>
00019 <span class="comment"></span>
00020 <span class="comment">    Kernel mode</span>
00021 <span class="comment"></span>
00022 <span class="comment"></span>
00023 <span class="comment">Revision History:</span>
00024 <span class="comment"></span>
00025 <span class="comment"></span>
00026 <span class="comment">--*/</span>
00027 
00028 <span class="preprocessor">#include "..\pnp\pnpi.h"</span>
00029 <span class="preprocessor">#include "<a class="code" href="../../d9/d8/arbiter_8h.html">arbiter.h</a>"</span>
00030 <span class="preprocessor">#include "dockintf.h"</span>
00031 <span class="preprocessor">#include "<a class="code" href="../../d7/d1/pnprlist_8h.html">pnprlist.h</a>"</span>
00032 
00033 <span class="comment">//</span>
00034 <span class="comment">// Pool tags</span>
00035 <span class="comment">//</span>
00036 
<a name="l00037"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a0">00037</a> <span class="preprocessor">#define IOP_DNOD_TAG    'donD'</span>
<a name="l00038"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a1">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_DNDT_TAG    'tdnD'</span>
<a name="l00039"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a2">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_DPWR_TAG    'rwPD'</span>
00040 <span class="preprocessor"></span>
00041 <span class="comment">//</span>
00042 <span class="comment">// Dbg scope</span>
00043 <span class="comment">//</span>
00044 
<a name="l00045"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a3">00045</a> <span class="preprocessor">#define DBG_SCOPE 1     // Enable SOME DBG stuff on ALL builds</span>
00046 <span class="preprocessor"></span><span class="comment">//#define DBG_SCOPE DBG // Enable only on DBG build</span>
00047 
00048 <span class="comment">//</span>
00049 <span class="comment">// The DEVICE_NODE is really just some extra stuff that we'd like to keep around</span>
00050 <span class="comment">// for each physical device object.</span>
00051 <span class="comment">// It is seperated from DEVOBJ_EXTENSION because these fields only apply to</span>
00052 <span class="comment">// PDO.</span>
00053 <span class="comment">//</span>
00054 
<a name="l00055"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a387">00055</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00056 
00057     <a class="code" href="../../d9/d0/pnpiop_8h.html#a387a203">DOCK_NOTDOCKDEVICE</a>,
00058     <a class="code" href="../../d9/d0/pnpiop_8h.html#a387a204">DOCK_QUIESCENT</a>,
00059     <a class="code" href="../../d9/d0/pnpiop_8h.html#a387a205">DOCK_ARRIVING</a>,
00060     <a class="code" href="../../d9/d0/pnpiop_8h.html#a387a206">DOCK_DEPARTING</a>,
00061     <a class="code" href="../../d9/d0/pnpiop_8h.html#a387a207">DOCK_EJECTIRP_COMPLETED</a>
00062 
00063 } <a class="code" href="../../d9/d0/pnpiop_8h.html#a387">PROFILE_STATUS</a>;
00064 
<a name="l00065"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a388">00065</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00066 
00067     <a class="code" href="../../d9/d0/pnpiop_8h.html#a388a208">PROFILE_IN_PNPEVENT</a>,
00068     <a class="code" href="../../d9/d0/pnpiop_8h.html#a388a209">PROFILE_NOT_IN_PNPEVENT</a>,
00069     <a class="code" href="../../d9/d0/pnpiop_8h.html#a388a210">PROFILE_PERHAPS_IN_PNPEVENT</a>
00070 
00071 } <a class="code" href="../../d9/d0/pnpiop_8h.html#a388">PROFILE_NOTIFICATION_TIME</a>;
00072 
<a name="l00073"></a><a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html">00073</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html">_PENDING_SET_INTERFACE_STATE</a>
00074 {
<a name="l00075"></a><a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html#o0">00075</a>     LIST_ENTRY      <a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html#o0">List</a>;
<a name="l00076"></a><a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html#o1">00076</a>     UNICODE_STRING  <a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html#o1">LinkName</a>;
00077 } <a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html">PENDING_SET_INTERFACE_STATE</a>, *<a class="code" href="../../d9/d4/struct__PENDING__SET__INTERFACE__STATE.html">PPENDING_SET_INTERFACE_STATE</a>;
00078 
00079 
<a name="l00080"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a389">00080</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a389">_UNLOCK_UNLINK_ACTION</a> {
00081     <a class="code" href="../../d9/d0/pnpiop_8h.html#a389a211">UnlinkRemovedDeviceNodes</a>,
00082     <a class="code" href="../../d9/d0/pnpiop_8h.html#a389a212">UnlinkAllDeviceNodesPendingClose</a>,
00083     <a class="code" href="../../d9/d0/pnpiop_8h.html#a389a213">UnlinkOnlyChildDeviceNodesPendingClose</a>
00084 }   <a class="code" href="../../d9/d0/pnpiop_8h.html#a114">UNLOCK_UNLINK_ACTION</a>, *<a class="code" href="../../d9/d0/pnpiop_8h.html#a115">PUNLOCK_UNLINK_ACTION</a>;
00085 
<a name="l00086"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a116">00086</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">_DEVICE_NODE</a> *<a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>;
<a name="l00087"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">00087</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">_DEVICE_NODE</a> {
00088 
00089     <span class="comment">//</span>
00090     <span class="comment">// Pointer to another DEVICE_NODE with the same parent as this one.</span>
00091     <span class="comment">//</span>
00092 
<a name="l00093"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o0">00093</a>     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o0">Sibling</a>;
00094 
00095     <span class="comment">//</span>
00096     <span class="comment">// Pointer to the first child of this DEVICE_NODE.</span>
00097     <span class="comment">//</span>
00098 
<a name="l00099"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o1">00099</a>     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o1">Child</a>;
00100 
00101     <span class="comment">//</span>
00102     <span class="comment">// Pointer to this DEVICE_NODE's parent.</span>
00103     <span class="comment">//</span>
00104 
<a name="l00105"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o2">00105</a>     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o2">Parent</a>;
00106 
00107     <span class="comment">//</span>
00108     <span class="comment">// Pointer to the last child of the device node</span>
00109     <span class="comment">//</span>
00110 
<a name="l00111"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o3">00111</a>     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o3">LastChild</a>;
00112 
00113     <span class="comment">//</span>
00114     <span class="comment">// Depth of DEVICE_NODE in the tree, root is 0</span>
00115     <span class="comment">//</span>
00116 
<a name="l00117"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o4">00117</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o4">Level</a>;
00118 
00119     <span class="comment">//</span>
00120     <span class="comment">// Power notification order list entry for this device node</span>
00121     <span class="comment">//</span>
00122 
<a name="l00123"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o5">00123</a>     <a class="code" href="../../d7/d7/struct__PO__DEVICE__NOTIFY.html">PPO_DEVICE_NOTIFY</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o5">Notify</a>;
00124 
00125     <span class="comment">//</span>
00126     <span class="comment">// General flags.</span>
00127     <span class="comment">//</span>
00128 
<a name="l00129"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o6">00129</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o6">Flags</a>;
00130 
00131     <span class="comment">//</span>
00132     <span class="comment">// Flags used by user-mode for volatile state which should go away on a</span>
00133     <span class="comment">// reboot or when the device is removed.</span>
00134     <span class="comment">//</span>
00135 
<a name="l00136"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o7">00136</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o7">UserFlags</a>;
00137 
00138     <span class="comment">//</span>
00139     <span class="comment">// Problem.  This is set if DNF_HAS_PROBLEM is set in Flags.  Indicates</span>
00140     <span class="comment">// which problem exists and uses the same values as the config manager</span>
00141     <span class="comment">// CM_PROB_*</span>
00142     <span class="comment">//</span>
00143 
<a name="l00144"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o8">00144</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o8">Problem</a>;
00145 
00146     <span class="comment">//</span>
00147     <span class="comment">// Pointer to the physical device object that this DEVICE_NODE is associated</span>
00148     <span class="comment">// with.</span>
00149     <span class="comment">//</span>
00150 
<a name="l00151"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o9">00151</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o9">PhysicalDeviceObject</a>;
00152 
00153     <span class="comment">//</span>
00154     <span class="comment">// Pointer to the list of resources assigned to the PhysicalDeviceObject.</span>
00155     <span class="comment">// This is the Resource list which is passed to driver's start routine.</span>
00156     <span class="comment">// Note, PDO contains ListOfAssignedResources which described the resources</span>
00157     <span class="comment">// owned by the PDO. But, it is not in the format we will pass to driver or</span>
00158     <span class="comment">// write to registry.</span>
00159     <span class="comment">//</span>
00160 
<a name="l00161"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o10">00161</a>     PCM_RESOURCE_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o10">ResourceList</a>;
00162 
<a name="l00163"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o11">00163</a>     PCM_RESOURCE_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o11">ResourceListTranslated</a>;
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">// EnumerationMutex ensures that a given DEVICE_NODE doesn't get enumerated</span>
00167     <span class="comment">// on multiple threads at the same time.</span>
00168     <span class="comment">//</span>
00169 
<a name="l00170"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o12">00170</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o12">EnumerationMutex</a>;
00171 
00172     <span class="comment">//</span>
00173     <span class="comment">// InstancePath is the path of the instance node in the registry,</span>
00174     <span class="comment">// i.e. &lt;EnumBus&gt;&lt;DeviceId&gt;&lt;uniqueid&gt;</span>
00175     <span class="comment">//</span>
00176 
<a name="l00177"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o13">00177</a>     UNICODE_STRING <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o13">InstancePath</a>;
00178 
00179     <span class="comment">//</span>
00180     <span class="comment">// ServiceName is the name of the driver who controls the device. (Not the</span>
00181     <span class="comment">// driver who enumerates/creates the PDO.)  This field is mainly for</span>
00182     <span class="comment">// convenience.</span>
00183     <span class="comment">//</span>
00184 
<a name="l00185"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o14">00185</a>     UNICODE_STRING <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o14">ServiceName</a>;
00186 
00187     <span class="comment">//</span>
00188     <span class="comment">// DuplicatePDO - if the flags have DNF_DUPLICATE set then this fields indicates</span>
00189     <span class="comment">// the duplicate PDO which is enumerated by a bus driver.  N.B. It is possible</span>
00190     <span class="comment">// that DNF_DUPLICATE is set but this field is NULL.  In this case, it means that</span>
00191     <span class="comment">// we know the device is a duplicate of another device and we have not enumerated</span>
00192     <span class="comment">// the DuplicatePDO yet.</span>
00193     <span class="comment">//</span>
00194 
<a name="l00195"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o15">00195</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o15">DuplicatePDO</a>;
00196 
00197     <span class="comment">//</span>
00198     <span class="comment">// ResourceRequirements</span>
00199     <span class="comment">//</span>
00200 
<a name="l00201"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o16">00201</a>     PIO_RESOURCE_REQUIREMENTS_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o16">ResourceRequirements</a>;
00202 
00203     <span class="comment">//</span>
00204     <span class="comment">// Information queried from the LEGACY_BUS_INFORMATION irp.</span>
00205     <span class="comment">//</span>
00206 
<a name="l00207"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o17">00207</a>     INTERFACE_TYPE <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o17">InterfaceType</a>;
<a name="l00208"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o18">00208</a>     ULONG <a class="code" href="../../d2/d7/hal_8h.html#a75">BusNumber</a>;
00209 
00210     <span class="comment">//</span>
00211     <span class="comment">// Information queried from the BUS_INFORMATION irp.</span>
00212     <span class="comment">//</span>
00213 
<a name="l00214"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o19">00214</a>     INTERFACE_TYPE <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o19">ChildInterfaceType</a>;
<a name="l00215"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o20">00215</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o20">ChildBusNumber</a>;
<a name="l00216"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o21">00216</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o21">ChildBusTypeIndex</a>;
00217 
00218     <span class="comment">//</span>
00219     <span class="comment">// Information queried from the PNP_BUS_INFORMATION irp. The BusTypeIndex</span>
00220     <span class="comment">// value is actually an index into a global table of known bus type guids.</span>
00221     <span class="comment">//</span>
00222 
<a name="l00223"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o22">00223</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o22">Reserved</a>;        <span class="comment">// padding, someone else can use this field</span>
00224 
00225     <span class="comment">//</span>
00226     <span class="comment">// Linked list of entries that represent each driver that has registered</span>
00227     <span class="comment">// for notification on this devnode. Note: drivers (and user-mode) actually</span>
00228     <span class="comment">// register based on a FILE_OBJECT handle, which is translated into a PDO</span>
00229     <span class="comment">// by sending an IRP_MN_QUERY_DEVICE_RELATIONS for TargetDeviceRelation.</span>
00230     <span class="comment">//</span>
00231 
<a name="l00232"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o23">00232</a>     LIST_ENTRY <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o23">TargetDeviceNotify</a>;
00233 
00234     <span class="comment">//</span>
00235     <span class="comment">// DeviceArbiterList - A list of arbiters registered for this physical device object</span>
00236     <span class="comment">// Note: The Arbiters must be dereferenced when the device node is going away.</span>
00237     <span class="comment">//</span>
00238 
<a name="l00239"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o24">00239</a>     LIST_ENTRY <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o24">DeviceArbiterList</a>;
00240 
00241     <span class="comment">//</span>
00242     <span class="comment">// DeviceTranslatorList - A list of translator for this physical device object</span>
00243     <span class="comment">// NOTE: the Translator must be dereferenced when the devic node is going away.</span>
00244     <span class="comment">//</span>
00245 
<a name="l00246"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o25">00246</a>     LIST_ENTRY <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o25">DeviceTranslatorList</a>;
00247 
00248     <span class="comment">//</span>
00249     <span class="comment">// NoTranslatorMask - the bit position corresponds to resource type</span>
00250     <span class="comment">//   if bit is set, there is no translator for the resource type in this devnode</span>
00251     <span class="comment">//</span>
00252 
<a name="l00253"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o26">00253</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o26">NoTranslatorMask</a>;
00254 
00255     <span class="comment">//</span>
00256     <span class="comment">// QueryTranslatorMask - The bit position corresponds to resource type.</span>
00257     <span class="comment">//   if bit is set, the translator for the resource type is queried.</span>
00258     <span class="comment">//</span>
00259 
<a name="l00260"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o27">00260</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o27">QueryTranslatorMask</a>;
00261 
00262     <span class="comment">//</span>
00263     <span class="comment">// NoArbiterMask - the bit position corresponds to resource type</span>
00264     <span class="comment">//   if bit is set, there is no arbiter for the resource type in this devnode</span>
00265     <span class="comment">//</span>
00266 
<a name="l00267"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o28">00267</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o28">NoArbiterMask</a>;
00268 
00269     <span class="comment">//</span>
00270     <span class="comment">// QueryArbiterMask - The bit position corresponds to resource type.</span>
00271     <span class="comment">//   if bit is set, the arbiter for the resource type is queried.</span>
00272     <span class="comment">//</span>
00273 
<a name="l00274"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o29">00274</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o29">QueryArbiterMask</a>;
00275 
00276     <span class="comment">//</span>
00277     <span class="comment">// The following fields are used to track  legacy resource allocation</span>
00278     <span class="comment">// LegacyDeviceNode - The real legacy device node.</span>
00279     <span class="comment">// NextResourceDeviceNode - link all the made-up device nodes which own part of</span>
00280     <span class="comment">//   the resources from LegacyDeviceNode.</span>
00281     <span class="comment">//</span>
00282 
00283     <span class="keyword">union </span>{
<a name="l00284"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o30">00284</a>         <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o30">LegacyDeviceNode</a>;
<a name="l00285"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o31">00285</a>         <a class="code" href="../../d0/d5/struct__DEVICE__RELATIONS.html">PDEVICE_RELATIONS</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o31">PendingDeviceRelations</a>;
00286     } OverUsed1;
00287 
00288     <span class="keyword">union </span>{
<a name="l00289"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o33">00289</a>         <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o33">NextResourceDeviceNode</a>;
00290     } OverUsed2;
00291 
00292     <span class="comment">//</span>
00293     <span class="comment">// Remember the BootResources for the device</span>
00294     <span class="comment">//</span>
00295 
<a name="l00296"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o35">00296</a>     PCM_RESOURCE_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o35">BootResources</a>;
00297 
00298     <span class="comment">//</span>
00299     <span class="comment">// Lock Count used to keep track of multiple ejects</span>
00300     <span class="comment">//</span>
<a name="l00301"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o36">00301</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o36">LockCount</a>;
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">// If this devnode has been QueryRemoved but the original target of the</span>
00305     <span class="comment">// QueryRemove is still physically present then this will point to the</span>
00306     <span class="comment">// relation list used to process the original QueryRemove.</span>
00307     <span class="comment">//</span>
<a name="l00308"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o37">00308</a>     <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o37">RelationList</a>;
00309 
00310     <span class="comment">//</span>
00311     <span class="comment">// When Capabilities have been queried for a device (twice, once before</span>
00312     <span class="comment">// start and once after start) the flags are stored here in the same format</span>
00313     <span class="comment">// as the query capabilities IRP - use IopDeviceNodeFlagsToCapabilities to</span>
00314     <span class="comment">// access.</span>
00315     <span class="comment">//</span>
<a name="l00316"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o38">00316</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o38">CapabilityFlags</a>;
00317 
00318     <span class="comment">//</span>
00319     <span class="comment">// Maintain a list of current dock devices and their SerialNumbers</span>
00320     <span class="comment">//</span>
00321     <span class="keyword">struct </span>{
<a name="l00322"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o39">00322</a>         <a class="code" href="../../d9/d0/pnpiop_8h.html#a387">PROFILE_STATUS</a>  <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o39">DockStatus</a>;
<a name="l00323"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o40">00323</a>         LIST_ENTRY      <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o40">ListEntry</a>;
<a name="l00324"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o41">00324</a>         PWCHAR          <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o41">SerialNumber</a>;
00325     } DockInfo;
00326 
00327     <span class="comment">//</span>
00328     <span class="comment">// Maintain a count to determine if either ourselves or any of</span>
00329     <span class="comment">// our children are stopping us from being disableable</span>
00330     <span class="comment">// count = myself (DNUF_NOT_DISABLEABLE) + 1 for each immediate</span>
00331     <span class="comment">// child that has DisableableDepends &gt; 0</span>
00332     <span class="comment">//</span>
<a name="l00333"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o43">00333</a>     ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o43">DisableableDepends</a>;
00334 
00335     <span class="comment">//</span>
00336     <span class="comment">// List of pended IoSetDeviceInterfaceState calls.</span>
00337     <span class="comment">// IoSetDeviceInterfaceState adds an entry to this list whenever it is</span>
00338     <span class="comment">// called and we haven't been started yet.  Once we do the start we'll</span>
00339     <span class="comment">// run down the list.</span>
00340     <span class="comment">//</span>
<a name="l00341"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o44">00341</a>     LIST_ENTRY <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o44">PendedSetInterfaceState</a>;
00342 
00343 <span class="preprocessor">#if DBG_SCOPE</span>
<a name="l00344"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o45">00344</a> <span class="preprocessor"></span>    ULONG <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o45">FailureStatus</a>;
<a name="l00345"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o46">00345</a>     PCM_RESOURCE_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o46">PreviousResourceList</a>;
<a name="l00346"></a><a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o47">00346</a>     PIO_RESOURCE_REQUIREMENTS_LIST <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html#o47">PreviousResourceRequirements</a>;
00347 <span class="preprocessor">#endif</span>
00348 <span class="preprocessor"></span>
00349 } <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">DEVICE_NODE</a>;
00350 
00351 
00352 <span class="comment">//</span>
00353 <span class="comment">// A device Object is a PDO iff it has a non NULL device node (aka set by</span>
00354 <span class="comment">// plug and play during a query device relations.</span>
00355 <span class="comment">//</span>
00356 
<a name="l00357"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a4">00357</a> <span class="preprocessor">#define ASSERT_PDO(d) \</span>
00358 <span class="preprocessor">    do { \</span>
00359 <span class="preprocessor">        if (    NULL == (d)-&gt;DeviceObjectExtension-&gt;DeviceNode || \</span>
00360 <span class="preprocessor">                (((PDEVICE_NODE)(d)-&gt;DeviceObjectExtension-&gt;DeviceNode)-&gt;Flags &amp; DNF_LEGACY_RESOURCE_DEVICENODE))  { \</span>
00361 <span class="preprocessor">            KeBugCheckEx(PNP_DETECTED_FATAL_ERROR, PNP_ERR_INVALID_PDO, (ULONG_PTR)d, 0, 0); \</span>
00362 <span class="preprocessor">        } \</span>
00363 <span class="preprocessor">    } \</span>
00364 <span class="preprocessor">    while (0)</span>
00365 <span class="preprocessor"></span>
00366 <span class="comment">//</span>
00367 <span class="comment">// DNF_MAKEUP - this devnode's device is created and owned by PnP manager</span>
00368 <span class="comment">//</span>
00369 
<a name="l00370"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a5">00370</a> <span class="preprocessor">#define DNF_MADEUP                                  0x00000001</span>
00371 <span class="preprocessor"></span>
00372 <span class="comment">//</span>
00373 <span class="comment">// DNF_DUPLICATE - this devnode's device is a duplicate of another enumerate PDO</span>
00374 <span class="comment">//</span>
00375 
<a name="l00376"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a6">00376</a> <span class="preprocessor">#define DNF_DUPLICATE                               0x00000002</span>
00377 <span class="preprocessor"></span>
00378 <span class="comment">//</span>
00379 <span class="comment">// DNF_HAL_NODE - a flag to indicate which device node is the root node created by</span>
00380 <span class="comment">// the hal</span>
00381 <span class="comment">//</span>
00382 
<a name="l00383"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a7">00383</a> <span class="preprocessor">#define DNF_HAL_NODE                                0x00000004</span>
00384 <span class="preprocessor"></span>
00385 <span class="comment">//</span>
00386 <span class="comment">// DNF_PROCESSED - indicates if the registry instance key of the device node</span>
00387 <span class="comment">//                 was created.</span>
00388 <span class="comment">//</span>
00389 
<a name="l00390"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a8">00390</a> <span class="preprocessor">#define DNF_PROCESSED                               0x00000008</span>
00391 <span class="preprocessor"></span>
00392 <span class="comment">//</span>
00393 <span class="comment">// DNF_ENUMERATED - used to track enumeration in IopEnumerateDevice()</span>
00394 <span class="comment">//</span>
00395 
<a name="l00396"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a9">00396</a> <span class="preprocessor">#define DNF_ENUMERATED                              0x00000010</span>
00397 <span class="preprocessor"></span>
00398 <span class="comment">//</span>
00399 <span class="comment">// Singal that we need to send driver query id irps</span>
00400 <span class="comment">//</span>
00401 
<a name="l00402"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a10">00402</a> <span class="preprocessor">#define DNF_NEED_QUERY_IDS                          0x00000020</span>
00403 <span class="preprocessor"></span>
00404 <span class="comment">//</span>
00405 <span class="comment">// THis device has been added to its controlling driver</span>
00406 <span class="comment">//</span>
00407 
<a name="l00408"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a11">00408</a> <span class="preprocessor">#define DNF_ADDED                                   0x00000040</span>
00409 <span class="preprocessor"></span>
00410 <span class="comment">//</span>
00411 <span class="comment">// DNF_HAS_BOOT_CONFIG - the device has resource assigned by BIOS.  It is considered</span>
00412 <span class="comment">//    pseudo-started and need to participate in rebalance.</span>
00413 <span class="comment">//</span>
00414 
<a name="l00415"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a12">00415</a> <span class="preprocessor">#define DNF_HAS_BOOT_CONFIG                         0x00000080</span>
00416 <span class="preprocessor"></span>
00417 <span class="comment">//</span>
00418 <span class="comment">// DNF_BOOT_CONFIG_RESERVED - Indicates the BOOT resources of the device are reserved.</span>
00419 <span class="comment">//</span>
00420 
<a name="l00421"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a13">00421</a> <span class="preprocessor">#define DNF_BOOT_CONFIG_RESERVED                    0x00000100</span>
00422 <span class="preprocessor"></span>
00423 <span class="comment">//</span>
00424 <span class="comment">// DNF_START_REQUEST_PENDING - Indicates the device is being started.</span>
00425 <span class="comment">//</span>
00426 
<a name="l00427"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a14">00427</a> <span class="preprocessor">#define DNF_START_REQUEST_PENDING                   0x00000200</span>
00428 <span class="preprocessor"></span>
00429 <span class="comment">//</span>
00430 <span class="comment">// DNF_NO_RESOURCE_REQUIRED - this devnode's device does not require resource.</span>
00431 <span class="comment">//</span>
00432 
<a name="l00433"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a15">00433</a> <span class="preprocessor">#define DNF_NO_RESOURCE_REQUIRED                    0x00000400</span>
00434 <span class="preprocessor"></span>
00435 <span class="comment">//</span>
00436 <span class="comment">// DNF_RESOURCE_REQUIREMENTS_NEED_FILTERED - to distinguished the</span>
00437 <span class="comment">//      DeviceNode-&gt;ResourceRequirements is a filtered list or not.</span>
00438 <span class="comment">//</span>
00439 
<a name="l00440"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a16">00440</a> <span class="preprocessor">#define DNF_RESOURCE_REQUIREMENTS_NEED_FILTERED     0x00000800</span>
00441 <span class="preprocessor"></span>
00442 <span class="comment">//</span>
00443 <span class="comment">// Indicates the device's resources are bing assigned (but is not done yet.)</span>
00444 <span class="comment">// So don't try assign resource to this device.</span>
00445 <span class="comment">//</span>
00446 
<a name="l00447"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a17">00447</a> <span class="preprocessor">#define DNF_ASSIGNING_RESOURCES                     0x00001000</span>
00448 <span class="preprocessor"></span>
00449 <span class="comment">//</span>
00450 <span class="comment">// DNF_RESOURCE_ASSIGNED - this devnode's resources are assigned by PnP</span>
00451 <span class="comment">//</span>
00452 
<a name="l00453"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a18">00453</a> <span class="preprocessor">#define DNF_RESOURCE_ASSIGNED                       0x00002000</span>
00454 <span class="preprocessor"></span>
00455 <span class="comment">//</span>
00456 <span class="comment">// DNF_RESOURCE_REPORTED - this devnode's resources are reported by PnP</span>
00457 <span class="comment">//</span>
00458 
<a name="l00459"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a19">00459</a> <span class="preprocessor">#define DNF_RESOURCE_REPORTED                       0x00004000</span>
00460 <span class="preprocessor"></span>
00461 <span class="comment">//</span>
00462 <span class="comment">// DNF_RESOURCE_REQUIREMENTS_CHANGED - Indicates the device's resource</span>
00463 <span class="comment">//      requirements list has been changed.</span>
00464 <span class="comment">//</span>
00465 
<a name="l00466"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a20">00466</a> <span class="preprocessor">#define DNF_RESOURCE_REQUIREMENTS_CHANGED           0x00008000</span>
00467 <span class="preprocessor"></span>
00468 <span class="comment">//</span>
00469 <span class="comment">// DNF_NON_STOPPED_REBALANC - indicates the device can be restarted with new</span>
00470 <span class="comment">//      resources without being stopped.</span>
00471 <span class="comment">//</span>
00472 
<a name="l00473"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a21">00473</a> <span class="preprocessor">#define DNF_NON_STOPPED_REBALANCE                   0x00010000</span>
00474 <span class="preprocessor"></span>
00475 <span class="comment">//</span>
00476 <span class="comment">// DNF_STOPPED - indicates this device is currently stopped for reconfiguration of</span>
00477 <span class="comment">//               its resources.</span>
00478 <span class="comment">//</span>
00479 
<a name="l00480"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a22">00480</a> <span class="preprocessor">#define DNF_STOPPED                                 0x00020000</span>
00481 <span class="preprocessor"></span>
00482 <span class="comment">//</span>
00483 <span class="comment">// DNF_STARTED - indicates if the device was started, i.e., its StartDevice</span>
00484 <span class="comment">//               irp is processed.</span>
00485 <span class="comment">//</span>
00486 
<a name="l00487"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a23">00487</a> <span class="preprocessor">#define DNF_STARTED                                 0x00040000</span>
00488 <span class="preprocessor"></span>
00489 <span class="comment">//</span>
00490 <span class="comment">// The device's controlling driver is a legacy driver</span>
00491 <span class="comment">//</span>
00492 
<a name="l00493"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a24">00493</a> <span class="preprocessor">#define DNF_LEGACY_DRIVER                           0x00080000</span>
00494 <span class="preprocessor"></span>
00495 <span class="comment">//</span>
00496 <span class="comment">// For the reported detected devices, they are considered started.  We still</span>
00497 <span class="comment">// need a flag to indicate we need to enumerate the device.</span>
00498 <span class="comment">//</span>
00499 
<a name="l00500"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a25">00500</a> <span class="preprocessor">#define DNF_NEED_ENUMERATION_ONLY                   0x00100000</span>
00501 <span class="preprocessor"></span>
00502 <span class="comment">//</span>
00503 <span class="comment">// DNF_IO_INVALIDATE_DEVICE_RELATIONS_PENDING - indicate the</span>
00504 <span class="comment">//      IoInvalidateDeviceRelations request is pending and therequest needs to</span>
00505 <span class="comment">//      be queued after the Query_Device_relation irp is completed.</span>
00506 <span class="comment">//</span>
00507 
<a name="l00508"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a26">00508</a> <span class="preprocessor">#define DNF_IO_INVALIDATE_DEVICE_RELATIONS_PENDING  0x00200000</span>
00509 <span class="preprocessor"></span>
00510 <span class="comment">//</span>
00511 <span class="comment">// Indicates the device is being sent a query device relations irp. So no more</span>
00512 <span class="comment">//      q-d-r irp at the same time.</span>
00513 <span class="comment">//</span>
00514 
<a name="l00515"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a27">00515</a> <span class="preprocessor">#define DNF_BEING_ENUMERATED                        0x00400000</span>
00516 <span class="preprocessor"></span>
00517 <span class="comment">//</span>
00518 <span class="comment">// DNF_ENUMERATION_REQUEST_QUEUED - indicate the IoInvalidateDeviceRelations</span>
00519 <span class="comment">//      request is queued.  So, new IoInvalidateDeviceRelations can be ignored.</span>
00520 <span class="comment">//</span>
00521 
<a name="l00522"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a28">00522</a> <span class="preprocessor">#define DNF_ENUMERATION_REQUEST_QUEUED              0x00800000</span>
00523 <span class="preprocessor"></span>
00524 <span class="comment">//</span>
00525 <span class="comment">// DNF_ENUMERATION_REQUEST_PENDING - Indicates the QUERY_DEVICE_RELATIONS irp</span>
00526 <span class="comment">//      returns pending.</span>
00527 <span class="comment">//</span>
00528 
<a name="l00529"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a29">00529</a> <span class="preprocessor">#define DNF_ENUMERATION_REQUEST_PENDING             0x01000000</span>
00530 <span class="preprocessor"></span>
00531 <span class="comment">//</span>
00532 <span class="comment">// This corresponds to the user-mode CM_PROB_WILL_BE_REMOVED problem value and</span>
00533 <span class="comment">// the DN_WILL_BE_REMOVED status flag.</span>
00534 <span class="comment">//</span>
00535 
<a name="l00536"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a30">00536</a> <span class="preprocessor">#define DNF_HAS_PROBLEM                             0x02000000</span>
00537 <span class="preprocessor"></span>
00538 <span class="comment">//</span>
00539 <span class="comment">// DNF_HAS_PRIVATE_PROBLEM - indicates this device reported PNP_DEVICE_FAILED</span>
00540 <span class="comment">//  to a IRP_MN_QUERY_PNP_DEVICE_STATE without also reporting</span>
00541 <span class="comment">//  PNP_DEVICE_RESOURCE_REQUIREMENTS_CHANGED.</span>
00542 <span class="comment">//</span>
00543 
<a name="l00544"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a31">00544</a> <span class="preprocessor">#define DNF_HAS_PRIVATE_PROBLEM                     0x04000000</span>
00545 <span class="preprocessor"></span>
00546 <span class="comment">//</span>
00547 <span class="comment">// DNF_REMOVE_PENDING_CLOSES is set after a IRP_MN_SURPRISE_REMOVE is sent</span>
00548 <span class="comment">// to a device object.  It is an indicator that IRP_MN_REMOVE_DEVICE should</span>
00549 <span class="comment">// be sent to the device object as soon as all of the file objects have gone</span>
00550 <span class="comment">// away.</span>
00551 <span class="comment">//</span>
00552 
<a name="l00553"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a32">00553</a> <span class="preprocessor">#define DNF_REMOVE_PENDING_CLOSES                   0x08000000</span>
00554 <span class="preprocessor"></span>
00555 <span class="comment">//</span>
00556 <span class="comment">// DNF_DEVICE_GONE is set when a pdo is no longer returned in a query bus</span>
00557 <span class="comment">// relations.  It will then be processed as a surprise remove if started.</span>
00558 <span class="comment">// This flag is used to better detect when a device is resurrected, and when</span>
00559 <span class="comment">// processing surprise remove, to determine if the devnode should be removed</span>
00560 <span class="comment">// from the tree.</span>
00561 <span class="comment">//</span>
00562 
<a name="l00563"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a33">00563</a> <span class="preprocessor">#define DNF_DEVICE_GONE                             0x10000000</span>
00564 <span class="preprocessor"></span>
00565 <span class="comment">//</span>
00566 <span class="comment">// DNF_LEGACY_RESOURCE_DEVICENODE is set for device nodes created for legacy</span>
00567 <span class="comment">// resource allocation.</span>
00568 <span class="comment">//</span>
00569 
<a name="l00570"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a34">00570</a> <span class="preprocessor">#define DNF_LEGACY_RESOURCE_DEVICENODE              0x20000000</span>
00571 <span class="preprocessor"></span>
00572 <span class="comment">//</span>
00573 <span class="comment">// DNF_NEEDS_REBALANCE is set for device nodes that trigger rebalance.</span>
00574 <span class="comment">//</span>
00575 
<a name="l00576"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a35">00576</a> <span class="preprocessor">#define DNF_NEEDS_REBALANCE                         0x40000000</span>
00577 <span class="preprocessor"></span>
00578 <span class="comment">//</span>
00579 <span class="comment">// DNF_LOCKED_FOR_EJECT is set on device nodes that are being ejected or are</span>
00580 <span class="comment">// related to a device being ejected.</span>
00581 <span class="comment">//</span>
00582 
<a name="l00583"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a36">00583</a> <span class="preprocessor">#define DNF_LOCKED_FOR_EJECT                        0x80000000</span>
00584 <span class="preprocessor"></span>
00585 <span class="comment">//</span>
00586 <span class="comment">// This corresponds to the user-mode the DN_WILL_BE_REMOVED status flag.</span>
00587 <span class="comment">//</span>
00588 
<a name="l00589"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a37">00589</a> <span class="preprocessor">#define DNUF_WILL_BE_REMOVED                        0x00000001</span>
00590 <span class="preprocessor"></span>
00591 <span class="comment">//</span>
00592 <span class="comment">// This corresponds to the user-mode DN_NO_SHOW_IN_DM status flag.</span>
00593 <span class="comment">//</span>
00594 
<a name="l00595"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a38">00595</a> <span class="preprocessor">#define DNUF_DONT_SHOW_IN_UI                        0x00000002</span>
00596 <span class="preprocessor"></span>
00597 <span class="comment">//</span>
00598 <span class="comment">// This flag is set when user-mode lets us know that a reboot is required</span>
00599 <span class="comment">// for this device.</span>
00600 <span class="comment">//</span>
00601 
<a name="l00602"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a39">00602</a> <span class="preprocessor">#define DNUF_NEED_RESTART                           0x00000004</span>
00603 <span class="preprocessor"></span>
00604 <span class="comment">//</span>
00605 <span class="comment">// This flag is set to let the user-mode know when a device can be disabled</span>
00606 <span class="comment">// it is still possible for this to be TRUE, yet disable to fail, as it's</span>
00607 <span class="comment">// a polled flag (see also PNP_DEVICE_NOT_DISABLEABLE)</span>
00608 <span class="comment">//</span>
00609 
<a name="l00610"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a40">00610</a> <span class="preprocessor">#define DNUF_NOT_DISABLEABLE                        0x00000008</span>
00611 <span class="preprocessor"></span>
00612 
<a name="l00613"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a41">00613</a> <span class="preprocessor">#define DNF_ADD_PHASE                 (DNF_HAS_PROBLEM | DNF_HAS_PRIVATE_PROBLEM | DNF_DEVICE_GONE | DNF_REMOVE_PENDING_CLOSES | DNF_ADDED)</span>
00614 <span class="preprocessor"></span>
<a name="l00615"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a42">00615</a> <span class="preprocessor">#define OK_TO_ADD_DEVICE(_devnode_)                                 \</span>
00616 <span class="preprocessor">    ( (_devnode_)-&gt;Flags &amp; DNF_PROCESSED     &amp;&amp;                     \</span>
00617 <span class="preprocessor">      !((_devnode_)-&gt;Flags &amp; DNF_ADD_PHASE) )</span>
00618 <span class="preprocessor"></span>
<a name="l00619"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a43">00619</a> <span class="preprocessor">#define DNF_START_PHASE               (DNF_HAS_PROBLEM | DNF_HAS_PRIVATE_PROBLEM | DNF_DEVICE_GONE | DNF_REMOVE_PENDING_CLOSES | DNF_STARTED | DNF_START_REQUEST_PENDING)</span>
00620 <span class="preprocessor"></span>
<a name="l00621"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a44">00621</a> <span class="preprocessor">#define DNF_ASYNC_REQUEST_PENDING     (DNF_START_REQUEST_PENDING | DNF_ENUMERATION_REQUEST_PENDING)</span>
00622 <span class="preprocessor"></span>
<a name="l00623"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a45">00623</a> <span class="preprocessor">#define DNF_ASSIGN_RESOURCE_PHASE     (DNF_HAS_PROBLEM | DNF_HAS_PRIVATE_PROBLEM | DNF_DEVICE_GONE | DNF_REMOVE_PENDING_CLOSES | DNF_RESOURCE_ASSIGNED | DNF_RESOURCE_REPORTED |  \</span>
00624 <span class="preprocessor">                                       DNF_ASSIGNING_RESOURCES | DNF_NO_RESOURCE_REQUIRED)</span>
<a name="l00625"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a46">00625</a> <span class="preprocessor"></span><span class="preprocessor">#define DNF_HAS_RESOURCE              (DNF_RESOURCE_ASSIGNED | DNF_RESOURCE_REPORTED | \</span>
00626 <span class="preprocessor">                                       DNF_NO_RESOURCE_REQUIRED)</span>
00627 <span class="preprocessor"></span>
00628 <span class="comment">//</span>
00629 <span class="comment">// PNP Bugcheck Subcodes</span>
00630 <span class="comment">//</span>
<a name="l00631"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a47">00631</a> <span class="preprocessor">#define PNP_ERR_DUPLICATE_PDO                   1</span>
<a name="l00632"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a48">00632</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ERR_INVALID_PDO                     2</span>
<a name="l00633"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a49">00633</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ERR_BOGUS_ID                        3</span>
<a name="l00634"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a50">00634</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ERR_PDO_ENUMERATED_AFTER_DELETION   4</span>
<a name="l00635"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a51">00635</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ERR_ACTIVE_PDO_FREED                5</span>
00636 <span class="preprocessor"></span>
<a name="l00637"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a52">00637</a> <span class="preprocessor">#define PNP_ERR_DEVICE_MISSING_FROM_EJECT_LIST  6</span>
<a name="l00638"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a53">00638</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ERR_UNEXPECTED_ADD_RELATION_ERR     7</span>
00639 <span class="preprocessor"></span>
00640 
00641 
<a name="l00642"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a118">00642</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> (*<a class="code" href="../../d9/d0/pnpiop_8h.html#a118">PENUM_CALLBACK</a>)(
00643     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
00644     IN PVOID Context
00645     );
00646 
00647 <span class="comment">//</span>
00648 <span class="comment">// Define workitem for add/start new device</span>
00649 <span class="comment">//</span>
00650 
<a name="l00651"></a><a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html">00651</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html">_NEW_DEVICE_WORK_ITEM</a> {
<a name="l00652"></a><a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o0">00652</a>     <a class="code" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o0">WorkItem</a>;
<a name="l00653"></a><a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o1">00653</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o1">DeviceObject</a>;
<a name="l00654"></a><a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o2">00654</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html#o2">DriverObject</a>;
00655 } <a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html">NEW_DEVICE_WORK_ITEM</a>, *<a class="code" href="../../d8/d1/struct__NEW__DEVICE__WORK__ITEM.html">PNEW_DEVICE_WORK_ITEM</a>;
00656 
00657 <span class="comment">//</span>
00658 <span class="comment">// Define callback routine for IopApplyFunctionToSubKeys &amp;</span>
00659 <span class="comment">// IopApplyFunctionToServiceInstances</span>
00660 <span class="comment">//</span>
<a name="l00661"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a121">00661</a> <span class="keyword">typedef</span> BOOLEAN (*<a class="code" href="../../d9/d0/pnpiop_8h.html#a121">PIOP_SUBKEY_CALLBACK_ROUTINE</a>) (
00662     IN     HANDLE,
00663     IN     PUNICODE_STRING,
00664     IN OUT PVOID
00665     );
00666 
00667 <span class="comment">//</span>
00668 <span class="comment">// Define context structures for Start and Add device services</span>
00669 <span class="comment">//</span>
00670 
<a name="l00671"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a54">00671</a> <span class="preprocessor">#define NO_MORE_GROUP ((USHORT) -1)</span>
<a name="l00672"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a55">00672</a> <span class="preprocessor"></span><span class="preprocessor">#define SETUP_RESERVED_GROUP      0</span>
<a name="l00673"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a56">00673</a> <span class="preprocessor"></span><span class="preprocessor">#define BUS_DRIVER_GROUP          1</span>
00674 <span class="preprocessor"></span>
<a name="l00675"></a><a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html">00675</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html">_ADD_CONTEXT</a> {
<a name="l00676"></a><a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o0">00676</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o0">GroupsToStart</a>;
<a name="l00677"></a><a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o1">00677</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o1">GroupToStartNext</a>;
<a name="l00678"></a><a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o2">00678</a>     ULONG <a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html#o2">DriverStartType</a>;
00679 } <a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html">ADD_CONTEXT</a>, *<a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html">PADD_CONTEXT</a>;
00680 
<a name="l00681"></a><a class="code" href="../../d0/d6/struct__START__CONTEXT.html">00681</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6/struct__START__CONTEXT.html">_START_CONTEXT</a> {
<a name="l00682"></a><a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o0">00682</a>     BOOLEAN <a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o0">LoadDriver</a>;
<a name="l00683"></a><a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o1">00683</a>     BOOLEAN <a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o1">NewDevice</a>;
<a name="l00684"></a><a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o2">00684</a>     <a class="code" href="../../d8/d5/struct__ADD__CONTEXT.html">ADD_CONTEXT</a> <a class="code" href="../../d0/d6/struct__START__CONTEXT.html#o2">AddContext</a>;
00685 } <a class="code" href="../../d0/d6/struct__START__CONTEXT.html">START_CONTEXT</a>, *<a class="code" href="../../d0/d6/struct__START__CONTEXT.html">PSTART_CONTEXT</a>;
00686 
00687 <span class="comment">//</span>
00688 <span class="comment">// Resource translation and allocation related structures</span>
00689 <span class="comment">//</span>
00690 
<a name="l00691"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a390">00691</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a390">_RESOURCE_HANDLER_TYPE</a> {
00692     <a class="code" href="../../d9/d0/pnpiop_8h.html#a390a214">ResourceHandlerNull</a>,
00693     <a class="code" href="../../d9/d0/pnpiop_8h.html#a390a215">ResourceTranslator</a>,
00694     <a class="code" href="../../d9/d0/pnpiop_8h.html#a390a216">ResourceArbiter</a>,
00695     <a class="code" href="../../d9/d0/pnpiop_8h.html#a390a217">ResourceLegacyDeviceDetection</a>
00696 } <a class="code" href="../../d9/d0/pnpiop_8h.html#a126">RESOURCE_HANDLER_TYPE</a>;
00697 
<a name="l00698"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a57">00698</a> <span class="preprocessor">#define PI_MAXIMUM_RESOURCE_TYPE_TRACKED 15</span>
00699 <span class="preprocessor"></span>
00700 <span class="comment">//</span>
00701 <span class="comment">// Internal Arbiters tracking structures</span>
00702 <span class="comment">// Note the first three fields of PI_RESOURCE_ARBITER_ENTRY and PI_RESOURCE_TRANSLATOR_ENTRY</span>
00703 <span class="comment">// must be the same.</span>
00704 <span class="comment">//</span>
00705 
<a name="l00706"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html">00706</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html">_PI_RESOURCE_ARBITER_ENTRY</a> {
<a name="l00707"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o0">00707</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o0">DeviceArbiterList</a>;         <span class="comment">// Link all the arbiters of a PDO.</span>
<a name="l00708"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o1">00708</a>     UCHAR <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o1">ResourceType</a>;
<a name="l00709"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o2">00709</a>     <a class="code" href="../../d9/d7/struct__ARBITER__INTERFACE.html">PARBITER_INTERFACE</a> <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o2">ArbiterInterface</a>;
<a name="l00710"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o3">00710</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o3">ResourceList</a>;
<a name="l00711"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o4">00711</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o4">BestResourceList</a>;
<a name="l00712"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o5">00712</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o5">BestConfig</a>;                <span class="comment">// Link all the arbiters which produces the best logconf</span>
<a name="l00713"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o6">00713</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o6">ActiveArbiterList</a>;         <span class="comment">// Link all the arbiters under testing</span>
<a name="l00714"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o7">00714</a>     UCHAR <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o7">State</a>;
<a name="l00715"></a><a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o8">00715</a>     BOOLEAN <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html#o8">ResourcesChanged</a>;
00716 } <a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html">PI_RESOURCE_ARBITER_ENTRY</a>, *<a class="code" href="../../d7/d5/struct__PI__RESOURCE__ARBITER__ENTRY.html">PPI_RESOURCE_ARBITER_ENTRY</a>;
00717 
00718 <span class="comment">//</span>
00719 <span class="comment">// Define PI_RESOURCE_ARBITER_ENTRY state</span>
00720 <span class="comment">//</span>
00721 
<a name="l00722"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a58">00722</a> <span class="preprocessor">#define PI_ARBITER_HAS_SOMETHING 1</span>
<a name="l00723"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a59">00723</a> <span class="preprocessor"></span><span class="preprocessor">#define PI_ARBITER_TEST_FAILED   2</span>
00724 <span class="preprocessor"></span>
00725 <span class="comment">//</span>
00726 <span class="comment">// Internal Translator tracking structures</span>
00727 <span class="comment">//</span>
00728 
<a name="l00729"></a><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html">00729</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html">_PI_RESOURCE_TRANSLATOR_ENTRY</a> {
<a name="l00730"></a><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o0">00730</a>     LIST_ENTRY <a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o0">DeviceTranslatorList</a>;
<a name="l00731"></a><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o1">00731</a>     UCHAR <a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o1">ResourceType</a>;
<a name="l00732"></a><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o2">00732</a>     <a class="code" href="../../d3/d2/struct__TRANSLATOR__INTERFACE.html">PTRANSLATOR_INTERFACE</a> <a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o2">TranslatorInterface</a>;
<a name="l00733"></a><a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html#o3">00733</a>     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode;
00734 } <a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html">PI_RESOURCE_TRANSLATOR_ENTRY</a>, *<a class="code" href="../../d8/d5/struct__PI__RESOURCE__TRANSLATOR__ENTRY.html">PPI_RESOURCE_TRANSLATOR_ENTRY</a>;
00735 
00736 <span class="comment">//</span>
00737 <span class="comment">// IOP_RESOURCE_REQUEST</span>
00738 <span class="comment">//</span>
00739 
<a name="l00740"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a60">00740</a> <span class="preprocessor">#define QUERY_RESOURCE_LIST                0</span>
<a name="l00741"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a61">00741</a> <span class="preprocessor"></span><span class="preprocessor">#define QUERY_RESOURCE_REQUIREMENTS        1</span>
00742 <span class="preprocessor"></span>
<a name="l00743"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a62">00743</a> <span class="preprocessor">#define REGISTRY_ALLOC_CONFIG              1</span>
<a name="l00744"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a63">00744</a> <span class="preprocessor"></span><span class="preprocessor">#define REGISTRY_FORCED_CONFIG             2</span>
<a name="l00745"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a64">00745</a> <span class="preprocessor"></span><span class="preprocessor">#define REGISTRY_BOOT_CONFIG               4</span>
<a name="l00746"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a65">00746</a> <span class="preprocessor"></span><span class="preprocessor">#define REGISTRY_OVERRIDE_CONFIGVECTOR     1</span>
<a name="l00747"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a66">00747</a> <span class="preprocessor"></span><span class="preprocessor">#define REGISTRY_BASIC_CONFIGVECTOR        2</span>
00748 <span class="preprocessor"></span>
00749 <span class="comment">//</span>
00750 <span class="comment">// An array of IOP_RESOURCE_REQUEST structures is used to anchor all the</span>
00751 <span class="comment">// devices for which resource rerquirement is being attempted.</span>
00752 <span class="comment">//</span>
00753 
<a name="l00754"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a67">00754</a> <span class="preprocessor">#define IOP_ASSIGN_RETRY              0x00000008    // Retry resource allocation later</span>
<a name="l00755"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a68">00755</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_ASSIGN_EXCLUDE            0x00000010    // internal IopAssign flag</span>
<a name="l00756"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a69">00756</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_ASSIGN_IGNORE             0x00000020    // ignore this request</span>
<a name="l00757"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a70">00757</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_ASSIGN_NO_REBALANCE       0x00000080    // no rebal if assign fails</span>
<a name="l00758"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a71">00758</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_ASSIGN_RESOURCES_RELEASED 0x00000100    // resources are released for rebalancing</span>
<a name="l00759"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a72">00759</a> <span class="preprocessor"></span><span class="preprocessor">#define IOP_ASSIGN_KEEP_CURRENT_CONFIG 0x00000200   // Indicate non-stopped rebalance.  We need to</span>
00760 <span class="preprocessor"></span>                                                    <span class="comment">//   preserved the current config.</span>
<a name="l00761"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a73">00761</a> <span class="preprocessor">#define IOP_ASSIGN_CLEAR_RESOURCE_REQUIREMENTS_CHANGE_FLAG \</span>
00762 <span class="preprocessor">                                      0x00000400</span>
00763 <span class="preprocessor"></span>
<a name="l00764"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html">00764</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html">_IOP_RESOURCE_REQUEST</a> {
<a name="l00765"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o0">00765</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>                 <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o0">PhysicalDevice</a>;
<a name="l00766"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o1">00766</a>     ULONG                          <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o1">Flags</a>;
<a name="l00767"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o2">00767</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a58">ARBITER_REQUEST_SOURCE</a>         <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o2">AllocationType</a>;
<a name="l00768"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o3">00768</a>     ULONG                          <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o3">Priority</a>;                   <span class="comment">// 0 is highest priority</span>
<a name="l00769"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o4">00769</a>     PIO_RESOURCE_REQUIREMENTS_LIST <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o4">ResourceRequirements</a>;
<a name="l00770"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o5">00770</a>     PVOID                          <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o5">ReqList</a>;                    <span class="comment">// PREQ_LIST</span>
<a name="l00771"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o6">00771</a>     PCM_RESOURCE_LIST              <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o6">ResourceAssignment</a>;
<a name="l00772"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o7">00772</a>     PCM_RESOURCE_LIST              <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o7">TranslatedResourceAssignment</a>;
<a name="l00773"></a><a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o8">00773</a>     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                       <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html#o8">Status</a>;
00774 } <a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html">IOP_RESOURCE_REQUEST</a>, *<a class="code" href="../../d4/d1/struct__IOP__RESOURCE__REQUEST.html">PIOP_RESOURCE_REQUEST</a>;
00775 
00776 <span class="comment">//</span>
00777 <span class="comment">// Misc</span>
00778 <span class="comment">//</span>
00779 
00780 <span class="comment">//</span>
00781 <span class="comment">// Enumeration request type</span>
00782 <span class="comment">//</span>
00783 
<a name="l00784"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a391">00784</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a391">_DEVICE_REQUEST_TYPE</a> {
00785     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a218">ReenumerateDeviceTree</a>,
00786     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a219">ReenumerateDeviceOnly</a>,
00787     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a220">ReenumerateBootDevices</a>,
00788     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a221">RestartEnumeration</a>,
00789     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a222">AssignResources</a>,
00790     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a223">ResourceRequirementsChanged</a>,
00791     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a224">StartDevice</a>,
00792     <a class="code" href="../../d9/d0/pnpiop_8h.html#a391a225">ReenumerateRootDevices</a>
00793 } <a class="code" href="../../d9/d0/pnpiop_8h.html#a133">DEVICE_REQUEST_TYPE</a>;
00794 
<a name="l00795"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html">00795</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html">_PI_DEVICE_REQUEST</a> {
<a name="l00796"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o0">00796</a>     LIST_ENTRY <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o0">ListEntry</a>;
<a name="l00797"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o1">00797</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o1">DeviceObject</a>;
<a name="l00798"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o2">00798</a>     <a class="code" href="../../d9/d0/pnpiop_8h.html#a133">DEVICE_REQUEST_TYPE</a> <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o2">RequestType</a>;
<a name="l00799"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o3">00799</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o3">CompletionEvent</a>;
<a name="l00800"></a><a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o4">00800</a>     PNTSTATUS <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html#o4">CompletionStatus</a>;
00801 } <a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html">PI_DEVICE_REQUEST</a>, *<a class="code" href="../../d6/d5/struct__PI__DEVICE__REQUEST.html">PPI_DEVICE_REQUEST</a>;
00802 
<a name="l00803"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a74">00803</a> <span class="preprocessor">#define CmResourceTypeReserved  0xf0</span>
00804 <span class="preprocessor"></span>
00805 
00806 
00807 <span class="comment">//</span>
00808 <span class="comment">// This macro returns the pointer to the beginning of the data</span>
00809 <span class="comment">// area of KEY_VALUE_FULL_INFORMATION structure.</span>
00810 <span class="comment">// In the macro, k is a pointer to KEY_VALUE_FULL_INFORMATION structure.</span>
00811 <span class="comment">//</span>
00812 
<a name="l00813"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a75">00813</a> <span class="preprocessor">#define KEY_VALUE_DATA(k) ((PCHAR)(k) + (k)-&gt;DataOffset)</span>
00814 <span class="preprocessor"></span>
00815 <span class="comment">//</span>
00816 <span class="comment">// Save failure status info.</span>
00817 <span class="comment">//</span>
00818 
00819 <span class="preprocessor">#if DBG_SCOPE</span>
<a name="l00820"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a76">00820</a> <span class="preprocessor"></span><span class="preprocessor">#define SAVE_FAILURE_INFO(DeviceNode, Status) (DeviceNode)-&gt;FailureStatus = (Status)</span>
00821 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00822 <span class="preprocessor"></span><span class="preprocessor">#define SAVE_FAILURE_INFO(DeviceNode, Status)</span>
00823 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00824 <span class="preprocessor"></span>
<a name="l00825"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a77">00825</a> <span class="preprocessor">#define IopDoesDevNodeHaveProblem(devnode)                          \</span>
00826 <span class="preprocessor">        ((devnode)-&gt;Flags &amp; (DNF_HAS_PROBLEM | DNF_HAS_PRIVATE_PROBLEM))</span>
00827 <span class="preprocessor"></span>
<a name="l00828"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a78">00828</a> <span class="preprocessor">#define IopIsDevNodeProblem(devnode, problem)                       \</span>
00829 <span class="preprocessor">        (((devnode)-&gt;Flags &amp; DNF_HAS_PROBLEM) &amp;&amp; (devnode)-&gt;Problem == (problem))</span>
00830 <span class="preprocessor"></span>
<a name="l00831"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a79">00831</a> <span class="preprocessor">#define IopClearDevNodeProblem(devnode)                             \</span>
00832 <span class="preprocessor">        (devnode)-&gt;Flags &amp;= ~DNF_HAS_PROBLEM;                       \</span>
00833 <span class="preprocessor">        (devnode)-&gt;Problem = 0;</span>
00834 <span class="preprocessor"></span>
<a name="l00835"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a80">00835</a> <span class="preprocessor">#define IopSetDevNodeProblem(devnode, problem)                      \</span>
00836 <span class="preprocessor">        ASSERT(((devnode)-&gt;Flags &amp; DNF_PROCESSED) || !((devnode)-&gt;Flags &amp; DNF_ENUMERATED)); \</span>
00837 <span class="preprocessor">        ASSERT(!((devnode)-&gt;Flags &amp; (DNF_STARTED | DNF_HAS_PROBLEM | DNF_HAS_PRIVATE_PROBLEM))); \</span>
00838 <span class="preprocessor">        ASSERT(problem != 0); \</span>
00839 <span class="preprocessor">        (devnode)-&gt;Flags |= DNF_HAS_PROBLEM;                        \</span>
00840 <span class="preprocessor">        (devnode)-&gt;Problem = (problem);</span>
00841 <span class="preprocessor"></span>
<a name="l00842"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a81">00842</a> <span class="preprocessor">#define IopIsProblemReadonly(problem)            \</span>
00843 <span class="preprocessor">    ((problem) != CM_PROB_FAILED_INSTALL      &amp;&amp; \</span>
00844 <span class="preprocessor">     (problem) != CM_PROB_FAILED_ADD          &amp;&amp; \</span>
00845 <span class="preprocessor">     (problem) != CM_PROB_FAILED_START        &amp;&amp; \</span>
00846 <span class="preprocessor">     (problem) != CM_PROB_NOT_CONFIGURED      &amp;&amp; \</span>
00847 <span class="preprocessor">     (problem) != CM_PROB_NEED_RESTART        &amp;&amp; \</span>
00848 <span class="preprocessor">     (problem) != CM_PROB_REINSTALL           &amp;&amp; \</span>
00849 <span class="preprocessor">     (problem) != CM_PROB_REGISTRY            &amp;&amp; \</span>
00850 <span class="preprocessor">     (problem) != CM_PROB_DISABLED)</span>
00851 <span class="preprocessor"></span>
00852 <span class="comment">//++</span>
00853 <span class="comment">//</span>
00854 <span class="comment">// VOID</span>
00855 <span class="comment">// IopRegistryDataToUnicodeString(</span>
00856 <span class="comment">//     OUT PUNICODE_STRING u,</span>
00857 <span class="comment">//     IN  PWCHAR p,</span>
00858 <span class="comment">//     IN  ULONG l</span>
00859 <span class="comment">//     )</span>
00860 <span class="comment">//</span>
00861 <span class="comment">//--</span>
<a name="l00862"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a82">00862</a> <span class="preprocessor">#define IopRegistryDataToUnicodeString(u, p, l)  \</span>
00863 <span class="preprocessor">    {                                            \</span>
00864 <span class="preprocessor">        ULONG len;                               \</span>
00865 <span class="preprocessor">                                                 \</span>
00866 <span class="preprocessor">        PiRegSzToString((p), (l), &amp;len, NULL);   \</span>
00867 <span class="preprocessor">        (u)-&gt;Length = (USHORT)len;               \</span>
00868 <span class="preprocessor">        (u)-&gt;MaximumLength = (USHORT)(l);        \</span>
00869 <span class="preprocessor">        (u)-&gt;Buffer = (p);                       \</span>
00870 <span class="preprocessor">    }</span>
00871 <span class="preprocessor"></span>
00872 <span class="comment">//</span>
00873 <span class="comment">// Title Index to set registry key value</span>
00874 <span class="comment">//</span>
00875 
<a name="l00876"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a83">00876</a> <span class="preprocessor">#define TITLE_INDEX_VALUE 0</span>
00877 <span class="preprocessor"></span>
00878 <span class="preprocessor">#if DBG</span>
00879 <span class="preprocessor"></span><span class="preprocessor">#define PNP_ASSERT(condition, message) \</span>
00880 <span class="preprocessor">        if (!(condition)) { \</span>
00881 <span class="preprocessor">           DbgPrint((message)); \</span>
00882 <span class="preprocessor">           DbgBreakPoint(); \</span>
00883 <span class="preprocessor">        }</span>
00884 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00885"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a84">00885</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_ASSERT(condition, message)</span>
00886 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00887 <span class="preprocessor"></span>
00888 <span class="comment">//</span>
00889 <span class="comment">// Default value of PnpDetectionEnabled</span>
00890 <span class="comment">// Only used if the CCS\Control\Pnp key is absent or garbled</span>
00891 <span class="comment">//</span>
00892 
<a name="l00893"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a85">00893</a> <span class="preprocessor">#define PNP_DETECTION_ENABLED_DEFAULT   TRUE</span>
00894 <span class="preprocessor"></span>
00895 <span class="comment">//</span>
00896 <span class="comment">// Size of scratch buffer used in this module.</span>
00897 <span class="comment">//</span>
00898 
<a name="l00899"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a86">00899</a> <span class="preprocessor">#define PNP_SCRATCH_BUFFER_SIZE 512</span>
<a name="l00900"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a87">00900</a> <span class="preprocessor"></span><span class="preprocessor">#define PNP_LARGE_SCRATCH_BUFFER_SIZE (PNP_SCRATCH_BUFFER_SIZE * 8)</span>
00901 <span class="preprocessor"></span>
00902 <span class="comment">//</span>
00903 <span class="comment">// Define Device Instance Flags (used by IoQueryDeviceConfiguration apis)</span>
00904 <span class="comment">//</span>
00905 
<a name="l00906"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a88">00906</a> <span class="preprocessor">#define DEVINSTANCE_FLAG_HWPROFILE_DISABLED 0x1</span>
<a name="l00907"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a89">00907</a> <span class="preprocessor"></span><span class="preprocessor">#define DEVINSTANCE_FLAG_PNP_ENUMERATED 0x2</span>
00908 <span class="preprocessor"></span>
00909 <span class="comment">//</span>
00910 <span class="comment">// Define Enumeration Control Flags (used by IopApplyFunctionToSubKeys)</span>
00911 <span class="comment">//</span>
00912 
<a name="l00913"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a90">00913</a> <span class="preprocessor">#define FUNCTIONSUBKEY_FLAG_IGNORE_NON_CRITICAL_ERRORS  0x1</span>
<a name="l00914"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a91">00914</a> <span class="preprocessor"></span><span class="preprocessor">#define FUNCTIONSUBKEY_FLAG_DELETE_SUBKEYS              0x2</span>
00915 <span class="preprocessor"></span>
00916 <span class="comment">//</span>
00917 <span class="comment">// The following definitions are used in IoOpenDeviceInstanceKey</span>
00918 <span class="comment">//</span>
00919 
<a name="l00920"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a92">00920</a> <span class="preprocessor">#define PLUGPLAY_REGKEY_DEVICE  1</span>
<a name="l00921"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a93">00921</a> <span class="preprocessor"></span><span class="preprocessor">#define PLUGPLAY_REGKEY_DRIVER  2</span>
<a name="l00922"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a94">00922</a> <span class="preprocessor"></span><span class="preprocessor">#define PLUGPLAY_REGKEY_CURRENT_HWPROFILE 4</span>
00923 <span class="preprocessor"></span>
00924 <span class="comment">//</span>
00925 <span class="comment">// Define device extension for devices reported with IoReportDetectedDevice.</span>
00926 <span class="comment">//</span>
00927 
<a name="l00928"></a><a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html">00928</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html">_IOPNP_DEVICE_EXTENSION</a> {
<a name="l00929"></a><a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html#o0">00929</a>     PWCHAR <a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html#o0">CompatibleIdList</a>;
<a name="l00930"></a><a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html#o1">00930</a>     ULONG <a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html#o1">CompatibleIdListSize</a>;
00931 } <a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html">IOPNP_DEVICE_EXTENSION</a>, *<a class="code" href="../../d5/d1/struct__IOPNP__DEVICE__EXTENSION.html">PIOPNP_DEVICE_EXTENSION</a>;
00932 
00933 <span class="comment">//</span>
00934 <span class="comment">// Reserve Boot Resources</span>
00935 <span class="comment">//</span>
00936 
<a name="l00937"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a138">00937</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html">_IOP_RESERVED_RESOURCES_RECORD</a> IOP_RESERVED_RESOURCES_RECORD, *<a class="code" href="../../d9/d0/pnpiop_8h.html#a138">PIOP_RESERVED_RESOURCES_RECORD</a>;
00938 
<a name="l00939"></a><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html">00939</a> <span class="keyword">struct </span><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html">_IOP_RESERVED_RESOURCES_RECORD</a> {
<a name="l00940"></a><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o0">00940</a>     <a class="code" href="../../d9/d0/pnpiop_8h.html#a138">PIOP_RESERVED_RESOURCES_RECORD</a>  <a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o0">Next</a>;
<a name="l00941"></a><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o1">00941</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>                  <a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o1">DeviceObject</a>;
<a name="l00942"></a><a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o2">00942</a>     PCM_RESOURCE_LIST               <a class="code" href="../../d3/d1/struct__IOP__RESERVED__RESOURCES__RECORD.html#o2">ReservedResources</a>;
00943 };
00944 
00945 <span class="comment">//</span>
00946 <span class="comment">// External References</span>
00947 <span class="comment">//</span>
00948 
00949 <span class="comment">//</span>
00950 <span class="comment">// Init data</span>
00951 <span class="comment">//</span>
<a name="l00952"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a139">00952</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d1/d0/pnpdata_8c.html#a0">IopPnpScratchBuffer1</a>;
<a name="l00953"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a140">00953</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d1/d0/pnpdata_8c.html#a1">IopPnpScratchBuffer2</a>;
<a name="l00954"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a141">00954</a> <span class="keyword">extern</span> PCM_RESOURCE_LIST <a class="code" href="../../d1/d0/pnpdata_8c.html#a2">IopInitHalResources</a>;
<a name="l00955"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a142">00955</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a3">IopInitHalDeviceNode</a>;
<a name="l00956"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a143">00956</a> <span class="keyword">extern</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a138">PIOP_RESERVED_RESOURCES_RECORD</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a4">IopInitReservedResourceList</a>;
00957 
00958 <span class="comment">//</span>
00959 <span class="comment">// Regular data</span>
00960 <span class="comment">//</span>
00961 
00962 <span class="comment">//</span>
00963 <span class="comment">// IopRootDeviceNode - the head of the PnP manager's device node tree.</span>
00964 <span class="comment">//</span>
00965 
<a name="l00966"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a144">00966</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a5">IopRootDeviceNode</a>;
00967 
00968 <span class="comment">//</span>
00969 <span class="comment">// IopPnPDriverObject - the madeup driver object for pnp manager</span>
00970 <span class="comment">//</span>
00971 
<a name="l00972"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a145">00972</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d9/d0/pnpiop_8h.html#a145">IopPnPDriverObject</a>;
00973 
00974 <span class="comment">//</span>
00975 <span class="comment">// IopPnPSpinLock - spinlock for Pnp code.</span>
00976 <span class="comment">//</span>
00977 
<a name="l00978"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a146">00978</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d1/d0/pnpdata_8c.html#a7">IopPnPSpinLock</a>;
00979 
00980 <span class="comment">//</span>
00981 <span class="comment">// IopPnpDeleteRequestList - a link list of device removal requests to worker thread.</span>
00982 <span class="comment">//</span>
00983 
<a name="l00984"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a147">00984</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d9/d0/pnpiop_8h.html#a147">IopPnpDeleteRequestList</a>;
00985 
00986 <span class="comment">//</span>
00987 <span class="comment">// IopPnpEnumerationRequestList - a link list of device enumeration requests to worker thread.</span>
00988 <span class="comment">//</span>
00989 
<a name="l00990"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a148">00990</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d1/d0/pnpdata_8c.html#a13">IopPnpEnumerationRequestList</a>;
00991 
00992 <span class="comment">//</span>
00993 <span class="comment">// IopDeviceTreeLock - performs syncronization on the whole device node tree.</span>
00994 <span class="comment">//      IopAcquireEnumerationLock acquires this lock shared then optionally</span>
00995 <span class="comment">//                                acquires an exclusive lock on a devnode.</span>
00996 <span class="comment">//      IopAcquireDeviceTreeLock acquires this lock exclusive</span>
00997 <span class="comment">//</span>
00998 
<a name="l00999"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a149">00999</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a8">IopDeviceTreeLock</a>;
01000 
01001 <span class="comment">//</span>
01002 <span class="comment">// PiEventQueueEmpty - Manual reset event which is set when the queue is empty</span>
01003 <span class="comment">//</span>
01004 
<a name="l01005"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a150">01005</a> <span class="keyword">extern</span> <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a9">PiEventQueueEmpty</a>;
01006 
01007 <span class="comment">//</span>
01008 <span class="comment">// PiEnumerationLock - to synchronize IoInvalidateDeviceRelations in boot phase.</span>
01009 <span class="comment">//</span>
01010 
<a name="l01011"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a151">01011</a> <span class="keyword">extern</span> <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a10">PiEnumerationLock</a>;
01012 
01013 <span class="comment">//</span>
01014 <span class="comment">// iopEnumerationCount - indicates how many devices are being enumerated.</span>
01015 <span class="comment">//</span>
01016 
<a name="l01017"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a152">01017</a> <span class="keyword">extern</span> LONG <a class="code" href="../../d1/d0/pnpdata_8c.html#a11">IopEnumerationCount</a>;
01018 
01019 <span class="comment">//</span>
01020 <span class="comment">// IopNumberDeviceNodes - Number of outstanding device nodes in the system</span>
01021 <span class="comment">//</span>
01022 
<a name="l01023"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a153">01023</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d1/d0/pnpdata_8c.html#a12">IopNumberDeviceNodes</a>;
01024 
01025 <span class="comment">//</span>
01026 <span class="comment">// PnPInitialized - A flag to indicate if PnP initialization is completed.</span>
01027 <span class="comment">//</span>
01028 
<a name="l01029"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a154">01029</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a14">PnPInitialized</a>;
01030 
01031 <span class="comment">//</span>
01032 <span class="comment">// PnPBootDriverInitialied</span>
01033 <span class="comment">//</span>
01034 
<a name="l01035"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a155">01035</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a16">PnPBootDriversInitialized</a>;
01036 
01037 <span class="comment">//</span>
01038 <span class="comment">// PnPBootDriverLoaded</span>
01039 <span class="comment">//</span>
01040 
<a name="l01041"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a156">01041</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a17">PnPBootDriversLoaded</a>;
01042 
01043 <span class="comment">//</span>
01044 <span class="comment">// IopBootConfigsReserved - Indicates whether we have reserved BOOT configs or not.</span>
01045 <span class="comment">//</span>
01046 
<a name="l01047"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a157">01047</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a18">IopBootConfigsReserved</a>;
01048 
01049 <span class="comment">//</span>
01050 <span class="comment">// IopResourcesReleased - a flag to indicate if a device is removed and its resources</span>
01051 <span class="comment">//     are freed.  This is for reallocating resources for DNF_INSUFFICIENT_RESOURCES</span>
01052 <span class="comment">//     devices.</span>
01053 <span class="comment">//</span>
01054 
<a name="l01055"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a158">01055</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a19">IopResourcesReleased</a>;
01056 
01057 <span class="comment">//</span>
01058 <span class="comment">// PnPDetectionEnabled - A flag to indicate if detection code can be executed</span>
01059 <span class="comment">//</span>
01060 
<a name="l01061"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a159">01061</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a15">PnPDetectionEnabled</a>;
01062 
01063 <span class="comment">//</span>
01064 <span class="comment">// PnpDefaultInterfaceTYpe - Use this if the interface type of resource list is unknown.</span>
01065 <span class="comment">//</span>
01066 
<a name="l01067"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a160">01067</a> <span class="keyword">extern</span> INTERFACE_TYPE <a class="code" href="../../d1/d0/pnpdata_8c.html#a23">PnpDefaultInterfaceType</a>;
01068 
01069 <span class="comment">//</span>
01070 <span class="comment">// PnpStartAsynOk - control how start irp should be handled. Synchronously or Asynchronously?</span>
01071 <span class="comment">//</span>
01072 
<a name="l01073"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a161">01073</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d0/pnpdata_8c.html#a24">PnpAsyncOk</a>;
01074 
01075 <span class="comment">//</span>
01076 <span class="comment">// IopPendingEjects - List of pending eject requests</span>
01077 <span class="comment">//</span>
<a name="l01078"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a162">01078</a> <span class="keyword">extern</span> LIST_ENTRY  <a class="code" href="../../d1/d0/pnpdata_8c.html#a26">IopPendingEjects</a>;
01079 
01080 <span class="comment">//</span>
01081 <span class="comment">// IopPendingSurpriseRemovals - List of pending surprise removal requests</span>
01082 <span class="comment">//</span>
<a name="l01083"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a163">01083</a> <span class="keyword">extern</span> LIST_ENTRY  <a class="code" href="../../d1/d0/pnpdata_8c.html#a27">IopPendingSurpriseRemovals</a>;
01084 
01085 
01086 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01087 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a3">IopAppendStringToValueKey</a> (
01088     IN HANDLE Handle,
01089     IN PWSTR ValueName,
01090     IN PUNICODE_STRING String,
01091     IN BOOLEAN Create
01092     );
01093 
01094 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01095 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a5">IopPrepareDriverLoading</a> (
01096     IN PUNICODE_STRING KeyName,
01097     IN HANDLE KeyHandle,
01098     IN PIMAGE_NT_HEADERS Header
01099     );
01100 
01101 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01102 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a2">IopRemoveStringFromValueKey</a> (
01103     IN HANDLE Handle,
01104     IN PWSTR ValueName,
01105     IN PUNICODE_STRING String
01106     );
01107 
01108 BOOLEAN
01109 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a16">IopIsDuplicatedDevices</a>(
01110     IN PCM_RESOURCE_LIST Configuration1,
01111     IN PCM_RESOURCE_LIST Configuration2,
01112     IN <a class="code" href="../../d6/d2/struct__HAL__BUS__INFORMATION.html">PHAL_BUS_INFORMATION</a> BusInfo1 OPTIONAL,
01113     IN <a class="code" href="../../d6/d2/struct__HAL__BUS__INFORMATION.html">PHAL_BUS_INFORMATION</a> BusInfo2 OPTIONAL
01114     );
01115 
01116 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01117 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a15">IopMarkDuplicateDevice</a>(
01118     IN PUNICODE_STRING TargetKeyName,
01119     IN ULONG TargetInstance,
01120     IN PUNICODE_STRING SourceKeyName,
01121     IN ULONG SourceInstance
01122     );
01123 
01124 BOOLEAN
01125 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a4">IopConcatenateUnicodeStrings</a> (
01126     OUT PUNICODE_STRING Destination,
01127     IN  PUNICODE_STRING String1,
01128     IN  PUNICODE_STRING String2  OPTIONAL
01129     );
01130 
01131 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01132 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a6">IopServiceInstanceToDeviceInstance</a> (
01133     IN  HANDLE ServiceKeyHandle OPTIONAL,
01134     IN  PUNICODE_STRING ServiceKeyName OPTIONAL,
01135     IN  ULONG ServiceInstanceOrdinal,
01136     OUT PUNICODE_STRING DeviceInstanceRegistryPath OPTIONAL,
01137     OUT PHANDLE DeviceInstanceHandle OPTIONAL,
01138     IN  ACCESS_MASK DesiredAccess
01139     );
01140 
01141 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01142 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a8">IopCreateRegistryKeyEx</a>(
01143     OUT PHANDLE Handle,
01144     IN HANDLE BaseHandle OPTIONAL,
01145     IN PUNICODE_STRING KeyName,
01146     IN ACCESS_MASK DesiredAccess,
01147     IN ULONG CreateOptions,
01148     OUT PULONG Disposition OPTIONAL
01149     );
01150 
01151 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01152 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a7">IopOpenRegistryKeyEx</a>(
01153     OUT PHANDLE Handle,
01154     IN HANDLE BaseHandle OPTIONAL,
01155     IN PUNICODE_STRING KeyName,
01156     IN ACCESS_MASK DesiredAccess
01157     );
01158 
01159 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01160 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a1">IopCreateMadeupNode</a>(
01161     IN PUNICODE_STRING ServiceKeyName,
01162     OUT PHANDLE ReturnedHandle,
01163     OUT PUNICODE_STRING KeyName,
01164     OUT PULONG InstanceOrdinal,
01165     IN BOOLEAN ResourceOwned
01166     );
01167 
01168 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01169 <a class="code" href="../../d9/d0/pnpiop_8h.html#a237">IopInitializePlugPlayServices</a>(
01170     IN <a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock,
01171     IN ULONG Phase
01172     );
01173 
01174 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01175 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a8">IopOpenServiceEnumKeys</a> (
01176     IN PUNICODE_STRING ServiceKeyName,
01177     IN ACCESS_MASK DesiredAccess,
01178     OUT PHANDLE ServiceHandle OPTIONAL,
01179     OUT PHANDLE ServiceEnumHandle OPTIONAL,
01180     IN BOOLEAN CreateEnum
01181     );
01182 
01183 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01184 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a11">IopOpenCurrentHwProfileDeviceInstanceKey</a>(
01185     OUT PHANDLE Handle,
01186     IN  PUNICODE_STRING ServiceKeyName,
01187     IN  ULONG Instance,
01188     IN  ACCESS_MASK DesiredAccess,
01189     IN  BOOLEAN Create
01190     );
01191 
01192 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01193 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a9">IopGetDeviceInstanceCsConfigFlags</a>(
01194     IN PUNICODE_STRING DeviceInstance,
01195     OUT PULONG CsConfigFlags
01196     );
01197 
01198 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01199 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a11">IopGetServiceInstanceCsConfigFlags</a>(
01200     IN PUNICODE_STRING ServiceKeyName,
01201     IN ULONG Instance,
01202     OUT PULONG CsConfigFlags
01203     );
01204 
01205 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01206 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a12">IopSetServiceInstanceCsConfigFlags</a>(
01207     IN PUNICODE_STRING ServiceKeyName,
01208     IN ULONG Instance,
01209     IN ULONG CsConfigFlags
01210     );
01211 
01212 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01213 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a12">IopApplyFunctionToSubKeys</a>(
01214     IN HANDLE BaseHandle OPTIONAL,
01215     IN PUNICODE_STRING KeyName,
01216     IN ACCESS_MASK DesiredAccess,
01217     IN ULONG Flags,
01218     IN PIOP_SUBKEY_CALLBACK_ROUTINE SubKeyCallbackRoutine,
01219     IN OUT PVOID Context
01220     );
01221 
01222 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01223 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a13">IopRegMultiSzToUnicodeStrings</a>(
01224     IN PKEY_VALUE_FULL_INFORMATION KeyValueInformation,
01225     IN PUNICODE_STRING *UnicodeStringList,
01226     OUT PULONG UnicodeStringCount
01227     );
01228 
01229 
01230 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01231 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a14">IopApplyFunctionToServiceInstances</a>(
01232     IN HANDLE ServiceKeyHandle OPTIONAL,
01233     IN PUNICODE_STRING ServiceKeyName OPTIONAL,
01234     IN ACCESS_MASK DesiredAccess,
01235     IN BOOLEAN IgnoreNonCriticalErrors,
01236     IN PIOP_SUBKEY_CALLBACK_ROUTINE DevInstCallbackRoutine,
01237     IN OUT PVOID Context,
01238     OUT PULONG ServiceInstanceOrdinal OPTIONAL
01239     );
01240 
01241 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01242 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a17">IopFreeUnicodeStringList</a>(
01243     IN PUNICODE_STRING UnicodeStringList,
01244     IN ULONG StringCount
01245     );
01246 
01247 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01248 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a18">IopDriverLoadingFailed</a>(
01249     IN HANDLE KeyHandle OPTIONAL,
01250     IN PUNICODE_STRING KeyName OPTIONAL
01251     );
01252 
01253 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01254 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a27">IopReadDeviceConfiguration</a> (
01255     IN HANDLE Handle,
01256     IN ULONG Flags,
01257     OUT PCM_RESOURCE_LIST *CmResource,
01258     OUT PULONG Length
01259     );
01260 
01261 BOOLEAN
01262 <a class="code" href="../../d9/d0/pnpiop_8h.html#a249">IopIsFirmwareMapperDevicePresent</a> (
01263     IN HANDLE KeyHandle
01264     );
01265 
<a name="l01266"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a95">01266</a> <span class="preprocessor">#define IopAcquireEnumerationLock(_devnode_)                        \</span>
01267 <span class="preprocessor">    ExAcquireResourceShared(&amp;IopDeviceTreeLock, TRUE);              \</span>
01268 <span class="preprocessor">    if ((_devnode_)) {                                              \</span>
01269 <span class="preprocessor">        KeWaitForSingleObject( &amp;((PDEVICE_NODE)(_devnode_))-&gt;EnumerationMutex,      \</span>
01270 <span class="preprocessor">                               Executive,                           \</span>
01271 <span class="preprocessor">                               KernelMode,                          \</span>
01272 <span class="preprocessor">                               FALSE,                               \</span>
01273 <span class="preprocessor">                               NULL );                              \</span>
01274 <span class="preprocessor">    }</span>
01275 <span class="preprocessor"></span>
<a name="l01276"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a96">01276</a> <span class="preprocessor">#define IopReleaseEnumerationLock(_devnode_)                        \</span>
01277 <span class="preprocessor">    if ((_devnode_)) {                                              \</span>
01278 <span class="preprocessor">        KeSetEvent( &amp;((PDEVICE_NODE)(_devnode_))-&gt;EnumerationMutex, \</span>
01279 <span class="preprocessor">                    0,                                              \</span>
01280 <span class="preprocessor">                    FALSE );                                        \</span>
01281 <span class="preprocessor">    }                                                               \</span>
01282 <span class="preprocessor">    ExReleaseResource(&amp;IopDeviceTreeLock);</span>
01283 <span class="preprocessor"></span>
01284 
<a name="l01285"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a97">01285</a> <span class="preprocessor">#define IopReleaseEnumerationLockForThread(_devnode_, _thread_)     \</span>
01286 <span class="preprocessor">    if ((_devnode_)) {                                              \</span>
01287 <span class="preprocessor">        KeSetEvent( &amp;((PDEVICE_NODE)(_devnode_))-&gt;EnumerationMutex, \</span>
01288 <span class="preprocessor">                    0,                                              \</span>
01289 <span class="preprocessor">                    FALSE );                                        \</span>
01290 <span class="preprocessor">    }                                                               \</span>
01291 <span class="preprocessor">    ExReleaseResourceForThreadLite(&amp;IopDeviceTreeLock, _thread_);</span>
01292 <span class="preprocessor"></span>
<a name="l01293"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a98">01293</a> <span class="preprocessor">#define IopAcquireDeviceTreeLock() ExAcquireResourceExclusive(&amp;IopDeviceTreeLock, TRUE)</span>
<a name="l01294"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a99">01294</a> <span class="preprocessor"></span><span class="preprocessor">#define IopReleaseDeviceTreeLock() ExReleaseResource(&amp;IopDeviceTreeLock)</span>
01295 <span class="preprocessor"></span>
01296 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01297 <a class="code" href="../../d9/d0/pnpiop_8h.html#a250">IopInsertTreeDeviceNode</a> (
01298     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>     ParentNode,
01299     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>     DeviceNode
01300     );
01301 
01302 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01303 <a class="code" href="../../d9/d0/pnpiop_8h.html#a251">IopRemoveTreeDeviceNode</a> (
01304     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>     DeviceNode
01305     );
01306 
01307 <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>
01308 <a class="code" href="../../d9/d0/pnpiop_8h.html#a252">IopAllocateDeviceNode</a>(
01309     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> PhysicalDeviceObject
01310     );
01311 
01312 <span class="preprocessor">#if DBG</span>
01313 <span class="preprocessor"></span><a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01314 IopCheckDeviceNodeTree (
01315     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> TargetDevice OPTIONAL,
01316     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>   TargetNode OPTIONAL
01317     );
01318 <span class="preprocessor">#endif</span>
01319 <span class="preprocessor"></span>
01320 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01321 <a class="code" href="../../d9/d0/pnpiop_8h.html#a253">IopForAllDeviceNodes</a>(
01322     IN PENUM_CALLBACK Callback,
01323     IN PVOID Context
01324     );
01325 
01326 ULONG
01327 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a21">IopDetermineResourceListSize</a>(
01328     IN PCM_RESOURCE_LIST ResourceList
01329     );
01330 
01331 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01332 <a class="code" href="../../d9/d0/pnpiop_8h.html#a255">IopQueryDeviceConfigurationVector</a>(
01333     IN PUNICODE_STRING ServiceKeyName,
01334     IN ULONG InstanceOrdinal,
01335     OUT PULONG DeviceInstanceFlags,
01336     OUT PIO_RESOURCE_REQUIREMENTS_LIST ConfigurationVector,
01337     IN ULONG BufferSize,
01338     OUT PULONG ActualBufferSize
01339     );
01340 
01341 <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>
01342 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a22">IopReferenceDriverObjectByName</a> (
01343     IN PUNICODE_STRING DriverName
01344     );
01345 
01346 <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>
01347 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a23">IopDeviceObjectFromDeviceInstance</a> (
01348     IN HANDLE DeviceInstanceHandle      OPTIONAL,
01349     IN PUNICODE_STRING DeviceInstance   OPTIONAL
01350     );
01351 
01352 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01353 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a24">IopDeviceObjectToDeviceInstance</a> (
01354     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01355     IN PHANDLE DeviceInstanceHandle,
01356     IN  ACCESS_MASK DesiredAccess
01357     );
01358 
01359 BOOLEAN
01360 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a20">IopIsDeviceInstanceEnabled</a>(
01361     IN HANDLE DeviceInstanceHandle,
01362     IN PUNICODE_STRING DeviceInstance,
01363     IN BOOLEAN DisableIfEnabled
01364     );
01365 
01366 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01367 <a class="code" href="../../d9/d0/pnpiop_8h.html#a260">IopAddDevicesToBootDriver</a> (
01368    IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject
01369    );
01370 
01371 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>
01372 <a class="code" href="../../d9/d0/pnpiop_8h.html#a261">IopProcessAddDevices</a> (
01373    IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01374    IN USHORT StartOrder,
01375    IN ULONG DriverStartType
01376    );
01377 
01378 BOOLEAN
01379 <a class="code" href="../../d9/d0/pnpiop_8h.html#a262">IopProcessAssignResources</a> (
01380    IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01381    IN BOOLEAN Reallocation,
01382    IN BOOLEAN BootConfigsOK
01383    );
01384 
01385 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01386 <a class="code" href="../../d9/d0/pnpiop_8h.html#a263">IopProcessStartDevices</a> (
01387    IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01388    IN PSTART_CONTEXT StartContext
01389    );
01390 
01391 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01392 <a class="code" href="../../d0/d1/pnpirp_8c.html#a19">IopStartDevice</a> (
01393     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> TargetDevice
01394     );
01395 
01396 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01397 <a class="code" href="../../d0/d1/pnpirp_8c.html#a20">IopEjectDevice</a>(
01398     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01399     <a class="code" href="../../d8/d4/struct__PENDING__RELATIONS__LIST__ENTRY.html">PPENDING_RELATIONS_LIST_ENTRY</a> PendingEntry
01400     );
01401 
01402 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01403 <a class="code" href="../../d0/d1/pnpirp_8c.html#a21">IopRemoveDevice</a> (
01404     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> TargetDevice,
01405     IN ULONG IrpMinorCode
01406     );
01407 
01408 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01409 <a class="code" href="../../d0/d1/pnpirp_8c.html#a22">IopQueryDeviceRelations</a>(
01410     IN DEVICE_RELATION_TYPE Relations,
01411     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01412     IN BOOLEAN AsyncOk,
01413     OUT <a class="code" href="../../d0/d5/struct__DEVICE__RELATIONS.html">PDEVICE_RELATIONS</a> *DeviceRelations
01414     );
01415 
01416 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01417 <a class="code" href="../../d0/d1/pnpirp_8c.html#a32">IopQueryDeviceState</a>(
01418     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
01419     );
01420 
01421 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01422 <a class="code" href="../../d0/d1/pnpirp_8c.html#a35">IopQueryDeviceSerialNumber</a> (
01423     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01424     OUT PWCHAR *SerialNumber
01425     );
01426 
01427 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01428 <a class="code" href="../../d9/d0/pnpiop_8h.html#a270">IopForAllChildDeviceNodes</a>(
01429     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> Parent,
01430     IN PENUM_CALLBACK Callback,
01431     IN PVOID Context
01432     );
01433 
01434 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01435 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a25">IopCleanupDeviceRegistryValues</a> (
01436     IN PUNICODE_STRING InstancePath,
01437     IN BOOLEAN KeepReference
01438     );
01439 
01440 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01441 <a class="code" href="../../d0/d1/pnpirp_8c.html#a23">IopQueryDeviceId</a> (
01442     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01443     OUT PWCHAR *DeviceId
01444     );
01445 
01446 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01447 <a class="code" href="../../d0/d1/pnpirp_8c.html#a24">IopQueryUniqueId</a> (
01448     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01449     OUT PWCHAR *UniqueId
01450     );
01451 
01452 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01453 <a class="code" href="../../d0/d1/pnpirp_8c.html#a25">IopMakeGloballyUniqueId</a>(
01454     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01455     IN PWCHAR           UniqueId,
01456     OUT PWCHAR         *GloballyUniqueId
01457     );
01458 
01459 
01460 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01461 <a class="code" href="../../d0/d1/pnpirp_8c.html#a26">IopQueryCompatibleIds</a> (
01462     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01463     IN BUS_QUERY_ID_TYPE IdType,
01464     OUT PWCHAR *CompatibleIds,
01465     OUT ULONG *Length
01466     );
01467 
01468 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01469 <a class="code" href="../../d0/d1/pnpirp_8c.html#a27">IopQueryDeviceResources</a> (
01470     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01471     IN ULONG ResourceType,
01472     OUT PVOID *Resource,
01473     OUT ULONG *Length
01474     );
01475 
01476 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01477 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a26">IopGetDeviceResourcesFromRegistry</a> (
01478     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01479     IN ULONG ResourceType,
01480     IN ULONG Preference,
01481     OUT PVOID *Resource,
01482     OUT PULONG Length
01483     );
01484 
01485 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01486 <a class="code" href="../../d9/d0/pnpiop_8h.html#a278">IopResourceRequirementsChanged</a>(
01487     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> PhysicalDeviceObject,
01488     IN BOOLEAN StopRequired
01489     );
01490 
01491 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01492 <a class="code" href="../../d9/d0/pnpiop_8h.html#a279">IopReleaseDeviceResources</a> (
01493     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01494     IN BOOLEAN  ReserveResources
01495     );
01496 
01497 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01498 <a class="code" href="../../d9/d0/pnpiop_8h.html#a280">IopPnPAddDevice</a>(
01499     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject,
01500     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
01501     );
01502 
01503 BOOLEAN
01504 <a class="code" href="../../d9/d0/pnpiop_8h.html#a281">IopProcessCriticalDevice</a>(
01505     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01506     );
01507 
01508 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01509 <a class="code" href="../../d9/d0/pnpiop_8h.html#a282">IopPnPDispatch</a>(
01510     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01511     IN OUT <a class="code" href="../../d0/d2/struct__IRP.html">PIRP</a> Irp
01512     );
01513 
01514 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01515 <a class="code" href="../../d9/d0/pnpiop_8h.html#a283">IopPowerDispatch</a>(
01516     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01517     IN OUT <a class="code" href="../../d0/d2/struct__IRP.html">PIRP</a> Irp
01518     );
01519 
01520 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01521 <a class="code" href="../../d9/d0/pnpiop_8h.html#a284">IopDestroyDeviceNode</a> (
01522     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01523     );
01524 
01525 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01526 <a class="code" href="../../d9/d0/pnpiop_8h.html#a285">IopStartAndEnumerateDevice</a>(
01527     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01528     IN PSTART_CONTEXT StartContext
01529     );
01530 
01531 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01532 <a class="code" href="../../d9/d0/pnpiop_8h.html#a286">IopCallDriverAddDevice</a> (
01533     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01534     IN BOOLEAN LoadDriver,
01535     IN PADD_CONTEXT AddContext
01536     );
01537 
01538 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01539 <a class="code" href="../../d9/d0/pnpiop_8h.html#a287">IopStartDriverDevices</a>(
01540     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject
01541     );
01542 
01543 BOOLEAN
01544 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a32">IopIsLegacyDriver</a> (
01545     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject
01546     );
01547 
01548 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01549 <a class="code" href="../../d9/d0/pnpiop_8h.html#a289">IopNewDevice</a>(
01550     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
01551     );
01552 
01553 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01554 <a class="code" href="../../d9/d0/pnpiop_8h.html#a290">IopProcessNewDeviceNode</a>(
01555     IN OUT <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01556     );
01557 
01558 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01559 <a class="code" href="../../d0/d1/pnpirp_8c.html#a18">IopSynchronousCall</a>(
01560     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01561     IN <a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a> TopStackLocation,
01562     OUT PVOID *Information
01563     );
01564 
01565 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01566 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a29">IopFilterResourceRequirementsList</a> (
01567     IN PIO_RESOURCE_REQUIREMENTS_LIST IoList,
01568     IN PCM_RESOURCE_LIST CmList,
01569     IN OUT PIO_RESOURCE_REQUIREMENTS_LIST *FilteredList,
01570     OUT PBOOLEAN ExactMatch
01571     );
01572 
01573 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01574 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a30">IopMergeFilteredResourceRequirementsList</a> (
01575     IN PIO_RESOURCE_REQUIREMENTS_LIST IoList1,
01576     IN PIO_RESOURCE_REQUIREMENTS_LIST IoList2,
01577     IN OUT PIO_RESOURCE_REQUIREMENTS_LIST *MergedList
01578     );
01579 
01580 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01581 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a31">IopMergeCmResourceLists</a> (
01582     IN PCM_RESOURCE_LIST List1,
01583     IN PCM_RESOURCE_LIST List2,
01584     IN OUT PCM_RESOURCE_LIST *MergedList
01585     );
01586 
01587 PIO_RESOURCE_REQUIREMENTS_LIST
01588 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a28">IopCmResourcesToIoResources</a> (
01589     IN ULONG SlotNumber,
01590     IN PCM_RESOURCE_LIST CmResourceList,
01591     IN ULONG Priority
01592     );
01593 
01594 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01595 <a class="code" href="../../d9/d0/pnpiop_8h.html#a296">IopReportResourceListToPnp</a>(
01596     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject OPTIONAL,
01597     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject OPTIONAL,
01598     IN PCM_RESOURCE_LIST ResourceList,
01599     IN ULONG ListSize,
01600     IN BOOLEAN Translated
01601     );
01602 
01603 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01604 <a class="code" href="../../d5/d1/pnpres_8c.html#a105">IopAllocateResources</a>(
01605     IN PULONG DeviceCountP,
01606     IN OUT PIOP_RESOURCE_REQUEST *AssignTablePP,
01607     IN BOOLEAN Locked,
01608     IN BOOLEAN BootConfigsOK
01609     );
01610 
01611 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01612 <a class="code" href="../../d5/d1/pnpres_8c.html#a113">IopReallocateResources</a>(
01613     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
01614     );
01615 
01616 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01617 <a class="code" href="../../d1/d8/report_8c.html#a15">IopWriteResourceList</a>(
01618     IN HANDLE ResourceMapKey,
01619     IN PUNICODE_STRING ClassName,
01620     IN PUNICODE_STRING DriverName,
01621     IN PUNICODE_STRING DeviceName,
01622     IN PCM_RESOURCE_LIST ResourceList,
01623     IN ULONG ResourceListSize
01624     );
01625 
01626 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01627 <a class="code" href="../../d9/d0/pnpiop_8h.html#a300">IopRemoveResourceListFromPnp</a>(
01628     IN PLIST_ENTRY ResourceList
01629     );
01630 
01631 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01632 <a class="code" href="../../d9/d0/pnpiop_8h.html#a301">IopWriteAllocatedResourcesToRegistry</a> (
01633     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01634     IN PCM_RESOURCE_LIST ResourceList,
01635     IN ULONG Length
01636     );
01637 
01638 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>
01639 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a33">IopGetGroupOrderIndex</a> (
01640     IN HANDLE ServiceHandle
01641     );
01642 
01643 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01644 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a34">IopDeleteLegacyKey</a>(
01645     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject
01646     );
01647 
01648 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01649 <a class="code" href="../../d9/d0/pnpiop_8h.html#a304">IopOpenDeviceParametersSubkey</a>(
01650     OUT HANDLE *ParamKeyHandle,
01651     IN  HANDLE ParentKeyHandle,
01652     IN  PUNICODE_STRING SubKeyString,
01653     IN  ACCESS_MASK DesiredAccess
01654     );
01655 
01656 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01657 <a class="code" href="../../d9/d0/pnpiop_8h.html#a305">IopRequestDeviceAction</a>(
01658     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject              OPTIONAL,
01659     IN DEVICE_REQUEST_TYPE RequestType,
01660     IN <a class="code" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> CompletionEvent                  OPTIONAL,
01661     IN PNTSTATUS CompletionStatus               OPTIONAL
01662     );
01663 
01664 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01665 <a class="code" href="../../d9/d0/pnpiop_8h.html#a306">IopRequestDeviceRemoval</a>(
01666     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01667     IN ULONG Problem
01668     );
01669 
01670 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01671 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a36">IopRestartDeviceNode</a>(
01672     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01673     );
01674 
01675 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01676 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a41">IopDeleteKeyRecursive</a>(
01677     IN HANDLE SubKeyHandle,
01678     IN PWCHAR SubKeyName
01679     );
01680 
01681 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01682 <a class="code" href="../../d0/d1/pnpirp_8c.html#a31">IopQueryPnpBusInformation</a> (
01683     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01684     OUT LPGUID InterfaceGuid           OPTIONAL,
01685     OUT INTERFACE_TYPE *InterfaceType  OPTIONAL,
01686     OUT ULONG *BusNumber               OPTIONAL
01687     );
01688 
01689 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01690 <a class="code" href="../../d0/d1/pnpirp_8c.html#a30">IopQueryLegacyBusInformation</a> (
01691     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01692     OUT LPGUID InterfaceGuid           OPTIONAL,
01693     OUT INTERFACE_TYPE *InterfaceType  OPTIONAL,
01694     OUT ULONG *BusNumber               OPTIONAL
01695     );
01696 
01697 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01698 <a class="code" href="../../d9/d0/pnpiop_8h.html#a311">IopGetRootDevices</a> (
01699     <a class="code" href="../../d0/d5/struct__DEVICE__RELATIONS.html">PDEVICE_RELATIONS</a> *DeviceRelations
01700     );
01701 
01702 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01703 <a class="code" href="../../d9/d0/pnpiop_8h.html#a312">IopLockDeviceRemovalRelations</a>(
01704     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01705     IN PLUGPLAY_DEVICE_DELETE_TYPE OperationCode,
01706     OUT <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a> *RelationsList,
01707     IN BOOLEAN IsKernelInitiated
01708     );
01709 
01710 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01711 <a class="code" href="../../d9/d0/pnpiop_8h.html#a313">IopDeleteLockedDeviceNodes</a>(
01712     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01713     IN <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a> RelationsList,
01714     IN PLUGPLAY_DEVICE_DELETE_TYPE OperationCode,
01715     IN BOOLEAN IsKernelInitiated,
01716     IN BOOLEAN ProcessIndirectDescendants,
01717     IN ULONG Problem,
01718     OUT <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> *VetoingDevice OPTIONAL
01719     );
01720 
01721 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01722 <a class="code" href="../../d9/d0/pnpiop_8h.html#a314">IopUnlockDeviceRemovalRelations</a>(
01723     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>       DeviceObject,
01724     IN <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a>       RelationsList,
01725     IN UNLOCK_UNLINK_ACTION UnlinkAction
01726     );
01727 
01728 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01729 <a class="code" href="../../d9/d0/pnpiop_8h.html#a315">IopInvalidateRelationsInList</a>(
01730     <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a> RelationsList,
01731     BOOLEAN OnlyIndirectDescendants,
01732     BOOLEAN UnlockDevNode,
01733     BOOLEAN RestartDevNode
01734     );
01735 
01736 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01737 <a class="code" href="../../d9/d0/pnpiop_8h.html#a316">IopChainDereferenceComplete</a>(
01738     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> PhysicalDeviceObject
01739     );
01740 
01741 BOOLEAN
01742 <a class="code" href="../../d9/d0/pnpiop_8h.html#a317">IopQueuePendingEject</a>(
01743     <a class="code" href="../../d8/d4/struct__PENDING__RELATIONS__LIST__ENTRY.html">PPENDING_RELATIONS_LIST_ENTRY</a> Entry
01744     );
01745 
01746 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01747 <a class="code" href="../../d9/d0/pnpiop_8h.html#a318">IopProcessCompletedEject</a>(
01748     IN PVOID Context
01749     );
01750 
01751 BOOLEAN
01752 <a class="code" href="../../d9/d0/pnpiop_8h.html#a319">IopQueuePendingSurpriseRemoval</a>(
01753     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01754     IN <a class="code" href="../../d6/d3/struct__RELATION__LIST.html">PRELATION_LIST</a> List,
01755     IN ULONG Problem
01756     );
01757 
01758 BOOLEAN
01759 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a19">IopIsAnyDeviceInstanceEnabled</a>(
01760     IN PUNICODE_STRING ServiceKeyName,
01761     IN HANDLE ServiceHandle,
01762     IN BOOLEAN LegacyIncluded
01763     );
01764 
01765 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01766 <a class="code" href="../../d0/d1/pnpirp_8c.html#a28">IopQueryResourceHandlerInterface</a>(
01767     IN RESOURCE_HANDLER_TYPE HandlerType,
01768     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01769     IN UCHAR ResourceType,
01770     IN OUT PVOID *Interface
01771     );
01772 
01773 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01774 <a class="code" href="../../d0/d1/pnpirp_8c.html#a29">IopQueryReconfiguration</a>(
01775     IN UCHAR Request,
01776     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
01777     );
01778 
01779 <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>
01780 <a class="code" href="../../d5/d1/pnpres_8c.html#a108">IopFindBusDeviceNode</a> (
01781     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01782     IN INTERFACE_TYPE InterfaceType,
01783     IN ULONG BusNumber,
01784     IN ULONG SlotNumber
01785     );
01786 
01787 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01788 <a class="code" href="../../d5/d1/pnpres_8c.html#a107">IopLegacyResourceAllocation</a> (
01789     IN ARBITER_REQUEST_SOURCE AllocationType,
01790     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject,
01791     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01792     IN PIO_RESOURCE_REQUIREMENTS_LIST ResourceRequirements,
01793     IN OUT PCM_RESOURCE_LIST *AllocatedResources OPTIONAL
01794     );
01795 
01796 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01797 <a class="code" href="../../d1/d8/report_8c.html#a14">IoReportResourceUsageInternal</a>(
01798     IN ARBITER_REQUEST_SOURCE AllocationType,
01799     IN PUNICODE_STRING DriverClassName OPTIONAL,
01800     IN <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject,
01801     IN PCM_RESOURCE_LIST DriverList OPTIONAL,
01802     IN ULONG DriverListSize OPTIONAL,
01803     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject OPTIONAL,
01804     IN PCM_RESOURCE_LIST DeviceList OPTIONAL,
01805     IN ULONG DeviceListSize OPTIONAL,
01806     IN BOOLEAN OverrideConflict,
01807     OUT PBOOLEAN ConflictDetected
01808     );
01809 
01810 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01811 <a class="code" href="../../d5/d1/pnpres_8c.html#a109">IopDuplicateDetection</a> (
01812     IN INTERFACE_TYPE LegacyBusType,
01813     IN ULONG BusNumber,
01814     IN ULONG SlotNumber,
01815     OUT <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> *DeviceNode
01816     );
01817 
01818 <span class="preprocessor">#if 0</span>
01819 <span class="preprocessor"></span><a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01820 IopTranslateResourceList(
01821     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode   OPTIONAL,
01822     IN PCM_RESOURCE_LIST ResourceList,
01823     OUT PCM_RESOURCE_LIST *TranslatedList
01824     );
01825 <span class="preprocessor">#endif</span>
01826 <span class="preprocessor"></span>
01827 <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>
01828 <a class="code" href="../../d9/d0/pnpiop_8h.html#a327">IopLoadBootFilterDriver</a> (
01829     IN PUNICODE_STRING DriverName,
01830     IN ULONG GroupIndex
01831     );
01832 
01833 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01834 <a class="code" href="../../d9/d1/pnpsubs_8c.html#a37">IopDeviceNodeCapabilitiesToRegistry</a> (
01835     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01836     );
01837 
01838 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01839 <a class="code" href="../../d0/d2/pri__bld_2pnpsubs_8c.html#a35">IopDeviceCapabilitiesToRegistry</a> (
01840     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01841     IN <a class="code" href="../../d3/d3/struct__DEVICE__CAPABILITIES.html">PDEVICE_CAPABILITIES</a> Capabilities
01842     );
01843 
01844 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01845 <a class="code" href="../../d9/d0/pnpiop_8h.html#a330">IopQueryDeviceCapabilities</a>(
01846     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
01847     OUT <a class="code" href="../../d3/d3/struct__DEVICE__CAPABILITIES.html">PDEVICE_CAPABILITIES</a> Capabilities
01848     );
01849 
01850 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01851 <a class="code" href="../../d0/d1/pnpirp_8c.html#a33">IopIncDisableableDepends</a>(
01852     IN OUT <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01853     );
01854 
01855 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01856 <a class="code" href="../../d0/d1/pnpirp_8c.html#a34">IopDecDisableableDepends</a>(
01857     IN OUT <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
01858     );
01859 
01860 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01861 <a class="code" href="../../d0/d1/pnpirp_8c.html#a36">IopQueryDockRemovalInterface</a>(
01862     IN      <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>  DeviceObject,
01863     IN OUT  PDOCK_INTERFACE *DockInterface
01864     );
01865 
01866 <span class="preprocessor">#ifndef FIELD_SIZE</span>
<a name="l01867"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a100">01867</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SIZE(type, field) (sizeof(((type *)0)-&gt;field))</span>
01868 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01869 <span class="preprocessor"></span>
<a name="l01870"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a101">01870</a> <span class="preprocessor">#define IopDeviceNodeFlagsToCapabilities(DeviceNode) \</span>
01871 <span class="preprocessor">     ((PDEVICE_CAPABILITIES) (((PUCHAR) (&amp;(DeviceNode)-&gt;CapabilityFlags)) - \</span>
01872 <span class="preprocessor">                              FIELD_OFFSET(DEVICE_CAPABILITIES, Version) - \</span>
01873 <span class="preprocessor">                              FIELD_SIZE(DEVICE_CAPABILITIES, Version)))</span>
01874 <span class="preprocessor"></span>
01875 <span class="keyword">typedef</span>
01876 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01877"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a164">01877</a> (*PIO_RESERVE_RESOURCES_ROUTINE) (
01878     IN <a class="code" href="../../d6/d9/pnp_8h.html#a58">ARBITER_REQUEST_SOURCE</a> ArbiterRequestSource,
01879     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01880     IN PCM_RESOURCE_LIST BootResources
01881     );
01882 
01883 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01884 <a class="code" href="../../d5/d1/pnpres_8c.html#a112">IopReserveBootResources</a> (
01885     IN ARBITER_REQUEST_SOURCE ArbiterRequestSource,
01886     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01887     IN PCM_RESOURCE_LIST BootResources
01888     );
01889 
01890 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01891 <a class="code" href="../../d5/d1/pnpres_8c.html#a111">IopAllocateBootResources</a> (
01892     IN ARBITER_REQUEST_SOURCE ArbiterRequestSource,
01893     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
01894     IN PCM_RESOURCE_LIST BootResources
01895     );
01896 
01897 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01898 <a class="code" href="../../d5/d1/pnpres_8c.html#a110">IopReserveLegacyBootResources</a>(
01899     IN INTERFACE_TYPE InterfaceType,
01900     IN ULONG BusNumber
01901     );
01902 
<a name="l01903"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a165">01903</a> <span class="keyword">extern</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a164">PIO_RESERVE_RESOURCES_ROUTINE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a20">IopReserveResourcesRoutine</a>;
01904 
01905 <span class="comment">//</span>
01906 <span class="comment">// Conflict detection declarations</span>
01907 <span class="comment">//</span>
01908 
01909 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01910 <a class="code" href="../../d5/d1/pnpres_8c.html#a114">IopQueryConflictList</a>(
01911     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>        PhysicalDeviceObject,
01912     IN PCM_RESOURCE_LIST  ResourceList,
01913     IN ULONG              ResourceListSize,
01914     OUT PPLUGPLAY_CONTROL_CONFLICT_LIST ConflictList,
01915     IN ULONG              ConflictListSize,
01916     IN ULONG              Flags
01917     );
01918 
01919 <span class="comment">//</span>
01920 <span class="comment">// Firmware mapper external declarations.</span>
01921 <span class="comment">//</span>
01922 
01923 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01924 <a class="code" href="../../d9/d0/pnpiop_8h.html#a338">MapperProcessFirmwareTree</a>(
01925     IN BOOLEAN OnlyProcessSerialPorts
01926     );
01927 
01928 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01929 <a class="code" href="../../d9/d0/pnpiop_8h.html#a339">MapperConstructRootEnumTree</a>(
01930     IN BOOLEAN CreatePhantomDevices
01931     );
01932 
01933 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01934 <a class="code" href="../../d9/d0/pnpiop_8h.html#a340">MapperFreeList</a>(
01935     VOID
01936     );
01937 
01938 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01939 <a class="code" href="../../d9/d0/pnpiop_8h.html#a341">EisaBuildEisaDeviceNode</a>(
01940     VOID
01941     );
01942 
01943 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01944 <a class="code" href="../../d9/d0/pnpiop_8h.html#a342">MapperPhantomizeDetectedComPorts</a>(
01945     VOID
01946     );
01947 <span class="comment">//</span>
01948 <span class="comment">// BUGBUG- for now we need the following dbg routines in free build also such</span>
01949 <span class="comment">//         that we can track resource allocation by enabling a dbg flag.</span>
01950 <span class="comment">//#if DBG</span>
01951 
01952 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01953 <a class="code" href="../../d1/d8/report_8c.html#a17">IopDumpCmResourceList</a> (
01954     IN PCM_RESOURCE_LIST CmList
01955     );
01956 
01957 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01958 <a class="code" href="../../d1/d8/report_8c.html#a16">IopDumpCmResourceDescriptor</a> (
01959     IN PUCHAR Indent,
01960     IN PCM_PARTIAL_RESOURCE_DESCRIPTOR Desc
01961     );
01962 
01963 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01964 <a class="code" href="../../d9/d0/pnpiop_8h.html#a345">IopDumpAllocatedSystemResources</a>(
01965     IN UCHAR ResourceType
01966     );
01967 
01968 <span class="comment">// #endif</span>
01969 
01970 <span class="comment">//</span>
01971 <span class="comment">// General utility macros</span>
01972 <span class="comment">//</span>
01973 
01974 <span class="comment">//</span>
01975 <span class="comment">// This macros calculates the size in bytes of a constant string</span>
01976 <span class="comment">//</span>
01977 <span class="comment">//  ULONG</span>
01978 <span class="comment">//  IopConstStringSize(</span>
01979 <span class="comment">//      IN CONST PWSTR String</span>
01980 <span class="comment">//      );</span>
01981 <span class="comment">//</span>
01982 
<a name="l01983"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a102">01983</a> <span class="preprocessor">#define IopConstStringSize(String)          ( sizeof(String) - sizeof(UNICODE_NULL) )</span>
01984 <span class="preprocessor"></span>
01985 <span class="comment">//</span>
01986 <span class="comment">// This macros calculates the number of characters of a constant string</span>
01987 <span class="comment">//</span>
01988 <span class="comment">//  ULONG</span>
01989 <span class="comment">//  IopConstStringLength(</span>
01990 <span class="comment">//      IN CONST PWSTR String</span>
01991 <span class="comment">//      );</span>
01992 <span class="comment">//</span>
01993 
<a name="l01994"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a103">01994</a> <span class="preprocessor">#define IopConstStringLength(String)        ( ( sizeof(String) - sizeof(UNICODE_NULL) ) / sizeof(WCHAR) )</span>
01995 <span class="preprocessor"></span>
01996 <span class="comment">//</span>
01997 <span class="comment">// Kernel Mode (KM) to User Mode (UM) SymbolicLinkName Conversion and Vice Versa</span>
01998 <span class="comment">// ie.  \??\ &lt;-&gt; \\?\</span>
01999 <span class="comment">//</span>
02000 
02001 <span class="comment">//</span>
02002 <span class="comment">//  VOID</span>
02003 <span class="comment">//  IopKMToUMSymbolicLinkName(</span>
02004 <span class="comment">//      IN UNICODE_STRING String</span>
02005 <span class="comment">//      );</span>
02006 <span class="comment">//</span>
02007 
<a name="l02008"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a104">02008</a> <span class="preprocessor">#define IopKMToUMSymbolicLinkName(String) \</span>
02009 <span class="preprocessor">    ASSERT(String) \</span>
02010 <span class="preprocessor">    ASSERT(String-&gt;Length &gt; 4) \</span>
02011 <span class="preprocessor">    String[1] = L'\\'</span>
02012 <span class="preprocessor"></span>
02013 <span class="comment">//</span>
02014 <span class="comment">//  VOID</span>
02015 <span class="comment">//  IopUMToKMSymbolicLinkName(</span>
02016 <span class="comment">//      IN UNICODE_STRING String</span>
02017 <span class="comment">//      );</span>
02018 <span class="comment">//</span>
02019 
<a name="l02020"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a105">02020</a> <span class="preprocessor">#define IopUMToKMSymbolicLinkName(String) \</span>
02021 <span class="preprocessor">    ASSERT(String) \</span>
02022 <span class="preprocessor">    ASSERT(String-&gt;Length &gt; 4) \</span>
02023 <span class="preprocessor">    String[1] = L'?'</span>
02024 <span class="preprocessor"></span>
02025 <span class="comment">//</span>
02026 <span class="comment">// Kernel mode notification</span>
02027 <span class="comment">//</span>
02028 
02029 <span class="comment">//</span>
02030 <span class="comment">// This macros maps a guid to a hash value based on the number of hash</span>
02031 <span class="comment">// buckets we are using.  It does this by treating the  guid as an array of</span>
02032 <span class="comment">// 4 ULONGs, suming them and MOD by the number of hash buckets we are using.</span>
02033 <span class="comment">//</span>
02034 <span class="comment">//  ULONG</span>
02035 <span class="comment">//  IopHashGuid(</span>
02036 <span class="comment">//      LPGUID Guid</span>
02037 <span class="comment">//      );</span>
02038 <span class="comment">//</span>
02039 
<a name="l02040"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a106">02040</a> <span class="preprocessor">#define IopHashGuid(_Guid) \</span>
02041 <span class="preprocessor">            ( ( ((PULONG)_Guid)[0] + ((PULONG)_Guid)[1] + ((PULONG)_Guid)[2] \</span>
02042 <span class="preprocessor">                + ((PULONG)_Guid)[3]) % NOTIFY_DEVICE_CLASS_HASH_BUCKETS)</span>
02043 <span class="preprocessor"></span>
02044 
02045 
02046 <span class="comment">//  This macros abstracts</span>
02047 <span class="comment">//</span>
02048 <span class="comment">//  VOID</span>
02049 <span class="comment">//  IopAcquireNotifyLock(</span>
02050 <span class="comment">//      PFAST_MUTEX Lock</span>
02051 <span class="comment">//      )</span>
02052 
<a name="l02053"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a107">02053</a> <span class="preprocessor">#define IopAcquireNotifyLock(Lock)     ExAcquireFastMutex(Lock);</span>
02054 <span class="preprocessor"></span>
02055 <span class="comment">/*</span>
02056 <span class="comment">VOID</span>
02057 <span class="comment">IopReleaseNotifyLock(</span>
02058 <span class="comment">    PFAST_MUTEX Lock</span>
02059 <span class="comment">    )</span>
02060 <span class="comment">*/</span>
<a name="l02061"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a108">02061</a> <span class="preprocessor">#define IopReleaseNotifyLock(Lock)     ExReleaseFastMutex(Lock);</span>
02062 <span class="preprocessor"></span>
02063 
02064 <span class="comment">//  BOOLEAN</span>
02065 <span class="comment">//  IopCompareGuid(</span>
02066 <span class="comment">//      IN LPGUID guid1,</span>
02067 <span class="comment">//      IN LPGUID guid2</span>
02068 <span class="comment">//      );</span>
02069 
<a name="l02070"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a109">02070</a> <span class="preprocessor">#define IopCompareGuid(g1, g2)  ( (g1) == (g2) \</span>
02071 <span class="preprocessor">                                    ? TRUE \</span>
02072 <span class="preprocessor">                                    : RtlCompareMemory( (g1), (g2), sizeof(GUID) ) == sizeof(GUID) \</span>
02073 <span class="preprocessor">                                    )</span>
02074 <span class="preprocessor"></span>
02075 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02076 <a class="code" href="../../d9/d0/pnpiop_8h.html#a346">IopInitializePlugPlayNotification</a>(
02077     VOID
02078     );
02079 
02080 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02081 <a class="code" href="../../d9/d0/pnpiop_8h.html#a347">IopNotifySetupDeviceArrival</a>(
02082         <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> PhysicalDeviceObject,    <span class="comment">// PDO of the device</span>
02083         HANDLE EnumEntryKey,                    <span class="comment">// Handle into the enum branch of the registry for this device</span>
02084         BOOLEAN InstallDriver                   <span class="comment">// Should setup attempt to install a driver</span>
02085 );
02086 
02087 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02088 <a class="code" href="../../d9/d0/pnpiop_8h.html#a348">IopRequestHwProfileChangeNotification</a>(
02089     IN   LPGUID                      EventGuid,
02090     IN   PROFILE_NOTIFICATION_TIME   NotificationTime,
02091     OUT  PPNP_VETO_TYPE              VetoType           OPTIONAL,
02092     OUT  PUNICODE_STRING             VetoName           OPTIONAL
02093     );
02094 
02095 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02096 <a class="code" href="../../d9/d0/pnpiop_8h.html#a349">IopNotifyTargetDeviceChange</a>(
02097     LPCGUID EventGuid,
02098     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject,
02099     PVOID NotificationStructure,
02100     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> *VetoingDriver
02101     );
02102 
02103 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02104 <a class="code" href="../../d9/d0/pnpiop_8h.html#a350">IopGetRelatedTargetDevice</a>(
02105     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
02106     OUT <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> *DeviceNode
02107     );
02108 
02109 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02110 <a class="code" href="../../d9/d0/pnpiop_8h.html#a351">IopNotifyDeviceClassChange</a>(
02111     LPGUID EventGuid,
02112     LPGUID ClassGuid,
02113     PUNICODE_STRING SymbolicLinkName
02114     );
02115 
02116 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02117 <a class="code" href="../../d9/d0/pnpiop_8h.html#a352">IopRegisterDeviceInterface</a>(
02118     IN PUNICODE_STRING DeviceInstanceName,
02119     IN CONST GUID *InterfaceClassGuid,
02120     IN PUNICODE_STRING ReferenceString      OPTIONAL,
02121     IN BOOLEAN UserModeFormat,
02122     OUT PUNICODE_STRING SymbolicLinkName
02123     );
02124 
02125 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02126 <a class="code" href="../../d9/d0/pnpiop_8h.html#a353">IopUnregisterDeviceInterface</a>(
02127     IN PUNICODE_STRING SymbolicLinkName
02128     );
02129 
02130 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02131 <a class="code" href="../../d9/d0/pnpiop_8h.html#a354">IopRemoveDeviceInterfaces</a>(
02132     IN PUNICODE_STRING DeviceInstancePath
02133     );
02134 
02135 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02136 <a class="code" href="../../d9/d0/pnpiop_8h.html#a355">IopGetDeviceInterfaces</a>(
02137     IN CONST GUID *InterfaceClassGuid,
02138     IN PUNICODE_STRING DevicePath   OPTIONAL,
02139     IN ULONG Flags,
02140     IN BOOLEAN UserModeFormat,
02141     OUT PWSTR *SymbolicLinkList,
02142     OUT PULONG SymbolicLinkListSize OPTIONAL
02143     );
02144 
02145 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02146 <a class="code" href="../../d9/d0/pnpiop_8h.html#a356">IopDoDeferredSetInterfaceState</a>(
02147     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
02148     );
02149 
02150 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02151 <a class="code" href="../../d9/d0/pnpiop_8h.html#a357">IopProcessSetInterfaceState</a>(
02152     IN PUNICODE_STRING SymbolicLinkName,
02153     IN BOOLEAN Enable,
02154     IN BOOLEAN DeferNotStarted
02155     );
02156 
02157 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02158 <a class="code" href="../../d9/d0/pnpiop_8h.html#a358">IopReplaceSeperatorWithPound</a>(
02159     OUT PUNICODE_STRING OutString,
02160     IN PUNICODE_STRING InString
02161     );
02162 
02163 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02164 <a class="code" href="../../d9/d0/pnpiop_8h.html#a359">IopNotifyHwProfileChange</a>(
02165     IN  LPGUID           EventGuid,
02166     OUT PPNP_VETO_TYPE   VetoType    OPTIONAL,
02167     OUT PUNICODE_STRING  VetoName    OPTIONAL
02168     );
02169 
02170 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02171 <a class="code" href="../../d0/d1/pnpirp_8c.html#a17">IopUncacheInterfaceInformation</a>(
02172     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject
02173     );
02174 
02175 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02176 <a class="code" href="../../d9/d0/pnpiop_8h.html#a361">IopProcessNewProfile</a>(
02177     VOID
02178     );
02179 
02180 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02181 <a class="code" href="../../d9/d0/pnpiop_8h.html#a362">IopProcessNewProfileWorker</a>(
02182     IN PVOID Context
02183     );
02184 
02185 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02186 <a class="code" href="../../d9/d0/pnpiop_8h.html#a363">IopProcessNewProfileStateCallback</a>(
02187     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode,
02188     IN PVOID Context
02189     );
02190 
02191 <span class="comment">//</span>
02192 <span class="comment">// Notify entry header - all notify entries have these</span>
02193 <span class="comment">//</span>
02194 
<a name="l02195"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html">02195</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html">_NOTIFY_ENTRY_HEADER</a> {
02196 
02197     <span class="comment">//</span>
02198     <span class="comment">// List Entry structure</span>
02199     <span class="comment">//</span>
02200 
<a name="l02201"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o0">02201</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o0">ListEntry</a>;
02202 
02203     <span class="comment">//</span>
02204     <span class="comment">// Notification event category for this notification entry.</span>
02205     <span class="comment">//</span>
02206 
<a name="l02207"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o1">02207</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a49">IO_NOTIFICATION_EVENT_CATEGORY</a> <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o1">EventCategory</a>;
02208 
02209     <span class="comment">//</span>
02210     <span class="comment">// Callback routine passed in at registration</span>
02211     <span class="comment">//</span>
02212 
<a name="l02213"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o2">02213</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a50">PDRIVER_NOTIFICATION_CALLBACK_ROUTINE</a> <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o2">Callback</a>;
02214 
02215     <span class="comment">//</span>
02216     <span class="comment">// Context passed in at registration</span>
02217     <span class="comment">//</span>
02218 
<a name="l02219"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o3">02219</a>     PVOID <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o3">Context</a>;
02220 
02221     <span class="comment">//</span>
02222     <span class="comment">// Driver object of the driver that registered for notifications.  Required</span>
02223     <span class="comment">// so we can dereference it when it unregisters</span>
02224     <span class="comment">//</span>
02225 
<a name="l02226"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o4">02226</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o4">DriverObject</a>;
02227 
02228     <span class="comment">//</span>
02229     <span class="comment">// RefCount is the number of outstanding pointers to the node and avoids</span>
02230     <span class="comment">// deletion while another notification is taking place</span>
02231     <span class="comment">//</span>
02232 
<a name="l02233"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o5">02233</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o5">RefCount</a>;
02234 
02235     <span class="comment">//</span>
02236     <span class="comment">// Unregistered is set if this notification has been unregistered but cannot</span>
02237     <span class="comment">// be removed from the list because other entities are using it</span>
02238     <span class="comment">//</span>
02239 
<a name="l02240"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o6">02240</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o6">Unregistered</a>;
02241 
02242     <span class="comment">//</span>
02243     <span class="comment">// Lock is a pointer to the fast mutex which is used to synchronise access</span>
02244     <span class="comment">// to the list this node is a member of and is required so that the correct</span>
02245     <span class="comment">// list can be locked during IoUnregisterPlugPlayNotification.  If no locking</span>
02246     <span class="comment">// is required it is NULL</span>
02247     <span class="comment">//</span>
02248 
<a name="l02249"></a><a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o7">02249</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html#o7">Lock</a>;
02250 
02251 } <a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html">NOTIFY_ENTRY_HEADER</a>, *<a class="code" href="../../d0/d4/struct__NOTIFY__ENTRY__HEADER.html">PNOTIFY_ENTRY_HEADER</a>;
02252 
02253 
02254 <span class="comment">//</span>
02255 <span class="comment">// Data to store for each target device registration</span>
02256 <span class="comment">//</span>
02257 
<a name="l02258"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html">02258</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html">_TARGET_DEVICE_NOTIFY_ENTRY</a> {
02259 
02260     <span class="comment">//</span>
02261     <span class="comment">// Header entries</span>
02262     <span class="comment">//</span>
02263 
<a name="l02264"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o0">02264</a>     LIST_ENTRY <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o0">ListEntry</a>;
<a name="l02265"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o1">02265</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a49">IO_NOTIFICATION_EVENT_CATEGORY</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o1">EventCategory</a>;
<a name="l02266"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o2">02266</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a50">PDRIVER_NOTIFICATION_CALLBACK_ROUTINE</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o2">Callback</a>;
<a name="l02267"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o3">02267</a>     PVOID <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o3">Context</a>;
<a name="l02268"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o4">02268</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o4">DriverObject</a>;
<a name="l02269"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o5">02269</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o5">RefCount</a>;
<a name="l02270"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o6">02270</a>     BOOLEAN <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o6">Unregistered</a>;
<a name="l02271"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o7">02271</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o7">Lock</a>;
02272 
02273     <span class="comment">//</span>
02274     <span class="comment">// FileObject - the file object of the target device we are interested in</span>
02275     <span class="comment">//</span>
02276 
<a name="l02277"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o8">02277</a>     <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o8">FileObject</a>;
02278 
02279     <span class="comment">//</span>
02280     <span class="comment">// PhysicalDeviceObject -- the PDO upon which this notification is hooked.</span>
02281     <span class="comment">// We need to keep this here, so we can dereference it when the refcount</span>
02282     <span class="comment">// on this notification entry drops to zero.</span>
02283     <span class="comment">//</span>
02284 
<a name="l02285"></a><a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o9">02285</a>     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html#o9">PhysicalDeviceObject</a>;
02286 
02287 } <a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html">TARGET_DEVICE_NOTIFY_ENTRY</a>, *<a class="code" href="../../d1/d0/struct__TARGET__DEVICE__NOTIFY__ENTRY.html">PTARGET_DEVICE_NOTIFY_ENTRY</a>;
02288 
02289 <span class="comment">//</span>
02290 <span class="comment">// Data to store for each device class registration</span>
02291 <span class="comment">//</span>
02292 
<a name="l02293"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html">02293</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html">_DEVICE_CLASS_NOTIFY_ENTRY</a> {
02294 
02295     <span class="comment">//</span>
02296     <span class="comment">// Header entries</span>
02297     <span class="comment">//</span>
02298 
<a name="l02299"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o0">02299</a>     LIST_ENTRY <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o0">ListEntry</a>;
<a name="l02300"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o1">02300</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a49">IO_NOTIFICATION_EVENT_CATEGORY</a> <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o1">EventCategory</a>;
<a name="l02301"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o2">02301</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a50">PDRIVER_NOTIFICATION_CALLBACK_ROUTINE</a> <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o2">Callback</a>;
<a name="l02302"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o3">02302</a>     PVOID <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o3">Context</a>;
<a name="l02303"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o4">02303</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o4">DriverObject</a>;
<a name="l02304"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o5">02304</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o5">RefCount</a>;
<a name="l02305"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o6">02305</a>     BOOLEAN <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o6">Unregistered</a>;
<a name="l02306"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o7">02306</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o7">Lock</a>;
02307 
02308     <span class="comment">//</span>
02309     <span class="comment">// ClassGuid - the guid of the device class we are interested in</span>
02310     <span class="comment">//</span>
02311 
<a name="l02312"></a><a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o8">02312</a>     GUID <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html#o8">ClassGuid</a>;
02313 
02314 } <a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html">DEVICE_CLASS_NOTIFY_ENTRY</a>, *<a class="code" href="../../d4/d3/struct__DEVICE__CLASS__NOTIFY__ENTRY.html">PDEVICE_CLASS_NOTIFY_ENTRY</a>;
02315 
02316 <span class="comment">//</span>
02317 <span class="comment">// Data to store for registration of the Reserved (ie setupdd.sys) variety</span>
02318 <span class="comment">//</span>
02319 
<a name="l02320"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html">02320</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html">_SETUP_NOTIFY_DATA</a> {
02321 
02322     <span class="comment">//</span>
02323     <span class="comment">// Header entries</span>
02324     <span class="comment">//</span>
02325 
<a name="l02326"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o0">02326</a>     LIST_ENTRY <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o0">ListEntry</a>;
<a name="l02327"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o1">02327</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a49">IO_NOTIFICATION_EVENT_CATEGORY</a> <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o1">EventCategory</a>;
<a name="l02328"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o2">02328</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a50">PDRIVER_NOTIFICATION_CALLBACK_ROUTINE</a> <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o2">Callback</a>;
<a name="l02329"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o3">02329</a>     PVOID <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o3">Context</a>;
<a name="l02330"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o4">02330</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o4">DriverObject</a>;
<a name="l02331"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o5">02331</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o5">RefCount</a>;
<a name="l02332"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o6">02332</a>     BOOLEAN <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o6">Unregistered</a>;
<a name="l02333"></a><a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o7">02333</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html#o7">Lock</a>;
02334 
02335 } <a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html">SETUP_NOTIFY_DATA</a>, *<a class="code" href="../../d7/d2/struct__SETUP__NOTIFY__DATA.html">PSETUP_NOTIFY_DATA</a>;
02336 
02337 
02338 <span class="comment">//</span>
02339 <span class="comment">// Data to store for registration for HardwareProfileChange Events</span>
02340 <span class="comment">//</span>
02341 
<a name="l02342"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html">02342</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html">_HWPROFILE_NOTIFY_ENTRY</a> {
02343 
02344     <span class="comment">//</span>
02345     <span class="comment">// Header entries</span>
02346     <span class="comment">//</span>
02347 
<a name="l02348"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o0">02348</a>     LIST_ENTRY <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o0">ListEntry</a>;
<a name="l02349"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o1">02349</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a49">IO_NOTIFICATION_EVENT_CATEGORY</a> <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o1">EventCategory</a>;
<a name="l02350"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o2">02350</a>     <a class="code" href="../../d6/d9/pnp_8h.html#a50">PDRIVER_NOTIFICATION_CALLBACK_ROUTINE</a> <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o2">Callback</a>;
<a name="l02351"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o3">02351</a>     PVOID <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o3">Context</a>;
<a name="l02352"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o4">02352</a>     <a class="code" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o4">DriverObject</a>;
<a name="l02353"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o5">02353</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o5">RefCount</a>;
<a name="l02354"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o6">02354</a>     BOOLEAN <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o6">Unregistered</a>;
<a name="l02355"></a><a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o7">02355</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html#o7">Lock</a>;
02356 
02357 } <a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html">HWPROFILE_NOTIFY_ENTRY</a>, *<a class="code" href="../../d0/d9/struct__HWPROFILE__NOTIFY__ENTRY.html">PHWPROFILE_NOTIFY_ENTRY</a>;
02358 
<a name="l02359"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a110">02359</a> <span class="preprocessor">#define PNP_NOTIFICATION_VERSION            1</span>
<a name="l02360"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a111">02360</a> <span class="preprocessor"></span><span class="preprocessor">#define NOTIFY_DEVICE_CLASS_HASH_BUCKETS    13</span>
02361 <span class="preprocessor"></span>
02362 <span class="comment">//</span>
02363 <span class="comment">// IopMaxDeviceNodeLevel - Level number of the DeviceNode deepest in the tree</span>
02364 <span class="comment">//</span>
<a name="l02365"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a176">02365</a> <span class="keyword">extern</span> ULONG       <a class="code" href="../../d1/d0/pnpdata_8c.html#a25">IopMaxDeviceNodeLevel</a>;
<a name="l02366"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a177">02366</a> <span class="keyword">extern</span> ULONG       <a class="code" href="../../d1/d0/pnpdata_8c.html#a21">IoDeviceNodeTreeSequence</a>;
02367 
02368 <span class="comment">//</span>
02369 <span class="comment">// Global notification data</span>
02370 <span class="comment">//</span>
02371 
<a name="l02372"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a178">02372</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d8/d0/pnpioapi_8c.html#a38">IopDeviceClassNotifyLock</a>;
<a name="l02373"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a179">02373</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d8/d0/pnpioapi_8c.html#a37">IopDeviceClassNotifyList</a>[];
<a name="l02374"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a180">02374</a> <span class="keyword">extern</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a173">PSETUP_NOTIFY_DATA</a> <a class="code" href="../../d8/d0/pnpioapi_8c.html#a39">IopSetupNotifyData</a>;
<a name="l02375"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a181">02375</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d8/d0/pnpioapi_8c.html#a40">IopTargetDeviceNotifyLock</a>;
<a name="l02376"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a182">02376</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d8/d0/pnpioapi_8c.html#a41">IopProfileNotifyList</a>;
<a name="l02377"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a183">02377</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d8/d0/pnpioapi_8c.html#a42">IopHwProfileNotifyLock</a>;
02378 
02379 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02380 <a class="code" href="../../d9/d0/pnpiop_8h.html#a364">IopProcessDeferredRegistrations</a>(
02381     VOID
02382     );
02383 
02384 <span class="comment">//</span>
02385 <span class="comment">// Generic buffer management</span>
02386 <span class="comment">//</span>
02387 
<a name="l02388"></a><a class="code" href="../../d4/d5/struct__BUFFER__INFO.html">02388</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d5/struct__BUFFER__INFO.html">_BUFFER_INFO</a> {
02389 
02390     <span class="comment">//</span>
02391     <span class="comment">// Buffer - pointer to the start of the buffer</span>
02392     <span class="comment">//</span>
02393 
<a name="l02394"></a><a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o0">02394</a>     PCHAR <a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o0">Buffer</a>;
02395 
02396     <span class="comment">//</span>
02397     <span class="comment">// Current - Pointer to the current position in the buffer</span>
02398     <span class="comment">//</span>
02399 
<a name="l02400"></a><a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o1">02400</a>     PCHAR <a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o1">Current</a>;
02401 
02402     <span class="comment">//</span>
02403     <span class="comment">// MaxSize - Maximum size of the buffer in bytes</span>
02404     <span class="comment">//</span>
02405 
<a name="l02406"></a><a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o2">02406</a>     ULONG <a class="code" href="../../d4/d5/struct__BUFFER__INFO.html#o2">MaxSize</a>;
02407 
02408 } <a class="code" href="../../d4/d5/struct__BUFFER__INFO.html">BUFFER_INFO</a>, *<a class="code" href="../../d4/d5/struct__BUFFER__INFO.html">PBUFFER_INFO</a>;
02409 
<a name="l02410"></a><a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html">02410</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html">_BUS_TYPE_GUID_LIST</a> {
02411 
02412     <span class="comment">//</span>
02413     <span class="comment">// Number of allocated guid slots in the table.</span>
02414     <span class="comment">//</span>
<a name="l02415"></a><a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o0">02415</a>     ULONG <a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o0">Count</a>;
02416 
02417     <span class="comment">//</span>
02418     <span class="comment">// Number of entries used so far.</span>
02419     <span class="comment">//</span>
<a name="l02420"></a><a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o1">02420</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o1">Lock</a>;
02421 
02422     <span class="comment">//</span>
02423     <span class="comment">// Array of bus type guids</span>
02424     <span class="comment">//</span>
<a name="l02425"></a><a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o2">02425</a>     GUID <a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html#o2">Guid</a>[1];
02426 
02427 } <a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html">BUS_TYPE_GUID_LIST</a>, *<a class="code" href="../../d8/d5/struct__BUS__TYPE__GUID__LIST.html">PBUS_TYPE_GUID_LIST</a>;
02428 
02429 <span class="comment">//</span>
02430 <span class="comment">// List of queried bus type guids</span>
02431 <span class="comment">//</span>
<a name="l02432"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a188">02432</a> <span class="keyword">extern</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a187">PBUS_TYPE_GUID_LIST</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a22">IopBusTypeGuidList</a>;
02433 
02434 <span class="comment">//</span>
02435 <span class="comment">// Arbiter entry points</span>
02436 <span class="comment">//</span>
02437 
02438 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02439 <a class="code" href="../../d3/d1/pnpmemio_8c.html#a25">IopPortInitialize</a>(
02440     VOID
02441     );
02442 
02443 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02444 <a class="code" href="../../d3/d1/pnpmemio_8c.html#a21">IopMemInitialize</a>(
02445     VOID
02446     );
02447 
02448 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02449 <a class="code" href="../../d1/d1/pnpirq_8c.html#a1">IopIrqInitialize</a>(
02450     VOID
02451     );
02452 
02453 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02454 <a class="code" href="../../d9/d0/pnpiop_8h.html#a368">IopDmaInitialize</a>(
02455     VOID
02456     );
02457 
02458 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02459 <a class="code" href="../../d9/d0/pnpiop_8h.html#a369">IopBusNumberInitialize</a>(
02460     VOID
02461     );
02462 
02463 <span class="comment">//</span>
02464 <span class="comment">// Arbiter state</span>
02465 <span class="comment">//</span>
02466 
<a name="l02467"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a189">02467</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__ARBITER__INSTANCE.html">ARBITER_INSTANCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a30">IopRootPortArbiter</a>;
<a name="l02468"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a190">02468</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__ARBITER__INSTANCE.html">ARBITER_INSTANCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a31">IopRootMemArbiter</a>;
<a name="l02469"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a191">02469</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__ARBITER__INSTANCE.html">ARBITER_INSTANCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a33">IopRootIrqArbiter</a>;
<a name="l02470"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a192">02470</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__ARBITER__INSTANCE.html">ARBITER_INSTANCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a32">IopRootDmaArbiter</a>;
<a name="l02471"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a193">02471</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__ARBITER__INSTANCE.html">ARBITER_INSTANCE</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a34">IopRootBusNumberArbiter</a>;
02472 
02473 <span class="comment">//</span>
02474 <span class="comment">// Buffer management routines.</span>
02475 <span class="comment">//</span>
02476 
02477 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02478 <a class="code" href="../../d9/d0/pnpiop_8h.html#a370">IopAllocateBuffer</a>(
02479     IN PBUFFER_INFO Info,
02480     IN ULONG Size
02481     );
02482 
02483 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02484 <a class="code" href="../../d9/d0/pnpiop_8h.html#a371">IopResizeBuffer</a>(
02485     IN PBUFFER_INFO Info,
02486     IN ULONG NewSize,
02487     IN BOOLEAN CopyContents
02488     );
02489 
02490 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02491 <a class="code" href="../../d9/d0/pnpiop_8h.html#a372">IopFreeBuffer</a>(
02492     IN PBUFFER_INFO Info
02493     );
02494 
02495 
02496 <span class="comment">//</span>
02497 <span class="comment">// UnicodeString management routines.</span>
02498 <span class="comment">//</span>
02499 
02500 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02501 <a class="code" href="../../d9/d0/pnpiop_8h.html#a373">IopAllocateUnicodeString</a>(
02502     IN OUT PUNICODE_STRING String,
02503     IN USHORT Length
02504     );
02505 
02506 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02507 <a class="code" href="../../d9/d0/pnpiop_8h.html#a374">IopFreeAllocatedUnicodeString</a>(
02508     PUNICODE_STRING String
02509     );
02510 
02511 <span class="comment">//</span>
02512 <span class="comment">// Misc.</span>
02513 <span class="comment">//</span>
02514 
02515 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02516 <a class="code" href="../../d2/d1/pnpmap_8c.html#a52">PnPBiosGetBiosInfo</a>(
02517     OUT PVOID *BiosInfo,
02518     OUT ULONG *BiosInfoLength
02519     );
02520 
02521 BOOLEAN
02522 <a class="code" href="../../d9/d0/pnpiop_8h.html#a376">IopFixupDeviceId</a>(
02523     PWCHAR DeviceId
02524     );
02525 
02526 <span class="comment">//</span>
02527 <span class="comment">// Hot Docking Profile Support</span>
02528 <span class="comment">//</span>
02529 
<a name="l02530"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a392">02530</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d9/d0/pnpiop_8h.html#a392">_HARDWARE_PROFILE_BUS_TYPE</a> {
02531     <a class="code" href="../../d9/d0/pnpiop_8h.html#a392a226">HardwareProfileBusTypeACPI</a>
02532 } <a class="code" href="../../d9/d0/pnpiop_8h.html#a194">HARDWARE_PROFILE_BUS_TYPE</a>, * <a class="code" href="../../d9/d0/pnpiop_8h.html#a195">PHARDWARE_PROFILE_BUS_TYPE</a>;
02533 
<a name="l02534"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a196">02534</a> <span class="keyword">extern</span> LIST_ENTRY   <a class="code" href="../../d9/d0/dockhwp_8c.html#a1">IopDockDeviceListHead</a>;
<a name="l02535"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a197">02535</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>   <a class="code" href="../../d9/d0/dockhwp_8c.html#a3">IopDockDeviceListLock</a>;
<a name="l02536"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a198">02536</a> <span class="keyword">extern</span> ULONG        <a class="code" href="../../d9/d0/dockhwp_8c.html#a2">IopDockDeviceCount</a>;
<a name="l02537"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a199">02537</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>   <a class="code" href="../../d9/d0/dockhwp_8c.html#a4">IopProfileChangeSemaphore</a>;
<a name="l02538"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a200">02538</a> <span class="keyword">extern</span> LONG         <a class="code" href="../../d9/d0/dockhwp_8c.html#a6">IopDocksInTransition</a>;
02539 
02540 <span class="comment">//</span>
02541 <span class="comment">// These six functions are exported by Dockhwp to control hardware profile</span>
02542 <span class="comment">// changes</span>
02543 <span class="comment">//</span>
02544 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02545 <a class="code" href="../../d9/d0/pnpiop_8h.html#a377">IopHardwareProfileBeginTransition</a>(
02546     IN BOOLEAN SubsumeExistingDeparture
02547     );
02548 
02549 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02550 <a class="code" href="../../d9/d0/pnpiop_8h.html#a378">IopHardwareProfileMarkDock</a>(
02551     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a>    DeviceNode,
02552     PROFILE_STATUS  ChangeInPresence
02553     );
02554 
02555 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02556 <a class="code" href="../../d9/d0/pnpiop_8h.html#a379">IopHardwareProfileQueryChange</a>(
02557     IN  BOOLEAN                     SubsumeExistingDeparture,
02558     IN  PROFILE_NOTIFICATION_TIME   NotificationTime,
02559     OUT PPNP_VETO_TYPE              VetoType,
02560     OUT PUNICODE_STRING             VetoName OPTIONAL
02561     );
02562 
02563 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02564 <a class="code" href="../../d9/d0/pnpiop_8h.html#a380">IopHardwareProfileCommitStartedDock</a>(
02565     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
02566     );
02567 
02568 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02569 <a class="code" href="../../d9/d0/pnpiop_8h.html#a381">IopHardwareProfileCommitRemovedDock</a>(
02570     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
02571     );
02572 
02573 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02574 <a class="code" href="../../d9/d0/pnpiop_8h.html#a382">IopHardwareProfileCancelRemovedDock</a>(
02575     IN <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
02576     );
02577 
02578 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02579 <a class="code" href="../../d9/d0/pnpiop_8h.html#a383">IopHardwareProfileCancelTransition</a>(
02580     VOID
02581     );
02582 
02583 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02584 <a class="code" href="../../d9/d0/pnpiop_8h.html#a384">IopHardwareProfileSetMarkedDocksEjected</a>(
02585     VOID
02586     );
02587 
02588 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
02589 <a class="code" href="../../d9/d0/pnpiop_8h.html#a385">IopOrphanNotification</a> (
02590     <a class="code" href="../../d4/d4/struct__DEVICE__NODE.html">PDEVICE_NODE</a> DeviceNode
02591     );
02592 
02593 
02594 <span class="comment">//</span>
02595 <span class="comment">// Warm eject externs and function prototypes</span>
02596 <span class="comment">//</span>
<a name="l02597"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a201">02597</a> <span class="keyword">extern</span> <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a28">IopWarmEjectLock</a>;
<a name="l02598"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a202">02598</a> <span class="keyword">extern</span> <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code" href="../../d1/d0/pnpdata_8c.html#a29">IopWarmEjectPdo</a>;
02599 
02600 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
02601 <a class="code" href="../../d4/d1/pnppower_8c.html#a4">IopWarmEjectDevice</a>(
02602     IN <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>      DeviceToEject,
02603     IN SYSTEM_POWER_STATE  LightestSleepState
02604     );
02605 
02606 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:17 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
