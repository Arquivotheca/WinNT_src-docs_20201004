<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: imefull.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>imefull.c File Reference</h1><code>#include "<a class="el" href="../../d6/d2/w32_2ntcon_2conime_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d1/d9/imefull_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/imefull_8c.html#a0">ImeOpenClose</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, BOOL fFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/imefull_8c.html#a1">CharHandlerFromConsole</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, UINT Message, ULONG wParam, ULONG lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/imefull_8c.html#a2">CharHandlerToConsole</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, UINT Message, ULONG wParam, ULONG lParam)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a1" doxytag="imefull.c::CharHandlerFromConsole" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CharHandlerFromConsole           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>Message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d9/imefull_8c-source.html#l00208">208</a> of file <a class="el" href="../../d1/d9/imefull_8c-source.html">imefull.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/imefull_8c-source.html#l00281">CharHandlerToConsole()</a>, <a class="el" href="../../d4/d4/conime_8h-source.html#l00083">CONIME_KEYDATA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d2/d4/ntuser_2imm_2conime_8c-source.html#l00034">ImmCallImeConsoleIME()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00196">ImmTranslateMessage()</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00147">IPHK_CHECKCTRL</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00145">IPHK_HOTKEY</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00146">IPHK_PROCESSBYIME</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00288">WndProc()</a>.
<p>
<pre class="fragment"><div>00209 {
00210     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> TmpMessage ;
00211     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwImmRet ;
00212     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uVKey ;
00213     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> wParamSave ;
00214 
00215     <span class="keywordflow">if</span> (HIWORD(wParam) == 0){
00216         wParamSave = wParam ;
00217     }
00218     <span class="keywordflow">else</span> {
00219         <span class="keywordflow">if</span> (Message == WM_KEYDOWN   +<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a> || Message == WM_KEYUP   +<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a> ||
00220             Message == WM_SYSKEYDOWN+<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a> || Message == WM_SYSKEYUP+<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a>){
00221             wParamSave = 0 ;
00222         }
00223         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(HIWORD(wParam) &gt; 0x00ff){
00224             WCHAR WideChar ;
00225             UCHAR MultiChar ;
00226             WideChar = HIWORD(wParam) ;
00227             WideCharToMultiByte(CP_OEMCP, 0, &amp;WideChar, 1, &amp;MultiChar, 1, NULL, NULL) ;
00228             wParamSave = MultiChar ;
00229         }
00230         <span class="keywordflow">else</span> {
00231             wParamSave = HIWORD(wParam) ;
00232         }
00233     }
00234 
00235     <span class="keywordflow">if</span> (HIWORD(lParam) &amp; KF_UP) <span class="comment">// KEY_TRANSITION_UP</span>
00236         TmpMessage = WM_KEYUP ;
00237     <span class="keywordflow">else</span>
00238         TmpMessage = WM_KEYDOWN ;
00239 
00240 
00241     <span class="comment">// Return Value of ClientImmProcessKeyConsoleIME</span>
00242     <span class="comment">// IPHK_HOTKEY          1   - the vkey is IME hotkey</span>
00243     <span class="comment">// IPHK_PROCESSBYIME    2   - the vkey is the one that the IME is waiting for</span>
00244     <span class="comment">// IPHK_CHECKCTRL       4   - not used by NT IME</span>
00245     dwImmRet = <a class="code" href="../../d1/d5/ntuser_2imm_2conime_8c.html#a3">ImmCallImeConsoleIME</a>(hWnd, TmpMessage, wParam, lParam, &amp;uVKey) ;
00246 
00247     <span class="keywordflow">if</span> ( dwImmRet &amp; <a class="code" href="../../d4/d5/conimep_8h.html#a46">IPHK_HOTKEY</a> ) {
00248     <span class="comment">//</span>
00249     <span class="comment">// if this vkey is the IME hotkey, we won't pass</span>
00250     <span class="comment">// it to application or hook procedure.</span>
00251     <span class="comment">// This is what Win95 does. [takaok]</span>
00252     <span class="comment">//</span>
00253        <span class="keywordflow">return</span> ;
00254     }
00255     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dwImmRet &amp; <a class="code" href="../../d4/d5/conimep_8h.html#a47">IPHK_PROCESSBYIME</a>) {
00256         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> ;
00257 
00258 <span class="comment">//3.51</span>
00259 <span class="comment">//      uVKey = (wParamSave&lt;&lt;8) | uVKey ;</span>
00260 <span class="comment">//      Status = ClientImmTranslateMessageMain( hWnd,uVKey,lParam);</span>
00261 
00262         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d0/immuser_8h.html#a49">ImmTranslateMessage</a>(hWnd, TmpMessage, wParam, lParam);
00263 
00264 
00265     }
00266     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dwImmRet &amp; <a class="code" href="../../d4/d5/conimep_8h.html#a48">IPHK_CHECKCTRL</a>) {
00267         <a class="code" href="../../d0/d0/imefull_8c.html#a2">CharHandlerToConsole</a>( hWnd, Message-CONIME_KEYDATA, wParamSave, lParam);
00268     }
00269     <span class="keywordflow">else</span>
00270     {
00271         <span class="keywordflow">if</span> ((Message == WM_CHAR   +<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a>)||
00272             (Message == WM_SYSCHAR+<a class="code" href="../../d3/d5/conime_8h.html#a23">CONIME_KEYDATA</a>)) {
00273             <a class="code" href="../../d0/d0/imefull_8c.html#a2">CharHandlerToConsole</a>( hWnd, Message-CONIME_KEYDATA, wParamSave, lParam);
00274         }
00275         <span class="keywordflow">else</span>
00276             <a class="code" href="../../d0/d0/imefull_8c.html#a2">CharHandlerToConsole</a>( hWnd, Message-CONIME_KEYDATA, wParam, lParam);
00277     }
00278 
00279 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="imefull.c::CharHandlerToConsole" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CharHandlerToConsole           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>Message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d9/imefull_8c-source.html#l00281">281</a> of file <a class="el" href="../../d1/d9/imefull_8c-source.html">imefull.c</a>.
<p>
References <a class="el" href="../../d4/d4/conime_8h-source.html#l00083">CONIME_KEYDATA</a>, <a class="el" href="../../d7/d4/ioep_8h-source.html#l00067">DBGPRINT</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00095">_CONSOLE_TABLE::hWndCon</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00026">LastConsole</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00767">SearchConsole()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03111">UNICODE_SPACE</a>, <a class="el" href="../../d4/d5/conimep_8h.html#a129">VirtualKeyHandler()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d9/imefull_8c-source.html#l00208">CharHandlerFromConsole()</a>, and <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00288">WndProc()</a>.
<p>
<pre class="fragment"><div>00282 {
00283     <a class="code" href="../../d0/d7/struct__CONSOLE__TABLE.html">PCONSOLE_TABLE</a> ConTbl;
00284     WORD  ch ;
00285     <span class="keywordtype">int</span>   NumByte = 0 ;
00286 
00287     ConTbl = <a class="code" href="../../d4/d5/conimep_8h.html#a100">SearchConsole</a>(LastConsole);
00288     <span class="keywordflow">if</span> (ConTbl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00289         <a class="code" href="../../d6/d5/ioep_8h.html#a21">DBGPRINT</a>((<span class="stringliteral">"CONIME: Error! Cannot found registed Console\n"</span>));
00290         <span class="keywordflow">return</span>;
00291     }
00292 
00293     <span class="keywordflow">if</span> (HIWORD(lParam) &amp; KF_UP ) {
00294         <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>( ConTbl-&gt;<a class="code" href="../../d0/d7/struct__CONSOLE__TABLE.html#o1">hWndCon</a>,
00295                      Message+CONIME_KEYDATA,
00296                      wParam,
00297                      lParam) ;
00298         <span class="keywordflow">return</span> ;
00299     }
00300 
00301     ch = LOWORD(wParam) ;
00302     <span class="keywordflow">if</span> ((ch &lt; <a class="code" href="../../d9/d5/verifier_8c.html#a6">UNICODE_SPACE</a>) ||
00303         ((ch &gt;= <a class="code" href="../../d9/d5/verifier_8c.html#a6">UNICODE_SPACE</a>) &amp;&amp;
00304         ((Message == WM_KEYDOWN) || (Message == WM_SYSKEYDOWN) ))) {
00305 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00306 <span class="preprocessor"></span>        <a class="code" href="../../d4/d5/conimep_8h.html#a129">VirtualKeyHandler</a>( hWnd, wParam ,lParam) ;
00307 <span class="preprocessor">#endif</span>
00308 <span class="preprocessor"></span>        <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>( ConTbl-&gt;<a class="code" href="../../d0/d7/struct__CONSOLE__TABLE.html#o1">hWndCon</a>,
00309                      Message+CONIME_KEYDATA,
00310                      wParam,
00311                      lParam) ;
00312         <span class="keywordflow">return</span> ;
00313     }
00314 
00315 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00316 <span class="preprocessor"></span>    StoreChar( hWnd, ch, 0);
00317 <span class="preprocessor">#endif</span>
00318 <span class="preprocessor"></span>
00319     <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>( ConTbl-&gt;<a class="code" href="../../d0/d7/struct__CONSOLE__TABLE.html#o1">hWndCon</a>,
00320                  Message+CONIME_KEYDATA,
00321                  wParam,          <span class="comment">//*Dest,</span>
00322                  lParam) ;
00323 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="imefull.c::ImeOpenClose" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ImeOpenClose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fFlag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d9/imefull_8c-source.html#l00030">30</a> of file <a class="el" href="../../d1/d9/imefull_8c-source.html">imefull.c</a>.
<p>
References <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00201">ImmGetContext()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00292">ImmReleaseContext()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01525">ImmSetOpenStatus()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00031 {
00032     HIMC            hIMC;
00033 
00034     <span class="comment">//</span>
00035     <span class="comment">// If fFlag is true then open IME; otherwise close it.</span>
00036     <span class="comment">//</span>
00037 
00038     <span class="keywordflow">if</span> ( !( hIMC = <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a5">ImmGetContext</a>( hWnd ) ) )
00039         <span class="keywordflow">return</span>;
00040 
00041     <a class="code" href="../../d4/d1/ctxtinfo_8c.html#a32">ImmSetOpenStatus</a>( hIMC, fFlag );
00042 
00043     <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a7">ImmReleaseContext</a>( hWnd, hIMC );
00044 
00045 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:09 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
