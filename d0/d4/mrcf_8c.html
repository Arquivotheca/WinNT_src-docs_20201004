<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mrcf.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>mrcf.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>

<p>
<a href="../../d1/d3/mrcf_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">_MRCF_BIT_IO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">_MDSIGNATURE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a0">wBACKPOINTERMAX</a>&nbsp;&nbsp;&nbsp;(4415)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a1">MD_STAMP</a>&nbsp;&nbsp;&nbsp;0x5344</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a2">MASK_VALID_mds</a>&nbsp;&nbsp;&nbsp;0x0300</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a3">minimum</a>(a, b)&nbsp;&nbsp;&nbsp;(a &lt; b ? a : b)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">_MRCF_BIT_IO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a4">MRCF_BIT_IO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">MRCF_BIT_IO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a5">PMRCF_BIT_IO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">_MDSIGNATURE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a6">MDSIGNATURE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a7">PMDSIGNATURE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a8">MrcfSetBitBuffer</a> (PUCHAR pb, ULONG cb, <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a> BitIo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a9">MrcfFillBitBuffer</a> (<a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a> BitIo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a10">MrcfReadBit</a> (<a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a> BitIo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a> (LONG cbits, <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a> BitIo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/mrcf_8c.html#a12">RtlDecompressBufferMrcf</a> (OUT PUCHAR UncompressedBuffer, IN ULONG UncompressedBufferSize, IN PUCHAR CompressedBuffer, IN ULONG CompressedBufferSize, OUT PULONG FinalUncompressedSize)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="mrcf.c::MASK_VALID_mds" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MASK_VALID_mds&nbsp;&nbsp;&nbsp;0x0300          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00094">94</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="mrcf.c::MD_STAMP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MD_STAMP&nbsp;&nbsp;&nbsp;0x5344          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00093">93</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="mrcf.c::minimum" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define minimum          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(a &lt; b ? a : b)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00101">101</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00437">MrcfReadNBits()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="mrcf.c::wBACKPOINTERMAX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define wBACKPOINTERMAX&nbsp;&nbsp;&nbsp;(4415)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00053">53</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a6" doxytag="mrcf.c::MDSIGNATURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">_MDSIGNATURE</a>  <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mrcf.c::MRCF_BIT_IO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">_MRCF_BIT_IO</a>  <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">MRCF_BIT_IO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="mrcf.c::PMDSIGNATURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a>* <a class="el" href="../../d8/d7/struct__MDSIGNATURE.html">PMDSIGNATURE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00091">91</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="mrcf.c::PMRCF_BIT_IO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">MRCF_BIT_IO</a>* <a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00047">47</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a9" doxytag="mrcf.c::MrcfFillBitBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MrcfFillBitBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>BitIo</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00541">541</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
References <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00039">_MRCF_BIT_IO::abitsBB</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00147">ASSERTMSG</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00043">_MRCF_BIT_IO::cbBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00040">_MRCF_BIT_IO::cbitsBB</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00042">_MRCF_BIT_IO::pbBB</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00387">MrcfReadBit()</a>, and <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00437">MrcfReadNBits()</a>.
<p>
<pre class="fragment"><div>00547                    :
00548 
00549     Fill abitsBB from <span class="keyword">static</span> bit buffer
00550 
00551 Arguments:
00552 
00553     BitIo - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bit buffer statics
00554 
00555 Return Value:
00556 
00557     None.
00558 
00559 --*/
00560 
00561 {
00562     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>) == 0);
00563 
00564     <span class="keywordflow">switch</span> (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o3">cbBB</a>) {
00565 
00566     <span class="keywordflow">case</span> 0:
00567 
00568         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"no bits left in coded buffer!"</span>, FALSE);
00569 
00570         <span class="keywordflow">break</span>;
00571 
00572     <span class="keywordflow">case</span> 1:
00573 
00574         <span class="comment">//</span>
00575         <span class="comment">//  Get last byte and adjust count</span>
00576         <span class="comment">//</span>
00577 
00578         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a> = 8;
00579         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a> = *(BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o2">pbBB</a>)++;
00580         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o3">cbBB</a>--;
00581 
00582         <span class="keywordflow">break</span>;
00583 
00584     <span class="keywordflow">default</span>:
00585 
00586         <span class="comment">//</span>
00587         <span class="comment">//  Get word and adjust count</span>
00588         <span class="comment">//</span>
00589 
00590         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a> = 16;
00591         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a> = *((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> *)(BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o2">pbBB</a>))++;
00592         BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o3">cbBB</a> -= 2;
00593 
00594         <span class="keywordflow">break</span>;
00595     }
00596 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="mrcf.c::MrcfReadBit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> MrcfReadBit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>BitIo</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00387">387</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
References <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00039">_MRCF_BIT_IO::abitsBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00040">_MRCF_BIT_IO::cbitsBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00541">MrcfFillBitBuffer()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.
<p>
<pre class="fragment"><div>00393                    :
00394 
00395     Get next bit from bit buffer
00396 
00397 Arguments:
00398 
00399     BitIo - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bit buffer statics
00400 
00401 Return Value:
00402 
00403     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> - Returns next bit (0 or 1)
00404 
00405 --*/
00406 
00407 {
00408     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> bit;
00409 
00410     <span class="comment">//</span>
00411     <span class="comment">//  Check if no bits available</span>
00412     <span class="comment">//</span>
00413 
00414     <span class="keywordflow">if</span> ((BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>) == 0) {
00415 
00416         <a class="code" href="../../d0/d4/mrcf_8c.html#a9">MrcfFillBitBuffer</a>(BitIo);
00417     }
00418 
00419     <span class="comment">//</span>
00420     <span class="comment">//  Decrement the bit count</span>
00421     <span class="comment">//  get the bit, remove it, and return the bit</span>
00422     <span class="comment">//</span>
00423 
00424     (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>)--;
00425     bit = (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a>) &amp; 1;
00426     (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a>) &gt;&gt;= 1;
00427 
00428     <span class="keywordflow">return</span> bit;
00429 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="mrcf.c::MrcfReadNBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> MrcfReadNBits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>cbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>BitIo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00437">437</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
References <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00039">_MRCF_BIT_IO::abitsBB</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00040">_MRCF_BIT_IO::cbitsBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00101">minimum</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00541">MrcfFillBitBuffer()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.
<p>
<pre class="fragment"><div>00444                    :
00445 
00446     Get next N bits from bit buffer
00447 
00448 Arguments:
00449 
00450     cbits - count of bits to get
00451 
00452     BitIo - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bit buffer statics
00453 
00454 Return Value:
00455 
00456     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> - Returns next cbits bits.
00457 
00458 --*/
00459 
00460 {
00461     ULONG abits;        <span class="comment">// Bits to return</span>
00462     LONG cbitsPart;    <span class="comment">// Partial count of bits</span>
00463     ULONG cshift;       <span class="comment">// Shift count</span>
00464     ULONG mask;         <span class="comment">// Mask</span>
00465 
00466     <span class="comment">//</span>
00467     <span class="comment">//  Largest number of bits we should read at one time is 12 bits for</span>
00468     <span class="comment">//  a 12-bit offset.  The largest length field component that we</span>
00469     <span class="comment">//  read is 8 bits.  If this routine were used for some other purpose,</span>
00470     <span class="comment">//  it can support up to 15 (NOT 16) bit reads, due to how the masking</span>
00471     <span class="comment">//  code works.</span>
00472     <span class="comment">//</span>
00473 
00474     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(cbits &lt;= 12);
00475 
00476     <span class="comment">//</span>
00477     <span class="comment">//  No shift and no bits yet</span>
00478     <span class="comment">//</span>
00479 
00480     cshift = 0;
00481     abits = 0;
00482 
00483     <span class="keywordflow">while</span> (cbits &gt; 0) {
00484 
00485         <span class="comment">//</span>
00486         <span class="comment">//  If not bits available get some bits</span>
00487         <span class="comment">//</span>
00488 
00489         <span class="keywordflow">if</span> ((BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>) == 0) {
00490 
00491             <a class="code" href="../../d0/d4/mrcf_8c.html#a9">MrcfFillBitBuffer</a>(BitIo);
00492         }
00493 
00494         <span class="comment">//</span>
00495         <span class="comment">//  Number of bits we can read</span>
00496         <span class="comment">//</span>
00497 
00498         cbitsPart = <a class="code" href="../../d0/d4/mrcf_8c.html#a3">minimum</a>((BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>), cbits);
00499 
00500         <span class="comment">//</span>
00501         <span class="comment">//  Mask for bits we want, extract and store them</span>
00502         <span class="comment">//</span>
00503 
00504         mask = (1 &lt;&lt; cbitsPart) - 1;
00505         abits |= ((BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a>) &amp; mask) &lt;&lt; cshift;
00506 
00507         <span class="comment">//</span>
00508         <span class="comment">//  Remember the next chunk of bits</span>
00509         <span class="comment">//</span>
00510 
00511         cshift = cbitsPart;
00512 
00513         <span class="comment">//</span>
00514         <span class="comment">//  Update bit buffer, move remaining bits down and</span>
00515         <span class="comment">//  update count of bits left</span>
00516         <span class="comment">//</span>
00517 
00518         (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a>) &gt;&gt;= cbitsPart;
00519         (BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>) -= cbitsPart;
00520 
00521         <span class="comment">//</span>
00522         <span class="comment">//  Update count of bits left to read</span>
00523         <span class="comment">//</span>
00524 
00525         cbits -= cbitsPart;
00526     }
00527 
00528     <span class="comment">//</span>
00529     <span class="comment">//  Return requested bits</span>
00530     <span class="comment">//</span>
00531 
00532     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)abits;
00533 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="mrcf.c::MrcfSetBitBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MrcfSetBitBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>pb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d9/struct__MRCF__BIT__IO.html">PMRCF_BIT_IO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>BitIo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00347">347</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
References <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00039">_MRCF_BIT_IO::abitsBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00043">_MRCF_BIT_IO::cbBB</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00044">_MRCF_BIT_IO::cbBBInitial</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00040">_MRCF_BIT_IO::cbitsBB</a>, and <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00042">_MRCF_BIT_IO::pbBB</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">RtlDecompressBufferMrcf()</a>.
<p>
<pre class="fragment"><div>00355                    :
00356 
00357     Set statics with coded buffer pointer and length
00358 
00359 Arguments:
00360 
00361     pb - pointer to compressed data buffer
00362 
00363     cb - length of compressed data buffer
00364 
00365     BitIo - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bit buffer statics
00366 
00367 Return Value:
00368 
00369     None.
00370 
00371 --*/
00372 
00373 {
00374     BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o2">pbBB</a>        = pb;
00375     BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o3">cbBB</a>        = cb;
00376     BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o4">cbBBInitial</a> = cb;
00377     BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o1">cbitsBB</a>     = 0;
00378     BitIo-&gt;<a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html#o0">abitsBB</a>     = 0;
00379 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="mrcf.c::RtlDecompressBufferMrcf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlDecompressBufferMrcf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>UncompressedBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>UncompressedBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>CompressedBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CompressedBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>FinalUncompressedSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00132">132</a> of file <a class="el" href="../../d1/d3/mrcf_8c-source.html">mrcf.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00147">ASSERTMSG</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00094">MASK_VALID_mds</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00093">MD_STAMP</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00387">MrcfReadBit()</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00437">MrcfReadNBits()</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00347">MrcfSetBitBuffer()</a>, <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00091">PMDSIGNATURE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, and <a class="el" href="../../d1/d3/mrcf_8c-source.html#l00053">wBACKPOINTERMAX</a>.
<p>
<pre class="fragment"><div>00142                    :
00143 
00144     This routine decompresses a buffer of StandardCompressed or MaxCompressed
00145     data.
00146 
00147 Arguments:
00148 
00149     UncompressedBuffer - buffer to receive uncompressed data
00150 
00151     UncompressedBufferSize - length of UncompressedBuffer
00152 
00153           NOTE: UncompressedBufferSize must be <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> EXACT length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> uncompressed
00154                 data, as Decompress uses <span class="keyword">this</span> information to detect
00155                 when decompression <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> complete.  If <span class="keyword">this</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00156                 incorrect, Decompress may crash!
00157 
00158     CompressedBuffer - buffer containing compressed data
00159 
00160     CompressedBufferSize - length of CompressedBuffer
00161 
00162     WorkSpace - pointer to a <span class="keyword">private</span> work area <span class="keywordflow">for</span> use by <span class="keyword">this</span> operation
00163 
00164 Return Value:
00165 
00166     ULONG - Returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> decompressed data in bytes. Returns 0 <span class="keywordflow">if</span>
00167         there was an error in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> decompress.
00168 
00169 --*/
00170 
00171 {
00172     <a class="code" href="../../d5/d9/struct__MRCF__BIT__IO.html">MRCF_BIT_IO</a> WorkSpace;
00173 
00174     ULONG  cbMatch; <span class="comment">//  Length of match string</span>
00175     ULONG  i;       <span class="comment">//  Index in UncompressedBuffer to receive decoded data</span>
00176     ULONG  iMatch;  <span class="comment">//  Index in UncompressedBuffer of matched string</span>
00177     ULONG  k;       <span class="comment">//  Number of bits in length string</span>
00178     ULONG  off;     <span class="comment">//  Offset from i in UncompressedBuffer of match string</span>
00179     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> x;       <span class="comment">//  Current bit being examined</span>
00180     ULONG  y;
00181 
00182     <span class="comment">//</span>
00183     <span class="comment">//  verify that compressed data starts with proper signature</span>
00184     <span class="comment">//</span>
00185 
00186     <span class="keywordflow">if</span> (CompressedBufferSize &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a>) ||                            <span class="comment">// Must have signature</span>
00187         ((<a class="code" href="../../d8/d7/struct__MDSIGNATURE.html">PMDSIGNATURE</a>)CompressedBuffer)-&gt;sigStamp != <a class="code" href="../../d0/d4/mrcf_8c.html#a1">MD_STAMP</a> ||            <span class="comment">// Stamp must be OK</span>
00188         ((<a class="code" href="../../d8/d7/struct__MDSIGNATURE.html">PMDSIGNATURE</a>)CompressedBuffer)-&gt;sigType &amp; (~<a class="code" href="../../d0/d4/mrcf_8c.html#a2">MASK_VALID_mds</a>)) {     <span class="comment">// Type must be OK</span>
00189 
00190         *FinalUncompressedSize = 0;
00191         <span class="keywordflow">return</span> STATUS_BAD_COMPRESSION_BUFFER;
00192     }
00193 
00194     <span class="comment">//</span>
00195     <span class="comment">//  Skip over the valid signature</span>
00196     <span class="comment">//</span>
00197 
00198     CompressedBufferSize -= <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a>);
00199     CompressedBuffer += <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__MDSIGNATURE.html">MDSIGNATURE</a>);
00200 
00201     <span class="comment">//</span>
00202     <span class="comment">//  Set up for decompress, start filling UncompressedBuffer at front</span>
00203     <span class="comment">//</span>
00204 
00205     i = 0;
00206 
00207     <span class="comment">//</span>
00208     <span class="comment">//  Set statics to save parm passing</span>
00209     <span class="comment">//</span>
00210 
00211     <a class="code" href="../../d0/d4/mrcf_8c.html#a8">MrcfSetBitBuffer</a>(CompressedBuffer,CompressedBufferSize,&amp;WorkSpace);
00212 
00213     <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00214 
00215         y = <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(2,&amp;WorkSpace);
00216 
00217         <span class="comment">//</span>
00218         <span class="comment">//  Check if next 7 bits are a byte</span>
00219         <span class="comment">//  1 if 128..255 (0x80..0xff), 2 if 0..127 (0x00..0x7f)</span>
00220         <span class="comment">//</span>
00221 
00222         <span class="keywordflow">if</span> (y == 1 || y == 2) {
00223 
00224             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"Don't exceed expected length "</span>, i&lt;UncompressedBufferSize);
00225 
00226             UncompressedBuffer[i] = (UCHAR)((y == 1 ? 0x80 : 0) | <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(7,&amp;WorkSpace));
00227 
00228             i++;
00229 
00230         } <span class="keywordflow">else</span> {
00231 
00232             <span class="comment">//</span>
00233             <span class="comment">//  Have match sequence</span>
00234             <span class="comment">//</span>
00235 
00236             <span class="comment">//</span>
00237             <span class="comment">// Get the offset</span>
00238             <span class="comment">//</span>
00239 
00240             <span class="keywordflow">if</span> (y == 0) {
00241 
00242                 <span class="comment">//</span>
00243                 <span class="comment">//  next 6 bits are offset</span>
00244                 <span class="comment">//</span>
00245 
00246                 off = <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(6,&amp;WorkSpace);
00247 
00248                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"offset 0 is invalid "</span>, off != 0);
00249 
00250             } <span class="keywordflow">else</span> {
00251 
00252                 x = <a class="code" href="../../d0/d4/mrcf_8c.html#a10">MrcfReadBit</a>(&amp;WorkSpace);
00253 
00254                 <span class="keywordflow">if</span> (x == 0) {
00255 
00256                     <span class="comment">//</span>
00257                     <span class="comment">//  next 8 bits are offset-64 (0x40)</span>
00258                     <span class="comment">//</span>
00259 
00260                     off = <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(8, &amp;WorkSpace) + 64;
00261 
00262                 } <span class="keywordflow">else</span> {
00263 
00264                     <span class="comment">//</span>
00265                     <span class="comment">//  next 12 bits are offset-320 (0x140)</span>
00266                     <span class="comment">//</span>
00267 
00268                     off = <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(12, &amp;WorkSpace) + 320;
00269 
00270                     <span class="keywordflow">if</span> (off == <a class="code" href="../../d0/d4/mrcf_8c.html#a0">wBACKPOINTERMAX</a>) {
00271 
00272                         <span class="comment">//</span>
00273                         <span class="comment">//  EOS marker</span>
00274                         <span class="comment">//</span>
00275 
00276                         <span class="keywordflow">if</span> (i &gt;= UncompressedBufferSize) {
00277 
00278                             <span class="comment">//</span>
00279                             <span class="comment">// Done with entire buffer</span>
00280                             <span class="comment">//</span>
00281 
00282                             *FinalUncompressedSize = i;
00283                             <span class="keywordflow">return</span> STATUS_SUCCESS;
00284 
00285                         } <span class="keywordflow">else</span> {
00286 
00287                             <span class="comment">//</span>
00288                             <span class="comment">//  More to do</span>
00289                             <span class="comment">//  Done with a 512-byte chunk</span>
00290                             <span class="comment">//</span>
00291 
00292                             <span class="keywordflow">continue</span>;
00293                         }
00294                     }
00295                 }
00296             }
00297 
00298             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"Don't exceed expected length "</span>, i&lt;UncompressedBufferSize);
00299             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"Cannot match before start of uncoded buffer! "</span>, off &lt;= i);
00300 
00301             <span class="comment">//</span>
00302             <span class="comment">//  Get the length  - logarithmically encoded</span>
00303             <span class="comment">//</span>
00304 
00305             <span class="keywordflow">for</span> (k=0; (x=<a class="code" href="../../d0/d4/mrcf_8c.html#a10">MrcfReadBit</a>(&amp;WorkSpace)) == 0; k++) { NOTHING; }
00306 
00307             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(k &lt;= 8);
00308 
00309             <span class="keywordflow">if</span> (k == 0) {
00310 
00311                 <span class="comment">//</span>
00312                 <span class="comment">//  All matches at least 2 chars long</span>
00313                 <span class="comment">//</span>
00314 
00315                 cbMatch = 2;
00316 
00317             } <span class="keywordflow">else</span> {
00318 
00319                 cbMatch = (1 &lt;&lt; k) + 1 + <a class="code" href="../../d0/d4/mrcf_8c.html#a11">MrcfReadNBits</a>(k, &amp;WorkSpace);
00320             }
00321 
00322             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"Don't exceed buffer size "</span>, (i - off + cbMatch - 1) &lt;= UncompressedBufferSize);
00323 
00324             <span class="comment">//</span>
00325             <span class="comment">//  Copy the matched string</span>
00326             <span class="comment">//</span>
00327 
00328             iMatch = i - off;
00329 
00330             <span class="keywordflow">while</span> ( (cbMatch &gt; 0) &amp;&amp; (i&lt;UncompressedBufferSize) ) {
00331 
00332                 UncompressedBuffer[i++] = UncompressedBuffer[iMatch++];
00333                 cbMatch--;
00334             }
00335 
00336             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(<span class="stringliteral">"Should have copied it all "</span>, cbMatch == 0);
00337         }
00338     }
00339 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
