<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ddemlcli.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ddemlcli.h File Reference</h1>
<p>
<a href="../../d1/d3/ddemlcli_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">tagCHANDLEENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/structtagXACT__INFO.html">tagXACT_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/structtagADVISE__LINK.html">tagADVISE_LINK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">tagDDE_MESSAGE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">tagSERVER_LOOKUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/structtagLINK__COUNT.html">tagLINK_COUNT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">tagCL_INSTANCE_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d1/structtagCONV__INFO.html">tagCONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">tagCL_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">tagSVR_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d1/structtagCONVLIST.html">tagCONVLIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">tagENABLE_ENUM_STRUCT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d2/structtagDDEMLDATA.html">tagDDEMLDATA</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(cb)&nbsp;&nbsp;&nbsp;LocalAlloc(LPTR, cb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>(p, cb)&nbsp;&nbsp;&nbsp;LocalReAlloc(p, cb, LHND)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(p)&nbsp;&nbsp;&nbsp;LocalFree(p);</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a3">MONHSZ</a>(pcii, hsz, <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pcii, fEst, fNoD, aS, aT, aI, wFmt, fSvr, hConvS, hConvC)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a5">MONCONV</a>(pcoi, fConn)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>&nbsp;&nbsp;&nbsp;RtlEnterCriticalSection(&amp;<a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a>);</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>&nbsp;&nbsp;&nbsp;RtlLeaveCriticalSection(&amp;<a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a>);</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>&nbsp;&nbsp;&nbsp;;</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>&nbsp;&nbsp;&nbsp;;</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a11">HSZT_NORMAL</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a12">HSZT_INST_SPECIFIC</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)(ULONG_PTR)(hsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(a)&nbsp;&nbsp;&nbsp;(HSZ)(ULONG_PTR)(a)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a15">INST_SPECIFIC_HSZ_FROM_LATOM</a>(a)&nbsp;&nbsp;&nbsp;(HSZ)LongToHandle( MAKELONG(a, 1) )</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a16">MASK_ID</a>&nbsp;&nbsp;&nbsp;0xFF000000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a17">SHIFT_ID</a>&nbsp;&nbsp;&nbsp;24</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a18">MASK_INDEX</a>&nbsp;&nbsp;&nbsp;0x00FFFC00</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a19">SHIFT_INDEX</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a20">MASK_TYPE</a>&nbsp;&nbsp;&nbsp;0x00000380</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a21">SHIFT_TYPE</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a22">MASK_INST</a>&nbsp;&nbsp;&nbsp;0x0000007F</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a23">SHIFT_INST</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a24">MAX_INST</a>&nbsp;&nbsp;&nbsp;MASK_INST</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a25">IdFromHandle</a>(h)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_ID)     &gt;&gt; SHIFT_ID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a26">IndexFromHandle</a>(h)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_INDEX)  &gt;&gt; SHIFT_INDEX)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(h)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_TYPE)   &gt;&gt; SHIFT_TYPE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(h)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_INST)   &gt;&gt; SHIFT_INST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a29">HandleFromId</a>(h)&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_ID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a30">HandleFromIndex</a>(h)&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_INDEX)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a31">HandleFromType</a>(h)&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_TYPE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a32">HandleFromInst</a>(h)&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_INST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a33">HTYPE_EMPTY</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a34">HTYPE_INSTANCE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a35">HTYPE_SERVER_CONVERSATION</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a36">HTYPE_CLIENT_CONVERSATION</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a37">HTYPE_CONVERSATION_LIST</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a38">HTYPE_TRANSACTION</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a39">HTYPE_DATA_HANDLE</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a41">HTYPE_ANY</a>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(-1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a42">HINST_ANY</a>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(-1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a43">XIF_SYNCHRONOUS</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a44">XIF_COMPLETE</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a45">XIF_ABANDONED</a>&nbsp;&nbsp;&nbsp;0x4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a46">TID_TIMEOUT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a47">ADVST_WAITING</a>&nbsp;&nbsp;&nbsp;0x0080</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a48">ADVST_CHANGED</a>&nbsp;&nbsp;&nbsp;0x0040</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a49">IIF_IN_SYNC_XACT</a>&nbsp;&nbsp;&nbsp;0x0001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>&nbsp;&nbsp;&nbsp;0x8000</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef ATOM&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef ATOM&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">tagCHANDLEENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a54">CHANDLEENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">tagCHANDLEENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a55">PCHANDLEENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a56">PFNHANDLEAPPLY</a> )(HANDLE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/structtagXACT__INFO.html">tagXACT_INFO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a57">PXACT_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a> )(<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>, UINT, LPARAM)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/structtagXACT__INFO.html">tagXACT_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a59">XACT_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">tagLINK_COUNT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a60">PLINK_COUNT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">tagADVISE_LINK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a61">ADVISE_LINK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">tagADVISE_LINK</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a62">PADVISE_LINK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">tagDDE_MESSAGE_QUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a63">DDE_MESSAGE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">tagDDE_MESSAGE_QUEUE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a64">PDDE_MESSAGE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">tagSERVER_LOOKUP</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a65">SERVER_LOOKUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">tagSERVER_LOOKUP</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a66">PSERVER_LOOKUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">tagLINK_COUNT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a67">LINK_COUNT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">tagCL_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a68">CL_INSTANCE_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">tagCL_INSTANCE_INFO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a69">PCL_INSTANCE_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d1/structtagCONV__INFO.html">tagCONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a70">CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d1/structtagCONV__INFO.html">tagCONV_INFO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a71">PCONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">tagCL_CONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a72">CL_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">tagCL_CONV_INFO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a73">PCL_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">tagSVR_CONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a74">SVR_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">tagSVR_CONV_INFO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a75">PSVR_CONV_INFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d1/structtagCONVLIST.html">tagCONVLIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a76">CONVLIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d1/structtagCONVLIST.html">tagCONVLIST</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a77">PCONVLIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">tagENABLE_ENUM_STRUCT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a79">ENABLE_ENUM_STRUCT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">tagENABLE_ENUM_STRUCT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a80">PENABLE_ENUM_STRUCT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">tagDDEMLDATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a81">DDEMLDATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">tagDDEMLDATA</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a82">PDDEMLDATA</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a85">CreateHandle</a> (ULONG_PTR dwData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> inst)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a86">DestroyHandle</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a87">GetHandleData</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a88">SetHandleData</a> (HANDLE h, ULONG_PTR dwData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a89">ValidateCHandle</a> (HANDLE h, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ExpectedType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ExpectedInstance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a90">PciiFromHandle</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a91">FindIstanceHandleFromHandle</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a92">ApplyFunctionToObjects</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ExpectedType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ExpectedInstance, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a56">PFNHANDLEAPPLY</a> pfn)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a93">BestSetLastDDEMLError</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a94">RW_RegisterDDEML</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a95">InternalDdeInitialize</a> (LPDWORD pidInst, PFNCALLBACK pfnCallback, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmd, BOOL fUnicode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a96">AddInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a97">DestroyInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a98">ValidateInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a99">CsClearSecurityForAck</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, HWND hwndServer, HWND hwndClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a100">SetLastDDEMLError</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a101">InternalDdeCreateStringHandle</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, PVOID psz, int iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a102">InternalDdeQueryString</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz, PVOID psz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchMax, <a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a> iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a103">ValidateHSZ</a> (HSZ hsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a104">MakeInstSpecificAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, HWND hwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a105">ParseInstSpecificAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *plaNormal)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a106">LocalToGlobalAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a107">GlobalToLocalAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> ga)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a108">IncGlobalAtomCount</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> la)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a109">IncLocalAtomCount</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a110">ValidateConnectParameters</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> *ppcii, HSZ *phszService, HSZ hszTopic, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *plaNormalSvcName, PCONVCONTEXT *ppCC, HWND *phwndTarget, HCONVLIST hConvList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a111">ConnectConv</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laService, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laTopic, HWND hwndTarget, HWND hwndSkip, PCONVCONTEXT pCC, HCONVLIST hConvList, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clst)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a112">SetCommonStateFlags</a> (HWND hwndUs, HWND hwndThem, PWORD pwFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, BOOL fMakeCallback)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a115">WaitForZombieTerminate</a> (HANDLE hData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a116">GetConvContext</a> (HWND hwnd, LONG *pl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a117">SetConvContext</a> (HWND hwnd, LONG *pl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a118">UpdateLinkIfChanged</a> (<a class="el" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink, <a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, <a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLinkLast, PBOOL pfSwapped, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cLinksToGo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a119">LinkTransaction</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a120">UnlinkTransaction</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a121">ValidateTransaction</a> (HCONV hConv, HANDLE hXact, <a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> *ppcoi, <a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> *ppxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDDEDATA&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a122">InternalCreateDataHandle</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, LPBYTE pSrc, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbOff, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> flags, WORD wStatus, WORD wFmt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a123">ApplyFreeDataHandle</a> (HANDLE hData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a124">InternalFreeDataHandle</a> (HDDEDATA hData, BOOL fIgnorefRelease)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a125">FreeDDEData</a> (HANDLE hDDE, BOOL fIgnorefRelease, BOOL fFreeTruelyGlobalObjects)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a126">CopyDDEData</a> (HANDLE hDDE, BOOL fExec)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDDEDATA&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, WORD wType, WORD wFmt, HCONV hConv, HSZ hsz1, HSZ hsz2, HDDEDATA hData, ULONG_PTR dw1, ULONG_PTR dw2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a128">_ClientEventCallback</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> pep)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a129">SetEnableState</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, UINT wCmd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a130">_ClientGetDDEHookData</a> (UINT message, LPARAM lParam, PDDEML_MSG_HOOK_DATA pdmhd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a131">_ClientGetDDEFlags</a> (HANDLE hClient, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a132">EnableEnumProc</a> (HWND hwnd, <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">PENABLE_ENUM_STRUCT</a> pees)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a133">DDEMLMotherWndProc</a> (HWND, UINT, WPARAM, LPARAM)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a134">DDEMLClientWndProc</a> (HWND, UINT, WPARAM, LPARAM)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a135">DDEMLServerWndProc</a> (HWND, UINT, WPARAM, LPARAM)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a136">ProcessTerminateMsg</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, HWND hwndFrom)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a137">ProcessAsyncDDEMsg</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, HWND hwndFrom, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a138">CheckForQueuedMessages</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a139">DumpDDEMessage</a> (BOOL fFreeData, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a140">ProcessSyncDDEMessage</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a141">ClStartAdvise</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a142">SvSpontAdvise</a> (<a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a143">ClRespAdviseAck</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a144">SvStartAdviseUpdate</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cLinksToGo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a145">ClSpontAdviseData</a> (<a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a146">SvRespAdviseDataAck</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a147">ClStartUnadvise</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a148">SvSpontUnadvise</a> (<a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a149">ClRespUnadviseAck</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a150">ClStartExecute</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a151">ClRespExecuteAck</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a152">ClStartPoke</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a153">SvSpontPoke</a> (<a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a154">ClRespPokeAck</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a155">ClStartRequest</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a156">SvSpontRequest</a> (<a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a157">ClRespRequestData</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a158">SpontaneousClientMessage</a> (<a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a159">SpontaneousServerMessage</a> (<a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a160">AllocAndSetDDEData</a> (LPBYTE pSrc, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb, WORD wStatus, WORD wFmt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a161">PackAndPostMessage</a> (HWND hwndTo, UINT msgIn, UINT msgOut, HWND hwndFrom, LPARAM lParam, UINT_PTR uiLo, UINT_PTR uiHi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a162">ExtractDDEDataInfo</a> (HANDLE hDDE, LPWORD pwStatus, LPWORD pwFmt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a163">TransactionComplete</a> (<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi, HDDEDATA hData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a164">UnpackAndFreeDDEMLDataHandle</a> (HDDEDATA hData, BOOL fExec)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a165">AddLink</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaItem, WORD wFmt, WORD wType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a166">DeleteLinkCount</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">PLINK_COUNT</a> pLinkCountDelete)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a167">MonitorStringHandle</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, HSZ hsz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fsAction)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a168">MonitorLink</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, BOOL fEstablished, BOOL fNoData, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laSvc, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laTopic, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaItem, WORD wFmt, BOOL fServer, HCONV hConvServer, HCONV hConvClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a169">MonitorConv</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, BOOL fConnect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a170">RegisterService</a> (BOOL fRegister, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaApp, HWND hwndListen)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a171">ProcessRegistrationMessage</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>RTL_CRITICAL_SECTION&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONVCONTEXT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a78">DefConvContext</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PHANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/ddemlcli_8h.html#a84">gWM_REGISTERCALLBACK</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a48" doxytag="ddemlcli.h::ADVST_CHANGED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ADVST_CHANGED&nbsp;&nbsp;&nbsp;0x0040          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00154">154</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ddemlcli.h::ADVST_WAITING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ADVST_WAITING&nbsp;&nbsp;&nbsp;0x0080          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00153">153</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ddemlcli.h::CheckDDECritIn" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CheckDDECritIn&nbsp;&nbsp;&nbsp;;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">58</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">CheckForQueuedMessages()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ddemlcli.h::CheckDDECritOut" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CheckDDECritOut&nbsp;&nbsp;&nbsp;;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">59</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00451">ApplyFreeDataHandle()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00068">RegisterService()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ddemlcli.h::DDEMLAlloc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DDEMLAlloc          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cb&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;LocalAlloc(LPTR, cb)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">16</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00620">CopyPalette()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ddemlcli.h::DDEMLFree" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DDEMLFree          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;LocalFree(p);</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">18</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">CheckForQueuedMessages()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00599">CloseTransaction()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00620">CopyPalette()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00123">DeleteLinkCount()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ddemlcli.h::DDEMLReAlloc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DDEMLReAlloc          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cb&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;LocalReAlloc(p, cb, LHND)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">17</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ddemlcli.h::EnterDDECrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EnterDDECrit&nbsp;&nbsp;&nbsp;RtlEnterCriticalSection(&amp;<a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a>);          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">48</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00451">ApplyFreeDataHandle()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00405">DdeGetLastError()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00496">DDEMLServerWndProc()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00489">DdeSetUserHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00346">DdeUnaccessData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ddemlcli.h::HandleFromId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HandleFromId          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_ID)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00097">97</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ddemlcli.h::HandleFromIndex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HandleFromIndex          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_INDEX)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00098">98</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ddemlcli.h::HandleFromInst" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HandleFromInst          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_INST)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00100">100</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ddemlcli.h::HandleFromType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HandleFromType          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(h)) &lt;&lt; SHIFT_TYPE)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00099">99</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ddemlcli.h::HINST_ANY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HINST_ANY&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(-1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">112</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00346">DdeUnaccessData()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ddemlcli.h::HSZT_INST_SPECIFIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HSZT_INST_SPECIFIC&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00067">67</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ddemlcli.h::HSZT_INVALID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HSZT_INVALID&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">65</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ddemlcli.h::HSZT_NORMAL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HSZT_NORMAL&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00066">66</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ddemlcli.h::HTYPE_ANY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_ANY&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(-1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00111">111</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ddemlcli.h::HTYPE_CLIENT_CONVERSATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_CLIENT_CONVERSATION&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">105</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ddemlcli.h::HTYPE_CONVERSATION_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_CONVERSATION_LIST&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">106</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ddemlcli.h::HTYPE_DATA_HANDLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_DATA_HANDLE&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00108">108</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00346">DdeUnaccessData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ddemlcli.h::HTYPE_EMPTY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_EMPTY&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00102">102</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ddemlcli.h::HTYPE_INSTANCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_INSTANCE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">103</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ddemlcli.h::HTYPE_SERVER_CONVERSATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_SERVER_CONVERSATION&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00104">104</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ddemlcli.h::HTYPE_TRANSACTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_TRANSACTION&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00107">107</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ddemlcli.h::HTYPE_ZOMBIE_CONVERSATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HTYPE_ZOMBIE_CONVERSATION&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">109</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ddemlcli.h::IdFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IdFromHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_ID)     &gt;&gt; SHIFT_ID)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00092">92</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ddemlcli.h::IIF_IN_SYNC_XACT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IIF_IN_SYNC_XACT&nbsp;&nbsp;&nbsp;0x0001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00205">205</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ddemlcli.h::IIF_UNICODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IIF_UNICODE&nbsp;&nbsp;&nbsp;0x8000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">206</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ddemlcli.h::IndexFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IndexFromHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_INDEX)  &gt;&gt; SHIFT_INDEX)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00093">93</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ddemlcli.h::INST_SPECIFIC_HSZ_FROM_LATOM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INST_SPECIFIC_HSZ_FROM_LATOM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(HSZ)LongToHandle( MAKELONG(a, 1) )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00071">71</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, and <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ddemlcli.h::InstFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define InstFromHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_INST)   &gt;&gt; SHIFT_INST)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">95</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">DestroyInstance()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ddemlcli.h::LATOM_FROM_HSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LATOM_FROM_HSZ          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hsz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)(ULONG_PTR)(hsz)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">69</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ddemlcli.h::LeaveDDECrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LeaveDDECrit&nbsp;&nbsp;&nbsp;RtlLeaveCriticalSection(&amp;<a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a>);          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">49</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00451">ApplyFreeDataHandle()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00405">DdeGetLastError()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00496">DDEMLServerWndProc()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00489">DdeSetUserHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00346">DdeUnaccessData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ddemlcli.h::MASK_ID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MASK_ID&nbsp;&nbsp;&nbsp;0xFF000000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00082">82</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ddemlcli.h::MASK_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MASK_INDEX&nbsp;&nbsp;&nbsp;0x00FFFC00          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00084">84</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ddemlcli.h::MASK_INST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MASK_INST&nbsp;&nbsp;&nbsp;0x0000007F          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00088">88</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ddemlcli.h::MASK_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MASK_TYPE&nbsp;&nbsp;&nbsp;0x00000380          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00086">86</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ddemlcli.h::MAX_INST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_INST&nbsp;&nbsp;&nbsp;MASK_INST          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00090">90</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ddemlcli.h::MONCONV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MONCONV          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pcoi,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fConn&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (((pcoi)-&gt;pcii-&gt;MonitorFlags &amp; MF_CONV) &amp;&amp; \
                ((((pcoi)-&gt;state &amp; ST_ISLOCAL) &amp;&amp; (pcoi)-&gt;state &amp; ST_CLIENT) || \
                !((pcoi)-&gt;state &amp; ST_ISLOCAL))) \
            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a169">MonitorConv</a>(pcoi, fConn);
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00036">36</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ddemlcli.h::MONHSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MONHSZ          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pcii,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>hsz,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> ((pcii-&gt;MonitorFlags &amp; MF_HSZ_INFO) &amp;&amp; hsz) \
                                        <a class="code" href="../../d0/d4/ddemlcli_8h.html#a167">MonitorStringHandle</a>(pcii, hsz, type)
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00029">29</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ddemlcli.h::MONLINK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MONLINK          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pcii,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fEst,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fNoD,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>aS,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>aT,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>aI,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>wFmt,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fSvr,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>hConvS,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>hConvC&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (pcii-&gt;MonitorFlags &amp; MF_LINKS) \
            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a168">MonitorLink</a>(pcii, fEst, fNoD, aS, aT, aI, \
            wFmt, fSvr, hConvS, hConvC)
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">31</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ddemlcli.h::NORMAL_HSZ_FROM_LATOM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NORMAL_HSZ_FROM_LATOM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(HSZ)(ULONG_PTR)(a)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">70</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ddemlcli.h::SHIFT_ID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SHIFT_ID&nbsp;&nbsp;&nbsp;24          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00083">83</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ddemlcli.h::SHIFT_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SHIFT_INDEX&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00085">85</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ddemlcli.h::SHIFT_INST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SHIFT_INST&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00089">89</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ddemlcli.h::SHIFT_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SHIFT_TYPE&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00087">87</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ddemlcli.h::TID_TIMEOUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TID_TIMEOUT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00140">140</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ddemlcli.h::TypeFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TypeFromHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(((ULONG_PTR)(h) &amp; MASK_TYPE)   &gt;&gt; SHIFT_TYPE)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">94</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">ApplyFunctionToObjects()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ddemlcli.h::XIF_ABANDONED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define XIF_ABANDONED&nbsp;&nbsp;&nbsp;0x4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00138">138</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00517">AbandonTransaction()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ddemlcli.h::XIF_COMPLETE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define XIF_COMPLETE&nbsp;&nbsp;&nbsp;0x2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00137">137</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ddemlcli.h::XIF_SYNCHRONOUS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define XIF_SYNCHRONOUS&nbsp;&nbsp;&nbsp;0x1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00136">136</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a61" doxytag="ddemlcli.h::ADVISE_LINK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">tagADVISE_LINK</a>  <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ddemlcli.h::CHANDLEENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">tagCHANDLEENTRY</a>  <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">CHANDLEENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="ddemlcli.h::CL_CONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">tagCL_CONV_INFO</a>  <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">CL_CONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="ddemlcli.h::CL_INSTANCE_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">tagCL_INSTANCE_INFO</a>  <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">CL_INSTANCE_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="ddemlcli.h::CONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d1/structtagCONV__INFO.html">tagCONV_INFO</a>  <a class="el" href="../../d2/d1/structtagCONV__INFO.html">CONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="ddemlcli.h::CONVLIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d1/structtagCONVLIST.html">tagCONVLIST</a>  <a class="el" href="../../d3/d1/structtagCONVLIST.html">CONVLIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="ddemlcli.h::DDE_MESSAGE_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">tagDDE_MESSAGE_QUEUE</a>  <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">DDE_MESSAGE_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="ddemlcli.h::DDEMLDATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">tagDDEMLDATA</a>  <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">DDEMLDATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="ddemlcli.h::ENABLE_ENUM_STRUCT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">tagENABLE_ENUM_STRUCT</a>  <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">ENABLE_ENUM_STRUCT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ddemlcli.h::FNRESPONSE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(*  <a class="el" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)(<a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>, UINT, LPARAM)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">118</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ddemlcli.h::GATOM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef ATOM <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">25</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ddemlcli.h::LATOM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef ATOM <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">24</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00367">MakeInstSpecificAtom()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="ddemlcli.h::LINK_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">tagLINK_COUNT</a>  <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">LINK_COUNT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ddemlcli.h::PADVISE_LINK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">tagADVISE_LINK</a> * <a class="el" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ddemlcli.h::PCHANDLEENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">tagCHANDLEENTRY</a> * <a class="el" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="ddemlcli.h::PCL_CONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">tagCL_CONV_INFO</a> * <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="ddemlcli.h::PCL_INSTANCE_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">tagCL_INSTANCE_INFO</a> * <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="ddemlcli.h::PCONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d1/structtagCONV__INFO.html">tagCONV_INFO</a> * <a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="ddemlcli.h::PCONVLIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d1/structtagCONVLIST.html">tagCONVLIST</a> * <a class="el" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="ddemlcli.h::PDDE_MESSAGE_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">tagDDE_MESSAGE_QUEUE</a> * <a class="el" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">PDDE_MESSAGE_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="ddemlcli.h::PDDEMLDATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">tagDDEMLDATA</a> * <a class="el" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="ddemlcli.h::PENABLE_ENUM_STRUCT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">tagENABLE_ENUM_STRUCT</a> * <a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">PENABLE_ENUM_STRUCT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">EnableEnumProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ddemlcli.h::PFNHANDLEAPPLY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(* <a class="el" href="../../d0/d4/ddemlcli_8h.html#a56">PFNHANDLEAPPLY</a>)(HANDLE)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00080">80</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="ddemlcli.h::PLINK_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">tagLINK_COUNT</a>* <a class="el" href="../../d0/d0/structtagLINK__COUNT.html">PLINK_COUNT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00144">144</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="ddemlcli.h::PSERVER_LOOKUP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">tagSERVER_LOOKUP</a> * <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">PSERVER_LOOKUP</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="ddemlcli.h::PSVR_CONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">tagSVR_CONV_INFO</a> * <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l00511">RW_RegisterDDEML()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ddemlcli.h::PXACT_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/structtagXACT__INFO.html">tagXACT_INFO</a>* <a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00116">116</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="ddemlcli.h::SERVER_LOOKUP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">tagSERVER_LOOKUP</a>  <a class="el" href="../../d1/d6/structtagSERVER__LOOKUP.html">SERVER_LOOKUP</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="ddemlcli.h::SVR_CONV_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">tagSVR_CONV_INFO</a>  <a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">SVR_CONV_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ddemlcli.h::XACT_INFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/structtagXACT__INFO.html">tagXACT_INFO</a>  <a class="el" href="../../d0/d0/structtagXACT__INFO.html">XACT_INFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a128" doxytag="ddemlcli.h::_ClientEventCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> _ClientEventCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pep</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">129</a> of file <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html">w32/ntuser/client/callback.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00071">INST_SPECIFIC_HSZ_FROM_LATOM</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00905">RtlUnicodeToMultiByteN()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>00132 {
00133     HDDEDATA hData;
00134 
00135     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00136 
00137     <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType) {
00138     <span class="keywordflow">case</span> 0: <span class="comment">// MonitorFlags change event - everybody gets it</span>
00139         pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> = <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data;
00140         <span class="keywordflow">break</span>;
00141 
00142     <span class="keywordflow">case</span> MF_CALLBACKS:
00143         {
00144             MONCBSTRUCT mcb;
00145 
00146             mcb = *((MONCBSTRUCT *)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data);
00147             mcb.hsz1 = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)mcb.hsz1));
00148             mcb.hsz2 = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)mcb.hsz2));
00149             <span class="keywordflow">if</span> (    mcb.wType == XTYP_REGISTER ||
00150                     mcb.wType == XTYP_UNREGISTER) {
00151                 mcb.hsz2 = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a15">INST_SPECIFIC_HSZ_FROM_LATOM</a>((LATOM)(ULONG_PTR)mcb.hsz2);
00152             }
00153             hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pcii, (LPSTR)&amp;mcb,
00154                     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData, 0,
00155                     HDATA_NOAPPFREE | HDATA_READONLY | HDATA_EXECUTE, 0, 0);
00156             <span class="keywordflow">if</span> (hData) {
00157                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii, (WORD)XTYP_MONITOR, 0, 0, 0, 0, hData, 0L,
00158                         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType);
00159                 <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>((HDDEDATA)hData, TRUE);
00160                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(mcb.hsz1));
00161                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(mcb.hsz2));
00162             }
00163         }
00164         <span class="keywordflow">break</span>;
00165 
00166     <span class="keywordflow">case</span> MF_LINKS:
00167         {
00168             MONLINKSTRUCT ml;
00169 
00170             ml = *((MONLINKSTRUCT *)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data);
00171             ml.hszSvc = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)ml.hszSvc));
00172             ml.hszTopic = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)ml.hszTopic));
00173             ml.hszItem = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)ml.hszItem));
00174             hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pcii, (LPSTR)&amp;ml,
00175                     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData, 0,
00176                     HDATA_NOAPPFREE | HDATA_READONLY | HDATA_EXECUTE, 0, 0);
00177             <span class="keywordflow">if</span> (hData) {
00178                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii, (WORD)XTYP_MONITOR, 0, 0, 0, 0, hData, 0L,
00179                         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType);
00180                 <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>((HDDEDATA)hData, TRUE);
00181                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(ml.hszSvc));
00182                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(ml.hszTopic));
00183                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(ml.hszItem));
00184             }
00185         }
00186         <span class="keywordflow">break</span>;
00187 
00188     <span class="keywordflow">case</span> MF_CONV:
00189         {
00190             MONCONVSTRUCT mc;
00191 
00192             mc = *((MONCONVSTRUCT *)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data);
00193             mc.hszSvc = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)mc.hszSvc));
00194             mc.hszTopic = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(<a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)(ULONG_PTR)mc.hszTopic));
00195             hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pcii, (LPSTR)&amp;mc,
00196                     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData, 0,
00197                     HDATA_NOAPPFREE | HDATA_READONLY | HDATA_EXECUTE, 0, 0);
00198             <span class="keywordflow">if</span> (hData) {
00199                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii, (WORD)XTYP_MONITOR, 0, 0, 0, 0, hData, 0L,
00200                         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType);
00201                 <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>((HDDEDATA)hData, TRUE);
00202                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(mc.hszSvc));
00203                 DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(mc.hszTopic));
00204             }
00205         }
00206         <span class="keywordflow">break</span>;
00207 
00208     <span class="keywordflow">case</span> MF_HSZ_INFO:
00209         <span class="keywordflow">if</span> (!(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>)) {
00210             LPSTR pszAnsi;
00211             <span class="comment">/*</span>
00212 <span class="comment">             * Translate HSZ string back into ANSI</span>
00213 <span class="comment">             */</span>
00214             <span class="keywordflow">if</span> (WCSToMB(((PMONHSZSTRUCT)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data)-&gt;str,
00215                     ((<span class="keywordtype">int</span>)<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData - (<span class="keywordtype">int</span>)((PMONHSZSTRUCT)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data)-&gt;cb) / <span class="keyword">sizeof</span>(WCHAR),
00216                     &amp;pszAnsi,
00217                     (<span class="keywordtype">int</span>)<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData - (<span class="keywordtype">int</span>)((PMONHSZSTRUCT)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data)-&gt;cb,
00218                     TRUE)) {
00219                 strcpy(((PMONHSZSTRUCTA)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data)-&gt;str, pszAnsi);
00220                 <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pszAnsi);
00221             }
00222             ((PMONHSZSTRUCT)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data)-&gt;cb = <span class="keyword">sizeof</span>(MONHSZSTRUCTA);
00223         }
00224         <span class="comment">// fall through</span>
00225     <span class="keywordflow">case</span> MF_SENDMSGS:
00226     <span class="keywordflow">case</span> MF_POSTMSGS:
00227         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType == MF_POSTMSGS) {
00228             PMONMSGSTRUCT pmms = (PMONMSGSTRUCT)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data;
00229             <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> buf[32];
00230 
00231             <span class="comment">/*</span>
00232 <span class="comment">             * We may need to translate the Execute string to/from</span>
00233 <span class="comment">             * UNICODE depending on what type of monitor this is</span>
00234 <span class="comment">             * going to.</span>
00235 <span class="comment">             */</span>
00236             <span class="keywordflow">if</span> (pmms-&gt;wMsg == WM_DDE_EXECUTE) {
00237                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fUnicodeText;
00238                 <span class="keywordtype">int</span> flags;
00239 
00240                 flags = (IS_TEXT_UNICODE_UNICODE_MASK |
00241                         IS_TEXT_UNICODE_REVERSE_MASK |
00242                         (IS_TEXT_UNICODE_NOT_UNICODE_MASK &amp;
00243                         (~IS_TEXT_UNICODE_ILLEGAL_CHARS)) |
00244                         IS_TEXT_UNICODE_NOT_ASCII_MASK);
00245 <span class="preprocessor">#ifdef ISTEXTUNICODE_WORKS</span>
00246 <span class="preprocessor"></span>                fUnicodeText = <a class="code" href="../../d6/d6/nls_8c.html#a50">RtlIsTextUnicode</a>(pmms-&gt;dmhd.Data,
00247                         <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(32, pmms-&gt;dmhd.cbData), &amp;flags);
00248 <span class="preprocessor">#else</span>
00249 <span class="preprocessor"></span>                fUnicodeText = (*(LPSTR)pmms-&gt;dmhd.Data == <span class="charliteral">'\0'</span>);
00250 <span class="preprocessor">#endif</span>
00251 <span class="preprocessor"></span>
00252                 <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a> &amp;&amp; !fUnicodeText) {
00253                     <span class="comment">/* Ascii-&gt;UNICODE */</span>
00254                     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>((LPWSTR)buf, 32, NULL,
00255                             (LPSTR)&amp;pmms-&gt;dmhd.Data,
00256                             <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(32, pmms-&gt;dmhd.cbData));
00257                     RtlCopyMemory(&amp;pmms-&gt;dmhd.Data, buf, 32);
00258                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>) &amp;&amp; fUnicodeText) {
00259                     <span class="comment">/* UNICODE-&gt;Ascii */</span>
00260                     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>((LPSTR)buf, 32, NULL,
00261                             (LPWSTR)&amp;pmms-&gt;dmhd.Data,
00262                             <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(32, pmms-&gt;dmhd.cbData));
00263                     RtlCopyMemory(&amp;pmms-&gt;dmhd.Data, buf, 32);
00264                 }
00265             }
00266         }
00267     <span class="keywordflow">case</span> MF_ERRORS:
00268         hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pcii, (LPSTR)&amp;<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;Data,
00269                 <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData, 0,
00270                 HDATA_NOAPPFREE | HDATA_READONLY | HDATA_EXECUTE, 0, 0);
00271         <span class="keywordflow">if</span> (hData) {
00272             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii, (WORD)XTYP_MONITOR, 0, 0, 0, 0, hData, 0L,
00273                     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType);
00274             <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>((HDDEDATA)hData, TRUE);
00275         }
00276         <span class="keywordflow">break</span>;
00277     }
00278 
00279     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00280     <span class="keywordflow">return</span> (0);
00281 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a131" doxytag="ddemlcli.h::_ClientGetDDEFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> _ClientGetDDEFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hClient</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00532">532</a> of file <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html">client/ddetrack.c</a>.
<p>
<pre class="fragment"><div>00535 {
00536     <a class="code" href="../../d9/d2/structtagDDEPACK.html">PDDEPACK</a> pDdePack;
00537     PWORD pw;
00538     HANDLE hData;
00539     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> retval = 0;
00540 
00541     pDdePack = (<a class="code" href="../../d9/d2/structtagDDEPACK.html">PDDEPACK</a>)hDDE;
00542     <span class="keywordflow">if</span> (pDdePack == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00543         <span class="keywordflow">return</span> (0);
00544     }
00545 
00546     <span class="keywordflow">if</span> (flags &amp; <a class="code" href="../../d6/d4/ddetrack_8h.html#a1">XS_DATA</a>) {
00547         <span class="keywordflow">if</span> (pDdePack-&gt;<a class="code" href="../../d9/d2/structtagDDEPACK.html#o0">uiLo</a>) {
00548             hData = (HANDLE)pDdePack-&gt;<a class="code" href="../../d9/d2/structtagDDEPACK.html#o0">uiLo</a>;
00549             <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hData, pw);
00550             <span class="keywordflow">if</span> (pw != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00551                 retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)*pw; <span class="comment">// first word is hData is wStatus</span>
00552                 <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hData);
00553             }
00554         }
00555     } <span class="keywordflow">else</span> {
00556         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)pDdePack-&gt;<a class="code" href="../../d9/d2/structtagDDEPACK.html#o0">uiLo</a>;
00557     }
00558 
00559     <span class="keywordflow">return</span> (retval);
00560 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a130" doxytag="ddemlcli.h::_ClientGetDDEHookData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> _ClientGetDDEHookData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PDDEML_MSG_HOOK_DATA&nbsp;</td>
          <td class="mdname" nowrap> <em>pdmhd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00500">500</a> of file <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html">w32/ntuser/client/callback.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00130">UserGlobalSize</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>.
<p>
<pre class="fragment"><div>00504 {
00505     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pb;
00506     HANDLE hDDE;
00507 
00508     <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(message, lParam, &amp;pdmhd-&gt;uiLo, &amp;pdmhd-&gt;uiHi);
00509     <span class="keywordflow">switch</span> (message) {
00510     <span class="keywordflow">case</span> WM_DDE_DATA:
00511     <span class="keywordflow">case</span> WM_DDE_POKE:
00512     <span class="keywordflow">case</span> WM_DDE_ADVISE:
00513         hDDE = (HANDLE)pdmhd-&gt;uiLo;
00514         <span class="keywordflow">break</span>;
00515 
00516     <span class="keywordflow">case</span> WM_DDE_EXECUTE:
00517         hDDE = (HANDLE)pdmhd-&gt;uiHi;
00518         <span class="keywordflow">break</span>;
00519 
00520     <span class="keywordflow">case</span> WM_DDE_ACK:
00521     <span class="keywordflow">case</span> WM_DDE_REQUEST:
00522     <span class="keywordflow">case</span> WM_DDE_UNADVISE:
00523     <span class="keywordflow">case</span> WM_DDE_TERMINATE:
00524         pdmhd-&gt;cbData = 0;
00525         <span class="keywordflow">return</span> (1);
00526     }
00527 
00528     pdmhd-&gt;cbData = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a6">UserGlobalSize</a>(hDDE);
00529     <span class="keywordflow">if</span> (pdmhd-&gt;cbData) {
00530         <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pb);
00531         <span class="keywordflow">if</span> (pb == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00532             pdmhd-&gt;cbData = 0;
00533         } <span class="keywordflow">else</span> {
00534             RtlCopyMemory(&amp;pdmhd-&gt;Data, pb, <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(pdmhd-&gt;cbData,
00535                     <span class="keyword">sizeof</span>(DDEML_MSG_HOOK_DATA) -
00536                     FIELD_OFFSET(DDEML_MSG_HOOK_DATA, Data)));
00537             <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00538         }
00539     }
00540     <span class="keywordflow">return</span> (1);
00541 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="ddemlcli.h::AddInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE AddInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">40</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00262">aInstance</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00022">cInstAllocated</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">DDEMLReAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00023">iFirstFreeInst</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00017">INST_GROW_COUNT</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00090">MAX_INST</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>.
<p>
<pre class="fragment"><div>00042 {
00043     <span class="keywordtype">int</span> i, iNextFree;
00044     PHANDLE ph;
00045 
00046     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> &gt;= <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a>) {
00047         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> == 0) {
00048            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> = (PHANDLE)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(HANDLE) * INST_GROW_COUNT);
00049         } <span class="keywordflow">else</span> {
00050            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> = (PHANDLE)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>((PVOID)aInstance,
00051                  <span class="keyword">sizeof</span>(HANDLE) * (cInstAllocated + INST_GROW_COUNT));
00052         }
00053         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> == 0) {
00054             <span class="keywordflow">return</span> (0);
00055         }
00056         ph = &amp;<a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a>];
00057         i = <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> + 1;
00058         <span class="keywordflow">while</span> (i &lt;= <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> + <a class="code" href="../../d0/d4/instance_8c.html#a0">INST_GROW_COUNT</a>) {
00059            *ph++ = (HANDLE)(UINT_PTR)(<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)i++;
00060         }
00061         <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> += <a class="code" href="../../d0/d4/instance_8c.html#a0">INST_GROW_COUNT</a>;
00062     }
00063     iNextFree = HandleToUlong(aInstance[iFirstFreeInst]);
00064     <span class="keywordflow">if</span> (iNextFree &gt; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a24">MAX_INST</a>) {
00065         <span class="comment">/*</span>
00066 <span class="comment">         * Instance limit for this process exceeded!</span>
00067 <span class="comment">         */</span>
00068         <span class="keywordflow">return</span>(0);
00069     }
00070     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a>] = hInstServer;
00071     i = <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a>;
00072     <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = iNextFree;
00073     <span class="keywordflow">return</span> (<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>(0, HTYPE_INSTANCE, i));
00074 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a165" doxytag="ddemlcli.h::AddLink" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL AddLink           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>gaItem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/util_8c-source.html#l00023">23</a> of file <a class="el" href="../../d3/d1/util_8c-source.html">util.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">DDEMLReAlloc</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00176">tagLINK_COUNT::gaItem</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00177">tagLINK_COUNT::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00175">tagLINK_COUNT::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00174">tagLINK_COUNT::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00146">tagADVISE_LINK::pLinkCount</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00202">tagCL_INSTANCE_INFO::pLinkCount</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00150">tagADVISE_LINK::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00179">tagLINK_COUNT::Total</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00178">tagLINK_COUNT::wFmt</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>.
<p>
<pre class="fragment"><div>00028 {
00029     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> aLinkNew;
00030     <span class="keywordtype">int</span> cLinks;
00031     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
00032     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00033 
00034     <span class="comment">/*</span>
00035 <span class="comment">     * if the link already exists, update its flags, otherwise create a</span>
00036 <span class="comment">     * new one.</span>
00037 <span class="comment">     */</span>
00038 
00039     aLinkNew = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>;
00040     cLinks = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;
00041     la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>(gaItem);     <span class="comment">// aLinkNew copy</span>
00042     <span class="keywordflow">while</span> (cLinks) {
00043         <span class="keywordflow">if</span> (aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> == la &amp;&amp; aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a> == wFmt) {
00044             aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> = wType;
00045             aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> = 0;
00046             DeleteAtom(la);
00047             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00048         }
00049         aLinkNew++;
00050         cLinks--;
00051     }
00052 
00053     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00054         aLinkNew = (<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a>));
00055     } <span class="keywordflow">else</span> {
00056         aLinkNew = (<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>,
00057                 <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a>) * (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a> + 1));
00058     }
00059     <span class="keywordflow">if</span> (aLinkNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00060         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
00061         DeleteAtom(la);
00062         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00063     }
00064     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a> = aLinkNew;
00065     aLinkNew += pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;
00066     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>++;
00067 
00068     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> = la;
00069     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a> = wFmt;
00070     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> = wType;
00071     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> = 0;
00072 
00073     <span class="keywordflow">if</span> (!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT)) {
00074         <span class="comment">/*</span>
00075 <span class="comment">         * Add count for this link</span>
00076 <span class="comment">         */</span>
00077         pcii = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>;
00078 
00079         <span class="keywordflow">for</span> (aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a> = pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o18">pLinkCount</a>;
00080                 aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>;
00081                     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a> = aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a>) {
00082             <span class="keywordflow">if</span> (aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o1">laTopic</a> == pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a> &amp;&amp;
00083                     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o2">gaItem</a> == gaItem &amp;&amp;
00084                     aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o4">wFmt</a> == wFmt) {
00085                 aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o5">Total</a>++;
00086                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00087             }
00088         }
00089 
00090         <span class="comment">/*</span>
00091 <span class="comment">         * Not found - add an entry</span>
00092 <span class="comment">         */</span>
00093         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a> = (<a class="code" href="../../d0/d0/structtagLINK__COUNT.html">PLINK_COUNT</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d0/structtagLINK__COUNT.html">LINK_COUNT</a>));
00094         <span class="keywordflow">if</span> (aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00095             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
00096             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00097         }
00098         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a> = pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o18">pLinkCount</a>;
00099         pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o18">pLinkCount</a> = aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>;
00100 
00101         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o1">laTopic</a> = <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>); <span class="comment">// LinkCount copy</span>
00102         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o2">gaItem</a> = <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(gaItem); <span class="comment">// LinkCount copy</span>
00103         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o3">laItem</a> = <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(la); <span class="comment">// LinkCount copy</span>
00104 
00105         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o4">wFmt</a> = wFmt;
00106         aLinkNew-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o5">Total</a> = 1;
00107         <span class="comment">// doesn't matter: aLinkNew-&gt;pLinkCount-&gt;Count = 0;</span>
00108     }
00109 
00110     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00111 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a160" doxytag="ddemlcli.h::AllocAndSetDDEData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE AllocAndSetDDEData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>pSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wStatus</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01479">1479</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00125">UserGlobalAlloc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, and <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>.
<p>
<pre class="fragment"><div>01484 {
01485     HANDLE hDDE;
01486     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbOff;
01487     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
01488     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fCopyIt;
01489 
01490     <span class="keywordflow">if</span> (cb == -1) {
01491         hDDE = (HANDLE)pSrc;
01492         cb = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)GlobalSize(hDDE);
01493         fCopyIt = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01494     } <span class="keywordflow">else</span> {
01495         hDDE = <a class="code" href="../../d6/d0/usercli_8h.html#a3">UserGlobalAlloc</a>(GMEM_DDESHARE | GMEM_MOVEABLE | GMEM_ZEROINIT,
01496                 (wFmt ? (cb + 4) : cb));
01497         fCopyIt = (pSrc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01498     }
01499     <span class="keywordflow">if</span> (hDDE == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01500         <span class="keywordflow">return</span>(0);
01501     }
01502     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
01503     <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01504         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(hDDE);
01505         <span class="keywordflow">return</span> (0);
01506     }
01507     <span class="keywordflow">if</span> (wFmt) {
01508         pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a> = wStatus;
01509         pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a> = wFmt;
01510         cbOff = 4;
01511     } <span class="keywordflow">else</span> {
01512         cbOff = 0;
01513     }
01514     <span class="keywordflow">if</span> (fCopyIt) {
01515         RtlCopyMemory((PBYTE)pdde + cbOff, pSrc, cb);
01516     }
01517     <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
01518 
01519     <span class="keywordflow">return</span> (hDDE);
01520 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a123" doxytag="ddemlcli.h::ApplyFreeDataHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ApplyFreeDataHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/hdata_8c-source.html#l00451">451</a> of file <a class="el" href="../../d1/d8/hdata_8c-source.html">hdata.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>00453 {
00454     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet;
00455 
00456     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00457     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00458     fRet = <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>((HDDEDATA)hData, FALSE);
00459     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00460     <span class="keywordflow">return</span>(fRet);
00461 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="ddemlcli.h::ApplyFunctionToObjects" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ApplyFunctionToObjects           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ExpectedType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ExpectedInstance</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a56">PFNHANDLEAPPLY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pfn</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00263">263</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00032">cHandlesAllocated</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00111">HTYPE_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>00267 {
00268     <a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a> phe;
00269 
00270     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00271 
00272     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>) {
00273         <span class="keywordflow">return</span>;
00274     }
00275     phe = &amp;<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>];
00276 
00277     <span class="keywordflow">do</span> {
00278         phe--;
00279         <span class="keywordflow">if</span> (phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> != 0 &amp;&amp;
00280                 (ExpectedType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a41">HTYPE_ANY</a> ||
00281                     ExpectedType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>)) &amp;&amp;
00282                 (ExpectedInstance == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a41">HTYPE_ANY</a> ||
00283                     ExpectedInstance == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>))) {
00284             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00285             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00286             (*pfn)(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>);
00287             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00288         }
00289     } <span class="keywordflow">while</span> (phe != <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>);
00290 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="ddemlcli.h::BestSetLastDDEMLError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID BestSetLastDDEMLError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>error</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">336</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00032">cHandlesAllocated</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.
<p>
<pre class="fragment"><div>00338 {
00339     <a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a> phe;
00340 
00341     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00342 
00343     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>) {
00344         <span class="keywordflow">return</span>;
00345     }
00346     phe = &amp;<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>];
00347     <span class="keywordflow">do</span> {
00348         phe--;
00349         <span class="keywordflow">if</span> (phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> != 0 &amp;&amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a34">HTYPE_INSTANCE</a>) {
00350             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>((<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>, error);
00351         }
00352     } <span class="keywordflow">while</span> (phe != <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>);
00353 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a138" doxytag="ddemlcli.h::CheckForQueuedMessages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CheckForQueuedMessages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pcoi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">664</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00508">_CLIENTINFO::CI_flags</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00548">CI_PROCESSING_QUEUE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00536">_CLIENTINFO::cInDDEMLCallback</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00223">tagCONV_INFO::dmqIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00224">tagCONV_INFO::dmqOut</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00162">tagDDE_MESSAGE_QUEUE::lParam</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00161">tagDDE_MESSAGE_QUEUE::msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00159">tagDDE_MESSAGE_QUEUE::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, and <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00441">SetEnableState()</a>.
<p>
<pre class="fragment"><div>00666 {
00667     <a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">PDDE_MESSAGE_QUEUE</a> pdmq;
00668     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00669     <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pci;
00670 
00671     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00672 
00673     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_PROCESSING) {      <span class="comment">// recursion prevention</span>
00674         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00675     }
00676 
00677     UserAssert(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>);
00678 
00679     pci = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>();
00680 
00681     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_PROCESSING;
00682     <span class="keywordflow">while</span> (!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_BLOCKED) &amp;&amp;
00683                 pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00684                 !pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o11">cInDDEMLCallback</a>) {
00685         pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o0">CI_flags</a> |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a113">CI_PROCESSING_QUEUE</a>;
00686         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d4/ddemlwp_8c.html#a8">ProcessSyncDDEMessage</a>(pcoi, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o2">msg</a>, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o3">lParam</a>)) {
00687             fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00688             pdmq = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>;
00689             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a>;
00690             <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00691                 pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00692             }
00693             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdmq);
00694         }
00695         pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o0">CI_flags</a> &amp;= ~<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a113">CI_PROCESSING_QUEUE</a>;
00696     }
00697     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_PROCESSING;
00698     <span class="keywordflow">return</span>(fRet);
00699 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a143" doxytag="ddemlcli.h::ClRespAdviseAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClRespAdviseAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">190</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a73">PCL_CONV_INFO</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00128">tagXACT_INFO::wType</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>.
<p>
<pre class="fragment"><div>00194 {
00195     UINT_PTR uiLo, uiHi;
00196 
00197     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00198         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> != WM_DDE_ACK) {
00199             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00200         }
00201 
00202         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
00203 <span class="preprocessor">#if DBG</span>
00204 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
00205             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00206         }
00207 <span class="preprocessor">#endif</span>
00208 <span class="preprocessor"></span>
00209         GlobalDeleteAtom((ATOM)uiHi); <span class="comment">// message copy</span>
00210 
00211         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_ADVACKRCVD;
00212         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = (WORD)uiLo;
00213 
00214         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FACK) {
00215             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/util_8c.html#a0">AddLink</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>,
00216                     (WORD)((pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &lt;&lt; 12) &amp; (DDE_FACKREQ | DDE_FDEFERUPD)))) {
00217                 <span class="comment">//</span>
00218                 <span class="comment">// only server side reports links on local conversations.</span>
00219                 <span class="comment">//</span>
00220                 <span class="keywordflow">if</span> (!(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_ISLOCAL)) {
00221                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, TRUE, (WORD)uiLo &amp; DDE_FDEFERUPD,
00222                             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>,
00223                             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>, FALSE, (HCONV)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>,
00224                             (HCONV)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>);
00225                 }
00226             } <span class="keywordflow">else</span> {
00227                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = 0;  <span class="comment">// memory failure - fake a NACK.</span>
00228             }
00229         } <span class="keywordflow">else</span> {
00230             <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>);  <span class="comment">// Nack free.</span>
00231         }
00232 
00233         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi,
00234                 (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FACK) ? (HDDEDATA)1L : (HDDEDATA)0L)) {
00235             <span class="keywordflow">goto</span> Cleanup;
00236         }
00237     } <span class="keywordflow">else</span> {
00238 Cleanup:
00239         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// pxi copy</span>
00240         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
00241         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
00242     }
00243     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00244         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
00245     }
00246     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a151" doxytag="ddemlcli.h::ClRespExecuteAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClRespExecuteAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">958</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00124">tagXACT_INFO::hXact</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>.
<p>
<pre class="fragment"><div>00962 {
00963     UINT_PTR uiLo, uiHi;
00964 
00965     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00966         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> != WM_DDE_ACK) {
00967             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00968         }
00969 
00970         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
00971         <span class="keywordflow">if</span> (uiHi != HandleToUlong(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>)) {
00972             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00973         }
00974 
00975         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>((HANDLE)uiHi);
00976 
00977         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_EXECACKRCVD;
00978         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = (WORD)uiLo;
00979 
00980         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi, (HDDEDATA)(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FACK ? 1 : 0))) {
00981             <span class="keywordflow">goto</span> Cleanup;
00982         }
00983     } <span class="keywordflow">else</span> {
00984 Cleanup:
00985         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// pxi copy</span>
00986         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
00987         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>) {
00988             <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>);
00989         }
00990         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
00991     }
00992     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00993         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
00994     }
00995     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00996 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a154" doxytag="ddemlcli.h::ClRespPokeAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClRespPokeAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">1116</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00124">tagXACT_INFO::hXact</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>.
<p>
<pre class="fragment"><div>01120 {
01121     UINT_PTR uiLo, uiHi;
01122 
01123     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01124         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> != WM_DDE_ACK) {
01125             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
01126         }
01127 
01128         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
01129         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
01130             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
01131         }
01132 
01133         GlobalDeleteAtom((ATOM)uiHi); <span class="comment">// message copy</span>
01134 
01135         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_POKEACKRCVD;
01136         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = (WORD)uiLo;
01137 
01138         <span class="keywordflow">if</span> (!((WORD)uiLo &amp; DDE_FACK)) {
01139             <span class="comment">//</span>
01140             <span class="comment">// NACKs make it our business to free the poked data.</span>
01141             <span class="comment">//</span>
01142             <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>, FALSE, TRUE);
01143         }
01144 
01145         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi,
01146                 (HDDEDATA)(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FACK ? 1 : 0))) {
01147             <span class="keywordflow">goto</span> Cleanup;
01148         }
01149     } <span class="keywordflow">else</span> {
01150 Cleanup:
01151         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// pxi copy</span>
01152         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
01153         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>) {
01154             <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>);
01155         }
01156         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
01157     }
01158     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01159         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
01160     }
01161     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01162 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a157" doxytag="ddemlcli.h::ClRespRequestData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClRespRequestData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">1294</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01591">ExtractDDEDataInfo()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00133">tagXACT_INFO::hDDEResult</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>.
<p>
<pre class="fragment"><div>01298 {
01299     UINT_PTR uiLo, uiHi;
01300     WORD wFmt, wStatus;
01301     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
01302 
01303     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01304         <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01305         <span class="keywordflow">case</span> WM_DDE_DATA:
01306             <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_DATA, lParam, (PUINT_PTR)&amp;pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>, &amp;uiHi);
01307             <span class="keywordflow">if</span> (!pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>) {
01308                 <span class="comment">// must be an advise data message with NODATA.</span>
01309                 <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a4">ClSpontAdviseData</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, lParam));
01310             }
01311             <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/stdptcl_8c.html#a24">ExtractDDEDataInfo</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>, &amp;wStatus, &amp;wFmt)) {
01312                 <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a4">ClSpontAdviseData</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, lParam));
01313             }
01314             <span class="keywordflow">if</span> (!(wStatus &amp; DDE_FREQUESTED)) {
01315                 <span class="comment">// must be advise data</span>
01316                 <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a4">ClSpontAdviseData</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, lParam));
01317             }
01318             <span class="keywordflow">if</span> (wStatus &amp; DDE_FACKREQ) {
01319 
01320                 <span class="comment">// if DDE_FRELEASE is not set, and this is a synchronous</span>
01321                 <span class="comment">// transaction, we need to make a copy here so the user</span>
01322                 <span class="comment">// can free at his leisure.</span>
01323 
01324                 <span class="comment">// reuse uiHi - message copy</span>
01325                 dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>,
01326                         WM_DDE_DATA, WM_DDE_ACK, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0,
01327                         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a> == wFmt &amp;&amp; pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a> == (GATOM)uiHi ?
01328                             DDE_FACK : 0, uiHi);
01329                 <span class="keywordflow">if</span> (dwError) {
01330                     <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01331                 }
01332             } <span class="keywordflow">else</span> {
01333                 GlobalDeleteAtom((GATOM)uiHi);     <span class="comment">// message copy</span>
01334             }
01335             <span class="keywordflow">if</span> (wFmt != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a> || (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
01336                 <span class="comment">/*</span>
01337 <span class="comment">                 * BOGUS returned data!  Just free it and make it look like</span>
01338 <span class="comment">                 * a NACK</span>
01339 <span class="comment">                 */</span>
01340                 <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>, FALSE, TRUE);
01341                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a> = 0;
01342                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi, 0)) {
01343                     <span class="keywordflow">goto</span> Cleanup;
01344                 }
01345             } <span class="keywordflow">else</span> {
01346                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi, (HDDEDATA)-1)) {
01347                     <span class="keywordflow">goto</span> Cleanup;
01348                 }
01349             }
01350             <span class="keywordflow">break</span>;
01351 
01352         <span class="keywordflow">case</span> WM_DDE_ACK:
01353             <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
01354             <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
01355                 <span class="keywordflow">return</span>(<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
01356             }
01357             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_DATARCVD;
01358             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = (WORD)uiLo;
01359             GlobalDeleteAtom((GATOM)uiHi); <span class="comment">// message copy</span>
01360             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi, 0)) {
01361                 <span class="keywordflow">goto</span> Cleanup;
01362             }
01363             <span class="keywordflow">break</span>;
01364 
01365         <span class="keywordflow">default</span>:
01366             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
01367         }
01368 
01369     } <span class="keywordflow">else</span> {
01370 
01371 Cleanup:
01372         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// pxi copy</span>
01373         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>) {
01374             <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>, FALSE, TRUE);  <span class="comment">// free message data</span>
01375         }
01376         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
01377         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
01378     }
01379     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01380         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
01381     }
01382     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01383 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a149" doxytag="ddemlcli.h::ClRespUnadviseAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClRespUnadviseAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">719</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00124">tagXACT_INFO::hXact</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>.
<p>
<pre class="fragment"><div>00723 {
00724     UINT_PTR uiLo, uiHi;
00725     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> al;
00726     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> aLink;
00727     <span class="keywordtype">int</span> iLink;
00728 
00729     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00730         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> != WM_DDE_ACK) {
00731             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00732         }
00733 
00734         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
00735         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
00736             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00737         }
00738 
00739         al = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((ATOM)uiHi);
00740         <span class="keywordflow">for</span> (aLink = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>, iLink = 0;
00741                 iLink &lt; pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;
00742                     ) {
00743             <span class="keywordflow">if</span> (aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> == al &amp;&amp;
00744                     (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a> == 0 || aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a> == pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>)) {
00745                 DeleteAtom(al);  <span class="comment">// aLink copy</span>
00746                 <span class="keywordflow">if</span> (--pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
00747                     memmove((LPSTR)aLink, (LPSTR)(aLink + 1),
00748                             <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a>) * (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a> - iLink));
00749                 }
00750             } <span class="keywordflow">else</span> {
00751                 aLink++;
00752                 iLink++;
00753             }
00754         }
00755         DeleteAtom(al);  <span class="comment">// local copy</span>
00756         GlobalDeleteAtom((ATOM)uiHi);   <span class="comment">// message copy</span>
00757 
00758         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_UNADVACKRCVD;
00759         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> = (WORD)uiLo;
00760         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a25">TransactionComplete</a>(pxi, (HDDEDATA)1)) {
00761             <span class="keywordflow">goto</span> Cleanup;
00762         }
00763     } <span class="keywordflow">else</span> {
00764 Cleanup:
00765         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);   <span class="comment">// pxi copy</span>
00766         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
00767         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>) {
00768             <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>);
00769         }
00770         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
00771     }
00772     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00773         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
00774     }
00775     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00776 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a145" doxytag="ddemlcli.h::ClSpontAdviseData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClSpontAdviseData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pci</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">362</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a62">PADVISE_LINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>.
<p>
<pre class="fragment"><div>00365 {
00366     UINT_PTR uiHi;
00367     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00368     HANDLE hDDE = 0;
00369     HDDEDATA hData, hDataReturn;
00370     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
00371     WORD wFmt;
00372     WORD wStatus;
00373     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
00374     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink;
00375     <span class="keywordtype">int</span> iLink;
00376 
00377     <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_DATA, lParam, (PUINT_PTR)&amp;hDDE, &amp;uiHi);
00378     UserAssert(!hDDE || GlobalSize(hDDE));
00379     wFmt = 0;
00380     wStatus = 0;
00381     hDataReturn = 0;
00382     la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)uiHi);
00383     <span class="keywordflow">if</span> (hDDE) {
00384         <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
00385         <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00386             hData = 0;
00387         } <span class="keywordflow">else</span> {
00388             wFmt = pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a>;
00389             wStatus = pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a>;
00390             <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00391 
00392             <span class="comment">/*</span>
00393 <span class="comment">             * if data is coming in, create a data handle for the app</span>
00394 <span class="comment">             */</span>
00395             hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, (LPBYTE)hDDE,
00396                     (DWORD)-1, 0, HDATA_NOAPPFREE | HDATA_READONLY, 0, 0);
00397         }
00398         <span class="keywordflow">if</span> (hData) {
00399             hDataReturn = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, XTYP_ADVDATA,
00400                     wFmt, pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
00401                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
00402                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00403                     hData, 0, 0);
00404             <span class="keywordflow">if</span> (hDataReturn != CBR_BLOCK) {
00405                 <a class="code" href="../../d2/d6/stdptcl_8c.html#a26">UnpackAndFreeDDEMLDataHandle</a>(hData, FALSE);
00406                 <span class="keywordflow">if</span> (((ULONG_PTR)hDataReturn &amp; DDE_FACK) || !(wStatus &amp; DDE_FACKREQ)) {
00407                     <span class="comment">/*</span>
00408 <span class="comment">                     * Nacked Advise data with fAckReq set is server's</span>
00409 <span class="comment">                     * responsibility to free!</span>
00410 <span class="comment">                     */</span>
00411                     <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(hDDE, FALSE, TRUE);
00412                 }
00413             }
00414         }
00415     } <span class="keywordflow">else</span> {
00416         <span class="comment">/*</span>
00417 <span class="comment">         * WARM LINK CASE</span>
00418 <span class="comment">         *</span>
00419 <span class="comment">         * Search through the client's link info to find what formats this</span>
00420 <span class="comment">         * puppy is on. We let the client know for each format being supported</span>
00421 <span class="comment">         * on this item that is warm-linked. The last hDataReturn determines</span>
00422 <span class="comment">         * the ACK returned - for lack of a better method.</span>
00423 <span class="comment">         */</span>
00424         <span class="keywordflow">for</span> (paLink = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>, iLink = 0; iLink &lt; pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>; iLink++, paLink++) {
00425             <span class="keywordflow">if</span> ((paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> == la) &amp;&amp; (paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &amp; DDE_FDEFERUPD)) {
00426                 hDataReturn = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, XTYP_ADVDATA,
00427                         paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
00428                         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
00429                         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00430                         0, 0, 0);
00431                 <span class="keywordflow">if</span> (hDataReturn == CBR_BLOCK) {
00432                     DeleteAtom(la);
00433                     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00434                 }
00435             }
00436         }
00437     }
00438     DeleteAtom(la);
00439     <span class="keywordflow">if</span> (hDataReturn == CBR_BLOCK) {
00440         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00441     }
00442 
00443     <span class="keywordflow">if</span> (wStatus &amp; DDE_FACKREQ) {
00444 
00445         (ULONG_PTR)hDataReturn &amp;= ~DDE_FACKRESERVED;
00446         <span class="comment">// reuse uiHi</span>
00447         <span class="keywordflow">if</span> (dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_DATA,
00448                 WM_DDE_ACK, pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, lParam, (UINT_PTR)hDataReturn, uiHi)) {
00449             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00450         }
00451     } <span class="keywordflow">else</span> {
00452         GlobalDeleteAtom((ATOM)uiHi); <span class="comment">// data message copy</span>
00453         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(WM_DDE_DATA, lParam); <span class="comment">// not reused so free it.</span>
00454     }
00455     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00456 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a141" doxytag="ddemlcli.h::ClStartAdvise" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClStartAdvise           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">67</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01479">AllocAndSetDDEData()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d6/d4/ddetrack_8h.html#a23">DDE_DATA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00116">PXACT_INFO</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00128">tagXACT_INFO::wType</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>.
<p>
<pre class="fragment"><div>00069 {
00070     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00071 
00072     <span class="comment">//</span>
00073     <span class="comment">// protocol quirk: DDE_FRELEASE is always assumed set in a WM_DDE_ADVISE</span>
00074     <span class="comment">// message. We set it here just in case the dork on the other end</span>
00075     <span class="comment">// pays attention to it.</span>
00076     <span class="comment">//</span>
00077     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a> = <a class="code" href="../../d2/d6/stdptcl_8c.html#a22">AllocAndSetDDEData</a>(NULL, <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d2/structtagDDE__DATA.html">DDE_DATA</a>),
00078             (WORD)(((pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &lt;&lt; 12) &amp; (DDE_FDEFERUPD | DDE_FACKREQ)) | DDE_FRELEASE),
00079             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>);
00080     <span class="keywordflow">if</span> (!pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>) {
00081         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
00082         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00083     }
00084 
00085     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00086     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_ADVISE,
00087             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, HandleToUlong(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>), pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
00088     <span class="keywordflow">if</span> (dwError) {
00089         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00090         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>);
00091         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a> = 0;
00092         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00093         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00094     }
00095 
00096     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_ADVSENT;
00097     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a143">ClRespAdviseAck</a>;
00098     <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
00099     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00100 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a150" doxytag="ddemlcli.h::ClStartExecute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClStartExecute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">852</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00791">MaybeTranslateExecuteData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>.
<p>
<pre class="fragment"><div>00854 {
00855     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00856 
00857     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a> = <a class="code" href="../../d2/d6/stdptcl_8c.html#a10">MaybeTranslateExecuteData</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>,
00858             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; IIF_UNICODE,
00859             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_UNICODE_EXECUTE,
00860             TRUE);
00861 
00862     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_EXECUTE,
00863             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, 0, HandleToUlong(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>));
00864     <span class="keywordflow">if</span> (dwError) {
00865         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00866         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00867     }
00868     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_EXECSENT;
00869     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a151">ClRespExecuteAck</a>;
00870     <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
00871     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00872 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a152" doxytag="ddemlcli.h::ClStartPoke" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClStartPoke           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">1012</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>.
<p>
<pre class="fragment"><div>01014 {
01015     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
01016 
01017     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
01018     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_POKE,
01019             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, HandleToUlong(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>), pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
01020     <span class="keywordflow">if</span> (dwError) {
01021         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01022         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
01023         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01024     }
01025 
01026     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_POKESENT;
01027     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a154">ClRespPokeAck</a>;
01028     <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
01029     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01030 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a155" doxytag="ddemlcli.h::ClStartRequest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClStartRequest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">1176</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>.
<p>
<pre class="fragment"><div>01178 {
01179     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
01180 
01181     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
01182     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_REQUEST,
01183             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
01184     <span class="keywordflow">if</span> (dwError) {
01185         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01186         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
01187         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01188     }
01189 
01190     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_REQSENT;
01191     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a157">ClRespRequestData</a>;
01192     <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
01193     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01194 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a147" doxytag="ddemlcli.h::ClStartUnadvise" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ClStartUnadvise           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">561</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>.
<p>
<pre class="fragment"><div>00563 {
00564     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00565 
00566     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00567     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_UNADVISE,
00568             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
00569     <span class="keywordflow">if</span> (dwError) {
00570         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00571         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00572         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00573     }
00574 
00575     <span class="comment">//</span>
00576     <span class="comment">// only server side reports links on local conversations.</span>
00577     <span class="comment">//</span>
00578     <span class="keywordflow">if</span> (!(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_ISLOCAL)) {
00579         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, FALSE, 0,
00580                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>,
00581                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>, FALSE, (HCONV)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>,
00582                 (HCONV)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>);
00583     }
00584     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_UNADVSENT;
00585     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a149">ClRespUnadviseAck</a>;
00586     <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
00587     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00588 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a111" doxytag="ddemlcli.h::ConnectConv" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> ConnectConv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndSkip</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>pCC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">607</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00129">tagINIT_ENUM::clst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00679">CLST_CONNECTED</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d7/clenum_8c-source.html#l00171">EnumWindows()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00675">GWL_CONVSTATE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00677">GWLP_CHINST</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00676">GWLP_SHINST</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00128">tagINIT_ENUM::hConvList</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00185">tagCL_INSTANCE_INFO::hInstServer</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00123">tagINIT_ENUM::hwndClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00232">tagCL_CONV_INFO::hwndReconnect</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00124">tagINIT_ENUM::hwndSkip</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00358">ICLS_DDEMLCLIENTA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00359">ICLS_DDEMLCLIENTW</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00220">tagCONV_INFO::laServiceRequested</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00126">tagINIT_ENUM::laServiceRequested</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00127">tagINIT_ENUM::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00125">tagINIT_ENUM::lParam</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00036">MONCONV</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04369">NtUserDdeSetQualityOfService()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00387">SetConvContext()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>.
<p>
<pre class="fragment"><div>00616 {
00617     <a class="code" href="../../d6/d8/structtagINIT__ENUM.html">INIT_ENUM</a> ie;
00618     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci;
00619     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
00620     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaService, gaTopic;
00621 
00622     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00623 
00624     <span class="keywordflow">if</span> (hwndTarget &amp;&amp; hwndTarget == hwndSkip) {
00625         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00626     }
00627 
00628     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00629     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00630 
00631     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>) {
00632         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> = CreateWindowW((LPWSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLCLIENTW]),
00633                                      L<span class="stringliteral">""</span>,
00634                                      WS_CHILD,
00635                                      0, 0, 0, 0,
00636                                      pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>,
00637                                      (HMENU)0,
00638                                      (HANDLE)0,
00639                                      (LPVOID)NULL);
00640     } <span class="keywordflow">else</span> {
00641         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> = CreateWindowA((LPSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLCLIENTA]),
00642                                      <span class="stringliteral">""</span>,
00643                                      WS_CHILD,
00644                                      0, 0, 0, 0,
00645                                      pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>,
00646                                      (HMENU)0,
00647                                      (HANDLE)0,
00648                                      (LPVOID)NULL);
00649     }
00650 
00651     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00652 
00653     <span class="keywordflow">if</span> (ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> == 0) {
00654         <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00655     }
00656 
00657     <span class="keywordflow">if</span> (pCC != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00658         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a168">NtUserDdeSetQualityOfService</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, &amp;(pCC-&gt;qos), NULL)) {
00659             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00660             <span class="keywordflow">goto</span> <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>;
00661         }
00662     }
00663     <span class="comment">/*</span>
00664 <span class="comment">     * Note that a pci will be created and allocated for each ACK recieved.</span>
00665 <span class="comment">     */</span>
00666     <a class="code" href="../../d0/d1/xact_8c.html#a2">SetConvContext</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, (LONG *)pCC);
00667     SetWindowLong(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWL_CONVSTATE, clst);
00668     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_SHINST, (LONG_PTR)pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>);
00669     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_CHINST, (LONG_PTR)pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>);
00670 
00671     gaService = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(laService);
00672     gaTopic = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(laTopic);
00673     ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a> = MAKELONG(gaService, gaTopic);
00674     <span class="keywordflow">if</span> (!hwndTarget) {
00675         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o1">hwndSkip</a> = hwndSkip;
00676         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a> = laService;
00677         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o4">laTopic</a> = laTopic;
00678         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o5">hConvList</a> = hConvList;
00679         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o6">clst</a> = clst;
00680     }
00681 
00682     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00683 
00684     <span class="keywordflow">if</span> (hwndTarget) {
00685         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndTarget, WM_DDE_INITIATE, (WPARAM)ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>,
00686                 ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a>);
00687     } <span class="keywordflow">else</span> {
00688         <span class="comment">/*</span>
00689 <span class="comment">         * Send this message to the nddeagnt app first so it can start</span>
00690 <span class="comment">         * the netdde services BEFORE we do an enumeration of windows.</span>
00691 <span class="comment">         * This lets things work the first time.  NetDDEAgent caches</span>
00692 <span class="comment">         * service status so this is the fastest way to do this.</span>
00693 <span class="comment">         */</span>
00694         HWND hwndAgent = FindWindowW(SZ_NDDEAGNT_CLASS, SZ_NDDEAGNT_TITLE);
00695         <span class="keywordflow">if</span> (hwndAgent) {
00696             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndAgent,
00697                 WM_DDE_INITIATE, (WPARAM)ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a>);
00698         }
00699         <a class="code" href="../../d0/d8/clenum_8c.html#a7">EnumWindows</a>((WNDENUMPROC)InitiateEnumerationProc, (LPARAM)&amp;ie);
00700     }
00701 
00702     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00703     <span class="comment">/*</span>
00704 <span class="comment">     * hConvList may have been destroyed during the enumeration but we are</span>
00705 <span class="comment">     * done with it now so no need to revalidate.</span>
00706 <span class="comment">     */</span>
00707 
00708 <span class="preprocessor">#if DBG</span>
00709 <span class="preprocessor"></span>    {
00710         WCHAR sz[10];
00711 
00712         <span class="keywordflow">if</span> (gaService &amp;&amp; GlobalGetAtomName(gaService, sz, 10) == 0) {
00713             RIPMSG1(RIP_ERROR, <span class="stringliteral">"Bad Service Atom after Initiate phase: %lX"</span>, (DWORD)gaService);
00714         }
00715         <span class="keywordflow">if</span> (gaTopic &amp;&amp; GlobalGetAtomName(gaTopic, sz, 10) == 0) {
00716             RIPMSG1(RIP_ERROR, <span class="stringliteral">"Bad Topic Atom after Initiate phase: %lX"</span>, (DWORD)gaTopic);
00717         }
00718     }
00719 <span class="preprocessor">#endif // DBG</span>
00720 <span class="preprocessor"></span>
00721     GlobalDeleteAtom(gaService);
00722     GlobalDeleteAtom(gaTopic);
00723 
00724     <span class="comment">//</span>
00725     <span class="comment">// Get the first pci allocated when a WM_DDE_ACK was recieved.</span>
00726     <span class="comment">//</span>
00727     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_PCI);
00728     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00729 <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>:
00730         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00731         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>);
00732         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00733         <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00734     }
00735 
00736     SetWindowLong(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWL_CONVSTATE, CLST_CONNECTED);
00737     <span class="keywordflow">if</span> (hwndTarget) {
00738         <span class="comment">/*</span>
00739 <span class="comment">         * If hwndTarget was NULL, the enumeration proc took care of this.</span>
00740 <span class="comment">         */</span>
00741         pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o1">hwndReconnect</a> = hwndTarget;
00742         UserAssert(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a> == NULL);
00743         pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a> = laService;
00744         <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(laService); <span class="comment">// pci copy</span>
00745     }
00746 
00747     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_CONV) {
00748         <span class="keywordflow">for</span> (pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci; pcoi; pcoi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00749             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a5">MONCONV</a>(pcoi, TRUE);
00750         }
00751     }
00752     <span class="keywordflow">return</span> (pci);
00753 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a126" doxytag="ddemlcli.h::CopyDDEData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE CopyDDEData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hDDE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fExec</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/hdata_8c-source.html#l00660">660</a> of file <a class="el" href="../../d1/d8/hdata_8c-source.html">hdata.c</a>.
<p>
References <a class="el" href="../../d1/d8/hdata_8c-source.html#l00579">CopyBitmap()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00620">CopyPalette()</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00020">tagDDE_DATA::Data</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00125">UserGlobalAlloc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00124">UserGlobalFree</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00130">UserGlobalSize</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>.
<p>
<pre class="fragment"><div>00663 {
00664     HANDLE hDDENew;
00665     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde, pddeNew;
00666     LPMETAFILEPICT pmfPict;
00667     HANDLE hmfPict;
00668 
00669     hDDENew = <a class="code" href="../../d6/d0/usercli_8h.html#a3">UserGlobalAlloc</a>(GMEM_DDESHARE | GMEM_MOVEABLE,
00670             <a class="code" href="../../d6/d0/usercli_8h.html#a6">UserGlobalSize</a>(hDDE));
00671     <span class="keywordflow">if</span> (!hDDENew) {
00672         <span class="keywordflow">return</span> (0);
00673     }
00674     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
00675     <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00676         <a class="code" href="../../d6/d0/usercli_8h.html#a2">UserGlobalFree</a>(hDDENew);
00677         <span class="keywordflow">return</span> (0);
00678     }
00679     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDENew, pddeNew);
00680     UserAssert(pddeNew);
00681     RtlCopyMemory(pddeNew, pdde, <a class="code" href="../../d6/d0/usercli_8h.html#a6">UserGlobalSize</a>(hDDE));
00682 
00683     <span class="keywordflow">if</span> (!fIsExecute) {
00684         <span class="keywordflow">switch</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a>) {
00685         <span class="keywordflow">case</span> CF_BITMAP:
00686         <span class="keywordflow">case</span> CF_DSPBITMAP:
00687             pddeNew-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> = (ULONG_PTR)<a class="code" href="../../d0/d9/hdata_8c.html#a11">CopyBitmap</a>((HBITMAP)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00688             <span class="keywordflow">break</span>;
00689 
00690         <span class="keywordflow">case</span> CF_PALETTE:
00691             pddeNew-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> = (ULONG_PTR)<a class="code" href="../../d0/d9/hdata_8c.html#a12">CopyPalette</a>((HPALETTE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00692             <span class="keywordflow">break</span>;
00693 
00694         <span class="keywordflow">case</span> CF_DIB:
00695             pddeNew-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> = (ULONG_PTR)<a class="code" href="../../d0/d9/hdata_8c.html#a13">CopyDDEData</a>((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>, TRUE);
00696             <span class="keywordflow">break</span>;
00697 
00698         <span class="keywordflow">case</span> CF_METAFILEPICT:
00699         <span class="keywordflow">case</span> CF_DSPMETAFILEPICT:
00700             hmfPict = <a class="code" href="../../d0/d9/hdata_8c.html#a13">CopyDDEData</a>((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>, TRUE);
00701             <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hmfPict, pmfPict);
00702             <span class="keywordflow">if</span> (pmfPict == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00703                 <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(hmfPict);
00704                 <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDENew);
00705                 <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(hDDENew);
00706                 <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00707                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00708             }
00709             pmfPict-&gt;hMF = CopyMetaFile(pmfPict-&gt;hMF, NULL);
00710             <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hmfPict);
00711             pddeNew-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> = (ULONG_PTR)hmfPict;
00712             <span class="keywordflow">break</span>;
00713 
00714         <span class="keywordflow">case</span> CF_ENHMETAFILE:
00715         <span class="keywordflow">case</span> CF_DSPENHMETAFILE:
00716             pddeNew-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> = (ULONG_PTR)CopyEnhMetaFile((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>, NULL);
00717             <span class="keywordflow">break</span>;
00718         }
00719     }
00720     <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDENew);
00721     <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00722     <span class="keywordflow">return</span> (hDDENew);
00723 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="ddemlcli.h::CreateHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE CreateHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dwData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>inst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">75</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00032">cHandlesAllocated</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00060">CheckHandleTable</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">DDEMLReAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00036">GROW_COUNT</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00097">HandleFromId</a>, <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00040">HandleFromIndex</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00100">HandleFromInst</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00099">HandleFromType</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00033">iFirstFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00034">nextId</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00079 {
00080     HANDLE h;
00081     <span class="keywordtype">int</span> i, iNextFree;
00082     <a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a> phe;
00083 
00084     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a> &gt;= <a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>) {
00085         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a> == 0) {
00086            <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a> = (<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">CHANDLEENTRY</a>) * GROW_COUNT);
00087         } <span class="keywordflow">else</span> {
00088            <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a> = (<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>(aHandleEntry,
00089                <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">CHANDLEENTRY</a>) * (cHandlesAllocated + GROW_COUNT));
00090         }
00091         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00092             <span class="keywordflow">return</span> (0);
00093         }
00094         i = <a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>;
00095         <a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a> += <a class="code" href="../../d3/d8/handles_8c.html#a0">GROW_COUNT</a>;
00096         phe = &amp;<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i];
00097         <span class="keywordflow">while</span> (i &lt; <a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>) {
00098            <span class="comment">// phe-&gt;handle = 0; // indicates empty - ZERO init.</span>
00099            phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a> = ++i; <span class="comment">// index to next free spot.</span>
00100            phe++;
00101         }
00102     }
00103     h = <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a>].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> = (HANDLE)LongToHandle(
00104          <a class="code" href="../../d0/d4/ddemlcli_8h.html#a29">HandleFromId</a>(nextId) |
00105          <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a0">HandleFromIndex</a>(iFirstFree) |
00106          <a class="code" href="../../d0/d4/ddemlcli_8h.html#a31">HandleFromType</a>(type) |
00107          <a class="code" href="../../d0/d4/ddemlcli_8h.html#a32">HandleFromInst</a>(inst) );
00108     iNextFree = (<span class="keywordtype">int</span>)<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a>].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>;
00109     <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a>].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a> = dwData;
00110     <a class="code" href="../../d3/d8/handles_8c.html#a5">nextId</a>++;
00111     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/handles_8c.html#a5">nextId</a> == 0) {     <span class="comment">// guarentees HIWORD of handle != 0</span>
00112        <a class="code" href="../../d3/d8/handles_8c.html#a5">nextId</a>++;
00113     }
00114     <a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a> = iNextFree;
00115 
00116     <a class="code" href="../../d3/d8/handles_8c.html#a1">CheckHandleTable</a>();
00117     <span class="keywordflow">return</span> (h);
00118 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="ddemlcli.h::CsClearSecurityForAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CsClearSecurityForAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndServer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndClient</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a134" doxytag="ddemlcli.h::DDEMLClientWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT DDEMLClientWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">376</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01738">tagCLS::atomClassName</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00679">CLST_CONNECTED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00680">CLST_SINGLE_INITIALIZING</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00629">DefWindowProc()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00675">GWL_CONVSTATE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00677">GWLP_CHINST</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">HTYPE_CLIENT_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00360">ICLS_DDEMLSERVERA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00361">ICLS_DDEMLSERVERW</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00210">REBASEALWAYS</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00876">SetCommonStateFlags()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02286">WFANSIPROC</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l00511">RW_RegisterDDEML()</a>.
<p>
<pre class="fragment"><div>00381 {
00382     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci, pciNew;
00383     LONG lState;
00384     LRESULT lRet = 0;
00385     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00386     <a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a> pcls;
00387 
00388     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00389 
00390     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_PCI);
00391     UserAssert(pci == NULL || pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a> == hwnd);
00392 
00393     <span class="keywordflow">switch</span> (message) {
00394     <span class="keywordflow">case</span> WM_DDE_ACK:
00395         lState = GetWindowLong(hwnd, GWL_CONVSTATE);
00396         <span class="keywordflow">if</span> (lState != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a157">CLST_CONNECTED</a>) {
00397 
00398             <span class="comment">// Initiation mode</span>
00399 
00400             pciNew = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">CL_CONV_INFO</a>));
00401             <span class="keywordflow">if</span> (pciNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ||
00402                     (pci != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; lState == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a158">CLST_SINGLE_INITIALIZING</a>)) {
00403                 <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>((HWND)wParam, WM_DDE_TERMINATE, (WPARAM)hwnd, 0);
00404                 <span class="keywordflow">goto</span> Exit;
00405             }
00406 
00407             <span class="comment">// PCL_CONV_INFO initialization</span>
00408 
00409             pciNew-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a> = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_CHINST));
00410 
00411             <span class="keywordflow">if</span> (pciNew-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00412                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pciNew);
00413                 <span class="keywordflow">goto</span> Exit;
00414             }
00415 
00416             pciNew-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a> = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci; <span class="comment">// pci may be NULL</span>
00417             <span class="comment">//</span>
00418             <span class="comment">// Seting GWLP_PCI gives feedback to ConnectConv() which issued</span>
00419             <span class="comment">// the WM_DDE_INITIATE message.</span>
00420             <span class="comment">//</span>
00421             <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(hwnd, GWLP_PCI, (LONG_PTR)pciNew);
00422             <span class="comment">// pciNew-&gt;hUser = 0; // Zero init.</span>
00423 
00424             <span class="comment">// BUG: If this fails we can have some nasty problems</span>
00425             pciNew-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a> = (HCONV)<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>((ULONG_PTR)pciNew,
00426                     HTYPE_CLIENT_CONVERSATION, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(pciNew-&gt;ci.pcii-&gt;hInstClient));
00427 
00428             pciNew-&gt;ci.laService = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>(LOWORD(lParam)); <span class="comment">// pci copy</span>
00429             GlobalDeleteAtom(LOWORD(lParam));
00430             pciNew-&gt;ci.laTopic = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>(HIWORD(lParam)); <span class="comment">// pci copy</span>
00431             GlobalDeleteAtom(HIWORD(lParam));
00432             pciNew-&gt;ci.hwndPartner = (HWND)wParam;
00433             pciNew-&gt;ci.hwndConv = hwnd;
00434             pciNew-&gt;ci.state = (WORD)(ST_CONNECTED | ST_CLIENT |
00435                     pciNew-&gt;ci.pcii-&gt;ConvStartupState);
00436             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a112">SetCommonStateFlags</a>(hwnd, (HWND)wParam, &amp;pciNew-&gt;ci.state);
00437 
00438             pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>((HWND)wParam);
00439 
00440             <span class="keywordflow">if</span> (pwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) <span class="keywordflow">goto</span> Exit;
00441             pcls = (<a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a24">REBASEALWAYS</a>(pwnd, pcls);
00442 
00443             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFANSIPROC)) {
00444                 <span class="keywordflow">if</span> (pcls-&gt;<a class="code" href="../../d7/d0/structtagCLS.html#o1">atomClassName</a> == <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a88">ICLS_DDEMLSERVERW</a>]) {
00445                     pciNew-&gt;ci.state |= ST_ISLOCAL;
00446                 }
00447             } <span class="keywordflow">else</span> {
00448                 <span class="keywordflow">if</span> (pcls-&gt;<a class="code" href="../../d7/d0/structtagCLS.html#o1">atomClassName</a> == <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a87">ICLS_DDEMLSERVERA</a>]) {
00449                     pciNew-&gt;ci.state |= ST_ISLOCAL;
00450                 }
00451             }
00452 
00453             <span class="comment">// pciNew-&gt;ci.laServiceRequested = 0; // Set by InitiateEnumerationProc()</span>
00454             <span class="comment">// pciNew-&gt;ci.pxiIn = 0;</span>
00455             <span class="comment">// pciNew-&gt;ci.pxiOut = 0;</span>
00456             <span class="comment">// pciNew-&gt;ci.dmqIn = 0;</span>
00457             <span class="comment">// pciNew-&gt;ci.dmqOut = 0;</span>
00458             <span class="comment">// pciNew-&gt;ci.aLinks = NULL;</span>
00459             <span class="comment">// pciNew-&gt;ci.cLinks = 0;</span>
00460             <span class="comment">// pciNew-&gt;ci.cLocks = 0;</span>
00461             <span class="keywordflow">goto</span> Exit;
00462         }
00463         <span class="comment">// fall through to handle posted messages here.</span>
00464 
00465     <span class="keywordflow">case</span> WM_DDE_DATA:
00466         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a5">ProcessAsyncDDEMsg</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci, message, (HWND)wParam, lParam);
00467         <span class="keywordflow">goto</span> Exit;
00468 
00469     <span class="keywordflow">case</span> WM_DDE_TERMINATE:
00470     <span class="keywordflow">case</span> WM_DESTROY:
00471         {
00472             <a class="code" href="../../d3/d4/ddemlwp_8c.html#a4">ProcessTerminateMsg</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci, (HWND)wParam);
00473             <span class="keywordflow">break</span>;
00474         }
00475     }
00476 
00477     lRet = <a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(hwnd, message, wParam, lParam);
00478 
00479 Exit:
00480     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00481     <span class="keywordflow">return</span> (lRet);
00482 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a133" doxytag="ddemlcli.h::DDEMLMotherWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT DDEMLMotherWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00027">27</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00629">DefWindowProc()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l00511">RW_RegisterDDEML()</a>.
<p>
<pre class="fragment"><div>00032 {
00033     <span class="keywordflow">switch</span> (message) {
00034     <span class="keywordflow">case</span> UM_REGISTER:
00035     <span class="keywordflow">case</span> UM_UNREGISTER:
00036         <span class="keywordflow">return</span>(<a class="code" href="../../d9/d6/register_8c.html#a2">ProcessRegistrationMessage</a>(hwnd, message, wParam, lParam));
00037 
00038     <span class="keywordflow">case</span> WM_DDE_INITIATE:
00039         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a0">ProcessDDEMLInitiate</a>((<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_PCI),
00040                 (HWND)wParam, (ATOM)LOWORD(lParam), (ATOM)HIWORD(lParam));
00041         <span class="keywordflow">return</span>(0);
00042 
00043     }
00044     <span class="keywordflow">return</span>(<a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(hwnd, message, wParam, lParam));
00045 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a135" doxytag="ddemlcli.h::DDEMLServerWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT DDEMLServerWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00496">496</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00629">DefWindowProc()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00685">GWLP_PSI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l00511">RW_RegisterDDEML()</a>.
<p>
<pre class="fragment"><div>00501 {
00502     <a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a> psi;
00503     LRESULT lRet = 0;
00504 
00505     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00506 
00507     psi = (<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_PSI);
00508     UserAssert(psi == NULL || psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a> == hwnd);
00509 
00510     <span class="keywordflow">switch</span> (message) {
00511     <span class="keywordflow">case</span> WM_DDE_REQUEST:
00512     <span class="keywordflow">case</span> WM_DDE_POKE:
00513     <span class="keywordflow">case</span> WM_DDE_ADVISE:
00514     <span class="keywordflow">case</span> WM_DDE_EXECUTE:
00515     <span class="keywordflow">case</span> WM_DDE_ACK:
00516     <span class="keywordflow">case</span> WM_DDE_UNADVISE:
00517         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a5">ProcessAsyncDDEMsg</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)psi, message, (HWND)wParam, lParam);
00518         <span class="keywordflow">goto</span> Exit;
00519 
00520     <span class="keywordflow">case</span> WM_DDE_TERMINATE:
00521     <span class="keywordflow">case</span> WM_DESTROY:
00522         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a4">ProcessTerminateMsg</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)psi, (HWND)wParam);
00523         <span class="keywordflow">break</span>;
00524     }
00525     lRet = <a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(hwnd, message, wParam, lParam);
00526 Exit:
00527     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00528     <span class="keywordflow">return</span> (lRet);
00529 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a166" doxytag="ddemlcli.h::DeleteLinkCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DeleteLinkCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d0/structtagLINK__COUNT.html">PLINK_COUNT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pLinkCountDelete</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/util_8c-source.html#l00123">123</a> of file <a class="el" href="../../d3/d1/util_8c-source.html">util.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00176">tagLINK_COUNT::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00177">tagLINK_COUNT::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00175">tagLINK_COUNT::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00174">tagLINK_COUNT::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00202">tagCL_INSTANCE_INFO::pLinkCount</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00179">tagLINK_COUNT::Total</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>.
<p>
<pre class="fragment"><div>00126 {
00127     <a class="code" href="../../d0/d0/structtagLINK__COUNT.html">PLINK_COUNT</a> pLinkCount, pLinkCountPrev;
00128 
00129     <span class="keywordflow">if</span> (--pLinkCountDelete-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o5">Total</a> != 0) {
00130         <span class="keywordflow">return</span>;
00131     }
00132     pLinkCountPrev = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00133     pLinkCount     = pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o18">pLinkCount</a>;
00134     <span class="keywordflow">while</span> (pLinkCount) {
00135 
00136         <span class="keywordflow">if</span> (pLinkCount == pLinkCountDelete) {
00137             GlobalDeleteAtom(pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o2">gaItem</a>);
00138             DeleteAtom(pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o3">laItem</a>);
00139             DeleteAtom(pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o1">laTopic</a>);
00140             <span class="keywordflow">if</span> (pLinkCountPrev == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00141                 pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o18">pLinkCount</a> = pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a>;
00142             } <span class="keywordflow">else</span> {
00143                 pLinkCountPrev-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a> = pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a>;
00144             }
00145             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pLinkCount);
00146             <span class="keywordflow">return</span>;
00147         }
00148 
00149         pLinkCountPrev = pLinkCount;
00150         pLinkCount = pLinkCount-&gt;<a class="code" href="../../d0/d0/structtagLINK__COUNT.html#o0">next</a>;
00151     }
00152 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="ddemlcli.h::DestroyHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR DestroyHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">137</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00060">CheckHandleTable</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00033">iFirstFree</a>, and <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00041">IndexFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">DestroyInstance()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>.
<p>
<pre class="fragment"><div>00139 {
00140     <span class="keyword">register</span> <span class="keywordtype">int</span> i;
00141     <span class="keyword">register</span> ULONG_PTR dwRet;
00142 
00143     <a class="code" href="../../d3/d8/handles_8c.html#a1">CheckHandleTable</a>();
00144 
00145     i = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a1">IndexFromHandle</a>(h);
00146     UserAssert(aHandleEntry[i].handle == h);
00147     <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> = 0;
00148     dwRet = <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>;
00149     <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a> = <a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a>;
00150     <a class="code" href="../../d3/d8/handles_8c.html#a4">iFirstFree</a> = i;
00151 
00152     <span class="keywordflow">return</span> (dwRet);
00153 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="ddemlcli.h::DestroyInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE DestroyInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">87</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00262">aInstance</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00023">iFirstFreeInst</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>00089 {
00090     <span class="keyword">register</span> HANDLE hInstServerRet = 0;
00091 
00092     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(hInstClient);
00093     hInstServerRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient)];
00094     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient)] = (HANDLE)UIntToPtr( iFirstFreeInst );
00095     <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient);
00096 
00097     <span class="keywordflow">return</span> (hInstServerRet);
00098 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a127" doxytag="ddemlcli.h::DoCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDDEDATA DoCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConv</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDDEDATA&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dw1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dw2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">24</a> of file <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html">w32/ntuser/client/callback.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00201">tagCL_INSTANCE_INFO::cInDDEMLCallback</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00536">_CLIENTINFO::cInDDEMLCallback</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a984">EVENT_PACKET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a985">PEVENT_PACKET</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00192">tagCL_INSTANCE_INFO::pfnCallback</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d4/callproc_8h-source.html#l00060">UserCallDDECallback</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00034 {
00035     HDDEDATA hDataRet;
00036     <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pci;
00037 
00038     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00039 
00040 
00041     <span class="comment">/*</span>
00042 <span class="comment">     * Zombie conversations don't generate callbacks!</span>
00043 <span class="comment">     */</span>
00044     <span class="keywordflow">if</span> (hConv &amp;&amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(hConv) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>) {
00045         <span class="keywordflow">return</span>(0);
00046     }
00047 
00048     pci = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>();
00049     pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o11">cInDDEMLCallback</a>++;
00050 
00051     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o17">cInDDEMLCallback</a>++;
00052     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00053     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00054 
00055     <span class="comment">/*</span>
00056 <span class="comment">     * Bug 246472 - joejo</span>
00057 <span class="comment">     * fixup all DDE Callbacks since some apps make their callbacks</span>
00058 <span class="comment">     * C-Style instead of PASCAL.</span>
00059 <span class="comment">     */</span>
00060     hDataRet = <a class="code" href="../../d0/d5/callproc_8h.html#a1">UserCallDDECallback</a>(*pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o8">pfnCallback</a>, (UINT)wType, (UINT)wFmt, hConv, hsz1, hsz2,
00061             hData, dw1, dw2);
00062     
00063     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00064     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o17">cInDDEMLCallback</a>--;
00065     pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o11">cInDDEMLCallback</a>--;
00066 
00067     <span class="keywordflow">if</span> (!(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; APPCLASS_MONITOR) &amp;&amp; pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_CALLBACKS) {
00068         <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00069 
00070         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00071                 <span class="keyword">sizeof</span>(MONCBSTRUCT));
00072         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00073 
00074             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_CALLBACKS;
00075             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00076             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONCBSTRUCT);
00077 
00078 <span class="preprocessor">#define pcbs ((MONCBSTRUCT *)&amp;pep-&gt;Data)</span>
00079 <span class="preprocessor"></span>            <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;cb =      <span class="keyword">sizeof</span>(MONCBSTRUCT);
00080             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;dwTime =  <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00081             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hTask =   (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00082             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;dwRet =   HandleToUlong(hDataRet);
00083             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;wType =   wType;
00084             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;wFmt =    wFmt;
00085             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hConv =   hConv;
00086             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hsz1 =    (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz1));
00087             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hsz2 =    (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz2));
00088             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hData =   hData;
00089             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;dwData1 = dw1;
00090             <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;dwData2 = dw2;
00091             <span class="keywordflow">if</span> (((wType == XTYP_CONNECT) || (wType == XTYP_WILDCONNECT)) &amp;&amp; dw1) {
00092                 RtlCopyMemory(&amp;<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;cc, (PVOID)dw1, <span class="keyword">sizeof</span>(CONVCONTEXT));
00093             }
00094 
00095             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00096 
00097                 <span class="keywordflow">if</span> (wType &amp; XCLASS_DATA) {
00098                     <span class="keywordflow">if</span> (hDataRet &amp;&amp; hDataRet != CBR_BLOCK) {
00099                         <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;cbData = <a class="code" href="../../d0/d9/hdata_8c.html#a4">DdeGetData</a>(hDataRet, (LPBYTE)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;Data, 32, 0);
00100                     }
00101                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hData) {
00102                     <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;cbData = <a class="code" href="../../d0/d9/hdata_8c.html#a4">DdeGetData</a>(hData, (LPBYTE)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;Data, 32, 0);
00103                 }
00104 
00105                 <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00106 
00107             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00108 
00109             GlobalDeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hsz1));
00110             GlobalDeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;hsz2));
00111             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pep);
00112 <span class="preprocessor">#undef pcbs</span>
00113 <span class="preprocessor"></span>        }
00114     }
00115     <span class="keywordflow">return</span> (hDataRet);
00116 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a139" doxytag="ddemlcli.h::DumpDDEMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DumpDDEMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fFreeData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">714</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>.
<p>
<pre class="fragment"><div>00718 {
00719     UINT_PTR uiLo, uiHi;
00720 
00721     RIPMSG2(RIP_WARNING, <span class="stringliteral">"Dump DDE msg %x lParam %x"</span>, msg, lParam);
00722 
00723     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00724     <span class="keywordflow">case</span> WM_DDE_ACK:
00725     <span class="keywordflow">case</span> WM_DDE_DATA:
00726     <span class="keywordflow">case</span> WM_DDE_POKE:
00727     <span class="keywordflow">case</span> WM_DDE_ADVISE:
00728         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(msg, lParam, &amp;uiLo, &amp;uiHi);
00729         <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00730         <span class="keywordflow">case</span> WM_DDE_DATA:
00731         <span class="keywordflow">case</span> WM_DDE_POKE:
00732             <span class="keywordflow">if</span> (uiLo) {
00733                 <span class="keywordflow">if</span> (fFreeData) {
00734                     <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>((HANDLE)uiLo, FALSE, TRUE);
00735                 }
00736                 GlobalDeleteAtom((ATOM)uiHi);
00737             }
00738             <span class="keywordflow">break</span>;
00739 
00740         <span class="keywordflow">case</span> WM_DDE_ADVISE:
00741             <span class="keywordflow">if</span> (uiLo) {
00742                 <span class="keywordflow">if</span> (fFreeData) {
00743                     <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>((HANDLE)uiLo, FALSE, TRUE);
00744                 }
00745                 GlobalDeleteAtom((ATOM)uiHi);
00746             }
00747             <span class="keywordflow">break</span>;
00748 
00749         <span class="keywordflow">case</span> WM_DDE_ACK:
00750             <span class="comment">// could be EXEC Ack - cant know what to do exactly.</span>
00751             <span class="keywordflow">break</span>;
00752         }
00753         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msg, lParam);
00754         <span class="keywordflow">break</span>;
00755 
00756     <span class="keywordflow">case</span> WM_DDE_EXECUTE:
00757         <span class="keywordflow">if</span> (fFreeData) {
00758             <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>((HANDLE)lParam);
00759         }
00760         <span class="keywordflow">break</span>;
00761 
00762     <span class="keywordflow">case</span> WM_DDE_REQUEST:
00763     <span class="keywordflow">case</span> WM_DDE_UNADVISE:
00764         GlobalDeleteAtom((ATOM)HIWORD(lParam));
00765         <span class="keywordflow">break</span>;
00766     }
00767 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a132" doxytag="ddemlcli.h::EnableEnumProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnableEnumProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">PENABLE_ENUM_STRUCT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pees</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">295</a> of file <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html">w32/ntuser/client/callback.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a80">PENABLE_ENUM_STRUCT</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00248">tagENABLE_ENUM_STRUCT::pfRet</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00441">SetEnableState()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00249">tagENABLE_ENUM_STRUCT::wCmd</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00250">tagENABLE_ENUM_STRUCT::wCmd2</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>.
<p>
<pre class="fragment"><div>00298 {
00299     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
00300 
00301     <span class="keywordflow">for</span> (pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_PCI);
00302                 pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pcoi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00303         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>++;
00304         *pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o0">pfRet</a> |= <a class="code" href="../../d0/d4/ddemlcli_8h.html#a129">SetEnableState</a>(pcoi, pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o1">wCmd</a>);
00305         <span class="keywordflow">if</span> (pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o2">wCmd2</a>) {
00306             <span class="comment">/*</span>
00307 <span class="comment">             * Only let ES_CHECKQUEUEONCE be done on one window but</span>
00308 <span class="comment">             * don't stop the wCmd from getting to all the other</span>
00309 <span class="comment">             * windows.</span>
00310 <span class="comment">             */</span>
00311             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a129">SetEnableState</a>(pcoi, pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o2">wCmd2</a>) &amp;&amp;
00312                     pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o2">wCmd2</a> == EC_CHECKQUEUEONCE) {
00313                 pees-&gt;<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o2">wCmd2</a> = 0;
00314             }
00315         }
00316         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>--;
00317         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a> == 0 &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_FREE_CONV_RES_NOW) {
00318             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a>(pcoi);
00319             <span class="keywordflow">break</span>;
00320         }
00321     }
00322     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00323 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a162" doxytag="ddemlcli.h::ExtractDDEDataInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ExtractDDEDataInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hDDE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pwStatus</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pwFmt</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01591">1591</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, and <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>.
<p>
<pre class="fragment"><div>01595 {
01596     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
01597 
01598     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
01599     <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01600         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01601     }
01602     *pwStatus = pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a>;
01603     *pwFmt = pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a>;
01604     <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
01605     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01606 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="ddemlcli.h::FindIstanceHandleFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE FindIstanceHandleFromHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a114" doxytag="ddemlcli.h::FreeConversationResources" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeConversationResources           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pcoi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">1354</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00123">DeleteLinkCount()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00223">tagCONV_INFO::dmqIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00224">tagCONV_INFO::dmqOut</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00130">tagXACT_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00220">tagCONV_INFO::laServiceRequested</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00162">tagDDE_MESSAGE_QUEUE::lParam</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00161">tagDDE_MESSAGE_QUEUE::msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00159">tagDDE_MESSAGE_QUEUE::next</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00121">tagXACT_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00146">tagADVISE_LINK::pLinkCount</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00222">tagCONV_INFO::pxiOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00140">TID_TIMEOUT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00136">XIF_SYNCHRONOUS</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">EnableEnumProc()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>.
<p>
<pre class="fragment"><div>01356 {
01357     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink;
01358     <a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">PDDE_MESSAGE_QUEUE</a> pdmq;
01359     <a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi;
01360 
01361     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01362 
01363     <span class="comment">/*</span>
01364 <span class="comment">     * Don't free resources on locked conversations.</span>
01365 <span class="comment">     */</span>
01366     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a> &gt; 0) {
01367         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_FREE_CONV_RES_NOW;
01368         <span class="keywordflow">return</span>;
01369     }
01370 
01371     <span class="comment">/*</span>
01372 <span class="comment">     * Don't free resources if a synchronous transaction is in effect!</span>
01373 <span class="comment">     */</span>
01374     pxi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>;
01375     <span class="keywordflow">while</span> (pxi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01376         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a43">XIF_SYNCHRONOUS</a>) {
01377             <span class="comment">/*</span>
01378 <span class="comment">             * This conversation is in a synchronous transaction.</span>
01379 <span class="comment">             * Shutdown the modal loop FIRST, then call this when</span>
01380 <span class="comment">             * the loop exits.</span>
01381 <span class="comment">             */</span>
01382             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, WM_TIMER, TID_TIMEOUT, 0);
01383             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_FREE_CONV_RES_NOW;
01384             <span class="keywordflow">return</span>;
01385         }
01386         pxi = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a>;
01387     }
01388 
01389     <span class="comment">/*</span>
01390 <span class="comment">     * If this is an Intra-Process conversation that hasn't yet received</span>
01391 <span class="comment">     * a terminate message, make it a zombie.  We will call this routine</span>
01392 <span class="comment">     * again once the terminate arrives or when WaitForZombieTerminate() has</span>
01393 <span class="comment">     * timed out waiting.</span>
01394 <span class="comment">     */</span>
01395     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS &amp;&amp; !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_TERMINATE_RECEIVED)) {
01396         <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>);
01397         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a> = (HCONV)<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>((ULONG_PTR)pcoi, HTYPE_ZOMBIE_CONVERSATION,
01398                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(pcoi-&gt;hConv));
01399         <a class="code" href="../../d6/d5/connect_8c.html#a19">UnlinkConvFromOthers</a>(pcoi, TRUE);
01400         <span class="keywordflow">return</span>;
01401     }
01402 
01403     <span class="comment">/*</span>
01404 <span class="comment">     * remove any transactions left in progress</span>
01405 <span class="comment">     */</span>
01406     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01407         (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a>)(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>, 0, 0);
01408     }
01409 
01410     <span class="comment">/*</span>
01411 <span class="comment">     * Throw away any incoming queued DDE messages.</span>
01412 <span class="comment">     */</span>
01413     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01414 
01415         pdmq = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>;
01416         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o2">msg</a>, pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o3">lParam</a>);
01417         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a>;
01418         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01419             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01420         }
01421         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdmq);
01422     }
01423 
01424     <span class="comment">//</span>
01425     <span class="comment">// Remove all link info</span>
01426     <span class="comment">//</span>
01427     paLink = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>;
01428     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
01429         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
01430             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, FALSE, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &amp; XTYPF_NODATA,
01431                     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>,
01432                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a106">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>),
01433                     paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, FALSE,
01434                     (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>);
01435         } <span class="keywordflow">else</span> {
01436             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, FALSE, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &amp; XTYPF_NODATA,
01437                     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>,
01438                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a106">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>),
01439                     paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, TRUE,
01440                     (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
01441         }
01442         <span class="keywordflow">if</span> (!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT)) {
01443             <a class="code" href="../../d2/d2/util_8c.html#a1">DeleteLinkCount</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>);
01444         }
01445         DeleteAtom(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>); <span class="comment">// link structure copy</span>
01446         paLink++;
01447         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>--;
01448     }
01449     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>) {
01450         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>);
01451     }
01452 
01453     <span class="comment">//</span>
01454     <span class="comment">// free atoms associated with this conv</span>
01455     <span class="comment">//</span>
01456     DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>);
01457     DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>);
01458     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a>) {
01459         DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a>);
01460     }
01461 
01462     <a class="code" href="../../d6/d5/connect_8c.html#a19">UnlinkConvFromOthers</a>(pcoi, FALSE);
01463 
01464     <span class="comment">/*</span>
01465 <span class="comment">     * invalidate app's conversation handle</span>
01466 <span class="comment">     */</span>
01467     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>);
01468 
01469     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcoi);
01470 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a125" doxytag="ddemlcli.h::FreeDDEData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeDDEData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hDDE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIgnorefRelease</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fFreeTruelyGlobalObjects</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">491</a> of file <a class="el" href="../../d1/d8/hdata_8c-source.html">hdata.c</a>.
<p>
References <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00020">tagDDE_DATA::Data</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, and <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00456">_ClientFreeDDEHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, and <a class="el" href="../../d4/d7/client_8c-source.html#l02696">UserRegisterWowHandlers()</a>.
<p>
<pre class="fragment"><div>00495 {
00496     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
00497     LPMETAFILEPICT pmfPict;
00498     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb;
00499 
00500     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
00501     <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00502         <span class="keywordflow">return</span> ;
00503     }
00504 
00505     <span class="keywordflow">if</span> ((pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a> &amp; DDE_FRELEASE) || fIgnorefRelease) {
00506         cb = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)GlobalSize(hDDE);
00507         <span class="comment">/*</span>
00508 <span class="comment">         * Because there is the possibility that the data never got</span>
00509 <span class="comment">         * initialized we need to do this in a try-except so we</span>
00510 <span class="comment">         * behave nicely.</span>
00511 <span class="comment">         */</span>
00512         <span class="keywordflow">switch</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a>) {
00513         <span class="keywordflow">case</span> CF_BITMAP:
00514         <span class="keywordflow">case</span> CF_DSPBITMAP:
00515         <span class="keywordflow">case</span> CF_PALETTE:
00516             <span class="keywordflow">if</span> (cb &gt;= <span class="keyword">sizeof</span>(HANDLE)) {
00517                 <span class="keywordflow">if</span> (fFreeTruelyGlobalObjects) {
00518                     <span class="keywordflow">if</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> != 0) {
00519                         DeleteObject((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00520                     }
00521                 } <span class="keywordflow">else</span> {
00522                     <span class="comment">/*</span>
00523 <span class="comment">                     * !fFreeTruelyGlobalObject implies we are only freeing</span>
00524 <span class="comment">                     * the Gdi proxy.  (another process may still have this</span>
00525 <span class="comment">                     * object in use.)</span>
00526 <span class="comment">                     *</span>
00527 <span class="comment">                     * ChrisWil: removed this call.  No longer</span>
00528 <span class="comment">                     *           applicable in KMode.</span>
00529 <span class="comment">                     *</span>
00530 <span class="comment">                     * GdiDeleteLocalObject((ULONG)pdde-&gt;Data);</span>
00531 <span class="comment">                     *</span>
00532 <span class="comment">                     */</span>
00533                 }
00534             }
00535             <span class="keywordflow">break</span>;
00536 
00537         <span class="keywordflow">case</span> CF_DIB:
00538             <span class="keywordflow">if</span> (cb &gt;= <span class="keyword">sizeof</span>(HANDLE)) {
00539                 <span class="keywordflow">if</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> != 0) {
00540                     <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00541                 }
00542             }
00543             <span class="keywordflow">break</span>;
00544 
00545         <span class="keywordflow">case</span> CF_METAFILEPICT:
00546         <span class="keywordflow">case</span> CF_DSPMETAFILEPICT:
00547             <span class="keywordflow">if</span> (cb &gt;= <span class="keyword">sizeof</span>(HANDLE)) {
00548                 <span class="keywordflow">if</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> != 0) {
00549                     <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>, pmfPict);
00550                     <span class="keywordflow">if</span> (pmfPict != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00551                         <span class="keywordflow">if</span> (GlobalSize((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>) &gt;= <span class="keyword">sizeof</span>(METAFILEPICT)) {
00552                             DeleteMetaFile(pmfPict-&gt;hMF);
00553                         }
00554                         <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00555                         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00556                     }
00557                 }
00558             }
00559             <span class="keywordflow">break</span>;
00560 
00561         <span class="keywordflow">case</span> CF_ENHMETAFILE:
00562         <span class="keywordflow">case</span> CF_DSPENHMETAFILE:
00563             <span class="keywordflow">if</span> (cb &gt;= <span class="keyword">sizeof</span>(HANDLE)) {
00564                 <span class="keywordflow">if</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a> != 0) {
00565                     DeleteEnhMetaFile((HANDLE)pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o2">Data</a>);
00566                 }
00567             }
00568             <span class="keywordflow">break</span>;
00569         }
00570         <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00571         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(hDDE);
00572     } <span class="keywordflow">else</span> {
00573         <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00574     }
00575 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a116" doxytag="ddemlcli.h::GetConvContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID GetConvContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>pl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00368">368</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00674">GWL_CONVCONTEXT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00371 {
00372     <span class="keywordtype">int</span> i;
00373 
00374     <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(CONVCONTEXT); i += 4) {
00375         *pl++ = GetWindowLong(hwnd, GWL_CONVCONTEXT + i);
00376     }
00377 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="ddemlcli.h::GetHandleData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR GetHandleData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00165">165</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00060">CheckHandleTable</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, and <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00041">IndexFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>.
<p>
<pre class="fragment"><div>00167 {
00168     <span class="keyword">register</span> ULONG_PTR dwRet;
00169 
00170     <a class="code" href="../../d3/d8/handles_8c.html#a1">CheckHandleTable</a>();
00171     dwRet = <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a1">IndexFromHandle</a>(h)].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>;
00172     <span class="keywordflow">return</span> (dwRet);
00173 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="ddemlcli.h::GlobalToLocalAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> GlobalToLocalAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ga</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">464</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00466 {
00467     WCHAR sz[256];
00468 
00469     <span class="keywordflow">if</span> (ga == 0) {
00470         <span class="keywordflow">return</span> (0);
00471     }
00472     <span class="keywordflow">if</span> (GlobalGetAtomName((ATOM)ga, sz, 256) == 0) {
00473         RIPMSG0(RIP_WARNING, <span class="stringliteral">"GlobalToLocalAtom out of memory"</span>);
00474         <span class="keywordflow">return</span> (0);
00475     }
00476     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)AddAtom(sz));
00477 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="ddemlcli.h::IncGlobalAtomCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> IncGlobalAtomCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>la</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">490</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00030">SendRegisterMessageToClass()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.
<p>
<pre class="fragment"><div>00492 {
00493     WCHAR sz[256];
00494 
00495     <span class="keywordflow">if</span> (ga == 0) {
00496         <span class="keywordflow">return</span> (0);
00497     }
00498     <span class="keywordflow">if</span> (GlobalGetAtomName(ga, sz, 256) == 0) {
00499         RIPMSG0(RIP_WARNING, <span class="stringliteral">"IncGlobalAtomCount out of memory"</span>);
00500         <span class="keywordflow">return</span> (0);
00501     }
00502     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)GlobalAddAtom(sz));
00503 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="ddemlcli.h::IncLocalAtomCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> IncLocalAtomCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>la</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">516</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00518 {
00519     WCHAR sz[256];
00520 
00521     <span class="keywordflow">if</span> (la == 0) {
00522         <span class="keywordflow">return</span> (0);
00523     }
00524     <span class="keywordflow">if</span> (GetAtomName(la, sz, 256) == 0) {
00525         RIPMSG0(RIP_WARNING, <span class="stringliteral">"IncLocalAtomCount out of memory"</span>);
00526         <span class="keywordflow">return</span> (0);
00527     }
00528     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)AddAtom(sz));
00529 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a122" doxytag="ddemlcli.h::InternalCreateDataHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDDEDATA InternalCreateDataHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>pSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbOff</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wStatus</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">94</a> of file <a class="el" href="../../d1/d8/hdata_8c-source.html">hdata.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00257">tagDDEMLDATA::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00256">tagDDEMLDATA::hDDE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00108">HTYPE_DATA_HANDLE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00125">UserGlobalAlloc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>, and <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00102 {
00103     <a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a> pdd;
00104     HDDEDATA hRet;
00105     LPBYTE p;
00106     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbOff2;
00107 
00108     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00109 
00110     pdd = (<a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d2/structtagDDEMLDATA.html">DDEMLDATA</a>));
00111     <span class="keywordflow">if</span> (pdd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00112         <span class="keywordflow">return</span> (0);
00113     }
00114     <span class="keywordflow">if</span> (cb == -1) {
00115         pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a> = (HANDLE)pSrc;
00116     } <span class="keywordflow">else</span> {
00117         <span class="keywordflow">if</span> (flags &amp; HDATA_EXECUTE) {
00118             cbOff2 = 0;
00119         } <span class="keywordflow">else</span> {
00120             cbOff2 = <span class="keyword">sizeof</span>(WORD) + <span class="keyword">sizeof</span>(WORD); <span class="comment">// skip wStatus, wFmt</span>
00121         }
00122         pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a> = <a class="code" href="../../d6/d0/usercli_8h.html#a3">UserGlobalAlloc</a>(GMEM_DDESHARE | GMEM_MOVEABLE | GMEM_ZEROINIT,
00123                 cb + cbOff + cbOff2);
00124         <span class="keywordflow">if</span> (pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00125             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdd);
00126             <span class="keywordflow">return</span> (0);
00127         }
00128 
00129         <span class="keywordflow">if</span> (!(flags &amp; HDATA_EXECUTE)) {
00130             <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
00131 
00132             <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a>, pdde);
00133             UserAssert(pdde);
00134             pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a> = wStatus;
00135             pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a> = wFmt;
00136             <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a>);
00137         }
00138     }
00139     pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o1">flags</a> = (WORD)flags;
00140     hRet = (HDDEDATA)<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>((ULONG_PTR)pdd, HTYPE_DATA_HANDLE,
00141             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>));
00142     <span class="keywordflow">if</span> (!hRet) {
00143         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(pdd-&gt;hDDE);
00144         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdd);
00145         <span class="keywordflow">return</span> (0);
00146     }
00147     <span class="keywordflow">if</span> (cb != -1 &amp;&amp; pSrc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00148         <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(pdd-&gt;hDDE, p);
00149         UserAssert(p);
00150         RtlCopyMemory(p + cbOff + cbOff2, pSrc, cb);
00151         <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(pdd-&gt;hDDE);
00152         pdd-&gt;flags |= HDATA_INITIALIZED;
00153     }
00154     <span class="keywordflow">return</span> (hRet);
00155 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="ddemlcli.h::InternalDdeCreateStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HSZ InternalDdeCreateStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">49</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00029">MONHSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00024">DdeCreateStringHandleA()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00036">DdeCreateStringHandleW()</a>.
<p>
<pre class="fragment"><div>00053 {
00054     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00055     HSZ hszRet = 0;
00056     <span class="keywordtype">int</span> cb;
00057     WCHAR szw[256];
00058 
00059     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00060 
00061     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00062     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00063         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00064         <span class="keywordflow">goto</span> Exit;
00065     }
00066 
00067     <span class="keywordflow">switch</span> (iCodePage) {
00068     <span class="keywordflow">case</span> CP_WINANSI:
00069         <span class="keywordflow">if</span> (*(LPSTR)psz == <span class="charliteral">'\0'</span>) {
00070             <span class="keywordflow">goto</span> Exit;
00071         }
00072         hszRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(AddAtomA((LPSTR)psz));
00073         <span class="keywordflow">break</span>;
00074 
00075     <span class="keywordflow">default</span>:
00076 
00077         <span class="comment">/*</span>
00078 <span class="comment">         * Convert psz to unicode and fall through.</span>
00079 <span class="comment">         */</span>
00080         cb = <span class="keyword">sizeof</span>(szw) /  <span class="keyword">sizeof</span>(WCHAR);
00081 <span class="preprocessor">#ifdef LATER</span>
00082 <span class="preprocessor"></span>        MultiByteToWideChar((UINT)iCodePage, MB_PRECOMPOSED,
00083                             (LPSTR)psz, -1, szw, cb);
00084 <span class="preprocessor">#endif</span>
00085 <span class="preprocessor"></span>        psz = &amp;szw[0];
00086 
00087 
00088     <span class="keywordflow">case</span> CP_WINUNICODE:
00089         <span class="keywordflow">if</span> (*(LPWSTR)psz == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>) {
00090             <span class="keywordflow">goto</span> Exit;
00091         }
00092         hszRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(AddAtomW((LPWSTR)psz));
00093         <span class="keywordflow">break</span>;
00094     }
00095     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a3">MONHSZ</a>(pcii, hszRet, MH_CREATE);
00096 
00097 Exit:
00098     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00099     <span class="keywordflow">return</span> (hszRet);
00100 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="ddemlcli.h::InternalDdeInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT InternalDdeInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pidInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFNCALLBACK&nbsp;</td>
          <td class="mdname" nowrap> <em>pfnCallback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fUnicode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">65</a> of file <a class="el" href="../../d0/d3/ddemlcli_8c-source.html">ddemlcli.c</a>.
<p>
References <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01197">_CreateWindowEx()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a68">CL_INSTANCE_INFO</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00196">tagCL_INSTANCE_INFO::cNameServiceAlloc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02744">CW_FLAGS_DIFFHMOD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00668">GWLP_INSTANCE_INFO</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00185">tagCL_INSTANCE_INFO::hInstServer</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00356">ICLS_DDEMLMOTHER</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04526">NtUserCallOneParam()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02929">NtUserUpdateInstance()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00017">pciiList</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00195">tagCL_INSTANCE_INFO::plaNameService</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00185">SetHandleData()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00039">DdeInitializeA()</a>, and <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00052">DdeInitializeW()</a>.
<p>
<pre class="fragment"><div>00070 {
00071     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uiRet = DMLERR_MEMORY_ERROR;
00072     <span class="keyword">register</span> <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00073 
00074     <span class="keywordflow">if</span> (afCmd &amp; APPCLASS_MONITOR) {
00075         afCmd |= CBF_MONMASK;
00076     }
00077 
00078     <span class="keywordflow">if</span> (afCmd &amp; APPCMD_CLIENTONLY) {
00079         afCmd |= CBF_FAIL_CONNECTIONS;
00080     }
00081 
00082     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00083 
00084     <span class="keywordflow">if</span> (*pidInst != 0) {
00085         pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( *pidInst ));
00086         <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00087             uiRet = DMLERR_INVALIDPARAMETER;
00088             <span class="keywordflow">goto</span> Exit;
00089         }
00090 
00091         <span class="comment">// only allow certain bits to be changed on reinitialize call</span>
00092 
00093         pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> = (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; ~(CBF_MASK | MF_MASK)) |
00094                 (afCmd &amp; (CBF_MASK | MF_MASK));
00095 
00096         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00097         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a121">NtUserUpdateInstance</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>, &amp;pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a>, afCmd);
00098         <span class="keywordflow">return</span> (DMLERR_NO_ERROR);
00099     }
00100 
00101     pcii = (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">CL_INSTANCE_INFO</a>));
00102     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00103         uiRet = DMLERR_MEMORY_ERROR;
00104         <span class="keywordflow">goto</span> Exit;
00105     }
00106 
00107     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o11">plaNameService</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(LATOM));
00108     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o11">plaNameService</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00109         uiRet = DMLERR_MEMORY_ERROR;
00110         <span class="keywordflow">goto</span> Backout3;
00111     }
00112     <span class="comment">// *pcii-&gt;plaNameService = 0; // zero init takes care of this</span>
00113     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o12">cNameServiceAlloc</a> = 1;
00114 
00115 
00116     <span class="comment">/*</span>
00117 <span class="comment">     * Flag this window as being create from a diff hmod as the app so</span>
00118 <span class="comment">     * hotkeys don't take it as the first window created in the app and</span>
00119 <span class="comment">     * assign it as the hotkey.</span>
00120 <span class="comment">     */</span>
00121     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a> =  <a class="code" href="../../d6/d0/usercli_8h.html#a624">_CreateWindowEx</a>(0, (LPTSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLMOTHER]), L<span class="stringliteral">""</span>,
00122             WS_POPUP, 0, 0, 0, 0, (HWND)0,
00123             (HMENU)0, 0, (LPVOID)NULL, CW_FLAGS_DIFFHMOD);
00124 
00125     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a> == 0) {
00126         uiRet = DMLERR_SYS_ERROR;
00127         <span class="keywordflow">goto</span> Backout2;
00128     }
00129     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>, GWLP_INSTANCE_INFO, (LONG_PTR)pcii);
00130 
00131     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> = afCmd | APPCMD_FILTERINITS;
00132     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o8">pfnCallback</a> = pfnCallback;
00133     <span class="comment">// pcii-&gt;LastError = DMLERR_NO_ERROR; // zero init</span>
00134     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> = GetCurrentThreadId();
00135     <span class="comment">// pcii-&gt;aServerLookup = NULL;          // zero init</span>
00136     <span class="comment">// pcii-&gt;cServerLookupAlloc = 0;        // zero init</span>
00137     <span class="comment">// pcii-&gt;ConvStartupState = 0;          // zero init - Not blocked.</span>
00138     <span class="comment">// pcii-&gt;flags = 0;                     // zero init</span>
00139     <span class="comment">// pcii-&gt;cInDDEMLCallback = 0;          // zero init</span>
00140     <span class="comment">// pcii-&gt;pLinkCounts = NULL;            // zero init</span>
00141 
00142     <span class="comment">// Do this last when the client side is ready for whatever events</span>
00143     <span class="comment">// flying around may come charging in.</span>
00144 
00145     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00146     uiRet = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a120">NtUserDdeInitialize</a>(&amp;pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>,
00147                             &amp;pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o5">hwndEvent</a>,
00148                             &amp;pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a>,
00149                             pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a>,
00150                             pcii);
00151     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00152 
00153     <span class="keywordflow">if</span> (uiRet != DMLERR_NO_ERROR) {
00154 Backout:
00155         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>);
00156 Backout2:
00157         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o11">plaNameService</a>);
00158 Backout3:
00159         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcii);
00160         <span class="keywordflow">goto</span> Exit;
00161     }
00162     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a> = <a class="code" href="../../d0/d4/instance_8c.html#a5">AddInstance</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>);
00163     *pidInst = HandleToUlong(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>);
00164     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a> == 0) {
00165         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00166         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a174">NtUserCallOneParam</a>((ULONG_PTR)pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>, SFI__CSDDEUNINITIALIZE);
00167         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00168         uiRet = DMLERR_MEMORY_ERROR;
00169         <span class="keywordflow">goto</span> Backout;
00170     }
00171     <a class="code" href="../../d3/d8/handles_8c.html#a9">SetHandleData</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>, (ULONG_PTR)pcii);
00172 
00173     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o0">next</a> = <a class="code" href="../../d9/d3/ddemlcli_8c.html#a0">pciiList</a>;
00174     <a class="code" href="../../d9/d3/ddemlcli_8c.html#a0">pciiList</a> = pcii;
00175     <span class="keywordflow">if</span> (fUnicode) {
00176         pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> |= <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>;
00177     }
00178     uiRet = DMLERR_NO_ERROR;
00179 
00180 Exit:
00181     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00182     <span class="keywordflow">return</span> (uiRet);
00183 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="ddemlcli.h::InternalDdeQueryString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> InternalDdeQueryString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">141</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00113">DdeQueryStringA()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00127">DdeQueryStringW()</a>.
<p>
<pre class="fragment"><div>00147 {
00148     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00149     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwRet = 0;
00150     WCHAR szw[256];
00151 <span class="comment">// BOOL fDefUsed; // LATER</span>
00152 
00153     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00154 
00155     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00156     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00157         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00158         <span class="keywordflow">goto</span> Exit;
00159     }
00160 
00161     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hsz) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00162         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00163         <span class="keywordflow">goto</span> Exit;
00164     }
00165 
00166     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz) == 0) {
00167         <span class="keywordflow">if</span> (iCodePage == CP_WINUNICODE) {
00168             <span class="keywordflow">if</span> (psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00169                 *(LPWSTR)psz = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00170             }
00171             dwRet = <span class="keyword">sizeof</span>(WCHAR);
00172             <span class="keywordflow">goto</span> Exit;
00173         } <span class="keywordflow">else</span> {
00174             <span class="keywordflow">if</span> (psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00175                 *(LPSTR)psz = <span class="charliteral">'\0'</span>;
00176             }
00177             dwRet = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>);
00178             <span class="keywordflow">goto</span> Exit;
00179         }
00180     }
00181 
00182     <span class="keywordflow">if</span> (psz == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00183         cbMax = <span class="keyword">sizeof</span>(szw);
00184         psz = (PVOID)szw;
00185     }
00186 
00187     <span class="keywordflow">switch</span> (iCodePage) {
00188     <span class="keywordflow">case</span> CP_WINANSI:
00189         dwRet = GetAtomNameA(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), psz, cbMax);
00190         <span class="keywordflow">break</span>;
00191 
00192     <span class="keywordflow">default</span>:
00193         dwRet = GetAtomNameW(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), (LPWSTR)psz, cbMax / <span class="keyword">sizeof</span>(WCHAR));
00194         <span class="keywordflow">if</span> (iCodePage != CP_WINUNICODE) {
00195 
00196             <span class="comment">/*</span>
00197 <span class="comment">             * convert psz to the appropriate codepage and count the</span>
00198 <span class="comment">             * characters(ie BYTES for DBCS!) to alter dwRet.</span>
00199 <span class="comment">             */</span>
00200 <span class="preprocessor">#ifdef LATER</span>
00201 <span class="preprocessor"></span>            <span class="comment">// Does this routine work in place? (i.e. input and output buffer the same).</span>
00202             WideCharToMultiByte((UINT)iCodePage, 0, szw,
00203                     <span class="keyword">sizeof</span>(szw) /  <span class="keyword">sizeof</span>(WCHAR),
00204                     (LPSTR)psz, cbMax, NULL, &amp;fDefUsed);
00205 <span class="preprocessor">#endif</span>
00206 <span class="preprocessor"></span>            dwRet = cbMax + 1;
00207         }
00208         <span class="keywordflow">break</span>;
00209     }
00210 
00211 Exit:
00212     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00213     <span class="keywordflow">return</span> (dwRet);
00214 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a124" doxytag="ddemlcli.h::InternalFreeDataHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InternalFreeDataHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDDEDATA&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIgnorefRelease</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">416</a> of file <a class="el" href="../../d1/d8/hdata_8c-source.html">hdata.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00257">tagDDEMLDATA::flags</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00256">tagDDEMLDATA::hDDE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00108">HTYPE_DATA_HANDLE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00451">ApplyFreeDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00419 {
00420     <a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a> pdd;
00421 
00422     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00423 
00424     pdd = (<a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hData,
00425             HTYPE_DATA_HANDLE, HINST_ANY);
00426     <span class="keywordflow">if</span> (pdd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00427         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00428     }
00429     <span class="keywordflow">if</span> (pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o1">flags</a> &amp; HDATA_EXECUTE) {
00430         <span class="keywordflow">if</span> (!(pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o1">flags</a> &amp; HDATA_APPOWNED) || fIgnorefRelease) {
00431             <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a>);
00432         }
00433     } <span class="keywordflow">else</span> {
00434         <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a>, fIgnorefRelease, TRUE);
00435     }
00436     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdd);
00437     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)hData);
00438     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00439 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a119" doxytag="ddemlcli.h::LinkTransaction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID LinkTransaction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">846</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00121">tagXACT_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00221">tagCONV_INFO::pxiIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00222">tagCONV_INFO::pxiOut</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.
<p>
<pre class="fragment"><div>00848 {
00849     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00850 
00851     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00852     <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00853         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o10">pxiIn</a> = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> = pxi;
00854     } <span class="keywordflow">else</span> {
00855         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o10">pxiIn</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a> = pxi;
00856         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o10">pxiIn</a> = pxi;
00857     }
00858 <span class="preprocessor">#if DBG</span>
00859 <span class="preprocessor"></span>    <span class="comment">/*</span>
00860 <span class="comment">     * Temporary check to find stress bug - make sure pxi list is not</span>
00861 <span class="comment">     * looped on itself.  If it is, this loop will never exit and things</span>
00862 <span class="comment">     * will get investigated. (sanfords)</span>
00863 <span class="comment">     */</span>
00864     {
00865         <a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxiT;
00866 
00867         <span class="keywordflow">for</span> (pxiT = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>; pxiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pxiT = pxiT-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a>) {
00868             ;
00869         }
00870     }
00871 <span class="preprocessor">#endif // DBG</span>
00872 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="ddemlcli.h::LocalToGlobalAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> LocalToGlobalAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>la</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">438</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.
<p>
<pre class="fragment"><div>00440 {
00441     WCHAR sz[256];
00442 
00443     <span class="keywordflow">if</span> (la == 0) {
00444         <span class="keywordflow">return</span> (0);
00445     }
00446     <span class="keywordflow">if</span> (GetAtomName((ATOM)la, sz, 256) == 0) {
00447         RIPMSG0(RIP_WARNING, <span class="stringliteral">"LocalToGlobalAtom out of memory"</span>);
00448         <span class="keywordflow">return</span> (0);
00449     }
00450     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)GlobalAddAtom(sz));
00451 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="ddemlcli.h::MakeInstSpecificAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> MakeInstSpecificAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00367">367</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, and <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>.
<p>
<pre class="fragment"><div>00370 {
00371     WCHAR sz[256];
00372     LPWSTR psz;
00373 
00374     <span class="keywordflow">if</span> (GetAtomName(la, sz, 256) == 0) {
00375         <span class="keywordflow">return</span> (0);
00376     }
00377 <span class="preprocessor">#ifdef UNICODE</span>
00378 <span class="preprocessor"></span>    psz = sz + wcslen(sz);
00379 <span class="preprocessor">#else</span>
00380 <span class="preprocessor"></span>    psz = sz + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(sz);
00381 <span class="preprocessor">#endif</span>
00382 <span class="preprocessor"></span>    wsprintf(psz, TEXT(<span class="stringliteral">"(%#p)"</span>), hwnd);
00383     la = AddAtom(sz);
00384     <span class="keywordflow">return</span> (la);
00385 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a169" doxytag="ddemlcli.h::MonitorConv" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorConv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fConnect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">167</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a2">pcs</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00170 {
00171     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00172 
00173     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00174 
00175     UserAssert(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_CONV);
00176 
00177     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00178             <span class="keyword">sizeof</span>(MONCONVSTRUCT));
00179     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00180         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
00181         <span class="keywordflow">return</span> ;
00182     }
00183 
00184     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_CONV;
00185     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00186     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONCONVSTRUCT);
00187 
00188 <span class="preprocessor">#define pcs ((MONCONVSTRUCT *)&amp;pep-&gt;Data)</span>
00189 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;cb =           <span class="keyword">sizeof</span>(MONCONVSTRUCT);
00190     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;fConnect =     fConnect;
00191     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;dwTime =       <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00192     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hTask =        (HANDLE)LongToHandle( pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00193     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszSvc =       (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>);
00194     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszTopic =     (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>);
00195     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
00196         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvClient =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
00197         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvServer =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>;
00198     } <span class="keywordflow">else</span> {
00199         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvClient =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>;
00200         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvServer =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
00201     }
00202 
00203     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00204     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00205     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00206 
00207     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszSvc);
00208     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszTopic);
00209 <span class="preprocessor">#undef pcs</span>
00210 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a168" doxytag="ddemlcli.h::MonitorLink" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorLink           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fEstablished</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fNoData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laSvc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>gaItem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fServer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvServer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvClient</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">90</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a1">pls</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00101 {
00102     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00103 
00104     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00105 
00106     UserAssert(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_LINKS);
00107 
00108     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00109             <span class="keyword">sizeof</span>(MONLINKSTRUCT));
00110     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00111         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00112         <span class="keywordflow">return</span> ;
00113     }
00114 
00115     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_LINKS;
00116     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00117     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONLINKSTRUCT);
00118 
00119 <span class="preprocessor">#define pls ((MONLINKSTRUCT *)&amp;pep-&gt;Data)</span>
00120 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;cb =           <span class="keyword">sizeof</span>(MONLINKSTRUCT);
00121     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;dwTime =       <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00122     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hTask =        (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00123     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fEstablished = fEstablished;
00124     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fNoData =      fNoData;
00125 
00126     <span class="comment">// use global atoms here - these need to be changed to local atoms before</span>
00127     <span class="comment">// the callbacks to the ddespy apps.</span>
00128 
00129     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszSvc =       (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(aService);
00130     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszTopic =     (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(aTopic);
00131     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(aItem);
00132     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszItem =      (HSZ)aItem;
00133 
00134     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;wFmt =         wFmt;
00135     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fServer =      fServer;
00136     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hConvServer =  hConvServer;
00137     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hConvClient =  hConvClient;
00138 
00139     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00140     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00141     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00142 
00143     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszSvc);
00144     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszTopic);
00145     GlobalDeleteAtom(aItem);
00146 <span class="preprocessor">#undef pls</span>
00147 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a167" doxytag="ddemlcli.h::MonitorStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fsAction</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">31</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a0">phszs</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00035 {
00036     WCHAR szT[256];
00037     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00038     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchString;
00039 
00040     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00041 
00042     UserAssert(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_HSZ_INFO);
00043 
00044     <span class="keywordflow">if</span> (!(cchString = GetAtomName(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), szT,
00045             <span class="keyword">sizeof</span>(szT) / <span class="keyword">sizeof</span>(WCHAR)))) {
00046         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00047         <span class="keywordflow">return</span> ;
00048     }
00049     cchString++;
00050     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00051             <span class="keyword">sizeof</span>(MONHSZSTRUCT) + cchString * <span class="keyword">sizeof</span>(WCHAR));
00052     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00053         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00054         <span class="keywordflow">return</span> ;
00055     }
00056 
00057     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_HSZ_INFO;
00058     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00059     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  (WORD)(<span class="keyword">sizeof</span>(MONHSZSTRUCT) + cchString * <span class="keyword">sizeof</span>(WCHAR));
00060 
00061 <span class="preprocessor">#define phszs ((MONHSZSTRUCT *)&amp;pep-&gt;Data)</span>
00062 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;cb =      <span class="keyword">sizeof</span>(MONHSZSTRUCT);
00063     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;fsAction = fsAction;
00064     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;dwTime =  <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00065     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;hsz = hsz;
00066     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;hTask = (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00067     <span class="comment">// phszs-&gt;wReserved = 0; // zero init.</span>
00068     wcscpy(<a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;str, szT);
00069 
00070     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00071     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00072     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00073 <span class="preprocessor">#undef phszs</span>
00074 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a161" doxytag="ddemlcli.h::PackAndPostMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> PackAndPostMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndTo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msgIn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msgOut</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndFrom</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>uiLo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>uiHi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">1534</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00061">FAIL_POST</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00064">FAILNOFREE_POST</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00666">ReuseDDElParam()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.
<p>
<pre class="fragment"><div>01542 {
01543     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> retval;
01544 
01545     lParam = <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a10">ReuseDDElParam</a>(lParam, msgIn, msgOut, uiLo, uiHi);
01546     <span class="keywordflow">if</span> (!lParam) {
01547         <span class="keywordflow">return</span> (DMLERR_MEMORY_ERROR);
01548     }
01549     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01550     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01551     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
01552 
01553     retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(hwndTo, msgOut, (WPARAM)hwndFrom, lParam);
01554     <span class="keywordflow">switch</span> (retval) {
01555     <span class="keywordflow">case</span> <a class="code" href="../../d6/d4/ddetrack_8h.html#a17">FAIL_POST</a>:
01556 <span class="preprocessor">#if (FAIL_POST != FALSE)</span>
01557 <span class="preprocessor"></span><span class="preprocessor">#error FAIL_POST must be defined as PostMessage's failure return value.</span>
01558 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01559 <span class="preprocessor"></span>        <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(msgOut, lParam);
01560         RIPMSG0(RIP_WARNING, <span class="stringliteral">"PostMessage failed."</span>);
01561         <span class="comment">/* Fall through */</span>
01562 
01563     <span class="keywordflow">case</span> <a class="code" href="../../d6/d4/ddetrack_8h.html#a20">FAILNOFREE_POST</a>:
01564         retval = DMLERR_POSTMSG_FAILED;
01565         <span class="keywordflow">break</span>;
01566 
01567     <span class="keywordflow">default</span>:
01568 <span class="preprocessor">#if (FAKE_POST != TRUE)</span>
01569 <span class="preprocessor"></span><span class="preprocessor">#error FAKE_POST must be defined as PostMessage's success return value.</span>
01570 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01571 <span class="preprocessor"></span>        UserAssert(retval == TRUE);
01572         retval = 0;
01573     }
01574 
01575     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01576     <span class="keywordflow">return</span> (retval);
01577 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="ddemlcli.h::ParseInstSpecificAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND ParseInstSpecificAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>plaNormal</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00398">398</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.
<p>
<pre class="fragment"><div>00401 {
00402     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> sz[256];
00403     LPSTR pszHwnd;
00404     HWND hwnd;
00405 
00406     <span class="comment">/*</span>
00407 <span class="comment">     * LATER- NEED TO MAKE THIS UNICODE BASED WHEN WE GET A SCANF WE CAN USE</span>
00408 <span class="comment">     */</span>
00409     <span class="keywordflow">if</span> (GetAtomNameA(la, sz, 256) == 0) {
00410         <span class="keywordflow">return</span> (0);
00411     }
00412     pszHwnd = strrchr(sz, <span class="charliteral">'('</span>);
00413     <span class="keywordflow">if</span> (pszHwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00414         <span class="keywordflow">return</span> (0);
00415     }
00416     <span class="keywordflow">if</span> (sscanf(pszHwnd, <span class="stringliteral">"(%#p)"</span>, &amp;hwnd) != 1) {
00417         <span class="keywordflow">return</span> (0);
00418     }
00419     <span class="keywordflow">if</span> (plaNormal != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00420         *pszHwnd = <span class="charliteral">'\0'</span>;
00421         *plaNormal = AddAtomA(sz);
00422     }
00423     <span class="keywordflow">return</span> (hwnd);
00424 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a90" doxytag="ddemlcli.h::PciiFromHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> PciiFromHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">226</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00032">cHandlesAllocated</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>.
<p>
<pre class="fragment"><div>00228 {
00229     <a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html">PCHANDLEENTRY</a> phe;
00230 
00231     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00232 
00233     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>) {
00234         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00235     }
00236     phe = &amp;<a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a>];
00237 
00238     <span class="keywordflow">do</span> {
00239         phe--;
00240         <span class="keywordflow">if</span> (phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> != 0 &amp;&amp;
00241                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a34">HTYPE_INSTANCE</a> &amp;&amp;
00242                 (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a>) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(h))) {
00243             <span class="keywordflow">return</span>(((<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>)-&gt;tid == GetCurrentThreadId() ?
00244                 (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)phe-&gt;<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a> : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00245         }
00246     } <span class="keywordflow">while</span> (phe != <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>);
00247     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00248 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a137" doxytag="ddemlcli.h::ProcessAsyncDDEMsg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ProcessAsyncDDEMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndFrom</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">572</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">CheckForQueuedMessages()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00223">tagCONV_INFO::dmqIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00224">tagCONV_INFO::dmqOut</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00162">tagDDE_MESSAGE_QUEUE::lParam</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00161">tagDDE_MESSAGE_QUEUE::msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00159">tagDDE_MESSAGE_QUEUE::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00160">tagDDE_MESSAGE_QUEUE::pcoi</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00496">DDEMLServerWndProc()</a>.
<p>
<pre class="fragment"><div>00577 {
00578     <a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">PDDE_MESSAGE_QUEUE</a> pdmq;
00579 <span class="preprocessor">#if DBG</span>
00580 <span class="preprocessor"></span>    HWND hwndT = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
00581 <span class="preprocessor">#endif // DBG</span>
00582 <span class="preprocessor"></span>
00583     <span class="keywordflow">while</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a> != hwndFrom) {
00584         pcoi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
00585     }
00586     <span class="keywordflow">if</span> (pcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00587         RIPMSG3(RIP_WARNING,
00588                 <span class="stringliteral">"Bogus DDE message %x received from %x by %x. Dumping."</span>,
00589                 msg, hwndFrom, hwndT);
00590         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(FALSE, msg, lParam);
00591         <span class="keywordflow">return</span> ;
00592     }
00593     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00594 
00595         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00596                 !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_BLOCKED)
00597 <span class="comment">//                &amp;&amp; !PctiCurrent()-&gt;cInDDEMLCallback</span>
00598                 ) {
00599 
00600             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d4/ddemlwp_8c.html#a8">ProcessSyncDDEMessage</a>(pcoi, msg, lParam)) {
00601                 <span class="keywordflow">return</span>; <span class="comment">// not blocked, ok to return.</span>
00602             }
00603         }
00604 
00605         <span class="comment">// enter into queue</span>
00606 
00607         pdmq = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">DDE_MESSAGE_QUEUE</a>));
00608         <span class="keywordflow">if</span> (pdmq == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00609 
00610             <span class="comment">// insufficient memory - we can't process this msg - we MUST</span>
00611             <span class="comment">// terminate.</span>
00612 
00613             <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00614                 <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_TERMINATE,
00615                         (WPARAM)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0);
00616                 pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_CONNECTED;
00617             }
00618             <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), msg, lParam);
00619             <span class="keywordflow">return</span> ;
00620         }
00621         pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o1">pcoi</a> = pcoi;
00622         pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o2">msg</a> = <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
00623         pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o3">lParam</a> = lParam;
00624         pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00625 
00626         <span class="comment">// dmqOut-&gt;next-&gt;next-&gt;next-&gt;dmqIn-&gt;NULL</span>
00627 
00628         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00629             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a> = pdmq;
00630         }
00631         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a> = pdmq;
00632         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00633             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a>;
00634         }
00635         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>++;
00636         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a6">CheckForQueuedMessages</a>(pcoi);
00637         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>--;
00638         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a> == 0 &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_FREE_CONV_RES_NOW) {
00639             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a>(pcoi);
00640         }
00641     } <span class="keywordflow">else</span> {
00642         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), msg, lParam);
00643     }
00644 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a171" doxytag="ddemlcli.h::ProcessRegistrationMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT ProcessRegistrationMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/register_8c-source.html#l00090">90</a> of file <a class="el" href="../../d0/d6/register_8c-source.html">register.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00668">GWLP_INSTANCE_INFO</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00071">INST_SPECIFIC_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00367">MakeInstSpecificAtom()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00906">TYPE_WINDOW</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00027">DDEMLMotherWndProc()</a>.
<p>
<pre class="fragment"><div>00095 {
00096     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00097     LRESULT lRet = 0;
00098 
00099     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00100 
00101     <span class="comment">/*</span>
00102 <span class="comment">     * wParam = GATOM of app</span>
00103 <span class="comment">     * lParam = hwndListen of source - may be a WOW DDEML source unthunked.</span>
00104 <span class="comment">     */</span>
00105     lParam = (LPARAM)<a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>((HWND)lParam, TYPE_WINDOW);
00106     lParam = (LPARAM)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>((PVOID)lParam);
00107 
00108     <span class="keywordflow">if</span> (lParam == 0) {
00109         <span class="keywordflow">return</span>(0);
00110     }
00111 
00112     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00113 
00114     pcii = (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_INSTANCE_INFO);
00115     <span class="keywordflow">if</span> (pcii != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00116             !((<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> == UM_REGISTER) &amp;&amp; (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_REGISTRATIONS)) &amp;&amp;
00117             !((<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> == UM_UNREGISTER) &amp;&amp; (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_UNREGISTRATIONS))) {
00118 
00119         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, lais;
00120 
00121         la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)wParam);
00122         lais = <a class="code" href="../../d4/d2/hsz_8c.html#a10">MakeInstSpecificAtom</a>(la, (HWND)lParam);
00123 
00124         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii,
00125                 (WORD)((msg == UM_REGISTER) ? XTYP_REGISTER : XTYP_UNREGISTER),
00126                 0,
00127                 (HCONV)0L,
00128                 (HSZ)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00129                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a15">INST_SPECIFIC_HSZ_FROM_LATOM</a>(lais),
00130                 (HDDEDATA)0L,
00131                 0L,
00132                 0L);
00133 
00134         DeleteAtom(la);
00135         DeleteAtom(lais);
00136         lRet = 1;
00137     }
00138 
00139     GlobalDeleteAtom((ATOM)wParam);  <span class="comment">// receiver frees</span>
00140     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00141     <span class="keywordflow">return</span>(1);
00142 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a140" doxytag="ddemlcli.h::ProcessSyncDDEMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ProcessSyncDDEMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">782</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00201">tagCL_INSTANCE_INFO::cInDDEMLCallback</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">EnableEnumProc()</a>, <a class="el" href="../../d1/d7/clenum_8c-source.html#l00188">EnumChildWindows()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00107">HTYPE_TRANSACTION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00124">tagXACT_INFO::hXact</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00205">IIF_IN_SYNC_XACT</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00248">tagENABLE_ENUM_STRUCT::pfRet</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00222">tagCONV_INFO::pxiOut</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00249">tagENABLE_ENUM_STRUCT::wCmd</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00250">tagENABLE_ENUM_STRUCT::wCmd2</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">CheckForQueuedMessages()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>.
<p>
<pre class="fragment"><div>00786 {
00787     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fNotBlocked = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00788     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00789     <a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html">ENABLE_ENUM_STRUCT</a> ees;
00790     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet;
00791 
00792     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00793 
00794     <span class="comment">/*</span>
00795 <span class="comment">     * lock the conversation so its resources don't go away till we are</span>
00796 <span class="comment">     * done with them.  This function could generate a callback which could</span>
00797 <span class="comment">     * disconnect the conversation.</span>
00798 <span class="comment">     */</span>
00799     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>++;
00800 
00801     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_BLOCKNEXT) {
00802         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> ^= ST_BLOCKNEXT | ST_BLOCKED;
00803     }
00804     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_BLOCKALLNEXT) {
00805         ees.<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o0">pfRet</a> = &amp;fRet;
00806         ees.<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o1">wCmd</a> = EC_DISABLE;
00807         ees.<a class="code" href="../../d5/d4/structtagENABLE__ENUM__STRUCT.html#o2">wCmd2</a> = 0;
00808         <a class="code" href="../../d0/d8/clenum_8c.html#a8">EnumChildWindows</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>, (WNDENUMPROC)EnableEnumProc,
00809                 (LPARAM)&amp;ees);
00810     }
00811 
00812     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00813         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00814             <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
00815                 fNotBlocked = <a class="code" href="../../d2/d6/stdptcl_8c.html#a20">SpontaneousClientMessage</a>((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi, msg, lParam);
00816             } <span class="keywordflow">else</span> {
00817                 fNotBlocked = <a class="code" href="../../d2/d6/stdptcl_8c.html#a21">SpontaneousServerMessage</a>((<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>)pcoi, msg, lParam);
00818             }
00819         } <span class="keywordflow">else</span> {
00820             UserAssert(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a> == (HANDLE)0 ||
00821                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a89">ValidateCHandle</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>, HTYPE_TRANSACTION,
00822                     HINST_ANY)
00823                     == (ULONG_PTR)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>);
00824             fNotBlocked = (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a>)(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>, <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>, lParam);
00825         }
00826     } <span class="keywordflow">else</span> {
00827         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), msg, lParam);
00828     }
00829     <span class="keywordflow">if</span> (!fNotBlocked) {
00830         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_BLOCKED;
00831         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_BLOCKNEXT;
00832     }
00833 
00834     pcii = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>;  <span class="comment">// save this incase unlocking makes pcoi go away.</span>
00835 
00836     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a>--;
00837     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a> == 0 &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_FREE_CONV_RES_NOW) {
00838         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a>(pcoi);
00839     }
00840 
00841     <span class="comment">/*</span>
00842 <span class="comment">     * Because callbacks are capable of blocking DdeUninitialize(), we check</span>
00843 <span class="comment">     * before exit to see if it needs to be called.</span>
00844 <span class="comment">     */</span>
00845     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; APPCMD_UNINIT_ASAP &amp;&amp;
00846             !(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a49">IIF_IN_SYNC_XACT</a>) &amp;&amp;
00847             !pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o17">cInDDEMLCallback</a>) {
00848         <a class="code" href="../../d9/d3/ddemlcli_8c.html#a5">DdeUninitialize</a>(HandleToUlong(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>));
00849         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00850     }
00851     <span class="keywordflow">return</span> (fNotBlocked);
00852 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a136" doxytag="ddemlcli.h::ProcessTerminateMsg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> ProcessTerminateMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndFrom</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">543</a> of file <a class="el" href="../../d4/d3/ddemlwp_8c-source.html">ddemlwp.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00496">DDEMLServerWndProc()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.
<p>
<pre class="fragment"><div>00546 {
00547     <span class="keywordflow">while</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a> != hwndFrom) {
00548         pcoi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
00549     }
00550     <span class="keywordflow">if</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00551         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_TERMINATE_RECEIVED;
00552         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>(pcoi, TRUE);
00553     }
00554     <span class="keywordflow">return</span> (pcoi);
00555 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a170" doxytag="ddemlcli.h::RegisterService" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RegisterService           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fRegister</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>gaApp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndListen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/register_8c-source.html#l00068">68</a> of file <a class="el" href="../../d0/d6/register_8c-source.html">register.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00357">ICLS_DDEML16BIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00356">ICLS_DDEMLMOTHER</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00030">SendRegisterMessageToClass()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>.
<p>
<pre class="fragment"><div>00072 {
00073     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00074 
00075     <span class="comment">/*</span>
00076 <span class="comment">     * Send notification to each DDEML32 listening window.</span>
00077 <span class="comment">     */</span>
00078     <a class="code" href="../../d9/d6/register_8c.html#a0">SendRegisterMessageToClass</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLMOTHER], fRegister ? UM_REGISTER : UM_UNREGISTER,
00079             gaApp, hwndListen, fRegister);
00080     <span class="comment">/*</span>
00081 <span class="comment">     * Send notification to each DDEML16 listening window.</span>
00082 <span class="comment">     */</span>
00083     <a class="code" href="../../d9/d6/register_8c.html#a0">SendRegisterMessageToClass</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEML16BIT], fRegister ? UM_REGISTER : UM_UNREGISTER,
00084             gaApp, hwndListen, fRegister);
00085 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="ddemlcli.h::RW_RegisterDDEML" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL RW_RegisterDDEML           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>, and <a class="el" href="../../d7/d7/clinit_8c-source.html#l01729">CtxInitUser32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a112" doxytag="ddemlcli.h::SetCommonStateFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetCommonStateFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndUs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndThem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00876">876</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00251">GetWindowThreadProcessId()</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00533">IsWindowUnicode()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00880 {
00881     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> pidUs, pidThem;
00882 
00883     <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwndUs, &amp;pidUs);
00884     <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwndThem, &amp;pidThem);
00885     <span class="keywordflow">if</span> (pidUs == pidThem) {
00886         *pwFlags |= ST_INTRA_PROCESS;
00887     }
00888 
00889     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a27">IsWindowUnicode</a>(hwndUs) &amp;&amp; <a class="code" href="../../d3/d8/winmgrc_8c.html#a27">IsWindowUnicode</a>(hwndThem)) {
00890         *pwFlags |= ST_UNICODE_EXECUTE;
00891     }
00892 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a117" doxytag="ddemlcli.h::SetConvContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetConvContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>pl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00387">387</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00674">GWL_CONVCONTEXT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>.
<p>
<pre class="fragment"><div>00390 {
00391     <span class="keywordtype">int</span> i;
00392 
00393     <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(CONVCONTEXT); i += 4) {
00394         SetWindowLong(hwnd, GWL_CONVCONTEXT + i, *pl++);
00395     }
00396 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a129" doxytag="ddemlcli.h::SetEnableState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SetEnableState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wCmd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00441">441</a> of file <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html">w32/ntuser/client/callback.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00664">CheckForQueuedMessages()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00548">CI_PROCESSING_QUEUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00224">tagCONV_INFO::dmqOut</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00159">tagDDE_MESSAGE_QUEUE::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, and <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">EnableEnumProc()</a>.
<p>
<pre class="fragment"><div>00444 {
00445     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00446 
00447     <span class="keywordflow">switch</span> (wCmd) {
00448     <span class="keywordflow">case</span> EC_CHECKQUEUEONCE:
00449     <span class="keywordflow">case</span> EC_CHECKQUEUE:
00450         fRet = <a class="code" href="../../d3/d4/ddemlwp_8c.html#a6">CheckForQueuedMessages</a>(pcoi);
00451         <span class="keywordflow">break</span>;
00452 
00453     <span class="keywordflow">case</span> EC_QUERYWAITING:
00454         fRet = !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ||
00455                 (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00456                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>()-&gt;CI_flags &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a113">CI_PROCESSING_QUEUE</a>));
00457         <span class="keywordflow">break</span>;
00458 
00459     <span class="keywordflow">case</span> EC_DISABLE:
00460         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_BLOCKED;
00461         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~(ST_BLOCKNEXT | ST_BLOCKALLNEXT);
00462         <span class="keywordflow">break</span>;
00463 
00464     <span class="keywordflow">case</span> EC_ENABLEONE:
00465         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_BLOCKED;
00466         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_BLOCKNEXT;
00467         <span class="keywordflow">break</span>;
00468 
00469     <span class="keywordflow">case</span> EC_ENABLEONEOFALL:
00470         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_BLOCKED;
00471         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= (ST_BLOCKNEXT | ST_BLOCKALLNEXT);
00472         <span class="keywordflow">break</span>;
00473 
00474     <span class="keywordflow">case</span> EC_ENABLEALL:
00475         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~(ST_BLOCKED | ST_BLOCKNEXT | ST_BLOCKALLNEXT);
00476         <span class="keywordflow">break</span>;
00477 
00478     <span class="keywordflow">default</span>:
00479         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00480     }
00481     <span class="keywordflow">return</span> (fRet);
00482 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="ddemlcli.h::SetHandleData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetHandleData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dwData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00185">185</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00041">IndexFromHandle</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, and <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>.
<p>
<pre class="fragment"><div>00188 {
00189     <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[<a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a1">IndexFromHandle</a>(h)].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a> = dwData;
00190 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="ddemlcli.h::SetLastDDEMLError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetLastDDEMLError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>error</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">137</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00092">GetCurrentProcessId</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00193">tagCL_INSTANCE_INFO::LastError</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d0/d4/instance_8c.html#a1">perrs</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.
<p>
<pre class="fragment"><div>00140 {
00141     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00142 
00143     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_ERRORS &amp;&amp; !(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; APPCLASS_MONITOR)) {
00144         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00145                 <span class="keyword">sizeof</span>(MONERRSTRUCT));
00146         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00147             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_ERRORS;
00148             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00149             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONERRSTRUCT);
00150 <span class="preprocessor">#define perrs ((MONERRSTRUCT *)&amp;pep-&gt;Data)</span>
00151 <span class="preprocessor"></span>            <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;cb =      <span class="keyword">sizeof</span>(MONERRSTRUCT);
00152             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;wLastError = (WORD)error;
00153             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;dwTime =  <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00154             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;hTask =   (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00155 <span class="preprocessor">#undef perrs</span>
00156 <span class="preprocessor"></span>            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00157             <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00158             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00159         }
00160     }
00161 <span class="preprocessor">#if DBG</span>
00162 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (error != 0 &amp;&amp; error != DMLERR_NO_CONV_ESTABLISHED) {
00163         RIPMSG3(RIP_WARNING,
00164                 <span class="stringliteral">"DDEML Error set=%x, Client Instance=%x, Process=%x."</span>,
00165                 error, pcii, <a class="code" href="../../d4/d1/userk_8h.html#a19">GetCurrentProcessId</a>());
00166     }
00167 <span class="preprocessor">#endif</span>
00168 <span class="preprocessor"></span>    pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o9">LastError</a> = error;
00169 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a113" doxytag="ddemlcli.h::ShutdownConversation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ShutdownConversation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fMakeCallback</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">1109</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00036">MONCONV</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00759">DisconnectConv()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>.
<p>
<pre class="fragment"><div>01112 {
01113     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01114 
01115     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
01116         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_CONNECTED;
01117 
01118         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>)) {
01119             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_TERMINATE,
01120                     (WPARAM)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0);
01121         }
01122         <span class="keywordflow">if</span> (fMakeCallback &amp;&amp; !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_DISCONNECTS)) {
01123             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, (WORD)XTYP_DISCONNECT, 0, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
01124                     0, 0, 0, 0, (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_ISSELF) ? 1L : 0L);
01125         }
01126         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a5">MONCONV</a>(pcoi, FALSE);
01127     }
01128 
01129     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a>(pcoi);
01130 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a158" doxytag="ddemlcli.h::SpontaneousClientMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SpontaneousClientMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pci</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">1396</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>.
<p>
<pre class="fragment"><div>01400 {
01401     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01402     <span class="keywordflow">case</span> WM_DDE_DATA:
01403         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a4">ClSpontAdviseData</a>(pci, lParam));
01404         <span class="keywordflow">break</span>;
01405 
01406     <span class="keywordflow">default</span>:
01407         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), msg, lParam);
01408         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci, TRUE);
01409         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01410     }
01411 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a159" doxytag="ddemlcli.h::SpontaneousServerMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SpontaneousServerMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">1424</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>.
<p>
<pre class="fragment"><div>01428 {
01429     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01430     <span class="keywordflow">case</span> WM_DDE_ADVISE:
01431         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a1">SvSpontAdvise</a>(psi, lParam));
01432         <span class="keywordflow">break</span>;
01433 
01434     <span class="keywordflow">case</span> WM_DDE_UNADVISE:
01435         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a8">SvSpontUnadvise</a>(psi, lParam));
01436         <span class="keywordflow">break</span>;
01437 
01438     <span class="keywordflow">case</span> WM_DDE_EXECUTE:
01439         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a12">SvSpontExecute</a>(psi, lParam));
01440         <span class="keywordflow">break</span>;
01441 
01442     <span class="keywordflow">case</span> WM_DDE_POKE:
01443         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a15">SvSpontPoke</a>(psi, lParam));
01444         <span class="keywordflow">break</span>;
01445 
01446     <span class="keywordflow">case</span> WM_DDE_REQUEST:
01447         <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a18">SvSpontRequest</a>(psi, lParam));
01448         <span class="keywordflow">break</span>;
01449 
01450     <span class="keywordflow">default</span>:
01451         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), msg, lParam);
01452 
01453         <span class="comment">/*</span>
01454 <span class="comment">         * It use to call ShutdownConversation here. Don't call it</span>
01455 <span class="comment">         * anymore. Fix for bugs: 49063, 70906</span>
01456 <span class="comment">         */</span>
01457         <span class="comment">//ShutdownConversation((PCONV_INFO)psi, TRUE);</span>
01458         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01459     }
01460 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a146" doxytag="ddemlcli.h::SvRespAdviseDataAck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvRespAdviseDataAck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">470</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00153">ADVST_WAITING</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00642">FreeDDElParam()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00150">tagADVISE_LINK::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>, and <a class="el" href="../../d0/d4/ddemlcli_8h.html#a59">XACT_INFO</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.
<p>
<pre class="fragment"><div>00474 {
00475     UINT_PTR uiLo, uiHi;
00476     <span class="keywordtype">int</span> iLink;
00477     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink;
00478     <a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxiNew;
00479     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
00480     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSwapped;
00481 <span class="preprocessor">#if DBG</span>
00482 <span class="preprocessor"></span>    <span class="keywordtype">int</span> cLinks;
00483 <span class="preprocessor">#endif</span>
00484 <span class="preprocessor"></span>
00485     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00486         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> != WM_DDE_ACK) {
00487             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a21">SpontaneousServerMessage</a>((<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00488         }
00489         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ACK, lParam, &amp;uiLo, &amp;uiHi);
00490         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)uiHi != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>) {
00491             RIPMSG0(RIP_ERROR, <span class="stringliteral">"DDE Protocol violation: Data ACK had wrong item"</span>);
00492             <span class="keywordflow">return</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a21">SpontaneousServerMessage</a>((<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>, msg, lParam));
00493         }
00494 
00495         GlobalDeleteAtom((ATOM)uiHi); <span class="comment">// message copy</span>
00496         <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a9">FreeDDElParam</a>(WM_DDE_ACK, lParam);
00497 
00498         <span class="keywordflow">if</span> (!((uiLo &amp; DDE_FACK) &amp;&amp; pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>)) {
00499             <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a>, FALSE, TRUE);
00500         }
00501 
00502 <span class="preprocessor">        #if DBG</span>
00503 <span class="preprocessor"></span>        <span class="comment">/*</span>
00504 <span class="comment">         * Rememeber the number of links so we can assert if they change during the loop below</span>
00505 <span class="comment">         */</span>
00506         cLinks = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;
00507 <span class="preprocessor">        #endif</span>
00508 <span class="preprocessor"></span>        <span class="comment">/*</span>
00509 <span class="comment">         * locate link info and clear ADVST_WAITING bit</span>
00510 <span class="comment">         */</span>
00511         la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)uiHi);
00512         paLink = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>;
00513         <span class="keywordflow">for</span> (iLink = 0; iLink &lt; pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>; iLink++, paLink++) {
00514             <span class="keywordflow">if</span> (paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> == la &amp;&amp;
00515                     paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a47">ADVST_WAITING</a>) {
00516                 paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> &amp;= ~<a class="code" href="../../d0/d4/ddemlcli_8h.html#a47">ADVST_WAITING</a>;
00517                 <span class="comment">/*</span>
00518 <span class="comment">                 * We have to allocate pxiNew because it may become linked</span>
00519 <span class="comment">                 * into pcoi-&gt;pxiIn.</span>
00520 <span class="comment">                 */</span>
00521                 pxiNew = (<a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d0/structtagXACT__INFO.html">XACT_INFO</a>));
00522 
00523                 <span class="keywordflow">if</span> (pxiNew &amp;&amp; !<a class="code" href="../../d0/d1/xact_8c.html#a8">UpdateLinkIfChanged</a>(paLink, pxiNew, pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>,
00524                         &amp;pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>[pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a> - 1], &amp;fSwapped,
00525                         CADV_LATEACK)) {
00526                     <span class="comment">/*</span>
00527 <span class="comment">                     * Not used, free it.</span>
00528 <span class="comment">                     */</span>
00529                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxiNew);
00530                 }
00531                 <span class="keywordflow">break</span>;
00532             }
00533         }
00534 <span class="preprocessor">        #if DBG</span>
00535 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (cLinks != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
00536             RIPMSG1(RIP_ERROR, <span class="stringliteral">"SvRespAdviseDataAck: cLinks changed. pxi:%#p"</span>, pxi);
00537         }
00538 <span class="preprocessor">        #endif</span>
00539 <span class="preprocessor"></span>
00540         DeleteAtom(la);
00541     }
00542     GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// pxi copy</span>
00543     <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
00544     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
00545     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00546 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a142" doxytag="ddemlcli.h::SvSpontAdvise" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvSpontAdvise           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">112</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01591">ExtractDDEDataInfo()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a75">PSVR_CONV_INFO</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00131">WOWGLOBALFREE</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>.
<p>
<pre class="fragment"><div>00115 {
00116     UINT_PTR uiHi;
00117     HANDLE hDDE;
00118     WORD wFmt, wStatus;
00119     ULONG_PTR dwRet = 0;
00120     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00121     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
00122 
00123     <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_ADVISE, lParam, (PUINT_PTR)&amp;hDDE, &amp;uiHi);
00124     <span class="keywordflow">if</span> (psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_FAIL_ADVISES) {
00125         <span class="keywordflow">goto</span> Ack;
00126     }
00127 
00128     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/stdptcl_8c.html#a24">ExtractDDEDataInfo</a>(hDDE, &amp;wStatus, &amp;wFmt)) {
00129         <span class="keywordflow">goto</span> Ack;
00130     }
00131 
00132     <span class="keywordflow">if</span> (wStatus &amp; DDE_FDEFERUPD) {
00133         wStatus &amp;= ~DDE_FACKREQ;   <span class="comment">// warm links shouldn't have this flag set</span>
00134     }
00135 
00136     la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)uiHi);
00137     dwRet = (ULONG_PTR)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>,
00138         XTYP_ADVSTART,
00139         wFmt, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
00140         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
00141         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00142         (HDDEDATA)0, 0, 0);
00143     DeleteAtom(la);
00144 
00145     <span class="comment">// check CBR_BLOCK case</span>
00146 
00147     <span class="keywordflow">if</span> (dwRet == (ULONG_PTR)CBR_BLOCK) {
00148         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00149     }
00150 
00151     <span class="keywordflow">if</span> (dwRet) {
00152         <span class="comment">//</span>
00153         <span class="comment">// If we fail to add the link internally, dwRet == 0 -&gt; NACK</span>
00154         <span class="comment">//</span>
00155         dwRet = <a class="code" href="../../d2/d2/util_8c.html#a0">AddLink</a>((<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)psi, (GATOM)uiHi, wFmt,
00156                 (WORD)(wStatus &amp; (WORD)(DDE_FDEFERUPD | DDE_FACKREQ)));
00157         <span class="keywordflow">if</span> (dwRet) {
00158             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, TRUE, wStatus &amp; DDE_FDEFERUPD, psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>,
00159                     psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>, (GATOM)uiHi, wFmt, TRUE,
00160                     (HCONV)psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, (HCONV)psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
00161         }
00162     }
00163 
00164 Ack:
00165     <span class="keywordflow">if</span> (dwRet) {
00166         <a class="code" href="../../d6/d0/usercli_8h.html#a7">WOWGLOBALFREE</a>(hDDE); <span class="comment">// hOptions - NACK -&gt; HE frees it.</span>
00167     }
00168     <span class="comment">// IncGlobalAtomCount((GATOM)uiHi);         // message copy - reuse</span>
00169     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_ADVISE, WM_DDE_ACK,
00170             psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, lParam, dwRet ? DDE_FACK : 0, uiHi);
00171     <span class="keywordflow">if</span> (dwError) {
00172         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;ci.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00173         GlobalDeleteAtom((ATOM)uiHi); <span class="comment">// message copy</span>
00174     }
00175 
00176     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00177 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a153" doxytag="ddemlcli.h::SvSpontPoke" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvSpontPoke           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">1042</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01591">ExtractDDEDataInfo()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00491">FreeDDEData()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, and <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00595">UnpackDDElParam()</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>.
<p>
<pre class="fragment"><div>01045 {
01046     UINT_PTR uiHi;
01047     HANDLE hDDE = 0;
01048     HDDEDATA hData;
01049     ULONG_PTR dwRet = 0;
01050     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
01051     WORD wFmt, wStatus;
01052     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> al;
01053 
01054     <span class="comment">// See what we have</span>
01055 
01056     <a class="code" href="../../d4/d4/client_2ddetrack_8c.html#a8">UnpackDDElParam</a>(WM_DDE_DATA, lParam, (PUINT_PTR)&amp;hDDE, &amp;uiHi);
01057 
01058     <span class="keywordflow">if</span> (!(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_FAIL_POKES)) {
01059         <span class="keywordflow">if</span> (!hDDE) {
01060             <span class="keywordflow">goto</span> Ack;
01061         }
01062         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/stdptcl_8c.html#a24">ExtractDDEDataInfo</a>(hDDE, &amp;wStatus, &amp;wFmt)) {
01063             <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(hDDE, FALSE, TRUE);             <span class="comment">// free message data</span>
01064             <span class="keywordflow">goto</span> Ack;
01065         }
01066 
01067         hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, (LPBYTE)hDDE, (DWORD)-1, 0,
01068                 HDATA_NOAPPFREE | HDATA_READONLY, 0, 0);
01069         <span class="keywordflow">if</span> (!hData) {
01070             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
01071             <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(hDDE, FALSE, TRUE);       <span class="comment">// free message data</span>
01072             <span class="keywordflow">goto</span> Ack;                             <span class="comment">// Nack it.</span>
01073             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01074         }
01075 
01076         al = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)uiHi);
01077             dwRet = (ULONG_PTR)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, XTYP_POKE,
01078                     wFmt, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
01079                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
01080                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(al),
01081                     hData, 0, 0);
01082         DeleteAtom(al);
01083         <a class="code" href="../../d2/d6/stdptcl_8c.html#a26">UnpackAndFreeDDEMLDataHandle</a>(hData, FALSE);
01084     }
01085     <span class="keywordflow">if</span> (dwRet == (ULONG_PTR)CBR_BLOCK) {
01086 
01087         <span class="comment">// Note: this code makes an app that return s CBR_BLOCK unable to</span>
01088         <span class="comment">// access the data after the callback return .</span>
01089 
01090         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01091     }
01092     <span class="keywordflow">if</span> (dwRet &amp; DDE_FACK) {
01093         <a class="code" href="../../d0/d9/hdata_8c.html#a10">FreeDDEData</a>(hDDE, FALSE, TRUE);
01094     }
01095 
01096 Ack:
01097     dwRet &amp;= ~DDE_FACKRESERVED;
01098     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_POKE, WM_DDE_ACK,
01099             psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, lParam, dwRet, uiHi);
01100     <span class="keywordflow">if</span> (dwError) {
01101         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01102     }
01103     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01104 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a156" doxytag="ddemlcli.h::SvSpontRequest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvSpontRequest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">1207</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01479">AllocAndSetDDEData()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00660">CopyDDEData()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01591">ExtractDDEDataInfo()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>.
<p>
<pre class="fragment"><div>01210 {
01211     HANDLE hDDE = 0;
01212     HDDEDATA hDataRet;
01213     WORD wFmt, wStatus;
01214     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
01215     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
01216 
01217     <span class="keywordflow">if</span> (psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_FAIL_REQUESTS) {
01218         <span class="keywordflow">goto</span> Nack;
01219     }
01220     <span class="comment">// See what we have</span>
01221 
01222     <span class="comment">// UnpackDDElParam(lParam, WM_DDE_REQUEST, .... Requests arn't packed</span>
01223     wFmt = LOWORD(lParam);
01224     la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)HIWORD(lParam));
01225     hDataRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, XTYP_REQUEST,
01226             wFmt, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
01227             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
01228             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
01229             (HDDEDATA)0, 0, 0);
01230     DeleteAtom(la);
01231 
01232     <span class="keywordflow">if</span> (hDataRet == CBR_BLOCK) {
01233         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01234     }
01235 
01236     <span class="keywordflow">if</span> (hDataRet) {
01237 
01238         hDDE = <a class="code" href="../../d2/d6/stdptcl_8c.html#a26">UnpackAndFreeDDEMLDataHandle</a>(hDataRet, FALSE);
01239         <span class="keywordflow">if</span> (!hDDE) {
01240             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_DLL_USAGE);
01241             <span class="keywordflow">goto</span> Nack;
01242         }
01243         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/stdptcl_8c.html#a24">ExtractDDEDataInfo</a>(hDDE, &amp;wStatus, &amp;wFmt)) {
01244             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_DLL_USAGE);
01245             <span class="keywordflow">goto</span> Nack;
01246         }
01247         <span class="keywordflow">if</span> (!(wStatus &amp; DDE_FRELEASE)) {
01248             <span class="comment">// Its APPOWNED or relayed from another server - only safe</span>
01249             <span class="comment">// thing to do is use a copy.</span>
01250             hDDE = <a class="code" href="../../d0/d9/hdata_8c.html#a13">CopyDDEData</a>(hDDE, FALSE);
01251             <span class="keywordflow">if</span> (!hDDE) {
01252                 <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
01253                 <span class="keywordflow">goto</span> Nack;
01254             }
01255         }
01256 
01257         <span class="comment">// Keep it simple, DDEML servers never ask for acks from requests.</span>
01258 
01259         wStatus = DDE_FRELEASE | DDE_FREQUESTED;
01260         <a class="code" href="../../d2/d6/stdptcl_8c.html#a22">AllocAndSetDDEData</a>((LPBYTE)hDDE, (DWORD)-1, wStatus, wFmt);
01261 
01262         <span class="comment">// just reuse HIWORD(lParam) (aItem) - message copy</span>
01263         <span class="keywordflow">if</span> (dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_REQUEST,
01264                 WM_DDE_DATA, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, HandleToUlong(hDDE), HIWORD(lParam))) {
01265             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01266             GlobalDeleteAtom(HIWORD(lParam)); <span class="comment">// message copy</span>
01267         }
01268 
01269     } <span class="keywordflow">else</span> {
01270 Nack:
01271         <span class="comment">// just reuse HIWORD(lParam) (aItem) - message copy</span>
01272         dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_REQUEST,
01273                 WM_DDE_ACK, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, 0, HIWORD(lParam));
01274         <span class="keywordflow">if</span> (dwError) {
01275             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
01276             GlobalDeleteAtom(HIWORD(lParam)); <span class="comment">// message copy</span>
01277         }
01278     }
01279 
01280     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01281 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a148" doxytag="ddemlcli.h::SvSpontUnadvise" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvSpontUnadvise           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/structtagSVR__CONV__INFO.html">PSVR_CONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">640</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d0/d4/ddemlcli_8h.html#a61">ADVISE_LINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00237">tagSVR_CONV_INFO::ci</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00599">CloseTransaction()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00123">DeleteLinkCount()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00146">tagADVISE_LINK::pLinkCount</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01424">SpontaneousServerMessage()</a>.
<p>
<pre class="fragment"><div>00643 {
00644     ULONG_PTR dwRet = 0;
00645     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00646     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a> iLink;
00647     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> aLink;
00648     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la;
00649 
00650     la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)HIWORD(lParam));
00651 
00652     <a class="code" href="../../d2/d6/stdptcl_8c.html#a7">CloseTransaction</a>(&amp;psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>, HIWORD(lParam));
00653 
00654     <span class="keywordflow">for</span> (aLink = psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>, iLink = 0; iLink &lt; psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;) {
00655 
00656         <span class="keywordflow">if</span> (la == 0 || aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a> == la &amp;&amp;
00657                 (LOWORD(lParam) == 0 || LOWORD(lParam) == aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>)) {
00658 
00659             <span class="keywordflow">if</span> (!(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_FAIL_ADVISES)) {
00660                 <span class="comment">/*</span>
00661 <span class="comment">                 * Only do the callbacks if he wants them.</span>
00662 <span class="comment">                 */</span>
00663                 dwRet = (ULONG_PTR)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>,
00664                     (WORD)XTYP_ADVSTOP, aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
00665                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
00666                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00667                     (HDDEDATA)0, 0L, 0L);
00668                 <span class="keywordflow">if</span> (dwRet == (ULONG_PTR)CBR_BLOCK) {
00669                     DeleteAtom(la);
00670                     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00671                 }
00672             }
00673             <span class="comment">/*</span>
00674 <span class="comment">             * Notify any DDESPY apps.</span>
00675 <span class="comment">             */</span>
00676             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, TRUE, 0, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>,
00677                     psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>, HIWORD(lParam), aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, TRUE,
00678                     (HCONV)psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, (HCONV)psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
00679             <span class="comment">/*</span>
00680 <span class="comment">             * Remove link info</span>
00681 <span class="comment">             */</span>
00682             DeleteAtom(aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>);  <span class="comment">// aLink copy</span>
00683             <a class="code" href="../../d2/d2/util_8c.html#a1">DeleteLinkCount</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, aLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>);
00684             <span class="keywordflow">if</span> (--psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
00685                 memmove((LPSTR)aLink, (LPSTR)(aLink + 1),
00686                         <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a>) * (psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a> - iLink));
00687             }
00688         } <span class="keywordflow">else</span> {
00689             aLink++;
00690             iLink++;
00691         }
00692     }
00693 
00694     DeleteAtom(la);
00695 
00696     <span class="comment">/*</span>
00697 <span class="comment">     * Now ACK the unadvise message.</span>
00698 <span class="comment">     */</span>
00699     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0,
00700             WM_DDE_ACK, psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, DDE_FACK, HIWORD(lParam));
00701     <span class="keywordflow">if</span> (dwError) {
00702         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(psi-&gt;<a class="code" href="../../d5/d7/structtagSVR__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00703         GlobalDeleteAtom((ATOM)HIWORD(lParam));      <span class="comment">// message copy</span>
00704         <span class="comment">// FreeDDElParam(WM_DDE_UNADVISE, lParam);   // no unpack needed</span>
00705     }
00706 
00707     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00708 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a144" doxytag="ddemlcli.h::SvStartAdviseUpdate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SvStartAdviseUpdate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cLinksToGo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">263</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00118">FNRESPONSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00132">tagXACT_INFO::hDDESent</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00846">LinkTransaction()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d6/d4/ddetrack_8h.html#a24">PDDE_DATA</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00131">tagXACT_INFO::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00128">USERGLOBALLOCK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00123">USERGLOBALUNLOCK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00019">tagDDE_DATA::wFmt</a>, <a class="el" href="../../d7/d3/ddetrack_8h-source.html#l00018">tagDDE_DATA::wStatus</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00128">tagXACT_INFO::wType</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.
<p>
<pre class="fragment"><div>00266 {
00267     HDDEDATA hData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00268     <a class="code" href="../../d4/d2/structtagDDE__DATA.html">PDDE_DATA</a> pdde;
00269     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwError;
00270     HANDLE hDDE;
00271     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> al;
00272 
00273     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00274 
00275     <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &amp; DDE_FDEFERUPD) {
00276         hDDE = 0;
00277     } <span class="keywordflow">else</span> {
00278         al = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
00279         hData = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>,
00280                            XTYP_ADVREQ,
00281                            pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>,
00282                            pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
00283                            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
00284                            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(al),
00285                            (HDDEDATA)0,
00286                            MAKELONG(cLinksToGo, 0),
00287                            0);
00288         DeleteAtom(al);
00289         <span class="keywordflow">if</span> (!hData) {
00290             <span class="comment">// app doesn't honor the advise.</span>
00291             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>); <span class="comment">// reuse pxi</span>
00292         }
00293         hDDE = <a class="code" href="../../d2/d6/stdptcl_8c.html#a26">UnpackAndFreeDDEMLDataHandle</a>(hData, FALSE);
00294         <span class="keywordflow">if</span> (!hDDE) {
00295 
00296             <span class="comment">/*</span>
00297 <span class="comment">             * failed - must be execute type data</span>
00298 <span class="comment">             */</span>
00299             <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>(hData, FALSE);
00300             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_DLL_USAGE);
00301             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00302         }
00303         <span class="comment">/*</span>
00304 <span class="comment">         * Set fAckReq bit apropriately - note APPOWNED handles will already</span>
00305 <span class="comment">         * have the fAckReq bit set so this will not change their state.</span>
00306 <span class="comment">         */</span>
00307         <a class="code" href="../../d6/d0/usercli_8h.html#a4">USERGLOBALLOCK</a>(hDDE, pdde);
00308         <span class="keywordflow">if</span> (pdde == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00309             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00310         }
00311         <span class="keywordflow">if</span> (pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o1">wFmt</a> != pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>) {
00312 
00313             <span class="comment">/*</span>
00314 <span class="comment">             * bogus data - wrong format!</span>
00315 <span class="comment">             */</span>
00316             <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00317             <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>(hData, FALSE);
00318             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_DLL_USAGE);
00319             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00320         }
00321         <span class="keywordflow">if</span> (!(pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a> &amp; DDE_FRELEASE)) {
00322             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> |= DDE_FACKREQ; <span class="comment">// dare not allow neither flag set!</span>
00323         }
00324         pdde-&gt;<a class="code" href="../../d4/d2/structtagDDE__DATA.html#o0">wStatus</a> |= (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &amp; DDE_FACKREQ);
00325         <a class="code" href="../../d6/d0/usercli_8h.html#a1">USERGLOBALUNLOCK</a>(hDDE);
00326     }
00327 
00328     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00329     dwError = <a class="code" href="../../d2/d6/stdptcl_8c.html#a23">PackAndPostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, 0, WM_DDE_DATA,
00330             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0, HandleToUlong(hDDE), pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
00331     <span class="keywordflow">if</span> (dwError) {
00332         <span class="keywordflow">if</span> (hData) {
00333             <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>(hData, FALSE);
00334         }
00335         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, dwError);
00336         GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>); <span class="comment">// message copy</span>
00337         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00338     }
00339 
00340     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o10">state</a> = XST_ADVDATASENT;
00341     <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &amp; DDE_FACKREQ) {
00342         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o11">hDDESent</a> = hDDE;
00343         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a58">FNRESPONSE</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a146">SvRespAdviseDataAck</a>;
00344         <a class="code" href="../../d0/d1/xact_8c.html#a10">LinkTransaction</a>(pxi);
00345         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>); <span class="comment">// prevents reuse - since its queued.</span>
00346     } <span class="keywordflow">else</span> {
00347         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>); <span class="comment">// causes pxi to be reused for next advdata message.</span>
00348     }
00349 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a163" doxytag="ddemlcli.h::TransactionComplete" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TransactionComplete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDDEDATA&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">1624</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00130">tagXACT_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00133">tagXACT_INFO::hDDEResult</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00124">tagXACT_INFO::hXact</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00094">InternalCreateDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00140">TID_TIMEOUT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">UnlinkTransaction()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00129">tagXACT_INFO::wStatus</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00138">XIF_ABANDONED</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00137">XIF_COMPLETE</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00136">XIF_SYNCHRONOUS</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>.
<p>
<pre class="fragment"><div>01627 {
01628     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> al;
01629     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fMustFree;
01630 
01631     <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a45">XIF_ABANDONED</a>) {
01632         UserAssert(!(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> &amp; XIF_SYNCHRONOUS));
01633         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01634     }
01635     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> |= <a class="code" href="../../d0/d4/ddemlcli_8h.html#a44">XIF_COMPLETE</a>;
01636     <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a43">XIF_SYNCHRONOUS</a>) {
01637         <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, WM_TIMER, TID_TIMEOUT, 0);
01638         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01639     } <span class="keywordflow">else</span> {
01640         <span class="keywordflow">if</span> (hData == (HDDEDATA)(-1)) {
01641             fMustFree = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01642             hData = <a class="code" href="../../d0/d9/hdata_8c.html#a2">InternalCreateDataHandle</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>,
01643                 (LPBYTE)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a>, (DWORD)-1, 0,
01644                 HDATA_NOAPPFREE | HDATA_READONLY, 0, 0);
01645         } <span class="keywordflow">else</span> {
01646             fMustFree = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01647         }
01648         al = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
01649 
01650         <span class="keywordflow">if</span> (!(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FACK)) {
01651             <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a> &amp; DDE_FBUSY) {
01652                 <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_BUSY);
01653             } <span class="keywordflow">else</span> {
01654                 <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_NOTPROCESSED);
01655             }
01656         }
01657 
01658         <span class="comment">/*</span>
01659 <span class="comment">         * During the callback the app may disconnect or otherwise kill</span>
01660 <span class="comment">         * this conversation so we unlink the pxi FIRST so cleanup code</span>
01661 <span class="comment">         * doesn't destroy it before this transaction code exits.</span>
01662 <span class="comment">         */</span>
01663         <a class="code" href="../../d0/d1/xact_8c.html#a11">UnlinkTransaction</a>(pxi);
01664 
01665         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(
01666             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>,
01667             (WORD)XTYP_XACT_COMPLETE,
01668             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a>,
01669             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
01670             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>),
01671             (HSZ)al,
01672             hData,
01673             HandleToUlong(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>),
01674             (DWORD)pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o8">wStatus</a>);
01675         DeleteAtom(al);
01676         <span class="keywordflow">if</span> (fMustFree) {
01677             <a class="code" href="../../d0/d9/hdata_8c.html#a8">InternalFreeDataHandle</a>(hData, FALSE);
01678             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o12">hDDEResult</a> = 0;
01679         }
01680 
01681         <span class="comment">/*</span>
01682 <span class="comment">         * during the callback is the only time the app has to access the</span>
01683 <span class="comment">         * transaction information.   pxi-&gt;hXact will be invalid once he</span>
01684 <span class="comment">         * returns.</span>
01685 <span class="comment">         */</span>
01686         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>) {
01687             <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a>);
01688             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o3">hXact</a> = 0;
01689         }
01690         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01691     }
01692 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a120" doxytag="ddemlcli.h::UnlinkTransaction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UnlinkTransaction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pxi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00885">885</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00121">tagXACT_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00221">tagCONV_INFO::pxiIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00222">tagCONV_INFO::pxiOut</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00190">ClRespAdviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00958">ClRespExecuteAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01116">ClRespPokeAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00887 {
00888     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00889     <span class="keywordflow">if</span> (pxi == pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>) {
00890         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a>;
00891         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00892             pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o10">pxiIn</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00893         }
00894     }
00895 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a164" doxytag="ddemlcli.h::UnpackAndFreeDDEMLDataHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE UnpackAndFreeDDEMLDataHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDDEDATA&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fExec</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">1708</a> of file <a class="el" href="../../d3/d5/stdptcl_8c-source.html">stdptcl.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00257">tagDDEMLDATA::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00256">tagDDEMLDATA::hDDE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00108">HTYPE_DATA_HANDLE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a82">PDDEMLDATA</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.
<p>
<pre class="fragment"><div>01711 {
01712     <a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a> pdd;
01713     HANDLE hDDE;
01714 
01715     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01716 
01717     <span class="keywordflow">if</span> (hData == 0) {
01718         <span class="keywordflow">return</span> (0);
01719     }
01720     pdd = (<a class="code" href="../../d8/d2/structtagDDEMLDATA.html">PDDEMLDATA</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hData, HTYPE_DATA_HANDLE,
01721             HINST_ANY);
01722     <span class="keywordflow">if</span> (pdd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01723         <span class="keywordflow">return</span> (0);
01724     }
01725     <span class="keywordflow">if</span> (!fExec &amp;&amp; pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o1">flags</a> &amp; HDATA_EXECUTE) {
01726         <span class="keywordflow">return</span> (0);
01727     }
01728 
01729     hDDE = pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o0">hDDE</a>;
01730     <span class="keywordflow">if</span> (pdd-&gt;<a class="code" href="../../d8/d2/structtagDDEMLDATA.html#o1">flags</a> &amp; HDATA_APPOWNED) {
01731         <span class="keywordflow">return</span> (hDDE); <span class="comment">// don't destroy appowned data handles</span>
01732     }
01733     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdd);
01734     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)hData);
01735     <span class="keywordflow">return</span> (hDDE);
01736 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a118" doxytag="ddemlcli.h::UpdateLinkIfChanged" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL UpdateLinkIfChanged           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>paLink</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pxi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>paLinkLast</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PBOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>pfSwapped</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cLinksToGo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">611</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00154">ADVST_CHANGED</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00153">ADVST_WAITING</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00150">tagADVISE_LINK::state</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00128">tagXACT_INFO::wType</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>.
<p>
<pre class="fragment"><div>00618 {
00619     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">ADVISE_LINK</a> aLinkT;
00620 
00621     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00622 
00623     *pfSwapped = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00624     <span class="keywordflow">if</span> (paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a48">ADVST_CHANGED</a> &amp;&amp; !(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a47">ADVST_WAITING</a>)) {
00625         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a> = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a146">SvRespAdviseDataAck</a>;
00626         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a> = pcoi;
00627         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a> = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>);    <span class="comment">// pxi copy</span>
00628         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a> = paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>;
00629         pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> = paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a>;
00630         paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> &amp;= ~<a class="code" href="../../d0/d4/ddemlcli_8h.html#a48">ADVST_CHANGED</a>;
00631         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a3">SvStartAdviseUpdate</a>(pxi, cLinksToGo)) {
00632             <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> &amp; DDE_FACKREQ) {
00633                 paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o4">state</a> |= <a class="code" href="../../d0/d4/ddemlcli_8h.html#a47">ADVST_WAITING</a>;
00634                 <span class="comment">/*</span>
00635 <span class="comment">                 * swap paLink with the last non-moved link to make ack search find</span>
00636 <span class="comment">                 * oldest updated format.</span>
00637 <span class="comment">                 */</span>
00638                 <span class="keywordflow">if</span> (paLink != paLinkLast) {
00639                     aLinkT = *paLink;
00640                     RtlMoveMemory(paLink, paLink + 1,
00641                             (PBYTE)paLinkLast - (PBYTE)paLink);
00642                     *paLinkLast = aLinkT;
00643                     *pfSwapped = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00644                 }
00645             }
00646             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00647         } <span class="keywordflow">else</span> {
00648             GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);  <span class="comment">// pxi copy</span>
00649             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00650         }
00651     }
00652     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00653 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="ddemlcli.h::ValidateCHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR ValidateCHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ExpectedType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ExpectedInstance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">204</a> of file <a class="el" href="../../d4/d7/handles_8c-source.html">handles.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00028">aHandleEntry</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00032">cHandlesAllocated</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00060">CheckHandleTable</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00077">tagCHANDLEENTRY::dwData</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00076">tagCHANDLEENTRY::handle</a>, <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00041">IndexFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/hdata_8c-source.html#l00304">DdeAccessData()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00378">DdeFreeDataHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00438">DdeImpersonateClient()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00346">DdeUnaccessData()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00416">InternalFreeDataHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01708">UnpackAndFreeDDEMLDataHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">WaitForZombieTerminate()</a>.
<p>
<pre class="fragment"><div>00208 {
00209     <span class="keyword">register</span> <span class="keywordtype">int</span> i;
00210     <span class="keyword">register</span> ULONG_PTR dwRet;
00211 
00212     <a class="code" href="../../d3/d8/handles_8c.html#a1">CheckHandleTable</a>();
00213     dwRet = 0;
00214     i = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a1">IndexFromHandle</a>(h);
00215     <span class="keywordflow">if</span> (i &lt; <a class="code" href="../../d3/d8/handles_8c.html#a3">cHandlesAllocated</a> &amp;&amp;
00216           <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o0">handle</a> == h &amp;&amp;
00217           (ExpectedType == -1 || ExpectedType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(h)) &amp;&amp;
00218           (ExpectedInstance == -1 || ExpectedInstance == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(h))) {
00219        dwRet = <a class="code" href="../../d3/d8/handles_8c.html#a2">aHandleEntry</a>[i].<a class="code" href="../../d8/d9/structtagCHANDLEENTRY.html#o1">dwData</a>;
00220     }
00221 
00222     <span class="keywordflow">return</span> (dwRet);
00223 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a110" doxytag="ddemlcli.h::ValidateConnectParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateConnectParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ *&nbsp;</td>
          <td class="mdname" nowrap> <em>phszService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>plaNormalSvcName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppCC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND *&nbsp;</td>
          <td class="mdname" nowrap> <em>phwndTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">491</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00107">DefConvContext</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00067">HSZT_INST_SPECIFIC</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00398">ParseInstSpecificAtom()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00106">TempConvContext</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>.
<p>
<pre class="fragment"><div>00500 {
00501     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> hszType;
00502     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fError = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00503 
00504     *ppcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>(hInst);
00505     <span class="keywordflow">if</span> (*ppcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00506         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00507     }
00508     hszType = <a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(*phszService);
00509     <span class="keywordflow">if</span> (hszType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a> || <a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hszTopic) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00510         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00511         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00512     }
00513     <span class="keywordflow">if</span> (hszType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a12">HSZT_INST_SPECIFIC</a>) {
00514         *phwndTarget = <a class="code" href="../../d4/d2/hsz_8c.html#a11">ParseInstSpecificAtom</a>(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(*phszService),
00515             plaNormalSvcName);
00516         <span class="keywordflow">if</span> (*plaNormalSvcName == 0) {
00517             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_SYS_ERROR);
00518             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00519         }
00520         *phszService = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(*plaNormalSvcName);
00521     }
00522     <span class="keywordflow">if</span> (*ppCC == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00523         *ppCC = &amp;<a class="code" href="../../d6/d5/connect_8c.html#a4">DefConvContext</a>;
00524         <span class="keywordflow">if</span> ((*ppcii)-&gt;flags &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>) {
00525             (*ppCC)-&gt;iCodePage = CP_WINUNICODE;
00526         } <span class="keywordflow">else</span> {
00527             (*ppCC)-&gt;iCodePage = CP_WINANSI;
00528         }
00529     } <span class="keywordflow">else</span> <span class="keywordflow">try</span> {
00530         <span class="keywordflow">if</span> ((*ppCC)-&gt;cb &gt; <span class="keyword">sizeof</span>(CONVCONTEXT)) {
00531             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00532             fError = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00533         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ppCC)-&gt;cb &lt; <span class="keyword">sizeof</span>(CONVCONTEXT)) {
00534             <a class="code" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a> = <a class="code" href="../../d6/d5/connect_8c.html#a4">DefConvContext</a>;
00535             <span class="comment">/*</span>
00536 <span class="comment">             * we can use this static temp because we are synchronized.</span>
00537 <span class="comment">             */</span>
00538             RtlCopyMemory(&amp;TempConvContext, *ppCC, (*ppCC)-&gt;cb);
00539             *ppCC = &amp;<a class="code" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a>;
00540         }
00541     } except(W32ExceptionHandler(FALSE, RIP_WARNING)) {
00542         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00543         fError = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00544     }
00545     <span class="keywordflow">if</span> (fError) {
00546         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00547     }
00548     <span class="keywordflow">if</span> (hConvList != 0 &amp;&amp;
00549             !<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvList, HTYPE_CONVERSATION_LIST,
00550             (DWORD)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>((*ppcii)-&gt;hInstClient))) {
00551         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00552     }
00553     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00554 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="ddemlcli.h::ValidateHSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ValidateHSZ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSZ&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">340</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00067">HSZT_INST_SPECIFIC</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00066">HSZT_NORMAL</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.
<p>
<pre class="fragment"><div>00342 {
00343     <span class="keywordflow">if</span> (hsz == 0) {
00344         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a11">HSZT_NORMAL</a>);
00345     }
00346     <span class="keywordflow">if</span> (LOWORD((ULONG_PTR)hsz) &lt; 0xC000) {
00347         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>);
00348     }
00349     <span class="keywordflow">if</span> (HIWORD((ULONG_PTR)hsz) == 0) {
00350         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a11">HSZT_NORMAL</a>);
00351     }
00352     <span class="keywordflow">if</span> (HIWORD((ULONG_PTR)hsz) == 1) {
00353         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a12">HSZT_INST_SPECIFIC</a>);
00354     }
00355     <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>);
00356 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="ddemlcli.h::ValidateInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> ValidateInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">111</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00405">DdeGetLastError()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.
<p>
<pre class="fragment"><div>00113 {
00114     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00115 
00116     pcii = (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>(hInstClient, HTYPE_INSTANCE, HINST_ANY);
00117 
00118     <span class="keywordflow">if</span> (pcii != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00119         <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> != GetCurrentThreadId() ||
00120                 pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a> != hInstClient) {
00121             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00122         }
00123     }
00124     <span class="keywordflow">return</span> (pcii);
00125 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a121" doxytag="ddemlcli.h::ValidateTransaction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateTransaction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConv</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hXact</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppxi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">909</a> of file <a class="el" href="../../d1/d0/xact_8c-source.html">xact.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">HTYPE_CLIENT_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00104">HTYPE_SERVER_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00107">HTYPE_TRANSACTION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00489">DdeSetUserHandle()</a>.
<p>
<pre class="fragment"><div>00914 {
00915     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00916 
00917     *ppcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConv,
00918             HTYPE_CLIENT_CONVERSATION, HINST_ANY);
00919     <span class="keywordflow">if</span> (*ppcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00920         *ppcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConv,
00921                 HTYPE_SERVER_CONVERSATION, HINST_ANY);
00922     }
00923     <span class="keywordflow">if</span> (*ppcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00924         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00925         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00926     }
00927     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((*ppcoi)-&gt;pcii-&gt;hInstClient);
00928     <span class="keywordflow">if</span> (pcii != (*ppcoi)-&gt;pcii) {
00929         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00930         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00931     }
00932 
00933     <span class="keywordflow">if</span> (hXact == (HANDLE)IntToPtr( QID_SYNC )) {
00934         *ppxi = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00935     } <span class="keywordflow">else</span> {
00936         *ppxi = (<a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>(hXact, HTYPE_TRANSACTION,
00937                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>((*ppcoi)-&gt;pcii-&gt;hInstClient));
00938         <span class="keywordflow">if</span> (*ppxi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00939             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>((*ppcoi)-&gt;pcii, DMLERR_INVALIDPARAMETER);
00940             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00941         }
00942     }
00943     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00944 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a115" doxytag="ddemlcli.h::WaitForZombieTerminate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WaitForZombieTerminate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">1474</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00874">DispatchMessage()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01486">MsgWaitForMultipleObjectsEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00483">PeekMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>01476 {
01477     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
01478     MSG <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
01479     HWND hwnd;
01480     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fTerminated;
01481     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fRet = 0;
01482 
01483     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
01484     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01485 
01486     fTerminated = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01487     <span class="keywordflow">while</span> ((pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>(hData,
01488             HTYPE_ZOMBIE_CONVERSATION, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hData))) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
01489             !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_TERMINATE_RECEIVED)) {
01490         hwnd = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
01491         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01492         <span class="keywordflow">while</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a14">PeekMessage</a>(&amp;msg, hwnd, WM_DDE_FIRST, WM_DDE_LAST, PM_REMOVE)) {
01493             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;msg);
01494             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_DDE_TERMINATE) {
01495                 fTerminated = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01496             }
01497         }
01498         <span class="keywordflow">if</span> (!fTerminated) {
01499             fRet = <a class="code" href="../../d3/d8/client_8c.html#a58">MsgWaitForMultipleObjectsEx</a>(0, NULL, 100, QS_POSTMESSAGE, 0);
01500             <span class="keywordflow">if</span> (fRet == 0xFFFFFFFF) {
01501                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"WaitForZombieTerminate: I give up - faking terminate."</span>);
01502                 <a class="code" href="../../d3/d4/ddemlwp_8c.html#a4">ProcessTerminateMsg</a>(pcoi, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
01503                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01504                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01505             }
01506         }
01507         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01508     }
01509     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01510     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01511 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a83" doxytag="ddemlcli.h::aInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PHANDLE <a class="el" href="../../d0/d4/instance_8c.html#a2">aInstance</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00262">262</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">DestroyInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="ddemlcli.h::DefConvContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONVCONTEXT <a class="el" href="../../d0/d4/ddemlcli_8h.html#a78">DefConvContext</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00245">245</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ddemlcli.h::gcsDDEML" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RTL_CRITICAL_SECTION <a class="el" href="../../d0/d4/ddemlcli_8h.html#a53">gcsDDEML</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00044">44</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l00059">UserClientDllInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="ddemlcli.h::gWM_REGISTERCALLBACK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a84">gWM_REGISTERCALLBACK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00263">263</a> of file <a class="el" href="../../d1/d3/ddemlcli_8h-source.html">ddemlcli.h</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:24 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
