<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: localrtl.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>localrtl.c</h1><a href="../../d9/d4/localrtl_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1993  Digital Equipment Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    localrtl.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains alternate implementations of each of the Rtl Memory</span>
00012 <span class="comment">    functions and other common functions required by the Rtl Memory test</span>
00013 <span class="comment">    programs.</span>
00014 <span class="comment"></span>
00015 <span class="comment">Author:</span>
00016 <span class="comment"></span>
00017 <span class="comment">    Thomas Van Baak (tvb) 11-Jan-1993</span>
00018 <span class="comment"></span>
00019 <span class="comment">Revision History:</span>
00020 <span class="comment"></span>
00021 <span class="comment">--*/</span>
00022 
00023 <span class="preprocessor">#include &lt;nt.h&gt;</span>
00024 <span class="preprocessor">#include "<a class="code" href="../../d0/d5/localrtl_8h.html">localrtl.h</a>"</span>
00025 
00026 <span class="comment">//</span>
00027 <span class="comment">// Simple pattern generator.</span>
00028 <span class="comment">//</span>
00029 
<a name="l00030"></a><a class="code" href="../../d9/d4/localrtl_8c.html#a0">00030</a> <span class="preprocessor">#define PATTERN "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>
<a name="l00031"></a><a class="code" href="../../d9/d4/localrtl_8c.html#a1">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define PATTERN_SIZE (sizeof(PATTERN) - 1)</span>
<a name="l00032"></a><a class="code" href="../../d9/d4/localrtl_8c.html#a2">00032</a> <span class="preprocessor"></span>UCHAR <a class="code" href="../../d9/d4/localrtl_8c.html#a2">Pattern</a>[] = <a class="code" href="../../d9/d4/localrtl_8c.html#a0">PATTERN</a>;
00033 
00034 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00035"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a9">00035</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a9">FillPattern</a>(PUCHAR To, ULONG Length)
00036 {
00037     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00038     ULONG Rotor = 0;
00039 
00040     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00041         To[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <a class="code" href="../../d9/d4/localrtl_8c.html#a2">Pattern</a>[Rotor];
00042         Rotor += 1;
00043         <span class="keywordflow">if</span> (Rotor == <a class="code" href="../../d9/d4/localrtl_8c.html#a1">PATTERN_SIZE</a>) {
00044             Rotor = 0;
00045         }
00046     }
00047 }
00048 
00049 <span class="comment">//</span>
00050 <span class="comment">// The following functions are simple, non-optimized, (and thus maybe even</span>
00051 <span class="comment">// bug-proof) implementations of each of the Rtl Memory functions.</span>
00052 <span class="comment">//</span>
00053 
00054 ULONG
<a name="l00055"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a3">00055</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a3">LocalCompareMemory</a> (
00056     PVOID Source1,
00057     PVOID Source2,
00058     ULONG Length
00059     )
00060 {
00061     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00062     PUCHAR Left = <a class="code" href="../../d8/d2/tmerge_8c.html#a52">Source1</a>;
00063     ULONG Match;
00064     PUCHAR Right = <a class="code" href="../../d8/d2/tmerge_8c.html#a55">Source2</a>;
00065 
00066     Match = 0;
00067     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00068         <span class="keywordflow">if</span> (Left[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] != Right[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>]) {
00069             <span class="keywordflow">break</span>;
00070         }
00071         Match += 1;
00072     }
00073     <span class="keywordflow">return</span> Match;
00074 }
00075 
00076 ULONG
<a name="l00077"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a4">00077</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a4">LocalCompareMemoryUlong</a> (
00078     PVOID Source,
00079     ULONG Length,
00080     ULONG Pattern
00081     )
00082 {
00083     PULONG From = Source;
00084     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00085     ULONG Match;
00086 
00087     Match = 0;
00088     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length / <span class="keyword">sizeof</span>(ULONG); <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00089         <span class="keywordflow">if</span> (From[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] != <a class="code" href="../../d9/d4/localrtl_8c.html#a2">Pattern</a>) {
00090             <span class="keywordflow">break</span>;
00091         }
00092         Match += <span class="keyword">sizeof</span>(ULONG);
00093     }
00094     <span class="keywordflow">return</span> Match;
00095 }
00096 
00097 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00098"></a><a class="code" href="../../d9/d4/localrtl_8c.html#a6">00098</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a5">LocalMoveMemory</a> (
00099    PVOID Destination,
00100    PVOID Source,
00101    ULONG Length
00102    )
00103 {
00104     PUCHAR From = Source;
00105     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00106     PUCHAR To = Destination;
00107 
00108     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00109         <span class="keywordflow">if</span> (To &lt;= From) {
00110             To[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = From[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00111 
00112         } <span class="keywordflow">else</span> {
00113             To[Length - 1 - <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = From[Length - 1 - <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00114         }
00115     }
00116 }
00117 
00118 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00119"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a6">00119</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a6">LocalFillMemory</a> (
00120    PVOID Destination,
00121    ULONG Length,
00122    UCHAR Fill
00123    )
00124 {
00125     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00126     PUCHAR To = Destination;
00127 
00128     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00129         To[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = Fill;
00130     }
00131 }
00132 
00133 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00134"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a7">00134</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a7">LocalFillMemoryUlong</a> (
00135    PVOID Destination,
00136    ULONG Length,
00137    ULONG Pattern
00138    )
00139 {
00140     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00141     PULONG To = Destination;
00142 
00143     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length / <span class="keyword">sizeof</span>(ULONG); <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00144         To[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <a class="code" href="../../d9/d4/localrtl_8c.html#a2">Pattern</a>;
00145     }
00146 }
00147 
00148 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00149"></a><a class="code" href="../../d0/d5/localrtl_8h.html#a8">00149</a> <a class="code" href="../../d0/d5/localrtl_8h.html#a8">LocalZeroMemory</a> (
00150    PVOID Destination,
00151    ULONG Length
00152    )
00153 {
00154     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00155     PUCHAR To = Destination;
00156 
00157     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00158         To[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = 0;
00159     }
00160 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:39 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
