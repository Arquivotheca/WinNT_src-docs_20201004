<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: instance.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>instance.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d1/d3/instance_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a0">INST_GROW_COUNT</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a1">perrs</a>&nbsp;&nbsp;&nbsp;((MONERRSTRUCT *)&amp;pep-&gt;Data)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a5">AddInstance</a> (HANDLE hInstServer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a6">DestroyInstance</a> (HANDLE hInstClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a> (HANDLE hInstClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> error)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PHANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a2">aInstance</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = 0</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="instance.c::INST_GROW_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INST_GROW_COUNT&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00017">17</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="instance.c::perrs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define perrs&nbsp;&nbsp;&nbsp;((MONERRSTRUCT *)&amp;pep-&gt;Data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="instance.c::AddInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE AddInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInstServer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">40</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00262">aInstance</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00022">cInstAllocated</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">DDEMLReAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00023">iFirstFreeInst</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00017">INST_GROW_COUNT</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00090">MAX_INST</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>.
<p>
<pre class="fragment"><div>00042 {
00043     <span class="keywordtype">int</span> i, iNextFree;
00044     PHANDLE ph;
00045 
00046     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> &gt;= <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a>) {
00047         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> == 0) {
00048            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> = (PHANDLE)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(HANDLE) * INST_GROW_COUNT);
00049         } <span class="keywordflow">else</span> {
00050            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> = (PHANDLE)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>((PVOID)aInstance,
00051                  <span class="keyword">sizeof</span>(HANDLE) * (cInstAllocated + INST_GROW_COUNT));
00052         }
00053         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a> == 0) {
00054             <span class="keywordflow">return</span> (0);
00055         }
00056         ph = &amp;<a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a>];
00057         i = <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> + 1;
00058         <span class="keywordflow">while</span> (i &lt;= <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> + <a class="code" href="../../d0/d4/instance_8c.html#a0">INST_GROW_COUNT</a>) {
00059            *ph++ = (HANDLE)(UINT_PTR)(<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)i++;
00060         }
00061         <a class="code" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> += <a class="code" href="../../d0/d4/instance_8c.html#a0">INST_GROW_COUNT</a>;
00062     }
00063     iNextFree = HandleToUlong(aInstance[iFirstFreeInst]);
00064     <span class="keywordflow">if</span> (iNextFree &gt; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a24">MAX_INST</a>) {
00065         <span class="comment">/*</span>
00066 <span class="comment">         * Instance limit for this process exceeded!</span>
00067 <span class="comment">         */</span>
00068         <span class="keywordflow">return</span>(0);
00069     }
00070     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a>] = hInstServer;
00071     i = <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a>;
00072     <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = iNextFree;
00073     <span class="keywordflow">return</span> (<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>(0, HTYPE_INSTANCE, i));
00074 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="instance.c::DestroyInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE DestroyInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInstClient</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">87</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00262">aInstance</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00023">iFirstFreeInst</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>00089 {
00090     <span class="keyword">register</span> HANDLE hInstServerRet = 0;
00091 
00092     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>(hInstClient);
00093     hInstServerRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient)];
00094     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a83">aInstance</a>[<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient)] = (HANDLE)UIntToPtr( iFirstFreeInst );
00095     <a class="code" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hInstClient);
00096 
00097     <span class="keywordflow">return</span> (hInstServerRet);
00098 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="instance.c::SetLastDDEMLError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetLastDDEMLError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>error</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">137</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00092">GetCurrentProcessId</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00193">tagCL_INSTANCE_INFO::LastError</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d0/d4/instance_8c.html#a1">perrs</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01294">ClRespRequestData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00852">ClStartExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00166">DdeAddData()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00234">DdeGetData()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">DdeQueryNextServer()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00885">SvSpontExecute()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.
<p>
<pre class="fragment"><div>00140 {
00141     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00142 
00143     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_ERRORS &amp;&amp; !(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; APPCLASS_MONITOR)) {
00144         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00145                 <span class="keyword">sizeof</span>(MONERRSTRUCT));
00146         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00147             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_ERRORS;
00148             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00149             <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONERRSTRUCT);
00150 <span class="preprocessor">#define perrs ((MONERRSTRUCT *)&amp;pep-&gt;Data)</span>
00151 <span class="preprocessor"></span>            <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;cb =      <span class="keyword">sizeof</span>(MONERRSTRUCT);
00152             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;wLastError = (WORD)error;
00153             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;dwTime =  <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00154             <a class="code" href="../../d0/d4/instance_8c.html#a1">perrs</a>-&gt;hTask =   (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00155 <span class="preprocessor">#undef perrs</span>
00156 <span class="preprocessor"></span>            <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00157             <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00158             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00159         }
00160     }
00161 <span class="preprocessor">#if DBG</span>
00162 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (error != 0 &amp;&amp; error != DMLERR_NO_CONV_ESTABLISHED) {
00163         RIPMSG3(RIP_WARNING,
00164                 <span class="stringliteral">"DDEML Error set=%x, Client Instance=%x, Process=%x."</span>,
00165                 error, pcii, <a class="code" href="../../d4/d1/userk_8h.html#a19">GetCurrentProcessId</a>());
00166     }
00167 <span class="preprocessor">#endif</span>
00168 <span class="preprocessor"></span>    pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o9">LastError</a> = error;
00169 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="instance.c::ValidateInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> ValidateInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInstClient</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">111</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00103">HTYPE_INSTANCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00560">DdeAbandonTransaction()</a>, <a class="el" href="../../d1/d8/hdata_8c-source.html#l00025">DdeCreateDataHandle()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00405">DdeGetLastError()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00065">InternalDdeInitialize()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00909">ValidateTransaction()</a>.
<p>
<pre class="fragment"><div>00113 {
00114     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00115 
00116     pcii = (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>(hInstClient, HTYPE_INSTANCE, HINST_ANY);
00117 
00118     <span class="keywordflow">if</span> (pcii != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00119         <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> != GetCurrentThreadId() ||
00120                 pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a> != hInstClient) {
00121             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00122         }
00123     }
00124     <span class="keywordflow">return</span> (pcii);
00125 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="instance.c::aInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PHANDLE <a class="el" href="../../d0/d4/instance_8c.html#a2">aInstance</a> = NULL          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00021">21</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">DestroyInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="instance.c::cInstAllocated" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="../../d0/d4/instance_8c.html#a3">cInstAllocated</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00022">22</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="instance.c::iFirstFreeInst" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="../../d0/d4/instance_8c.html#a4">iFirstFreeInst</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/instance_8c-source.html#l00023">23</a> of file <a class="el" href="../../d1/d3/instance_8c-source.html">instance.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/instance_8c-source.html#l00040">AddInstance()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00087">DestroyInstance()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:13 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
