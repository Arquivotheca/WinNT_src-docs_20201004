<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: psinit.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>psinit.c File Reference</h1><code>#include "<a class="el" href="../../d9/d0/psp_8h-source.html">psp.h</a>"</code><br>

<p>
<a href="../../d1/d0/psinit_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a0">ROUND_UP</a>(VALUE, ROUND)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a1">PSP_1MB</a>&nbsp;&nbsp;&nbsp;(1024*1024)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a39">MmCheckSystemImage</a> (IN HANDLE ImageFileHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a40">LookupEntryPoint</a> (IN PVOID DllBase, IN PSZ NameOfEntryPoint, OUT PVOID *AddressOfEntryPoint)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a41">PsInitSystem</a> (IN ULONG Phase, IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a42">PspInitPhase0</a> (IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a43">PspInitPhase1</a> (IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a44">PsLocateSystemDll</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a45">PspMapSystemDll</a> (IN <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process, OUT PVOID *DllBase OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a46">PspInitializeSystemDll</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a47">PspLookupSystemDllEntryPoint</a> (IN PSZ NameOfEntryPoint, OUT PVOID *AddressOfEntryPoint)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a48">PsChangeQuantumTable</a> (BOOLEAN ModifyActiveProcesses, ULONG PrioritySeparation)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a2">PsMinimumWorkingSet</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a3">PsMaximumWorkingSet</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a4">PsPrioritySeperation</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a5">PsRawPrioritySeparation</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>GENERIC_MAPPING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a6">PspProcessMapping</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>GENERIC_MAPPING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a7">PspThreadMapping</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>GENERIC_MAPPING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a8">PspJobMapping</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a9">PsThreadType</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a10">PsProcessType</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a11">PspCidTable</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a12">PsInitialSystemProcess</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a13">PspInitialSystemProcessHandle</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PACCESS_TOKEN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a14">PspBootAccessToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a15">PsNtDllPathName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a16">PsProcessSecurityLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a17">PsSystemDllDllBase</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a18">PspDefaultPagedLimit</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a19">PspDefaultNonPagedLimit</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a20">PspDefaultPagefileLimit</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a21">PspForegroundQuantum</a> [3]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">EPROCESS_QUOTA_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a22">PspDefaultQuotaBlock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a23">PspDoingGiveBacks</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a24">PsJobType</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a25">PspJobListLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a26">PspJobList</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a27">PsReaperActive</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a28">PsReaperListHead</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a29">PsReaperWorkItem</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d8/struct__SYSTEM__DLL.html">SYSTEM_DLL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a31">PsSystemDllBase</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a32">PspActiveProcessMutex</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a33">PsActiveProcessHead</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a34">PsIdleProcess</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a35">PspFixedQuantums</a> [6]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a36">PspVariableQuantums</a> [6]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a37">PspUseJobSchedulingClasses</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d1/psinit_8c.html#a38">PspJobSchedulingClasses</a> [PSP_NUMBER_OF_SCHEDULING_CLASSES]</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="psinit.c::PSP_1MB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PSP_1MB&nbsp;&nbsp;&nbsp;(1024*1024)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00126">126</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="psinit.c::ROUND_UP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ROUND_UP          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VALUE,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ROUND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>((ULONG)(((ULONG)VALUE + \
                               ((ULONG)ROUND - 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>)) &amp; (~((ULONG)ROUND - 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>))))
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00023">23</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a40" doxytag="psinit.c::LookupEntryPoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS LookupEntryPoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>DllBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>NameOfEntryPoint</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>AddressOfEntryPoint</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00827">PspLookupSystemDllEntryPoint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="psinit.c::MmCheckSystemImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS MmCheckSystemImage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ImageFileHandle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="psinit.c::PsChangeQuantumTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID PsChangeQuantumTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ModifyActiveProcesses</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PrioritySeparation</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">878</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00285">_EPROCESS::Job</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00041">MEMORY_PRIORITY_BACKGROUND</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00069">_MMSUPPORT::MemoryPriority</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l03087">MmIsThisAnNtAsSystem()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00166">_EPROCESS::Pcb</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00276">_EPROCESS::PriorityClass</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00575">PsActiveProcessHead</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03058">PspActiveProcessMutex</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00840">PspFixedQuantums</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00113">PspForegroundQuantum</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00864">PspJobSchedulingClasses</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00573">PsPrioritySeperation</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00862">PspUseJobSchedulingClasses</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00849">PspVariableQuantums</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00543">_EJOB::SchedulingClass</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00036">THREAD_QUANTUM</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d8/ps_8h-source.html#l00196">_EPROCESS::Vm</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.
<p>
<pre class="fragment"><div>00882 {
00883 
00884     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process;
00885     PLIST_ENTRY NextProcess;
00886     ULONG QuantumIndex;
00887     PSCHAR QuantumTableBase;
00888 
00889     <span class="comment">//</span>
00890     <span class="comment">// extract priority seperation value</span>
00891     <span class="comment">//</span>
00892     <span class="keywordflow">switch</span> ( PrioritySeparation &amp; PROCESS_PRIORITY_SEPARATION_MASK ) {
00893         <span class="keywordflow">case</span> 3:
00894             <a class="code" href="../../d1/d9/ps_8h.html#a47">PsPrioritySeperation</a> = PROCESS_PRIORITY_SEPARATION_MAX;
00895             <span class="keywordflow">break</span>;
00896         <span class="keywordflow">default</span>:
00897             <a class="code" href="../../d1/d9/ps_8h.html#a47">PsPrioritySeperation</a> = PrioritySeparation &amp; PROCESS_PRIORITY_SEPARATION_MASK;
00898             <span class="keywordflow">break</span>;
00899         }
00900 
00901     <span class="comment">//</span>
00902     <span class="comment">// determine if we are using fixed or variable quantums</span>
00903     <span class="comment">//</span>
00904     <span class="keywordflow">switch</span> ( PrioritySeparation &amp; PROCESS_QUANTUM_VARIABLE_MASK ) {
00905         <span class="keywordflow">case</span> PROCESS_QUANTUM_VARIABLE_VALUE:
00906             QuantumTableBase = <a class="code" href="../../d0/d1/psinit_8c.html#a36">PspVariableQuantums</a>;
00907             <span class="keywordflow">break</span>;
00908 
00909         <span class="keywordflow">case</span> PROCESS_QUANTUM_FIXED_VALUE:
00910             QuantumTableBase = <a class="code" href="../../d0/d1/psinit_8c.html#a35">PspFixedQuantums</a>;
00911             <span class="keywordflow">break</span>;
00912 
00913         <span class="keywordflow">case</span> PROCESS_QUANTUM_VARIABLE_DEF:
00914         <span class="keywordflow">default</span>:
00915             <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d1/mminit_8c.html#a58">MmIsThisAnNtAsSystem</a>() ) {
00916                 QuantumTableBase = <a class="code" href="../../d0/d1/psinit_8c.html#a35">PspFixedQuantums</a>;
00917                 }
00918             <span class="keywordflow">else</span> {
00919                 QuantumTableBase = <a class="code" href="../../d0/d1/psinit_8c.html#a36">PspVariableQuantums</a>;
00920                 }
00921             <span class="keywordflow">break</span>;
00922         }
00923 
00924     <span class="comment">//</span>
00925     <span class="comment">// determine if we are using long or short</span>
00926     <span class="comment">//</span>
00927     <span class="keywordflow">switch</span> ( PrioritySeparation &amp; PROCESS_QUANTUM_LONG_MASK ) {
00928         <span class="keywordflow">case</span> PROCESS_QUANTUM_LONG_VALUE:
00929             QuantumTableBase = QuantumTableBase + 3;
00930             <span class="keywordflow">break</span>;
00931 
00932         <span class="keywordflow">case</span> PROCESS_QUANTUM_SHORT_VALUE:
00933             <span class="keywordflow">break</span>;
00934 
00935         <span class="keywordflow">case</span> PROCESS_QUANTUM_LONG_DEF:
00936         <span class="keywordflow">default</span>:
00937             <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d1/mminit_8c.html#a58">MmIsThisAnNtAsSystem</a>() ) {
00938                 QuantumTableBase = QuantumTableBase + 3;
00939                 }
00940             <span class="keywordflow">break</span>;
00941         }
00942 
00943     <span class="comment">//</span>
00944     <span class="comment">// Job Scheduling classes are ONLY meaningful if long fixed quantums</span>
00945     <span class="comment">// are selected. In practice, this means stock NTS configurations</span>
00946     <span class="comment">//</span>
00947     <span class="keywordflow">if</span> ( QuantumTableBase == &amp;<a class="code" href="../../d0/d1/psinit_8c.html#a35">PspFixedQuantums</a>[3] ) {
00948         <a class="code" href="../../d0/d1/psinit_8c.html#a37">PspUseJobSchedulingClasses</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00949         }
00950     <span class="keywordflow">else</span> {
00951         <a class="code" href="../../d0/d1/psinit_8c.html#a37">PspUseJobSchedulingClasses</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00952         }
00953 
00954     RtlCopyMemory(PspForegroundQuantum,QuantumTableBase,<span class="keyword">sizeof</span>(PspForegroundQuantum));
00955 
00956     <span class="keywordflow">if</span> (ModifyActiveProcesses) {
00957 
00958         ExAcquireFastMutex(&amp;PspActiveProcessMutex);
00959 
00960         NextProcess = <a class="code" href="../../d1/d9/ps_8h.html#a49">PsActiveProcessHead</a>.Flink;
00961 
00962         <span class="keywordflow">while</span> (NextProcess != &amp;<a class="code" href="../../d1/d9/ps_8h.html#a49">PsActiveProcessHead</a>) {
00963             Process = CONTAINING_RECORD(NextProcess,
00964                                         <a class="code" href="../../d0/d4/struct__EPROCESS.html">EPROCESS</a>,
00965                                         ActiveProcessLinks);
00966 
00967             <span class="keywordflow">if</span> ( Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o16">Vm</a>.<a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o12">MemoryPriority</a> == <a class="code" href="../../d1/d9/ps_8h.html#a1">MEMORY_PRIORITY_BACKGROUND</a> ) {
00968                 QuantumIndex = 0;
00969                 }
00970             <span class="keywordflow">else</span> {
00971                 QuantumIndex = <a class="code" href="../../d1/d9/ps_8h.html#a47">PsPrioritySeperation</a>;
00972                 }
00973             <span class="keywordflow">if</span> ( Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o68">PriorityClass</a> != PROCESS_PRIORITY_CLASS_IDLE ) {
00974 
00975                 <span class="comment">//</span>
00976                 <span class="comment">// If the process is contained within a JOB, AND we are</span>
00977                 <span class="comment">// running Fixed, Long Quantums, use the quantum associated</span>
00978                 <span class="comment">// with the Job's scheduling class</span>
00979                 <span class="comment">//</span>
00980                 <span class="keywordflow">if</span> ( Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o73">Job</a> &amp;&amp; <a class="code" href="../../d0/d1/psinit_8c.html#a37">PspUseJobSchedulingClasses</a> ) {
00981                     Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a38">PspJobSchedulingClasses</a>[Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o73">Job</a>-&gt;<a class="code" href="../../d0/d3/struct__EJOB.html#o28">SchedulingClass</a>];
00982                     }
00983                 <span class="keywordflow">else</span> {
00984                     Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a21">PspForegroundQuantum</a>[QuantumIndex];
00985                     }
00986                 }
00987             <span class="keywordflow">else</span> {
00988                 Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a> = <a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>;
00989                 }
00990             NextProcess = NextProcess-&gt;Flink;
00991             }
00992         ExReleaseFastMutex(&amp;PspActiveProcessMutex);
00993         }
00994 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="psinit.c::PsInitSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN PsInitSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LoaderBlock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00138">138</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d9/d0/init_8h-source.html#l00070">InitializationPhase</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00487">PspInitPhase1()</a>.
<p>
<pre class="fragment"><div>00145                    :
00146 
00147     This function fermorms process structure initialization.
00148     It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called during phase 0 and phase 1 initialization. Its
00149     function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to dispatch to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate phase initialization
00150     routine.
00151 
00152 Arguments:
00153 
00154     Phase - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initialization phase number.
00155 
00156     LoaderBlock - Supplies a pointer to a loader parameter block.
00157 
00158 Return Value:
00159 
00160     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - Initialization succeeded.
00161 
00162     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - Initialization failed.
00163 
00164 --*/
00165 
00166 {
00167 
00168     <span class="keywordflow">switch</span> ( <a class="code" href="../../d8/d1/init_8h.html#a21">InitializationPhase</a> ) {
00169 
00170     <span class="keywordflow">case</span> 0 :
00171         <span class="keywordflow">return</span> <a class="code" href="../../d8/d1/psp_8h.html#a55">PspInitPhase0</a>(LoaderBlock);
00172     <span class="keywordflow">case</span> 1 :
00173         <span class="keywordflow">return</span> <a class="code" href="../../d8/d1/psp_8h.html#a56">PspInitPhase1</a>(LoaderBlock);
00174     <span class="keywordflow">default</span>:
00175         <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(UNEXPECTED_INITIALIZATION_CALL);
00176     }
00177     <span class="keywordflow">return</span> 0; <span class="comment">// Not reachable, quiet compiler</span>
00178 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="psinit.c::PsLocateSystemDll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PsLocateSystemDll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">525</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00086">_SYSTEM_DLL::DllBase</a>, <a class="el" href="../../d2/d8/icmui_8def-source.html#l00004">File</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d0/d1/psinit_8c.html#a39">MmCheckSystemImage()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00381">MmSectionObjectType</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00576">PsNtDllPathName</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00679">PspMapSystemDll()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00124">PspSystemDll</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00577">PsSystemDllBase</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00061">PsSystemDllDllBase</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00410">RtlAllocateStringRoutine</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01763">RtlCopyUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00085">_SYSTEM_DLL::Section</a>, and <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00582">ZwOpenFile()</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>.
<p>
<pre class="fragment"><div>00531                    :
00532 
00533     This function locates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system dll and creates a section <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00534     DLL and maps <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system process.
00535 
00536 Arguments:
00537 
00538     None.
00539 
00540 Return Value:
00541 
00542     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - Initialization was successful.
00543 
00544     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - Initialization Failed.
00545 
00546 --*/
00547 
00548 {
00549 
00550     HANDLE <a class="code" href="../../d1/d9/icmui_8def.html#a0">File</a>;
00551     HANDLE Section;
00552     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00553     UNICODE_STRING DllPathName;
00554     WCHAR PathBuffer[DOS_MAX_PATH_LENGTH];
00555     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00556     IO_STATUS_BLOCK IoStatus;
00557 
00558     <span class="comment">//</span>
00559     <span class="comment">// Initialize the system DLL</span>
00560     <span class="comment">//</span>
00561 
00562     DllPathName.Length = 0;
00563     DllPathName.Buffer = PathBuffer;
00564     DllPathName.MaximumLength = 256;
00565     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;DllPathName,L<span class="stringliteral">"\\SystemRoot\\System32\\ntdll.dll"</span>);
00566     InitializeObjectAttributes(
00567         &amp;ObjectAttributes,
00568         &amp;DllPathName,
00569         OBJ_CASE_INSENSITIVE,
00570         NULL,
00571         NULL
00572         );
00573 
00574     st = <a class="code" href="../../d6/d9/restrfil_8c.html#a33">ZwOpenFile</a>(
00575             &amp;File,
00576             SYNCHRONIZE | FILE_EXECUTE,
00577             &amp;ObjectAttributes,
00578             &amp;IoStatus,
00579             FILE_SHARE_READ,
00580             0
00581             );
00582 
00583     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00584 
00585 <span class="preprocessor">#if DBG</span>
00586 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"PS: PsLocateSystemDll - NtOpenFile( NTDLL.DLL ) failed.  Status == %lx\n"</span>,
00587             st
00588             );
00589 <span class="preprocessor">#endif</span>
00590 <span class="preprocessor"></span>        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,2,0,0);
00591         <span class="keywordflow">return</span> st;
00592     }
00593 
00594     st = <a class="code" href="../../d0/d1/psinit_8c.html#a39">MmCheckSystemImage</a>(File);
00595     <span class="keywordflow">if</span> ( st == STATUS_IMAGE_CHECKSUM_MISMATCH ) {
00596         ULONG_PTR ErrorParameters;
00597         ULONG ErrorResponse;
00598 
00599         <span class="comment">//</span>
00600         <span class="comment">// Hard error time. A driver is corrupt.</span>
00601         <span class="comment">//</span>
00602 
00603     ErrorParameters = (ULONG_PTR)&amp;DllPathName;
00604 
00605         <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a11">NtRaiseHardError</a>(
00606             st,
00607             1,
00608             1,
00609             &amp;ErrorParameters,
00610             OptionOk,
00611             &amp;ErrorResponse
00612             );
00613         <span class="keywordflow">return</span> st;
00614         }
00615 
00616 
00617     <a class="code" href="../../d1/d9/ps_8h.html#a50">PsNtDllPathName</a>.MaximumLength = DllPathName.Length + <span class="keyword">sizeof</span>( WCHAR );
00618     <a class="code" href="../../d1/d9/ps_8h.html#a50">PsNtDllPathName</a>.Length = 0;
00619     <a class="code" href="../../d1/d9/ps_8h.html#a50">PsNtDllPathName</a>.Buffer = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a49">RtlAllocateStringRoutine</a>( <a class="code" href="../../d1/d9/ps_8h.html#a50">PsNtDllPathName</a>.MaximumLength );
00620     <a class="code" href="../../d6/d6/nls_8c.html#a44">RtlCopyUnicodeString</a>( &amp;PsNtDllPathName, &amp;DllPathName );
00621 
00622     st = ZwCreateSection(
00623             &amp;Section,
00624             SECTION_ALL_ACCESS,
00625             NULL,
00626             0,
00627             PAGE_EXECUTE,
00628             SEC_IMAGE,
00629             File
00630             );
00631     ZwClose( File );
00632 
00633     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00634 <span class="preprocessor">#if DBG</span>
00635 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"PS: PsLocateSystemDll: NtCreateSection Status == %lx\n"</span>,st);
00636 <span class="preprocessor">#endif</span>
00637 <span class="preprocessor"></span>        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,3,0,0);
00638         <span class="keywordflow">return</span> st;
00639     }
00640 
00641     <span class="comment">//</span>
00642     <span class="comment">// Now that we have the section, reference it, store its address in the</span>
00643     <span class="comment">// PspSystemDll and then close handle to the section.</span>
00644     <span class="comment">//</span>
00645 
00646     st = <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00647             Section,
00648             SECTION_ALL_ACCESS,
00649             MmSectionObjectType,
00650             KernelMode,
00651             &amp;<a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o0">Section</a>,
00652             NULL
00653             );
00654 
00655     ZwClose(Section);
00656 
00657     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00658         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,4,0,0);
00659         <span class="keywordflow">return</span> st;
00660     }
00661 
00662     <span class="comment">//</span>
00663     <span class="comment">// Map the system dll into the user part of the address space</span>
00664     <span class="comment">//</span>
00665 
00666     st = <a class="code" href="../../d8/d1/psp_8h.html#a61">PspMapSystemDll</a>(<a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>(),&amp;<a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">DllBase</a>);
00667     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a8">PsSystemDllDllBase</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">DllBase</a>;
00668 
00669     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00670         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,5,0,0);
00671         <span class="keywordflow">return</span> st;
00672     }
00673     <a class="code" href="../../d1/d9/ps_8h.html#a51">PsSystemDllBase</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">DllBase</a>;
00674 
00675     <span class="keywordflow">return</span> STATUS_SUCCESS;
00676 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="psinit.c::PspInitializeSystemDll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PspInitializeSystemDll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00745">745</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d6/d5/4_2kdinit_8c-source.html#l00038">KdUpdateDataBlock()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00087">_SYSTEM_DLL::LoaderInitRoutine</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d9/d9/kulokup2_8c-source.html#l00025">PspLookupKernelUserEntryPoints()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00827">PspLookupSystemDllEntryPoint()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00124">PspSystemDll</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00487">PspInitPhase1()</a>.
<p>
<pre class="fragment"><div>00751                    :
00752 
00753     This function initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system DLL and locates
00754     various <a class="code" href="../../d7/d1/genuedef_8c.html#a4">entrypoints</a> within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DLL.
00755 
00756 Arguments:
00757 
00758     None.
00759 
00760 Return Value:
00761 
00762     TBD
00763 
00764 --*/
00765 
00766 {
00767     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00768     PSZ dll_entrypoint;
00769     PVOID R3EmulatorTable;
00770 
00771     <span class="comment">//</span>
00772     <span class="comment">// Locate the important system dll entrypoints</span>
00773     <span class="comment">//</span>
00774 
00775     dll_entrypoint = <span class="stringliteral">"LdrInitializeThunk"</span>;
00776 
00777     st = <a class="code" href="../../d8/d1/psp_8h.html#a58">PspLookupSystemDllEntryPoint</a>(
00778             dll_entrypoint,
00779             (PVOID *)&amp;<a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o2">LoaderInitRoutine</a>
00780             );
00781 
00782     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00783 <span class="preprocessor">#if DBG</span>
00784 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"PS: Unable to locate LdrInitializeThunk in system dll\n"</span>);
00785 <span class="preprocessor">#endif</span>
00786 <span class="preprocessor"></span>        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,6,0,0);
00787         <span class="keywordflow">return</span> st;
00788     }
00789 
00790 <span class="preprocessor">#if i386</span>
00791 <span class="preprocessor"></span>    <span class="comment">//</span>
00792     <span class="comment">// Find 80387 emulator.</span>
00793     <span class="comment">//</span>
00794 
00795     st = <a class="code" href="../../d8/d1/psp_8h.html#a58">PspLookupSystemDllEntryPoint</a>(
00796             <span class="stringliteral">"NPXEMULATORTABLE"</span>,
00797             &amp;R3EmulatorTable
00798             );
00799 
00800     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00801 <span class="preprocessor">#if DBG</span>
00802 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"PS: Unable to locate NPXNPHandler in system dll\n"</span>);
00803 <span class="preprocessor">#endif</span>
00804 <span class="preprocessor"></span>        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,7,0,0);
00805         <span class="keywordflow">return</span> st;
00806     }
00807     <span class="comment">//</span>
00808     <span class="comment">// Pass emulator into kernel, and let it decide whether it should</span>
00809     <span class="comment">// use the emulator or set up to use the 80387 hardware.</span>
00810     <span class="comment">//</span>
00811 
00812     <a class="code" href="../../d6/d9/kernlini_8c.html#a40">KeSetup80387OrEmulate</a>(R3EmulatorTable);
00813 <span class="preprocessor">#endif //i386</span>
00814 <span class="preprocessor"></span>
00815     st = <a class="code" href="../../d8/d1/psp_8h.html#a59">PspLookupKernelUserEntryPoints</a>();
00816 
00817     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00818         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS1_INITIALIZATION_FAILED,st,8,0,0);
00819         }
00820 
00821     <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a2">KdUpdateDataBlock</a>();
00822 
00823     <span class="keywordflow">return</span> st;
00824 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="psinit.c::PspInitPhase0" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN PspInitPhase0           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>LoaderBlock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">181</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00457">ExCreateHandleTable()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00367">ExInitializeFastMutex</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01961">ExInitializeWorkItem</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00273">_EPROCESS::ImageFileName</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00755">_KPROCESS::KernelTime</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00091">_JOB_WORKING_SET_CHANGE_HEAD::Links</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00092">_JOB_WORKING_SET_CHANGE_HEAD::Lock</a>, <a class="el" href="../../d2/d1/mm_8h.html#a140">MM_SYSTEMSIZE</a>, <a class="el" href="../../d2/d1/mm_8h.html#a343a167">MmLargeSystem</a>, <a class="el" href="../../d2/d1/mm_8h.html#a343a166">MmMediumSystem</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l03073">MmQuerySystemSize()</a>, <a class="el" href="../../d2/d1/mm_8h.html#a343a165">MmSmallSystem</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00166">_EPROCESS::Pcb</a>, <a class="el" href="../../d8/d1/init_8h.html#a23">Phase1Initialization()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00575">PsActiveProcessHead</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00175">PsCreateSystemThread()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00588">PsIdleProcess</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00579">PsInitialSystemProcess</a>, <a class="el" href="../../d0/d8/ntos_8h-source.html#l00090">PsJobType</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00056">PsMaximumWorkingSet</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00097">PsMinimumWorkingSet</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00126">PSP_1MB</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00056">PSP_PROCESS_NONPAGED_CHARGE</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00055">PSP_PROCESS_PAGED_CHARGE</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00069">PSP_THREAD_NONPAGED_CHARGE</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00068">PSP_THREAD_PAGED_CHARGE</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03058">PspActiveProcessMutex</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00106">PspBootAccessToken</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00037">PspCidTable</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d9/d9/cmdat3_8c-source.html#l00098">PspDefaultNonPagedLimit</a>, <a class="el" href="../../d9/d9/cmdat3_8c-source.html#l00097">PspDefaultPagedLimit</a>, <a class="el" href="../../d9/d9/cmdat3_8c-source.html#l00099">PspDefaultPagefileLimit</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00116">PspDoingGiveBacks</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00086">PspInitialSystemProcessHandle</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00119">PspJobList</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00118">PspJobListLock</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00074">PspJobMapping</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00084">PspLdtInitialize()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00064">PspProcessLockMutex</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00050">PspProcessMapping</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00057">PspReaper()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00578">PsProcessSecurityLock</a>, <a class="el" href="../../d0/d8/ntos_8h-source.html#l00088">PsProcessType</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01438">PspThreadDelete()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00063">PspThreadMapping</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00987">PspVdmInitialize()</a>, <a class="el" href="../../d9/d0/psp_8h-source.html#l00102">PspWorkingSetChangeHead</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00574">PsRawPrioritySeparation</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00590">PsReaperListHead</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00591">PsReaperWorkItem</a>, <a class="el" href="../../d0/d8/ntos_8h-source.html#l00089">PsThreadType</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00138">ThreadHandle</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00138">PsInitSystem()</a>.
<p>
<pre class="fragment"><div>00187                    :
00188 
00189     This routine performs phase 0 process structure initialization.
00190     During <span class="keyword">this</span> phase, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial system process, phase 1 initialization
00191     thread, and reaper threads are created. All object types and other
00192     process structures are created and initialized.
00193 
00194 Arguments:
00195 
00196     None.
00197 
00198 Return Value:
00199 
00200     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - Initialization was successful.
00201 
00202     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - Initialization Failed.
00203 
00204 --*/
00205 
00206 {
00207 
00208     UNICODE_STRING NameString;
00209     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00210     <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">OBJECT_TYPE_INITIALIZER</a> ObjectTypeInitializer;
00211     HANDLE <a class="code" href="../../d2/d1/cttoken_8c.html#a63">ThreadHandle</a>;
00212     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread;
00213     <a class="code" href="../../d2/d1/mm_8h.html#a140">MM_SYSTEMSIZE</a> SystemSize;
00214 
00215     SystemSize = <a class="code" href="../../d5/d1/mminit_8c.html#a57">MmQuerySystemSize</a>();
00216     <a class="code" href="../../d8/d0/cmdat3_8c.html#a43">PspDefaultPagefileLimit</a> = (ULONG)-1;
00217 
00218 <span class="preprocessor">#ifdef _WIN64</span>
00219 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( <span class="keyword">sizeof</span>(TEB) &gt; 8192 || <span class="keyword">sizeof</span>(PEB) &gt; 4096 ) {
00220 <span class="preprocessor">#else</span>
00221 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( <span class="keyword">sizeof</span>(TEB) &gt; 4096 || <span class="keyword">sizeof</span>(PEB) &gt; 4096 ) {
00222 <span class="preprocessor">#endif</span>
00223 <span class="preprocessor"></span>        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(PROCESS_INITIALIZATION_FAILED,99,<span class="keyword">sizeof</span>(TEB),<span class="keyword">sizeof</span>(PEB),99);
00224         }
00225 
00226     <span class="keywordflow">switch</span> ( SystemSize ) {
00227 
00228         <span class="keywordflow">case</span> <a class="code" href="../../d2/d1/mm_8h.html#a343a166">MmMediumSystem</a> :
00229             <a class="code" href="../../d5/d0/wsmanage_8c.html#a5">PsMinimumWorkingSet</a> += 10;
00230             <a class="code" href="../../d2/d8/ps_2create_8c.html#a7">PsMaximumWorkingSet</a> += 100;
00231             <span class="keywordflow">break</span>;
00232 
00233         <span class="keywordflow">case</span> <a class="code" href="../../d2/d1/mm_8h.html#a343a167">MmLargeSystem</a> :
00234             <a class="code" href="../../d5/d0/wsmanage_8c.html#a5">PsMinimumWorkingSet</a> += 30;
00235             <a class="code" href="../../d2/d8/ps_2create_8c.html#a7">PsMaximumWorkingSet</a> += 300;
00236             <span class="keywordflow">break</span>;
00237 
00238         <span class="keywordflow">case</span> <a class="code" href="../../d2/d1/mm_8h.html#a343a165">MmSmallSystem</a> :
00239         <span class="keywordflow">default</span>:
00240             <span class="keywordflow">break</span>;
00241         }
00242 
00243     <a class="code" href="../../d0/d1/psinit_8c.html#a48">PsChangeQuantumTable</a>(FALSE,PsRawPrioritySeparation);
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">// Quotas grow as needed automatically</span>
00247     <span class="comment">//</span>
00248 
00249     <span class="keywordflow">if</span> ( !<a class="code" href="../../d8/d0/cmdat3_8c.html#a41">PspDefaultPagedLimit</a> ) {
00250         <a class="code" href="../../d8/d0/cmdat3_8c.html#a41">PspDefaultPagedLimit</a> = 0;
00251         }
00252     <span class="keywordflow">if</span> ( !<a class="code" href="../../d8/d0/cmdat3_8c.html#a42">PspDefaultNonPagedLimit</a> ) {
00253         <a class="code" href="../../d8/d0/cmdat3_8c.html#a42">PspDefaultNonPagedLimit</a> = 0;
00254         }
00255 
00256     <span class="keywordflow">if</span> ( <a class="code" href="../../d8/d0/cmdat3_8c.html#a42">PspDefaultNonPagedLimit</a> == 0 &amp;&amp; <a class="code" href="../../d8/d0/cmdat3_8c.html#a41">PspDefaultPagedLimit</a> == 0) {
00257         <a class="code" href="../../d0/d1/psinit_8c.html#a23">PspDoingGiveBacks</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00258         }
00259     <span class="keywordflow">else</span> {
00260         <a class="code" href="../../d0/d1/psinit_8c.html#a23">PspDoingGiveBacks</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00261         }
00262 
00263 
00264     <a class="code" href="../../d8/d0/cmdat3_8c.html#a41">PspDefaultPagedLimit</a> *= <a class="code" href="../../d0/d1/psinit_8c.html#a1">PSP_1MB</a>;
00265     <a class="code" href="../../d8/d0/cmdat3_8c.html#a42">PspDefaultNonPagedLimit</a> *= <a class="code" href="../../d0/d1/psinit_8c.html#a1">PSP_1MB</a>;
00266 
00267     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/cmdat3_8c.html#a43">PspDefaultPagefileLimit</a> != -1) {
00268         <a class="code" href="../../d8/d0/cmdat3_8c.html#a43">PspDefaultPagefileLimit</a> *= <a class="code" href="../../d0/d1/psinit_8c.html#a1">PSP_1MB</a>;
00269         }
00270 
00271     <span class="comment">//</span>
00272     <span class="comment">// Initialize the process security fields lock and the process lock.</span>
00273     <span class="comment">//</span>
00274 
00275     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>( &amp;PspProcessLockMutex );
00276     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>( &amp;PsProcessSecurityLock );
00277 
00278     <a class="code" href="../../d1/d9/ps_8h.html#a62">PsIdleProcess</a> = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>();
00279     <a class="code" href="../../d1/d9/ps_8h.html#a62">PsIdleProcess</a>-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o4">KernelTime</a> = 0;
00280     <a class="code" href="../../d1/d9/ps_8h.html#a62">PsIdleProcess</a>-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o4">KernelTime</a> = 0;
00281 
00282     <span class="comment">//</span>
00283     <span class="comment">// Initialize the common fields of the Object Type Prototype record</span>
00284     <span class="comment">//</span>
00285 
00286     RtlZeroMemory( &amp;ObjectTypeInitializer, <span class="keyword">sizeof</span>( ObjectTypeInitializer ) );
00287     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o0">Length</a> = <span class="keyword">sizeof</span>( ObjectTypeInitializer );
00288     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o3">InvalidAttributes</a> = OBJ_OPENLINK;
00289     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o6">SecurityRequired</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00290     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o9">PoolType</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>;
00291     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o3">InvalidAttributes</a> = OBJ_PERMANENT |
00292                                               OBJ_EXCLUSIVE |
00293                                               OBJ_OPENIF;
00294 
00295 
00296     <span class="comment">//</span>
00297     <span class="comment">// Create Object types for Thread and Process Objects.</span>
00298     <span class="comment">//</span>
00299 
00300     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;NameString, L<span class="stringliteral">"Process"</span>);
00301     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a> = <a class="code" href="../../d8/d1/psp_8h.html#a1">PSP_PROCESS_PAGED_CHARGE</a>;
00302     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a> = <a class="code" href="../../d8/d1/psp_8h.html#a2">PSP_PROCESS_NONPAGED_CHARGE</a>;
00303     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a> = <a class="code" href="../../d8/d0/psdelete_8c.html#a14">PspProcessDelete</a>;
00304     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a> = PROCESS_ALL_ACCESS;
00305     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a6">PspProcessMapping</a>;
00306 
00307     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(&amp;NameString,
00308                                      &amp;ObjectTypeInitializer,
00309                                      (PSECURITY_DESCRIPTOR) NULL,
00310                                      &amp;PsProcessType
00311                                      )) ){
00312         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00313     }
00314 
00315     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;NameString, L<span class="stringliteral">"Thread"</span>);
00316     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a> = <a class="code" href="../../d8/d1/psp_8h.html#a3">PSP_THREAD_PAGED_CHARGE</a>;
00317     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a> = <a class="code" href="../../d8/d1/psp_8h.html#a4">PSP_THREAD_NONPAGED_CHARGE</a>;
00318     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a> = <a class="code" href="../../d8/d0/psdelete_8c.html#a15">PspThreadDelete</a>;
00319     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a> = THREAD_ALL_ACCESS;
00320     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a7">PspThreadMapping</a>;
00321 
00322     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(&amp;NameString,
00323                                      &amp;ObjectTypeInitializer,
00324                                      (PSECURITY_DESCRIPTOR) NULL,
00325                                      &amp;PsThreadType
00326                                      )) ){
00327         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00328     }
00329 
00330 
00331     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;NameString, L<span class="stringliteral">"Job"</span>);
00332     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a> = 0;
00333     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d3/struct__EJOB.html">EJOB</a>);
00334     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a> = <a class="code" href="../../d1/d1/psjob_8c.html#a9">PspJobDelete</a>;
00335     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o14">CloseProcedure</a> = <a class="code" href="../../d1/d1/psjob_8c.html#a10">PspJobClose</a>;
00336     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a> = JOB_OBJECT_ALL_ACCESS;
00337     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a> = <a class="code" href="../../d0/d1/psinit_8c.html#a8">PspJobMapping</a>;
00338     ObjectTypeInitializer.<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o3">InvalidAttributes</a> = 0;
00339 
00340     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(&amp;NameString,
00341                                      &amp;ObjectTypeInitializer,
00342                                      (PSECURITY_DESCRIPTOR) NULL,
00343                                      &amp;PsJobType
00344                                      )) ){
00345         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00346     }
00347 
00348 
00349 
00350 
00351 
00352 
00353     <span class="comment">//</span>
00354     <span class="comment">// Initialize active process list head and mutex</span>
00355     <span class="comment">//</span>
00356 
00357     InitializeListHead(&amp;PsActiveProcessHead);
00358     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(&amp;PspActiveProcessMutex);
00359 
00360     <span class="comment">//</span>
00361     <span class="comment">// Initialize job list head and mutex</span>
00362     <span class="comment">//</span>
00363 
00364     InitializeListHead(&amp;PspJobList);
00365     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(&amp;PspJobListLock);
00366     InitializeListHead(&amp;<a class="code" href="../../d8/d1/psp_8h.html#a20">PspWorkingSetChangeHead</a>.<a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o0">Links</a>);
00367     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(&amp;<a class="code" href="../../d8/d1/psp_8h.html#a20">PspWorkingSetChangeHead</a>.<a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o1">Lock</a>);
00368 
00369     <span class="comment">//</span>
00370     <span class="comment">// Initialize CID handle table.</span>
00371     <span class="comment">//</span>
00372     <span class="comment">// N.B. The CID handle table is removed from the handle table list so</span>
00373     <span class="comment">//      it will not be enumerated for object handle queries.</span>
00374     <span class="comment">//</span>
00375 
00376     <a class="code" href="../../d6/d8/sysinfo_8c.html#a1">PspCidTable</a> = <a class="code" href="../../d5/d8/ex_8h.html#a290">ExCreateHandleTable</a>(NULL);
00377     <span class="keywordflow">if</span> ( ! <a class="code" href="../../d6/d8/sysinfo_8c.html#a1">PspCidTable</a> ) {
00378         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00379     }
00380     <a class="code" href="../../d5/d8/ex_8h.html#a291">ExRemoveHandleTable</a>(PspCidTable);
00381 
00382 <span class="preprocessor">#if defined(i386)</span>
00383 <span class="preprocessor"></span>
00384     <span class="comment">//</span>
00385     <span class="comment">// Ldt Initialization</span>
00386     <span class="comment">//</span>
00387 
00388     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d1/i386_2psldt_8c.html#a9">PspLdtInitialize</a>()) ) {
00389         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00390     }
00391 
00392     <span class="comment">//</span>
00393     <span class="comment">// Vdm support Initialization</span>
00394     <span class="comment">//</span>
00395 
00396     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d2/i386_2psvdm_8c.html#a11">PspVdmInitialize</a>()) ) {
00397         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00398     }
00399 
00400 <span class="preprocessor">#endif</span>
00401 <span class="preprocessor"></span>
00402     <span class="comment">//</span>
00403     <span class="comment">// Initialize Reaper Data Structures</span>
00404     <span class="comment">//</span>
00405 
00406     InitializeListHead(&amp;PsReaperListHead);
00407     <a class="code" href="../../d5/d8/ex_8h.html#a55">ExInitializeWorkItem</a>(&amp;PsReaperWorkItem, PspReaper, NULL);
00408 
00409     <span class="comment">//</span>
00410     <span class="comment">// Get a pointer to the system access token.</span>
00411     <span class="comment">// This token is used by the boot process, so we can take the pointer</span>
00412     <span class="comment">// from there.</span>
00413     <span class="comment">//</span>
00414 
00415     <a class="code" href="../../d0/d1/psinit_8c.html#a14">PspBootAccessToken</a> = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;Token;
00416 
00417     InitializeObjectAttributes( &amp;ObjectAttributes,
00418                                 NULL,
00419                                 0,
00420                                 NULL,
00421                                 NULL
00422                               ); <span class="comment">// FIXFIX</span>
00423 
00424     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d8/d1/psp_8h.html#a62">PspCreateProcess</a>(
00425                     &amp;PspInitialSystemProcessHandle,
00426                     PROCESS_ALL_ACCESS,
00427                     &amp;ObjectAttributes,
00428                     0L,
00429                     FALSE,
00430                     0L,
00431                     0L,
00432                     0L
00433                     )) ) {
00434         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00435     }
00436 
00437     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00438                                         PspInitialSystemProcessHandle,
00439                                         0L,
00440                                         PsProcessType,
00441                                         KernelMode,
00442                                         (PVOID *)&amp;PsInitialSystemProcess,
00443                                         NULL
00444                                         )) ) {
00445 
00446         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00447     }
00448 
00449     strcpy(&amp;<a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;ImageFileName[0],<span class="stringliteral">"Idle"</span>);
00450     strcpy(&amp;<a class="code" href="../../d1/d9/ps_8h.html#a53">PsInitialSystemProcess</a>-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o65">ImageFileName</a>[0],<span class="stringliteral">"System"</span>);
00451 
00452     <span class="comment">//</span>
00453     <span class="comment">// Phase 1 System initialization</span>
00454     <span class="comment">//</span>
00455 
00456     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d8/ps_2create_8c.html#a11">PsCreateSystemThread</a>(
00457                     &amp;ThreadHandle,
00458                     THREAD_ALL_ACCESS,
00459                     &amp;ObjectAttributes,
00460                     0L,
00461                     NULL,
00462                     Phase1Initialization,
00463                     (PVOID)LoaderBlock
00464                     )) ) {
00465         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00466     }
00467 
00468 
00469     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00470                         ThreadHandle,
00471                         0L,
00472                         PsThreadType,
00473                         KernelMode,
00474                         (PVOID *)&amp;Thread,
00475                         NULL
00476                         )) ) {
00477 
00478         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00479     }
00480 
00481     ZwClose( ThreadHandle );
00482 
00483     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00484 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="psinit.c::PspInitPhase1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN PspInitPhase1           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>LoaderBlock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00487">487</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00745">PspInitializeSystemDll()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00138">PsInitSystem()</a>.
<p>
<pre class="fragment"><div>00493                    :
00494 
00495     This routine performs phase 1 process structure initialization.
00496     During <span class="keyword">this</span> phase, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system DLL <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> located and relevant entry
00497     points are extracted.
00498 
00499 Arguments:
00500 
00501     None.
00502 
00503 Return Value:
00504 
00505     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - Initialization was successful.
00506 
00507     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - Initialization Failed.
00508 
00509 --*/
00510 
00511 {
00512 
00513     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00514 
00515     st = <a class="code" href="../../d8/d1/psp_8h.html#a57">PspInitializeSystemDll</a>();
00516 
00517     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) ) {
00518         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00519     }
00520 
00521     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00522 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="psinit.c::PspLookupSystemDllEntryPoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PspLookupSystemDllEntryPoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>NameOfEntryPoint</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>AddressOfEntryPoint</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00827">827</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d9/d0/psp_8h-source.html#l00086">_SYSTEM_DLL::DllBase</a>, <a class="el" href="../../d0/d1/psinit_8c.html#a40">LookupEntryPoint()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00124">PspSystemDll</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00745">PspInitializeSystemDll()</a>, and <a class="el" href="../../d0/d0/kulookup_8c-source.html#l00026">PspLookupKernelUserEntryPoints()</a>.
<p>
<pre class="fragment"><div>00832 {
00833     <span class="keywordflow">return</span> <a class="code" href="../../d0/d1/psinit_8c.html#a40">LookupEntryPoint</a> (
00834                 <a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">DllBase</a>,
00835                 NameOfEntryPoint,
00836                 AddressOfEntryPoint
00837             );
00838 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="psinit.c::PspMapSystemDll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PspMapSystemDll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *DllBase&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00679">679</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00753">MmMapViewOfSection()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00124">PspSystemDll</a>, and <a class="el" href="../../d9/d0/psp_8h-source.html#l00085">_SYSTEM_DLL::Section</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>.
<p>
<pre class="fragment"><div>00686                    :
00687 
00688     This function maps <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system DLL into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified process.
00689 
00690 Arguments:
00691 
00692     Process - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process to map <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DLL into.
00693 
00694 Return Value:
00695 
00696     TBD
00697 
00698 --*/
00699 
00700 {
00701     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00702     PVOID ViewBase;
00703     LARGE_INTEGER SectionOffset;
00704     SIZE_T ViewSize;
00705 
00706     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00707 
00708     ViewBase = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00709     SectionOffset.LowPart = 0;
00710     SectionOffset.HighPart = 0;
00711     ViewSize = 0;
00712 
00713     <span class="comment">//</span>
00714     <span class="comment">// Map the system dll into the user part of the address space</span>
00715     <span class="comment">//</span>
00716 
00717     st = <a class="code" href="../../d3/d5/mapview_8c.html#a21">MmMapViewOfSection</a>(
00718             <a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>.<a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o0">Section</a>,
00719             Process,
00720             &amp;ViewBase,
00721             0L,
00722             0L,
00723             &amp;SectionOffset,
00724             &amp;ViewSize,
00725             ViewShare,
00726             0L,
00727             PAGE_READWRITE
00728             );
00729 
00730     <span class="keywordflow">if</span> ( st != STATUS_SUCCESS ) {
00731 <span class="preprocessor">#if DBG</span>
00732 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"PS: Unable to map system dll at based address.\n"</span>);
00733 <span class="preprocessor">#endif</span>
00734 <span class="preprocessor"></span>        st = STATUS_CONFLICTING_ADDRESSES;
00735     }
00736 
00737     <span class="keywordflow">if</span> ( ARGUMENT_PRESENT(DllBase) ) {
00738         *DllBase = ViewBase;
00739     }
00740 
00741     <span class="keywordflow">return</span> st;
00742 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a33" doxytag="psinit.c::PsActiveProcessHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d0/d1/psinit_8c.html#a33">PsActiveProcessHead</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00133">133</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01519">IoWriteCrashDump()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="psinit.c::PsIdleProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="el" href="../../d0/d1/psinit_8c.html#a34">PsIdleProcess</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00135">135</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="psinit.c::PsInitialSystemProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="el" href="../../d0/d1/psinit_8c.html#a12">PsInitialSystemProcess</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00104">104</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00084">IopChainDereferenceComplete()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02160">ObpCreateHandle()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02507">ObpCreateUnnamedHandle()</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00246">PsChargePoolQuota()</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00024">PsChargeSharedPoolQuota()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00175">PsCreateSystemThread()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d1/d1/psquota_8c-source.html#l00356">PsReturnPoolQuota()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="psinit.c::PsJobType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a> <a class="el" href="../../d0/d1/psinit_8c.html#a24">PsJobType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00117">117</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00188">NtOpenJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02358">NtTerminateJobObject()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07905">NtUserUserHandleGrantAccess()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00586">PsOpenTokenOfJobObject()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="psinit.c::PsMaximumWorkingSet" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d0/d1/psinit_8c.html#a3">PsMaximumWorkingSet</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00027">27</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="psinit.c::PsMinimumWorkingSet" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d0/d1/psinit_8c.html#a2">PsMinimumWorkingSet</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00026">26</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="psinit.c::PsNtDllPathName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d0/d1/psinit_8c.html#a15">PsNtDllPathName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00107">107</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00211">DbgkCreateThread()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="psinit.c::PspActiveProcessMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="el" href="../../d8/d1/psp_8h.html#a32">PspActiveProcessMutex</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00132">132</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="psinit.c::PspBootAccessToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PACCESS_TOKEN <a class="el" href="../../d8/d1/psp_8h.html#a29">PspBootAccessToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00106">106</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01117">PspInitializeProcessSecurity()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="psinit.c::PspCidTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> <a class="el" href="../../d8/d1/psp_8h.html#a27">PspCidTable</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00103">103</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="psinit.c::PspDefaultNonPagedLimit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/psp_8h.html#a35">PspDefaultNonPagedLimit</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00111">111</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="psinit.c::PspDefaultPagedLimit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/psp_8h.html#a34">PspDefaultPagedLimit</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00110">110</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="psinit.c::PspDefaultPagefileLimit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/psp_8h.html#a36">PspDefaultPagefileLimit</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00112">112</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="psinit.c::PspDefaultQuotaBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">EPROCESS_QUOTA_BLOCK</a> <a class="el" href="../../d8/d1/psp_8h.html#a37">PspDefaultQuotaBlock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00115">115</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="psinit.c::PspDoingGiveBacks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/psp_8h.html#a38">PspDoingGiveBacks</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00116">116</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d1/d1/psquota_8c-source.html#l00356">PsReturnPoolQuota()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="psinit.c::PspFixedQuantums" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SCHAR <a class="el" href="../../d0/d1/psinit_8c.html#a35">PspFixedQuantums</a>[6]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
                                3*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                3*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                3*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                6*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                6*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                6*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>
                                }
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00840">840</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="psinit.c::PspForegroundQuantum" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SCHAR <a class="el" href="../../d8/d1/psp_8h.html#a44">PspForegroundQuantum</a>[3]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00113">113</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="psinit.c::PspInitialSystemProcessHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d1/psp_8h.html#a28">PspInitialSystemProcessHandle</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00105">105</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="psinit.c::PspJobList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d8/d1/psp_8h.html#a48">PspJobList</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00119">119</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="psinit.c::PspJobListLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="el" href="../../d8/d1/psp_8h.html#a47">PspJobListLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00118">118</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="psinit.c::PspJobMapping" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> GENERIC_MAPPING <a class="el" href="../../d0/d1/psinit_8c.html#a8">PspJobMapping</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    STANDARD_RIGHTS_READ |
        JOB_OBJECT_QUERY,
    STANDARD_RIGHTS_WRITE |
        JOB_OBJECT_ASSIGN_PROCESS | JOB_OBJECT_SET_ATTRIBUTES | JOB_OBJECT_TERMINATE,
    STANDARD_RIGHTS_EXECUTE |
        SYNCHRONIZE,
    THREAD_ALL_ACCESS
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00074">74</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="psinit.c::PspJobSchedulingClasses" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SCHAR <a class="el" href="../../d8/d1/psp_8h.html#a45">PspJobSchedulingClasses</a>[PSP_NUMBER_OF_SCHEDULING_CLASSES]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
                                1*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,   
                                2*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,   
                                3*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                4*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                5*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                6*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,   
                                7*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                8*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                9*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                10*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>   
                                }
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00864">864</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="psinit.c::PspProcessMapping" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> GENERIC_MAPPING <a class="el" href="../../d0/d1/psinit_8c.html#a6">PspProcessMapping</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    STANDARD_RIGHTS_READ |
        PROCESS_VM_READ | PROCESS_QUERY_INFORMATION,
    STANDARD_RIGHTS_WRITE |
        PROCESS_CREATE_PROCESS | PROCESS_CREATE_THREAD |
        PROCESS_VM_OPERATION | PROCESS_VM_WRITE | PROCESS_DUP_HANDLE |
        PROCESS_TERMINATE | PROCESS_SET_QUOTA |
        PROCESS_SET_INFORMATION | PROCESS_SET_PORT,
    STANDARD_RIGHTS_EXECUTE |
        SYNCHRONIZE,
    PROCESS_ALL_ACCESS
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00050">50</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="psinit.c::PsPrioritySeperation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d0/d1/psinit_8c.html#a4">PsPrioritySeperation</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00028">28</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="psinit.c::PsProcessSecurityLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="el" href="../../d0/d1/psinit_8c.html#a16">PsProcessSecurityLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00108">108</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="psinit.c::PsProcessType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a> <a class="el" href="../../d0/d1/psinit_8c.html#a10">PsProcessType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00102">102</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d5/iosup_8c-source.html#l07311">MmSetBankedSection()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00199">NtCreateProfile()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d6/d4/flushbuf_8c-source.html#l00142">NtFlushInstructionCache()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00055">NtFlushVirtualMemory()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00199">NtMapViewOfSection()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00311">NtMapViewOfSuperSection()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00102">NtReadVirtualMemory()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00227">NtTerminateProcess()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00033">NtUnmapViewOfSection()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02329">NtUserGetGuiResources()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02788">NtUserProcessConnect()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00231">NtWriteVirtualMemory()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00492">PsOpenTokenOfProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00291">PspQueryPooledQuotaLimits()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00209">PspQueryQuotaLimits()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00113">PspQueryWorkingSetWatch()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00366">PspSetPrimaryToken()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l06357">SetInformationProcess()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04821">xxxResolveDesktop()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="psinit.c::PspSystemDll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d8/struct__SYSTEM__DLL.html">SYSTEM_DLL</a> <a class="el" href="../../d8/d1/psp_8h.html#a31">PspSystemDll</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00124">124</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00745">PspInitializeSystemDll()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00827">PspLookupSystemDllEntryPoint()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00679">PspMapSystemDll()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01800">PspUserThreadStartup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="psinit.c::PspThreadMapping" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> GENERIC_MAPPING <a class="el" href="../../d0/d1/psinit_8c.html#a7">PspThreadMapping</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    STANDARD_RIGHTS_READ |
        THREAD_GET_CONTEXT | THREAD_QUERY_INFORMATION,
    STANDARD_RIGHTS_WRITE |
        THREAD_TERMINATE | THREAD_SUSPEND_RESUME | THREAD_ALERT |
        THREAD_SET_INFORMATION | THREAD_SET_CONTEXT,
    STANDARD_RIGHTS_EXECUTE |
        SYNCHRONIZE,
    THREAD_ALL_ACCESS
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00063">63</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="psinit.c::PspUseJobSchedulingClasses" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/psp_8h.html#a46">PspUseJobSchedulingClasses</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00862">862</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="psinit.c::PspVariableQuantums" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SCHAR <a class="el" href="../../d0/d1/psinit_8c.html#a36">PspVariableQuantums</a>[6]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
                                1*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                2*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                3*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                2*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                4*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>,
                                6*<a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>
                                }
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00849">849</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="psinit.c::PsRawPrioritySeparation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d0/d1/psinit_8c.html#a5">PsRawPrioritySeparation</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00029">29</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="psinit.c::PsReaperActive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d0/d1/psinit_8c.html#a27">PsReaperActive</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00121">121</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">KeTerminateThread()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00057">PspReaper()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="psinit.c::PsReaperListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d0/d1/psinit_8c.html#a28">PsReaperListHead</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00122">122</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">KeTerminateThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00057">PspReaper()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="psinit.c::PsReaperWorkItem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="el" href="../../d0/d1/psinit_8c.html#a29">PsReaperWorkItem</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00123">123</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">KeTerminateThread()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="psinit.c::PsSystemDllBase" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d0/d1/psinit_8c.html#a31">PsSystemDllBase</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00125">125</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00211">DbgkCreateThread()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="psinit.c::PsSystemDllDllBase" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d0/d1/psinit_8c.html#a17">PsSystemDllDllBase</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00109">109</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, and <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="psinit.c::PsThreadType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a> <a class="el" href="../../d0/d1/psinit_8c.html#a9">PsThreadType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d0/psinit_8c-source.html#l00101">101</a> of file <a class="el" href="../../d1/d0/psinit_8c-source.html">psinit.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00971">ExpCreateWorkerThread()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00267">NtAlertResumeThread()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00214">NtAlertThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l03038">NtImpersonateAnonymousToken()</a>, <a class="el" href="../../d0/d0/psimpers_8c-source.html#l00026">NtImpersonateThread()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00056">NtQueueApcThread()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00138">NtResumeThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00033">NtSuspendThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00461">NtTerminateThread()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00326">PsOpenTokenOfThread()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00294">SepOpenTokenOfThread()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00146">VdmpQueueInterrupt()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2kernel_2random_8c-source.html#l00276">xxxHardErrorControl()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05901">xxxQueryInformationThread()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l06114">xxxSetInformationThread()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:23 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
