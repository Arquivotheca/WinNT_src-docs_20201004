<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: usrbench.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>usrbench.c</h1><a href="../../d9/d1/usrbench_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1995  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name</span>
00006 <span class="comment"></span>
00007 <span class="comment">   usrbench.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    USER performance numbers</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">   Dan Almosnino (danalm)   25-July-1996</span>
00016 <span class="comment">   Based on code by MarkE and DarrinM</span>
00017 <span class="comment"></span>
00018 <span class="comment">Enviornment:</span>
00019 <span class="comment"></span>
00020 <span class="comment">   User Mode</span>
00021 <span class="comment"></span>
00022 <span class="comment">Revision History:</span>
00023 <span class="comment"></span>
00024 <span class="comment">   Dan Almosnino (danalm) 20-Sept-1995</span>
00025 <span class="comment"></span>
00026 <span class="comment">1. Timer call modified to run on both NT and WIN95.</span>
00027 <span class="comment">2. Test-Menu flag option added to prevent long one-colomn menu that flows out of the window in new</span>
00028 <span class="comment">   shell (both WIN95 and NT).</span>
00029 <span class="comment">3. Added Option menu item to choose fonts and string size for text-string related function calls.</span>
00030 <span class="comment">4. Added Run 2nd Suite option for the above.</span>
00031 <span class="comment">5. Modified the output save file to report the information for the above.</span>
00032 <span class="comment"></span>
00033 <span class="comment">    Dan Almosnino (danalm) 17-Oct-1995</span>
00034 <span class="comment"></span>
00035 <span class="comment">1.  Added Batch Mode and help for running batch mode</span>
00036 <span class="comment">2.  Added "Transparent" background text option to menu</span>
00037 <span class="comment"></span>
00038 <span class="comment">    Dan Almosnino (danalm) 20-Nov-1995</span>
00039 <span class="comment"></span>
00040 <span class="comment">1.  Added Option for using the Pentium Cycle Counter instead of "QueryPerformanceCounter" when applicable.</span>
00041 <span class="comment">2.  Added a simple statistics module and filter for processing the raw test data.</span>
00042 <span class="comment"></span>
00043 <span class="comment">    Dan Almosnino (danalm) 25-July-1996</span>
00044 <span class="comment"></span>
00045 <span class="comment">1.  Adapted the GDIbench UI and processing to UserBench</span>
00046 <span class="comment"></span>
00047 <span class="comment">  Hiro Yamamoto (hiroyama) 18-Sept-1996</span>
00048 <span class="comment"></span>
00049 <span class="comment">* use listview control to show results</span>
00050 <span class="comment"></span>
00051 <span class="comment">--*/</span>
00052 
00053 
00054 <span class="preprocessor">#include "<a class="code" href="../../d3/d4/w32_2ntuser_2tools_2usrbench_2precomp_8h.html">precomp.h</a>"</span>
00055 <span class="preprocessor">#include "<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html">resource.h</a>"</span>
00056 <span class="preprocessor">#include "wchar.h"</span>
<a name="l00057"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a0">00057</a> <span class="preprocessor">#define MAIN_MODULE</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="../../d0/d2/usrbench_8h.html">usrbench.h</a>"</span>
00059 <span class="preprocessor">#undef MAIN_MODULE</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="../../d2/d1/bench_8h.html">bench.h</a>"</span>
00061 
00062 <span class="comment">//</span>
00063 <span class="comment">// some globals</span>
00064 <span class="comment">//</span>
00065 
<a name="l00066"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a2">00066</a> PSZ     <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a>                 = <a class="code" href="../../d0/d2/usrbench_8h.html#a11">DEFAULT_A_STRING</a>;
<a name="l00067"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a3">00067</a> PWSTR   <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a>                = <a class="code" href="../../d0/d2/usrbench_8h.html#a12">DEFAULT_W_STRING</a>;
00068 
<a name="l00069"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a4">00069</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d1/d1/bench_8c.html#a23">gfPentium</a>               = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
<a name="l00070"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a5">00070</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d1/usrbench_8c.html#a5">gfUseCycleCount</a>         = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00071 
<a name="l00072"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a6">00072</a> HINSTANCE   <a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>;
00073 
00074 <span class="comment">// USERBENCH GLOBALS</span>
<a name="l00075"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a7">00075</a> HANDLE <a class="code" href="../../d9/d1/usrbench_8c.html#a7">ghaccel</a>;
<a name="l00076"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a8">00076</a> HANDLE <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>;
<a name="l00077"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a9">00077</a> HWND <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00078 
00079 <span class="comment">//</span>
00080 
<a name="l00081"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a10">00081</a> MDICREATESTRUCT <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>;
00082 
00083 
<a name="l00084"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a11">00084</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a11">szChild</a>[] = <span class="stringliteral">"child"</span>;           <span class="comment">// Class name for "Child" window</span>
<a name="l00085"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a12">00085</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a>[] = <span class="stringliteral">"frame"</span>;           <span class="comment">// Class name for "frame" window</span>
00086 
<a name="l00087"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a13">00087</a> <span class="keyword">static</span> CHOOSEFONT    <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>;
<a name="l00088"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a14">00088</a> <span class="keyword">static</span> LOGFONT       <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;        <span class="comment">/* logical font structure       */</span>
00089 
00090 
00091 LRESULT <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a15">MDIChildWndProc</a>(
00092     HWND hwnd,
00093     UINT msg,
00094     WPARAM wParam,
00095     LPARAM lParam);
00096 
00097 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a16">InitializeInstance</a>(HINSTANCE hInst, HINSTANCE hPrev, INT nCmdShow);
00098 
00099 
00100 
00101 
00102 <span class="keywordtype">int</span> PASCAL
<a name="l00103"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a17">00103</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a51">WinMain</a>(
00104     HINSTANCE hInst,
00105     HINSTANCE hPrev,
00106     LPSTR szCmdLine,
00107     <span class="keywordtype">int</span> cmdShow
00108 )
00109 
00110 <span class="comment">/*++</span>
00111 <span class="comment"></span>
00112 <span class="comment">Routine Description:</span>
00113 <span class="comment"></span>
00114 <span class="comment">   Process messages.</span>
00115 <span class="comment"></span>
00116 <span class="comment">Arguments:</span>
00117 <span class="comment"></span>
00118 <span class="comment">   hWnd    - window hande</span>
00119 <span class="comment">   msg     - type of message</span>
00120 <span class="comment">   wParam  - additional information</span>
00121 <span class="comment">   lParam  - additional information</span>
00122 <span class="comment"></span>
00123 <span class="comment">Return Value:</span>
00124 <span class="comment"></span>
00125 <span class="comment">   status of operation</span>
00126 <span class="comment"></span>
00127 <span class="comment"></span>
00128 <span class="comment">Revision History:</span>
00129 <span class="comment"></span>
00130 <span class="comment">      02-17-91      Initial code</span>
00131 <span class="comment"></span>
00132 <span class="comment">--*/</span>
00133 
00134 
00135 {
00136     MSG         <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
00137     HWND        hWndDesk;
00138     HWND        hwnd;
00139     HDC hdc2;
00140 
00141     <span class="keywordtype">char</span> txtbuf[80];
00142     <span class="keywordtype">char</span> *ptr;
00143 
00144     <a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a> =  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00145     <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>    =  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00146 
00147     <span class="comment">// Initialize Instance, Create Frame Window, Desktop Window and an MDI client Window</span>
00148 
00149     <span class="keywordflow">if</span>(!<a class="code" href="../../d9/d1/usrbench_8c.html#a16">InitializeInstance</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>, hPrev, cmdShow))
00150         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00151 
00152     <span class="comment">// Initialize Source Strings</span>
00153 
00154     strcpy(<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, <span class="stringliteral">"This is just a silly test string. Would you rather have a different one? Well, you can define one if you run GDI bench in batch!"</span>);
00155     wcscpy(<a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"This is just a silly test string. Would you rather have a different one? Well, you can define one if you run GDI bench in batch!"</span>);
00156     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>                  = <a class="code" href="../../d0/d2/usrbench_8h.html#a10">DEFAULT_STRING_LENGTH</a>;
00157 
00158     <span class="comment">//  Batch Mode Related</span>
00159 
00160     <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>           = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00161     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a>               = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00162     <a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00163     <a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00164     <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00165     <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a>      = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00166     <a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00167 
00168 <span class="comment">//  GdiSetBatchLimit(1);                // Kills all GDI Batching</span>
00169 
00170 
00171     <span class="comment">// Check for help or batch-mode command-line parameters</span>
00172 
00173 
00174     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-?"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/?"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-h"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-H"</span>) ||<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/h"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/H"</span>))
00175     {
00176         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a15">IDM_HELP</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);       <span class="comment">// Show Help Dialog</span>
00177     }
00178 
00179     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-b"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-B"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/b"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/B"</span>))
00180     {
00181         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00182         GetCurrentDirectory(<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);  <span class="comment">// Prepare INI file path, append name later</span>
00183         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,<span class="stringliteral">"\\"</span>);
00184     }
00185 
00186     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-m"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-M"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/m"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/M"</span>))
00187         <a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00188 
00189     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-s"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-S"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/s"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/S"</span>))
00190         <a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00191 
00192     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-t"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-T"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/t"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/T"</span>))
00193         <a class="code" href="../../d9/d1/usrbench_8c.html#a5">gfUseCycleCount</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00194 
00195     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-d"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-D"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/d"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/D"</span>))
00196         <a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00197 
00198 
00199     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-i"</span>))
00200     {
00201         ptr = strstr(szCmdLine, <span class="stringliteral">"-i"</span>);
00202         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00203         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,txtbuf);
00204     }
00205     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-I"</span>))
00206     {
00207         ptr = strstr(szCmdLine, <span class="stringliteral">"-I"</span>);
00208         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00209         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,txtbuf);
00210     }
00211     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/i"</span>))
00212     {
00213         ptr = strstr(szCmdLine, <span class="stringliteral">"/i"</span>);
00214         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00215         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,txtbuf);
00216     }
00217     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/I"</span>))
00218     {
00219         ptr = strstr(szCmdLine, <span class="stringliteral">"/I"</span>);
00220         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00221         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,txtbuf);
00222     }
00223     <span class="keywordflow">else</span>
00224     {
00225         strcat(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,<span class="stringliteral">"USRBATCH.INI"</span>);
00226     }
00227 
00228     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00229         <span class="comment">/*</span>
00230 <span class="comment">         * Suck any messages out of the queue before starting to avoid</span>
00231 <span class="comment">         * contaminating our results.</span>
00232 <span class="comment">         */</span>
00233         <span class="keywordflow">while</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a14">PeekMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>,<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,0,0,PM_REMOVE))
00234         {
00235             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);
00236             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);
00237         }
00238 
00239         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a13">RUN_BATCH</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);      <span class="comment">// Start Batch</span>
00240     }
00241 
00242     <span class="comment">//</span>
00243     <span class="comment">// Main message loop</span>
00244     <span class="comment">//</span>
00245 
00246     <span class="keywordflow">while</span> (<a class="code" href="../../d0/d8/ntcftxt_8h.html#a16">GetMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>,(HWND)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,0,0))
00247     {
00248         <span class="comment">/*</span>
00249 <span class="comment">         * If a keyboard message is for the MDI, let the MDI client</span>
00250 <span class="comment">         * take care of it.  Otherwise, check to see if it's a normal</span>
00251 <span class="comment">         * accelerator key (like F3 = find next).  Otherwise, just handle</span>
00252 <span class="comment">         * the message as usual.</span>
00253 <span class="comment">         */</span>
00254         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d5/mdiwin_8c.html#a8">TranslateMDISysAccel</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, &amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) &amp;&amp;
00255                 !<a class="code" href="../../d3/d0/user32_8def.html#a57">TranslateAccelerator</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a7">ghaccel</a>, &amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>)) {
00256             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);
00257             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);
00258         }
00259 
00260     }
00261 
00262   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam;
00263 }
00264 
00265 
00266 
00267 LRESULT <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a>
<a name="l00268"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a52">00268</a> PASCAL <a class="code" href="../../d0/d2/usrbench_8h.html#a52">WndProc</a>(
00269     HWND        hWnd,
00270     <span class="keywordtype">unsigned</span>    msg,
00271     WPARAM      wParam,
00272     LPARAM      lParam)
00273 
00274 <span class="comment">/*++</span>
00275 <span class="comment"></span>
00276 <span class="comment">Routine Description:</span>
00277 <span class="comment"></span>
00278 <span class="comment">   Process messages.</span>
00279 <span class="comment"></span>
00280 <span class="comment">Arguments:</span>
00281 <span class="comment"></span>
00282 <span class="comment">   hWnd    - window hande</span>
00283 <span class="comment">   msg     - type of message</span>
00284 <span class="comment">   wParam  - additional information</span>
00285 <span class="comment">   lParam  - additional information</span>
00286 <span class="comment"></span>
00287 <span class="comment">Return Value:</span>
00288 <span class="comment"></span>
00289 <span class="comment">   status of operation</span>
00290 <span class="comment"></span>
00291 <span class="comment"></span>
00292 <span class="comment">Revision History:</span>
00293 <span class="comment"></span>
00294 <span class="comment">      02-17-91      Initial code</span>
00295 <span class="comment"></span>
00296 <span class="comment">--*/</span>
00297 
00298 {
00299 
00300     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00301     UCHAR tmsg[256];
00302     <span class="keywordtype">int</span> MBresult;
00303     <span class="keywordtype">char</span> txtbuf[80];
00304     <span class="keywordtype">char</span> strbuf[256];
00305     <span class="keywordtype">char</span> tmpbuf[5][20];
00306     <span class="keywordtype">int</span> i,j,k,<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
00307     <span class="keywordtype">char</span> *kptr;
00308     <span class="keywordtype">char</span> TestTypeEntry[16];
00309     <span class="keywordtype">int</span> TestType;
00310     <span class="keywordtype">int</span> Num_Selected_Tests;
00311     <span class="keywordtype">int</span> Test_Item[25];
00312     <span class="keywordtype">char</span> SelectedFont[32];
00313     <span class="keywordtype">int</span>  SelectedFontSize       = 12;
00314     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontBold       = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00315     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontItalic     = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00316     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontUnderline  = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00317     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontStrike     = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00318     COLORREF SelectedFontColor  = RGB(0,0,0);
00319     <span class="keywordtype">char</span> tst[2];
00320     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> FontRed, FontGreen, FontBlue;
00321     <span class="keywordtype">char</span> TextString[256];
00322     <span class="keywordtype">int</span> No_String_Lengths, No_Font_Sizes;
00323     <span class="keywordtype">int</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[16], FontSize[16];
00324     <span class="keywordtype">int</span> Source_String_Length;
00325     <span class="keywordtype">int</span> Text_Test_Order[16];
00326     <span class="keywordtype">int</span> VPixelsPerLogInch;
00327     <span class="keyword">static</span> <span class="keywordtype">int</span> Last_Checked = 5;
00328 
00329     <span class="keywordtype">double</span> <a class="code" href="../../d6/d6/ttime_8c.html#a12">Sum</a>;
00330     <span class="keywordtype">double</span> Sample[<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>];
00331 
00332     <span class="keyword">static</span> HDC hdc2;          <span class="comment">/* display DC handle            */</span>
00333     <span class="keyword">static</span> HFONT hfont;       <span class="comment">/* new logical font handle      */</span>
00334     <span class="keyword">static</span> HFONT hfontOld;    <span class="comment">/* original logical font handle */</span>
00335     <span class="keyword">static</span> COLORREF crOld;    <span class="comment">/* original text color          */</span>
00336 
00337 
00338     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00339 
00340     <span class="keywordflow">case</span> WM_CREATE:
00341     {
00342         ULONG ix;
00343         HWND hwnd;
00344         HMENU hAdd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>),1);
00345         HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>),2),0),0);
00346 
00347         <span class="keywordflow">for</span> (ix=0;ix&lt;<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;ix++)
00348         {
00349 
00350             <span class="keywordflow">if</span> ((ix &gt; 0) &amp;&amp; ((ix % 20) == 0))
00351             {
00352                 <a class="code" href="../../d5/d9/cltxt_8h.html#a33">AppendMenu</a>(hAdd, MF_MENUBARBREAK | MF_SEPARATOR,0,0);
00353             }
00354 
00355             wsprintf(tmsg,<span class="stringliteral">"T%i: %s"</span>,ix,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Api);
00356             <a class="code" href="../../d5/d9/cltxt_8h.html#a33">AppendMenu</a>(hAdd, MF_STRING | MF_ENABLED, <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a28">ID_TEST_START</a> + ix, tmsg);
00357         }
00358 
00359         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,5,MF_BYPOSITION|MF_CHECKED);
00360 
00361     }
00362     <span class="keywordflow">break</span>;
00363     <span class="keywordflow">case</span> WM_COMMAND:
00364     {
00365 
00366             <span class="keywordflow">switch</span> (LOWORD(wParam)){
00367             <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>:
00368             {
00369                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_CLOSE,0,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00370             }
00371              <span class="keywordflow">break</span>;
00372 
00373             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a7">IDM_SHOW</a>:
00374                 DialogBox(<a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>, (LPSTR)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a3">IDD_RESULTS</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a20">ResultsDlgProc</a>);
00375                 <span class="keywordflow">break</span>;
00376 
00377             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a15">IDM_HELP</a>:
00378                 DialogBox(<a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>, (LPSTR)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a4">IDD_HELP</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a21">HelpDlgProc</a>);
00379                 <span class="keywordflow">break</span>;
00380 
00381 <span class="comment">//</span>
00382 <span class="comment">// Choose and Set Text String Length</span>
00383 <span class="comment">//</span>
00384 
00385             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a17">IDM_S001</a>:
00386                 {
00387                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 1;
00388                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 0);
00389                 }
00390                 <span class="keywordflow">break</span>;
00391 
00392             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a18">IDM_S002</a>:
00393                 {
00394                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 2;
00395                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 1);
00396 
00397                 }
00398                 <span class="keywordflow">break</span>;
00399 
00400             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a19">IDM_S004</a>:
00401                 {
00402                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 4;
00403                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 2);
00404 
00405                 }
00406                 <span class="keywordflow">break</span>;
00407 
00408             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a20">IDM_S008</a>:
00409                 {
00410                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 8;
00411                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 3);
00412 
00413                 }
00414                 <span class="keywordflow">break</span>;
00415 
00416             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a21">IDM_S016</a>:
00417                 {
00418                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 16;
00419                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 4);
00420 
00421                 }
00422                 <span class="keywordflow">break</span>;
00423 
00424             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a22">IDM_S032</a>:
00425                 {
00426                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 32;
00427                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 5);
00428 
00429                 }
00430                 <span class="keywordflow">break</span>;
00431 
00432             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a23">IDM_S064</a>:
00433                 {
00434                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 64;
00435                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 6);
00436 
00437                 }
00438                 <span class="keywordflow">break</span>;
00439 
00440             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a24">IDM_S128</a>:
00441                 {
00442                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 128;
00443                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, 7);
00444 
00445                 }
00446                 <span class="keywordflow">break</span>;
00447 
00448 <span class="comment">//            case IDM_SXXX:</span>
00449 <span class="comment">//</span>
00450 <span class="comment">//            break;</span>
00451 
00452             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a27">IDM_TRANSPARENT</a>:
00453                 {
00454                     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>),2),0);
00455                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00456                     {
00457                         <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00458                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_UNCHECKED);
00459                     }
00460                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)
00461                     {
00462                         <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00463                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_CHECKED);
00464                     }
00465                 }
00466                 <span class="keywordflow">break</span>;
00467 
00468 
00469             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a26">IDM_FONT</a>:         <span class="comment">// Invoke the ChooseFont Dialog (interactive mode)</span>
00470                 {
00471         <span class="comment">/* Initialize the necessary members */</span>
00472 
00473                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lStructSize = <span class="keyword">sizeof</span> (CHOOSEFONT);
00474                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00475                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont = &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
00476                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS | CF_INITTOLOGFONTSTRUCT;
00477                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.nFontType = SCREEN_FONTTYPE;
00478 <span class="comment">/*</span>
00479 <span class="comment"> * Display the dialog box, allow the user to</span>
00480 <span class="comment"> * choose a font, and render the text in the</span>
00481 <span class="comment"> * window with that selection.</span>
00482 <span class="comment"> */</span>
00483                     <span class="keywordflow">if</span> (ChooseFont(&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>)){
00484                         hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00485                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00486                         hfontOld = SelectObject(hdc2, hfont);
00487                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00488 
00489                     }
00490 
00491                 }
00492                 <span class="keywordflow">break</span>;
00493 
00494             <span class="comment">//</span>
00495             <span class="comment">// Run all tests</span>
00496             <span class="comment">//</span>
00497 
00498             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a10">IDM_RUN</a>:               <span class="comment">// Run all tests</span>
00499                 {
00500                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00501                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00502                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00503                     RECT CliRect = {20,20,500,40};
00504 
00505                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00506                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, WM_MDICREATE, 0, (LPARAM)&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>); <span class="comment">//Create Test Object</span>
00507 
00508                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>&lt;<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00509                     {
00510                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00511 
00512                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00513                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Api);
00514                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00515                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00516                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00517 
00518                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00519                         hfontOld = SelectObject(hdc2, hfont);
00520                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00521                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00522 
00524 
00525                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00526                         {
00527 
00528                             GdiFlush();
00529 
00530                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00531                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00532                         }
00533 
00534                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,<a class="code" href="../../d7/d5/stats_8h.html#a0">HI_FILTER</a>,<a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>,&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>]);
00536 
00537                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00538 
00539                         SetTextColor(hdc, crOld);
00540                         SelectObject(hdc, hfontOld);
00541                         DeleteObject(hfont);
00542                         SetBkMode(hdc2,OPAQUE);
00543 
00544                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc2);
00545                     }
00546 
00547                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc);
00548                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00549                         DialogBox(<a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>, (LPSTR)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a3">IDD_RESULTS</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a20">ResultsDlgProc</a>);
00550                 }
00551                 <span class="keywordflow">break</span>;
00552 
00553             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a11">IDM_QRUN1</a>:             <span class="comment">// Run the quick test suite 1</span>
00554                 {
00555                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00556                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00557                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00558                     RECT CliRect = {20,20,500,40};
00559 
00560 
00561                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00562                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, WM_MDICREATE, 0, (LPARAM)&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>); <span class="comment">//Create Test Object</span>
00563 
00564                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a19">NUM_QTESTS</a>;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00565                     {
00566                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00567 
00568                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00569                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Api);
00570                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00571                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00572                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00573 
00574                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00575                         hfontOld = SelectObject(hdc2, hfont);
00576                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00577                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00578 
00580 
00581                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00582                         {
00583 
00584                             GdiFlush();
00585 
00586                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00587                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00588                         }
00589 
00590                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,<a class="code" href="../../d7/d5/stats_8h.html#a0">HI_FILTER</a>,<a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>,&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>]);
00592 
00593 
00594                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00595 
00596                         SetTextColor(hdc, crOld);
00597                         SelectObject(hdc, hfontOld);
00598                         DeleteObject(hfont);
00599                         SetBkMode(hdc2,OPAQUE);
00600                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc2);
00601                     }
00602 
00603                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc);
00604 
00605                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00606                         DialogBox(<a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>, (LPSTR)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a3">IDD_RESULTS</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a20">ResultsDlgProc</a>);
00607                 }
00608                 <span class="keywordflow">break</span>;
00609 
00610             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a12">IDM_QRUN2</a>:         <span class="comment">// Run Quick Test Suite 2</span>
00611                 {
00612                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00613                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00614                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00615                     RECT CliRect = {20,20,500,40};
00616 
00617                     <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00618 
00619                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00620                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, WM_MDICREATE, 0, (LPARAM)&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>); <span class="comment">//Create Test Object</span>
00621 
00622                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a8">FIRST_TEXT_FUNCTION</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt;= <a class="code" href="../../d0/d2/usrbench_8h.html#a9">LAST_TEXT_FUNCTION</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00623                     {
00624                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00625 
00626                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00627                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Api);
00628                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00629                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00630                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00631 
00632                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00633                         hfontOld = SelectObject(hdc2, hfont);
00634                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00635                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00637 
00638                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00639                         {
00640 
00641                             GdiFlush();
00642 
00643                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00644                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00645 
00646                         }
00647 
00648                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,<a class="code" href="../../d7/d5/stats_8h.html#a0">HI_FILTER</a>,<a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>,&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>]);
00650 
00651                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00652                         SetTextColor(hdc, crOld);
00653                         SelectObject(hdc, hfontOld);
00654                         DeleteObject(hfont);
00655                         SetBkMode(hdc2,OPAQUE);
00656 
00657                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc2);
00658 
00659                     }
00660 
00661                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc);
00662 
00663                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00664                         DialogBox(<a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>, (LPSTR)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a3">IDD_RESULTS</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d9/d1/usrbench_8c.html#a20">ResultsDlgProc</a>);
00665 
00666                 }
00667                 <span class="keywordflow">break</span>;
00668 
00669 <span class="comment">//</span>
00670 <span class="comment">// Run in Batch Mode</span>
00671 <span class="comment">//</span>
00672             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a13">RUN_BATCH</a>:
00673                 {
00674                     <a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a> = fopen(<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>,<span class="stringliteral">"r"</span>);
00675                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>)
00676                     {
00677                         MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"USRBATCH.INI File Not Found, Cannot Continue in Batch Mode"</span>,<span class="stringliteral">"INI File Not Found"</span>,MB_ICONSTOP|MB_OK);
00678                         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00679                         <span class="keywordflow">break</span>;
00680                     }
00681                     <span class="keywordflow">else</span>                    <span class="comment">//Start reading INI file Keys</span>
00682 
00683                     {
00684                         <span class="keywordflow">if</span>(!GetPrivateProfileString(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"TEXT"</span>,TestTypeEntry,<span class="keyword">sizeof</span>(TestTypeEntry),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>))
00685                         {
00686                             MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid Caption 1 in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00687                             <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00688                             <span class="keywordflow">break</span>;
00689                         }
00690 
00691                         <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a> = GetPrivateProfileInt(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"CYCLE"</span>,1,<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00692 
00693                         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"ALL"</span>))
00694                         {
00695                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a13">ALL</a>;
00696                         }
00697                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"QUICK"</span>))
00698                         {
00699                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a14">QUICK</a>;
00700                         }
00701                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"TEXT"</span>))
00702                         {
00703                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a>;
00704                         }
00705                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"SELECT"</span>))
00706                         {
00707                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a16">SELECT</a>;
00708                         }
00709                         <span class="keywordflow">else</span>
00710                         {
00711                             MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid or No Test-Type Entry in USRBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00712                             <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00713                             <span class="keywordflow">break</span>;
00714                         }
00715 
00716                         <span class="keywordflow">switch</span> (TestType)
00717                         {
00718                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a13">ALL</a>:                   <span class="comment">// Run all tests</span>
00719                             {
00720                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>);
00721                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00722                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
00723                                 {
00724                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00725                                     <span class="keywordflow">break</span>;
00726                                 }
00727                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>, <span class="stringliteral">"w+"</span>);
00728 
00729                                 <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; i++)
00730                                 {
00731                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a10">IDM_RUN</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00732                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>, TestType, i+1);
00733                                 }
00734 
00735                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>);
00736 
00737                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00738                                 {
00739                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
00740                                     strcat(txtbuf,<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>);
00741                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
00742                                 }
00743 
00744                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00745                                 {
00746                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00747                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
00748                                     {
00749                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
00750                                     }
00751                                 }
00752                                 <span class="keywordflow">else</span>
00753                                 {
00754                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00755                                 }
00756 
00757                             }
00758 
00759                             <span class="keywordflow">break</span>;
00760 
00761                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a14">QUICK</a>:                 <span class="comment">// Run the quick suite</span>
00762                             {
00763                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>);
00764 
00765                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00766 
00767                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>, <span class="stringliteral">"w+"</span>);
00768                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>)
00769                                 {
00770                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00771                                     <span class="keywordflow">break</span>;
00772                                 }
00773 
00774                                 <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; i++)
00775                                 {
00776                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a11">IDM_QRUN1</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00777                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>, TestType, i+1);
00778                                 }
00779 
00780                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>);
00781 
00782                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00783                                 {
00784                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
00785                                     strcat(txtbuf,<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>);
00786                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
00787                                 }
00788 
00789                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00790                                 {
00791                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00792                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
00793                                     {
00794                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
00795                                     }
00796                                 }
00797                                 <span class="keywordflow">else</span>
00798                                 {
00799                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00800                                 }
00801 
00802                             }
00803                             <span class="keywordflow">break</span>;
00804 
00805                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a>:                    <span class="comment">// Get some more keys then run the text suite</span>
00806                             {
00807 
00808                                 <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = GetPrivateProfileString(<span class="stringliteral">"TEXT"</span>,<span class="stringliteral">"FONT"</span>,<span class="stringliteral">"Arial"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00809 
00810                                 i = 0;
00811 
00812                                 <span class="keywordflow">do</span>
00813                                 {
00814                                     sscanf(&amp;txtbuf[i],<span class="stringliteral">"%1c"</span>,tst);
00815                                     ++i;
00816                                 }
00817                                 <span class="keywordflow">while</span>((i &lt;= <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> ) &amp;&amp; (tst[0] != <span class="charliteral">','</span>) &amp;&amp; (tst[0] != <span class="charliteral">';'</span>));
00818 
00819                                 strncpy(&amp;SelectedFont[0],&amp;txtbuf[0],i-1);
00820                                 strcpy(&amp;SelectedFont[i-1],<span class="stringliteral">"\0"</span>);
00821 
00822                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"BOLD"</span>))
00823                                 {
00824                                     SelectedFontBold = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00825                                 }
00826 
00827                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"ITALIC"</span>))
00828                                 {
00829                                     SelectedFontItalic = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00830                                 }
00831 
00832                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"UNDERLINE"</span>))
00833                                 {
00834                                     SelectedFontUnderline = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00835                                 }
00836 
00837                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"STRIKE"</span>))
00838                                 {
00839                                     SelectedFontStrike = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00840                                 }
00841 
00842                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"TRANSPARENT"</span>))
00843                                 {
00844                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00845                                 }
00846 
00847                                 kptr = strstr(&amp;txtbuf[0], <span class="stringliteral">"RGB("</span>);   <span class="comment">// Parse and interpret the RGB values if exist</span>
00848                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != kptr)
00849                                 {
00850                                     sscanf(kptr+4,<span class="stringliteral">"%s"</span>,tmpbuf[0]);
00851 
00852                                     FontRed     = 0;
00853                                     FontGreen   = 0;
00854                                     FontBlue    = 0;
00855 
00856                                     j = 0;
00857 
00858                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00859 
00860                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00861                                     {
00862                                         ++j;
00863                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00864                                     }
00865                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">','</span>)
00866                                     {
00867                                         FontRed = 10*FontRed + atoi(tst);
00868                                         ++j;
00869                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00870                                     }
00871 
00872                                     ++j;
00873                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00874                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00875                                     {
00876                                         ++j;
00877                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00878                                     }
00879                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">','</span>)
00880                                     {
00881                                         FontGreen = 10*FontGreen + atoi(tst);
00882                                         ++j;
00883                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00884                                     }
00885 
00886                                     ++j;
00887                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00888                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00889                                     {
00890                                         ++j;
00891                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00892                                     }
00893                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">')'</span>)
00894                                     {
00895                                         FontBlue = 10*FontBlue + atoi(tst);
00896                                         ++j;
00897                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00898                                         <span class="keywordflow">if</span>(tst[0] == <span class="charliteral">' '</span>)<span class="keywordflow">break</span>;
00899                                     }
00900 
00901                                     SelectedFontColor = RGB(FontRed, FontGreen, FontBlue);
00902                                 }
00903 
00904                                 k = GetPrivateProfileString(<span class="stringliteral">"TEXT"</span>,<span class="stringliteral">"STRING_CONTENT"</span>,<a class="code" href="../../d0/d2/usrbench_8h.html#a11">DEFAULT_A_STRING</a>,strbuf,<span class="keyword">sizeof</span>(strbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00905 
00906                                 strncpy(<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>,strbuf,(size_t)k);
00907                                 Source_String_Length = k;
00908 
00909                                 MultiByteToWideChar(CP_ACP|CP_OEMCP,0,<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>,-1,<a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>,<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>));
00910 
00911                                 <span class="keywordflow">for</span>(j=0; j&lt;2; j++)
00912                                     Text_Test_Order[j] = 0;
00913 
00914                                 GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"ORDER"</span>,<span class="stringliteral">"FONT_SIZE, STRING_LENGTH"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00915                                 <span class="keywordflow">if</span>(strstr(txtbuf,<span class="stringliteral">"STRING_LENGTH"</span>) &gt; strstr(txtbuf,<span class="stringliteral">"FONT_SIZE"</span>))
00916                                 {
00917                                     Text_Test_Order[0] = 1;
00918                                     Text_Test_Order[1] = 2;
00919                                 }
00920                                 <span class="keywordflow">else</span>
00921                                 {
00922                                     Text_Test_Order[0] = 2;
00923                                     Text_Test_Order[1] = 1;
00924                                 }
00925 
00926                                 k = GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"STRING_LENGTH"</span>,<span class="stringliteral">"32"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00927                                 No_String_Lengths = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>);
00928 
00929                                 <span class="keywordflow">if</span>(No_String_Lengths==0)
00930                                 {
00931                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid or No String Length Entry in GDIBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00932                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00933                                     <span class="keywordflow">break</span>;
00934                                 }
00935 
00936                                 k = GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"FONT_SIZE"</span>,<span class="stringliteral">"10"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
00937                                 No_Font_Sizes = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, FontSize);
00938 
00939                                 <span class="keywordflow">if</span>(No_Font_Sizes==0)
00940                                 {
00941                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid or No Font Size Entry in GDIBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00942                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00943                                     <span class="keywordflow">break</span>;
00944                                 }
00945 
00946                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>);
00947 
00948     <span class="comment">// Initialize the LOGFONT struct</span>
00949 
00950                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWidth          = 0;
00951                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfEscapement     = 0;
00952                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfOrientation    = 0;
00953                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWeight         = (SelectedFontBold == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)? 400 : 700;
00954                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfItalic         = SelectedFontItalic;
00955                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfUnderline      = SelectedFontUnderline;
00956                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfStrikeOut      = SelectedFontStrike;
00957                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfCharSet        = ANSI_CHARSET;
00958                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfOutPrecision   = OUT_DEFAULT_PRECIS;
00959                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfClipPrecision  = CLIP_DEFAULT_PRECIS;
00960                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfQuality        = DEFAULT_QUALITY;
00961                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfPitchAndFamily = DEFAULT_PITCH | FF_DONTCARE;
00962                                 lstrcpy(&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0],&amp;SelectedFont[0]);
00963 
00964     <span class="comment">// Get some necessary font information for the present screen to be able to determine its height</span>
00965 
00966                                 hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00967                                 GetTextFace(hdc2, <span class="keyword">sizeof</span>(SelectedFont), &amp;SelectedFont[0]);
00968                                 VPixelsPerLogInch = GetDeviceCaps(hdc2, LOGPIXELSY);
00969                                 <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc2);
00970 
00971     <span class="comment">// Some more font initialization</span>
00972 
00973                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lStructSize      = <span class="keyword">sizeof</span> (CHOOSEFONT);
00974                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.hwndOwner        = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00975                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont        = &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
00976                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.Flags            = CF_SCREENFONTS | CF_EFFECTS | CF_INITTOLOGFONTSTRUCT;
00977                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.nFontType        = SCREEN_FONTTYPE;
00978                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors        = SelectedFontColor;
00979 
00980     <span class="comment">// Auto Select an output file name</span>
00981 
00982                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00983                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>, <span class="stringliteral">"w+"</span>);
00984                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
00985                                 {
00986                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Could not Open an Output File, Batch Mode Halted"</span>, <span class="stringliteral">"Output Open File Error"</span>,MB_ICONSTOP|MB_OK);
00987                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00988                                     <span class="keywordflow">break</span>;
00989                                 }
00990 
00991     <span class="comment">// Execute Text Suite, Depending on the Predefined Order of Loops</span>
00992 
00993                                 <span class="keywordflow">if</span>(Text_Test_Order[1] == 1)
00994                                 {
00995 
00996                                     <span class="keywordflow">for</span>(i = 0; i &lt; No_String_Lengths; i++)
00997                                     {
00998                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[i];
00999                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a> = (<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> &lt;= (size_t)Source_String_Length)? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01000                                         strcpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>],<span class="stringliteral">"\0"</span>);
01001                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[0], <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01002                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a36">DestStringW</a>[0], <a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01003 
01004                                         <span class="keywordflow">for</span>(j = 0; j &lt; No_Font_Sizes; j++)
01005                                         {
01006                                             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfHeight = -MulDiv(FontSize[j], VPixelsPerLogInch, <a class="code" href="../../d7/d6/font_8h.html#a5">POINTS_PER_INCH</a>);
01007                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize = 10*FontSize[j];  <span class="comment">// Point Size is in 1/10 of a point</span>
01008 
01009                                             <span class="keywordflow">for</span>(k=0; k &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; k++)
01010                                             {
01011                                                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a12">IDM_QRUN2</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01012                                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>, TestType, k+1);
01013                                             }
01014 
01015                                         }
01016 
01017                                     }
01018 
01019                                 }               <span class="comment">//endif</span>
01020 
01021                                 <span class="keywordflow">else</span>
01022                                 {
01023 
01024                                     <span class="keywordflow">for</span>(i = 0; i &lt; No_Font_Sizes; i++)
01025                                     {
01026 
01027                                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfHeight = -MulDiv(FontSize[i], VPixelsPerLogInch, <a class="code" href="../../d7/d6/font_8h.html#a5">POINTS_PER_INCH</a>);
01028                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize = 10*FontSize[i];  <span class="comment">// Point Size is in 1/10 of a point</span>
01029 
01030                                         <span class="keywordflow">for</span>(j = 0; j &lt; No_String_Lengths; j++)
01031                                         {
01032                                             <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[j];
01033                                             <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a> = (<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> &lt;= (size_t)Source_String_Length)? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01034                                             strcpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>],<span class="stringliteral">"\0"</span>);
01035                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[0], <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01036                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a36">DestStringW</a>[0], <a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01037 
01038                                             <span class="keywordflow">for</span>(k=0; k &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; k++)
01039                                             {
01040                                                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a12">IDM_QRUN2</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01041                                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>, TestType, k+1);
01042                                             }
01043 
01044                                         }
01045 
01046                                     }
01047 
01048                                 }                <span class="comment">//else</span>
01049 
01050     <span class="comment">// Cleanup</span>
01051                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>);
01052 
01053                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01054                                 {
01055                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
01056                                     strcat(txtbuf,<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>);
01057                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
01058                                 }
01059 
01060                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)<span class="comment">// App Stays Open, Check Appropriate Menu Items for Last Selection</span>
01061                                 {
01062                                     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>),2),0);
01063                                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01064                                     {
01065                                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_CHECKED);
01066                                     }
01067 
01068                                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> == 1)i=0;
01069                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     2)i=1;
01070                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     4)i=2;
01071                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     8)i=3;
01072                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    16)i=4;
01073                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    32)i=5;
01074                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    64)i=6;
01075                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==   128)i=7;
01076                                     <span class="keywordflow">else</span>
01077                                     {
01078                                         i = 8;                         <span class="comment">// "Other" non-standard menu selection</span>
01079                                     }
01080                                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, Last_Checked, i);
01081 
01082                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01083                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
01084                                     {
01085                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
01086                                     }
01087 
01088                                 }
01089                                 <span class="keywordflow">else</span>
01090                                 {
01091                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01092                                 }
01093 
01094                             }             <span class="comment">//case TEXT_SUITE</span>
01095 
01096                             <span class="keywordflow">break</span>;
01097 
01098                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a16">SELECT</a>:        <span class="comment">// Read some more keys then run the selected test suite</span>
01099                             {
01100 
01101                                 k = GetPrivateProfileString(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"TEST"</span>,<span class="stringliteral">"0"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),<a class="code" href="../../d0/d2/usrbench_8h.html#a49">IniFileName</a>);
01102                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>);
01103 
01104                                 Num_Selected_Tests = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, Test_Item);
01105 
01106                                 <span class="keywordflow">if</span>(Num_Selected_Tests == 0)
01107                                 {
01108                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid Test-Number Entry in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
01109                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01110                                     <span class="keywordflow">break</span>;
01111                                 }
01112 
01113                                 <span class="keywordflow">for</span>(i=0; i&lt;Num_Selected_Tests; i++)
01114                                 {
01115                                     <span class="keywordflow">if</span>(Test_Item[i] &gt; (<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>)
01116                                     {
01117                                         MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Invalid Test-Number Entry in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
01118                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01119                                         <span class="keywordflow">break</span>;
01120                                     }
01121                                 }
01122 
01123                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
01124                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
01125                                 {
01126                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01127                                     <span class="keywordflow">break</span>;
01128                                 }
01129                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>, <span class="stringliteral">"w+"</span>);
01130 
01131                                 <span class="keywordflow">for</span>(j=0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; j++)
01132                                 {
01133                                     <span class="keywordflow">for</span>(i=0; i &lt; Num_Selected_Tests; i++)
01134                                     {
01135                                         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a28">ID_TEST_START</a>+Test_Item[i],0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01136                                     }
01137 
01138                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>, TestType, i+1);
01139                                 }
01140 
01141                                 fclose(<a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>);
01142 
01143                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01144                                 {
01145                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
01146                                     strcat(txtbuf,<a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>);
01147                                     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
01148                                 }
01149 
01150                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01151                                 {
01152                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01153                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
01154                                     {
01155                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
01156                                     }
01157                                 }
01158                                 <span class="keywordflow">else</span>
01159                                 {
01160                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,WM_COMMAND,<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>,0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01161                                 }
01162 
01163                             }
01164                             <span class="keywordflow">break</span>;
01165 
01166                         }       <span class="comment">// switch TestType</span>
01167 
01168                     }           <span class="comment">//else (RUN_BATCH - OK to Proceed)</span>
01169 
01170                 }               <span class="comment">// case RUN_BATCH</span>
01171                 <span class="keywordflow">break</span>;
01172 
01173             <span class="comment">//</span>
01174             <span class="comment">// run a single selected test (interactive mode)</span>
01175             <span class="comment">//</span>
01176 
01177             <span class="keywordflow">default</span>:
01178 
01179                 {
01180                     ULONG <a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a> = LOWORD(wParam) - <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a28">ID_TEST_START</a>;
01181                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01182                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
01183                     RECT CliRect = {0,0,10000,10000};
01184                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
01185                     <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
01186 
01187                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
01188                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, WM_MDICREATE, 0, (LPARAM)&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>); <span class="comment">//Create Test Object</span>
01189 
01190                     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a> &lt; <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>)
01191                     {
01192                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
01193 
01194                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>].Api);
01195                         TextOut(hdc,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
01196 
01197                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
01198                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01199 
01200                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
01201                         hfontOld = SelectObject(hdc2, hfont);
01202                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
01203                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
01204 
01206                         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>;
01207                         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
01208                         {
01209 
01210                             GdiFlush();
01211 
01212                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
01213                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
01214                             <span class="keywordflow">if</span> (Sample[j] == 0) {
01215                                 <span class="comment">// error occurred</span>
01216                                 <span class="keywordflow">break</span>;
01217                             }
01218 
01219                         }
01220 
01221                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,<a class="code" href="../../d7/d5/stats_8h.html#a0">HI_FILTER</a>,<a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>,&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>]);
01223 
01224                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01225 
01226                         SetTextColor(hdc2, crOld);
01227                         SelectObject(hdc2, hfontOld);
01228                         DeleteObject(hfont);
01229                         SetBkMode(hdc2, OPAQUE);
01230 
01231                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc2);
01232                         <span class="comment">// HIRO</span>
01233                         wsprintf(tmsg,<span class="stringliteral">"Finished %s"</span>,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>].Api);
01234                         TextOut(hdc,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
01235                     }
01236 
01237                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,hdc);
01238                 }
01239 
01240             }       <span class="comment">// SWITCH CASE</span>
01241 
01242 
01243             <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)               <span class="comment">// Initialize Test Strings (interactive mode)</span>
01244             {
01245                 <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(<a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01246                 <a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>] = <span class="charliteral">'\0'</span>;
01247                 <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(<a class="code" href="../../d0/d2/usrbench_8h.html#a36">DestStringW</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a34">SourceStringW</a>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01248                 <a class="code" href="../../d0/d2/usrbench_8h.html#a36">DestStringW</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
01249             }
01250 
01251         }       <span class="comment">// WM_COMMAND</span>
01252         <span class="keywordflow">break</span>;
01253 
01254     <span class="keywordflow">case</span> WM_PAINT:
01255         {
01256             PAINTSTRUCT ps;
01257             HDC hDC = <a class="code" href="../../d3/d0/user32_8def.html#a41">BeginPaint</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,&amp;ps);
01258             EndPaint(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,&amp;ps);
01259         }
01260         <span class="keywordflow">break</span>;
01261 
01262     <span class="keywordflow">case</span> WM_DESTROY:
01263             <a class="code" href="../../d3/d8/client_8c.html#a122">PostQuitMessage</a>(0);
01264             <span class="keywordflow">break</span>;
01265 
01266     <span class="keywordflow">default</span>:
01267 
01268         <span class="comment">//</span>
01269         <span class="comment">// Passes message on if unproccessed</span>
01270         <span class="comment">//</span>
01271         <span class="comment">/*</span>
01272 <span class="comment">         * Use DefFrameProc() instead of DefWindowProc() since there are</span>
01273 <span class="comment">         * things that have to be handled differently because of MDI.</span>
01274 <span class="comment">         */</span>
01275         <span class="keywordflow">return</span> DefFrameProc(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>, wParam, lParam);
01276 
01277     }
01278 
01279 <span class="comment">/* Calculate Timer Frequency For Current Machine and Convert to MicroSeconds (Actual time will be presented in units of 100ns) */</span>
01280 
01281     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = QueryPerformanceFrequency((LARGE_INTEGER *)&amp;<a class="code" href="../../d0/d2/usrbench_8h.html#a31">PerformanceFreq</a>);
01282     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>){
01283            <a class="code" href="../../d0/d2/usrbench_8h.html#a31">PerformanceFreq</a> /= 10000;<span class="comment">//PerformanceFreq is in Counts/Sec.</span>
01284                                     <span class="comment">//Dividing it by 1,000,000 gives Counts/nanosecond</span>
01285     }                               <span class="comment">//Dividing it by 10,000 gives Counts/(100 nanosecond unit)</span>
01286     <span class="keywordflow">else</span>
01287     {
01288             MessageBox(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01289                <span class="stringliteral">"High Resolution Performance Counter Doesn't Seem to be Supported on This Machine"</span>,
01290                <span class="stringliteral">"Warning"</span>, MB_OK | MB_ICONEXCLAMATION);
01291 
01292             <a class="code" href="../../d0/d2/usrbench_8h.html#a31">PerformanceFreq</a> = 1;                <span class="comment">/* To Prevent Possible Div by zero later */</span>
01293     }
01294 
01295 
01296     <span class="keywordflow">return</span> ((LRESULT)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01297 }
01298 
01299 
01300 <span class="comment">/*++</span>
01301 <span class="comment"></span>
01302 <span class="comment">Routine Description:</span>
01303 <span class="comment"></span>
01304 <span class="comment">    Save results to file</span>
01305 <span class="comment"></span>
01306 <span class="comment">Arguments</span>
01307 <span class="comment"></span>
01308 <span class="comment">    none</span>
01309 <span class="comment"></span>
01310 <span class="comment">Return Value</span>
01311 <span class="comment"></span>
01312 <span class="comment">    none</span>
01313 <span class="comment"></span>
01314 <span class="comment">--*/</span>
01315 
01316 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l01317"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a59">01317</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a19">SaveResults</a>()
01318 {
01319     <span class="keyword">static</span> OPENFILENAME ofn;
01320     <span class="keyword">static</span> <span class="keywordtype">char</span> szFilename[80];
01321     <span class="keywordtype">char</span> szT[80];
01322     <span class="keywordtype">int</span> i, hfile;
01323     FILE *fpOut;
01324 
01325     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01326 
01327     <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(ofn); i++)
01328     {
01329         <span class="comment">//</span>
01330         <span class="comment">// clear out the OPENFILENAME struct</span>
01331         <span class="comment">//</span>
01332 
01333         ((<span class="keywordtype">char</span> *)&amp;ofn)[i] = 0;
01334     }
01335 
01336     ofn.lStructSize = <span class="keyword">sizeof</span>(ofn);
01337     ofn.hwndOwner = <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>;
01338     ofn.hInstance = <a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>;
01339 
01340     ofn.lpstrFilter = <span class="stringliteral">"USRBench (*.cs;*.km)\0*.cs;*.km\0All Files\0*.*\0\0"</span>;
01341     ofn.lpstrCustomFilter = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01342     ofn.nMaxCustFilter = 0;
01343     ofn.nFilterIndex = 0;
01344     ofn.lpstrFileTitle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01345     ofn.nMaxFileTitle = 0;
01346     ofn.lpstrInitialDir = <span class="stringliteral">"C:\\"</span>;
01347     ofn.Flags = 0;
01348     ofn.lpstrDefExt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01349     ofn.lCustData = 0;
01350     ofn.lpfnHook = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01351     ofn.lpTemplateName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01352 
01353     lstrcpy(szFilename, <span class="stringliteral">"USRB001.km"</span>);
01354 
01355     ofn.lpstrFile = szFilename;
01356     ofn.nMaxFile = <span class="keyword">sizeof</span>(szFilename);
01357     ofn.lpstrTitle = <span class="stringliteral">"Save As"</span>;
01358 
01359     <span class="keywordflow">if</span> (!GetSaveFileName(&amp;ofn))
01360     {
01361         <span class="keywordflow">return</span>;
01362     }
01363 
01364     fpOut = fopen(szFilename, <span class="stringliteral">"w+"</span>);
01365     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != fpOut)
01366     {
01367         <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOut,0,0);
01368         fclose(fpOut);
01369     }
01370     <span class="keywordflow">else</span>
01371     {
01372         MessageBox(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>,<span class="stringliteral">"Cannot Open File to Save Results"</span>, <span class="stringliteral">"Output File Creation Error"</span>,MB_ICONSTOP|MB_OK);
01373     }
01374 
01375 }
01376 
01377 
01378 
01379 
01380 <span class="comment">/*++</span>
01381 <span class="comment"></span>
01382 <span class="comment">Routine Description:</span>
01383 <span class="comment"></span>
01384 <span class="comment">    Show results  (Interactive Mode Dialog)</span>
01385 <span class="comment"></span>
01386 <span class="comment">Arguments</span>
01387 <span class="comment"></span>
01388 <span class="comment">    Std dlg</span>
01389 <span class="comment"></span>
01390 <span class="comment">Return Value</span>
01391 <span class="comment"></span>
01392 <span class="comment">    Status</span>
01393 <span class="comment"></span>
01394 <span class="comment">--*/</span>
01395 
01396 INT_PTR
01397 <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a>
<a name="l01398"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a57">01398</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a57">ResultsDlgProc</a>(
01399     HWND hwnd,
01400     UINT msg,
01401     WPARAM wParam,
01402     LPARAM lParam)
01403 {
01404     ULONG ix;
01405     <span class="keywordtype">char</span> szT[180];
01406     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fResults;
01407     <span class="keywordtype">int</span> aiT[2];
01408 
01409     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01410     <span class="keywordflow">case</span> WM_INITDIALOG:
01411         aiT[0] = 100;
01412         aiT[1] = 190;
01413         fResults = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01414 
01415         {
01416             LV_COLUMN lvc;
01417             LV_ITEM lvl;
01418             <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> width;
01419             RECT rc;
01420             HWND hwndList = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a5">IDC_RESULTSLIST</a>);
01421             <span class="keywordtype">int</span> i;
01422             <span class="keyword">static</span> LPCSTR title[] = {
01423                 <span class="stringliteral">"Function"</span>, <span class="stringliteral">"Time(100ns)"</span>, <span class="stringliteral">"StdDev%"</span>, <span class="stringliteral">"Best"</span>, <span class="stringliteral">"Worst"</span>,
01424                 <span class="stringliteral">"Valid Samples"</span>, <span class="stringliteral">"Out of"</span>, <span class="stringliteral">"Iterations"</span>,
01425             };
01426 <span class="preprocessor">#ifdef _X86_</span>
01427 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a23">gfPentium</a>)
01428                 title[1] = <span class="stringliteral">"Cycle Counts"</span>;
01429 <span class="preprocessor">#endif</span>
01430 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (hwndList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01431                 <span class="keywordflow">break</span>;
01432             <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(hwndList, &amp;rc);
01433             <span class="comment">// only first column has doubled width</span>
01434             lvc.cx = (width = (rc.right - rc.left) / (<span class="keyword">sizeof</span> title / <span class="keyword">sizeof</span> *title + 1)) * 2;
01435             lvc.mask = LVCF_FMT | LVCF_WIDTH | LVCF_TEXT | LVCF_SUBITEM;
01436             lvc.fmt = LVCFMT_LEFT;
01437             <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span> title / <span class="keyword">sizeof</span> *title; ++i) {
01438                 lvc.pszText = (LPSTR)title[i];
01439                 ListView_InsertColumn(hwndList, i, &amp;lvc);
01440                 lvc.cx = width;     <span class="comment">// normal width</span>
01441             }
01442 
01443             lvl.iItem = 0;
01444             lvl.mask = LVIF_TEXT;
01445             <span class="keywordflow">for</span> (ix = 0; ix &lt; <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; ix++) {
01446                 <span class="keywordflow">if</span> ((<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o0">Average</a>) == 0) {
01447                     <span class="comment">// no measuement, skip</span>
01448                     <span class="keywordflow">continue</span>;
01449                 }
01450                 lvl.iSubItem = 0;
01451                 lvl.pszText = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o0">Api</a>;
01452                 ListView_InsertItem(hwndList, &amp;lvl);
01453 <span class="preprocessor">#define SUBITEM(fmt, v) \</span>
01454 <span class="preprocessor">                sprintf(szT, fmt, v); \</span>
01455 <span class="preprocessor">                ListView_SetItemText(hwndList, lvl.iItem, ++lvl.iSubItem, szT);</span>
01456 <span class="preprocessor"></span>
01457                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Average));
01458                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%.2f"</span>, (<span class="keywordtype">float</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].StdDev);
01459                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Minimum_Result));
01460                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Maximum_Result));
01461                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].NumSamplesValid);
01462                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>);
01463                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Iter);
01464 <span class="preprocessor">#undef SUBITEM</span>
01465 <span class="preprocessor"></span>                ++lvl.iItem;
01466                 fResults = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01467             }
01468 
01469             <span class="keywordflow">if</span> (!fResults)
01470                 MessageBox(hwnd, <span class="stringliteral">"No results have been generated yet or Test may have failed!"</span>,
01471                     <span class="stringliteral">"UsrBench"</span>, MB_OK | MB_ICONEXCLAMATION);
01472         }
01473         <span class="keywordflow">break</span>;
01474 
01475     <span class="keywordflow">case</span> WM_COMMAND:
01476         <span class="keywordflow">switch</span> (LOWORD(wParam)) {
01477         <span class="keywordflow">case</span> IDOK:
01478         <span class="keywordflow">case</span> IDCANCEL:
01479             <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hwnd, 0);
01480             <span class="keywordflow">break</span>;
01481 
01482         <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a6">IDM_SAVERESULTS</a>:
01483             <a class="code" href="../../d9/d1/usrbench_8c.html#a19">SaveResults</a>();
01484             <span class="keywordflow">break</span>;
01485 
01486         <span class="keywordflow">default</span>:
01487             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01488         }
01489         <span class="keywordflow">break</span>;
01490 
01491     <span class="keywordflow">default</span>:
01492         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01493     }
01494 
01495     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01496 }
01497 
01498 INT_PTR
01499 <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a>
<a name="l01500"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a58">01500</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a58">HelpDlgProc</a>(
01501     HWND hwnd,
01502     UINT msg,
01503     WPARAM wParam,
01504     LPARAM lParam)
01505 {
01506     ULONG ix, last_ix;
01507     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* szT[] = {
01508         <span class="stringliteral">"Usage:"</span>,
01509         <span class="stringliteral">"usrbench (interactive mode), or "</span>,
01510         <span class="stringliteral">"usrbench /b (batch mode)"</span>,
01511         <span class="stringliteral">"         /d (Print detailed distribution if more than 5 percent of samples filtered out)"</span>,
01512         <span class="stringliteral">"         /m (Message when batch finished)"</span>,
01513         <span class="stringliteral">"         /s (Stay, don't close application when batch finished)"</span>,
01514         <span class="stringliteral">"         /t (Batch and Interactive Modes; Measure test time - not Cycle Counts, on Pentium Machines)"</span>,
01515         <span class="stringliteral">"         /i [INI filename] (optional, def.= USRBATCH.INI )"</span>,
01516         <span class="stringliteral">""</span>,
01517         <span class="stringliteral">"Batch Mode requires preparing an INI file (default: USRBATCH.INI) in the same directory where the application is being run."</span>,
01518         <span class="stringliteral">"You may also specify an INI filename using /i [INI filename] in the command line (must reside in the directory mentioned above)."</span>,
01519         <span class="stringliteral">""</span>,
01520         <span class="stringliteral">"INI file Sections and Keys: (Use  ' , '  or  ' ; '  as separators where necessary)"</span>,
01521         <span class="stringliteral">"[BATCH]"</span>,
01522         <span class="stringliteral">"RUN= ALL / QUICK / TEXT / SELECT (Test type, select one, def.= TEXT"</span>,
01523         <span class="stringliteral">"CYCLE= (No. of batch cycles, def.= 1)"</span>,
01524         <span class="stringliteral">"TEST= test numbers (Selected tests to run, needed only for test type= SELECT)"</span>,
01525         <span class="stringliteral">"[TEXT]"</span>,
01526         <span class="stringliteral">"FONT = name, +optional parameters   (Font name + any combination of:"</span>,
01527         <span class="stringliteral">" BOLD, ITALIC, UNDERLINE, STRIKE, TRANSPARENT, RGB(r,g,b), def.= Arial)"</span>,
01528         <span class="stringliteral">"STRING_CONTENT= string (Text string to be used, up to 128 characters)"</span>,
01529         <span class="stringliteral">"[RUN]"</span>,
01530         <span class="stringliteral">"FONT_SIZE= font sizes (Font sizes to be tested, def. 12)"</span>,
01531         <span class="stringliteral">"STRING_LENGTH= string lengths (String Length to be tested, taken as sub-strings of the one specified, def. 32)"</span>,
01532         <span class="stringliteral">"ORDER= test loop order (Order of test loops (first is outer); example: FONT_SIZE STRING_LENGTH )"</span>,
01533         <span class="stringliteral">""</span>,
01534         <span class="stringliteral">"Batch Output:"</span>,
01535         <span class="stringliteral">"Output files will be generated automatically in the run directory, with the name [USBxxx.log], where xxx is a number."</span>,
01536         <span class="stringliteral">"Note that the program will refuse to run if more than 200 output files are accumulated..."</span>,
01537     };
01538 
01539     <span class="keywordtype">int</span> aiT[2];
01540 
01541     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01542     <span class="keywordflow">case</span> WM_INITDIALOG:
01543         aiT[0] = 100;
01544         aiT[1] = 190;
01545         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hwnd, <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a16">IDC_HELPLIST</a>, LB_SETTABSTOPS, 2,
01546                 (LPARAM)aiT);
01547 
01548         <span class="keywordflow">for</span> (ix = 0; ix &lt; <span class="keyword">sizeof</span> szT / <span class="keyword">sizeof</span> szT[0]; ix++) {
01549             <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hwnd, <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a16">IDC_HELPLIST</a>, LB_ADDSTRING, 0,
01550                         (LPARAM)szT[ix]);
01551         }
01552 
01553 
01554         <span class="keywordflow">break</span>;
01555 
01556     <span class="keywordflow">case</span> WM_COMMAND:
01557         <span class="keywordflow">switch</span> (LOWORD(wParam)) {
01558         <span class="keywordflow">case</span> IDOK:
01559             <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hwnd, 0);
01560             <span class="keywordflow">break</span>;
01561         <span class="keywordflow">default</span>:
01562             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01563         }
01564         <span class="keywordflow">break</span>;
01565 
01566     <span class="keywordflow">default</span>:
01567         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01568     }
01569 
01570     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01571 }
01572 
01573 <span class="comment">/*++</span>
01574 <span class="comment"></span>
01575 <span class="comment">Routine Description:</span>
01576 <span class="comment"></span>
01577 <span class="comment">    SelectOutFileName  - Select the next output file name (batch mode)</span>
01578 <span class="comment"></span>
01579 <span class="comment">Arguments</span>
01580 <span class="comment"></span>
01581 <span class="comment">    HWND hWnd</span>
01582 <span class="comment"></span>
01583 <span class="comment">Return Value</span>
01584 <span class="comment"></span>
01585 <span class="comment">    char *OutFileName</span>
01586 <span class="comment"></span>
01587 <span class="comment">--*/</span>
01588 
01589 <span class="keywordtype">char</span> *
<a name="l01590"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a60">01590</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(HWND hWnd)
01591 
01592 {
01593 
01594     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[11];
01595     <span class="keywordtype">char</span> <a class="code" href="../../d3/d3/dumpuser_8c.html#a12">buf2</a>[4];
01596     FILE *fpFile;
01597     <span class="keywordtype">int</span> i;
01598 
01599     lstrcpy(buf,<span class="stringliteral">"usb"</span>);
01600 
01601     <span class="keywordflow">for</span> (i=1; i&lt;201; i++)   <span class="comment">// Allow for up to 200 output files to exist in current directory</span>
01602     {
01603       <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(&amp;buf[3],<span class="stringliteral">"%03s.log"</span>,_itoa(i,<a class="code" href="../../d3/d3/dumpuser_8c.html#a12">buf2</a>,10));
01604 
01605       fpFile = fopen(&amp;buf[0],<span class="stringliteral">"r"</span>);  <span class="comment">// Try to open for read, if succeeds the file already exists</span>
01606                                     <span class="comment">//                       if fails, thats the next file selected</span>
01607       <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != fpFile)
01608       {
01609         fclose(fpFile);
01610         <span class="keywordflow">continue</span>;
01611       }
01612       <span class="keywordflow">return</span> buf;
01613     }
01614 
01615     MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,<span class="stringliteral">"Cannot Continue, Limit of 200 usbxxx.log Output Files Exceeded, Please Clean Up! "</span>, <span class="stringliteral">"Output File Creation Error"</span>,MB_ICONSTOP|MB_OK);
01616     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01617 }
01618 
01619 
01620 <span class="comment">/*++</span>
01621 <span class="comment"></span>
01622 <span class="comment">Routine Description:</span>
01623 <span class="comment"></span>
01624 <span class="comment">    WriteBatchResults - Save Batch results to file</span>
01625 <span class="comment"></span>
01626 <span class="comment">Arguments</span>
01627 <span class="comment"></span>
01628 <span class="comment">    FILE *fpOutFile</span>
01629 <span class="comment">    int  TestType</span>
01630 <span class="comment"></span>
01631 <span class="comment">Return Value</span>
01632 <span class="comment"></span>
01633 <span class="comment">    none</span>
01634 <span class="comment"></span>
01635 <span class="comment">--*/</span>
01636 
01637 
<a name="l01638"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a61">01638</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(FILE *fpOut, <span class="keywordtype">int</span> TestType, <span class="keywordtype">int</span> cycle)
01639 {
01640     <span class="keywordtype">char</span> szT[180];
01641     OSVERSIONINFO Win32VersionInformation;
01642     MEMORYSTATUS MemoryStatus;
01643     <span class="keywordtype">char</span> ComputerName[MAX_COMPUTERNAME_LENGTH + 1];
01644     <span class="keywordtype">int</span> SizBuf = MAX_COMPUTERNAME_LENGTH + 1;
01645     <span class="keywordtype">int</span> i,j;
01646     ULONG ix;
01647     <span class="keywordtype">char</span> *pszOSName;
01648     ULONG ixStart = 0;
01649     ULONG ixEnd  = <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;
01650 
01651     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a> == TestType){
01652         ixStart = <a class="code" href="../../d0/d2/usrbench_8h.html#a8">FIRST_TEXT_FUNCTION</a>;
01653         ixEnd  = <a class="code" href="../../d0/d2/usrbench_8h.html#a9">LAST_TEXT_FUNCTION</a> + 1;
01654     }
01655 
01656 
01657     <span class="comment">/*</span>
01658 <span class="comment">     * Write out the build information and current date.</span>
01659 <span class="comment">     */</span>
01660     Win32VersionInformation.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(Win32VersionInformation);
01661     <span class="keywordflow">if</span> (GetVersionEx(&amp;Win32VersionInformation))
01662     {
01663         <span class="keywordflow">switch</span> (Win32VersionInformation.dwPlatformId)
01664         {
01665             <span class="keywordflow">case</span> VER_PLATFORM_WIN32s:
01666                 pszOSName = <span class="stringliteral">"WIN32S"</span>;
01667                 <span class="keywordflow">break</span>;
01668             <span class="keywordflow">case</span> VER_PLATFORM_WIN32_WINDOWS:
01669                 pszOSName = <span class="stringliteral">"Windows 95"</span>;
01670                 <span class="keywordflow">break</span>;
01671             <span class="keywordflow">case</span> VER_PLATFORM_WIN32_NT:
01672                 pszOSName = <span class="stringliteral">"Windows NT"</span>;
01673                 <span class="keywordflow">break</span>;
01674             <span class="keywordflow">default</span>:
01675                 pszOSName = <span class="stringliteral">"Windows ???"</span>;
01676                 <span class="keywordflow">break</span>;
01677         }
01678 
01679         GetComputerName(ComputerName, &amp;SizBuf);
01680         wsprintf(szT, <span class="stringliteral">"\n\n</span>
01681 <span class="stringliteral">        fwrite(szT, sizeof(char), lstrlen(szT), fpOut);</span>
01682 <span class="stringliteral"></span>
01683 <span class="stringliteral">        wsprintf(szT, "</span>%s <a class="code" href="../../d2/d5/editreg_8c.html#a50">Version</a> %d.%d Build %d <span class="stringliteral">", pszOSName,</span>
01684 <span class="stringliteral">        Win32VersionInformation.dwMajorVersion,</span>
01685 <span class="stringliteral">        Win32VersionInformation.dwMinorVersion,</span>
01686 <span class="stringliteral">        Win32VersionInformation.dwBuildNumber);</span>
01687 <span class="stringliteral">        fwrite(szT, sizeof(char), lstrlen(szT), fpOut);</span>
01688 <span class="stringliteral"></span>
01689 <span class="stringliteral">        MemoryStatus.dwLength = sizeof(MEMORYSTATUS);</span>
01690 <span class="stringliteral">        GlobalMemoryStatus(&amp;MemoryStatus);</span>
01691 <span class="stringliteral"></span>
01692 <span class="stringliteral">        wsprintf(szT, "</span><a class="code" href="../../d6/d8/udfstruc_8h.html#a129a115">Physical</a> Memory = %dKB   
01693         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01694 
01695         wsprintf(szT,<span class="stringliteral">"\nComputer Name = %s"</span>, ComputerName);
01696         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01697 
01698     }
01699 
01700     wsprintf(szT, <span class="stringliteral">"\n\nMaximum Variation Coefficient (Standard Deviation/Average) Imposed on Test Data = %d %%"</span>, <a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>);
01701     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01702     wsprintf(szT, <span class="stringliteral">"\n\nBest and Worst Cycle or Time Counts per Call are Unprocessed Values"</span>, <a class="code" href="../../d0/d2/usrbench_8h.html#a21">VAR_LIMIT</a>);
01703     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01704 
01705 
01706     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01707     {
01708         wsprintf(szT, <span class="stringliteral">"\n\nBatch Cycle No. %d Out of %d Cycles"</span>, cycle, <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a> );
01709         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01710     }
01711     <span class="keywordflow">else</span>
01712     {
01713         wsprintf(szT, <span class="stringliteral">"\n\nResults of interactive mode session;"</span>);
01714         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01715     }
01716 
01717     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a> == TestType || <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>){
01718         wsprintf(szT, <span class="stringliteral">"\n\nFor Text Function Suit:\n\nTest String Length = %d Characters"</span>, <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>);
01719         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01720 
01721         wsprintf(szT, <span class="stringliteral">"\nString Used=   %s"</span>, <a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>);
01722         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01723 
01724         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01725         {
01726             wsprintf(szT, <span class="stringliteral">"\n!!!WARNING: One or More String Lengths Specified in INI File \n           is Longer than Supplied or Default Source String"</span>);
01727             fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01728         }
01729 
01730         wsprintf(szT, <span class="stringliteral">"\nFont name = %s, Font Size = %d"</span>, &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0], <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize/10);
01731         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01732 
01733         wsprintf(szT, <span class="stringliteral">"\nFont Weight = %ld (400 = Normal, 700 = Bold)"</span>,<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWeight);
01734         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01735 
01736         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfItalic != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)?wsprintf(szT,<span class="stringliteral">"\nItalic = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nItalic = FALSE"</span>);
01737         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01738 
01739         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfUnderline==<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)?wsprintf(szT,<span class="stringliteral">"\nUnderline = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nUnderline = FALSE"</span>);
01740         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01741 
01742         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfStrikeOut==<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)?wsprintf(szT,<span class="stringliteral">"\nStrikeOut = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nStrikeOut = FALSE"</span>);
01743         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01744 
01745         (<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>==<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)?wsprintf(szT,<span class="stringliteral">"\nTransparent Background = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nOpaque Background = TRUE"</span>);
01746         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01747 
01748         wsprintf(szT, <span class="stringliteral">"\nColor Used: RED = %d, GREEN = %d, BLUE = %d"</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors&gt;&gt;8), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors&gt;&gt;16) );
01749         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01750    }
01751 
01752     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a> == TestType || <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>)
01753       {
01754 #ifdef <a class="code" href="../../d3/d3/i386_8c.html#a0">_X86_</a>
01755                 <span class="keywordflow">if</span>(<a class="code" href="../../d1/d1/bench_8c.html#a23">gfPentium</a>)
01756                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\t Cycle Counts \tStdDev%\tBest \t Worst \t Valid Samples \t Out of\tIterations  StrLen \t Font Size   Font Name\n\n"</span>);
01757                 <span class="keywordflow">else</span>
01758 #endif
01759                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\tTime (100 ns) \tStdDev%\tBest \t Worst \t Valid Samples \t Out of\tIterations  StrLen \t Font Size   Font Name\n\n"</span>);
01760       }
01761     <span class="keywordflow">else</span>
01762       {
01763 #ifdef <a class="code" href="../../d3/d3/i386_8c.html#a0">_X86_</a>
01764                 <span class="keywordflow">if</span>(<a class="code" href="../../d1/d1/bench_8c.html#a23">gfPentium</a>)
01765                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\t Cycle Counts \tStdDev% \t Best \t Worst \t Valid Samples \t Out of \t Iterations\n\n"</span>);
01766                 <span class="keywordflow">else</span>
01767 #endif
01768                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\tTime (100 ns) \tStdDev% \t Best \t Worst \t Valid Samples \t Out of \t Iterations\n\n"</span>);
01769 
01770       }
01771 
01772     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01773 
01774     <span class="keywordflow">for</span> (ix = ixStart; ix &lt; ixEnd; ix++) {
01775 
01776         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a> == TestType || <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>)
01777         {
01778             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,
01779                    <span class="stringliteral">"%-30s\t,%6ld\t,%6.2f\t,%6ld\t,%6ld\t,%6ld\t\t,%6ld\t,%6ld\t,%6ld\t,%6ld\t,%s\n"</span>,
01780                    (LPSTR)<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Api,
01781                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Average),
01782                                 (<span class="keywordtype">float</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].StdDev,
01783                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Minimum_Result),
01784                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Maximum_Result),
01785                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].NumSamplesValid,
01786                                 (<span class="keywordtype">long</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,
01787                                 <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Iter,
01788                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>,
01789                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize / 10,
01790                                 &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0]);
01791 
01792 
01793         }
01794         <span class="keywordflow">else</span>
01795         {
01796             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,
01797                    <span class="stringliteral">"%-50s\t,%10ld\t,%6.2f\t,%10ld\t,%10ld\t,%6ld\t\t,%6ld\t,%6ld\n"</span>,
01798                    (LPSTR)<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Api,
01799                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Average),
01800                                 (<span class="keywordtype">float</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].StdDev,
01801                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Minimum_Result),
01802                                 (<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].Maximum_Result),
01803                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].NumSamplesValid,
01804                                 (<span class="keywordtype">long</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>,
01805                                 <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].Iter);
01806         }
01807 
01808         <span class="keywordflow">if</span>((<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o0">Average</a>) != 0)
01809         {
01810             fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01811             <span class="keywordflow">if</span>((<a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) &amp;&amp; ((<span class="keywordtype">float</span>)(<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a> - <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o4">NumSamplesValid</a>)/(<span class="keywordtype">float</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a> &gt; 0.05F))
01812             {
01813                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"\nThe Last Test Had More Than 5 Percent of Its Samples Filtered Out;\n\n"</span>);
01814                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01815 
01816                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"Here Is a Detailed Distribution of the Samples:\n\n"</span>);
01817                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01818 
01819                 <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
01820                 {
01821                     <span class="keywordflow">if</span>((j+1)%10)
01822                         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"%d\t"</span>,<a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[ix][j]);
01823                     <span class="keywordflow">else</span>
01824                         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"%d\n"</span>,<a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[ix][j]);
01825 
01826                     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01827                 }
01828                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"\n"</span>);
01829                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01830 
01831             }
01832         }
01833         <span class="keywordflow">else</span> {
01834             fputs(<span class="stringliteral">"\n"</span>, fpOut);
01835         }
01836     }
01837 
01838     <span class="keywordflow">if</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>)<a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01839 }
01840 
01841 <span class="comment">/*++</span>
01842 <span class="comment"></span>
01843 <span class="comment">Routine Description:</span>
01844 <span class="comment"></span>
01845 <span class="comment">    SyncMenuChecks - toggle checkmarks between String-Length menu items</span>
01846 <span class="comment"></span>
01847 <span class="comment">Arguments</span>
01848 <span class="comment"></span>
01849 <span class="comment">    HWND hwnd</span>
01850 <span class="comment">    int Last_Checked - index of last menu item checked</span>
01851 <span class="comment">    int New_Checked  - index of new menu item to check</span>
01852 <span class="comment"></span>
01853 <span class="comment">Return Value</span>
01854 <span class="comment"></span>
01855 <span class="comment">    int Last_Checked - new index of menu item just checked</span>
01856 <span class="comment"></span>
01857 <span class="comment">--*/</span>
01858 
<a name="l01859"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a62">01859</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(HWND hWnd, <span class="keywordtype">int</span> Last_Checked, <span class="keywordtype">int</span> New_Checked)
01860 {
01861     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>),2),0),0);
01862     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,Last_Checked,MF_BYPOSITION|MF_UNCHECKED);
01863     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,New_Checked,MF_BYPOSITION|MF_CHECKED);
01864     Last_Checked = New_Checked;
01865     <span class="keywordflow">return</span> Last_Checked;
01866 }
01867 
01868 <span class="comment">/*++</span>
01869 <span class="comment"></span>
01870 <span class="comment">Routine Description:</span>
01871 <span class="comment"></span>
01872 <span class="comment">    StdParse - Standard parser for comma, semi-colon or space delimited integer containing strings</span>
01873 <span class="comment"></span>
01874 <span class="comment">Arguments</span>
01875 <span class="comment"></span>
01876 <span class="comment">    char txtbuf - buffer containing the string to parse</span>
01877 <span class="comment">    int limit -   max no. of characters to search in txtbuf</span>
01878 <span class="comment">    int * array - returned array containing the integers found</span>
01879 <span class="comment"></span>
01880 <span class="comment">Return Value</span>
01881 <span class="comment"></span>
01882 <span class="comment">    int i - number of integers found in txtbuf</span>
01883 <span class="comment"></span>
01884 <span class="comment">--*/</span>
01885 
<a name="l01886"></a><a class="code" href="../../d0/d2/usrbench_8h.html#a63">01886</a> <span class="keywordtype">int</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(<span class="keywordtype">char</span> *txtbuf, <span class="keywordtype">int</span> limit, <span class="keywordtype">int</span> *array)
01887 {
01888     <span class="keywordtype">int</span> i = 0;
01889     <span class="keywordtype">int</span> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = 0;
01890     <span class="keywordtype">char</span> tst[2];
01891 
01892     array[0] = 0;
01893 
01894     <span class="keywordflow">do</span>
01895     {
01896         sscanf(&amp;txtbuf[<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>],<span class="stringliteral">"%1c"</span>,tst);
01897 
01898         <span class="keywordflow">if</span>((array[i] != 0)&amp;&amp;((tst[0] == <span class="charliteral">' '</span>)||(tst[0] == <span class="charliteral">','</span>)||(tst[0] == <span class="charliteral">';'</span>)))
01899         {
01900             ++i;
01901             array[i] = 0;
01902         }
01903 
01904         <span class="keywordflow">if</span>(tst[0] == <span class="charliteral">'\n'</span>)
01905         {
01906             ++i;
01907             <span class="keywordflow">break</span>;
01908         }
01909         <span class="keywordflow">while</span>((<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&lt;limit)&amp;&amp;((tst[0] == <span class="charliteral">' '</span>)||(tst[0] == <span class="charliteral">','</span>)||(tst[0] == <span class="charliteral">';'</span>)))
01910         {
01911             ++<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01912             sscanf(&amp;txtbuf[<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>],<span class="stringliteral">"%1c"</span>,tst);
01913         }
01914         <span class="keywordflow">if</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&gt;=limit)
01915             <span class="keywordflow">break</span>;
01916 
01917         array[i] = 10*array[i] + atoi(tst);
01918         ++<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01919 
01920     }<span class="keywordflow">while</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&lt;limit );
01921 
01922     <span class="keywordflow">if</span>(array[i] != 0) ++i;
01923     <span class="keywordflow">return</span> i;
01924 }
01925 
01926 
01927 <span class="comment">/***************************************************************************\</span>
01928 <span class="comment">* MDIChildWndProc</span>
01929 <span class="comment">*</span>
01930 <span class="comment">* History:</span>
01931 <span class="comment">* 01-24-92 DarrinM      Created.</span>
01932 <span class="comment">\***************************************************************************/</span>
01933 
<a name="l01934"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a15">01934</a> LRESULT <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a15">MDIChildWndProc</a>(
01935     HWND hwnd,
01936     UINT msg,
01937     WPARAM wParam,
01938     LPARAM lParam)
01939 {
01940     HWND hwndEdit;
01941 
01942     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01943     <span class="keywordflow">case</span> WM_MDICREATE:
01944 
01945         <span class="comment">/*</span>
01946 <span class="comment">         * Create an edit control</span>
01947 <span class="comment">         */</span>
01948         hwndEdit = CreateWindow(<span class="stringliteral">"edit"</span>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01949                 WS_CHILD | WS_HSCROLL | WS_MAXIMIZE | WS_VISIBLE |
01950                 WS_VSCROLL | ES_AUTOHSCROLL | ES_AUTOVSCROLL | ES_MULTILINE | WS_OVERLAPPEDWINDOW,
01951                 0, 0, 0, 0, <a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, (HMENU)<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a34">ID_EDIT</a>, <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01952 
01953         <span class="comment">/*</span>
01954 <span class="comment">         * Remember the window handle and initialize some window attributes</span>
01955 <span class="comment">         */</span>
01956         <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(hwnd, <a class="code" href="../../d2/d1/bench_8h.html#a1">GWLP_HWNDEDIT</a>, (LONG_PTR)hwndEdit);
01957         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(hwndEdit);
01958         <span class="keywordflow">break</span>;
01959 
01960     <span class="keywordflow">case</span> WM_CLOSE:
01961         <span class="keywordflow">break</span>;
01962 
01963     <span class="keywordflow">case</span> WM_SIZE: {
01964         RECT rc;
01965 
01966         <span class="comment">/*</span>
01967 <span class="comment">         * On creation or resize, size the edit control.</span>
01968 <span class="comment">         */</span>
01969 
01970         hwndEdit = (HWND)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, <a class="code" href="../../d2/d1/bench_8h.html#a1">GWLP_HWNDEDIT</a>);
01971         <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(hwnd, &amp;rc);
01972         MoveWindow(hwndEdit, rc.left, rc.top,
01973                 rc.right - rc.left, rc.bottom - rc.top, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01974         <span class="keywordflow">return</span> DefMDIChildProc(hwnd, <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>, wParam, lParam);
01975     }
01976 
01977     <span class="keywordflow">case</span> WM_SETFOCUS:
01978         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>((HWND)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, <a class="code" href="../../d2/d1/bench_8h.html#a1">GWLP_HWNDEDIT</a>));
01979         <span class="keywordflow">break</span>;
01980 
01981     <span class="keywordflow">default</span>:
01982         <span class="keywordflow">return</span> DefMDIChildProc(hwnd, <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>, wParam, lParam);
01983     }
01984 
01985     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01986 }
01987 <span class="comment">/***************************************************************************\</span>
01988 <span class="comment">* InitializeInstance  (danalm)</span>
01989 <span class="comment">*</span>
01990 <span class="comment">* History:</span>
01991 <span class="comment">* 01-24-92 DarrinM      Created.</span>
01992 <span class="comment">* 07-25-96 DanAlm       Modified.</span>
01993 <span class="comment">\***************************************************************************/</span>
01994 
<a name="l01995"></a><a class="code" href="../../d9/d1/usrbench_8c.html#a16">01995</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a> <a class="code" href="../../d9/d1/usrbench_8c.html#a16">InitializeInstance</a>(
01996     HINSTANCE hInst,
01997     HINSTANCE hPrev,
01998     INT nCmdShow)
01999 {
02000 
02001     WNDCLASS    wc;
02002     HWND        hWndDesk;
02003     RECT        hwRect;
02004     RECT        rc;
02005 
02006     CLIENTCREATESTRUCT ccs;
02007 
02008     hWndDesk = <a class="code" href="../../d3/d9/client_2wow_8c.html#a4">GetDesktopWindow</a>();
02009     <a class="code" href="../../d3/d9/client_2wow_8c.html#a26">GetWindowRect</a>(hWndDesk,&amp;hwRect);
02010 
02011     <span class="keywordflow">if</span> (!hPrev)
02012     {
02013         wc.hInstance      = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
02014         wc.hCursor        = LoadCursor((HINSTANCE)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, IDC_ARROW);
02015         wc.hIcon          = LoadIcon(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>, MAKEINTRESOURCE(<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a8">IDR_USRBENCH_MENU</a>));
02016         wc.lpszMenuName   = MAKEINTRESOURCE(<a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a8">IDR_USRBENCH_MENU</a>);
02017         wc.lpszClassName  = <a class="code" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a>;
02018         wc.hbrBackground  = (HBRUSH)GetStockObject(GRAY_BRUSH);
02019         wc.style          = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)0;
02020         wc.lpfnWndProc    = <a class="code" href="../../d0/d5/ntcon_2conime_2conime_8c.html#a12">WndProc</a>;
02021         wc.cbWndExtra     = 0;
02022         wc.cbClsExtra     = 0;
02023 
02024 
02025         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d9/cltxt_8h.html#a7">RegisterClass</a>(&amp;wc)) {
02026             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02027         }
02028     <span class="comment">/*</span>
02029 <span class="comment">     * Register the MDI child class</span>
02030 <span class="comment">     */</span>
02031         wc.lpfnWndProc   = <a class="code" href="../../d9/d1/usrbench_8c.html#a15">MDIChildWndProc</a>;
02032         wc.hIcon         = LoadIcon(<a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>, <a class="code" href="../../d2/d1/bench_8h.html#a3">IDNOTE</a>);
02033         wc.lpszMenuName  = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02034         wc.cbWndExtra    = <span class="keyword">sizeof</span>(HWND);
02035         wc.lpszClassName = <a class="code" href="../../d9/d1/usrbench_8c.html#a11">szChild</a>;
02036 
02037         <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d9/cltxt_8h.html#a7">RegisterClass</a>(&amp;wc))<span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02038 
02039 
02040     }
02041 
02042 
02043     <span class="comment">//</span>
02044     <span class="comment">// Create and show the main Frame window</span>
02045     <span class="comment">//</span>
02046 
02047     <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a> = CreateWindow (<a class="code" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a>,
02048                             <span class="stringliteral">"USER Call Performance"</span>,
02049                             WS_OVERLAPPEDWINDOW | WS_CLIPCHILDREN,
02050                             0,
02051                             0,
02052                             hwRect.right,
02053                             hwRect.bottom,
02054                             (HWND)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
02055                             (HMENU)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
02056                             (HINSTANCE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>,
02057                             (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
02058                            );
02059 
02060     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02061         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
02062 
02063     }
02064 
02065     <span class="comment">//</span>
02066     <span class="comment">//  Show the window</span>
02067     <span class="comment">//</span>
02068 
02069     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>,nCmdShow);
02070     <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>);
02071     <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>);
02072 
02073     <span class="comment">//  Create a Desktop Window inside the Frame Window</span>
02074 
02075     ccs.hWindowMenu = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02076     ccs.idFirstChild = 0;
02077 
02078     <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>, (LPRECT)&amp;rc);
02079 
02080     <a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> = CreateWindow(<span class="stringliteral">"mdiclient"</span>,
02081                                     <span class="stringliteral">"Desktop"</span>,
02082                                     WS_CHILD | WS_CLIPCHILDREN | WS_VISIBLE | WS_BORDER,
02083                                     rc.left,
02084                                     rc.top+100,
02085                                     rc.right-rc.left,
02086                                     rc.bottom-(rc.top+100),
02087                                     <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>,
02088                                     (HMENU)0xCAC,
02089                                     <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>,
02090                                     (LPSTR)&amp;ccs
02091                                   );
02092 
02093     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02094         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
02095     }
02096 
02097     <span class="comment">/*</span>
02098 <span class="comment">     * Create MDI child window for potential use of Userbench tests.</span>
02099 <span class="comment">     */</span>
02100 
02101     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.szClass = <span class="stringliteral">"mdiclient"</span>;
02102     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.szTitle = <span class="stringliteral">"Test Object"</span>;
02103     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.hOwner  = <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>;
02104     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.x = <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.cx = CW_USEDEFAULT;
02105     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.y = <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.cy = CW_USEDEFAULT;
02106     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.style = WS_OVERLAPPEDWINDOW;
02107 
02108     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a>, WM_MDICREATE, 0, (LPARAM)&amp;<a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>);
02109 
02110     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02111 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:17 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
