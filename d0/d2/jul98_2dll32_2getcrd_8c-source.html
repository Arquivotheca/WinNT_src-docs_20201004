<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: getcrd.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>getcrd.c</h1><a href="../../d9/d2/jul98_2dll32_2getcrd_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include "<a class="code" href="../../d3/d0/jul98_2dll32_2generic_8h.html">generic.h</a>"</span>
00002 
00003 <span class="preprocessor">#pragma code_seg(_ICMSEG)</span>
00004 <span class="preprocessor"></span>
<a name="l00005"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a1">00005</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a2">BeginString</a>[]       = <span class="stringliteral">"&lt;"</span>;
<a name="l00006"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a2">00006</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a3">EndString</a>[]         = <span class="stringliteral">"&gt;"</span>;
<a name="l00007"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a3">00007</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>[]        = <span class="stringliteral">"["</span>;
<a name="l00008"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a4">00008</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>[]          = <span class="stringliteral">"]"</span>;
<a name="l00009"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a5">00009</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>[]     = <span class="stringliteral">"{"</span>;
<a name="l00010"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a6">00010</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>[]       = <span class="stringliteral">"}bind "</span>;
<a name="l00011"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a7">00011</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>[]         = <span class="stringliteral">"&lt;&lt;"</span> ;
<a name="l00012"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a8">00012</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>[]           = <span class="stringliteral">"&gt;&gt;"</span> ;
<a name="l00013"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a9">00013</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a10">BlackPoint</a>[]        = <span class="stringliteral">"[0 0 0]"</span> ;
<a name="l00014"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a10">00014</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>[]          = <span class="stringliteral">"/ColorRenderingType 1 "</span>;
00015 
<a name="l00016"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a11">00016</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a17">WhitePointTag</a>[]     = <span class="stringliteral">"/WhitePoint "</span> ;
<a name="l00017"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a12">00017</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a18">BlackPointTag</a>[]     = <span class="stringliteral">"/BlackPoint "</span> ;
<a name="l00018"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a13">00018</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a19">RangePQRTag</a>[]       = <span class="stringliteral">"/RangePQR "</span> ;
<a name="l00019"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a14">00019</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a20">TransformPQRTag</a>[]   = <span class="stringliteral">"/TransformPQR "</span> ;
<a name="l00020"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a15">00020</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a21">MatrixPQRTag</a>[]      = <span class="stringliteral">"/MatrixPQR "</span> ;
00021 
<a name="l00022"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a16">00022</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a22">RangeABCTag</a>[]       = <span class="stringliteral">"/RangeABC "</span> ;
<a name="l00023"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a17">00023</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a23">MatrixATag</a>[]        = <span class="stringliteral">"/MatrixA "</span>;
<a name="l00024"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a18">00024</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>[]      = <span class="stringliteral">"/MatrixABC "</span>;
<a name="l00025"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a19">00025</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>[]      = <span class="stringliteral">"/EncodeABC "</span> ;
<a name="l00026"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a20">00026</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a26">RangeLMNTag</a>[]       = <span class="stringliteral">"/RangeLMN "</span> ;
<a name="l00027"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a21">00027</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a27">MatrixLMNTag</a>[]      = <span class="stringliteral">"/MatrixLMN "</span> ;
<a name="l00028"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a22">00028</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a28">EncodeLMNTag</a>[]      = <span class="stringliteral">"/EncodeLMN "</span> ;
<a name="l00029"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a23">00029</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a29">RenderTableTag</a>[]    = <span class="stringliteral">"/RenderTable "</span> ;
<a name="l00030"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a24">00030</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a30">CIEBasedATag</a>[]      = <span class="stringliteral">"/CIEBasedA "</span> ;
<a name="l00031"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a25">00031</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a31">CIEBasedABCTag</a>[]    = <span class="stringliteral">"/CIEBasedABC "</span> ;
<a name="l00032"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a26">00032</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a32">CIEBasedDEFGTag</a>[]   = <span class="stringliteral">"/CIEBasedDEFG "</span> ;
<a name="l00033"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a27">00033</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a33">CIEBasedDEFTag</a>[]    = <span class="stringliteral">"/CIEBasedDEF "</span> ;
<a name="l00034"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a28">00034</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a34">DecodeATag</a>[]        = <span class="stringliteral">"/DecodeA "</span> ;
<a name="l00035"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a29">00035</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a35">DecodeABCTag</a>[]      = <span class="stringliteral">"/DecodeABC "</span> ;
<a name="l00036"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a30">00036</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a36">DecodeLMNTag</a>[]      = <span class="stringliteral">"/DecodeLMN "</span> ;
<a name="l00037"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a31">00037</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a37">DeviceRGBTag</a>[]      = <span class="stringliteral">"/DeviceRGB "</span> ;
<a name="l00038"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a32">00038</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a38">DeviceCMYKTag</a>[]     = <span class="stringliteral">"/DeviceCMYK "</span> ;
<a name="l00039"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a33">00039</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a39">DeviceGrayTag</a>[]     = <span class="stringliteral">"/DeviceGray "</span> ;
<a name="l00040"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a34">00040</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a40">TableTag</a>[]          = <span class="stringliteral">"/Table "</span> ;
<a name="l00041"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a35">00041</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a41">DecodeDEFGTag</a>[]     = <span class="stringliteral">"/DecodeDEFG "</span> ;
<a name="l00042"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a36">00042</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a42">DecodeDEFTag</a>[]      = <span class="stringliteral">"/DecodeDEF "</span> ;
00043 
<a name="l00044"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a37">00044</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a43">NullOp</a>[]            = <span class="stringliteral">""</span>;
<a name="l00045"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a38">00045</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>[]             = <span class="stringliteral">"dup "</span>;
<a name="l00046"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a39">00046</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a45">UserDictOp</a>[]        = <span class="stringliteral">"userdict "</span>;
<a name="l00047"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a40">00047</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a46">GlobalDictOp</a>[]      = <span class="stringliteral">"globaldict "</span>;
<a name="l00048"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a41">00048</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a47">CurrentGlobalOp</a>[]   = <span class="stringliteral">"currentglobal "</span>;
<a name="l00049"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a42">00049</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a48">SetGlobalOp</a>[]       = <span class="stringliteral">"setglobal "</span>;
<a name="l00050"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a43">00050</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a49">DefOp</a>[]             = <span class="stringliteral">"def "</span>;
<a name="l00051"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a44">00051</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a50">BeginOp</a>[]           = <span class="stringliteral">"begin "</span>;
<a name="l00052"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a45">00052</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a51">EndOp</a>[]             = <span class="stringliteral">"end "</span>;
<a name="l00053"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a46">00053</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a52">TrueOp</a>[]            = <span class="stringliteral">"true "</span>;
<a name="l00054"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a47">00054</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a53">FalseOp</a>[]           = <span class="stringliteral">"false "</span>;
<a name="l00055"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a48">00055</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a54">MulOp</a>[]             = <span class="stringliteral">"mul "</span>;
<a name="l00056"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a49">00056</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a55">DivOp</a>[]             = <span class="stringliteral">"div "</span>;
00057 
<a name="l00058"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a50">00058</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>[]           = <span class="stringliteral">"\n"</span> ;
<a name="l00059"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a51">00059</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a57">Slash</a>[]             = <span class="stringliteral">"/"</span> ;
<a name="l00060"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a52">00060</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a32">Space</a>[]             = <span class="stringliteral">" "</span> ;
<a name="l00061"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a53">00061</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>[]          = <span class="stringliteral">"%** CRD Begin "</span>;
<a name="l00062"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a54">00062</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>[]            = <span class="stringliteral">"%** CRD End "</span>;
<a name="l00063"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a55">00063</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a61">CieBasedDEFGBegin</a>[] = <span class="stringliteral">"%** CieBasedDEFG CSA Begin "</span>;
<a name="l00064"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a56">00064</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a62">CieBasedDEFBegin</a>[]  = <span class="stringliteral">"%** CieBasedDEF CSA Begin "</span>;
<a name="l00065"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a57">00065</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a63">CieBasedABCBegin</a>[]  = <span class="stringliteral">"%** CieBasedABC CSA Begin "</span>;
<a name="l00066"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a58">00066</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a64">CieBasedABegin</a>[]    = <span class="stringliteral">"%** CieBasedA CSA Begin "</span>;
<a name="l00067"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a59">00067</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a65">CieBasedDEFGEnd</a>[]   = <span class="stringliteral">"%** CieBasedDEFG CSA End "</span>;
<a name="l00068"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a60">00068</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a66">CieBasedDEFEnd</a>[]    = <span class="stringliteral">"%** CieBasedDEF CSA End "</span>;
<a name="l00069"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a61">00069</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a67">CieBasedABCEnd</a>[]    = <span class="stringliteral">"%** CieBasedABC CSA End "</span>;
<a name="l00070"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a62">00070</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a68">CieBasedAEnd</a>[]      = <span class="stringliteral">"%** CieBasedA CSA End "</span>;
<a name="l00071"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a63">00071</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a69">RangeABC</a>[]          = <span class="stringliteral">"[ 0 1 0 1 0 1 ] "</span>;
<a name="l00072"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a64">00072</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a70">RangeLMN</a>[]          = <span class="stringliteral">"[ 0 2 0 2 0 2 ] "</span>;
<a name="l00073"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a65">00073</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a71">Identity</a>[]          = <span class="stringliteral">"[1 0 0 0 1 0 0 0 1]"</span>;
<a name="l00074"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a66">00074</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a72">RangeABC_Lab</a>[]      = <span class="stringliteral">"[0 100 -128 127 -128 127]"</span>;
00075 
00076 <span class="comment">/********** This PostScript code clips incoming value between 0.0 and 1.0</span>
00077 <span class="comment">   Use:   x &lt;clip&gt;   --   &lt;clipped x&gt;                                   */</span>
<a name="l00078"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a67">00078</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a73">Clip01</a>[]            = <span class="stringliteral">"dup 1.0 ge{pop 1.0}{dup 0.0 lt{pop 0.0}if}ifelse "</span> ;
<a name="l00079"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a68">00079</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a74">DecodeA3</a>[]          = <span class="stringliteral">"256 div exp "</span>;
<a name="l00080"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a69">00080</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>[]       = <span class="stringliteral">"256 div 1.0 exch div exp "</span>;
<a name="l00081"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a70">00081</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a76">DecodeABCArray</a>[]    = <span class="stringliteral">"DecodeABC_"</span>;
<a name="l00082"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a71">00082</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>[]        = <span class="stringliteral">"Inp_"</span>;
<a name="l00083"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a72">00083</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a78">OutputArray</a>[]       = <span class="stringliteral">"Out_"</span>;
<a name="l00084"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a73">00084</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a79">PreViewInArray</a>[]    = <span class="stringliteral">"IPV_"</span>;
<a name="l00085"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a74">00085</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a80">PreViewOutArray</a>[]   = <span class="stringliteral">"OPV_"</span>;
00086 
00087 
00088 <span class="comment">// This PostScript segment takes value in range from 0.0 to 1.0 and</span>
00089 <span class="comment">//  interpolates the result using array supplied.</span>
00090 <span class="comment">//   x [array]  -- &lt;interpolated value&gt;</span>
00091 
<a name="l00092"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a75">00092</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a83">IndexArray16b</a>[]     = \
00093 <span class="stringliteral">" dup length 1 sub 3 -1 roll mul dup dup floor cvi \</span>
00094 <span class="stringliteral">exch ceiling cvi 3 index exch get 32768 add 4 -1 roll 3 -1 roll get 32768 add \</span>
00095 <span class="stringliteral">dup 3 1 roll sub 3 -1 roll dup floor cvi sub mul add "</span>;
00096 
<a name="l00097"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a76">00097</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>[]        = \
00098 <span class="stringliteral">" dup length 1 sub 3 -1 roll mul dup dup floor cvi \</span>
00099 <span class="stringliteral">exch ceiling cvi 3 index exch get 4 -1 roll 3 -1 roll get \</span>
00100 <span class="stringliteral">dup 3 1 roll sub 3 -1 roll dup floor cvi sub mul add "</span>;
00101 
<a name="l00102"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a77">00102</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a85">TestingDEFG</a>[]       = \
00103 <span class="stringliteral">"/SupportDEFG? {/CIEBasedDEFG /ColorSpaceFamily resourcestatus { pop pop true}{false} ifelse} def"</span>;
00104 
<a name="l00105"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a78">00105</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a86">SupportDEFG_S</a>[]     = <span class="stringliteral">"SupportDEFG? { "</span>;
<a name="l00106"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a79">00106</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a87">NotSupportDEFG_S</a>[]  = <span class="stringliteral">"SupportDEFG? not { "</span>;
<a name="l00107"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a80">00107</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a88">SupportDEFG_E</a>[]     = <span class="stringliteral">"}if "</span>;
00108 
<a name="l00109"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a81">00109</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>[]         = <span class="stringliteral">"dup 1.0 le{dup 0.0 ge{"</span> ;
<a name="l00110"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a82">00110</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>[]           = <span class="stringliteral">"}if}if "</span> ;
00111 
<a name="l00112"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a83">00112</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a91">Scale8</a>[]            = <span class="stringliteral">"255 div "</span> ;
<a name="l00113"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a84">00113</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>[]           = <span class="stringliteral">"65535 div "</span> ;
<a name="l00114"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a85">00114</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a93">Scale16XYZ</a>[]        = <span class="stringliteral">"32768 div "</span> ;
<a name="l00115"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a86">00115</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a94">TFunction8</a>[]        = <span class="stringliteral">"exch 255 mul round cvi get 255 div "</span> ;
<a name="l00116"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a87">00116</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a95">TFunction8XYZ</a>[]     = <span class="stringliteral">"exch 255 mul round cvi get 128 div "</span> ;
<a name="l00117"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a88">00117</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a96">MatrixABCLab</a>[]      = <span class="stringliteral">"[1 1 1 1 0 0 0 0 -1]"</span> ;
<a name="l00118"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a89">00118</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a97">DecodeABCLab1</a>[]     = <span class="stringliteral">"[{16 add 116 div} bind {500 div} bind {200 div} bind]"</span>;
<a name="l00119"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a90">00119</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a98">DecodeALab</a>[]        = <span class="stringliteral">" 50 mul 16 add 116 div "</span>;
<a name="l00120"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a91">00120</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a99">DecodeLMNLab</a>[]      = \
00121 <span class="stringliteral">"dup 0.206897 ge{dup dup mul mul}{0.137931 sub 0.128419 mul} ifelse "</span>;
00122 
<a name="l00123"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a92">00123</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a100">RangeLMNLab</a>[]       = <span class="stringliteral">"[0 1 0 1 0 1]"</span> ;
<a name="l00124"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a93">00124</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a101">EncodeLMNLab</a>[]      = <span class="stringliteral">"\</span>
00125 <span class="stringliteral">dup 0.008856 le{7.787 mul 0.13793 add}{0.3333 exp}ifelse "</span> ;
00126 
<a name="l00127"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a94">00127</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a102">MatrixABCLabCRD</a>[]   = <span class="stringliteral">"[0 500 0 116 -500 200 0 0 -200]"</span> ;
<a name="l00128"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a95">00128</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a103">MatrixABCXYZCRD</a>[]   = <span class="stringliteral">"[0 1 0 1 0 0 0 0 1]"</span> ;
<a name="l00129"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a96">00129</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a104">EncodeABCLab1</a>[]     = <span class="stringliteral">"16 sub 100 div "</span> ;
<a name="l00130"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a97">00130</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a105">EncodeABCLab2</a>[]     = <span class="stringliteral">"128 add 255 div "</span> ;
00131 
<a name="l00132"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a98">00132</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a>   <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a106">RangePQR</a>[]          = <span class="stringliteral">"[ -0.07 2.2 -0.02 1.4 -0.2 4.8 ]"</span>;
<a name="l00133"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a99">00133</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a>   <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a107">MatrixPQR</a>[]         = <span class="stringliteral">"[0.8951 -0.7502 0.0389 0.2664 1.7135 -0.0685 -0.1614 0.0367 1.0296]"</span>;
00134 
<a name="l00135"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a100">00135</a> <span class="keywordtype">char</span> *<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a108">TransformPQR</a>[3]             = {
00136 <span class="stringliteral">"exch pop exch 3 get mul exch pop exch 3 get div "</span>,
00137 <span class="stringliteral">"exch pop exch 4 get mul exch pop exch 4 get div "</span>,
00138 <span class="stringliteral">"exch pop exch 5 get mul exch pop exch 5 get div "</span> };
00139 
00140 <span class="preprocessor">#pragma optimize("",off)</span>
00141 <span class="preprocessor"></span>
00142 <span class="comment">/***************************************************************************</span>
00143 <span class="comment">*                               CreateLutCRD</span>
00144 <span class="comment">*  function:</span>
00145 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00146 <span class="comment">*    from the data supplied in the ColorProfile's LUT8 or LUT16 tag.</span>
00147 <span class="comment">*  prototype:</span>
00148 <span class="comment">*       SINT EXTERN CreateLutCRD(</span>
00149 <span class="comment">*                          CHANDLE      cp,</span>
00150 <span class="comment">*                          SINT         Index,</span>
00151 <span class="comment">*                          MEMPTR       lpMem,</span>
00152 <span class="comment">*                          BOOL         AllowBinary)</span>
00153 <span class="comment">*  parameters:</span>
00154 <span class="comment">*       cp          --  Color Profile handle</span>
00155 <span class="comment">*       Index       --  Index of the tag</span>
00156 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00157 <span class="comment">*       AllowBinary --  1: binary CRD allowed,  0: only ascii CRD allowed.</span>
00158 <span class="comment">*</span>
00159 <span class="comment">*  returns:</span>
00160 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00161 <span class="comment">*                         0 otherwise.</span>
00162 <span class="comment">*                       Returns number of bytes required/transferred</span>
00163 <span class="comment">***************************************************************************/</span>
00164 
00165 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00166"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a101">00166</a> <a class="code" href="../../d2/d9/ps2_8c.html#a188">CreateLutCRD</a> (CHANDLE cp, SINT Index, MEMPTR lpMem, DWORD InputIntent, BOOL AllowBinary)
00167 {
00168     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nInputCh, nOutputCh, nGrids;
00169     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nInputTable, nOutputTable, nNumbers;
00170     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag, PCS;
00171     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> IntentSig;
00172 
00173     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret;
00174     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, j;
00175     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00176 
00177     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00178     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> MediaWP[3];
00179     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00180     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00181     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00182     <span class="keywordtype">char</span> PublicArrayName[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
00183     HGLOBAL hMem;
00184     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpLineStart;
00185  <span class="comment">// Check if we can generate the CRD</span>
00186     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; IntentSig) ||
00187         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00188         ((Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>) &amp;&amp; (Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a90">icSigLut16Type</a>)) ||
00189         !<a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; PCS) ||
00190         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) ||
00191         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) ||
00192         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00193     {
00194         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != Buff)
00195         {
00196             <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00197         }
00198         <span class="keywordflow">return</span> (0);
00199     }
00200     <a class="code" href="../../d7/d4/jul98_2test_2getcsa_8h.html#a7">GetCLUTinfo</a>(Tag, Buff, &amp;nInputCh, &amp;nOutputCh, 
00201         &amp;nGrids, &amp;nInputTable, &amp;nOutputTable, &amp;i);
00202  <span class="comment">// Level 2 printers support only tri-component CIEBasedABC input,</span>
00203  <span class="comment">// but can have either 3 or 4 output channels.</span>
00204     <span class="keywordflow">if</span> (((nOutputCh != 3) &amp;&amp;
00205          (nOutputCh != 4)) ||
00206         (nInputCh != 3))
00207     {
00208         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a> (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a47">CP_POSTSCRIPT_ERR</a>);
00209         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00210         <span class="keywordflow">return</span> (0);
00211     }
00212     Ret = nInputCh * nInputTable * 6 +
00213         nOutputCh * nOutputTable * 6 +  <span class="comment">// Number of INT bytes</span>
00214         nOutputCh * nGrids * nGrids * nGrids * 2 +  <span class="comment">// LUT HEX bytes</span>
00215         nInputCh * (lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>) +
00216                     lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>) +
00217                     lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>)) +
00218         nOutputCh * (lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>) +
00219                      lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>) +
00220                      lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>)) +
00221         2048;                           <span class="comment">// + other PS stuff</span>
00222 
00223     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)                  <span class="comment">// This is a size request</span>
00224     {
00225         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00226         <span class="keywordflow">return</span> (Ret);
00227     }
00228 <span class="comment">//  Get all necessary params from the header</span>
00229 <span class="comment">//  GetCPRenderIntent (cp, (LPCSIG) &amp; Intent);  // Get Intent</span>
00230     <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00231 
00232  <span class="comment">// Support absolute whitePoint</span>
00233     <span class="keywordflow">if</span> (InputIntent == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>)
00234     {
00235         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; MediaWP)) <span class="comment">// .. Media WhitePoint</span>
00236         {
00237             MediaWP[0] = IlluminantWP[0];
00238             MediaWP[1] = IlluminantWP[1];
00239             MediaWP[2] = IlluminantWP[2];
00240         }
00241     }
00242 
00243 <span class="comment">//******** Define golbal array used in EncodeABC and RenderTaber</span>
00244     <a class="code" href="../../d2/d9/ps2_8c.html#a217">GetPublicArrayName</a> (cp, IntentSig, PublicArrayName);
00245     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>);
00246 
00247     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a220">EnableGlobalDict</a>(lpMem);
00248     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a221">BeginGlobalDict</a>(lpMem);
00249 
00250     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a215">CreateInputArray</a> (lpMem, nInputCh, nInputTable,
00251              (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) PublicArrayName, Tag, Buff, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00252 
00253     i = nInputTable * nInputCh +
00254         nGrids * nGrids * nGrids * nOutputCh;
00255     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a216">CreateOutputArray</a> (lpMem, nOutputCh, nOutputTable, i,
00256              (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) PublicArrayName, Tag, Buff, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00257 
00258     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a222">EndGlobalDict</a>(lpMem);
00259 
00260 <span class="comment">//************* Start writing  CRD  ****************************</span>
00261     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00262     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00263 
00264  <span class="comment">//********** Send Black/White Point.</span>
00265     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
00266 
00267  <span class="comment">//********** Send PQR - used for Absolute Colorimetric *****</span>
00268     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
00269 
00270  <span class="comment">//********** Send LMN - For Absolute Colorimetric use WhitePoint's XYZs</span>
00271     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a205">SendCRDLMN</a>(lpMem, InputIntent, IlluminantWP, MediaWP, PCS);
00272 
00273  <span class="comment">// ******** Create MatrixABC and  EncodeABC  stuff</span>
00274     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a206">SendCRDABC</a>(lpMem, PublicArrayName, 
00275         PCS, nInputCh, Buff, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, Tag, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00276 
00277  <span class="comment">//********** /RenderTable</span>
00278     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a29">RenderTableTag</a>);
00279     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00280 
00281     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Na</span>
00282     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Nb</span>
00283     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Nc</span>
00284 
00285     lpLineStart = lpMem;
00286     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00287     nNumbers = nGrids * nGrids * nOutputCh;
00288     <span class="keywordflow">for</span> (i = 0; i &lt; nGrids; i++)        <span class="comment">// Na strings should be sent</span>
00289     {
00290         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00291         lpLineStart = lpMem;
00292         <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00293         {
00294             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a37">lpcpLut8Type</a>) Buff)-&gt;lut.data) +
00295                 nInputTable * nInputCh +
00296                 nNumbers * i;
00297         } <span class="keywordflow">else</span>
00298         {
00299             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a36">lpcpLut16Type</a>) Buff)-&gt;lut.data) +
00300                 2 * nInputTable * nInputCh +
00301                 2 * nNumbers * i;
00302         }
00303         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)               <span class="comment">// Output ASCII CRD</span>
00304         {
00305             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a2">BeginString</a>);
00306             <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00307                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a227">WriteHexBuffer</a> (lpMem, lpTable, lpLineStart, nNumbers);
00308             <span class="keywordflow">else</span>
00309             {
00310                 <span class="keywordflow">for</span> (j = 0; j &lt; nNumbers; j++)
00311                 {
00312                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a45">WriteHex</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable) / 256);
00313                     lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00314                     <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00315                     {
00316                         lpLineStart = lpMem;
00317                         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00318                     }
00319                 }
00320             }
00321             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a3">EndString</a>);
00322         } <span class="keywordflow">else</span>
00323         {                               <span class="comment">// Output BINARY CRD</span>
00324             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a228">WriteStringToken</a> (lpMem, 143, nNumbers);
00325             <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00326                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a229">WriteByteString</a> (lpMem, lpTable, nNumbers);
00327             <span class="keywordflow">else</span>
00328                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a230">WriteInt2ByteString</a> (lpMem, lpTable, nNumbers);
00329         }
00330     }
00331 
00332     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>); <span class="comment">// End array</span>
00333     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nOutputCh);   <span class="comment">// Send down m</span>
00334 
00335  <span class="comment">//********** Send Output Table.</span>
00336     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a207">SendCRDOutputTable</a>(lpMem, PublicArrayName, 
00337         nOutputCh, Tag, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00338 
00339     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>); <span class="comment">// End array</span>
00340     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
00341 
00342     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>);
00343 
00344 <span class="comment">// Testing Convert binary to ascii</span>
00345 <span class="comment">//    i = ConvertBinaryData2Ascii(lpOldMem, (SINT)(lpMem - lpOldMem), Ret);</span>
00346 <span class="comment">//    lpMem = lpOldMem + i;</span>
00347 <span class="comment">// Testing Convert binary to ascii</span>
00348 
00349     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00350     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
00351 }
00352 <span class="comment">/***************************************************************************</span>
00353 <span class="comment">*                               GetRevCurve</span>
00354 <span class="comment">*  function:</span>
00355 <span class="comment">*  prototype:</span>
00356 <span class="comment">*       BOOL  GetRevCurve(</span>
00357 <span class="comment">*                          MEMPTR       Buff,</span>
00358 <span class="comment">*                          MEMPTR       lpRevCurve)</span>
00359 <span class="comment">*  parameters:</span>
00360 <span class="comment">*       Buff        --</span>
00361 <span class="comment">*       lpRevCurve  --</span>
00362 <span class="comment">*  returns:</span>
00363 <span class="comment">*       BOOL        --  TRUE:  successful,</span>
00364 <span class="comment">*                       FALSE: otherwise.</span>
00365 <span class="comment">***************************************************************************/</span>
00366 
00367 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00368"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a102">00368</a> <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (MEMPTR lpBuff, MEMPTR lpCurve, MEMPTR lpRevCurve)
00369 {
00370     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, j, nCount;
00371     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00372     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a> lpInput, lpOutput;
00373     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> fTemp;
00374     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> iBegin, iEnd, iTemp;
00375     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00376     lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.data);
00377     lpOutput = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve;
00378     lpInput = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpCurve;
00379 
00380     <span class="keywordflow">for</span> (i = 0; i &lt; nCount; i++)
00381     {
00382         lpInput[i] = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00383         lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00384     }
00385 
00386     j = nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>;
00387     <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)
00388     {
00389         fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) i *65535 / (j - 1);
00390         lpOutput[i] = (fTemp &lt; 65535) ? (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) fTemp : (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) 65535;
00391     }
00392 
00393     <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)
00394     {
00395         iBegin = 0;
00396         iEnd = nCount - 1;
00397         <span class="keywordflow">for</span> (;;)
00398         {
00399             <span class="keywordflow">if</span> ((iEnd - iBegin) &lt;= 1)
00400                 <span class="keywordflow">break</span>;
00401             iTemp = (iEnd + iBegin) / 2;
00402             <span class="keywordflow">if</span> (lpOutput[i] &lt; lpInput[iTemp])
00403                 iEnd = iTemp;
00404             <span class="keywordflow">else</span>
00405                 iBegin = iTemp;
00406         }
00407         <span class="keywordflow">if</span> (lpOutput[i] &lt;= lpInput[iBegin])
00408             fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) iBegin;
00409         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpOutput[i] &gt;= lpInput[iEnd])
00410             fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) iEnd;
00411         <span class="keywordflow">else</span>
00412         {
00413             fTemp = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) (lpInput[iEnd] - lpOutput[i])) /
00414                 (lpOutput[i] - lpInput[iBegin]);
00415             fTemp = (iBegin * fTemp + iEnd) / (fTemp + 1);
00416         }
00417         fTemp = (fTemp / (nCount - 1)) * 65535;
00418         lpOutput[i] = (fTemp &lt; 65535) ? (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) fTemp : (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) 65535;
00419     }
00420 
00421     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00422 }
00423 <span class="comment">/***************************************************************************</span>
00424 <span class="comment">*                               CreateMonoCRD</span>
00425 <span class="comment">*  function:</span>
00426 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00427 <span class="comment">*    from the data supplied in the GrayTRC tag.</span>
00428 <span class="comment">*  prototype:</span>
00429 <span class="comment">*       BOOL EXTERN CreateMonoCRD(</span>
00430 <span class="comment">*                          CHANDLE      cp,</span>
00431 <span class="comment">*                          SINT         Index,</span>
00432 <span class="comment">*                          MEMPTR       lpMem)</span>
00433 <span class="comment">*  parameters:</span>
00434 <span class="comment">*       cp          --  Color Profile handle</span>
00435 <span class="comment">*       Index       --  Index of the tag</span>
00436 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00437 <span class="comment">*  returns:</span>
00438 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00439 <span class="comment">*                         0 otherwise.</span>
00440 <span class="comment">*                       Returns number of bytes required/transferred</span>
00441 <span class="comment">***************************************************************************/</span>
00442 <span class="comment">//  According to the spec this tag-based function only converts from</span>
00443 <span class="comment">//  Device to PCS, so we need to create an inverse function to perform</span>
00444 <span class="comment">//  PCS-&gt;device conversion. By definition the CRD is only</span>
00445 <span class="comment">//  for XYZ-&gt;DeviceRGB/CMYK conversion.</span>
00446 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00447"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a103">00447</a> <a class="code" href="../../d2/d9/ps2_8c.html#a187">CreateMonoCRD</a> (CHANDLE cp, SINT Index, MEMPTR lpMem, DWORD InputIntent)
00448 {
00449     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nCount;
00450     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag, PCS;
00451 
00452     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00453     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00454     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00455     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpCurve, lpRevCurve;
00456     HGLOBAL hRevCurve;
00457     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret = 0;
00458     HGLOBAL hMem;
00459     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i;
00460     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00461     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00462     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> MediaWP[3];
00463     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpLineStart;
00464  <span class="comment">// Check if we can generate the CRD</span>
00465     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00466         (Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>) ||
00467         !<a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; PCS) ||
00468         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) ||
00469         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) ||
00470         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00471     {
00472         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != Buff)
00473         {
00474             <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00475         }
00476         <span class="keywordflow">return</span> (0);
00477     }
00478     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) Buff)-&gt;curve.count);
00479 
00480  <span class="comment">// Estimate the memory size required to hold CRD</span>
00481  <span class="comment">// SRGB98</span>
00482     Ret = nCount * 6 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + <span class="comment">// Number of INT elements</span>
00483         2048;                           <span class="comment">// + other PS stuff</span>
00484     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)                  <span class="comment">// This is a size request</span>
00485     {
00486         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00487         <span class="keywordflow">return</span> (Ret);
00488     }
00489     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (nCount * 2 * (<a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 1),
00490                    (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;hRevCurve, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRevCurve))
00491     {
00492         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00493         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00494     }
00495     lpCurve = lpRevCurve + 2 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> * nCount;
00496     <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (Buff, lpCurve, lpRevCurve);
00497 
00498  <span class="comment">//   GetCPCMMType (cp, (LPCSIG) &amp; Intent);   // Get Intent</span>
00499     <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00500 
00501  <span class="comment">// Support absolute whitePoint</span>
00502     <span class="keywordflow">if</span> (InputIntent == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>)
00503     {
00504         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; MediaWP)) <span class="comment">// .. Media WhitePoint</span>
00505         {
00506             MediaWP[0] = IlluminantWP[0];
00507             MediaWP[1] = IlluminantWP[1];
00508             MediaWP[2] = IlluminantWP[2];
00509         }
00510     }
00511 
00512 <span class="comment">//************* Start writing  CRD  ****************************</span>
00513     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00514     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00515 
00516  <span class="comment">//********** Send Black/White Point.</span>
00517     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
00518 
00519  <span class="comment">//********** /TransformPQR</span>
00520     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
00521 
00522  <span class="comment">//********** /MatrixLMN</span>
00523     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a205">SendCRDLMN</a>(lpMem, InputIntent, IlluminantWP, MediaWP, PCS);
00524 
00525  <span class="comment">//********** /MatrixABC</span>
00526     <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
00527     {   <span class="comment">// Switch ABC to BAC, since we want to output B which is converted from Y.</span>
00528         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>);
00529         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a103">MatrixABCXYZCRD</a>);
00530     }
00531     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00532     {
00533         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>);
00534         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a102">MatrixABCLabCRD</a>);
00535     }
00536  <span class="comment">//********** /EncodeABC</span>
00537     <span class="keywordflow">if</span> (nCount != 0)
00538     {
00539         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00540         lpLineStart = lpMem;
00541         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>);
00542         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00543         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>);
00544         <span class="keywordflow">if</span> (nCount == 1)                <span class="comment">// Gamma supplied in ui16 format</span>
00545         {
00546             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) Buff)-&gt;curve.data);
00547             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00548             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>);
00549         } <span class="keywordflow">else</span>
00550         {
00551             <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00552             {
00553                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a104">EncodeABCLab1</a>);
00554             }
00555             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>);
00556             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00557             <span class="keywordflow">for</span> (i = 0; i &lt; nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>; i++)
00558             {
00559                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve)));
00560                 lpRevCurve += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00561                 <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00562                 {
00563                     lpLineStart = lpMem;
00564                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00565                 }
00566             }
00567             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00568             lpLineStart = lpMem;
00569             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>);
00570             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>);
00571             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>);
00572         }
00573         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>);
00574         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>);
00575         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>);
00576         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00577     }
00578     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
00579 
00580     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hRevCurve);
00581     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00582     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
00583 }
00584 
00585 <span class="comment">// SRGB98 start</span>
00586 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00587"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a104">00587</a> <a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(CHANDLE cp, CSIG icSigXTRCTag, LPSINT pIndex, LPSINT pTRCSize)
00588 {
00589     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag;
00590 
00591     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigXTRCTag, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) pIndex) ||
00592         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, *pIndex, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00593         !(Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>) ||
00594         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, *pIndex, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) pTRCSize))
00595     {
00596         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00597     }
00598     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00599 }
00600 
00601 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00602"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a105">00602</a> <a class="code" href="../../d2/d9/ps2_8c.html#a190">DoesTRCAndColorantTagExist</a> (CHANDLE cp)
00603 {
00604     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00605         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a> ) &amp;&amp;
00606         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) &amp;&amp;
00607         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a> ) &amp;&amp;
00608         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00609         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a> ))
00610     {
00611         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00612     }
00613 
00614     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00615 }
00616 
00617 <span class="keyword">static</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00618"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">00618</a> <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (CHANDLE cp, MEMPTR lpMem, MEMPTR lpBuff, 
00619                 MEMPTR lpRevCurve, CSIG CPTag, BOOL AllowBinary)
00620 {
00621     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, nCount;
00622     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00623     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem, lpLineStart;
00624     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpCurve;
00625 
00626     lpOldMem = lpMem;
00627 
00628     lpLineStart = lpMem;
00629     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00630     <span class="keywordflow">if</span> (nCount &gt; 1)
00631     {
00632         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a57">Slash</a>);
00633         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>);
00634         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) CPTag);
00635 
00636         lpCurve = lpRevCurve + 2 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> * nCount;
00637         <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (lpBuff, lpCurve, lpRevCurve);
00638 
00639         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)           <span class="comment">// Output ASCII DATA</span>
00640         {
00641             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00642             <span class="keywordflow">for</span> (i = 0; i &lt; nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>; i++)
00643             {
00644                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve)));
00645                 lpRevCurve += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00646                 <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00647                 {
00648                     lpLineStart = lpMem;
00649                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00650                 }
00651             }
00652             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00653         } <span class="keywordflow">else</span>
00654         {                           <span class="comment">// Output BINARY DATA</span>
00655             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a224">WriteHNAToken</a> (lpMem, 149, nCount);
00656             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a226">WriteIntStringU2S_L</a> (lpMem, lpRevCurve, nCount);
00657         }
00658     }
00659     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a49">DefOp</a>);
00660     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpOldMem));
00661 }
00662 
00663 <span class="keyword">static</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00664"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">00664</a> <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (CHANDLE cp, MEMPTR lpMem, MEMPTR lpBuff, 
00665               CSIG CPTag, BOOL AllowBinary)
00666 {
00667     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nCount;
00668     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem;
00669     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00670 
00671     lpOldMem = lpMem;
00672     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>);
00673     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00674     <span class="keywordflow">if</span> (nCount != 0)
00675     {
00676         <span class="keywordflow">if</span> (nCount == 1)            <span class="comment">// Gamma supplied in ui16 format</span>
00677         {
00678             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.data);
00679             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00680             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>);
00681         } <span class="keywordflow">else</span>
00682         {
00683             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>);
00684             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>);
00685             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) CPTag);
00686 
00687             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)       <span class="comment">// Output ASCII CS</span>
00688             {
00689                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>);
00690             } <span class="keywordflow">else</span>
00691             {                       <span class="comment">// Output BINARY CS</span>
00692                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a83">IndexArray16b</a>);
00693             }
00694             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>);
00695             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>);
00696         }
00697     }
00698     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>);
00699     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpOldMem));
00700 }
00701 
00702 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00703"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a108">00703</a> <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(CHANDLE cp, <span class="keywordtype">double</span> FAR *lpArray, CSIG CPTag)
00704 {
00705     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00706     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00707     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00708     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00709     HGLOBAL hBuff;
00710 
00711     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, CPTag, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00712         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) &amp;&amp;
00713         <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hBuff, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) &amp;&amp;
00714         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00715     {
00716         lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp; (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a38">lpcpXYZType</a>) Buff)-&gt;data);
00717         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
00718         {
00719             *lpArray++ = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>)<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a> (lpTable);
00720             lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a192">icS15Fixed16Number</a>);
00721         }
00722         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hBuff);
00723     }
00724     <span class="keywordflow">return</span> ( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00725 }
00726 <span class="comment">/***************************************************************************</span>
00727 <span class="comment">*                           CreateMatrixCRD</span>
00728 <span class="comment">*  function:</span>
00729 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00730 <span class="comment">*    from the data supplied in the redTRC, greenTRC, blueTRA, redColorant,</span>
00731 <span class="comment">*    greenColorant and BlueColorant tags</span>
00732 <span class="comment">*  prototype:</span>
00733 <span class="comment">*       BOOL EXTERN CreateMatrixCRD(</span>
00734 <span class="comment">*                          CHANDLE      cp,</span>
00735 <span class="comment">*                          MEMPTR       lpMem,</span>
00736 <span class="comment">*                          BOOL         AllowBinary)</span>
00737 <span class="comment">*  parameters:</span>
00738 <span class="comment">*       cp          --  Color Profile handle</span>
00739 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00740 <span class="comment">*       AllowBinary --</span>
00741 <span class="comment">*  returns:</span>
00742 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00743 <span class="comment">*                         0 otherwise.</span>
00744 <span class="comment">*                       Returns number of bytes required/transferred</span>
00745 <span class="comment">***************************************************************************/</span>
00746 <span class="comment">// With matrix/TRC model, only the CIEXYZ encoding of the PCS can be used.</span>
00747 <span class="comment">// So, we don't need to worry about CIELAB.</span>
00748 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00749"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a109">00749</a> <a class="code" href="../../d2/d9/ps2_8c.html#a234">CreateMatrixCRD</a> (CHANDLE cp, MEMPTR lpMem, DWORD InputIntent, BOOL AllowBinary)
00750 {
00751     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> RedTRCIndex, GreenTRCIndex, BlueTRCIndex;
00752     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, MemSize;
00753     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nRedCount, nGreenCount, nBlueCount;
00754     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpRed = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,lpGreen, lpBlue;
00755     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> RedTRCSize = 0, GreenTRCSize = 0, BlueTRCSize = 0;
00756     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00757     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpRevCurve;
00758     HGLOBAL hRevCurve;
00759     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret = 0;
00760     HGLOBAL hMem;
00761     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00762     <span class="keywordtype">double</span> Colorant[9];
00763     <span class="keywordtype">double</span> RevColorant[9];
00764  
00765  <span class="comment">// Check if we can generate the CRD</span>
00766     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, &amp;RedTRCIndex, &amp;RedTRCSize) ||
00767         !<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, &amp;GreenTRCIndex, &amp;GreenTRCSize) ||
00768         !<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, &amp;BlueTRCIndex, &amp;BlueTRCSize))
00769     {
00770         <span class="keywordflow">return</span> 0;
00771     }
00772     MemSize = RedTRCSize + GreenTRCSize + BlueTRCSize;
00773     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRed))
00774         <span class="keywordflow">return</span> 0;
00775 
00776     lpGreen = lpRed + RedTRCSize;
00777     lpBlue = lpGreen + GreenTRCSize;
00778     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, RedTRCIndex, lpRed, RedTRCSize) ||
00779         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, GreenTRCIndex, lpGreen, GreenTRCSize ) ||
00780         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, BlueTRCIndex, lpBlue, BlueTRCSize ))
00781     {
00782         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00783         <span class="keywordflow">return</span> (0);
00784     }
00785     nRedCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpRed)-&gt;curve.count);
00786     nGreenCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpGreen)-&gt;curve.count);
00787     nBlueCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBlue)-&gt;curve.count);
00788 
00789  <span class="comment">// Estimate the memory size required to hold CRD</span>
00790     Ret = (nRedCount + nGreenCount + nBlueCount) * 6 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 
00791         2048;                <span class="comment">// Number of INT elements + other PS stuff</span>
00792     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)       <span class="comment">// This is a size request</span>
00793     {
00794         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00795         <span class="keywordflow">return</span> (Ret);
00796     }
00797 
00798     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (nRedCount * 2 * (<a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 1),
00799                   (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;hRevCurve, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRevCurve))
00800     {
00801         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00802         <span class="keywordflow">return</span> (0);
00803     }
00804 
00805     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a220">EnableGlobalDict</a>(lpMem);
00806     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a221">BeginGlobalDict</a>(lpMem);
00807     
00808     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpRed, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00809     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpGreen, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00810     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpBlue, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00811 
00812     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a222">EndGlobalDict</a>(lpMem);
00813 
00814  <span class="comment">//   GetCPCMMType (cp, (LPCSIG) &amp; Intent);   // Get Intent</span>
00815     <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00816 
00817  <span class="comment">//************* Start writing  CRD  ****************************</span>
00818     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>);
00819 
00820     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00821     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00822 
00823  <span class="comment">//********** Send Black/White Point.</span>
00824     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
00825 
00826  <span class="comment">//********** /TransformPQR</span>
00827     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
00828 
00829  <span class="comment">//********** /MatrixLMN</span>
00830     <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[0], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>);
00831     <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[3], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>);
00832     <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[6], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>);
00833     <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a56">InvertMatrix</a> (Colorant, RevColorant);
00834 
00835     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a27">MatrixLMNTag</a>);
00836 
00837     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00838     <span class="keywordflow">for</span> (i = 0; i &lt; 9; i++)
00839     {
00840         lpMem += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a46">WriteFloat</a> (lpMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>)RevColorant[i]);
00841     }
00842     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00843 
00844  <span class="comment">//********** /EncodeABC</span>
00845     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>);
00846     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00847 
00848     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00849     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpRed, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00850     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00851     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpGreen, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00852     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00853     lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpBlue, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00854     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00855 
00856     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
00857 
00858     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>);
00859 
00860     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hRevCurve);
00861     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00862     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
00863 }
00864 <span class="comment">// SRGB98 End</span>
00865 
00866 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>
<a name="l00867"></a><a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a110">00867</a> <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a29">GetPS2ColorRenderingDictionary</a> (
00868                                 CHANDLE cp,
00869                                 DWORD Intent,
00870                                 MEMPTR lpMem,
00871                                 LPDWORD lpcbSize,
00872                                 BOOL AllowBinary)
00873 {
00874     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00875     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00876     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> icSigPs2CRDx, icSigBToAx;
00877 
00878     <span class="keywordflow">if</span> (!cp)
00879         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00880 
00881     <span class="keywordflow">if</span> ((lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (*lpcbSize == 0))
00882     {
00883         lpMem = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00884         *lpcbSize = 0;
00885     }
00886     Ret = 0;
00887     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) * lpcbSize;
00888 
00889     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>)
00890     {
00891         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00892             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a46">icSigPs2CRD0Tag</a>;
00893             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>;
00894             <span class="keywordflow">break</span>;
00895 
00896         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00897             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a47">icSigPs2CRD1Tag</a>;
00898             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>;
00899             <span class="keywordflow">break</span>;
00900 
00901         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00902             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a48">icSigPs2CRD2Tag</a>;
00903             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>;
00904             <span class="keywordflow">break</span>;
00905 
00906         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00907             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a49">icSigPs2CRD3Tag</a>;
00908             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>;
00909             <span class="keywordflow">break</span>;
00910 
00911         <span class="keywordflow">default</span>:
00912             *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) Ret;
00913             <span class="keywordflow">return</span> (Ret &gt; 0);
00914     }
00915 
00916     <span class="keywordflow">if</span> (
00917         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, icSigPs2CRDx) &amp;&amp;
00918          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigPs2CRDx, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00919          <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; Ret) &amp;&amp;
00920          ((<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> == 0) ||
00921           <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>)) &amp;&amp;
00922          (Ret = <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a55">Convert2Ascii</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>, Ret, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
00923         ) ||
00924         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, icSigBToAx) &amp;&amp;
00925          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigBToAx, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00926          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a188">CreateLutCRD</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
00927         ) ||
00928         <span class="comment">// SRGB98 Support Windows 98 sRGB icc profile.</span>
00929         <span class="comment">// Create CRD from TRC and Colorant Tags.</span>
00930         (<a class="code" href="../../d2/d9/ps2_8c.html#a190">DoesTRCAndColorantTagExist</a> (cp) &amp;&amp;
00931          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a234">CreateMatrixCRD</a> (cp, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
00932         ) ||
00933         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) &amp;&amp;
00934          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00935          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a187">CreateMonoCRD</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>))
00936         )
00937        )
00938     {
00939     }
00940 
00941     *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) Ret;
00942     <span class="keywordflow">return</span> (Ret &gt; 0);
00943 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:11 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
