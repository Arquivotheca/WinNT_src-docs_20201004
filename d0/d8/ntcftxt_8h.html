<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ntcftxt.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ntcftxt.h File Reference</h1><code>#include &lt;tchar.h&gt;</code><br>
<code>#include "<a class="el" href="../../d8/d8/ntsend_8h-source.html">ntsend.h</a>"</code><br>

<p>
<a href="../../d1/d7/ntcftxt_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a0">IS_ANSI</a>&nbsp;&nbsp;&nbsp;TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a1">StringDuplicate</a>&nbsp;&nbsp;&nbsp;TEXT_FN(StringDuplicate)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a2">InitClsMenuName</a>&nbsp;&nbsp;&nbsp;TEXT_FN(InitClsMenuName)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a10">FindWindowEx</a> (HWND hwndParent, HWND hwndChild, LPCTSTR pClassName, LPCTSTR pWindowName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a11">FindWindow</a> (LPCTSTR pClassName, LPCTSTR pWindowName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a12">GetClassInfo</a> (HINSTANCE hmod OPTIONAL, LPCTSTR pszClassName, LPWNDCLASS pwc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a13">GetClassInfoEx</a> (HINSTANCE hmod OPTIONAL, LPCTSTR pszClassName, LPWNDCLASSEX pwc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a14">GetClipboardFormatName</a> (UINT wFormat, LPTSTR pFormatName, int chMaxCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a15">GetKeyNameText</a> (LONG lParam, LPTSTR pString, int cchSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a16">GetMessage</a> (LPMSG pmsg, HWND hwnd, UINT wMsgFilterMin, UINT wMsgFilterMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a17">GetKeyboardLayoutName</a> (LPTSTR pwszKL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a18">MapVirtualKey</a> (UINT wCode, UINT wMapType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a19">MapVirtualKeyEx</a> (UINT wCode, UINT wMapType, HKL hkl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a> (HWND hwnd, UINT wMsg, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a21">PostThreadMessage</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idThread, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPTSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a22">StringDuplicate</a> (LPCTSTR ptszDup)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a23">InitClsMenuName</a> (<a class="el" href="../../d8/d0/structtagCLSMENUNAME.html">PCLSMENUNAME</a> pcmn, LPCTSTR lpszMenuName, <a class="el" href="../../d8/d1/struct__IN__STRING.html">PIN_STRING</a> pstrMenuName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a24">SetClassLongPtr</a> (HWND hwnd, int nIndex, LONG_PTR dwNewLong)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a25">RegisterWindowMessage</a> (LPCTSTR pString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a26">RemoveProp</a> (HWND hwnd, LPCTSTR pString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a27">SendMessageCallback</a> (HWND hwnd, UINT wMsg, WPARAM wParam, LPARAM lParam, SENDASYNCPROC lpResultCallBack, ULONG_PTR dwData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a28">SendNotifyMessage</a> (HWND hwnd, UINT wMsg, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a29">SetProp</a> (HWND hwnd, LPCTSTR pString, HANDLE hData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a30">UnregisterClass</a> (LPCTSTR pszClassName, HINSTANCE hModule)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a31">VkKeyScan</a> (TCHAR cChar)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a32">VkKeyScanEx</a> (TCHAR cChar, HKL hkl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a33">EnumDisplayDevices</a> (LPCTSTR lpszDevice, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iDevNum, PDISPLAY_DEVICE lpDisplayDevice, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a34">EnumDisplaySettings</a> (LPCTSTR lpszDeviceName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iModeNum, LPDEVMODE lpDevMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a35">EnumDisplaySettingsEx</a> (LPCTSTR lpszDeviceName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iModeNum, LPDEVMODE lpDevMode, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a36">ChangeDisplaySettings</a> (LPDEVMODE lpDevMode, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a37">ChangeDisplaySettingsEx</a> (LPCTSTR lpszDeviceName, LPDEVMODE lpDevMode, HWND hwnd, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a38">CallMsgFilter</a> (LPMSG pmsg, int nCode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a39">DrawCaptionTemp</a> (HWND hwnd, HDC hdc, LPCRECT lprc, HFONT hFont, HICON hicon, LPCTSTR lpText, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI UINT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a40">RealGetWindowClass</a> (HWND hwnd, LPTSTR ptszClassName, UINT cchClassNameMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a41">GetAltTabInfo</a> (HWND hwnd, int iItem, PALTTABINFO pati, LPTSTR pszItemText, UINT cchItemText OPTIONAL)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HWND TEXT_FN(&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a3">InternalFindWindowEx</a> )(HWND hwndParent, HWND hwndChild, LPCTSTR pClassName, LPCTSTR pWindowName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WNDPROC&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a4">mpPfnAddress</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HKL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a5">hMVKCachedHKL</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a6">uMVKCachedCP</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ATOM TEXT_FN(&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a7">RegisterClassExWOW</a> )(WNDCLASSEX *lpWndClass, LPDWORD pdwWOWstuff, WORD fnid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HKL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a8">hVKSCachedHKL</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d8/ntcftxt_8h.html#a9">uVKSCachedCP</a> = 0</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="ntcftxt.h::InitClsMenuName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define InitClsMenuName&nbsp;&nbsp;&nbsp;TEXT_FN(InitClsMenuName)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00534">534</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00579">SetClassLongPtr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ntcftxt.h::IS_ANSI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IS_ANSI&nbsp;&nbsp;&nbsp;TRUE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00020">20</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ntcftxt.h::StringDuplicate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define StringDuplicate&nbsp;&nbsp;&nbsp;TEXT_FN(StringDuplicate)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00517">517</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00535">InitClsMenuName()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a38" doxytag="ntcftxt.h::CallMsgFilter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CallMsgFilter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPMSG&nbsp;</td>
          <td class="mdname" nowrap> <em>pmsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nCode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
UNICODE 
<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01460">1460</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00014">BEGINCALLCONNECT</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02253">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01266">IsHooked</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00072">MSGERRORCODE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09413">NtUserCallMsgFilter()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00133">RESERVED_MSG_BITS</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00490">RtlMBMessageWParamCharToWCS()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, and <a class="el" href="../../d6/d8/dlgmgr2_8c-source.html#l00317">IsDialogMessageW()</a>.
<p>
<pre class="fragment"><div>01463 {
01464     <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pci;
01465     MSG         <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
01466 
01467     <a class="code" href="../../d7/d9/ntsend_8h.html#a0">BEGINCALLCONNECT</a>()
01468 
01469         <span class="comment">/*</span>
01470 <span class="comment">         * If we're not hooked, don't bother going to the server</span>
01471 <span class="comment">         */</span>
01472         pci = GetClientInfo();
01473         if (!IsHooked(pci, (WH_MSGFILTER | WH_SYSMSGFILTER))) {
01474             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01475         }
01476 
01477         <span class="comment">/*</span>
01478 <span class="comment">         * Don't allow apps to use the hiword of the message parameter.</span>
01479 <span class="comment">         */</span>
01480         <span class="keywordflow">if</span> (pmsg-&gt;message &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a8">RESERVED_MSG_BITS</a>) {
01481             <a class="code" href="../../d5/d8/crecv_8c.html#a8">MSGERRORCODE</a>(ERROR_INVALID_PARAMETER);
01482         }
01483         <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> = *pmsg;
01484 
01485 <span class="preprocessor">#ifndef UNICODE</span>
01486 <span class="preprocessor"></span>        <span class="keywordflow">switch</span> (pmsg-&gt;message) {
01487 <span class="preprocessor">#ifdef FE_SB // CallMsgFilter()</span>
01488 <span class="preprocessor"></span>        <span class="keywordflow">case</span> WM_CHAR:
01489         <span class="keywordflow">case</span> EM_SETPASSWORDCHAR:
01490 <span class="preprocessor">#ifndef LATER</span>
01491 <span class="preprocessor"></span>             <span class="comment">/*</span>
01492 <span class="comment">              * we should not return "TRUE" everytime for DBCS leadbyte character...</span>
01493 <span class="comment">              * but should convert DBCS character to Unicode correctly.. How I can do ??</span>
01494 <span class="comment">              * then ,finally, we just take what we did in NT 3.51, it means do nothing..</span>
01495 <span class="comment">              */</span>
01496 <span class="preprocessor">#else</span>
01497 <span class="preprocessor"></span>             <span class="comment">/*</span>
01498 <span class="comment">              * Build DBCS-aware message.</span>
01499 <span class="comment">              */</span>
01500              <a class="code" href="../../d6/d0/usercli_8h.html#a294">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>(pmsg-&gt;message,pmsg-&gt;wParam,TRUE);
01501              <span class="comment">/*</span>
01502 <span class="comment">              * Fall through.....</span>
01503 <span class="comment">              */</span>
01504 <span class="preprocessor">#endif // LATER</span>
01505 <span class="preprocessor"></span><span class="preprocessor">#else</span>
01506 <span class="preprocessor"></span>        <span class="keywordflow">case</span> WM_CHAR:
01507         <span class="keywordflow">case</span> EM_SETPASSWORDCHAR:
01508 <span class="preprocessor">#endif // FE_SB</span>
01509 <span class="preprocessor"></span>        <span class="keywordflow">case</span> WM_CHARTOITEM:
01510         <span class="keywordflow">case</span> WM_DEADCHAR:
01511         <span class="keywordflow">case</span> WM_SYSCHAR:
01512         <span class="keywordflow">case</span> WM_SYSDEADCHAR:
01513         <span class="keywordflow">case</span> WM_MENUCHAR:
01514 <span class="preprocessor">#ifdef FE_IME // CallMsgFilter()</span>
01515 <span class="preprocessor"></span>        <span class="keywordflow">case</span> WM_IME_CHAR:
01516         <span class="keywordflow">case</span> WM_IME_COMPOSITION:
01517 <span class="preprocessor">#endif // FE_IME</span>
01518 <span class="preprocessor"></span>
01519             <a class="code" href="../../d5/d6/chartran_8c.html#a5">RtlMBMessageWParamCharToWCS</a>( <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message, &amp;(<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam));
01520             <span class="keywordflow">break</span>;
01521         }
01522 <span class="preprocessor">#endif </span>
01523 <span class="preprocessor"></span>
01524 <span class="preprocessor"></span>        retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a323">NtUserCallMsgFilter</a>(
01525                 &amp;msg,
01526                 nCode);
01527 
01528     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
01529     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
01530 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ntcftxt.h::ChangeDisplaySettings" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG ChangeDisplaySettings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDEVMODE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01372">1372</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01386">ChangeDisplaySettingsEx()</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>01375 {
01376 
01377     <span class="comment">/*</span>
01378 <span class="comment">     * Compatibility</span>
01379 <span class="comment">     */</span>
01380     <span class="keywordflow">if</span> (lpDevMode)
01381         lpDevMode-&gt;dmDriverExtra = 0;
01382 
01383     <span class="keywordflow">return</span> <a class="code" href="../../d0/d8/ntcftxt_8h.html#a37">ChangeDisplaySettingsEx</a>(NULL, lpDevMode, NULL, dwFlags, NULL);
01384 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ntcftxt.h::ChangeDisplaySettingsEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG ChangeDisplaySettingsEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszDeviceName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDEVMODE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01386">1386</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09380">NtUserChangeDisplaySettings()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, and <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01372">ChangeDisplaySettings()</a>.
<p>
<pre class="fragment"><div>01392 {
01393 <span class="preprocessor">#ifndef UNICODE</span>
01394 <span class="preprocessor"></span>    ANSI_STRING     AnsiString;
01395 <span class="preprocessor">#endif</span>
01396 <span class="preprocessor"></span>
01397     UNICODE_STRING  UnicodeString;
01398     PUNICODE_STRING pUnicodeString = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01399     LONG            status = DISP_CHANGE_FAILED;
01400     LPDEVMODEW      lpDevModeW;
01401 
01402     <span class="keywordflow">if</span> (lpszDeviceName) {
01403 
01404 <span class="preprocessor">#ifdef UNICODE</span>
01405 <span class="preprocessor"></span>
01406         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;UnicodeString, lpszDeviceName);
01407 
01408 <span class="preprocessor">#else</span>
01409 <span class="preprocessor"></span>
01410         UnicodeString = NtCurrentTeb()-&gt;StaticUnicodeString;
01411         <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(&amp;AnsiString, (LPSTR)lpszDeviceName);
01412 
01413         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(&amp;UnicodeString,
01414                                                      &amp;AnsiString,
01415                                                      FALSE))) {
01416             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01417         }
01418 
01419 <span class="preprocessor">#endif</span>
01420 <span class="preprocessor"></span>
01421         pUnicodeString = &amp;UnicodeString;
01422     }
01423 
01424 <span class="preprocessor">#ifdef UNICODE</span>
01425 <span class="preprocessor"></span>
01426     lpDevModeW = lpDevMode;
01427 
01428 <span class="preprocessor">#else</span>
01429 <span class="preprocessor"></span>
01430     lpDevModeW = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01431 
01432     <span class="keywordflow">if</span> (lpDevMode) {
01433 
01434         lpDevModeW = GdiConvertToDevmodeW(lpDevMode);
01435 
01436         <span class="keywordflow">if</span> (lpDevModeW == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01437 
01438             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01439         }
01440     }
01441 
01442 <span class="preprocessor">#endif</span>
01443 <span class="preprocessor"></span>
01444     status = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a322">NtUserChangeDisplaySettings</a>(pUnicodeString,
01445                                          lpDevModeW,
01446                                          hwnd,
01447                                          dwFlags,
01448                                          lParam);
01449 
01450 <span class="preprocessor">#ifndef UNICODE</span>
01451 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (lpDevMode) {
01452         LocalFree(lpDevModeW);
01453     }
01454 <span class="preprocessor">#endif</span>
01455 <span class="preprocessor"></span>
01456     <span class="keywordflow">return</span> status;
01457 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ntcftxt.h::DrawCaptionTemp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DrawCaptionTemp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HFONT&nbsp;</td>
          <td class="mdname" nowrap> <em>hFont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON&nbsp;</td>
          <td class="mdname" nowrap> <em>hicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01532">1532</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00316">_IN_STRING::fAllocated</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00262">FIRSTCOPYLPTSTRIDOPT</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00027">IsMetaFile()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09490">NtUserDrawCaptionTemp()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>.
<p>
<pre class="fragment"><div>01540 {
01541     HDC hdcr;
01542     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strText;
01543 
01544     <span class="comment">/*</span>
01545 <span class="comment">     * Make sure cleanup will work successfully</span>
01546 <span class="comment">     */</span>
01547     strText.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01548 
01549     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
01550 
01551         if (IsMetaFile(hdc)) return FALSE;
01552 
01553         hdcr = GdiConvertAndCheckDC(hdc);
01554         if (hdcr == (HDC)0)
01555             return FALSE;
01556 
01557         FIRSTCOPYLPTSTRIDOPT(&amp;strText, lpText);
01558 
01559         retval = (DWORD)NtUserDrawCaptionTemp(
01560                 hwnd,
01561                 hdc,
01562                 lprc,
01563                 hFont,
01564                 hicon,
01565                 strText.pstr,
01566                 flags);
01567 
01568     ERRORTRAP(0);
01569     CLEANUPLPTSTR(strText);
01570     ENDCALL(BOOL);
01571 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ntcftxt.h::EnumDisplayDevices" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnumDisplayDevices           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszDevice</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iDevNum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PDISPLAY_DEVICE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDisplayDevice</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01102">1102</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09312">NtUserEnumDisplayDevices()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">CICMUserInterface::AddMonitorTab()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00159">CMonitorList::Enumerate()</a>.
<p>
<pre class="fragment"><div>01107 {
01108     UNICODE_STRING  UnicodeString;
01109     PUNICODE_STRING pUnicodeString = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01110     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01111     DISPLAY_DEVICEW tmpDisplayDevice;
01112 
01113     <span class="comment">//</span>
01114     <span class="comment">// Clear out things to make sure the caller passes in appropriate</span>
01115     <span class="comment">// parameters</span>
01116     <span class="comment">//</span>
01117 
01118     ZeroMemory(((PUCHAR)lpDisplayDevice) + <span class="keyword">sizeof</span>(DWORD),
01119                lpDisplayDevice-&gt;cb - <span class="keyword">sizeof</span>(DWORD));
01120 
01121     tmpDisplayDevice.cb = <span class="keyword">sizeof</span>(DISPLAY_DEVICEW);
01122 
01123     <span class="keywordflow">if</span> (lpszDevice) {
01124 
01125 <span class="preprocessor">#ifdef UNICODE</span>
01126 <span class="preprocessor"></span>
01127         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;UnicodeString, lpszDevice);
01128 
01129 <span class="preprocessor">#else</span>
01130 <span class="preprocessor"></span>
01131         ANSI_STRING     AnsiString;
01132 
01133         UnicodeString = NtCurrentTeb()-&gt;StaticUnicodeString;
01134         <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(&amp;AnsiString, (LPSTR)lpszDevice);
01135 
01136         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(&amp;UnicodeString,
01137                                                      &amp;AnsiString,
01138                                                      FALSE))) {
01139             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01140         }
01141 
01142 <span class="preprocessor">#endif</span>
01143 <span class="preprocessor"></span>
01144         pUnicodeString = &amp;UnicodeString;
01145     }
01146 
01147     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a320">NtUserEnumDisplayDevices</a>(
01148                 pUnicodeString,
01149                 iDevNum,
01150                 &amp;tmpDisplayDevice,
01151                 dwFlags);
01152 
01153     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status))
01154     {
01155 <span class="preprocessor">#ifndef UNICODE</span>
01156 <span class="preprocessor"></span>        LPSTR psz;
01157 
01158         <span class="keywordflow">if</span> (lpDisplayDevice-&gt;cb &gt;= FIELD_OFFSET(DISPLAY_DEVICE, DeviceString)) {
01159             psz = (LPSTR)&amp;(lpDisplayDevice-&gt;DeviceName[0]);
01160             WCSToMB(&amp;(tmpDisplayDevice.DeviceName[0]), -1, &amp;psz, 32, FALSE);
01161         }
01162 
01163         <span class="keywordflow">if</span> (lpDisplayDevice-&gt;cb &gt;= FIELD_OFFSET(DISPLAY_DEVICE, StateFlags)) {
01164             psz = (LPSTR)&amp;(lpDisplayDevice-&gt;DeviceString[0]);
01165             WCSToMB(&amp;(tmpDisplayDevice.DeviceString[0]), -1, &amp;psz, 128, FALSE);
01166         }
01167 
01168         <span class="keywordflow">if</span> (lpDisplayDevice-&gt;cb &gt;= FIELD_OFFSET(DISPLAY_DEVICE, DeviceID)) {
01169             lpDisplayDevice-&gt;StateFlags = tmpDisplayDevice.StateFlags;
01170         }
01171 
01172         <span class="keywordflow">if</span> (lpDisplayDevice-&gt;cb &gt;= FIELD_OFFSET(DISPLAY_DEVICE, DeviceKey)) {
01173             psz = (LPSTR)&amp;(lpDisplayDevice-&gt;DeviceID[0]);
01174             WCSToMB(&amp;(tmpDisplayDevice.DeviceID[0]), -1, &amp;psz, 128, FALSE);
01175         }
01176         <span class="keywordflow">if</span> (lpDisplayDevice-&gt;cb &gt;= <span class="keyword">sizeof</span>(DISPLAY_DEVICE)) {
01177             psz = (LPSTR)&amp;(lpDisplayDevice-&gt;DeviceKey[0]);
01178             WCSToMB(&amp;(tmpDisplayDevice.DeviceKey[0]), -1, &amp;psz, 128, FALSE);
01179         }
01180 <span class="preprocessor">#else</span>
01181 <span class="preprocessor"></span>
01182         RtlMoveMemory(lpDisplayDevice,
01183                       &amp;tmpDisplayDevice,
01184                       lpDisplayDevice-&gt;cb);
01185 
01186 <span class="preprocessor">#endif</span>
01187 <span class="preprocessor"></span>
01188         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01189     }
01190 
01191     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01192 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ntcftxt.h::EnumDisplaySettings" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnumDisplaySettings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszDeviceName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iModeNum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDEVMODE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01194">1194</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01211">EnumDisplaySettingsEx()</a>.
<p>
<pre class="fragment"><div>01198 {
01199 
01200     <span class="comment">//</span>
01201     <span class="comment">// Work-around Win95 problem which does not require the caller</span>
01202     <span class="comment">// to initialize these two fields.</span>
01203     <span class="comment">//</span>
01204 
01205     lpDevMode-&gt;dmDriverExtra = 0;
01206     lpDevMode-&gt;dmSize = FIELD_OFFSET(DEVMODE, dmICMMethod);
01207 
01208     <span class="keywordflow">return</span> <a class="code" href="../../d0/d8/ntcftxt_8h.html#a35">EnumDisplaySettingsEx</a>(lpszDeviceName, iModeNum, lpDevMode, 0);
01209 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ntcftxt.h::EnumDisplaySettingsEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnumDisplaySettingsEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszDeviceName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iModeNum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDEVMODE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01211">1211</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09357">NtUserEnumDisplaySettings()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01194">EnumDisplaySettings()</a>.
<p>
<pre class="fragment"><div>01216 {
01217     UNICODE_STRING  UnicodeString;
01218     PUNICODE_STRING pUnicodeString = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01219     LPDEVMODEW      lpDevModeReserve;
01220     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>            retval = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01221     WORD            size = lpDevMode-&gt;dmSize;
01222 
01223     <span class="keywordflow">if</span> (lpszDeviceName) {
01224 
01225 <span class="preprocessor">#ifdef UNICODE</span>
01226 <span class="preprocessor"></span>
01227         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;UnicodeString, lpszDeviceName);
01228 
01229 <span class="preprocessor">#else</span>
01230 <span class="preprocessor"></span>
01231         ANSI_STRING     AnsiString;
01232 
01233         UnicodeString = NtCurrentTeb()-&gt;StaticUnicodeString;
01234         <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(&amp;AnsiString, (LPSTR)lpszDeviceName);
01235 
01236         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(&amp;UnicodeString,
01237                                                      &amp;AnsiString,
01238                                                      FALSE))) {
01239             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01240         }
01241 
01242 <span class="preprocessor">#endif</span>
01243 <span class="preprocessor"></span>
01244         pUnicodeString = &amp;UnicodeString;
01245     }
01246 
01247     <span class="comment">/*</span>
01248 <span class="comment">     * Currently -2 is reserved (undocumented function of the NT api.</span>
01249 <span class="comment">     * remove the check is win95 implements this.</span>
01250 <span class="comment">     * -&gt; -1 returns the content of the registry at the time of the call</span>
01251 <span class="comment">     *</span>
01252 <span class="comment">     *</span>
01253 <span class="comment">     * if (iModeNum == (DWORD) -2)</span>
01254 <span class="comment">     * {</span>
01255 <span class="comment">     *     return FALSE;</span>
01256 <span class="comment">     * }</span>
01257 <span class="comment">     *</span>
01258 <span class="comment">     *</span>
01259 <span class="comment">     * -1 should return the current DEVMODE for the device.</span>
01260 <span class="comment">     * This is handled in the kernel part of the function, so we pass it on.</span>
01261 <span class="comment">     *</span>
01262 <span class="comment">     *</span>
01263 <span class="comment">     *</span>
01264 <span class="comment">     * We will always request a full DEVMODE from the kernel.</span>
01265 <span class="comment">     * So allocate the space needed</span>
01266 <span class="comment">     *</span>
01267 <span class="comment">     */</span>
01268     lpDevModeReserve = <a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(HEAP_ZERO_MEMORY,
01269                                       <span class="keyword">sizeof</span>(DEVMODEW) + lpDevMode-&gt;dmDriverExtra);
01270 
01271     <span class="keywordflow">if</span> (lpDevModeReserve) {
01272 
01273         lpDevModeReserve-&gt;dmSize = <span class="keyword">sizeof</span>(DEVMODEW);
01274         lpDevModeReserve-&gt;dmDriverExtra = lpDevMode-&gt;dmDriverExtra;
01275 
01276         <span class="comment">/*</span>
01277 <span class="comment">         * Get the information</span>
01278 <span class="comment">         */</span>
01279         retval = (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a321">NtUserEnumDisplaySettings</a>(pUnicodeString,
01280                                                        iModeNum,
01281                                                        lpDevModeReserve,
01282                                                        dwFlags)));
01283         <span class="keywordflow">if</span> (retval) {
01284 
01285 <span class="preprocessor">#ifndef UNICODE</span>
01286 <span class="preprocessor"></span>            LPSTR psz;
01287 <span class="preprocessor">#endif</span>
01288 <span class="preprocessor"></span>
01289             <span class="comment">/*</span>
01290 <span class="comment">             * return only the amount of information requested.</span>
01291 <span class="comment">             * For ANSI, this requires a conversion.</span>
01292 <span class="comment">             */</span>
01293 
01294             <span class="comment">/*</span>
01295 <span class="comment">             * First, copy the driver extra information</span>
01296 <span class="comment">             */</span>
01297 
01298             <span class="keywordflow">if</span> (lpDevMode-&gt;dmDriverExtra &amp;&amp;
01299                 lpDevModeReserve-&gt;dmDriverExtra) {
01300 
01301                 RtlMoveMemory(((PUCHAR)lpDevMode) + size,
01302                               lpDevModeReserve + 1,
01303                               <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(lpDevMode-&gt;dmDriverExtra,
01304                                   lpDevModeReserve-&gt;dmDriverExtra));
01305             }
01306 
01307 <span class="preprocessor">#ifndef UNICODE</span>
01308 <span class="preprocessor"></span>            psz = (LPSTR)&amp;(lpDevMode-&gt;dmDeviceName[0]);
01309 
01310             retval = WCSToMB(lpDevModeReserve-&gt;dmDeviceName,
01311                              -1,
01312                              &amp;psz,
01313                              32,
01314                              FALSE);
01315 
01316             RtlMoveMemory(&amp;lpDevMode-&gt;dmSpecVersion,
01317                           &amp;lpDevModeReserve-&gt;dmSpecVersion,
01318                           <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(size, FIELD_OFFSET(DEVMODE,dmFormName)) -
01319                               FIELD_OFFSET(DEVMODE,dmSpecVersion));
01320 
01321             lpDevMode-&gt;dmSize = size;
01322 
01323             <span class="keywordflow">if</span> (size &gt;= FIELD_OFFSET(DEVMODE,dmFormName)) {
01324 
01325                 psz = (LPSTR)&amp;(lpDevMode-&gt;dmFormName[0]);
01326 
01327                 retval = WCSToMB(lpDevModeReserve-&gt;dmFormName, -1, &amp;psz, 32, FALSE);
01328             }
01329 
01330             <span class="keywordflow">if</span> (size &gt; FIELD_OFFSET(DEVMODE,dmBitsPerPel)) {
01331 
01332                 RtlMoveMemory(&amp;lpDevMode-&gt;dmBitsPerPel,
01333                               &amp;lpDevModeReserve-&gt;dmBitsPerPel,
01334                               lpDevMode-&gt;dmSize +
01335                                   lpDevMode-&gt;dmDriverExtra -
01336                                   FIELD_OFFSET(DEVMODE,dmBitsPerPel));
01337             }
01338 
01339 <span class="preprocessor">#else</span>
01340 <span class="preprocessor"></span>            RtlMoveMemory(lpDevMode, lpDevModeReserve, size);
01341 
01342             lpDevMode-&gt;dmSize = size;
01343 
01344 <span class="preprocessor">#endif</span>
01345 <span class="preprocessor"></span>
01346             <span class="keywordflow">if</span> (size != lpDevMode-&gt;dmSize) {
01347                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"EnumDisplaySettings : Error in dmSize"</span>);
01348             }
01349 
01350             <span class="comment">/*</span>
01351 <span class="comment">             * Don't return invalid field flags to the application</span>
01352 <span class="comment">             * Add any other new ones here.</span>
01353 <span class="comment">             *</span>
01354 <span class="comment">             * We assume apps at least have up to dmDisplayFrenquency for</span>
01355 <span class="comment">             * now ...</span>
01356 <span class="comment">             */</span>
01357 
01358             <span class="keywordflow">if</span> (size &lt; FIELD_OFFSET(DEVMODE,dmPanningWidth))
01359                 lpDevMode-&gt;dmFields &amp;= ~DM_PANNINGWIDTH;
01360 
01361             <span class="keywordflow">if</span> (size &lt; FIELD_OFFSET(DEVMODE,dmPanningHeight))
01362                 lpDevMode-&gt;dmFields &amp;= ~DM_PANNINGHEIGHT;
01363         }
01364 
01365         LocalFree(lpDevModeReserve);
01366     }
01367 
01368     <span class="keywordflow">return</span> retval;
01369 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ntcftxt.h::FindWindow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND FindWindow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pWindowName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00070">70</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00784">FW_BOTH</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00026">InternalFindWindowEx</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00275">TEXT_FN</a>.
<p>
<pre class="fragment"><div>00073 {
00074     <span class="keywordflow">return</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a36">TEXT_FN</a>(InternalFindWindowEx)(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, pClassName, pWindowName, <a class="code" href="../../d1/d0/inc_2user_8h.html#a187">FW_BOTH</a>);
00075 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ntcftxt.h::FindWindowEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND FindWindowEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndChild</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pWindowName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00061">61</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00784">FW_BOTH</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00026">InternalFindWindowEx</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00275">TEXT_FN</a>.
<p>
Referenced by <a class="el" href="../../d2/d9/client_2help_8c-source.html#l00375">FindWinHelpWindow()</a>.
<p>
<pre class="fragment"><div>00066 {
00067     <span class="keywordflow">return</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a36">TEXT_FN</a>(InternalFindWindowEx)(hwndParent, hwndChild, pClassName, pWindowName, <a class="code" href="../../d1/d0/inc_2user_8h.html#a187">FW_BOTH</a>);
00068 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ntcftxt.h::GetAltTabInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI BOOL WINAPI GetAltTabInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iItem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PALTTABINFO&nbsp;</td>
          <td class="mdname" nowrap> <em>pati</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszItemText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT cchItemText&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01610">1610</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00018">IS_ANSI</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03726">NtUserGetAltTabInfo()</a>.
<p>
<pre class="fragment"><div>01616 {
01617     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
01618 
01619     retval = (DWORD)NtUserGetAltTabInfo(hwnd,  iItem, pati,
01620             (LPWSTR)pszItemText, cchItemText, IS_ANSI);
01621 
01622     ERRORTRAP(0);
01623     ENDCALL(BOOL);
01624 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ntcftxt.h::GetClassInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL GetClassInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE hmod&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWNDCLASS&nbsp;</td>
          <td class="mdname" nowrap> <em>pwc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00079">79</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00316">_IN_STRING::fAllocated</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00261">FIRSTCOPYLPTSTRID</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00018">IS_ANSI</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08817">NtUserGetClassInfo()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/bench_8c-source.html#l00262">msProfClassGroup()</a>.
<p>
<pre class="fragment"><div>00083 {
00084     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strClassName;
00085     LPWSTR pszMenuName;
00086     WNDCLASSEXW WndClass;
00087 
00088     <span class="comment">/*</span>
00089 <span class="comment">     * Make sure cleanup will work successfully</span>
00090 <span class="comment">     */</span>
00091     strClassName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00092 
00093     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00094 
00095         FIRSTCOPYLPTSTRID(&amp;strClassName, pszClassName);
00096 
00097         retval = (DWORD)NtUserGetClassInfo(
00098                 hmod,
00099                 strClassName.pstr,
00100                 &amp;WndClass,
00101                 &amp;pszMenuName,
00102                 IS_ANSI);
00103 
00104         if (retval) {
00105 
00106             <span class="comment">/*</span>
00107 <span class="comment">             * Move the info from the WNDCLASSEX to the WNDCLASS structure</span>
00108 <span class="comment">             * On 64-bit plaforms we'll have 32 bits of padding between style and</span>
00109 <span class="comment">             * lpfnWndProc in WNDCLASS, so start the copy from the first 64-bit</span>
00110 <span class="comment">             * aligned field and hand copy the rest.</span>
00111 <span class="comment">             */</span>
00112             RtlCopyMemory(&amp;(pwc-&gt;lpfnWndProc), &amp;(WndClass.lpfnWndProc), <span class="keyword">sizeof</span>(WNDCLASS) - FIELD_OFFSET(WNDCLASS, lpfnWndProc));
00113             pwc-&gt;style = WndClass.style;
00114 
00115             <span class="comment">/*</span>
00116 <span class="comment">             * Update these pointers so they point to something real.</span>
00117 <span class="comment">             * pszMenuName is actually just the pointer the app originally</span>
00118 <span class="comment">             * passed to us.</span>
00119 <span class="comment">             */</span>
00120             pwc-&gt;lpszMenuName = (LPTSTR)pszMenuName;
00121             pwc-&gt;lpszClassName = pszClassName;
00122         }
00123 
00124     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00125     <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strClassName);
00126     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00127 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ntcftxt.h::GetClassInfoEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL GetClassInfoEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE hmod&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWNDCLASSEX&nbsp;</td>
          <td class="mdname" nowrap> <em>pwc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00129">129</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00316">_IN_STRING::fAllocated</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00261">FIRSTCOPYLPTSTRID</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00018">IS_ANSI</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08817">NtUserGetClassInfo()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/softkbd_8c-source.html#l00024">RegisterSoftKeyboard()</a>.
<p>
<pre class="fragment"><div>00133 {
00134     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strClassName;
00135     LPWSTR pszMenuName;
00136 
00137     <span class="comment">/*</span>
00138 <span class="comment">     * Make sure cleanup will work successfully</span>
00139 <span class="comment">     */</span>
00140     strClassName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00141 
00142     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00143 
00144         FIRSTCOPYLPTSTRID(&amp;strClassName, pszClassName);
00145 
00146         retval = (DWORD)NtUserGetClassInfo(
00147                 hmod,
00148                 strClassName.pstr,
00149                 (LPWNDCLASSEXW)pwc,
00150                 &amp;pszMenuName,
00151                 IS_ANSI);
00152 
00153         if (retval) {
00154 
00155             <span class="comment">/*</span>
00156 <span class="comment">             * Update these pointers so they point to something real.</span>
00157 <span class="comment">             * pszMenuName is actually just the pointer the app originally</span>
00158 <span class="comment">             * passed to us.</span>
00159 <span class="comment">             */</span>
00160             pwc-&gt;lpszMenuName = (LPTSTR)pszMenuName;
00161             pwc-&gt;lpszClassName = pszClassName;
00162         }
00163 
00164     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00165     <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strClassName);
00166     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00167 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ntcftxt.h::GetClipboardFormatName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int GetClipboardFormatName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pFormatName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chMaxCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00169">169</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08962">NtUserGetClipboardFormatName()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
<pre class="fragment"><div>00173 {
00174     LPWSTR lpszReserve;
00175 
00176     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00177 
00178 #ifdef UNICODE
00179         lpszReserve = pFormatName;
00180 <span class="preprocessor">#else</span>
00181 <span class="preprocessor"></span>        lpszReserve = LocalAlloc(LMEM_FIXED, chMaxCount * <span class="keyword">sizeof</span>(WCHAR));
00182         <span class="keywordflow">if</span> (!lpszReserve) {
00183             <span class="keywordflow">return</span> 0;
00184         }
00185 <span class="preprocessor">#endif</span>
00186 <span class="preprocessor"></span>
00187         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a309">NtUserGetClipboardFormatName</a>(
00188                 wFormat,
00189                 lpszReserve,
00190                 chMaxCount);
00191 
00192 <span class="preprocessor">#ifndef UNICODE</span>
00193 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (retval) {
00194             <span class="comment">/*</span>
00195 <span class="comment">             * Do not copy out more than the requested byte count 'chMaxCount'.</span>
00196 <span class="comment">             * Set retval to reflect the number of ANSI bytes.</span>
00197 <span class="comment">             */</span>
00198             retval = WCSToMB(lpszReserve, (UINT)retval,
00199                     &amp;pFormatName, chMaxCount-1, FALSE);
00200             pFormatName[retval] = <span class="charliteral">'\0'</span>;
00201         }
00202         LocalFree(lpszReserve);
00203 <span class="preprocessor">#endif</span>
00204 <span class="preprocessor"></span>
00205     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00206     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(<span class="keywordtype">int</span>);
00207 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ntcftxt.h::GetKeyboardLayoutName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL GetKeyboardLayoutName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwszKL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00306">306</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09022">NtUserGetKeyboardLayoutName()</a>.
<p>
Referenced by <a class="el" href="../../d7/d6/country_8c-source.html#l00081">GetIMEName()</a>.
<p>
<pre class="fragment"><div>00308 {
00309 <span class="preprocessor">#ifdef UNICODE</span>
00310 <span class="preprocessor"></span>    UNICODE_STRING str;
00311     PUNICODE_STRING pstr = &amp;str;
00312 <span class="preprocessor">#else</span>
00313 <span class="preprocessor"></span>    PUNICODE_STRING pstr = &amp;NtCurrentTeb()-&gt;StaticUnicodeString;
00314 <span class="preprocessor">#endif</span>
00315 <span class="preprocessor"></span>
00316     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00317 
00318 #ifdef UNICODE
00319         str.MaximumLength = KL_NAMELENGTH * <span class="keyword">sizeof</span>(WCHAR);
00320         str.Buffer = pwszKL;
00321 <span class="preprocessor">#endif</span>
00322 <span class="preprocessor"></span>
00323         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a311">NtUserGetKeyboardLayoutName</a>(pstr);
00324 
00325 <span class="preprocessor">#ifndef UNICODE</span>
00326 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (retval) {
00327             <span class="comment">/*</span>
00328 <span class="comment">             * Non-zero retval means some text to copy out.  Do not copy out</span>
00329 <span class="comment">             * more than the requested byte count 'chMaxCount'.</span>
00330 <span class="comment">             */</span>
00331             WCSToMB(pstr-&gt;Buffer, -1, &amp;pwszKL, KL_NAMELENGTH, FALSE);
00332         }
00333 <span class="preprocessor">#endif</span>
00334 <span class="preprocessor"></span>
00335     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00336     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00337 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ntcftxt.h::GetKeyNameText" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int GetKeyNameText           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00209">209</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08992">NtUserGetKeyNameText()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
<pre class="fragment"><div>00213 {
00214     LPWSTR lpszReserve;
00215 
00216     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00217 
00218 #ifdef UNICODE
00219         lpszReserve = pString;
00220 <span class="preprocessor">#else</span>
00221 <span class="preprocessor"></span>        lpszReserve = LocalAlloc(LMEM_FIXED, cchSize * <span class="keyword">sizeof</span>(WCHAR));
00222         <span class="keywordflow">if</span> (!lpszReserve) {
00223             <span class="keywordflow">return</span> 0;
00224         }
00225 <span class="preprocessor">#endif</span>
00226 <span class="preprocessor"></span>
00227         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a310">NtUserGetKeyNameText</a>(
00228                 lParam,
00229                 lpszReserve,
00230                 cchSize);
00231 
00232 <span class="preprocessor">#ifndef UNICODE</span>
00233 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (retval) {
00234             <span class="comment">/*</span>
00235 <span class="comment">             * Do not copy out more than the requested byte count 'nSize'.</span>
00236 <span class="comment">             * Set retval to reflect the number of ANSI bytes.</span>
00237 <span class="comment">             */</span>
00238             retval = WCSToMB(lpszReserve, (UINT)retval,
00239                     &amp;pString, cchSize-1, FALSE);
00240         }
00241         LocalFree(lpszReserve);
00242         ((LPSTR)pString)[retval] = <span class="charliteral">'\0'</span>;
00243 <span class="preprocessor">#endif</span>
00244 <span class="preprocessor"></span>
00245     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00246     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(<span class="keywordtype">int</span>);
00247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ntcftxt.h::GetMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY GetMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPMSG&nbsp;</td>
          <td class="mdname" nowrap> <em>pmsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsgFilterMin</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsgFilterMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00249">249</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02311">BUILD_DBCS_MESSAGE_TO_CLIENTA_FROM_SERVER</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02359">BUILD_DBCS_MESSAGE_TO_CLIENTW_FROM_SERVER</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02229">GET_DBCS_MESSAGE_IF_EXIST</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00249">GetMessage()</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00072">MSGERRORCODE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01888">NtUserGetMessage()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00133">RESERVED_MSG_BITS</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00361">RtlWCSMessageWParamCharToMB()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l01946">ConsoleInputThread()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00249">GetMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01705">SendMessageDiffThreadFunc()</a>, and <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00062">WinMain()</a>.
<p>
<pre class="fragment"><div>00254 {
00255     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00256 
00257         <span class="comment">/*</span>
00258 <span class="comment">         * Prevent apps from setting hi 16 bits so we can use them internally.</span>
00259 <span class="comment">         */</span>
00260         if ((wMsgFilterMin | wMsgFilterMax) &amp; RESERVED_MSG_BITS) {
00261             <a class="code" href="../../d5/d8/crecv_8c.html#a8">MSGERRORCODE</a>(ERROR_INVALID_PARAMETER);
00262         }
00263 
00264 <span class="preprocessor">#ifndef UNICODE</span>
00265 <span class="preprocessor"></span>        <span class="comment">/*</span>
00266 <span class="comment">         * If we have pushed message for DBCS messaging, we should pass this one</span>
00267 <span class="comment">         * to Apps at first...</span>
00268 <span class="comment">         */</span>
00269         <a class="code" href="../../d6/d0/usercli_8h.html#a293">GET_DBCS_MESSAGE_IF_EXIST</a>(GetMessage, pmsg, wMsgFilterMin, wMsgFilterMax, TRUE);
00270 <span class="preprocessor">#endif</span>
00271 <span class="preprocessor"></span>
00272         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a110">NtUserGetMessage</a>(
00273                 pmsg,
00274                 hwnd,
00275                 wMsgFilterMin,
00276                 wMsgFilterMax);
00277 
00278 <span class="preprocessor">#ifndef UNICODE</span>
00279 <span class="preprocessor"></span>        <span class="comment">// May have a bit more work to do if this MSG is for an ANSI app</span>
00280 
00281         <span class="comment">// !!! LATER if the unichar translates into multiple ANSI chars</span>
00282         <span class="comment">// !!! then what??? Divide into two messages??  WM_SYSDEADCHAR??</span>
00283 
00284         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/chartran_8c.html#a4">RtlWCSMessageWParamCharToMB</a>(pmsg-&gt;message, &amp;(pmsg-&gt;wParam))) {
00285             WPARAM dwAnsi = pmsg-&gt;wParam;
00286             <span class="comment">/*</span>
00287 <span class="comment">             * Build DBCS-ware wParam. (for EM_SETPASSWORDCHAR...)</span>
00288 <span class="comment">             */</span>
00289             <a class="code" href="../../d6/d0/usercli_8h.html#a296">BUILD_DBCS_MESSAGE_TO_CLIENTA_FROM_SERVER</a>(pmsg, dwAnsi, TRUE, TRUE);
00290         } <span class="keywordflow">else</span> {
00291             retval = 0;
00292         }
00293 ExitGetMessage:
00294 <span class="preprocessor">#else</span>
00295 <span class="preprocessor"></span>        <span class="comment">/*</span>
00296 <span class="comment">         * Only LOWORD of WPARAM is valid for WM_CHAR (Unicode)....</span>
00297 <span class="comment">         * (Mask off DBCS messaging information.)</span>
00298 <span class="comment">         */</span>
00299         <a class="code" href="../../d6/d0/usercli_8h.html#a297">BUILD_DBCS_MESSAGE_TO_CLIENTW_FROM_SERVER</a>(pmsg-&gt;message,pmsg-&gt;wParam);
00300 <span class="preprocessor">#endif // UNICODE</span>
00301 <span class="preprocessor"></span>
00302     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00303     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00304 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ntcftxt.h::InitClsMenuName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitClsMenuName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d0/structtagCLSMENUNAME.html">PCLSMENUNAME</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcmn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszMenuName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d1/struct__IN__STRING.html">PIN_STRING</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pstrMenuName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00535">535</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00257">COPYLPTSTRID</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1036">PCLSMENUNAME</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a351">PIN_STRING</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01641">tagCLSMENUNAME::pszClientAnsiMenuName</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01724">tagCLSMENUNAME::pusMenuName</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01642">tagCLSMENUNAME::pwszClientUnicodeMenuName</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00517">StringDuplicate</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00536 {
00537     <span class="comment">/*</span>
00538 <span class="comment">     * We check the high-word because this may be a resource-ID.</span>
00539 <span class="comment">     */</span>
00540     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(lpszMenuName)) {
00541 <span class="preprocessor">#ifdef UNICODE</span>
00542 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ((pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a> = <a class="code" href="../../d0/d8/ntcftxt_8h.html#a1">StringDuplicate</a>(lpszMenuName)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00543             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00544         }
00545 
00546         <span class="keywordflow">if</span> (!WCSToMB(lpszMenuName, -1, &amp;(pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a>), -1, TRUE)) {
00547             pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00548         }
00549 <span class="preprocessor">#else</span>
00550 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ((pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a> = <a class="code" href="../../d0/d8/ntcftxt_8h.html#a1">StringDuplicate</a>(lpszMenuName)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00551             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00552         }
00553 
00554         <span class="keywordflow">if</span> (!MBToWCS(lpszMenuName, -1, &amp;(pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a>), -1, TRUE)) {
00555             pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00556         }
00557 <span class="preprocessor">#endif // UNICODE</span>
00558 <span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
00559         <span class="comment">/* Copy the ID */</span>
00560         pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a> = (LPSTR)lpszMenuName;
00561         pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a> = (LPWSTR)lpszMenuName;
00562     }
00563 
00564     <a class="code" href="../../d7/d9/ntsend_8h.html#a46">COPYLPTSTRID</a>(pstrMenuName, lpszMenuName);
00565     pcmn-&gt;<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o2">pusMenuName</a> = pstrMenuName-&gt;<a class="code" href="../../d8/d1/struct__IN__STRING.html#o1">pstr</a>;
00566 
00567     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00568 
00569     <span class="keywordflow">goto</span> errorexit; <span class="comment">/* Keep the compiler happy */</span>
00570 errorexit: <span class="comment">/* Used by COPYLPTSTRID */</span>
00571    <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00572 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ntcftxt.h::MapVirtualKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT MapVirtualKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMapType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00339">339</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09089">NtUserMapVirtualKeyEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00905">RtlUnicodeToMultiByteN()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/server_2private_8c-source.html#l02403">ConvertHotKey()</a>, <a class="el" href="../../d8/d7/ntcon_2server_2clipbrd_8c-source.html#l00835">DoStringPaste()</a>, <a class="el" href="../../d9/d3/editec_8c-source.html#l02904">EditWndProc()</a>, <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l02272">HandleSysKeyEvent()</a>, <a class="el" href="../../d7/d8/softkbd_8c-source.html#l00137">ImmCreateSoftKeyboard()</a>, <a class="el" href="../../d3/d9/writescy_8c-source.html#l00018">main()</a>, and <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l01609">RetrieveKeyInfo()</a>.
<p>
<pre class="fragment"><div>00342 {
00343     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00344 
00345         retval = (DWORD)NtUserMapVirtualKeyEx(
00346                 wCode,
00347                 wMapType,
00348                 0,
00349                 FALSE);
00350 
00351 #ifndef UNICODE
00352         if ((wMapType == 2) &amp;&amp; (retval != 0)) {
00353             WCHAR wch = LOWORD(retval);
00354             retval &amp;= ~0xFFFF;
00355             <a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>((LPSTR)&amp;(retval), <span class="keyword">sizeof</span>(CHAR),
00356                     NULL, &amp;wch, <span class="keyword">sizeof</span>(WCHAR));
00357         }
00358 <span class="preprocessor">#endif</span>
00359 <span class="preprocessor"></span>
00360     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00361     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(UINT);
00362 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ntcftxt.h::MapVirtualKeyEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT MapVirtualKeyEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMapType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HKL&nbsp;</td>
          <td class="mdname" nowrap> <em>hkl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00374">374</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00371">hMVKCachedHKL</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09089">NtUserMapVirtualKeyEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00372">uMVKCachedCP</a>.
<p>
<pre class="fragment"><div>00378 {
00379     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00380 
00381         retval = (DWORD)NtUserMapVirtualKeyEx(
00382                 wCode,
00383                 wMapType,
00384                 (ULONG_PTR)hkl,
00385                 TRUE);
00386 
00387 #ifndef UNICODE
00388         if ((wMapType == 2) &amp;&amp; (retval != 0)) {
00389             WCHAR wch = LOWORD(retval);
00390 
00391             <span class="keywordflow">if</span> (hkl != <a class="code" href="../../d0/d8/ntcftxt_8h.html#a5">hMVKCachedHKL</a>) {
00392                 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCodePage;
00393                 <span class="keywordflow">if</span> (!GetLocaleInfoW(
00394                          HandleToUlong(hkl) &amp; 0xffff,
00395                          LOCALE_IDEFAULTANSICODEPAGE | LOCALE_RETURN_NUMBER,
00396                          (LPWSTR)&amp;dwCodePage,
00397                          <span class="keyword">sizeof</span>(dwCodePage) / <span class="keyword">sizeof</span>(WCHAR)
00398                          )) {
00399                     <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
00400                 }
00401                 <a class="code" href="../../d0/d8/ntcftxt_8h.html#a6">uMVKCachedCP</a> = dwCodePage;
00402                 <a class="code" href="../../d0/d8/ntcftxt_8h.html#a5">hMVKCachedHKL</a> = hkl;
00403             }
00404             <span class="comment">/*</span>
00405 <span class="comment">             * Clear low word which contains Unicode character returned from server.</span>
00406 <span class="comment">             * This preserves the high word which is used to indicate dead key status.</span>
00407 <span class="comment">             */</span>
00408             retval = retval &amp; 0xffff0000;
00409             <span class="keywordflow">if</span> (!WideCharToMultiByte(
00410                      uMVKCachedCP,
00411                      0,
00412                      &amp;wch,
00413                      1,
00414                      (LPSTR)&amp;(retval),
00415                      1,
00416                      NULL,
00417                      NULL)) {
00418                 <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
00419             }
00420         }
00421 <span class="preprocessor">#endif</span>
00422 <span class="preprocessor"></span>
00423     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00424     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(UINT);
00425 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ntcftxt.h::PostMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY PostMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">427</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02253">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00154">GETPROCESSID</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00153">GetWindowProcess</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05550">NtUserPostMessage()</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00490">RtlMBMessageWParamCharToWCS()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d9/server_2exitwin_8c-source.html#l01601">_EndTask()</a>, <a class="el" href="../../d1/d9/imefull_8c-source.html#l00281">CharHandlerToConsole()</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l01000">ConImeInputLangchangeRequest()</a>, <a class="el" href="../../d7/d1/output_8c-source.html#l04700">ConsoleWindowProc()</a>, <a class="el" href="../../d7/d1/output_8c-source.html#l00834">CreateWindowsWindow()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l02101">DefFrameProcWorker()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l02531">DefMDIChildProcWorker()</a>, <a class="el" href="../../d3/d8/dlgend_8c-source.html#l00024">EndDialog()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l02397">HandleKeyEvent()</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00292">IMENonIMEToggle()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00374">ImmIMPSetIMEW()</a>, <a class="el" href="../../d2/d4/editml_8c-source.html#l02028">MLKeyDown()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01435">msProfMenu()</a>, <a class="el" href="../../d3/d4/transsub_8c-source.html#l01481">MyPostImsMessage()</a>, <a class="el" href="../../d3/d4/transsub_8c-source.html#l01328">MySetCompFont()</a>, <a class="el" href="../../d3/d4/transsub_8c-source.html#l01396">MySetCompWindow()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01534">PackAndPostMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d7/d1/output_8c-source.html#l04267">QueueConsoleMessage()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00483">RecalculateScrollRanges()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00030">SendRegisterMessageToClass()</a>, <a class="el" href="../../d7/d1/output_8c-source.html#l03953">SetWindowSize()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d7/d7/sftkbdt1_8c-source.html#l01258">SKWndProcT1()</a>, <a class="el" href="../../d2/d3/instdev_8c-source.html#l00037">SrvDeviceEvent()</a>, <a class="el" href="../../d8/d3/server_2private_8c-source.html#l00213">SrvSetConsoleCursor()</a>, <a class="el" href="../../d0/d4/ntcon_2server_2getset_8c-source.html#l01164">SrvSetConsoleIcon()</a>, <a class="el" href="../../d8/d3/server_2private_8c-source.html#l02423">SrvSetConsoleKeyShortcuts()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04929">SrvSetConsoleTitle()</a>, <a class="el" href="../../d8/d3/server_2private_8c-source.html#l00298">SrvShowConsoleCursor()</a>, <a class="el" href="../../d3/d4/srvvdm_8c-source.html#l00024">SrvVDMConsoleOperation()</a>, <a class="el" href="../../d3/d9/server_2exitwin_8c-source.html#l00757">ThreadShutdownNotify()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>, <a class="el" href="../../d7/d1/output_8c-source.html#l02162">UpdateScrollBars()</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00288">WndProc()</a>, <a class="el" href="../../d1/d1/lboxctl3_8c-source.html#l00190">xxxDlgDirListHelper()</a>, <a class="el" href="../../d3/d1/lboxrare_8c-source.html#l00062">xxxLBCreate()</a>, and <a class="el" href="../../d0/d1/lboxctl2_8c-source.html#l02183">xxxLBoxCtlKeyInput()</a>.
<p>
<pre class="fragment"><div>00432 {
00433     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00434 
00435         switch (wMsg) {
00436         <span class="keywordflow">case</span> WM_DROPFILES:
00437             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a12">GetWindowProcess</a>(hwnd) != <a class="code" href="../../d6/d0/usercli_8h.html#a13">GETPROCESSID</a>()) {
00438                 <span class="comment">/*</span>
00439 <span class="comment">                 * We first send a WM_COPYGLOBALDATA message to get the data into the proper</span>
00440 <span class="comment">                 * context.</span>
00441 <span class="comment">                 */</span>
00442                 HGLOBAL hg;
00443 
00444                 hg = (HGLOBAL)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, WM_COPYGLOBALDATA,
00445                         GlobalSize((HGLOBAL)wParam), wParam);
00446                 <span class="keywordflow">if</span> (!hg) {
00447                     <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
00448                 }
00449                 wParam = (WPARAM)hg;
00450             }
00451             <span class="keywordflow">break</span>;
00452 
00453         <span class="keywordflow">case</span> LB_DIR:
00454         <span class="keywordflow">case</span> CB_DIR:
00455             <span class="comment">/*</span>
00456 <span class="comment">             * Make sure this bit is set so the client side string gets</span>
00457 <span class="comment">             * successfully copied over.</span>
00458 <span class="comment">             */</span>
00459             wParam |= DDL_POSTMSGS;
00460             <span class="keywordflow">break</span>;
00461         }
00462 
00463 <span class="preprocessor">#ifndef UNICODE</span>
00464 <span class="preprocessor"></span>        <span class="comment">/*</span>
00465 <span class="comment">         * Setup DBCS Messaging for WM_CHAR...</span>
00466 <span class="comment">         */</span>
00467         <a class="code" href="../../d6/d0/usercli_8h.html#a294">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>(wMsg,wParam,TRUE);
00468 
00469         <a class="code" href="../../d5/d6/chartran_8c.html#a5">RtlMBMessageWParamCharToWCS</a>(wMsg, &amp;wParam);
00470 <span class="preprocessor">#endif</span>
00471 <span class="preprocessor"></span>        retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a214">NtUserPostMessage</a>(
00472                 hwnd,
00473                 wMsg,
00474                 wParam,
00475                 lParam);
00476 
00477     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00478     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00479 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ntcftxt.h::PostThreadMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY PostThreadMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idThread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00481">481</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02253">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03161">NtUserPostThreadMessage()</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00490">RtlMBMessageWParamCharToWCS()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l00789">AllocateConsole()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l01906">BoostHardError()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00383">MsgBoxTimerFunc()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01752">msProfSendMessageDiffThread()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l01599">ProcessHardErrorRequest()</a>, and <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l01860">QueueThreadMessage()</a>.
<p>
<pre class="fragment"><div>00486 {
00487     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00488 
00489 #ifndef UNICODE
00490 <span class="preprocessor">#ifdef FE_SB // PostThreadMessage()</span>
00491 <span class="preprocessor"></span>        <span class="comment">/*</span>
00492 <span class="comment">         * The server always expects the characters to be unicode so</span>
00493 <span class="comment">         * if this was generated from an ANSI routine convert it to Unicode</span>
00494 <span class="comment">         */</span>
00495         <a class="code" href="../../d6/d0/usercli_8h.html#a294">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>(msg,wParam,TRUE);
00496 <span class="preprocessor">#endif // FE_SB</span>
00497 <span class="preprocessor"></span>
00498         <a class="code" href="../../d5/d6/chartran_8c.html#a5">RtlMBMessageWParamCharToWCS</a>(msg, &amp;wParam);
00499 <span class="preprocessor">#endif</span>
00500 <span class="preprocessor"></span>
00501         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a127">NtUserPostThreadMessage</a>(
00502                 idThread,
00503                 msg,
00504                 wParam,
00505                 lParam);
00506 
00507     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00508     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00509 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ntcftxt.h::RealGetWindowClass" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI UINT WINAPI RealGetWindowClass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>ptszClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cchClassNameMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01574">1574</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08904">NtUserGetClassName()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>01578 {
01579     UNICODE_STRING strClassName;
01580     <span class="keywordtype">int</span> retval;
01581 
01582     strClassName.MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(cchClassNameMax * <span class="keyword">sizeof</span>(WCHAR));
01583 
01584 <span class="preprocessor">#ifndef UNICODE</span>
01585 <span class="preprocessor"></span>    strClassName.Buffer = LocalAlloc(LMEM_FIXED, strClassName.MaximumLength);
01586     <span class="keywordflow">if</span> (!strClassName.Buffer) {
01587         <span class="keywordflow">return</span> 0;
01588     }
01589 <span class="preprocessor">#else</span>
01590 <span class="preprocessor"></span>    strClassName.Buffer = ptszClassName;
01591 <span class="preprocessor">#endif</span>
01592 <span class="preprocessor"></span>
01593     retval = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a308">NtUserGetClassName</a>(hwnd, TRUE, &amp;strClassName);
01594 
01595 <span class="preprocessor">#ifndef UNICODE</span>
01596 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (retval || (cchClassNameMax == 1)) {
01597         <span class="comment">/*</span>
01598 <span class="comment">         * Copy the result</span>
01599 <span class="comment">         */</span>
01600         retval = WCSToMB(strClassName.Buffer, retval,
01601                 &amp;ptszClassName, cchClassNameMax-1, FALSE);
01602         ptszClassName[retval] = <span class="charliteral">'\0'</span>;
01603     }
01604     LocalFree(strClassName.Buffer);
01605 <span class="preprocessor">#endif</span>
01606 <span class="preprocessor"></span>
01607   <span class="keywordflow">return</span> retval;
01608 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ntcftxt.h::RegisterWindowMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT RegisterWindowMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00800">800</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00316">_IN_STRING::fAllocated</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00260">FIRSTCOPYLPTSTR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09173">NtUserRegisterWindowMessage()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l01946">ConsoleInputThread()</a>, and <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00129">WinMain()</a>.
<p>
<pre class="fragment"><div>00802 {
00803     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> str;
00804 
00805     <span class="comment">/*</span>
00806 <span class="comment">     * Make sure cleanup will work successfully</span>
00807 <span class="comment">     */</span>
00808     str.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00809 
00810     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00811 
00812         FIRSTCOPYLPTSTR(&amp;str, (LPTSTR)pString);
00813 
00814         retval = (DWORD)NtUserRegisterWindowMessage(
00815                 str.pstr);
00816 
00817     ERRORTRAP(0);
00818     CLEANUPLPTSTR(str);
00819     ENDCALL(UINT);
00820 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ntcftxt.h::RemoveProp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE RemoveProp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00822">822</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09202">NtUserRemoveProp()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d3/msgbox_8c-source.html#l01944">EndTaskModalDialog()</a>.
<p>
<pre class="fragment"><div>00825 {
00826     ATOM atomProp;
00827     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwProp;
00828 
00829     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00830 
00831         if (IS_PTR(pString)) {
00832             atomProp = GlobalFindAtom(pString);
00833             <span class="keywordflow">if</span> (atomProp == 0)
00834                 <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
00835             dwProp = MAKELONG(atomProp, TRUE);
00836         } <span class="keywordflow">else</span>
00837             dwProp = MAKELONG(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pString), FALSE);
00838 
00839         retval = (ULONG_PTR)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a316">NtUserRemoveProp</a>(
00840                 hwnd,
00841                 dwProp);
00842 
00843         <span class="keywordflow">if</span> (retval != 0 &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pString))
00844             GlobalDeleteAtom(atomProp);
00845 
00846     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00847     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(HANDLE);
00848 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ntcftxt.h::SendMessageCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY SendMessageCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SENDASYNCPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpResultCallBack</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dwData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00850">850</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02253">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05648">NtUserSendMessageCallback()</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00490">RtlMBMessageWParamCharToWCS()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d9/server_2exitwin_8c-source.html#l00757">ThreadShutdownNotify()</a>.
<p>
<pre class="fragment"><div>00857 {
00858     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00859 
00860 #ifndef UNICODE
00861 <span class="preprocessor">#ifdef FE_SB // SendMessageCallBack()</span>
00862 <span class="preprocessor"></span>        <span class="comment">/*</span>
00863 <span class="comment">         * Setup DBCS Messaging for WM_CHAR...</span>
00864 <span class="comment">         */</span>
00865         <a class="code" href="../../d6/d0/usercli_8h.html#a294">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>(wMsg,wParam,TRUE);
00866 <span class="preprocessor">#endif // FE_SB</span>
00867 <span class="preprocessor"></span>
00868         <a class="code" href="../../d5/d6/chartran_8c.html#a5">RtlMBMessageWParamCharToWCS</a>(wMsg, &amp;wParam);
00869 <span class="preprocessor">#endif</span>
00870 <span class="preprocessor"></span>
00871         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a216">NtUserSendMessageCallback</a>(
00872                 hwnd,
00873                 wMsg,
00874                 wParam,
00875                 lParam,
00876                 lpResultCallBack,
00877                 dwData);
00878 
00879     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00880     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00881 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ntcftxt.h::SendNotifyMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY SendNotifyMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00883">883</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02253">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05599">NtUserSendNotifyMessage()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00636">RtlInitLargeUnicodeString()</a>, <a class="el" href="../../d6/d5/chartran_8c-source.html#l00490">RtlMBMessageWParamCharToWCS()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d3/d9/server_2exitwin_8c-source.html#l00757">ThreadShutdownNotify()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.
<p>
<pre class="fragment"><div>00888 {
00889     <a class="code" href="../../d1/d9/struct__LARGE__STRING.html">LARGE_STRING</a> str;
00890     LPWSTR  lpUniName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00891 
00892 
00893     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00894 
00895 #ifndef UNICODE
00896 <span class="preprocessor">#ifdef FE_SB // SendNotifyMessage()</span>
00897 <span class="preprocessor"></span>        <span class="comment">/*</span>
00898 <span class="comment">         * Setup DBCS Messaging for WM_CHAR...</span>
00899 <span class="comment">         */</span>
00900         <a class="code" href="../../d6/d0/usercli_8h.html#a294">BUILD_DBCS_MESSAGE_TO_SERVER_FROM_CLIENTA</a>(wMsg,wParam,TRUE);
00901 <span class="preprocessor">#endif // FE_SB</span>
00902 <span class="preprocessor"></span>
00903         <a class="code" href="../../d5/d6/chartran_8c.html#a5">RtlMBMessageWParamCharToWCS</a>(wMsg, &amp;wParam);
00904 <span class="preprocessor">#endif</span>
00905 <span class="preprocessor"></span>
00906         <span class="comment">/*</span>
00907 <span class="comment">         * Allow system notification messages containing</span>
00908 <span class="comment">         * strings to go through.</span>
00909 <span class="comment">         */</span>
00910         <span class="keywordflow">if</span> ((wMsg == WM_WININICHANGE || wMsg == WM_DEVMODECHANGE) &amp;&amp; lParam) {
00911 <span class="preprocessor">#ifdef UNICODE</span>
00912 <span class="preprocessor"></span>            <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;str,
00913                     (LPWSTR)lParam, (UINT)-1);
00914 <span class="preprocessor">#else</span>
00915 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (!MBToWCS((LPSTR)lParam, -1, &amp;lpUniName, -1, TRUE))
00916                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00917 
00918             <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;str,
00919                         lpUniName, (UINT)-1);
00920 <span class="preprocessor">#endif</span>
00921 <span class="preprocessor"></span>            lParam = (LPARAM)(&amp;str);
00922         }
00923 
00924         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a215">NtUserSendNotifyMessage</a>(
00925                 hwnd,
00926                 wMsg,
00927                 wParam,
00928                 lParam);
00929 
00930     <span class="keywordflow">if</span> (lpUniName)
00931         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
00932 
00933     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00934     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00935 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ntcftxt.h::SetClassLongPtr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR APIENTRY SetClassLongPtr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>dwNewLong</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00579">579</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1035">CLSMENUNAME</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00534">InitClsMenuName</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00018">IS_ANSI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d1/d9/ntuser_8h-source.html#l00303">NtUserSetClassLongPtr</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01641">tagCLSMENUNAME::pszClientAnsiMenuName</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01642">tagCLSMENUNAME::pwszClientUnicodeMenuName</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/bench_8c-source.html#l00262">msProfClassGroup()</a>.
<p>
<pre class="fragment"><div>00580 {
00581     <a class="code" href="../../d8/d0/structtagCLSMENUNAME.html">CLSMENUNAME</a> cmn;
00582     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strMenuName;
00583 
00584     <span class="keywordflow">switch</span> (nIndex) {
00585         <span class="keywordflow">case</span> GCLP_MENUNAME:
00586             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d8/ntcftxt_8h.html#a2">InitClsMenuName</a>(&amp;cmn, (LPCTSTR) dwNewLong, &amp;strMenuName)) {
00587                 RIPERR0(ERROR_INVALID_HANDLE, RIP_WARNING, <span class="stringliteral">"SetClassLong: InitClsMenuName failed"</span>);
00588                 <span class="keywordflow">return</span> 0;
00589             }
00590             dwNewLong = (ULONG_PTR) &amp;cmn;
00591             <span class="keywordflow">break</span>;
00592 
00593         <span class="keywordflow">case</span> GCLP_HBRBACKGROUND:
00594             <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)dwNewLong &gt; COLOR_ENDCOLORS) {
00595                 <span class="comment">/*</span>
00596 <span class="comment">                 * Let gdi validate the brush.  If it's invalid, then</span>
00597 <span class="comment">                 * gdi will log a warning.  No need to rip twice so we'll</span>
00598 <span class="comment">                 * just set the last-error.</span>
00599 <span class="comment">                 */</span>
00600                 <span class="keywordflow">if</span> (GdiValidateHandle((HBRUSH)dwNewLong) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00601                     RIPERR0(ERROR_INVALID_HANDLE, RIP_VERBOSE, <span class="stringliteral">""</span>);
00602                     <span class="keywordflow">return</span> 0;
00603                 }
00604             }
00605             <span class="keywordflow">break</span>;
00606     }
00607 
00608     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00609 
00610     retval = (ULONG_PTR)NtUserSetClassLongPtr(hwnd, nIndex, dwNewLong, IS_ANSI);
00611 
00612     ERRORTRAP(0);
00613 
00614     <span class="comment">/* Clean up */</span>
00615     switch (nIndex) {
00616         <span class="keywordflow">case</span> GCLP_MENUNAME:
00617             <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strMenuName); <span class="comment">/* Initialized by InitClsMenuName */</span>
00618             <span class="comment">/*</span>
00619 <span class="comment">             * We free either the old strings (returned by the kernel),</span>
00620 <span class="comment">             *  or the new ones if the kernel call failed</span>
00621 <span class="comment">             */</span>
00622             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a>)) {
00623                 LocalFree(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a>);
00624             }
00625             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a>)) {
00626                 LocalFree(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a>);
00627             }
00628 
00629             <span class="keywordflow">break</span>;
00630     }
00631 
00632     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(ULONG_PTR);
00633 
00634 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ntcftxt.h::SetProp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SetProp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00937">937</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09220">NtUserSetProp()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d3/msgbox_8c-source.html#l01648">MB_DlgProcWorker()</a>, <a class="el" href="../../d6/d4/mdimenu_8c-source.html#l00775">MDIActivateDlgInit()</a>, and <a class="el" href="../../d7/d3/msgbox_8c-source.html#l01892">StartTaskModalDialog()</a>.
<p>
<pre class="fragment"><div>00941 {
00942     ATOM atomProp;
00943     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwProp;
00944 
00945     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00946 
00947         if (IS_PTR(pString)) {
00948             atomProp = GlobalAddAtom(pString);
00949             <span class="keywordflow">if</span> (atomProp == 0)
00950                 <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
00951             dwProp = MAKELONG(atomProp, TRUE);
00952         } <span class="keywordflow">else</span>
00953             dwProp = MAKELONG(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pString), FALSE);
00954 
00955         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a317">NtUserSetProp</a>(
00956                 hwnd,
00957                 dwProp,
00958                 hData);
00959 
00960         <span class="comment">/*</span>
00961 <span class="comment">         * If it failed, get rid of the atom</span>
00962 <span class="comment">         */</span>
00963         <span class="keywordflow">if</span> (retval == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pString))
00964             GlobalDeleteAtom(atomProp);
00965 
00966     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00967     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00968 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ntcftxt.h::StringDuplicate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPTSTR StringDuplicate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ptszDup</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00518">518</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00518                                         {
00519     LPTSTR ptsz;
00520     ULONG cb;
00521 
00522     cb = (_tcslen(ptszDup) + 1) * <span class="keyword">sizeof</span>(TCHAR);
00523     ptsz = (LPTSTR)LocalAlloc(NONZEROLPTR, cb);
00524     <span class="keywordflow">if</span> (ptsz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00525         RtlCopyMemory(ptsz, ptszDup, cb);
00526     }
00527     <span class="keywordflow">return</span> ptsz;
00528 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ntcftxt.h::UnregisterClass" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL UnregisterClass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszClassName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00970">970</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00266">CLEANUPLPTSTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00316">_IN_STRING::fAllocated</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00261">FIRSTCOPYLPTSTRID</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09243">NtUserUnregisterClass()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00315">_IN_STRING::pstr</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01641">tagCLSMENUNAME::pszClientAnsiMenuName</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01642">tagCLSMENUNAME::pwszClientUnicodeMenuName</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00109">InitConsoleIME()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01613">msProfCallback()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00262">msProfClassGroup()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00828">msProfCreateDestroyButton()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00555">msProfCreateDestroyChildWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00880">msProfCreateDestroyCombobox()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00932">msProfCreateDestroyEdit()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00776">msProfCreateDestroyListbox()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01036">msProfCreateDestroyScrollbar()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00984">msProfCreateDestroyStatic()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00501">msProfCreateDestroyWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01559">msProfDispatchMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00674">msProfGetWindowLong()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01088">msProfListboxInsert1()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01153">msProfListboxInsert2()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01217">msProfListboxInsert3()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00224">msProfRegisterClass()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01659">msProfSendMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00725">msProfSetWindowLong()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01843">msProfTranslateMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01791">msProfUpdateWindow()</a>, and <a class="el" href="../../d2/d0/bench_8c-source.html#l01705">SendMessageDiffThreadFunc()</a>.
<p>
<pre class="fragment"><div>00973 {
00974     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strClassName;
00975     <a class="code" href="../../d8/d0/structtagCLSMENUNAME.html">CLSMENUNAME</a> cmn;
00976 
00977     <span class="comment">/*</span>
00978 <span class="comment">     * Make sure cleanup will work successfully</span>
00979 <span class="comment">     */</span>
00980     strClassName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00981 
00982     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00983 
00984         FIRSTCOPYLPTSTRID(&amp;strClassName, pszClassName);
00985 
00986         retval = (DWORD)NtUserUnregisterClass(
00987                 strClassName.pstr,
00988                 hModule,
00989                 &amp;cmn);
00990 
00991 
00992         <span class="comment">/*</span>
00993 <span class="comment">         * Check explicity for TRUE so we don't get a !FALSE when</span>
00994 <span class="comment">         * converttogui fails and the NtUser returns a status code intead of bool.</span>
00995 <span class="comment">         */</span>
00996         if (retval == TRUE) {
00997             <span class="comment">/*</span>
00998 <span class="comment">             * Free the menu strings if they are not resource IDs</span>
00999 <span class="comment">             */</span>
01000             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.pszClientAnsiMenuName)) {
01001                 LocalFree(cmn.pszClientAnsiMenuName);
01002             }
01003             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.pwszClientUnicodeMenuName)) {
01004                 LocalFree(cmn.pwszClientUnicodeMenuName);
01005             }
01006         }
01007 
01008     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
01009     <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strClassName);
01010     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
01011 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ntcftxt.h::VkKeyScan" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> VkKeyScan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cChar</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01013">1013</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09282">NtUserVkKeyScanEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d8/d7/ntcon_2server_2clipbrd_8c-source.html#l00835">DoStringPaste()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00263">GetChar()</a>, and <a class="el" href="../../d3/d9/writescy_8c-source.html#l00018">main()</a>.
<p>
<pre class="fragment"><div>01015 {
01016     WCHAR wChar;
01017 
01018     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
01019 
01020 #ifdef UNICODE
01021         wChar = cChar;
01022 <span class="preprocessor">#else</span>
01023 <span class="preprocessor"></span><span class="preprocessor">#ifdef FE_SB // VkKeyScan()</span>
01024 <span class="preprocessor"></span>        <span class="comment">/*</span>
01025 <span class="comment">         * Return 0xFFFFFFFF for DBCS LeadByte character.</span>
01026 <span class="comment">         */</span>
01027         <span class="keywordflow">if</span> (IsDBCSLeadByte(cChar)) {
01028             <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
01029         }
01030 <span class="preprocessor">#endif // FE_SB</span>
01031 <span class="preprocessor"></span>
01032         <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>((LPWSTR)&amp;(wChar), <span class="keyword">sizeof</span>(WCHAR), NULL, &amp;cChar, <span class="keyword">sizeof</span>(CHAR));
01033 <span class="preprocessor">#endif // UNICODE</span>
01034 <span class="preprocessor"></span>
01035         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a319">NtUserVkKeyScanEx</a>(
01036                 wChar,
01037                 0,
01038                 FALSE);
01039 
01040     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(-1);
01041     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(SHORT);
01042 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ntcftxt.h::VkKeyScanEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> VkKeyScanEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>cChar</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HKL&nbsp;</td>
          <td class="mdname" nowrap> <em>hkl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01048">1048</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
References <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00027">BEGINCALL</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00047">ENDCALL</a>, <a class="el" href="../../d8/d8/ntsend_8h-source.html#l00035">ERRORTRAP</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01045">hVKSCachedHKL</a>, <a class="el" href="../../d6/d7/crecv_8c-source.html#l00069">MSGERROR</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09282">NtUserVkKeyScanEx()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01046">uVKSCachedCP</a>.
<p>
<pre class="fragment"><div>01051 {
01052     WCHAR wChar;
01053     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
01054 
01055 #ifdef UNICODE
01056         wChar = cChar;
01057 <span class="preprocessor">#else</span>
01058 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (hkl != <a class="code" href="../../d0/d8/ntcftxt_8h.html#a8">hVKSCachedHKL</a>) {
01059             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCodePage;
01060             <span class="keywordflow">if</span> (!GetLocaleInfoW(
01061                      HandleToUlong(hkl) &amp; 0xffff,
01062                      LOCALE_IDEFAULTANSICODEPAGE | LOCALE_RETURN_NUMBER,
01063                      (LPWSTR)&amp;dwCodePage,
01064                      <span class="keyword">sizeof</span>(dwCodePage) / <span class="keyword">sizeof</span>(WCHAR)
01065                      )) {
01066                 <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
01067             }
01068             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a9">uVKSCachedCP</a> = dwCodePage;
01069             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a8">hVKSCachedHKL</a> = hkl;
01070         }
01071 
01072 <span class="preprocessor">#ifdef FE_SB // VkKeyScanEx()</span>
01073 <span class="preprocessor"></span>        <span class="comment">/*</span>
01074 <span class="comment">         * Return 0xFFFFFFFF for DBCS LeadByte character.</span>
01075 <span class="comment">         */</span>
01076         <span class="keywordflow">if</span> (IsDBCSLeadByteEx(uVKSCachedCP,cChar)) {
01077             <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
01078         }
01079 <span class="preprocessor">#endif // FE_SB</span>
01080 <span class="preprocessor"></span>
01081         <span class="keywordflow">if</span> (!MultiByteToWideChar(
01082                  uVKSCachedCP,
01083                  0,
01084                  &amp;cChar,
01085                  <span class="keyword">sizeof</span>(CHAR),
01086                  &amp;wChar,
01087                  <span class="keyword">sizeof</span>(WCHAR))) {
01088             <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>();
01089         }
01090 <span class="preprocessor">#endif // UNICODE</span>
01091 <span class="preprocessor"></span>
01092         retval = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a319">NtUserVkKeyScanEx</a>(
01093                 wChar,
01094                 (ULONG_PTR)hkl,
01095                 TRUE);
01096 
01097     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(-1);
01098     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(SHORT);
01099 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a5" doxytag="ntcftxt.h::hMVKCachedHKL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HKL <a class="el" href="../../d0/d8/ntcftxt_8h.html#a5">hMVKCachedHKL</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00371">371</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00374">MapVirtualKeyEx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ntcftxt.h::hVKSCachedHKL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HKL <a class="el" href="../../d0/d8/ntcftxt_8h.html#a8">hVKSCachedHKL</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01045">1045</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01048">VkKeyScanEx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ntcftxt.h::InternalFindWindowEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND TEXT_FN( <a class="el" href="../../d0/d8/ntcftxt_8h.html#a3">InternalFindWindowEx</a>)(HWND hwndParent, HWND hwndChild, LPCTSTR pClassName, LPCTSTR pWindowName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwFlag)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00026">26</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00070">FindWindow()</a>, and <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00061">FindWindowEx()</a>.
<p>
<pre class="fragment"><div>00032 {
00033     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strClass;
00034     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strWindow;
00035 
00036     <span class="comment">/*</span>
00037 <span class="comment">     * Make sure cleanup will work successfully</span>
00038 <span class="comment">     */</span>
00039     strClass.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00040     strWindow.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00041 
00042     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00043 
00044         FIRSTCOPYLPTSTRIDOPT(&amp;strClass, pClassName);
00045         COPYLPTSTROPT(&amp;strWindow, pWindowName);
00046 
00047         retval = (ULONG_PTR)NtUserFindWindowEx(
00048                 hwndParent,
00049                 hwndChild,
00050                 strClass.pstr,
00051                 strWindow.pstr,
00052                 dwFlag);
00053 
00054     ERRORTRAP(0);
00055     CLEANUPLPTSTR(strClass);
00056     CLEANUPLPTSTR(strWindow);
00057     ENDCALL(HWND);
00058 
00059 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ntcftxt.h::mpPfnAddress" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WNDPROC <a class="el" href="../../d0/d8/ntcftxt_8h.html#a4">mpPfnAddress</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00077">77</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ntcftxt.h::RegisterClassExWOW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ATOM TEXT_FN( <a class="el" href="../../d0/d8/ntcftxt_8h.html#a7">RegisterClassExWOW</a>)(WNDCLASSEX *lpWndClass, LPDWORD pdwWOWstuff, WORD fnid)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00652">652</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
<pre class="fragment"><div>00656 {
00657     WNDCLASSEX WndClass;
00658     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strClassName;
00659     <a class="code" href="../../d8/d1/struct__IN__STRING.html">IN_STRING</a> strMenuName;
00660     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, dwExpWinVer;
00661     <a class="code" href="../../d8/d0/structtagCLSMENUNAME.html">CLSMENUNAME</a> cmn;
00662 
00663     strClassName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a> = 0;
00664     strMenuName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o2">fAllocated</a>  = 0;
00665 
00666     <span class="comment">/*</span>
00667 <span class="comment">     * Skip validation for our classes</span>
00668 <span class="comment">     */</span>
00669     <span class="keywordflow">if</span> (fnid !=0) {
00670         <span class="comment">/*</span>
00671 <span class="comment">         * This is a hack to bypass validation for DDE classes</span>
00672 <span class="comment">         * specifically, allow them to use hmodUser.</span>
00673 <span class="comment">         */</span>
00674          <span class="keywordflow">if</span> (fnid == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a225">FNID_DDE_BIT</a>) {
00675              fnid = 0;
00676          }
00677          dwExpWinVer = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>;
00678     } <span class="keywordflow">else</span> {
00679         <span class="keywordflow">if</span> (lpWndClass-&gt;cbSize != <span class="keyword">sizeof</span>(WNDCLASSEX)) {
00680             RIPMSG0(RIP_WARNING, <span class="stringliteral">"RegisterClass: Invalid cbSize"</span>);
00681         }
00682 
00683         <span class="keywordflow">if</span> (lpWndClass-&gt;cbClsExtra &lt; 0 ||
00684                 lpWndClass-&gt;cbWndExtra &lt; 0) {
00685             RIPMSG0(RIP_WARNING, <span class="stringliteral">"RegisterClass: invalid cb*Extra"</span>);
00686             <span class="keywordflow">goto</span> BadParameter;
00687         }
00688 
00689         <span class="comment">/*</span>
00690 <span class="comment">         * Validate hInstance</span>
00691 <span class="comment">         * Don't allow 4.0 apps to use hmodUser</span>
00692 <span class="comment">         */</span>
00693          <span class="keywordflow">if</span> ((lpWndClass-&gt;hInstance == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>)
00694                 &amp;&amp; (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>()-&gt;dwExpWinVer &gt;= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>)) {
00695              RIPMSG0(RIP_WARNING, <span class="stringliteral">"RegisterClass: Cannot use USER's hInstance"</span>);
00696              <span class="keywordflow">goto</span> BadParameter;
00697          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpWndClass-&gt;hInstance == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00698             <span class="comment">/*</span>
00699 <span class="comment">             * For 32 bit apps we need to fix up the hInstance because Win 95 does</span>
00700 <span class="comment">             * this in their thunk MapHInstLS</span>
00701 <span class="comment">             */</span>
00702 
00703             lpWndClass-&gt;hInstance = GetModuleHandle(NULL);
00704             RIPMSG1(RIP_VERBOSE, <span class="stringliteral">"RegisterClass: fixing up NULL hmodule to %#p"</span>,
00705                     lpWndClass-&gt;hInstance);
00706         }
00707 
00708         dwExpWinVer = <a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(lpWndClass-&gt;hInstance);
00709 
00710 
00711         <span class="comment">/*</span>
00712 <span class="comment">         * Check for valid style bits and strip if appropriate</span>
00713 <span class="comment">         */</span>
00714         <span class="keywordflow">if</span> (lpWndClass-&gt;style &amp; ~CS_VALID40) {
00715 
00716             <span class="keywordflow">if</span> (dwExpWinVer &gt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a102">VER31</a>) {
00717                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"RegisterClass: Invalid class style"</span>);
00718                 <span class="keywordflow">goto</span> BadParameter;
00719             }
00720 
00721             <span class="comment">/*</span>
00722 <span class="comment">             * Old application - strip bogus bits and pass through</span>
00723 <span class="comment">             */</span>
00724             RIPMSG0(RIP_WARNING, <span class="stringliteral">"RegisterClass: Invalid class style, stripping bad styles"</span>);
00725             lpWndClass-&gt;style &amp;= CS_VALID40;
00726         }
00727 
00728         <span class="comment">/*</span>
00729 <span class="comment">         * Validate hbrBackground</span>
00730 <span class="comment">         */</span>
00731         <span class="keywordflow">if</span> (lpWndClass-&gt;hbrBackground &gt; (HBRUSH)COLOR_MAX
00732                 &amp;&amp; !GdiValidateHandle(lpWndClass-&gt;hbrBackground)) {
00733 
00734             RIPMSG1(RIP_WARNING, <span class="stringliteral">"RegisterClass: Invalid class brush:%#p"</span>, lpWndClass-&gt;hbrBackground);
00735             <span class="keywordflow">if</span> (dwExpWinVer &gt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a103">VER30</a>) {
00736                 <span class="keywordflow">goto</span> BadParameter;
00737             }
00738 
00739             lpWndClass-&gt;hbrBackground = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00740         }
00741 
00742     } <span class="comment">/* if (fnid !=0) */</span>
00743 
00744 
00745     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d8/ntcftxt_8h.html#a2">InitClsMenuName</a>(&amp;cmn, lpWndClass-&gt;lpszMenuName, &amp;strMenuName)) {
00746         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00747     }
00748 
00749     <a class="code" href="../../d7/d9/ntsend_8h.html#a1">BEGINCALL</a>()
00750 
00751         WndClass = *lpWndClass;
00752 
00753 #ifdef UNICODE
00754         dwFlags = 0;
00755 #else
00756         dwFlags = CSF_ANSIPROC;
00757 #endif <span class="comment">// UNICODE</span>
00758 
00759         if (dwExpWinVer &gt; VER31) {
00760             <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> |= <a class="code" href="../../d1/d0/inc_2user_8h.html#a491">CSF_WIN40COMPAT</a>;
00761         }
00762 
00763         <a class="code" href="../../d7/d9/ntsend_8h.html#a46">COPYLPTSTRID</a>(&amp;strClassName, (LPTSTR)lpWndClass-&gt;lpszClassName);
00764 
00765         retval = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a314">NtUserRegisterClassExWOW</a>(
00766                 &amp;WndClass,
00767                 strClassName.<a class="code" href="../../d8/d1/struct__IN__STRING.html#o1">pstr</a>,
00768                 &amp;cmn,
00769                 fnid,
00770                 dwFlags,
00771                 pdwWOWstuff);
00772 
00773         <span class="comment">/*</span>
00774 <span class="comment">         * Return the atom associated with this class or if earlier</span>
00775 <span class="comment">         * than Win 3.1 convert it to a strict BOOL (some apps check)</span>
00776 <span class="comment">         */</span>
00777         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(lpWndClass-&gt;hInstance) &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a102">VER31</a>)
00778             retval = !!retval;
00779 
00780     <a class="code" href="../../d7/d9/ntsend_8h.html#a3">ERRORTRAP</a>(0);
00781     <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strMenuName);     <span class="comment">/* Initialized by InitClsMenuName */</span>
00782     <a class="code" href="../../d7/d9/ntsend_8h.html#a55">CLEANUPLPTSTR</a>(strClassName);
00783 
00784     <span class="keywordflow">if</span> (!retval) {
00785         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a>)) {
00786             LocalFree(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o0">pszClientAnsiMenuName</a>);
00787         }
00788         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a>)) {
00789             LocalFree(cmn.<a class="code" href="../../d8/d0/structtagCLSMENUNAME.html#o1">pwszClientUnicodeMenuName</a>);
00790         }
00791     }
00792     <a class="code" href="../../d7/d9/ntsend_8h.html#a5">ENDCALL</a>(BOOL);
00793 
00794 BadParameter:
00795     RIPERR0(ERROR_INVALID_PARAMETER, RIP_VERBOSE, <span class="stringliteral">"RegisterClass: Invalid Parameter"</span>);
00796     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00797 
00798 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ntcftxt.h::uMVKCachedCP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT <a class="el" href="../../d0/d8/ntcftxt_8h.html#a6">uMVKCachedCP</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00372">372</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00374">MapVirtualKeyEx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ntcftxt.h::uVKSCachedCP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT <a class="el" href="../../d0/d8/ntcftxt_8h.html#a9">uVKSCachedCP</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01046">1046</a> of file <a class="el" href="../../d1/d7/ntcftxt_8h-source.html">ntcftxt.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01048">VkKeyScanEx()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:52 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
