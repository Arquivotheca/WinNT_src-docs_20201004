<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: constubs.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>constubs.c</h1><a href="../../d9/d5/constubs_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    constubs.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">Author:</span>
00012 <span class="comment"></span>
00013 <span class="comment">    KazuM Mar.05.1992</span>
00014 <span class="comment"></span>
00015 <span class="comment">Revision History:</span>
00016 <span class="comment"></span>
00017 <span class="comment">--*/</span>
00018 
00019 <span class="preprocessor">#include "<a class="code" href="../../d6/d3/w32_2ntcon_2server_2precomp_8h.html">precomp.h</a>"</span>
00020 <span class="preprocessor">#pragma hdrstop</span>
00021 <span class="preprocessor"></span>
00022 
00023 <span class="preprocessor">#if defined(FE_SB)</span>
00024 <span class="preprocessor"></span>ULONG
00025 SrvGetConsoleCharType(
00026     IN OUT PCSR_API_MSG m,
00027     IN OUT PCSR_REPLY_STATUS ReplyStatus
00028     )
00029 
00030 <span class="comment">/*++</span>
00031 <span class="comment"></span>
00032 <span class="comment">Routine Description:</span>
00033 <span class="comment"></span>
00034 <span class="comment">    This routine check character type.</span>
00035 <span class="comment"></span>
00036 <span class="comment">Arguments:</span>
00037 <span class="comment"></span>
00038 <span class="comment">    m - message containing api parameters</span>
00039 <span class="comment"></span>
00040 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00041 <span class="comment"></span>
00042 <span class="comment">Return Value:</span>
00043 <span class="comment"></span>
00044 <span class="comment">--*/</span>
00045 
00046 {
00047     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00048     PCONSOLE_CHAR_TYPE_MSG a = (PCONSOLE_CHAR_TYPE_MSG)&amp;m-&gt;u.ApiMessageData;
00049     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00050     <a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo;
00051     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00052     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> RowIndex;
00053     <a class="code" href="../../d9/d4/struct__ROW.html">PROW</a> Row;
00054     PWCHAR Char;
00055 
00056     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00057                          &amp;Console
00058                         );
00059     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00060         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00061     }
00062 
00063     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00064                                  a-&gt;Handle,
00065                                  CONSOLE_OUTPUT_HANDLE,
00066                                  GENERIC_READ,
00067                                  &amp;HandleData
00068                                 );
00069     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00070 
00071         ScreenInfo = HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.ScreenBuffer;
00072 
00073 <span class="preprocessor">#if defined(DBG) &amp;&amp; defined(DBG_KATTR)</span>
00074 <span class="preprocessor"></span>        BeginKAttrCheck(ScreenInfo);
00075 <span class="preprocessor">#endif</span>
00076 <span class="preprocessor"></span>
00077         <span class="keywordflow">if</span> (a-&gt;coordCheck.X &gt;= ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o5">ScreenBufferSize</a>.X ||
00078             a-&gt;coordCheck.Y &gt;= ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o5">ScreenBufferSize</a>.Y) {
00079             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_INVALID_PARAMETER;
00080         }
00081         <span class="keywordflow">else</span> {
00082             RowIndex = (ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o22">BufferInfo</a>.TextInfo.FirstRow+a-&gt;coordCheck.Y) % ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o5">ScreenBufferSize</a>.Y;
00083             Row = &amp;ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o22">BufferInfo</a>.TextInfo.Rows[RowIndex];
00084             Char = &amp;Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o0">CharRow</a>.<a class="code" href="../../d6/d9/struct__CHAR__ROW.html#o4">Chars</a>[a-&gt;coordCheck.X];
00085             <span class="keywordflow">if</span> (!CONSOLE_IS_DBCS_OUTPUTCP(ScreenInfo-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o0">Console</a>))
00086                 a-&gt;dwType = CHAR_TYPE_SBCS;
00087             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o0">CharRow</a>.KAttrs[a-&gt;coordCheck.X] &amp; ATTR_TRAILING_BYTE)
00088                 a-&gt;dwType = CHAR_TYPE_TRAILING;
00089             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o0">CharRow</a>.KAttrs[a-&gt;coordCheck.X] &amp; ATTR_LEADING_BYTE)
00090                 a-&gt;dwType = CHAR_TYPE_LEADING;
00091             <span class="keywordflow">else</span>
00092                 a-&gt;dwType = CHAR_TYPE_SBCS;
00093         }
00094     }
00095 
00096     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00097     <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00098     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00099 }
00100 
00101 ULONG
00102 SrvSetConsoleLocalEUDC(
00103     IN OUT PCSR_API_MSG m,
00104     IN OUT PCSR_REPLY_STATUS ReplyStatus
00105     )
00106 
00107 <span class="comment">/*++</span>
00108 <span class="comment"></span>
00109 <span class="comment">Routine Description:</span>
00110 <span class="comment"></span>
00111 <span class="comment">    This routine sets Local EUDC Font.</span>
00112 <span class="comment"></span>
00113 <span class="comment">Arguments:</span>
00114 <span class="comment"></span>
00115 <span class="comment">    m - message containing api parameters</span>
00116 <span class="comment"></span>
00117 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00118 <span class="comment"></span>
00119 <span class="comment">Return Value:</span>
00120 <span class="comment"></span>
00121 <span class="comment">--*/</span>
00122 
00123 {
00124     PCONSOLE_LOCAL_EUDC_MSG a = (PCONSOLE_LOCAL_EUDC_MSG)&amp;m-&gt;u.ApiMessageData;
00125     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00126     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00127     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00128     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Source[4];
00129     WCHAR Target[2];
00130 
00131     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00132                          &amp;Console
00133                         );
00134     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00135         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00136     }
00137 
00138     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00139                                  a-&gt;Handle,
00140                                  CONSOLE_OUTPUT_HANDLE,
00141                                  GENERIC_WRITE,
00142                                  &amp;HandleData
00143                                 );
00144     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00145         <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00146         <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00147     }
00148 
00149     <span class="keywordflow">if</span> (!CsrValidateMessageBuffer(m, &amp;a-&gt;FontFace, ((a-&gt;FontSize.X + 7) / 8), a-&gt;FontSize.Y)) {
00150         <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00151         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
00152     }
00153 
00154     Source[0] = (<span class="keywordtype">char</span>)(a-&gt;CodePoint &gt;&gt; 8) ;
00155     Source[1] = (<span class="keywordtype">char</span>)(a-&gt;CodePoint &amp; 0x00ff) ;
00156     Source[2] = 0 ;
00157     <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a37">ConvertOutputToUnicode</a>(Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o62">OutputCP</a>,Source,2,Target,1);
00158 
00159     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/eudc_8h.html#a8">IsEudcRange</a>(Console,Target[0]))
00160     {
00161         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d7/eudc_8h.html#a5">RegisterLocalEUDC</a>(Console,Target[0],a-&gt;FontSize,a-&gt;FontFace);
00162         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00163             ((<a class="code" href="../../d2/d7/struct__EUDC__INFORMATION.html">PEUDC_INFORMATION</a>)(Console-&gt;EudcInformation))-&gt;LocalVDMEudcMode = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00164         }
00165     }
00166     <span class="keywordflow">else</span> {
00167         <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00168         <span class="keywordflow">return</span> (ULONG)STATUS_INVALID_PARAMETER;
00169     }
00170 
00171     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00172     <span class="keywordflow">return</span> STATUS_SUCCESS;
00173     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00174 }
00175 
00176 ULONG
00177 SrvSetConsoleCursorMode(
00178     IN OUT PCSR_API_MSG m,
00179     IN OUT PCSR_REPLY_STATUS ReplyStatus
00180     )
00181 
00182 <span class="comment">/*++</span>
00183 <span class="comment"></span>
00184 <span class="comment">Routine Description:</span>
00185 <span class="comment"></span>
00186 <span class="comment">    This routine sets Cursor Mode.</span>
00187 <span class="comment"></span>
00188 <span class="comment">Arguments:</span>
00189 <span class="comment"></span>
00190 <span class="comment">    m - message containing api parameters</span>
00191 <span class="comment"></span>
00192 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00193 <span class="comment"></span>
00194 <span class="comment">Return Value:</span>
00195 <span class="comment"></span>
00196 <span class="comment">--*/</span>
00197 
00198 {
00199     PCONSOLE_CURSOR_MODE_MSG a = (PCONSOLE_CURSOR_MODE_MSG)&amp;m-&gt;u.ApiMessageData;
00200     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00201     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00202     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00203 
00204     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00205                          &amp;Console
00206                         );
00207     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00208         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00209     }
00210 
00211     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00212                                  a-&gt;Handle,
00213                                  CONSOLE_OUTPUT_HANDLE,
00214                                  GENERIC_WRITE,
00215                                  &amp;HandleData
00216                                 );
00217     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00218         <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00219         <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00220     }
00221 
00222     HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.ScreenBuffer-&gt;BufferInfo.TextInfo.CursorBlink = (BOOLEAN)a-&gt;Blink ;
00223     HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.ScreenBuffer-&gt;BufferInfo.TextInfo.CursorDBEnable = (BOOLEAN)a-&gt;DBEnable ;
00224 
00225     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00226     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00227     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00228 }
00229 
00230 
00231 ULONG
00232 SrvGetConsoleCursorMode(
00233     IN OUT PCSR_API_MSG m,
00234     IN OUT PCSR_REPLY_STATUS ReplyStatus
00235     )
00236 
00237 <span class="comment">/*++</span>
00238 <span class="comment"></span>
00239 <span class="comment">Routine Description:</span>
00240 <span class="comment"></span>
00241 <span class="comment">    This routine gets Cursor Mode.</span>
00242 <span class="comment"></span>
00243 <span class="comment">Arguments:</span>
00244 <span class="comment"></span>
00245 <span class="comment">    m - message containing api parameters</span>
00246 <span class="comment"></span>
00247 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00248 <span class="comment"></span>
00249 <span class="comment">Return Value:</span>
00250 <span class="comment"></span>
00251 <span class="comment">--*/</span>
00252 
00253 {
00254     PCONSOLE_CURSOR_MODE_MSG a = (PCONSOLE_CURSOR_MODE_MSG)&amp;m-&gt;u.ApiMessageData;
00255     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00256     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00257     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00258 
00259     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00260                          &amp;Console
00261                         );
00262     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00263         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00264     }
00265 
00266     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00267                                  a-&gt;Handle,
00268                                  CONSOLE_OUTPUT_HANDLE,
00269                                  GENERIC_READ,
00270                                  &amp;HandleData
00271                                 );
00272     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00273         <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00274         <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00275     }
00276 
00277     a-&gt;Blink = HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.ScreenBuffer-&gt;BufferInfo.TextInfo.CursorBlink ;
00278     a-&gt;DBEnable = HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.ScreenBuffer-&gt;BufferInfo.TextInfo.CursorDBEnable ;
00279 
00280     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00281     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00282     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00283 }
00284 
00285 ULONG
00286 SrvRegisterConsoleOS2(
00287     IN OUT PCSR_API_MSG m,
00288     IN OUT PCSR_REPLY_STATUS ReplyStatus
00289     )
00290 
00291 <span class="comment">/*++</span>
00292 <span class="comment"></span>
00293 <span class="comment">  This function calls NEC PC-98 machine's only.</span>
00294 <span class="comment"></span>
00295 <span class="comment">--*/</span>
00296 
00297 {
00298     PCONSOLE_REGISTEROS2_MSG a = (PCONSOLE_REGISTEROS2_MSG)&amp;m-&gt;u.ApiMessageData;
00299     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00300     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00301     HANDLE hEvent = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00302 
00303     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00304                          &amp;Console
00305                         );
00306     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00307         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00308     }
00309 <span class="preprocessor">#if defined(i386)</span>
00310 <span class="preprocessor"></span>    {
00311         <span class="keywordflow">if</span> (!a-&gt;fOs2Register) {
00312             Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o35">Flags</a> &amp;= ~ CONSOLE_OS2_REGISTERED;
00313             <a class="code" href="../../d6/d2/output_8c.html#a67">ResizeWindow</a>(Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o4">CurrentScreenBuffer</a>, &amp;Console-&gt;Os2SavedWindowRect, FALSE);
00314         }
00315         <span class="keywordflow">else</span> {
00316             Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o35">Flags</a> |= CONSOLE_OS2_REGISTERED;
00317             Console-&gt;Os2SavedWindowRect = Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o4">CurrentScreenBuffer</a>-&gt;<a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html#o6">Window</a>;
00318         }
00319     }
00320 <span class="preprocessor">#endif // i386</span>
00321 <span class="preprocessor"></span>
00322     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00323     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00324     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00325 }
00326 
00327 ULONG
00328 SrvSetConsoleOS2OemFormat(
00329     IN OUT PCSR_API_MSG m,
00330     IN OUT PCSR_REPLY_STATUS ReplyStatus
00331     )
00332 
00333 <span class="comment">/*++</span>
00334 <span class="comment"></span>
00335 <span class="comment">  This function calls NEC PC-98 machine's only.</span>
00336 <span class="comment"></span>
00337 <span class="comment">--*/</span>
00338 
00339 {
00340     PCONSOLE_SETOS2OEMFORMAT_MSG a = (PCONSOLE_SETOS2OEMFORMAT_MSG)&amp;m-&gt;u.ApiMessageData;
00341     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00342     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00343 
00344     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00345                          &amp;Console
00346                         );
00347     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00348         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00349     }
00350 <span class="preprocessor">#if defined(i386)</span>
00351 <span class="preprocessor"></span>    {
00352         <span class="keywordflow">if</span> (!a-&gt;fOs2OemFormat) {
00353             Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o35">Flags</a> &amp;= ~CONSOLE_OS2_OEM_FORMAT;
00354         }
00355         <span class="keywordflow">else</span> {
00356             Console-&gt;<a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html#o35">Flags</a> |= CONSOLE_OS2_OEM_FORMAT;
00357         }
00358     }
00359 <span class="preprocessor">#endif // i386</span>
00360 <span class="preprocessor"></span>
00361     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00362     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00363     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00364 }
00365 
00366 <span class="preprocessor">#if defined(FE_IME)</span>
00367 <span class="preprocessor"></span>ULONG
00368 SrvGetConsoleNlsMode(
00369     IN OUT PCSR_API_MSG m,
00370     IN OUT PCSR_REPLY_STATUS ReplyStatus
00371     )
00372 
00373 <span class="comment">/*++</span>
00374 <span class="comment"></span>
00375 <span class="comment">Routine Description:</span>
00376 <span class="comment"></span>
00377 <span class="comment">    This routine gets NLS mode for input.</span>
00378 <span class="comment"></span>
00379 <span class="comment">Arguments:</span>
00380 <span class="comment"></span>
00381 <span class="comment">    m - message containing api parameters</span>
00382 <span class="comment"></span>
00383 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00384 <span class="comment"></span>
00385 <span class="comment">Return Value:</span>
00386 <span class="comment"></span>
00387 <span class="comment">--*/</span>
00388 
00389 {
00390     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00391     PCONSOLE_NLS_MODE_MSG a = (PCONSOLE_NLS_MODE_MSG)&amp;m-&gt;u.ApiMessageData;
00392     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00393     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00394     HANDLE hEvent = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00395 
00396     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00397                          &amp;Console
00398                         );
00399     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00400         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00401     }
00402 
00403     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00404                                  a-&gt;Handle,
00405                                  CONSOLE_INPUT_HANDLE,
00406                                  GENERIC_READ,
00407                                  &amp;HandleData
00408                                 );
00409     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00410         <span class="keywordflow">goto</span> SrvGetConsoleNlsModeFailure;
00411     }
00412 
00413     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d0/obhandle_8c.html#a4">NtDuplicateObject</a>(<a class="code" href="../../d1/d7/server_8h.html#a79">CONSOLE_CLIENTPROCESSHANDLE</a>(),
00414                        a-&gt;hEvent,
00415                        NtCurrentProcess(),
00416                        &amp;hEvent,
00417                        0,
00418                        FALSE,
00419                        DUPLICATE_SAME_ACCESS
00420                        );
00421     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00422         <span class="keywordflow">goto</span> SrvGetConsoleNlsModeFailure;
00423     }
00424 
00425     <span class="comment">/*</span>
00426 <span class="comment">     * Caller should set FALSE on a-&gt;Ready.</span>
00427 <span class="comment">     */</span>
00428     <span class="keywordflow">if</span> (a-&gt;Ready == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)
00429     {
00430         a-&gt;Ready = HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.InputBuffer-&gt;ImeMode.ReadyConversion;
00431 
00432         <span class="keywordflow">if</span> (a-&gt;Ready == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)
00433         {
00434             <span class="comment">/*</span>
00435 <span class="comment">             * If not ready ImeMode.Conversion,</span>
00436 <span class="comment">             * then get conversion status from ConIME.</span>
00437 <span class="comment">             */</span>
00438             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d2/output_8c.html#a76">QueueConsoleMessage</a>(Console,
00439                         CM_GET_NLSMODE,
00440                         (WPARAM)hEvent,
00441                         0L
00442                        );
00443             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00444                 <span class="keywordflow">goto</span> SrvGetConsoleNlsModeFailure;
00445             }
00446         }
00447         <span class="keywordflow">else</span>
00448         {
00449             <span class="keywordflow">if</span> (! HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.InputBuffer-&gt;ImeMode.Disable) {
00450                 a-&gt;NlsMode = <a class="code" href="../../d0/d3/dbcs_8h.html#a54">ImmConversionToConsole</a>(
00451                                  HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.InputBuffer-&gt;ImeMode.Conversion );
00452             }
00453             <span class="keywordflow">else</span> {
00454                 a-&gt;NlsMode = 0;
00455             }
00456             <a class="code" href="../../d0/d8/ex_2event_8c.html#a10">NtSetEvent</a>(hEvent, NULL);
00457             <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(hEvent);
00458         }
00459     }
00460     <span class="keywordflow">else</span>
00461     {
00462         <span class="keywordflow">if</span> (! HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.InputBuffer-&gt;ImeMode.Disable) {
00463             a-&gt;NlsMode = <a class="code" href="../../d0/d3/dbcs_8h.html#a54">ImmConversionToConsole</a>(
00464                              HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o5">Buffer</a>.InputBuffer-&gt;ImeMode.Conversion );
00465         }
00466         <span class="keywordflow">else</span> {
00467             a-&gt;NlsMode = 0;
00468         }
00469         <a class="code" href="../../d0/d8/ex_2event_8c.html#a10">NtSetEvent</a>(hEvent, NULL);
00470         <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(hEvent);
00471     }
00472 
00473     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00474     <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00475 
00476 SrvGetConsoleNlsModeFailure:
00477     <span class="keywordflow">if</span> (hEvent) {
00478         <a class="code" href="../../d0/d8/ex_2event_8c.html#a10">NtSetEvent</a>(hEvent, NULL);
00479         <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(hEvent);
00480     }
00481     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00482     <span class="keywordflow">return</span>((ULONG) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00483 
00484     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00485 }
00486 
00487 ULONG
00488 SrvSetConsoleNlsMode(
00489     IN OUT PCSR_API_MSG m,
00490     IN OUT PCSR_REPLY_STATUS ReplyStatus
00491     )
00492 
00493 <span class="comment">/*++</span>
00494 <span class="comment"></span>
00495 <span class="comment">Routine Description:</span>
00496 <span class="comment"></span>
00497 <span class="comment">    This routine sets NLS mode for input.</span>
00498 <span class="comment"></span>
00499 <span class="comment">Arguments:</span>
00500 <span class="comment"></span>
00501 <span class="comment">    m - message containing api parameters</span>
00502 <span class="comment"></span>
00503 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00504 <span class="comment"></span>
00505 <span class="comment">Return Value:</span>
00506 <span class="comment"></span>
00507 <span class="comment">--*/</span>
00508 
00509 {
00510     PCONSOLE_NLS_MODE_MSG a = (PCONSOLE_NLS_MODE_MSG)&amp;m-&gt;u.ApiMessageData;
00511     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00512     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
00513     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
00514     HANDLE hEvent = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00515 
00516     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a33">ApiPreamble</a>(a-&gt;ConsoleHandle,
00517                          &amp;Console
00518                         );
00519     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00520         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00521     }
00522 
00523     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a31">DereferenceIoHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a84">CONSOLE_PERPROCESSDATA</a>(),
00524                                  a-&gt;Handle,
00525                                  CONSOLE_INPUT_HANDLE,
00526                                  GENERIC_WRITE,
00527                                  &amp;HandleData
00528                                 );
00529     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00530         <span class="keywordflow">goto</span> SrvSetConsoleNlsModeFailure;
00531     }
00532 
00533     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d0/obhandle_8c.html#a4">NtDuplicateObject</a>(<a class="code" href="../../d1/d7/server_8h.html#a79">CONSOLE_CLIENTPROCESSHANDLE</a>(),
00534                        a-&gt;hEvent,
00535                        NtCurrentProcess(),
00536                        &amp;hEvent,
00537                        0,
00538                        FALSE,
00539                        DUPLICATE_SAME_ACCESS
00540                        );
00541     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00542         <span class="keywordflow">goto</span> SrvSetConsoleNlsModeFailure;
00543     }
00544 
00545     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d2/output_8c.html#a76">QueueConsoleMessage</a>(Console,
00546                 CM_SET_NLSMODE,
00547                 (WPARAM)hEvent,
00548                 a-&gt;NlsMode
00549                );
00550     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00551         <span class="keywordflow">goto</span> SrvSetConsoleNlsModeFailure;
00552     }
00553 
00554     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00555     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00556 
00557 SrvSetConsoleNlsModeFailure:
00558     <span class="keywordflow">if</span> (hEvent) {
00559         <a class="code" href="../../d0/d8/ex_2event_8c.html#a10">NtSetEvent</a>(hEvent, NULL);
00560         <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(hEvent);
00561     }
00562     <a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a54">UnlockConsole</a>(Console);
00563     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00564 
00565     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00566 }
00567 
00568 ULONG
00569 SrvRegisterConsoleIME(
00570     IN OUT PCSR_API_MSG m,
00571     IN OUT PCSR_REPLY_STATUS ReplyStatus
00572     )
00573 
00574 <span class="comment">/*++</span>
00575 <span class="comment"></span>
00576 <span class="comment">Routine Description:</span>
00577 <span class="comment"></span>
00578 <span class="comment">    This routine register console IME on the current desktop.</span>
00579 <span class="comment"></span>
00580 <span class="comment">Arguments:</span>
00581 <span class="comment"></span>
00582 <span class="comment">    m - message containing api parameters</span>
00583 <span class="comment"></span>
00584 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00585 <span class="comment"></span>
00586 <span class="comment">Return Value:</span>
00587 <span class="comment"></span>
00588 <span class="comment">--*/</span>
00589 
00590 {
00591     PCONSOLE_REGISTER_CONSOLEIME_MSG a = (PCONSOLE_REGISTER_CONSOLEIME_MSG)&amp;m-&gt;u.ApiMessageData;
00592     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00593     PCSR_PROCESS Process;
00594     HDESK hdesk;
00595     HWINSTA hwinsta;
00596     UNICODE_STRING strDesktopName;
00597 
00598     a-&gt;dwConsoleThreadId = 0;
00599 
00600     <span class="keywordflow">if</span> (!CsrValidateMessageBuffer(m, &amp;a-&gt;Desktop, a-&gt;DesktopLength, <span class="keyword">sizeof</span>(BYTE))) {
00601         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
00602     }
00603 
00604     <span class="comment">//</span>
00605     <span class="comment">// Connect to the windowstation and desktop.</span>
00606     <span class="comment">//</span>
00607 
00608     <span class="keywordflow">if</span> (!CsrImpersonateClient(NULL)) {
00609         <span class="keywordflow">return</span> (ULONG)STATUS_BAD_IMPERSONATION_LEVEL;
00610     }
00611 
00612     Process = (PCSR_PROCESS)(CSR_SERVER_QUERYCLIENTTHREAD()-&gt;Process);
00613     <span class="keywordflow">if</span> (a-&gt;DesktopLength)
00614         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strDesktopName, a-&gt;Desktop);
00615     <span class="keywordflow">else</span>
00616         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strDesktopName, L<span class="stringliteral">"Default"</span>);
00617     hdesk = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a97">NtUserResolveDesktop</a>(
00618             Process-&gt;ProcessHandle,
00619             &amp;strDesktopName, FALSE, &amp;hwinsta);
00620 
00621     CsrRevertToSelf();
00622 
00623     <span class="keywordflow">if</span> (hdesk == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00624         <span class="keywordflow">return</span> (ULONG)STATUS_UNSUCCESSFUL;
00625     }
00626 
00627     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ConSrvRegisterConsoleIME(Process,
00628                                       hdesk,
00629                                       hwinsta,
00630                                       a-&gt;hWndConsoleIME,
00631                                       a-&gt;dwConsoleIMEThreadId,
00632                                       REGCONIME_REGISTER,
00633                                       &amp;a-&gt;dwConsoleThreadId
00634                                      );
00635 
00636 
00637     <span class="keywordflow">return</span> ((ULONG)<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00638     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00639 }
00640 
00641 ULONG
00642 SrvUnregisterConsoleIME(
00643     IN OUT PCSR_API_MSG m,
00644     IN OUT PCSR_REPLY_STATUS ReplyStatus
00645     )
00646 
00647 <span class="comment">/*++</span>
00648 <span class="comment"></span>
00649 <span class="comment">Routine Description:</span>
00650 <span class="comment"></span>
00651 <span class="comment">    This routine unregister console IME on the current desktop.</span>
00652 <span class="comment"></span>
00653 <span class="comment">Arguments:</span>
00654 <span class="comment"></span>
00655 <span class="comment">    m - message containing api parameters</span>
00656 <span class="comment"></span>
00657 <span class="comment">    ReplyStatus - Indicates whether to reply to the dll port.</span>
00658 <span class="comment"></span>
00659 <span class="comment">Return Value:</span>
00660 <span class="comment"></span>
00661 <span class="comment">--*/</span>
00662 
00663 {
00664     PCONSOLE_UNREGISTER_CONSOLEIME_MSG a = (PCONSOLE_UNREGISTER_CONSOLEIME_MSG)&amp;m-&gt;u.ApiMessageData;
00665     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00666     PCSR_PROCESS Process;
00667     <a class="code" href="../../d0/d4/struct__CONSOLE__PER__PROCESS__DATA.html">PCONSOLE_PER_PROCESS_DATA</a> ProcessData;
00668 
00669     Process = (PCSR_PROCESS)(CSR_SERVER_QUERYCLIENTTHREAD()-&gt;Process);
00670     ProcessData = <a class="code" href="../../d1/d7/server_8h.html#a82">CONSOLE_FROMPROCESSPERPROCESSDATA</a>(Process);
00671 
00672     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ConSrvRegisterConsoleIME(Process,
00673                                       ProcessData-&gt;hDesk,
00674                                       ProcessData-&gt;hWinSta,
00675                                       NULL,
00676                                       a-&gt;dwConsoleIMEThreadId,
00677                                       REGCONIME_UNREGISTER,
00678                                       NULL
00679                                      );
00680 
00681 
00682     <span class="keywordflow">return</span> ((ULONG)<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00683     UNREFERENCED_PARAMETER(ReplyStatus);    <span class="comment">// get rid of unreferenced parameter warning message</span>
00684 }
00685 <span class="preprocessor">#endif // FE_IME</span>
00686 <span class="preprocessor"></span>
00687 <span class="preprocessor">#endif // FE_SB</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:33 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
