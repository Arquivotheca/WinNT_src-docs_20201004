<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: edithive.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>edithive.h File Reference</h1><code>#include "<a class="el" href="../../d0/d8/ntos_8h-source.html">ntos.h</a>"</code><br>
<code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>

<p>
<a href="../../d1/d4/edithive_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a0">TYPE_SIMPLE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a1">TYPE_LOG</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a2">TYPE_ALT</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a3">EhOpenHive</a> (IN PUNICODE_STRING <a class="el" href="../../d8/d1/hivestat_8c.html#a9">FileName</a>, OUT PHANDLE RootCell, OUT PUNICODE_STRING RootName, IN ULONG HiveType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a4">EhCloseHive</a> (IN HANDLE <a class="el" href="../../d7/d1/hivemap_8c.html#a0">Hive</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a5">EhEnumerateValueKey</a> (IN HANDLE HiveHandle, IN HANDLE CellHandle, IN ULONG <a class="el" href="../../d7/d0/cmdat2_8c.html#a27">Index</a>, IN KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, IN PVOID KeyValueInformation, IN ULONG Length, IN PULONG ResultLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a6">EhEnumerateKey</a> (IN HANDLE HiveHandle, IN HANDLE CellHandle, IN ULONG <a class="el" href="../../d7/d0/cmdat2_8c.html#a27">Index</a>, IN KEY_INFORMATION_CLASS KeyInformationClass, IN PVOID KeyInformation, IN ULONG Length, IN PULONG ResultLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a7">EhOpenChildByName</a> (HANDLE HiveHandle, HANDLE KeyHandle, PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, PHANDLE ChildCell)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a8">EhCreateChild</a> (IN HANDLE HiveHandle, IN HANDLE CellHandle, IN PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, OUT PHANDLE ChildCell, OUT PULONG Disposition OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a9">EhQueryKey</a> (IN HANDLE HiveHandle, IN HANDLE KeyHandle, IN KEY_INFORMATION_CLASS KeyInformationClass, IN PVOID KeyInformation, IN ULONG Length, IN PULONG ResultLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a10">EhQueryValueKey</a> (IN HANDLE HiveHandle, IN HANDLE KeyHandle, IN PUNICODE_STRING <a class="el" href="../../d8/d2/rtrenval_8c.html#a3">ValueName</a>, IN KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, IN PVOID KeyValueInformation, IN ULONG Length, IN PULONG ResultLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a11">EhSetValueKey</a> (IN HANDLE HiveHandle, IN HANDLE CellHandle, IN PUNICODE_STRING <a class="el" href="../../d8/d2/rtrenval_8c.html#a3">ValueName</a>, IN ULONG TitleIndex OPTIONAL, IN ULONG Type, IN PVOID Data, IN ULONG DataSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a12">EhDeleteValueKey</a> (IN HANDLE <a class="el" href="../../d7/d1/hivemap_8c.html#a0">Hive</a>, IN HANDLE <a class="el" href="../../d7/d0/cmdat2_8c.html#a24">Cell</a>, IN PUNICODE_STRING <a class="el" href="../../d8/d2/rtrenval_8c.html#a3">ValueName</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSECURITY_DESCRIPTOR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d5/edithive_8h.html#a13">EhGetKeySecurity</a> (IN HANDLE HiveHandle, IN HANDLE KeyHandle)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="edithive.h::TYPE_ALT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TYPE_ALT&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d4/edithive_8h-source.html#l00028">28</a> of file <a class="el" href="../../d1/d4/edithive_8h-source.html">edithive.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/edithive_8c-source.html#l00156">EhOpenHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="edithive.h::TYPE_LOG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TYPE_LOG&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d4/edithive_8h-source.html#l00027">27</a> of file <a class="el" href="../../d1/d4/edithive_8h-source.html">edithive.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/edithive_8c-source.html#l00156">EhOpenHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="edithive.h::TYPE_SIMPLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TYPE_SIMPLE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d4/edithive_8h-source.html#l00026">26</a> of file <a class="el" href="../../d1/d4/edithive_8h-source.html">edithive.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/edithive_8c-source.html#l00156">EhOpenHive()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>, and <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="edithive.h::EhCloseHive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID EhCloseHive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Hive</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00124">124</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00186">CmpFree()</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00569">HFILE_TYPE_ALTERNATE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00570">HFILE_TYPE_LOG</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00568">HFILE_TYPE_PRIMARY</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l00647">HvSyncHive()</a>, and <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00130                    :
00131 
00132     Closes a hive, including writing all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> to disk and freeing
00133     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> relevant structures.
00134 
00135 Arguments:
00136 
00137     HiveHandle - Supplies a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure
00138 
00139 Return Value:
00140 
00141     None.
00142 
00143 --*/
00144 
00145 {
00146     <a class="code" href="../../d0/d2/hivesync_8c.html#a13">HvSyncHive</a>((<a class="code" href="../../d7/d7/struct__HHIVE.html">PHHIVE</a>)HiveHandle);
00147     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;FileHandles[HFILE_TYPE_PRIMARY]);
00148     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;FileHandles[HFILE_TYPE_ALTERNATE]);
00149     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;FileHandles[HFILE_TYPE_LOG]);
00150     <a class="code" href="../../d7/d3/cmwrapr_8c.html#a12">CmpFree</a>((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d6/struct__CMHIVE.html">CMHIVE</a>));
00151 
00152 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="edithive.h::EhCreateChild" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhCreateChild           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>CellHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PHANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>ChildCell</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG Disposition&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00625">625</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00605">_HHIVE::BaseBlock</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00464">_CM_KEY_NODE::Class</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00476">_CM_KEY_NODE::ClassLength</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00422">CM_KEY_NODE_SIGNATURE</a>, <a class="el" href="../../d8/d0/cmindex_8c-source.html#l00895">CmpAddSubKey()</a>, <a class="el" href="../../d4/d2/cmtredel_8c-source.html#l00140">CmpFreeKeyByCell()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00683">CmpHKeyNodeSize</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00332">_CHILD_LIST::Count</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00988">EhpAttachSecurity()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00450">_CM_KEY_NODE::Flags</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00109">HCELL_NIL</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00092">Hive</a>, <a class="el" href="../../d9/d9/hivecell_8c-source.html#l00386">HvAllocateCell()</a>, <a class="el" href="../../d7/d9/hive_8h-source.html#l00290">HvGetCell</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00153">KeQuerySystemTime()</a>, <a class="el" href="../../d9/d0/cmdata_8h.html#a103a95">KeyBodyNode</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00451">_CM_KEY_NODE::LastWriteTime</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00333">_CHILD_LIST::List</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00466">_CM_KEY_NODE::MaxClassLen</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00465">_CM_KEY_NODE::MaxNameLen</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00468">_CM_KEY_NODE::MaxValueDataLen</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00467">_CM_KEY_NODE::MaxValueNameLen</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00477">_CM_KEY_NODE::Name</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00475">_CM_KEY_NODE::NameLength</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00453">_CM_KEY_NODE::Parent</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00107">PHCELL_INDEX</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00524">_CM_KEY_SECURITY::ReferenceCount</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00343">_HBASE_BLOCK::RootCell</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00463">_CM_KEY_NODE::Security</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00449">_CM_KEY_NODE::Signature</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00452">_CM_KEY_NODE::Spare</a>, <a class="el" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00454">_CM_KEY_NODE::SubKeyCounts</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00457">_CM_KEY_NODE::SubKeyLists</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00458">_CM_KEY_NODE::ValueList</a>, and <a class="el" href="../../d0/d1/hivedata_8h.html#a77a76">Volatile</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00634                    :
00635 
00636     Attempts to open <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given child subkey specified by name.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00637     child does not exist, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> created.
00638 
00639 Arguments:
00640 
00641     HiveHandle - handle of hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure <span class="keywordflow">for</span> hive of interest
00642 
00643     CellHandle - handle <span class="keywordflow">for</span> parent cell
00644 
00645 
00646     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - name of child object to create
00647 
00648     ChildCell - pointer to variable to receive cell index of child
00649 
00650     Disposition - This optional parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer to a variable
00651         that will receive a value indicating whether a <span class="keyword">new</span> Registry
00652         key was created or an existing one opened:
00653 
00654         REG_CREATED_NEW_KEY - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keyword">new</span> Registry <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a> was created
00655         REG_OPENED_EXISTING_KEY - An existing Registry <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a> was opened
00656 
00657 Return Value:
00658 
00659     status
00660 
00661 --*/
00662 {
00663     <a class="code" href="../../d0/d1/hivedata_8h.html#a50">PHCELL_INDEX</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00664     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00665     <a class="code" href="../../d7/d7/struct__HHIVE.html">PHHIVE</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a>;
00666     <a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a> NewCell;
00667     <a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a> NewListCell;
00668     <a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a> OldListCell;
00669     <a class="code" href="../../d0/d1/hivedata_8h.html#a50">PHCELL_INDEX</a> NewList;
00670     <a class="code" href="../../d0/d1/hivedata_8h.html#a50">PHCELL_INDEX</a> OldList;
00671     <a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a> Child;
00672     <a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a> Parent;
00673     <a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html">PCM_KEY_SECURITY</a> Security;
00674     HANDLE <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00675     ULONG oldcount;
00676 
00677     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> = &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive;
00678 
00679     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle == <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>) {
00680         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a>-&gt;<a class="code" href="../../d7/d7/struct__HHIVE.html#o8">BaseBlock</a>-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o8">RootCell</a> != <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>) {
00681             *ChildCell = (HANDLE)(<a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a>-&gt;<a class="code" href="../../d7/d7/struct__HHIVE.html#o8">BaseBlock</a>-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o8">RootCell</a>);
00682             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Disposition)) {
00683                 *Disposition = REG_OPENED_EXISTING_KEY;
00684             }
00685             <span class="keywordflow">return</span>(STATUS_SUCCESS);
00686         } <span class="keywordflow">else</span> {
00687             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_OBJECT_NAME_NOT_FOUND;
00688         }
00689     } <span class="keywordflow">else</span> {
00690         Parent = (<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a>)<a class="code" href="../../d6/d0/hive_8h.html#a12">HvGetCell</a>(Hive, (HCELL_INDEX)CellHandle);
00691         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = CmpFindChildByName(Hive,
00692                                     (HCELL_INDEX)CellHandle,
00693                                     *Name,
00694                                     KeyBodyNode,
00695                                     (PHCELL_INDEX)ChildCell,
00696                                     &amp;Index);
00697     }
00698     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_OBJECT_NAME_NOT_FOUND) {
00699 
00700         NewCell = <a class="code" href="../../d8/d0/hivecell_8c.html#a16">HvAllocateCell</a>(Hive,
00701                                  <a class="code" href="../../d1/d2/cmp_8h.html#a98">CmpHKeyNodeSize</a>(Hive,<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length),
00702                                  Stable);
00703         <span class="keywordflow">if</span> (NewCell != <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>) {
00704 
00705             *ChildCell = (HANDLE)NewCell;
00706             Child = (<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a>)<a class="code" href="../../d6/d0/hive_8h.html#a12">HvGetCell</a>(Hive, NewCell);
00707 
00708             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o0">Signature</a> = <a class="code" href="../../d9/d0/cmdata_8h.html#a25">CM_KEY_NODE_SIGNATURE</a>;
00709             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o1">Flags</a> = 0;
00710 
00711             <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a3">KeQuerySystemTime</a>(&amp;(Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o2">LastWriteTime</a>));
00712 
00713             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o3">Spare</a> = 0;
00714             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o4">Parent</a> = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle;
00715 
00716             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o7">ValueList</a>.<a class="code" href="../../d7/d9/struct__CHILD__LIST.html#o0">Count</a> = 0;
00717             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o7">ValueList</a>.<a class="code" href="../../d7/d9/struct__CHILD__LIST.html#o1">List</a> = <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>;
00718             Child-&gt;u1.s1.<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o9">Security</a> = <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>;
00719             Child-&gt;u1.s1.<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o10">Class</a> = <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>;
00720             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o16">NameLength</a> = <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length;
00721             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o17">ClassLength</a> = 0;
00722 
00723             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o5">SubKeyCounts</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>] = 0;
00724             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o5">SubKeyCounts</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a76">Volatile</a>] = 0;
00725             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o6">SubKeyLists</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>] = <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>;
00726             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o6">SubKeyLists</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a76">Volatile</a>] = <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>;
00727 
00728             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o14">MaxValueDataLen</a> = 0;
00729             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o11">MaxNameLen</a> = 0;
00730             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o13">MaxValueNameLen</a> = 0;
00731             Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o12">MaxClassLen</a> = 0;
00732 
00733             <span class="keywordflow">if</span>((<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle == <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>) {
00734                 <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a>-&gt;<a class="code" href="../../d7/d7/struct__HHIVE.html#o8">BaseBlock</a>-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o8">RootCell</a> = NewCell;
00735                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d4/edithive_8c.html#a3">EhpAttachSecurity</a>(Hive, NewCell);
00736             } <span class="keywordflow">else</span> {
00737                 Child-&gt;u1.s1.<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o9">Security</a> = Parent-&gt;u1.s1.<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o9">Security</a>;
00738                 Security = (<a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html">PCM_KEY_SECURITY</a>)<a class="code" href="../../d6/d0/hive_8h.html#a12">HvGetCell</a>(Hive, Child-&gt;u1.s1.<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o9">Security</a>);
00739                 ++Security-&gt;<a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html#o4">ReferenceCount</a>;
00740             }
00741 
00742             RtlMoveMemory(
00743                 &amp;(Child-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o18">Name</a>[0]),
00744                 <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer,
00745                 <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length
00746                 );
00747 
00748             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00749         } <span class="keywordflow">else</span> {
00750             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_INSUFFICIENT_RESOURCES;
00751             <span class="keywordflow">return</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00752         }
00753         <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Disposition)) {
00754             *Disposition = REG_CREATED_NEW_KEY;
00755         }
00756 
00757         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle != <a class="code" href="../../d0/d1/hivedata_8h.html#a6">HCELL_NIL</a>) {
00758 
00759             <span class="comment">//</span>
00760             <span class="comment">// put newly created child into parent's sub key list</span>
00761             <span class="comment">//</span>
00762             <span class="keywordflow">if</span> (! <a class="code" href="../../d1/d2/cmp_8h.html#a305">CmpAddSubKey</a>(Hive, (HCELL_INDEX)CellHandle, NewCell)) {
00763                 <a class="code" href="../../d3/d3/cmtredel_8c.html#a1">CmpFreeKeyByCell</a>(Hive, NewCell, FALSE);
00764                 <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;
00765             }
00766 
00767             Parent = (<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a>)<a class="code" href="../../d6/d0/hive_8h.html#a12">HvGetCell</a>(Hive, (HCELL_INDEX)CellHandle);
00768 
00769             <span class="keywordflow">if</span> (Parent-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o11">MaxNameLen</a> &lt; <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length) {
00770                 Parent-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o11">MaxNameLen</a> = <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length;
00771             }
00772             Parent-&gt;<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html#o12">MaxClassLen</a> = 0;
00773         }
00774     } <span class="keywordflow">else</span> {
00775         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00776         <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Disposition)) {
00777             *Disposition = REG_OPENED_EXISTING_KEY;
00778         }
00779     }
00780     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00781 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="edithive.h::EhDeleteValueKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhDeleteValueKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Hive</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Cell</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>ValueName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00943">943</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00092">CmDeleteValueKey()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00950                    :
00951 
00952     One of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value entries of a registry key may be removed with <span class="keyword">this</span> call.
00953 
00954     The value entry with <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a7">matching</a> <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> key.
00955     If no such entry exists, an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00956 
00957 Arguments:
00958 
00959     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> - Supplies a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure
00960 
00961     <a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a> - Supplies a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry key to be operated on
00962 
00963     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a> - The name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value to be deleted.  <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a legal name.
00964 
00965 Return Value:
00966 
00967     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> - Result code from call, among <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following:
00968 
00969         &lt;TBS&gt;
00970 
00971 --*/
00972 {
00973     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00974 
00975     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00976     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00977     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyHive = &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive;
00978     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle;
00979     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length = 0;
00980     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.MaximumLength = 0;
00981     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00982 
00983     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a225">CmDeleteValueKey</a>(&amp;kcb, *ValueName));
00984 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="edithive.h::EhEnumerateKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhEnumerateKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>CellHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Index</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KEY_INFORMATION_CLASS&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyInformationClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00320">320</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00285">CmEnumerateKey()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>.
<p>
<pre class="fragment"><div>00331                    :
00332 
00333     Enumerate sub keys, <span class="keywordflow">return</span> data on <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>'th entry.
00334 
00335     <a class="code" href="../../d8/d9/cmapi_8c.html#a12">CmEnumerateKey</a> returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>'th sub key of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> open
00336     key specified.  The value STATUS_NO_MORE_ENTRIES will be
00337     returned <span class="keywordflow">if</span> value of <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> larger than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of sub keys.
00338 
00339     Note that <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> simply a way to select among child keys.  Two calls
00340     to <a class="code" href="../../d8/d9/cmapi_8c.html#a12">CmEnumerateKey</a> with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> are NOT guaranteed to <span class="keywordflow">return</span>
00341     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same results.
00342 
00343     If KeyInformation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not <span class="keywordtype">long</span> enough to hold all requested data,
00344     STATUS_BUFFER_OVERFLOW will be returned, and ResultLength will be
00345     set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes actually required.
00346 
00347 Arguments:
00348 
00349     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> - supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive
00350 
00351     <a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a> - supplies index of node to whose sub keys are to be found
00352 
00353     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> (0-based) number of the sub key to be returned.
00354 
00355     KeyInformationClass - Specifies the type of information returned in
00356         Buffer.  One of the following types:
00357 
00358         KeyBasicInformation - return last write time, title index, and name.
00359             (see KEY_BASIC_INFORMATION structure)
00360 
00361         KeyNodeInformation - return last write time, title index, name, class.
00362             (see KEY_NODE_INFORMATION structure)
00363 
00364     KeyInformation -Supplies pointer to buffer to receive the data.
00365 
00366     Length - Length of KeyInformation in bytes.
00367 
00368     ResultLength - Number of bytes actually written into KeyInformation.
00369 
00370 Return Value:
00371 
00372     NTSTATUS - Result code from call, among the following:
00373 
00374         &lt;TBS&gt;
00375 
00376 --*/
00377 {
00378     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a>    <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00379 
00380     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00381     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00382     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyHive = &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive;
00383     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle;
00384     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.RefCount = 1;
00385 
00386     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a226">CmEnumerateKey</a>(&amp;kcb,
00387                           Index,
00388                           KeyInformationClass,
00389                           KeyInformation,
00390                           Length,
00391                           ResultLength));
00392 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="edithive.h::EhEnumerateValueKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhEnumerateValueKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>CellHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Index</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KEY_VALUE_INFORMATION_CLASS&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyValueInformationClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyValueInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00396">396</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00416">CmEnumerateValueKey()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>.
<p>
<pre class="fragment"><div>00407                    :
00408 
00409     The value entries of an open key may be enumerated.
00410 
00411     <a class="code" href="../../d8/d9/cmapi_8c.html#a13">CmEnumerateValueKey</a> returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>'th value
00412     entry of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> open key specified by KeyHandle.  The value
00413     STATUS_NO_MORE_ENTRIES will be returned <span class="keywordflow">if</span> value of <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00414     larger than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of sub keys.
00415 
00416     Note that <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> simply a way to select among value
00417     entries.  Two calls to <a class="code" href="../../d7/d7/ntapi_8c.html#a18">NtEnumerateValueKey</a> with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>
00418     are NOT guaranteed to <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same results.
00419 
00420     If KeyValueInformation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not <span class="keywordtype">long</span> enough to hold all requested data,
00421     STATUS_BUFFER_OVERFLOW will be returned, and ResultLength will be
00422     set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes actually required.
00423 
00424 Arguments:
00425 
00426     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> - supplies a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive
00427 
00428     <a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a> - supplies handle to node whose sub keys are to be found
00429 
00430     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> (0-based) number of the sub key to be returned.
00431 
00432     KeyValueInformationClass - Specifies the type of information returned
00433     in Buffer. One of the following types:
00434 
00435         KeyValueBasicInformation - return time of last write,
00436             title index, and name.  (See KEY_VALUE_BASIC_INFORMATION)
00437 
00438         KeyValueFullInformation - return time of last write,
00439             title index, name, class.  (See KEY_VALUE_FULL_INFORMATION)
00440 
00441     KeyValueInformation -Supplies pointer to buffer to receive the data.
00442 
00443     Length - Length of KeyValueInformation in bytes.
00444 
00445     ResultLength - Number of bytes actually written into KeyValueInformation.
00446 
00447 Return Value:
00448 
00449     NTSTATUS - Result code from call, among the following:
00450 
00451         &lt;TBS&gt;
00452 
00453 --*/
00454 {
00455     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a>    <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00456 
00457     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00458     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00459     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyHive = (<a class="code" href="../../d7/d7/struct__HHIVE.html">PHHIVE</a>)&amp;(((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive);
00460     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle;
00461     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.RefCount = 1;
00462 
00463     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a227">CmEnumerateValueKey</a>(&amp;kcb,
00464                                Index,
00465                                KeyValueInformationClass,
00466                                KeyValueInformation,
00467                                Length,
00468                                ResultLength));
00469 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="edithive.h::EhGetKeySecurity" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSECURITY_DESCRIPTOR EhGetKeySecurity           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00854">854</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d0/d4/edithive_8c-source.html#l00070">CmpGetObjectSecurity()</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00526">_CM_KEY_SECURITY::Descriptor</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00092">Hive</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00858 {
00859     <a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html">PCM_KEY_SECURITY</a> Security;
00860 
00861     <a class="code" href="../../d9/d4/edithive_8c.html#a9">CmpGetObjectSecurity</a>((HCELL_INDEX)KeyHandle,
00862                          &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive,
00863                          &amp;Security,
00864                          NULL);
00865 
00866     <span class="keywordflow">return</span>(&amp;Security-&gt;<a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html#o6">Descriptor</a>);
00867 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="edithive.h::EhOpenChildByName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhOpenChildByName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PHANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>ChildCell</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00585">585</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00092">Hive</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d9/d0/cmdata_8h.html#a103a95">KeyBodyNode</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, and <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00107">PHCELL_INDEX</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>.
<p>
<pre class="fragment"><div>00593                    :
00594 
00595     Find <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> child subkey cell specified by <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>.
00596 
00597 Arguments:
00598 
00599     HiveHandle - handle of hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure <span class="keywordflow">for</span> hive of interest
00600 
00601     CellHandle - handle <span class="keywordflow">for</span> parent cell
00602 
00603     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - name of child object to find
00604 
00605     ChildCell - pointer to variable to receive cell index of child
00606 
00607 Return Value:
00608 
00609     status
00610 
00611 --*/
00612 {
00613     <a class="code" href="../../d0/d1/hivedata_8h.html#a50">PHCELL_INDEX</a>    <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00614 
00615     <span class="keywordflow">return</span>(CmpFindChildByName(&amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive,
00616                               (HCELL_INDEX)CellHandle,
00617                               *Name,
00618                               KeyBodyNode,
00619                               (PHCELL_INDEX)ChildCell,
00620                               &amp;Index));
00621 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="edithive.h::EhOpenHive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE EhOpenHive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>FileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PHANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>RootCell</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>RootName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>, and <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="edithive.h::EhQueryKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhQueryKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KEY_INFORMATION_CLASS&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyInformationClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00785">785</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00647">CmQueryKey()</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00272">_CM_KEY_CONTROL_BLOCK::Delete</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00280">_CM_KEY_CONTROL_BLOCK::KeyCell</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00279">_CM_KEY_CONTROL_BLOCK::KeyHive</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00795                    :
00796 
00797     Data about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">class </span>of a key, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> numbers and sizes of its
00798     children and value entries may be queried with <a class="code" href="../../d8/d9/cmapi_8c.html#a15">CmQueryKey</a>.
00799 
00800     NOTE: The returned lengths are guaranteed to be at least as
00801           long as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> described values, but may be longer in
00802           some circumstances.
00803 
00804 Arguments:
00805 
00806     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> - supplies a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure for <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive
00807 
00808     <a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a> - supplies handle of node to whose sub keys are to be found
00809 
00810     KeyInformationClass - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of information
00811         returned in <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>.  One of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following types:
00812 
00813         KeyBasicInformation - return last write time, title index, and name.
00814             (See KEY_BASIC_INFORMATION)
00815 
00816         KeyNodeInformation - return last write time, title index, name, class.
00817             (See KEY_NODE_INFORMATION)
00818 
00819         KeyFullInformation - return all data except for name and security.
00820             (See KEY_FULL_INFORMATION)
00821 
00822     KeyInformation -Supplies pointer to buffer to receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data.
00823 
00824     Length - Length of KeyInformation in bytes.
00825 
00826     ResultLength - Number of bytes actually written into KeyInformation.
00827 
00828 Return Value:
00829 
00830     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> - Result code from call, among <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following:
00831 
00832         &lt;TBS&gt;
00833 
00834 --*/
00835 {
00836     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a> Kcb;
00837 
00838     Kcb.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00839     Kcb.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00840     Kcb.KeyHive = &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive;
00841     Kcb.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)KeyHandle;
00842     Kcb.FullName.Length = 0;
00843     Kcb.FullName.MaximumLength = 0;
00844     Kcb.FullName.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00845 
00846     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a229">CmQueryKey</a>(&amp;Kcb,
00847                       KeyInformationClass,
00848                       KeyInformation,
00849                       Length,
00850                       ResultLength));
00851 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="edithive.h::EhQueryValueKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhQueryValueKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>ValueName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KEY_VALUE_INFORMATION_CLASS&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyValueInformationClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyValueInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00871">871</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00804">CmQueryValueKey()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00882                    :
00883 
00884     The <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>, TitleIndex, Type, and Data <span class="keywordflow">for</span> any one of a key's
00885     value entries may be queried with <a class="code" href="../../d8/d9/cmapi_8c.html#a16">CmQueryValueKey</a>.
00886 
00887     If KeyValueInformation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not <span class="keywordtype">long</span> enough to hold all requested data,
00888     STATUS_BUFFER_OVERFLOW will be returned, and ResultLength will be
00889     set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes actually required.
00890 
00891 Arguments:
00892 
00893     <a class="code" href="../../d1/d0/cmchek_8c.html#a3">Hive</a> - supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> structure <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive
00894 
00895     <a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a> - supplies index of node to whose sub keys are to be found
00896 
00897     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>  - The name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value entry to <span class="keywordflow">return</span> data <span class="keywordflow">for</span>.
00898 
00899     KeyValueInformationClass - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of information
00900         returned in KeyValueInformation.  One of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following types:
00901 
00902         KeyValueBasicInformation - <span class="keywordflow">return</span> time of last write, title
00903             index, and name.  (See KEY_VALUE_BASIC_INFORMATION)
00904 
00905         KeyValueFullInformation - <span class="keywordflow">return</span> time of last write, title
00906             index, name, <span class="keyword">class</span>.  (See KEY_VALUE_FULL_INFORMATION)
00907 
00908     KeyValueInformation -Supplies pointer to buffer to receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data.
00909 
00910     Length - Length of KeyValueInformation in bytes.
00911 
00912     ResultLength - Number of bytes actually written into KeyValueInformation.
00913 
00914 Return Value:
00915 
00916     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> - Result code from call, among <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following:
00917 
00918         &lt;TBS&gt;
00919 
00920 --*/
00921 {
00922     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00923 
00924     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00925     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00926     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyHive = &amp;((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive;
00927     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)KeyHandle;
00928     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length = 0;
00929     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.MaximumLength = 0;
00930     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00931 
00932     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a230">CmQueryValueKey</a>(&amp;kcb,
00933                            *ValueName,
00934                            KeyValueInformationClass,
00935                            KeyValueInformation,
00936                            Length,
00937                            ResultLength));
00938 
00939 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="edithive.h::EhSetValueKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS EhSetValueKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>CellHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>ValueName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG TitleIndex&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DataSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/edithive_8c-source.html#l00515">515</a> of file <a class="el" href="../../d0/d4/edithive_8c-source.html">edithive.c</a>.
<p>
References <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01087">CmSetValueKey()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00106">HCELL_INDEX</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.
<p>
<pre class="fragment"><div>00526                    :
00527 
00528     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value entry may be created or replaced with <a class="code" href="../../d9/d4/edithive_8c.html#a15">EhSetValueKey</a>.
00529 
00530     If a value entry with a Value <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> (i.e. name) matching the
00531     one specified by ValueName exists, it is deleted and replaced
00532     with the one specified.  If no such value entry exists, a new
00533     one is created.  NULL is a legal Value ID.  While Value IDs must
00534     be unique within any given key, the same Value ID may appear
00535     in many different keys.
00536 
00537 Arguments:
00538 
00539     HiveHandle - handle of hive control structure for hive of interest
00540 
00541     CellHandle - handle for parent cell
00542 
00543     ValueName - The unique (relative to the containing key) name
00544         of the value entry.  May be NULL.
00545 
00546     TitleIndex - Supplies the title index for ValueName.  The title
00547         index specifies the index of the localized alias for the ValueName.
00548 
00549     Type - The integer type number of the value entry.
00550 
00551     Data - Pointer to buffer with actual data for the value entry.
00552 
00553     DataSize - Size of Data buffer.
00554 
00555 
00556 Return Value:
00557 
00558     NTSTATUS - Result code from call, among the following:
00559 
00560         &lt;TBS&gt;
00561 
00562 --*/
00563 {
00564     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00565 
00566     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Delete = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00567     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Signature = CM_KEY_CONTROL_BLOCK_SIGNATURE;
00568     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyHive = (<a class="code" href="../../d7/d7/struct__HHIVE.html">PHHIVE</a>)&amp;(((<a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>)HiveHandle)-&gt;Hive);
00569     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.KeyCell = (<a class="code" href="../../d0/d1/hivedata_8h.html#a49">HCELL_INDEX</a>)CellHandle;
00570     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length = 0;
00571     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.MaximumLength = 0;
00572     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00573 
00574     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d2/cmp_8h.html#a237">CmSetValueKey</a>(&amp;kcb,
00575                          *ValueName,
00576                          TitleIndex,
00577                          Type,
00578                          Data,
00579                          DataSize));
00580 
00581 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:32 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
