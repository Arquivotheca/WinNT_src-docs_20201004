<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: trtl.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>trtl.c</h1><a href="../../d9/d5/trtl_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    trtl.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Test program for the NT OS Runtime Library (RTL)</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Steve Wood (stevewo) 31-Mar-1989</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#include &lt;os2.h&gt;</span>
00022 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00023 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d5/process_8h.html">process.h</a>&gt;</span>
00024 <span class="preprocessor">#include "nt.h"</span>
00025 <span class="preprocessor">#include "ntrtl.h"</span>
00026 
<a name="l00027"></a><a class="code" href="../../d9/d5/trtl_8c.html#a0">00027</a> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d5/trtl_8c.html#a0">TestMemoryStrings</a>[] = {
00028     <span class="stringliteral">""</span>,
00029     <span class="stringliteral">"1"</span>,
00030     <span class="stringliteral">"12"</span>,
00031     <span class="stringliteral">"123"</span>,
00032     <span class="stringliteral">"1234"</span>,
00033     <span class="stringliteral">"12345"</span>,
00034     <span class="stringliteral">"123456"</span>,
00035     <span class="stringliteral">"1234567"</span>,
00036     <span class="stringliteral">"12345678"</span>,
00037     <span class="stringliteral">"123456789"</span>,
00038     <span class="stringliteral">"123456789A"</span>,
00039     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00040 };
00041 
00042 
00043 BOOLEAN
<a name="l00044"></a><a class="code" href="../../d9/d5/trtl_8c.html#a1">00044</a> <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>(
00045     IN PSTRING String1,
00046     IN PSTRING String2,
00047     IN BOOLEAN CaseInSensitive,
00048     IN LONG ExpectedResult
00049     )
00050 {
00051     LONG Result = <a class="code" href="../../d2/d7/string_8c.html#a10">RtlCompareString</a>( <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, CaseInSensitive );
00052 
00053     <span class="keywordflow">if</span> (Result &lt; 0) {
00054         Result = -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00055         }
00056     <span class="keywordflow">else</span> {
00057         <span class="keywordflow">if</span> (Result &gt; 0) {
00058             Result = 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00059             }
00060         }
00061 
00062     <span class="keywordflow">if</span> (Result != ExpectedResult) {
00063         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"RtlCompareString( \"%.*s\", \"%.*s\", %d ) == %ld (%ld)\n"</span>,
00064                 <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Length, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Buffer,
00065                 <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Length, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Buffer,
00066                 CaseInSensitive,
00067                 Result, ExpectedResult
00068                 );
00069         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
00070         }
00071     <span class="keywordflow">else</span> {
00072         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00073         }
00074 }
00075 
00076 BOOLEAN
<a name="l00077"></a><a class="code" href="../../d9/d5/trtl_8c.html#a2">00077</a> <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>(
00078     IN PSTRING String1,
00079     IN PSTRING String2,
00080     IN BOOLEAN CaseInSensitive,
00081     IN BOOLEAN ExpectedResult
00082     )
00083 {
00084     BOOLEAN Result = <a class="code" href="../../d2/d7/string_8c.html#a11">RtlEqualString</a>( <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, CaseInSensitive );
00085 
00086     <span class="keywordflow">if</span> (Result != ExpectedResult) {
00087         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"RtlEqualString( \"%.*s\", \"%.*s\", %d ) == %d (%d)\n"</span>,
00088                 <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Length, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Buffer,
00089                 <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Length, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Buffer,
00090                 CaseInSensitive,
00091                 Result, ExpectedResult );
00092         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
00093         }
00094     <span class="keywordflow">else</span> {
00095         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00096         }
00097 }
00098 
00099 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00100"></a><a class="code" href="../../d9/d5/trtl_8c.html#a3">00100</a> <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>(
00101     IN PCH StringTitle,
00102     IN PSTRING String
00103     )
00104 {
00105     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"%s: (%d, %d) \"%.*s\"\n"</span>, StringTitle,
00106                                        <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;MaximumLength,
00107                                        <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Length,
00108                                        <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Length,
00109                                        <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Buffer );
00110 }
00111 
00112 
00113 BOOLEAN
<a name="l00114"></a><a class="code" href="../../d9/d5/trtl_8c.html#a4">00114</a> <a class="code" href="../../d9/d5/trtl_8c.html#a4">TestString</a>( <span class="keywordtype">void</span> )
00115 {
00116     BOOLEAN Result;
00117     <span class="keywordtype">char</span> buffer5[ 80 ], buffer6[ 15 ], buffer7[ 3 ];
00118     STRING <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, String3, String4;
00119     STRING String5, String6, String7, String8;
00120                             <span class="comment">//         1         2</span>
00121                             <span class="comment">//12345678901234567890</span>
00122                             <span class="comment">//</span>
00123     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <span class="stringliteral">" One"</span> );
00124     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, <span class="stringliteral">" Two"</span> );
00125     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;String3, <span class="stringliteral">" Three"</span> );
00126     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;String4, <span class="stringliteral">" Four"</span> );
00127     String5.Buffer = buffer5;
00128     String5.MaximumLength = <span class="keyword">sizeof</span>( buffer5 );
00129     String5.Length = 0;
00130     String6.Buffer = buffer6;
00131     String6.MaximumLength = <span class="keyword">sizeof</span>( buffer6 );
00132     String6.Length = 0;
00133     String7.Buffer = buffer7;
00134     String7.MaximumLength = <span class="keyword">sizeof</span>( buffer7 );
00135     String7.Length = 0;
00136     String8.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00137     String8.MaximumLength = 0;
00138     String8.Length = 0;
00139     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>( &amp;String5, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> );
00140     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>( &amp;String6, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> );
00141     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>( &amp;String7, &amp;String3 );
00142     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>( &amp;String8, &amp;String4 );
00143 
00144     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String1"</span>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> );
00145     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String2"</span>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> );
00146     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String3"</span>, &amp;String3 );
00147     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String4"</span>, &amp;String4 );
00148     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String5"</span>, &amp;String5 );
00149     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String6"</span>, &amp;String6 );
00150     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String7"</span>, &amp;String7 );
00151     <a class="code" href="../../d9/d5/trtl_8c.html#a3">DumpString</a>( <span class="stringliteral">"String8"</span>, &amp;String8 );
00152 
00153     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00154     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> );
00155     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00156     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String3, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00157     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String4, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> );
00158     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String5, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> );
00159     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String6, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00160     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String7, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00161     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a1">StringCompare</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String8, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> );
00162 
00163     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 1 );
00164     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00165     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String3, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00166     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String4, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00167     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String5, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 1 );
00168     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String6, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00169     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String7, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00170     Result &amp;= <a class="code" href="../../d9/d5/trtl_8c.html#a2">StringEqual</a>( &amp;<a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, &amp;String8, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0 );
00171 
00172     <span class="keywordflow">return</span>( Result );
00173 }
00174 
00175 
00176 <span class="keywordtype">int</span>
00177 _CDECL
<a name="l00178"></a><a class="code" href="../../d9/d5/trtl_8c.html#a5">00178</a> <a class="code" href="../../d2/d5/editreg_8c.html#a87">main</a>(
00179     <span class="keywordtype">int</span> argc,
00180     <span class="keywordtype">char</span> *argv[]
00181     )
00182 {
00183     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d5/trtl_8c.html#a4">TestString</a>()) {
00184         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"TRTL: TestString failed\n"</span> );
00185         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 1 );
00186         }
00187 
00188     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 0 );
00189     <span class="keywordflow">return</span>( 0 );
00190 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:05 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
