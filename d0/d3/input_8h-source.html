<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: input.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>input.h</h1><a href="../../d9/d3/input_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    input.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the internal structures and definitions used</span>
00012 <span class="comment">    by the input (keyboard and mouse) component of the NT console subsystem.</span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment"></span>
00016 <span class="comment">    Therese Stowell (thereses) 12-Nov-1990</span>
00017 <span class="comment"></span>
00018 <span class="comment">Revision History:</span>
00019 <span class="comment"></span>
00020 <span class="comment">--*/</span>
00021 
<a name="l00022"></a><a class="code" href="../../d9/d3/input_8h.html#a0">00022</a> <span class="preprocessor">#define DEFAULT_NUMBER_OF_EVENTS 50</span>
<a name="l00023"></a><a class="code" href="../../d9/d3/input_8h.html#a1">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define INPUT_BUFFER_SIZE_INCREMENT 10</span>
00024 <span class="preprocessor"></span>
<a name="l00025"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html">00025</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html">_INPUT_INFORMATION</a> {
<a name="l00026"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o0">00026</a>     PINPUT_RECORD <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o0">InputBuffer</a>;
<a name="l00027"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o1">00027</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o1">InputBufferSize</a>;      <span class="comment">// size in events</span>
<a name="l00028"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o2">00028</a>     <a class="code" href="../../d8/d6/struct__CONSOLE__SHARE__ACCESS.html">CONSOLE_SHARE_ACCESS</a> <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o2">ShareAccess</a>;   <span class="comment">// share mode</span>
<a name="l00029"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o3">00029</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o3">AllocatedBufferSize</a>;  <span class="comment">// size in bytes of entire buffer</span>
<a name="l00030"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o4">00030</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o4">InputMode</a>;
<a name="l00031"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o5">00031</a>     ULONG <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o5">RefCount</a>;             <span class="comment">// number of handles to input buffer</span>
<a name="l00032"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o6">00032</a>     ULONG_PTR <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o6">First</a>;             <span class="comment">// ptr to base of circular buffer</span>
<a name="l00033"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o7">00033</a>     ULONG_PTR <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o7">In</a>;                <span class="comment">// ptr to next free event</span>
<a name="l00034"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o8">00034</a>     ULONG_PTR <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o8">Out</a>;               <span class="comment">// ptr to next available event</span>
<a name="l00035"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o9">00035</a>     ULONG_PTR <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o9">Last</a>;              <span class="comment">// ptr to end+1 of buffer</span>
<a name="l00036"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o10">00036</a>     LIST_ENTRY <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o10">ReadWaitQueue</a>;
<a name="l00037"></a><a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o11">00037</a>     HANDLE <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html#o11">InputWaitEvent</a>;
00038 <span class="preprocessor">#if defined(FE_SB)</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#if defined(FE_IME)</span>
00040 <span class="preprocessor"></span>    <span class="keyword">struct </span>{
00041         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Disable     : 1;  <span class="comment">// High   : specifies input code page or enable/disable in NLS state</span>
00042         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Unavailable : 1;  <span class="comment">// Middle : specifies console window doing menu loop or size move</span>
00043         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Open        : 1;  <span class="comment">// Low    : specifies open/close in NLS state or IME hot key</span>
00044 
00045         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ReadyConversion:1;<span class="comment">// if conversion mode is ready by succeed communicate to ConIME.</span>
00046                                 <span class="comment">// then this field is TRUE.</span>
00047         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Conversion;       <span class="comment">// conversion mode of ime (i.e IME_CMODE_xxx).</span>
00048                                 <span class="comment">// this field uses by GetConsoleNlsMode</span>
00049     } ImeMode;
00050     HWND hWndConsoleIME;        <span class="comment">// validate hWnd when open property window by ImmConfigureIME</span>
00051 <span class="preprocessor">#endif // FE_IME</span>
00052 <span class="preprocessor"></span>    <span class="keyword">struct </span><a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">_CONSOLE_INFORMATION</a> *Console;
00053     INPUT_RECORD ReadConInpDbcsLeadByte;
00054     INPUT_RECORD WriteConInpDbcsLeadByte[2];
00055 <span class="preprocessor">#endif</span>
00056 <span class="preprocessor"></span>} <a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html">INPUT_INFORMATION</a>, *<a class="code" href="../../d7/d2/struct__INPUT__INFORMATION.html">PINPUT_INFORMATION</a>;
00057 
<a name="l00058"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html">00058</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html">_INPUT_READ_HANDLE_DATA</a> {
00059 
00060     <span class="comment">//</span>
00061     <span class="comment">// the following seven fields are solely used for input reads.</span>
00062     <span class="comment">//</span>
00063 
<a name="l00064"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o0">00064</a>     CRITICAL_SECTION <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o0">ReadCountLock</a>; <span class="comment">// serializes access to read count</span>
<a name="l00065"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o1">00065</a>     ULONG <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o1">ReadCount</a>;            <span class="comment">// number of reads waiting</span>
<a name="l00066"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o2">00066</a>     ULONG <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o2">InputHandleFlags</a>;
00067 
00068     <span class="comment">//</span>
00069     <span class="comment">// the following four fields are used to remember input data that</span>
00070     <span class="comment">// wasn't returned on a cooked-mode read.  we do our own buffering</span>
00071     <span class="comment">// and don't return data until the user hits enter so that she can</span>
00072     <span class="comment">// edit the input.  as a result, there is often data that doesn't fit</span>
00073     <span class="comment">// into the caller's buffer.  we save it so we can return it on the</span>
00074     <span class="comment">// next cooked-mode read to this handle.</span>
00075     <span class="comment">//</span>
00076 
<a name="l00077"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o3">00077</a>     ULONG <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o3">BytesAvailable</a>;
<a name="l00078"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o4">00078</a>     PWCHAR <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o4">CurrentBufPtr</a>;
<a name="l00079"></a><a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o5">00079</a>     PWCHAR <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o5">BufPtr</a>;
00080 } <a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html">INPUT_READ_HANDLE_DATA</a>, *<a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html">PINPUT_READ_HANDLE_DATA</a>;
00081 
<a name="l00082"></a><a class="code" href="../../d9/d3/input_8h.html#a2">00082</a> <span class="preprocessor">#define UNICODE_BACKSPACE ((WCHAR)0x08)</span>
<a name="l00083"></a><a class="code" href="../../d9/d3/input_8h.html#a3">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_BACKSPACE2 ((WCHAR)0x25d8)</span>
<a name="l00084"></a><a class="code" href="../../d9/d3/input_8h.html#a4">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_CARRIAGERETURN ((WCHAR)0x0d)</span>
<a name="l00085"></a><a class="code" href="../../d9/d3/input_8h.html#a5">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_LINEFEED ((WCHAR)0x0a)</span>
<a name="l00086"></a><a class="code" href="../../d9/d3/input_8h.html#a6">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_BELL ((WCHAR)0x07)</span>
<a name="l00087"></a><a class="code" href="../../d9/d3/input_8h.html#a7">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_TAB ((WCHAR)0x09)</span>
<a name="l00088"></a><a class="code" href="../../d9/d3/input_8h.html#a8">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define UNICODE_SPACE ((WCHAR)0x20)</span>
00089 <span class="preprocessor"></span>
<a name="l00090"></a><a class="code" href="../../d9/d3/input_8h.html#a9">00090</a> <span class="preprocessor">#define TAB_SIZE 8</span>
<a name="l00091"></a><a class="code" href="../../d9/d3/input_8h.html#a10">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define TAB_MASK (TAB_SIZE-1)</span>
<a name="l00092"></a><a class="code" href="../../d9/d3/input_8h.html#a11">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define NUMBER_OF_SPACES_IN_TAB(POSITION) (TAB_SIZE - ((POSITION) &amp; TAB_MASK))</span>
00093 <span class="preprocessor"></span>
<a name="l00094"></a><a class="code" href="../../d9/d3/input_8h.html#a12">00094</a> <span class="preprocessor">#define AT_EOL(COOKEDREADDATA) ((COOKEDREADDATA)-&gt;BytesRead == ((COOKEDREADDATA)-&gt;CurrentPosition*2))</span>
<a name="l00095"></a><a class="code" href="../../d9/d3/input_8h.html#a13">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define INSERT_MODE(COOKEDREADDATA) ((COOKEDREADDATA)-&gt;InsertMode)</span>
00096 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="../../d9/d3/input_8h.html#a14">00097</a> <span class="preprocessor">#define VIRTUAL_KEY_CODE_S 0x53</span>
<a name="l00098"></a><a class="code" href="../../d9/d3/input_8h.html#a15">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define VIRTUAL_KEY_CODE_C 0x43</span>
00099 <span class="preprocessor"></span>
<a name="l00100"></a><a class="code" href="../../d9/d3/input_8h.html#a16">00100</a> <span class="preprocessor">#define VK_OEM_SCROLL    0x91</span>
00101 <span class="preprocessor"></span>
<a name="l00102"></a><a class="code" href="../../d9/d3/input_8h.html#a17">00102</a> <span class="preprocessor">#define KEY_PRESSED 0x8000</span>
<a name="l00103"></a><a class="code" href="../../d9/d3/input_8h.html#a18">00103</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_TOGGLED 0x01</span>
<a name="l00104"></a><a class="code" href="../../d9/d3/input_8h.html#a19">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_ENHANCED 0x01000000</span>
<a name="l00105"></a><a class="code" href="../../d9/d3/input_8h.html#a20">00105</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_UP_TRANSITION 1</span>
<a name="l00106"></a><a class="code" href="../../d9/d3/input_8h.html#a21">00106</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_PREVIOUS_DOWN 0x40000000</span>
<a name="l00107"></a><a class="code" href="../../d9/d3/input_8h.html#a22">00107</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_TRANSITION_UP 0x80000000</span>
00108 <span class="preprocessor"></span>
<a name="l00109"></a><a class="code" href="../../d9/d3/input_8h.html#a23">00109</a> <span class="preprocessor">#define CONSOLE_CTRL_C_SEEN  1</span>
<a name="l00110"></a><a class="code" href="../../d9/d3/input_8h.html#a24">00110</a> <span class="preprocessor"></span><span class="preprocessor">#define CONSOLE_CTRL_BREAK_SEEN 2</span>
00111 <span class="preprocessor"></span>
<a name="l00112"></a><a class="code" href="../../d9/d3/input_8h.html#a25">00112</a> <span class="preprocessor">#define LockReadCount(HANDLEPTR) RtlEnterCriticalSection(&amp;(HANDLEPTR)-&gt;InputReadData-&gt;ReadCountLock)</span>
<a name="l00113"></a><a class="code" href="../../d9/d3/input_8h.html#a26">00113</a> <span class="preprocessor"></span><span class="preprocessor">#define UnlockReadCount(HANDLEPTR) RtlLeaveCriticalSection(&amp;(HANDLEPTR)-&gt;InputReadData-&gt;ReadCountLock)</span>
00114 <span class="preprocessor"></span>
<a name="l00115"></a><a class="code" href="../../d9/d3/input_8h.html#a27">00115</a> <span class="preprocessor">#define LoadKeyEvent(PEVENT,KEYDOWN,CHAR,KEYCODE,SCANCODE,KEYSTATE) { \</span>
00116 <span class="preprocessor">        (PEVENT)-&gt;EventType = KEY_EVENT;                              \</span>
00117 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.bKeyDown = KEYDOWN;                  \</span>
00118 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.wRepeatCount = 1;                    \</span>
00119 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.uChar.UnicodeChar = CHAR;            \</span>
00120 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.wVirtualKeyCode = KEYCODE;           \</span>
00121 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.wVirtualScanCode = SCANCODE;         \</span>
00122 <span class="preprocessor">        (PEVENT)-&gt;Event.KeyEvent.dwControlKeyState = KEYSTATE;        \</span>
00123 <span class="preprocessor">        }</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:24 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
