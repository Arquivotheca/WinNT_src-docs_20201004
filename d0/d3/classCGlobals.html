<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CGlobals class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CGlobals Class Reference</h1><code>#include &lt;<a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>&gt;</code>
<p>
<a href="../../d6/d2/classCGlobals-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e0">Attach</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e1">Detach</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int &amp;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e2">ReferenceCounter</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e3">SetHandle</a> (HMODULE hmNew)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HMODULE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e4">Instance</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e5">CanUnload</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e6">Report</a> (int idError, HWND hwndParent=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e7">ReportEx</a> (int idError, HWND hwndParent, <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bSystemMessage, <a class="el" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwNumMsg,...)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e8">IsInstalled</a> (<a class="el" href="../../d1/d7/classCString.html">CString</a> &amp;csProfile)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e9">InvalidateList</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDC&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e10">GetPrinterHDC</a> (LPCTSTR lpctstrName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#e11">ThisIsAColorPrinter</a> (LPCTSTR lpctstrName)</td></tr>

<tr><td colspan=2><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#v0">m_icDLLReferences</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HMODULE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#v1">m_hmThisDll</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#v2">m_csaProfiles</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d3/classCGlobals.html#v3">m_bIsValid</a> = FALSE</td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e0" doxytag="CGlobals::Attach" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CGlobals::Attach           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00050">50</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00037">m_icDLLReferences</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00214">CIcmUiFactory::CIcmUiFactory()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface::CICMUserInterface()</a>.
<p>
<pre class="fragment"><div>00050 { <a class="code" href="../../d0/d3/classCGlobals.html#v0">m_icDLLReferences</a>++; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e5" doxytag="CGlobals::CanUnload" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CGlobals::CanUnload           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00062">62</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00037">m_icDLLReferences</a>, and <a class="el" href="../../d7/d7/proppage_8cpp-source.html#l00156">CShellExtensionPage::OKToClose()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00166">DllCanUnloadNow()</a>.
<p>
<pre class="fragment"><div>00062                                 { 
00063         <span class="keywordflow">return</span> (!<a class="code" href="../../d0/d3/classCGlobals.html#v0">m_icDLLReferences</a> &amp;&amp; <a class="code" href="../../d9/d6/classCShellExtensionPage.html#e0">CShellExtensionPage::OKToClose</a>()) ?
00064             S_OK : S_FALSE;
00065     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="CGlobals::Detach" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CGlobals::Detach           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00051">51</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00037">m_icDLLReferences</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00076">CIcmUiFactory::~CIcmUiFactory()</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00131">CICMUserInterface::~CICMUserInterface()</a>.
<p>
<pre class="fragment"><div>00051 { <a class="code" href="../../d0/d3/classCGlobals.html#v0">m_icDLLReferences</a>--; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e10" doxytag="CGlobals::GetPrinterHDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDC CGlobals::GetPrinterHDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpctstrName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00097">97</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00097">GetPrinterHDC()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00097">GetPrinterHDC()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00084">ThisIsAColorPrinter()</a>.
<p>
<pre class="fragment"><div>00097                                              {
00098 
00099     HANDLE  hPrinter;   <span class="comment">//  Get a handle on it...</span>
00100     LPTSTR  lpstrMe = const_cast &lt;LPTSTR&gt; (lpstrName);
00101 
00102     <span class="keywordflow">if</span>  (!OpenPrinter(lpstrMe, &amp;hPrinter, NULL)) {
00103         _RPTF2(_CRT_WARN, <span class="stringliteral">"Unable to open printer '%s'- error %d\n"</span>, lpstrName,
00104             GetLastError());
00105         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00106     }
00107 
00108     <span class="comment">//  First, use DocumentProperties to find the correct DEVMODE size- we</span>
00109     <span class="comment">//  must use the DEVMODE to force color on, in case the user's defaults</span>
00110     <span class="comment">//  have turned it off...</span>
00111 
00112     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lcbNeeded = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) DocumentProperties(NULL, hPrinter, lpstrMe, NULL,
00113         NULL, 0);
00114 
00115     <span class="keywordflow">if</span>  (lcbNeeded &lt;= 0) {
00116         _RPTF2(_CRT_WARN,
00117             <span class="stringliteral">"Document Properties (get size) for '%s' returned %d\n"</span>, lpstrName,
00118             lcbNeeded);
00119         ClosePrinter(hPrinter);
00120         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00121     }
00122 
00123     HDC hdcThis = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00124 
00125     <span class="keyword">union </span>{
00126         LPBYTE      lpb;
00127         LPDEVMODE   lpdm;
00128     };
00129 
00130     lpb = <span class="keyword">new</span> <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>[lcbNeeded];
00131 
00132     <span class="keywordflow">if</span>  (lpb) {
00133 
00134         ZeroMemory(lpb,lcbNeeded);
00135         lpdm -&gt; dmSize = lcbNeeded;
00136         lpdm -&gt; dmFields = DM_COLOR;
00137         lpdm -&gt; dmColor = DMCOLOR_COLOR;
00138         <span class="keywordflow">if</span>  (IDOK == DocumentProperties(NULL, hPrinter, lpstrMe, lpdm, lpdm,
00139             DM_IN_BUFFER | DM_OUT_BUFFER)) {
00140 
00141             <span class="comment">//  Turn off ICM, since not nessesary here.</span>
00142             <span class="comment">//</span>
00143             lpdm -&gt; dmICMMethod = DMICMMETHOD_NONE;
00144 
00145             <span class="comment">//  Finally, we can create the DC!</span>
00146             <span class="comment">//  Note: we're not actually creating a DC, just an IC</span>
00147             hdcThis = CreateIC(NULL, lpstrName, NULL, lpdm);
00148         } <span class="keywordflow">else</span> {
00149             _RPTF2(_CRT_WARN,
00150                 <span class="stringliteral">"DocumentProperties (retrieve) on '%s' failed- error %d\n"</span>,
00151                 lpstrName, GetLastError());
00152         }
00153         <span class="keyword">delete</span> lpb;
00154     }
00155     <span class="keywordflow">else</span>
00156         _RPTF2(_CRT_WARN, <span class="stringliteral">"ThisIsAColorPrinter(%s) failed to get %d bytes\n"</span>,
00157             lpstrName, lcbNeeded);
00158 
00159     ClosePrinter(hPrinter);
00160 
00161     <span class="keywordflow">return</span> hdcThis;
00162 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e4" doxytag="CGlobals::Instance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HMODULE CGlobals::Instance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00058">58</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00038">m_hmThisDll</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">CICMUserInterface::InvokeCommand()</a>, and <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>.
<p>
<pre class="fragment"><div>00058                                { 
00059         <span class="keywordflow">return</span> <a class="code" href="../../d0/d3/classCGlobals.html#v1">m_hmThisDll</a>;
00060     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e9" doxytag="CGlobals::InvalidateList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CGlobals::InvalidateList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00077">77</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00040">m_bIsValid</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">CProfile::Install()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">CProfile::Uninstall()</a>.
<p>
<pre class="fragment"><div>00077 { <a class="code" href="../../d0/d3/classCGlobals.html#v3">m_bIsValid</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e8" doxytag="CGlobals::IsInstalled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CGlobals::IsInstalled           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d7/classCString.html">CString</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>csProfile</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00068">68</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00103">CStringArray::Count()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00068">IsInstalled()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00040">m_bIsValid</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00039">m_csaProfiles</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00165">CString::NameOnly()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00068">IsInstalled()</a>.
<p>
<pre class="fragment"><div>00068                                                 {
00069 <span class="comment">//    if  (!m_bIsValid) {</span>
00070         ENUMTYPE    et = {<span class="keyword">sizeof</span> et, ENUM_TYPE_VERSION, 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>};
00071 
00072         <a class="code" href="../../d7/d5/classCProfile.html#e0">CProfile::Enumerate</a>(et, m_csaProfiles);
00073         <a class="code" href="../../d0/d3/classCGlobals.html#v3">m_bIsValid</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00074 <span class="comment">//    }</span>
00075 
00076     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d0/d3/classCGlobals.html#v2">m_csaProfiles</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); u++)
00077         <span class="keywordflow">if</span>  (!lstrcmpi(csProfile.<a class="code" href="../../d1/d7/classCString.html#a14">NameOnly</a>(), <a class="code" href="../../d0/d3/classCGlobals.html#v2">m_csaProfiles</a>[u].NameOnly()))
00078             <span class="keywordflow">break</span>;
00079 
00080     <span class="keywordflow">return</span>  u &lt; <a class="code" href="../../d0/d3/classCGlobals.html#v2">m_csaProfiles</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>();
00081 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e2" doxytag="CGlobals::ReferenceCounter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int&amp; CGlobals::ReferenceCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00052">52</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00037">m_icDLLReferences</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/proppage_8cpp-source.html#l00113">CShellExtensionPage::CShellExtensionPage()</a>.
<p>
<pre class="fragment"><div>00052 { <span class="keywordflow">return</span> <a class="code" href="../../d0/d3/classCGlobals.html#v0">m_icDLLReferences</a>; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e6" doxytag="CGlobals::Report" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CGlobals::Report           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idError</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndParent</em> = <code>NULL</code></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00044">44</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00033">MessageBoxTitle</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00044">Report()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00044">Report()</a>.
<p>
<pre class="fragment"><div>00044                                                        {
00045     <a class="code" href="../../d1/d7/classCString.html">CString</a> csMessage, csTitle;
00046 
00047     csMessage.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(idError);
00048     csTitle.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(MessageBoxTitle);
00049 
00050     MessageBox(m_hwndParent, csMessage, csTitle, MB_OK|MB_ICONEXCLAMATION);
00051 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e7" doxytag="CGlobals::ReportEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int CGlobals::ReportEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idError</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bSystemMessage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwNumMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00053">53</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00214">CString::LoadAndFormat()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00033">MessageBoxTitle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00053">ReportEx()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00053">ReportEx()</a>.
<p>
<pre class="fragment"><div>00054                                                                                 {
00055     <a class="code" href="../../d1/d7/classCString.html">CString</a> csMessage, csTitle;
00056     va_list argList;
00057 
00058     va_start(argList,dwNumMsg);
00059     csMessage.<a class="code" href="../../d1/d7/classCString.html#a18">LoadAndFormat</a>(idError,NULL,bSystemMessage,dwNumMsg,&amp;argList);
00060     csTitle.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(MessageBoxTitle);
00061     va_end(argList);
00062 
00063     <span class="keywordflow">return</span> (MessageBox(m_hwndParent, csMessage, csTitle, uType));
00064 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e3" doxytag="CGlobals::SetHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CGlobals::SetHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HMODULE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hmNew</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/icmui_8h-source.html#l00053">53</a> of file <a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00038">m_hmThisDll</a>, and <a class="el" href="../../d3/d8/icmui_8h-source.html#l00053">SetHandle()</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/icmui_8h-source.html#l00053">SetHandle()</a>.
<p>
<pre class="fragment"><div>00053                                          { 
00054         <span class="keywordflow">if</span>  (!<a class="code" href="../../d0/d3/classCGlobals.html#v1">m_hmThisDll</a>) 
00055             <a class="code" href="../../d0/d3/classCGlobals.html#v1">m_hmThisDll</a> = hmNew; 
00056     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e11" doxytag="CGlobals::ThisIsAColorPrinter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CGlobals::ThisIsAColorPrinter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpctstrName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00084">84</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00097">GetPrinterHDC()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00084">ThisIsAColorPrinter()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00084">ThisIsAColorPrinter()</a>.
<p>
<pre class="fragment"><div>00084                                                     {
00085   HDC hdcThis = <a class="code" href="../../d0/d3/classCGlobals.html#e10">CGlobals::GetPrinterHDC</a>(lpstrName);
00086   <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bReturn = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00087   <span class="keywordflow">if</span>  (hdcThis) {
00088     bReturn =  2 &lt; (<span class="keywordtype">unsigned</span>) GetDeviceCaps(hdcThis, NUMCOLORS);
00089     DeleteDC(hdcThis);
00090   }
00091   <span class="keywordflow">return</span> bReturn;
00092 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="v3" doxytag="CGlobals::m_bIsValid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d0/d3/classCGlobals.html#v3">CGlobals::m_bIsValid</a> = FALSE<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00040">40</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/icmui_8h-source.html#l00077">InvalidateList()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00068">IsInstalled()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v2" doxytag="CGlobals::m_csaProfiles" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> <a class="el" href="../../d0/d3/classCGlobals.html#v2">CGlobals::m_csaProfiles</a><code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00039">39</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00068">IsInstalled()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v1" doxytag="CGlobals::m_hmThisDll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HMODULE <a class="el" href="../../d0/d3/classCGlobals.html#v1">CGlobals::m_hmThisDll</a> = NULL<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00038">38</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/icmui_8h-source.html#l00058">Instance()</a>, and <a class="el" href="../../d3/d8/icmui_8h-source.html#l00053">SetHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v0" doxytag="CGlobals::m_icDLLReferences" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="../../d0/d3/classCGlobals.html#v0">CGlobals::m_icDLLReferences</a> = 0<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00037">37</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/icmui_8h-source.html#l00050">Attach()</a>, <a class="el" href="../../d3/d8/icmui_8h-source.html#l00062">CanUnload()</a>, <a class="el" href="../../d3/d8/icmui_8h-source.html#l00051">Detach()</a>, and <a class="el" href="../../d3/d8/icmui_8h-source.html#l00052">ReferenceCounter()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d3/d8/icmui_8h-source.html">icmui.h</a><li><a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
