<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kdp.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>kdp.h File Reference</h1><code>#include "<a class="el" href="../../d0/d8/ntos_8h-source.html">ntos.h</a>"</code><br>
<code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>
<code>#include "ntdbg.h"</code><br>
<code>#include "string.h"</code><br>
<code>#include "stdlib.h"</code><br>
<code>#include "<a class="el" href="../../d0/d7/4_2ia64_2kdpcpu_8h-source.html">kdpcpu.h</a>"</code><br>

<p>
<a href="../../d1/d6/kdp_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html">DBGKD_INTERNAL_BREAKPOINT</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a0">GLOBAL_BREAKPOINT_LIMIT</a>&nbsp;&nbsp;&nbsp;1610612736L</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a2">KD_BREAKPOINT_NEEDS_WRITE</a>&nbsp;&nbsp;&nbsp;0x00000002</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>&nbsp;&nbsp;&nbsp;0x00000004</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a4">KD_BREAKPOINT_NEEDS_REPLACE</a>&nbsp;&nbsp;&nbsp;0x00000008</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a5">KD_BREAKPOINT_STATE_MASK</a>&nbsp;&nbsp;&nbsp;0x0000000f</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a6">KD_BREAKPOINT_IA64_MASK</a>&nbsp;&nbsp;&nbsp;0x000f0000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a7">KD_BREAKPOINT_IA64_MODE</a>&nbsp;&nbsp;&nbsp;0x00010000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a8">KD_BREAKPOINT_IA64_MOVL</a>&nbsp;&nbsp;&nbsp;0x00020000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a12">MAXIMUM_RETRIES</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a13">DBGKD_MAX_SPECIAL_CALLS</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;4096</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a15">DBGKD_MAX_INTERNAL_BREAKPOINTS</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>(s)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a17">BREAKPOINT_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a18">PBREAKPOINT_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a19">TRACE_DATA_SYM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a20">PTRACE_DATA_SYM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a39">PDBGKD_INTERNAL_BREAKPOINT</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a87">KdpReboot</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a88">KdpPrintString</a> (IN PSTRING Output)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a89">KdpPromptString</a> (IN PSTRING Output, IN OUT PSTRING Input)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a90">KdpAddBreakpoint</a> (IN PVOID Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a91">KdpDeleteBreakpoint</a> (IN ULONG <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a92">KdpDeleteBreakpointRange</a> (IN PVOID Lower, IN PVOID Upper)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a93">KdpMoveMemory</a> (IN PCHAR Destination, IN PCHAR Source, IN ULONG Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a94">KdpQuickMoveMemory</a> (IN PCHAR Destination, IN PCHAR Source, IN ULONG Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a95">KdpReceivePacket</a> (IN ULONG ExpectedPacketType, OUT PSTRING MessageHeader, OUT PSTRING MessageData, OUT PULONG DataLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a96">KdpSetLoadState</a> (IN PDBGKD_WAIT_STATE_CHANGE WaitStateChange, IN PCONTEXT ContextRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a97">KdpSetStateChange</a> (IN PDBGKD_WAIT_STATE_CHANGE WaitStateChange, IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a98">KdpGetStateChange</a> (IN PDBGKD_MANIPULATE_STATE ManipulateState, IN PCONTEXT ContextRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a99">KdpSendPacket</a> (IN ULONG PacketType, IN PSTRING MessageHeader, IN PSTRING MessageData OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a100">KdpStub</a> (IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame, IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> PreviousMode, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a101">KdpTrap</a> (IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame, IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> PreviousMode, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a102">KdpDisplayString</a> (IN PCHAR Output)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a103">KdpWriteComPacket</a> (<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>, <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>, PVOID, PVOID, PVOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a104">KdpReadComPacket</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a105">KdpSwitchProcessor</a> (IN PEXCEPTION_RECORD ExceptionRecord, IN OUT PCONTEXT ContextRecord, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a106">KdpReportExceptionStateChange</a> (IN PEXCEPTION_RECORD ExceptionRecord, IN OUT PCONTEXT ContextRecord, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a107">KdpReportLoadSymbolsStateChange</a> (IN PSTRING PathName, IN <a class="el" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a> SymbolInfo, IN BOOLEAN UnloadSymbols, IN OUT PCONTEXT ContextRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a108">KdpSendWaitContinue</a> (IN ULONG PacketType, IN PSTRING MessageHeader, IN PSTRING MessageData OPTIONAL, IN OUT PCONTEXT ContextRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a109">KdpReadVirtualMemory</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a110">KdpReadVirtualMemory64</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a111">KdpWriteVirtualMemory</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a112">KdpWriteVirtualMemory64</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a113">KdpReadPhysicalMemory</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a114">KdpWritePhysicalMemory</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a115">KdpGetContext</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a116">KdpSetContext</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a117">KdpWriteBreakpoint</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a118">KdpRestoreBreakpoint</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a119">KdpReadControlSpace</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a120">KdpWriteControlSpace</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a121">KdpReadIoSpace</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a122">KdpReadMachineSpecificRegister</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a123">KdpWriteIoSpace</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a124">KdpWriteMachineSpecificRegister</a> (IN PDBGKD_MANIPULATE_STATE m, IN PSTRING AdditionalData, IN PCONTEXT Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a125">KdpSuspendBreakpoint</a> (ULONG <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a126">KdpSuspendAllBreakpoints</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a127">KdpRestoreAllBreakpoints</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a128">KdpTimeSlipDpcRoutine</a> (<a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a129">KdpTimeSlipWork</a> (IN PVOID Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a130">RtlpBreakWithStatusInstruction</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a131">KdpInitCom</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a132">KdpPortLock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a133">KdpPortUnlock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a134">KdpPollBreakInWithPortLock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a135">KdpReceivePacketLeader</a> (IN ULONG PacketType, OUT PULONG PacketLeader)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">BREAKPOINT_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a21">KdpBreakpointTable</a> [BREAKPOINT_TABLE_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a22">KdpControlCPending</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a23">KdpDebuggerLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/ke_8h.html#a64">PKDEBUG_ROUTINE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a24">KiDebugRoutine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/ke_8h.html#a65">PKDEBUG_SWITCH_ROUTINE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a25">KiDebugSwitchRoutine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KDP_BREAKPOINT_TYPE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a26">KdpBreakpointInstruction</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a27">KdpMessageBuffer</a> [KDP_MESSAGE_BUFFER_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a28">KdpPathBuffer</a> [KDP_MESSAGE_BUFFER_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a29">KdpOweBreakpoint</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a30">KdpNextPacketIdToSend</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a31">KdpPacketIdExpected</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a32">KdPerformanceCounterRate</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a33">KdTimerStart</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a34">KdTimerStop</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a35">KdTimerDifference</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a36">BreakpointsSuspended</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a37">KdpNtosImageBase</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a38">KdpDebuggerDataListHead</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html">DBGKD_INTERNAL_BREAKPOINT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a40">KdpInternalBPs</a> [DBGKD_MAX_INTERNAL_BREAKPOINTS]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a41">KdpCurrentSymbolStart</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a42">KdpCurrentSymbolEnd</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a43">KdpNextCallLevelChange</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a44">KdSpecialCalls</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a45">KdNumberOfSpecialCalls</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a46">InitialSP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a47">KdpNumInternalBreakpoints</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a48">InternalBreakpointTimer</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a49">InternalBreakpointCheckDpc</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a50">KdpPortLocked</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a51">KdpTimeEntered</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>DBGKD_TRACE_DATA&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a52">TraceDataBuffer</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a53">TraceDataBufferPosition</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">TRACE_DATA_SYM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a54">TraceDataSyms</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a55">NextTraceDataSym</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a56">NumTraceDataSyms</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a57">IntBPsSkipping</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a58">WatchStepOver</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a59">WSOThread</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a60">WSOEsp</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a61">WatchStepOverHandle</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a62">WatchStepOverBreakAddr</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a63">WatchStepOverSuspended</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a64">InstructionsTraced</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a65">SymbolRecorded</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a66">CallLevelChange</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a67">oldpc</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a68">InstrCountInternal</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a69">KdpControlCPressed</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a70">KdpRetryCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a71">KdpNumberRetries</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a72">KdPrintCircularBuffer</a> [KDPRINTBUFFERSIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PUCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a73">KdPrintWritePointer</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a74">KdPrintRolloverCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a75">KdpPrintSpinLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d2/struct__DEBUG__PARAMETERS.html">DEBUG_PARAMETERS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a76">KdDebugParameters</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a77">KdpDataSpinLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KDDEBUGGER_DATA&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a78">KdDebuggerDataBlock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a79">KdpTimeSlipDpc</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a80">KdpTimeSlipWorkItem</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a81">KdpTimeSlipTimer</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a82">KdpTimeSlipPending</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a83">KdpTimeSlipEventLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a84">KdpTimeSlipEvent</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a85">KdpDebuggerStructuresInitialized</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/kdp_8h.html#a86">KdEnteredDebugger</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a15" doxytag="kdp.h::DBGKD_MAX_INTERNAL_BREAKPOINTS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DBGKD_MAX_INTERNAL_BREAKPOINTS&nbsp;&nbsp;&nbsp;20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00470">470</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="kdp.h::DBGKD_MAX_SPECIAL_CALLS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DBGKD_MAX_SPECIAL_CALLS&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00081">81</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="kdp.h::DPRINT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DPRINT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00573">573</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00303">KdEnterDebugger()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00826">KdpDeleteBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01121">KdpLowRestoreBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00635">KdpLowWriteContent()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="kdp.h::GLOBAL_BREAKPOINT_LIMIT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GLOBAL_BREAKPOINT_LIMIT&nbsp;&nbsp;&nbsp;1610612736L          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00042">42</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="kdp.h::KD_BREAKPOINT_IA64_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_IA64_MASK&nbsp;&nbsp;&nbsp;0x000f0000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00054">54</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="kdp.h::KD_BREAKPOINT_IA64_MODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_IA64_MODE&nbsp;&nbsp;&nbsp;0x00010000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00055">55</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="kdp.h::KD_BREAKPOINT_IA64_MOVL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_IA64_MOVL&nbsp;&nbsp;&nbsp;0x00020000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00056">56</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01121">KdpLowRestoreBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00635">KdpLowWriteContent()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="kdp.h::KD_BREAKPOINT_IN_USE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_IN_USE&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00048">48</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00902">KdpDeleteBreakpointRange()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01309">KdpRestoreAllBreakpoints()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00954">KdpSuspendBreakpoint()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="kdp.h::KD_BREAKPOINT_NEEDS_REPLACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_NEEDS_REPLACE&nbsp;&nbsp;&nbsp;0x00000008          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00051">51</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00826">KdpDeleteBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01121">KdpLowRestoreBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00635">KdpLowWriteContent()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="kdp.h::KD_BREAKPOINT_NEEDS_WRITE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_NEEDS_WRITE&nbsp;&nbsp;&nbsp;0x00000002          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00049">49</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01121">KdpLowRestoreBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00635">KdpLowWriteContent()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="kdp.h::KD_BREAKPOINT_STATE_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_STATE_MASK&nbsp;&nbsp;&nbsp;0x0000000f          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00053">53</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="kdp.h::KD_BREAKPOINT_SUSPENDED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KD_BREAKPOINT_SUSPENDED&nbsp;&nbsp;&nbsp;0x00000004          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00050">50</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00826">KdpDeleteBreakpoint()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01309">KdpRestoreAllBreakpoints()</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00954">KdpSuspendBreakpoint()</a>, and <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00316">KdSetOwedBreakpoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="kdp.h::KDP_MESSAGE_BUFFER_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KDP_MESSAGE_BUFFER_SIZE&nbsp;&nbsp;&nbsp;4096          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00432">432</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00110">KdpPromptString()</a>, <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00212">KdpReadControlSpace()</a>, and <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="kdp.h::KDP_PACKET_RECEIVED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KDP_PACKET_RECEIVED&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00062">62</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00110">KdpPromptString()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00342">KdpReceivePacket()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00095">KdpReceivePacketLeader()</a>, and <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="kdp.h::KDP_PACKET_RESEND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KDP_PACKET_RESEND&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00064">64</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00110">KdpPromptString()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00342">KdpReceivePacket()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00095">KdpReceivePacketLeader()</a>, and <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="kdp.h::KDP_PACKET_TIMEOUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KDP_PACKET_TIMEOUT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00063">63</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00342">KdpReceivePacket()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00095">KdpReceivePacketLeader()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="kdp.h::MAXIMUM_RETRIES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAXIMUM_RETRIES&nbsp;&nbsp;&nbsp;20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00079">79</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a17" doxytag="kdp.h::BREAKPOINT_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a>  <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">BREAKPOINT_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="kdp.h::PBREAKPOINT_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a> * <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">PBREAKPOINT_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="kdp.h::PDBGKD_INTERNAL_BREAKPOINT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef   * <a class="el" href="../../d0/d7/kdp_8h.html#a39">PDBGKD_INTERNAL_BREAKPOINT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="kdp.h::PTRACE_DATA_SYM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a> * <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">PTRACE_DATA_SYM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="kdp.h::TRACE_DATA_SYM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a>  <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">TRACE_DATA_SYM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a90" doxytag="kdp.h::KdpAddBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KdpAddBreakpoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Address</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">60</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>00066                    :
00067 
00068     This routine adds an entry to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table and returns a handle
00069     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table entry.
00070 
00071 Arguments:
00072 
00073     Address - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address where to set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint.
00074 
00075 Return Value:
00076 
00077     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of zero <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00078     breakpoint table, there are no free entries in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00079     specified address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not correctly aligned, or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00080     not valid. Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> index of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assigned breakpoint table entry
00081     plus one <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00082 
00083 --*/
00084 
00085 {
00086 
00087     <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a> Content;
00088     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00089     BOOLEAN Accessible;
00090     ULONG_PTR Opaque;
00091 
00092     <span class="comment">//DPRINT(("KD: Setting breakpoint at 0x%08x\n", Address));</span>
00093 
00094     <span class="comment">//</span>
00095     <span class="comment">// If the specified address is not properly aligned, then return zero.</span>
00096     <span class="comment">//</span>
00097 
00098     <span class="keywordflow">if</span> (((ULONG_PTR)Address &amp; <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a5">KDP_BREAKPOINT_ALIGN</a>) != 0) {
00099         <span class="keywordflow">return</span> 0;
00100     }
00101 
00102 
00103     <span class="comment">//</span>
00104     <span class="comment">// Don't allow setting the same breakpoint twice.</span>
00105     <span class="comment">//</span>
00106 
00107     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00108         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>) != 0 &amp;&amp;
00109             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> == Address) {
00110 
00111             <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a4">KD_BREAKPOINT_NEEDS_REPLACE</a>) != 0) {
00112 
00113                 <span class="comment">//</span>
00114                 <span class="comment">// Breakpoint was set, the page was written out and was not</span>
00115                 <span class="comment">// accessible when the breakpoint was cleared.  Now the breakpoint</span>
00116                 <span class="comment">// is being set again.  Just clear the defer flag:</span>
00117                 <span class="comment">//</span>
00118                 <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp;= ~<a class="code" href="../../d0/d7/kdp_8h.html#a4">KD_BREAKPOINT_NEEDS_REPLACE</a>;
00119                 <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> + 1;
00120 
00121             } <span class="keywordflow">else</span> {
00122 
00123                 <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: Attempt to set breakpoint %08x twice!\n"</span>, Address));
00124                 <span class="keywordflow">return</span> 0;
00125 
00126             }
00127         }
00128     }
00129 
00130     <span class="comment">//</span>
00131     <span class="comment">// Search the breakpoint table for a free entry.</span>
00132     <span class="comment">//</span>
00133 
00134     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00135         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> == 0) {
00136             <span class="keywordflow">break</span>;
00137         }
00138     }
00139 
00140     <span class="comment">//</span>
00141     <span class="comment">// If a free entry was found, then write breakpoint and return the handle</span>
00142     <span class="comment">// value plus one. Otherwise, return zero.</span>
00143     <span class="comment">//</span>
00144 
00145     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> == BREAKPOINT_TABLE_SIZE) {
00146         <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: ran out of breakpoints!\n"</span>));
00147         <span class="keywordflow">return</span> 0;
00148     }
00149 
00150 
00151     <span class="comment">//DPRINT(("KD: using Index %d\n", Index));</span>
00152 
00153     <span class="comment">//</span>
00154     <span class="comment">// Get the instruction to be replaced. If the instruction cannot be read,</span>
00155     <span class="comment">// then mark breakpoint as not accessible.</span>
00156     <span class="comment">//</span>
00157 
00158     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00159             (PCHAR)&amp;Content,
00160             (PCHAR)Address,
00161             <span class="keyword">sizeof</span>(KDP_BREAKPOINT_TYPE) ) != <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a>)) {
00162         Accessible = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00163         <span class="comment">//DPRINT(("KD: memory inaccessible\n"));</span>
00164     } <span class="keywordflow">else</span> {
00165         <span class="comment">//DPRINT(("KD: memory readable...\n"));</span>
00166         Accessible = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00167     }
00168 
00169     <span class="comment">//</span>
00170     <span class="comment">// If the specified address is not write accessible, then return zero.</span>
00171     <span class="comment">//</span>
00172 
00173     <span class="keywordflow">if</span> (Accessible) {
00174         <span class="keywordflow">if</span>  (<a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a1">MmDbgWriteCheck</a>((PVOID)Address, &amp;Opaque) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00175             <a class="code" href="../../d2/d6/ia64_2debugsup_8c.html#a2">MmDbgReleaseAddress</a>((PVOID)Address, Opaque);
00176         } <span class="keywordflow">else</span> {
00177             <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: memory not writable!\n"</span>));
00178             <span class="keywordflow">return</span> 0;
00179         }
00180     }
00181 
00182 <span class="preprocessor">#if defined(_IA64_)</span>
00183 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( Accessible ) {
00184         <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a> mBuf;
00185         PVOID BundleAddress;
00186 
00187         <span class="comment">// change template to type 0 if current instruction is MLI</span>
00188 
00189         <span class="comment">// read in intruction template if current instruction is NOT slot 0.</span>
00190         <span class="comment">// check for two-slot MOVL instruction. Reject request if attempt to</span>
00191         <span class="comment">// set break in slot 2 of MLI template.</span>
00192 
00193         <span class="keywordflow">if</span> (((ULONG_PTR)Address &amp; 0xf) != 0) {
00194             (ULONG_PTR)BundleAddress = (ULONG_PTR)Address &amp; ~(0xf);
00195             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00196                     (PCHAR)&amp;mBuf,
00197                     (PCHAR)BundleAddress,
00198                     <span class="keyword">sizeof</span>(KDP_BREAKPOINT_TYPE)
00199                     ) != <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a>)) {
00200                 <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: read 0x%08x template failed\n"</span>, BundleAddress));
00201                 <span class="keywordflow">return</span> 0;
00202             } <span class="keywordflow">else</span> {
00203                 <span class="keywordflow">if</span> (((mBuf &amp; INST_TEMPL_MASK) &gt;&gt; 1) == 0x2) {
00204                     <span class="keywordflow">if</span> (((ULONG_PTR)Address &amp; 0xf) == 4) {
00205                         <span class="comment">// if template= type 2 MLI, change to type 0</span>
00206                         mBuf &amp;= ~((INST_TEMPL_MASK &gt;&gt; 1) &lt;&lt; 1);
00207                         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> |= <a class="code" href="../../d0/d7/kdp_8h.html#a8">KD_BREAKPOINT_IA64_MOVL</a>;
00208                         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00209                                 (PCHAR)BundleAddress,
00210                                 (PCHAR)&amp;mBuf,
00211                                 <span class="keyword">sizeof</span>(KDP_BREAKPOINT_TYPE)
00212                                 ) != <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a>)) {
00213                             <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: write to 0x%08x template failed\n"</span>, BundleAddress));
00214                             <span class="keywordflow">return</span> 0;
00215                          }
00216                          <span class="keywordflow">else</span> {
00217                              <span class="comment">//DPRINT(("KD: change MLI template to type 0 at 0x%08x set\n", Address));</span>
00218                          }
00219                     } <span class="keywordflow">else</span> {
00220                          <span class="comment">// set breakpoint at slot 2 of MOVL is illegal</span>
00221                          <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: illegal to set BP at slot 2 of MOVL at 0x%08x\n"</span>, BundleAddress));
00222                          <span class="keywordflow">return</span> 0;
00223                     }
00224                 }
00225             }
00226         }
00227 
00228         <span class="comment">// insert break instruction</span>
00229 
00230         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> = Address;
00231         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o3">Content</a> = Content;
00232         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp;= ~(<a class="code" href="../../d0/d7/kdp_8h.html#a5">KD_BREAKPOINT_STATE_MASK</a>);
00233         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> |= <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>;
00234         <span class="keywordflow">if</span> (Address &lt; (PVOID)<a class="code" href="../../d0/d7/kdp_8h.html#a0">GLOBAL_BREAKPOINT_LIMIT</a>) {
00235             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a> =
00236                 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process-&gt;DirectoryTableBase[0];
00237             }
00238             <span class="keywordflow">switch</span> ((ULONG_PTR)Address &amp; 0xf) {
00239             <span class="keywordflow">case</span> 0:
00240                 Content = (Content &amp; ~(INST_SLOT0_MASK)) | (<a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a> &lt;&lt; 5);
00241                 <span class="keywordflow">break</span>;
00242 
00243             <span class="keywordflow">case</span> 4:
00244                 Content = (Content &amp; ~(INST_SLOT1_MASK)) | (<a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a> &lt;&lt; 14);
00245                 <span class="keywordflow">break</span>;
00246 
00247             <span class="keywordflow">case</span> 8:
00248                 Content = (Content &amp; ~(INST_SLOT2_MASK)) | (<a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a> &lt;&lt; 23);
00249                 <span class="keywordflow">break</span>;
00250 
00251             <span class="keywordflow">default</span>:
00252                 <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: KdpAddBreakpoint bad instruction slot#\n"</span>));
00253                 <span class="keywordflow">return</span> 0;
00254             }
00255             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00256                     (PCHAR)Address,
00257                     (PCHAR)&amp;Content,
00258                     <span class="keyword">sizeof</span>(KDP_BREAKPOINT_TYPE)
00259                     ) != <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a>)) {
00260 
00261                 <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: KdpMoveMemory failed writing BP!\n"</span>));
00262                 <span class="keywordflow">return</span> 0;
00263             }
00264             <span class="keywordflow">else</span> {
00265                 <span class="comment">//DPRINT(("KD: breakpoint at 0x%08x set\n", Address));</span>
00266             }
00267 
00268     } <span class="keywordflow">else</span> {  <span class="comment">// memory not accessible</span>
00269         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> = Address;
00270         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp;= ~(<a class="code" href="../../d0/d7/kdp_8h.html#a5">KD_BREAKPOINT_STATE_MASK</a>);
00271         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> |= <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>;
00272         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> |= <a class="code" href="../../d0/d7/kdp_8h.html#a2">KD_BREAKPOINT_NEEDS_WRITE</a>;
00273         <a class="code" href="../../d8/d5/kddata_8c.html#a108">KdpOweBreakpoint</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00274         <span class="comment">//DPRINT(("KD: breakpoint write deferred\n"));</span>
00275         <span class="keywordflow">if</span> (Address &lt; (PVOID)<a class="code" href="../../d0/d7/kdp_8h.html#a0">GLOBAL_BREAKPOINT_LIMIT</a>) {
00276             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a> =
00277                 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process-&gt;DirectoryTableBase[0];
00278         }
00279     }
00280 <span class="preprocessor">#else</span>
00281 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( Accessible ) {
00282         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> = Address;
00283         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o3">Content</a> = Content;
00284         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> = <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>;
00285         <span class="keywordflow">if</span> (Address &lt; (PVOID)<a class="code" href="../../d0/d7/kdp_8h.html#a0">GLOBAL_BREAKPOINT_LIMIT</a>) {
00286             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a> =
00287                 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process-&gt;DirectoryTableBase[0];
00288         }
00289         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00290                 (PCHAR)Address,
00291                 (PCHAR)&amp;KdpBreakpointInstruction,
00292                 <span class="keyword">sizeof</span>(KDP_BREAKPOINT_TYPE)
00293                 ) != <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a>)) {
00294 
00295             <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: KdpMoveMemory failed writing BP!\n"</span>));
00296         }
00297     } <span class="keywordflow">else</span> {
00298         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> = Address;
00299         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> = <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a> | <a class="code" href="../../d0/d7/kdp_8h.html#a2">KD_BREAKPOINT_NEEDS_WRITE</a>;
00300         <a class="code" href="../../d8/d5/kddata_8c.html#a108">KdpOweBreakpoint</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00301         <span class="comment">//DPRINT(("KD: breakpoint write deferred\n"));</span>
00302         <span class="keywordflow">if</span> (Address &lt; (PVOID)<a class="code" href="../../d0/d7/kdp_8h.html#a0">GLOBAL_BREAKPOINT_LIMIT</a>) {
00303             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a> =
00304                 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process-&gt;DirectoryTableBase[0];
00305         }
00306     }
00307 <span class="preprocessor">#endif  // IA64</span>
00308 <span class="preprocessor"></span>
00309     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> + 1;
00310 
00311 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="kdp.h::KdpDeleteBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpDeleteBreakpoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00826">826</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>00832                    :
00833 
00834     This routine deletes an entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table.
00835 
00836 Arguments:
00837 
00838     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> index plus one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table entry
00839         which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be deleted.
00840 
00841 Return Value:
00842 
00843     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not a valid
00844     value or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint cannot be deleted because <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old instruction
00845     cannot be replaced. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00846 
00847 --*/
00848 
00849 {
00850     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - 1;
00851 
00852     <span class="comment">//</span>
00853     <span class="comment">// If the specified handle is not valid, then return FALSE.</span>
00854     <span class="comment">//</span>
00855 
00856     <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> == 0) || (<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> &gt; BREAKPOINT_TABLE_SIZE)) {
00857         <a class="code" href="../../d0/d7/kdp_8h.html#a16">DPRINT</a>((<span class="stringliteral">"KD: Breakpoint %d invalid.\n"</span>, Index));
00858         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00859     }
00860 
00861     <span class="comment">//</span>
00862     <span class="comment">// If the specified breakpoint table entry is not valid, then return FALSE.</span>
00863     <span class="comment">//</span>
00864 
00865     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> == 0) {
00866         <span class="comment">//DPRINT(("KD: Breakpoint %d already clear.\n", Index));</span>
00867         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00868     }
00869 
00870     <span class="comment">//</span>
00871     <span class="comment">// If the breakpoint is already suspended, just delete it from the table.</span>
00872     <span class="comment">//</span>
00873 
00874     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>) {
00875         <span class="comment">//DPRINT(("KD: Deleting suspended breakpoint %d \n", Index));</span>
00876         <span class="keywordflow">if</span> ( !(<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a4">KD_BREAKPOINT_NEEDS_REPLACE</a>) ) {
00877             <span class="comment">//DPRINT(("KD: already clear.\n"));</span>
00878             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> = 0;
00879             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00880         }
00881     }
00882 
00883     <span class="comment">//</span>
00884     <span class="comment">// Replace the instruction contents.</span>
00885     <span class="comment">//</span>
00886 
00887     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d4/4_2kdbreak_8c.html#a4">KdpLowWriteContent</a>(Index)) {
00888 
00889         <span class="comment">//</span>
00890         <span class="comment">// Delete breakpoint table entry</span>
00891         <span class="comment">//</span>
00892 
00893         <span class="comment">//DPRINT(("KD: Breakpoint %d deleted successfully.\n", Index));</span>
00894         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> = 0;
00895     }
00896 
00897     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00898 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="kdp.h::KdpDeleteBreakpointRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpDeleteBreakpointRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Lower</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Upper</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00902">902</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>00909                    :
00910 
00911     This routine deletes all breakpoints falling in a given range
00912     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint table.
00913 
00914 Arguments:
00915 
00916     Lower - inclusive lower address of range from which to remove BPs.
00917 
00918     Upper - include upper address of range from which to remove BPs.
00919 
00920 Return Value:
00921 
00922     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> any breakpoints removed, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
00923 
00924 --*/
00925 
00926 {
00927     ULONG   <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00928     BOOLEAN ReturnStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00929 
00930     <span class="comment">//</span>
00931     <span class="comment">// Examine each entry in the table in turn</span>
00932     <span class="comment">//</span>
00933 
00934     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00935 
00936         <span class="keywordflow">if</span> ( (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>) &amp;&amp;
00937              ((<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> &gt;= Lower) &amp;&amp;
00938               (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> &lt;= Upper))
00939            ) {
00940 
00941             <span class="comment">//</span>
00942             <span class="comment">// Breakpoint is in use and falls in range, clear it.</span>
00943             <span class="comment">//</span>
00944 
00945             ReturnStatus = ReturnStatus || <a class="code" href="../../d1/d7/4_2kdp_8h.html#a105">KdpDeleteBreakpoint</a>(Index+1);
00946         }
00947     }
00948 
00949     <span class="keywordflow">return</span> ReturnStatus;
00950 
00951 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="kdp.h::KdpDisplayString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpDisplayString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Output</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a115" doxytag="kdp.h::KdpGetContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpGetContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01461">1461</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00150">KdpQuickMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>01469                    :
01470 
01471     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a get context state
01472     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
01473     context.
01474 
01475 Arguments:
01476 
01477     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01478 
01479     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01480 
01481     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01482 
01483 Return Value:
01484 
01485     None.
01486 
01487 --*/
01488 
01489 {
01490     PDBGKD_GET_CONTEXT a = &amp;m-&gt;u.GetContext;
01491     STRING MessageHeader;
01492 
01493     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01494     MessageHeader.Buffer = (PCHAR)m;
01495 
01496     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
01497 
01498     <span class="keywordflow">if</span> (m-&gt;Processor &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>) {
01499         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01500     } <span class="keywordflow">else</span> {
01501         m-&gt;ReturnStatus = STATUS_SUCCESS;
01502         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>(CONTEXT);
01503         <span class="keywordflow">if</span> (m-&gt;Processor == (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number) {
01504             <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a>(AdditionalData-&gt;Buffer, (PCHAR)Context, <span class="keyword">sizeof</span>(CONTEXT));
01505         } <span class="keywordflow">else</span> {
01506             <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a>(AdditionalData-&gt;Buffer,
01507                           (PCHAR)&amp;KiProcessorBlock[m-&gt;Processor]-&gt;ProcessorState.ContextFrame,
01508                           <span class="keyword">sizeof</span>(CONTEXT)
01509                          );
01510         }
01511     }
01512 
01513     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01514                   PACKET_TYPE_KD_STATE_MANIPULATE,
01515                   &amp;MessageHeader,
01516                   AdditionalData
01517                   );
01518 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="kdp.h::KdpGetStateChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpGetStateChange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>ManipulateState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00183">183</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
<pre class="fragment"><div>00190                    :
00191 
00192     Extract continuation <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> data from Manipulate_State message
00193 
00194     N.B. This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a noop <span class="keywordflow">for</span> MIPS.
00195 
00196 Arguments:
00197 
00198     ManipulateState - supplies pointer to Manipulate_State packet
00199 
00200     ContextRecord - Supplies a pointer to a context record.
00201 
00202 Return Value:
00203 
00204     None.
00205 
00206 --*/
00207 
00208 {
00209 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a131" doxytag="kdp.h::KdpInitCom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpInitCom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="kdp.h::KdpMoveMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KdpMoveMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Destination</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">31</a> of file <a class="el" href="../../d9/d5/kdmove_8c-source.html">kdmove.c</a>.
<p>
<pre class="fragment"><div>00039                    :
00040 
00041     This routine moves data to or from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message buffer and returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00042     actual length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information that was <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a100">moved</a>. As data <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a100">moved</a>, checks
00043     are <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to ensure that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> resident in memory and a page fault
00044     will not occur. If a page fault would occur, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> truncated.
00045 
00046 Arguments:
00047 
00048     Destination  - Supplies a pointer to destination of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00049 
00050     Source - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00051 
00052     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00053 
00054 Return Value:
00055 
00056     The actual length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> fucntion value.
00057 
00058 --*/
00059 
00060 {
00061 
00062     PVOID Address1;
00063     PVOID Address2;
00064     ULONG ActualLength;
00065     ULONG_PTR Opaque;
00066 
00067     <span class="comment">//</span>
00068     <span class="comment">// If the length is greater than the size of the message buffer, then</span>
00069     <span class="comment">// reduce the length to the size of the message buffer.</span>
00070     <span class="comment">//</span>
00071 
00072     <span class="keywordflow">if</span> (Length &gt; <a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>) {
00073         Length = <a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>;
00074     }
00075 
00076     <span class="comment">//</span>
00077     <span class="comment">// Move the source information to the destination address.</span>
00078     <span class="comment">//</span>
00079 
00080     ActualLength = Length;
00081 
00082     <span class="keywordflow">while</span> (((ULONG_PTR)Source &amp; 3) &amp;&amp; (Length &gt; 0)) {
00083 
00084     <span class="comment">//</span>
00085     <span class="comment">// Check to determine if the move will succeed before actually performing</span>
00086     <span class="comment">// the operation.</span>
00087     <span class="comment">//</span>
00088 
00089         Address1 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a1">MmDbgWriteCheck</a>((PVOID)Destination, &amp;Opaque);
00090         Address2 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a0">MmDbgReadCheck</a>((PVOID)Source);
00091         <span class="keywordflow">if</span> ((Address1 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (Address2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00092             <span class="keywordflow">break</span>;
00093         }
00094         *(PCHAR)Address1 = *(PCHAR)Address2;
00095         <a class="code" href="../../d2/d6/ia64_2debugsup_8c.html#a2">MmDbgReleaseAddress</a>((PVOID)Destination, Opaque);
00096         Destination += 1;
00097         Source += 1;
00098         Length -= 1;
00099     }
00100 
00101     <span class="keywordflow">while</span> (Length &gt; 3) {
00102 
00103     <span class="comment">//</span>
00104     <span class="comment">// Check to determine if the move will succeed before actually performing</span>
00105     <span class="comment">// the operation.</span>
00106     <span class="comment">//</span>
00107 
00108         Address1 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a1">MmDbgWriteCheck</a>((PVOID)Destination, &amp;Opaque);
00109         Address2 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a0">MmDbgReadCheck</a>((PVOID)Source);
00110         <span class="keywordflow">if</span> ((Address1 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (Address2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00111             <span class="keywordflow">break</span>;
00112         }
00113         *(ULONG UNALIGNED *)Address1 = *(PULONG)Address2;
00114         <a class="code" href="../../d2/d6/ia64_2debugsup_8c.html#a2">MmDbgReleaseAddress</a>((PVOID)Destination, Opaque);
00115         Destination += 4;
00116         Source += 4;
00117         Length -= 4;
00118 
00119     }
00120 
00121     <span class="keywordflow">while</span> (Length &gt; 0) {
00122 
00123     <span class="comment">//</span>
00124     <span class="comment">// Check to determine if the move will succeed before actually performing</span>
00125     <span class="comment">// the operation.</span>
00126     <span class="comment">//</span>
00127 
00128         Address1 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a1">MmDbgWriteCheck</a>((PVOID)Destination, &amp;Opaque);
00129         Address2 = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a0">MmDbgReadCheck</a>((PVOID)Source);
00130         <span class="keywordflow">if</span> ((Address1 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (Address2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00131             <span class="keywordflow">break</span>;
00132         }
00133         *(PCHAR)Address1 = *(PCHAR)Address2;
00134         <a class="code" href="../../d2/d6/ia64_2debugsup_8c.html#a2">MmDbgReleaseAddress</a>((PVOID)Destination, Opaque);
00135         Destination += 1;
00136         Source += 1;
00137         Length -= 1;
00138     }
00139 
00140     <span class="comment">//</span>
00141     <span class="comment">// Flush the instruction cache in case the write was into the instruction</span>
00142     <span class="comment">// stream.</span>
00143     <span class="comment">//</span>
00144 
00145     KeSweepCurrentIcache();
00146     <span class="keywordflow">return</span> ActualLength - Length;
00147 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a134" doxytag="kdp.h::KdpPollBreakInWithPortLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpPollBreakInWithPortLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/kdlock_8c-source.html#l00165">165</a> of file <a class="el" href="../../d7/d5/kdlock_8c-source.html">kdlock.c</a>.
<p>
<pre class="fragment"><div>00171                    :
00172 
00173     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a> same as <a class="code" href="../../d7/d3/kd_8h.html#a19">KdPollBreakIn</a>, but assumes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller
00174     already holds <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> port lock.  Returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> a breakin packet
00175     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> pending.
00176 
00177     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> packet <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> present <span class="keywordflow">if</span>:
00178 
00179     There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a valid character which matches BREAK_CHAR.
00180 
00181     N.B.    Interrupts must be OFF around <span class="keyword">this</span> call
00182 
00183 Return Value:
00184 
00185     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> breakin sequence present, caller should execute <span class="keywordtype">int</span>-3.
00186     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> no breakin seen.
00187 
00188 --*/
00189 
00190 {
00191 
00192     BOOLEAN BreakIn;
00193     BOOLEAN Enable;
00194     UCHAR Input;
00195     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00196 
00197     <span class="comment">//</span>
00198     <span class="comment">// If the debugger is enabled, see if a breakin by the kernel</span>
00199     <span class="comment">// debugger is pending.</span>
00200     <span class="comment">//</span>
00201 
00202     BreakIn = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00203     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00204         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00205             BreakIn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00206             <a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00207 
00208         } <span class="keywordflow">else</span> {
00209             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d7/hal_8h.html#a201">KdPortPollByte</a>(&amp;Input);
00210             <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == <a class="code" href="../../d7/d3/kd_8h.html#a0">CP_GET_SUCCESS</a>) &amp;&amp;
00211                 (Input == BREAKIN_PACKET_BYTE)) {
00212                 BreakIn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00213             }
00214         }
00215     }
00216 
00217     <span class="keywordflow">return</span> BreakIn;
00218 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a132" doxytag="kdp.h::KdpPortLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpPortLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/kdlock_8c-source.html#l00026">26</a> of file <a class="el" href="../../d7/d5/kdlock_8c-source.html">kdlock.c</a>.
<p>
<pre class="fragment"><div>00032                    :
00033 
00034     Acquire <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> spinlock <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debug port.
00035 
00036     Note that user must call <span class="keyword">this</span> explicitly, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> get/put <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a>
00037     <span class="keywordflow">do</span> NOT make any use of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lock.
00038 
00039     CALLER MUST HAVE <a class="code" href="../../d9/d7/profman_8c.html#a17">SET</a> PROPER IRQL BEFORE CALLING US.
00040 
00041     We use KiAcquireSpinLock and NOT Ke... because our IRQL may
00042     be above <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00043 
00044 Arguments:
00045 
00046     None.
00047 
00048 Return value:
00049 
00050     None.
00051 
00052 --*/
00053 
00054 {
00055     KiAcquireSpinLock(&amp;KdpDebuggerLock);
00056 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a133" doxytag="kdp.h::KdpPortUnlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpPortUnlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/kdlock_8c-source.html#l00060">60</a> of file <a class="el" href="../../d7/d5/kdlock_8c-source.html">kdlock.c</a>.
<p>
<pre class="fragment"><div>00066                    :
00067 
00068     Release <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> spinlock <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debug port.
00069 
00070     Note that user must call <span class="keyword">this</span> explicitly, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> get/put <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a>
00071     <span class="keywordflow">do</span> NOT make any use of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lock.
00072 
00073     CALLER MUST HAVE <a class="code" href="../../d9/d7/profman_8c.html#a17">SET</a> PROPER IRQL BEFORE CALLING US.
00074 
00075     We use KiReleaseSpinLock and NOT Ke... because our IRQL may
00076     be above <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00077 
00078 Arguments:
00079 
00080     None.
00081 
00082 Return value:
00083 
00084     None.
00085 
00086 --*/
00087 
00088 {
00089     KiReleaseSpinLock(&amp;KdpDebuggerLock);
00090 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="kdp.h::KdpPrintString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpPrintString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSTRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Output</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00030">30</a> of file <a class="el" href="../../d1/d5/kddbgio_8c-source.html">kddbgio.c</a>.
<p>
<pre class="fragment"><div>00036                    :
00037 
00038     This routine prints a string.
00039 
00040 Arguments:
00041 
00042     Output - Supplies a pointer to a string descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> output string.
00043 
00044 Return Value:
00045 
00046     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> Control-C present in input buffer after <a class="code" href="../../d0/d1/rtdeltre_8c.html#a5">print</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done.
00047     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
00048 
00049 --*/
00050 
00051 {
00052 
00053     ULONG Length;
00054     STRING MessageData;
00055     STRING MessageHeader;
00056     DBGKD_DEBUG_IO DebugIo;
00057 
00058     <span class="comment">//</span>
00059     <span class="comment">// Move the output string to the message buffer.</span>
00060     <span class="comment">//</span>
00061 
00062     Length = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00063                 (PCHAR)KdpMessageBuffer,
00064                 (PCHAR)Output-&gt;Buffer,
00065                 Output-&gt;Length
00066                 );
00067 
00068     <span class="comment">//</span>
00069     <span class="comment">// If the total message length is greater than the maximum packet size,</span>
00070     <span class="comment">// then truncate the output string.</span>
00071     <span class="comment">//</span>
00072 
00073     <span class="keywordflow">if</span> ((<span class="keyword">sizeof</span>(DBGKD_DEBUG_IO) + Length) &gt; PACKET_MAX_SIZE) {
00074         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_DEBUG_IO);
00075     }
00076 
00077     <span class="comment">//</span>
00078     <span class="comment">// Construct the print string message and message descriptor.</span>
00079     <span class="comment">//</span>
00080 
00081     DebugIo.ApiNumber = DbgKdPrintStringApi;
00082     DebugIo.ProcessorLevel = <a class="code" href="../../d4/d9/ke_8h.html#a135">KeProcessorLevel</a>;
00083     DebugIo.Processor = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number;
00084     DebugIo.u.PrintString.LengthOfString = Length;
00085     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_DEBUG_IO);
00086     MessageHeader.Buffer = (PCHAR)&amp;DebugIo;
00087 
00088     <span class="comment">//</span>
00089     <span class="comment">// Construct the print string data and data descriptor.</span>
00090     <span class="comment">//</span>
00091 
00092     MessageData.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)Length;
00093     MessageData.Buffer = <a class="code" href="../../d8/d5/kddata_8c.html#a52">KdpMessageBuffer</a>;
00094 
00095     <span class="comment">//</span>
00096     <span class="comment">// Send packet to the kernel debugger on the host machine.</span>
00097     <span class="comment">//</span>
00098 
00099     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00100                   PACKET_TYPE_KD_DEBUG_IO,
00101                   &amp;MessageHeader,
00102                   &amp;MessageData
00103                   );
00104 
00105     <span class="keywordflow">return</span> <a class="code" href="../../d1/d7/4_2kdp_8h.html#a147">KdpPollBreakInWithPortLock</a>();
00106 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="kdp.h::KdpPromptString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpPromptString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Output</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Input</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00110">110</a> of file <a class="el" href="../../d1/d5/kddbgio_8c-source.html">kddbgio.c</a>.
<p>
<pre class="fragment"><div>00117                    :
00118 
00119     This routine prints a string, then reads a reply string.
00120 
00121 Arguments:
00122 
00123     Output - Supplies a pointer to a string descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> output string.
00124 
00125     Input - Supplies a pointer to a string descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input string.
00126             (Length stored/returned in Input-&gt;Length)
00127 
00128 Return Value:
00129 
00130     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> Breakin sequence was seen, caller should breakpoint and retry
00131     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - No Breakin seen.
00132 
00133 --*/
00134 
00135 {
00136 
00137     ULONG Length;
00138     STRING MessageData;
00139     STRING MessageHeader;
00140     DBGKD_DEBUG_IO DebugIo;
00141     ULONG ReturnCode;
00142 
00143     <span class="comment">//</span>
00144     <span class="comment">// Move the output string to the message buffer.</span>
00145     <span class="comment">//</span>
00146 
00147     Length = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00148                 (PCHAR)KdpMessageBuffer,
00149                 (PCHAR)Output-&gt;Buffer,
00150                 Output-&gt;Length
00151                 );
00152 
00153     <span class="comment">//</span>
00154     <span class="comment">// If the total message length is greater than the maximum packet size,</span>
00155     <span class="comment">// then truncate the output string.</span>
00156     <span class="comment">//</span>
00157 
00158     <span class="keywordflow">if</span> ((<span class="keyword">sizeof</span>(DBGKD_DEBUG_IO) + Length) &gt; PACKET_MAX_SIZE) {
00159         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_DEBUG_IO);
00160     }
00161 
00162     <span class="comment">//</span>
00163     <span class="comment">// Construct the prompt string message and message descriptor.</span>
00164     <span class="comment">//</span>
00165 
00166     DebugIo.ApiNumber = DbgKdGetStringApi;
00167     DebugIo.ProcessorLevel = <a class="code" href="../../d4/d9/ke_8h.html#a135">KeProcessorLevel</a>;
00168     DebugIo.Processor = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number;
00169     DebugIo.u.GetString.LengthOfPromptString = Length;
00170     DebugIo.u.GetString.LengthOfStringRead = Input-&gt;MaximumLength;
00171     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_DEBUG_IO);
00172     MessageHeader.Buffer = (PCHAR)&amp;DebugIo;
00173 
00174     <span class="comment">//</span>
00175     <span class="comment">// Construct the prompt string data and data descriptor.</span>
00176     <span class="comment">//</span>
00177 
00178     MessageData.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)Length;
00179     MessageData.Buffer = <a class="code" href="../../d8/d5/kddata_8c.html#a52">KdpMessageBuffer</a>;
00180 
00181     <span class="comment">//</span>
00182     <span class="comment">// Send packet to the kernel debugger on the host machine.</span>
00183     <span class="comment">//</span>
00184 
00185     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00186                   PACKET_TYPE_KD_DEBUG_IO,
00187                   &amp;MessageHeader,
00188                   &amp;MessageData
00189                   );
00190 
00191 
00192     <span class="comment">//</span>
00193     <span class="comment">// Receive packet from the kernel debugger on the host machine.</span>
00194     <span class="comment">//</span>
00195 
00196     MessageHeader.MaximumLength = <span class="keyword">sizeof</span>(DBGKD_DEBUG_IO);
00197     MessageData.MaximumLength = <a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>;
00198 
00199     <span class="keywordflow">do</span> {
00200         ReturnCode = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a112">KdpReceivePacket</a>(
00201                                       PACKET_TYPE_KD_DEBUG_IO,
00202                                       &amp;MessageHeader,
00203                                       &amp;MessageData,
00204                                       &amp;Length
00205                                       );
00206         <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>) {
00207             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00208         }
00209     } <span class="keywordflow">while</span> (ReturnCode != <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>);
00210 
00211 
00212     <span class="keywordflow">if</span> (Length &gt; Input-&gt;MaximumLength) {
00213         Length = Input-&gt;MaximumLength;
00214     }
00215 
00216     Input-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
00217                                 (PCHAR)Input-&gt;Buffer,
00218                                 (PCHAR)KdpMessageBuffer,
00219                                 Length
00220                                 );
00221 
00222     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00223 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="kdp.h::KdpQuickMoveMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpQuickMoveMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Destination</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00150">150</a> of file <a class="el" href="../../d9/d5/kdmove_8c-source.html">kdmove.c</a>.
<p>
<pre class="fragment"><div>00158                    :
00159 
00160     This routine does <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exact same thing as RtlMoveMemory, BUT <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00161     <span class="keyword">private</span> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debugger.  This allows folks to set breakpoints and
00162     watch points in RtlMoveMemory without risk of recursive debugger
00163     entry and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> accompanying hang.
00164 
00165     N.B.  UNLIKE <a class="code" href="../../d8/d6/kdmove_8c.html#a0">KdpMoveMemory</a>, <span class="keyword">this</span> routine does NOT check <span class="keywordflow">for</span> accessability
00166       and may fault!  Use <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> ONLY in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debugger and ONLY where you
00167       could use RtlMoveMemory.
00168 
00169 Arguments:
00170 
00171     Destination  - Supplies a pointer to destination of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00172 
00173     Source - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00174 
00175     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> operation.
00176 
00177 Return Value:
00178 
00179     None.
00180 
00181 --*/
00182 {
00183     <span class="keywordflow">while</span> (Length &gt; 0) {
00184         *Destination = *Source;
00185         Destination++;
00186         Source++;
00187         Length--;
00188     }
00189 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="kdp.h::KdpReadComPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpReadComPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a119" doxytag="kdp.h::KdpReadControlSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadControlSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00212">212</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d1/d6/kdp_8h-source.html#l00432">KDP_MESSAGE_BUFFER_SIZE</a>, <a class="el" href="../../d2/d7/alpha_2kdpcpu_8h.html#a12">KdpGetCurrentPrcb()</a>, <a class="el" href="../../d2/d7/alpha_2kdpcpu_8h.html#a13">KdpGetCurrentThread()</a>, <a class="el" href="../../d2/d7/alpha_2kdpcpu_8h.html#a7">KdpGetPcr()</a>, <a class="el" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a9">KdpReadInternalProcessorCounters()</a>, <a class="el" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a8">KdpReadInternalProcessorState()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00220                    :
00221 
00222     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a read <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> space state
00223     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read implementation
00224     specific system data.
00225 
00226 Arguments:
00227 
00228     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
00229 
00230     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
00231 
00232     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
00233 
00234 Return Value:
00235 
00236     None.
00237 
00238 --*/
00239 
00240 {
00241 
00242     PDBGKD_READ_MEMORY a = &amp;m-&gt;u.ReadMemory;
00243     ULONG Length;
00244     STRING MessageHeader;
00245     PVOID <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = AdditionalData-&gt;Buffer;
00246 
00247     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
00248     MessageHeader.Buffer = (PCHAR)m;
00249 
00250     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
00251 
00252     <span class="keywordflow">if</span> (a-&gt;TransferCount &gt; (PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE))) {
00253         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
00254     } <span class="keywordflow">else</span> {
00255         Length = a-&gt;TransferCount;
00256     }
00257 
00258     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<span class="keyword">sizeof</span>(PVOID) == <span class="keyword">sizeof</span>(ULONG));
00259 
00260 <span class="comment">//NOTENOTE</span>
00261 <span class="comment">//  This code will in fact only work on a uni-processor as the</span>
00262 <span class="comment">//  m-&gt;Processor field is ignored for now</span>
00263 
00264     <span class="comment">//</span>
00265     <span class="comment">// Case on address to determine what part of Control</span>
00266     <span class="comment">// space is being read</span>
00267     <span class="comment">//</span>
00268 
00269     <span class="keywordflow">switch</span>( (ULONG_PTR)a-&gt;TargetBaseAddress ){
00270 
00271         <span class="comment">//</span>
00272         <span class="comment">// Return the pcr address for the current processor.</span>
00273         <span class="comment">//</span>
00274 
00275     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_PCR:
00276 
00277         *(PKPCR *)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a7">KdpGetPcr</a>();
00278         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>( PKPCR );
00279         a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00280         m-&gt;ReturnStatus = STATUS_SUCCESS;
00281         <span class="keywordflow">break</span>;
00282 
00283         <span class="comment">//</span>
00284         <span class="comment">// Return the prcb address for the current processor.</span>
00285         <span class="comment">//</span>
00286 
00287     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_PRCB:
00288 
00289         *(PKPRCB *)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a12">KdpGetCurrentPrcb</a>();
00290         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>( PKPRCB );
00291         a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00292         m-&gt;ReturnStatus = STATUS_SUCCESS;
00293         <span class="keywordflow">break</span>;
00294 
00295         <span class="comment">//</span>
00296         <span class="comment">// Return the pointer to the current thread address for the</span>
00297         <span class="comment">// current processor.</span>
00298         <span class="comment">//</span>
00299 
00300     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_THREAD:
00301 
00302         *(<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> *)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a13">KdpGetCurrentThread</a>();
00303         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>( <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> );
00304         a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00305         m-&gt;ReturnStatus = STATUS_SUCCESS;
00306         <span class="keywordflow">break</span>;
00307 
00308         <span class="comment">//</span>
00309         <span class="comment">// Return the current Thread Environment Block pointer for the</span>
00310         <span class="comment">// current thread on the current processor.</span>
00311         <span class="comment">//</span>
00312 
00313     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_TEB:
00314 
00315         *(PVOID *)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = (PVOID)NtCurrentTeb();
00316         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>( <span class="keyword">struct </span>_TEB * );
00317         a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00318         m-&gt;ReturnStatus = STATUS_SUCCESS;
00319         <span class="keywordflow">break</span>;
00320 
00321         <span class="comment">//</span>
00322         <span class="comment">// Return the dpc active flag for the current processor.</span>
00323         <span class="comment">//</span>
00324 
00325     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_DPCACTIVE:
00326 
00327         *(BOOLEAN *)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = KeIsExecutingDpc();
00328         AdditionalData-&gt;Length = <span class="keyword">sizeof</span>( ULONG );
00329         a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00330         m-&gt;ReturnStatus = STATUS_SUCCESS;
00331         <span class="keywordflow">break</span>;
00332 
00333         <span class="comment">//</span>
00334         <span class="comment">// Return the internal processor register state.</span>
00335         <span class="comment">//</span>
00336         <span class="comment">// N.B. - the kernel debugger buffer is expected to be allocated</span>
00337         <span class="comment">//        in the 32-bit superpage</span>
00338         <span class="comment">//</span>
00339         <span class="comment">// N.B. - the size of the internal state cannot exceed the size of</span>
00340         <span class="comment">//        the buffer allocated to the kernel debugger via</span>
00341         <span class="comment">//        KDP_MESSAGE_BUFFER_SIZE</span>
00342         <span class="comment">//</span>
00343 
00344     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_IPRSTATE:
00345 
00346         <span class="comment">//</span>
00347         <span class="comment">// Guarantee that Buffer is quadword-aligned, and adjust the</span>
00348         <span class="comment">// size of the available buffer accordingly.</span>
00349         <span class="comment">//</span>
00350 
00351         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = (PVOID)( ((ULONG_PTR)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> + 7) &amp; ~7);
00352 
00353         Length = (ULONG)((ULONG_PTR)&amp;AdditionalData-&gt;Buffer[<a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>] -
00354                  (ULONG_PTR)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>);
00355 
00356         AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a8">KdpReadInternalProcessorState</a>(
00357                                              Buffer,
00358                                              Length );
00359 
00360         <span class="comment">//</span>
00361         <span class="comment">// Check the returned size, if greater than the buffer size than</span>
00362         <span class="comment">// we didn't have a sufficient buffer.  If zero then the call</span>
00363         <span class="comment">// failed otherwise.</span>
00364         <span class="comment">//</span>
00365 
00366         <span class="keywordflow">if</span>( (AdditionalData-&gt;Length &gt; <a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>) ||
00367             (AdditionalData-&gt;Length == 0) ){
00368 
00369             AdditionalData-&gt;Length = 0;
00370             m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
00371             a-&gt;ActualBytesRead = 0;
00372 
00373         } <span class="keywordflow">else</span> {
00374 
00375             m-&gt;ReturnStatus = STATUS_SUCCESS;
00376             a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00377 
00378         }
00379 
00380         <span class="keywordflow">break</span>;
00381 
00382         <span class="comment">//</span>
00383         <span class="comment">// Return the internal processor counter values.</span>
00384         <span class="comment">//</span>
00385         <span class="comment">// N.B. - the kernel debugger buffer is expected to be allocated</span>
00386         <span class="comment">//        in the 32-bit superpage</span>
00387         <span class="comment">//</span>
00388         <span class="comment">// N.B. - the size of the counters structure cannot exceed the size of</span>
00389         <span class="comment">//        the buffer allocated to the kernel debugger via</span>
00390         <span class="comment">//        KDP_MESSAGE_BUFFER_SIZE</span>
00391         <span class="comment">//</span>
00392 
00393     <span class="keywordflow">case</span> DEBUG_CONTROL_SPACE_COUNTERS:
00394 
00395         <span class="comment">//</span>
00396         <span class="comment">// Guarantee that Buffer is quadword-aligned, and adjust the</span>
00397         <span class="comment">// size of the available buffer accordingly.</span>
00398         <span class="comment">//</span>
00399 
00400         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = (PVOID)( ((ULONG_PTR)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> + 7) &amp; ~7);
00401 
00402         Length = (ULONG)((ULONG_PTR)&amp;AdditionalData-&gt;Buffer[<a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>] -
00403                  (ULONG_PTR)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>);
00404 
00405         AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a9">KdpReadInternalProcessorCounters</a>(
00406                                              Buffer,
00407                                              Length );
00408 
00409         <span class="comment">//</span>
00410         <span class="comment">// Check the returned size, if greater than the buffer size than</span>
00411         <span class="comment">// we didn't have a sufficient buffer.  If zero then the call</span>
00412         <span class="comment">// failed otherwise.</span>
00413         <span class="comment">//</span>
00414 
00415         <span class="keywordflow">if</span>( (AdditionalData-&gt;Length &gt; <a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>) ||
00416             (AdditionalData-&gt;Length == 0) ){
00417 
00418             AdditionalData-&gt;Length = 0;
00419             m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
00420             a-&gt;ActualBytesRead = 0;
00421 
00422         } <span class="keywordflow">else</span> {
00423 
00424             m-&gt;ReturnStatus = STATUS_SUCCESS;
00425             a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
00426 
00427         }
00428 
00429         <span class="keywordflow">break</span>;
00430 
00431         <span class="comment">//</span>
00432         <span class="comment">// Uninterpreted Special Space</span>
00433         <span class="comment">//</span>
00434 
00435     <span class="keywordflow">default</span>:
00436 
00437         AdditionalData-&gt;Length = 0;
00438         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
00439         a-&gt;ActualBytesRead = 0;
00440 
00441     }
00442 
00443     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00444         PACKET_TYPE_KD_STATE_MANIPULATE,
00445         &amp;MessageHeader,
00446         AdditionalData
00447         );
00448 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a121" doxytag="kdp.h::KdpReadIoSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadIoSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00499">499</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01170">BusNumber</a>, <a class="el" href="../../d2/d7/hal_8h.html#a184">HalTranslateBusAddress()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00050">InterfaceType</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00085">PUSHORT</a>.
<p>
<pre class="fragment"><div>00507                    :
00508 
00509     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a read io space state
00510     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read system io
00511     locations.
00512 
00513 Arguments:
00514 
00515     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
00516 
00517     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
00518 
00519     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
00520 
00521 Return Value:
00522 
00523     None.
00524 
00525 --*/
00526 
00527 {
00528     PDBGKD_READ_WRITE_IO a = &amp;m-&gt;u.ReadWriteIo;
00529     STRING MessageHeader;
00530     INTERFACE_TYPE <a class="code" href="../../d4/d0/cmconfig_8c.html#a5">InterfaceType</a>;
00531     ULONG <a class="code" href="../../d2/d7/hal_8h.html#a75">BusNumber</a>;
00532     PHYSICAL_ADDRESS IoAddress;
00533     PHYSICAL_ADDRESS TranslatedAddress;
00534     ULONG AddressSpace;
00535     ULONG DataSize;
00536 
00537     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
00538     MessageHeader.Buffer = (PCHAR)m;
00539 
00540     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
00541 
00542     m-&gt;ReturnStatus = STATUS_SUCCESS;
00543 
00544     <span class="comment">//</span>
00545     <span class="comment">// Capture the input parameters and use the default values for those</span>
00546     <span class="comment">// parameters not specified in the Api.</span>
00547     <span class="comment">//</span>
00548 
00549     <a class="code" href="../../d4/d0/cmconfig_8c.html#a5">InterfaceType</a> = Isa;
00550     <a class="code" href="../../d2/d7/hal_8h.html#a75">BusNumber</a> = 0;
00551     AddressSpace = 1;
00552     IoAddress.QuadPart = (ULONG_PTR)a-&gt;IoAddress;
00553     DataSize = a-&gt;DataSize;
00554 
00555     <span class="comment">//</span>
00556     <span class="comment">// Zero the return data value.</span>
00557     <span class="comment">//</span>
00558 
00559     a-&gt;DataValue = 0;
00560 
00561     <span class="comment">//</span>
00562     <span class="comment">// Translate the bus address to the physical system address</span>
00563     <span class="comment">// or QVA.</span>
00564     <span class="comment">//</span>
00565 
00566     <span class="keywordflow">if</span>( !<a class="code" href="../../d2/d7/hal_8h.html#a184">HalTranslateBusAddress</a>( InterfaceType,
00567                                  BusNumber,
00568                                  IoAddress,
00569                                  &amp;AddressSpace,
00570                                  &amp;TranslatedAddress ) ){
00571         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00572         <span class="keywordflow">goto</span> SendReadIoSpaceResponse;
00573     }
00574 
00575     <span class="comment">//</span>
00576     <span class="comment">// N.B. - for the moment we will only support QVAs ie. when AddressSpace</span>
00577     <span class="comment">//        is one.  It may be in later systems that we will have to</span>
00578     <span class="comment">//        check the address space, map it, perform the virtual read</span>
00579     <span class="comment">//        unmap, and then return the data - only we will have to be</span>
00580     <span class="comment">//        careful about what Irql we are to make sure the memory mgmt</span>
00581     <span class="comment">//        stuff will all work</span>
00582     <span class="comment">//</span>
00583 
00584     <span class="keywordflow">if</span>( !AddressSpace ){
00585         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00586         <span class="keywordflow">goto</span> SendReadIoSpaceResponse;
00587     }
00588 
00589     <span class="comment">//</span>
00590     <span class="comment">// Do the IO space read using the appropriate HAL routines based upon</span>
00591     <span class="comment">// the default address space (io) and the data size requested.</span>
00592     <span class="comment">//</span>
00593 
00594     <span class="keywordflow">switch</span>( DataSize ){
00595 
00596     <span class="keywordflow">case</span> 1:
00597         a-&gt;DataValue = READ_PORT_UCHAR( (PUCHAR)TranslatedAddress.LowPart );
00598         <span class="keywordflow">break</span>;
00599 
00600     <span class="keywordflow">case</span> 2:
00601         a-&gt;DataValue = READ_PORT_USHORT( (PUSHORT)TranslatedAddress.LowPart );
00602         <span class="keywordflow">break</span>;
00603 
00604     <span class="keywordflow">case</span> 4:
00605         a-&gt;DataValue = READ_PORT_ULONG((PULONG)TranslatedAddress.LowPart );
00606         <span class="keywordflow">break</span>;
00607 
00608     <span class="keywordflow">default</span>:
00609         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00610     }
00611 
00612 
00613 SendReadIoSpaceResponse:
00614 
00615     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00616         PACKET_TYPE_KD_STATE_MANIPULATE,
00617         &amp;MessageHeader,
00618         NULL
00619         );
00620 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a122" doxytag="kdp.h::KdpReadMachineSpecificRegister" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadMachineSpecificRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l01095">1095</a> of file <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html">i386/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d3/i386_8h.html#a52">RDMSR()</a>.
<p>
<pre class="fragment"><div>01103                    :
01104 
01105     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a read MSR
01106     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MSR.
01107 
01108 Arguments:
01109 
01110     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01111 
01112     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01113 
01114     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01115 
01116 Return Value:
01117 
01118     None.
01119 
01120 --*/
01121 
01122 {
01123     PDBGKD_READ_WRITE_MSR a = &amp;m-&gt;u.ReadWriteMsr;
01124     STRING MessageHeader;
01125     LARGE_INTEGER l;
01126 
01127     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01128     MessageHeader.Buffer = (PCHAR)m;
01129 
01130     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
01131 
01132     m-&gt;ReturnStatus = STATUS_SUCCESS;
01133 
01134     <span class="keywordflow">try</span> {
01135         l.QuadPart = <a class="code" href="../../d5/d3/i386_8h.html#a52">RDMSR</a>(a-&gt;Msr);
01136     } except (EXCEPTION_EXECUTE_HANDLER) {
01137         l.QuadPart = 0;
01138         m-&gt;ReturnStatus = STATUS_NO_SUCH_DEVICE;
01139     }
01140 
01141     a-&gt;DataValueLow  = l.LowPart;
01142     a-&gt;DataValueHigh = l.HighPart;
01143 
01144     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01145         PACKET_TYPE_KD_STATE_MANIPULATE,
01146         &amp;MessageHeader,
01147         NULL
01148         );
01149     UNREFERENCED_PARAMETER(Context);
01150 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a113" doxytag="kdp.h::KdpReadPhysicalMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadPhysicalMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02534">2534</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00166">BYTE_OFFSET</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/ppc_2debugsup_8c-source.html#l00233">MmDbgTranslatePhysicalAddress()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00190">PAGE_ALIGN</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>02542                    :
02543 
02544     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response to a read physical memory
02545     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read physical memory
02546     and <span class="keywordflow">return</span>.
02547 
02548     N.B. This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> now more dangerous than ever:  <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> modified physical
02549     memory <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> mapped to a <span class="keyword">virtual</span> page which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">protected</span> as readonly <a class="code" href="../../d7/d1/genuedef_8c.html#a5">text</a>,
02550     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory manager will eventually bugcheck when <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> discovers that
02551     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page has been modified.
02552 
02553 Arguments:
02554 
02555     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
02556 
02557     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
02558 
02559     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
02560 
02561 Return Value:
02562 
02563     None.
02564 
02565 --*/
02566 
02567 {
02568     PDBGKD_READ_MEMORY a = &amp;m-&gt;u.ReadMemory;
02569     ULONG Length;
02570     STRING MessageHeader;
02571     PVOID VirtualAddress;
02572     PHYSICAL_ADDRESS Source;
02573     PUCHAR Destination;
02574     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> NumberBytes;
02575     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> BytesLeft;
02576 
02577     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
02578     MessageHeader.Buffer = (PCHAR)m;
02579 
02580     <span class="comment">//</span>
02581     <span class="comment">// make sure that nothing but a read memory message was transmitted</span>
02582     <span class="comment">//</span>
02583 
02584     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
02585 
02586     <span class="comment">//</span>
02587     <span class="comment">// Trim transfer count to fit in a single message</span>
02588     <span class="comment">//</span>
02589 
02590     <span class="keywordflow">if</span> (a-&gt;TransferCount &gt; (PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE))) {
02591         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
02592     } <span class="keywordflow">else</span> {
02593         Length = a-&gt;TransferCount;
02594     }
02595 
02596     <span class="comment">//</span>
02597     <span class="comment">// Since the MmDbgTranslatePhysicalAddress only maps in one physical</span>
02598     <span class="comment">// page at a time, we need to break the memory move up into smaller</span>
02599     <span class="comment">// moves which don't cross page boundaries.  There are two cases we</span>
02600     <span class="comment">// need to deal with.  The area to be moved may start and end on the</span>
02601     <span class="comment">// same page, or it may start and end on different pages (with an</span>
02602     <span class="comment">// arbitrary number of pages in between)</span>
02603     <span class="comment">//</span>
02604     Source.QuadPart = (ULONG_PTR)a-&gt;TargetBaseAddress;
02605     Destination = AdditionalData-&gt;Buffer;
02606     BytesLeft = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)Length;
02607     <span class="keywordflow">if</span>(<a class="code" href="../../d2/d1/mm_8h.html#a7">PAGE_ALIGN</a>((PUCHAR)a-&gt;TargetBaseAddress) ==
02608        <a class="code" href="../../d2/d1/mm_8h.html#a7">PAGE_ALIGN</a>((PUCHAR)(a-&gt;TargetBaseAddress)+Length)) {
02609         <span class="comment">//</span>
02610         <span class="comment">// Memory move starts and ends on the same page.</span>
02611         <span class="comment">//</span>
02612         VirtualAddress=<a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Source);
02613         <span class="keywordflow">if</span> (VirtualAddress == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02614             AdditionalData-&gt;Length = 0;
02615         } <span class="keywordflow">else</span> {
02616             AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02617                                                 Destination,
02618                                                 VirtualAddress,
02619                                                 BytesLeft
02620                                                 );
02621             BytesLeft -= AdditionalData-&gt;Length;
02622         }
02623     } <span class="keywordflow">else</span> {
02624         <span class="comment">//</span>
02625         <span class="comment">// Memory move spans page boundaries</span>
02626         <span class="comment">//</span>
02627         VirtualAddress=<a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Source);
02628         <span class="keywordflow">if</span> (VirtualAddress == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02629             AdditionalData-&gt;Length = 0;
02630         } <span class="keywordflow">else</span> {
02631             NumberBytes = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - <a class="code" href="../../d2/d1/mm_8h.html#a6">BYTE_OFFSET</a>(VirtualAddress));
02632             AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02633                                             Destination,
02634                                             VirtualAddress,
02635                                             NumberBytes
02636                                             );
02637             Source.LowPart += NumberBytes;
02638             Destination += NumberBytes;
02639             BytesLeft -= NumberBytes;
02640             <span class="keywordflow">while</span>(BytesLeft &gt; 0) {
02641                 <span class="comment">//</span>
02642                 <span class="comment">// Transfer a full page or the last bit,</span>
02643                 <span class="comment">// whichever is smaller.</span>
02644                 <span class="comment">//</span>
02645                 VirtualAddress = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Source);
02646                 <span class="keywordflow">if</span> (VirtualAddress == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02647                     <span class="keywordflow">break</span>;
02648                 } <span class="keywordflow">else</span> {
02649                     NumberBytes = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) ((<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> &lt; BytesLeft) ? <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> : BytesLeft);
02650                     AdditionalData-&gt;Length += (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02651                                                     Destination,
02652                                                     VirtualAddress,
02653                                                     NumberBytes
02654                                                     );
02655                     Source.LowPart += NumberBytes;
02656                     Destination += NumberBytes;
02657                     BytesLeft -= NumberBytes;
02658                 }
02659             }
02660         }
02661     }
02662 
02663     <span class="keywordflow">if</span> (Length == AdditionalData-&gt;Length) {
02664         m-&gt;ReturnStatus = STATUS_SUCCESS;
02665     } <span class="keywordflow">else</span> {
02666         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
02667     }
02668     a-&gt;ActualBytesRead = AdditionalData-&gt;Length;
02669 
02670     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
02671                   PACKET_TYPE_KD_STATE_MANIPULATE,
02672                   &amp;MessageHeader,
02673                   AdditionalData
02674                   );
02675     UNREFERENCED_PARAMETER(Context);
02676 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="kdp.h::KdpReadVirtualMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadVirtualMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01139">1139</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>01147                    :
01148 
01149     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response to a read <span class="keyword">virtual</span> memory 32-bit
01150     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read <span class="keyword">virtual</span> memory
01151     and <span class="keywordflow">return</span>.
01152 
01153 Arguments:
01154 
01155     m - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01156 
01157     AdditionalData - Supplies a pointer to a descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data to read.
01158 
01159     Context - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01160 
01161 Return Value:
01162 
01163     None.
01164 
01165 --*/
01166 
01167 {
01168 
01169     ULONG Length;
01170     STRING MessageHeader;
01171 
01172     <span class="comment">//</span>
01173     <span class="comment">// Trim the transfer count to fit in a single message.</span>
01174     <span class="comment">//</span>
01175 
01176     Length = m-&gt;u.ReadMemory.TransferCount;
01177     <span class="keywordflow">if</span> (Length &gt; (PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE))) {
01178         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01179     }
01180 
01181     <span class="comment">//</span>
01182     <span class="comment">// Move the data to the destination buffer.</span>
01183     <span class="comment">//</span>
01184 
01185     AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(AdditionalData-&gt;Buffer,
01186                                                    m-&gt;u.ReadMemory.TargetBaseAddress,
01187                                                    Length);
01188 
01189     <span class="comment">//</span>
01190     <span class="comment">// If all the data is read, then return a success status. Otherwise,</span>
01191     <span class="comment">// return unsuccessful.</span>
01192     <span class="comment">//</span>
01193 
01194     m-&gt;ReturnStatus = STATUS_SUCCESS;
01195     <span class="keywordflow">if</span> (Length != AdditionalData-&gt;Length) {
01196         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01197     }
01198 
01199     <span class="comment">//</span>
01200     <span class="comment">// Set the actual number of bytes read, initialize the message header,</span>
01201     <span class="comment">// and send the reply packet to the host debugger.</span>
01202     <span class="comment">//</span>
01203 
01204     m-&gt;u.ReadMemory.ActualBytesRead = AdditionalData-&gt;Length;
01205     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01206     MessageHeader.Buffer = (PCHAR)m;
01207     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(PACKET_TYPE_KD_STATE_MANIPULATE,
01208                   &amp;MessageHeader,
01209                   AdditionalData);
01210 
01211     <span class="keywordflow">return</span>;
01212 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a110" doxytag="kdp.h::KdpReadVirtualMemory64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReadVirtualMemory64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01215">1215</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/ppc_2debugsup_8c-source.html#l00156">MmDbgReadCheck64()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.
<p>
<pre class="fragment"><div>01223                    :
01224 
01225     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a read <span class="keyword">virtual</span> memory 64-bit
01226     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read <span class="keyword">virtual</span> memory
01227     and <span class="keywordflow">return</span>.
01228 
01229 Arguments:
01230 
01231     m - Supplies a pointer to a state manipulation message.
01232 
01233     AdditionalData - Supplies a pointer to descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data to read.
01234 
01235     Context - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01236 
01237 Return Value:
01238 
01239     None.
01240 
01241 --*/
01242 
01243 {
01244 
01245     UCHAR * POINTER_64 Address;
01246     PUCHAR Destination;
01247     ULONG Length;
01248     STRING MessageHeader;
01249     UCHAR * POINTER_64 Source;
01250 
01251     <span class="comment">//</span>
01252     <span class="comment">// Trim the transfer count to fit in a single message.</span>
01253     <span class="comment">//</span>
01254 
01255     Length = m-&gt;u.ReadMemory64.TransferCount;
01256     <span class="keywordflow">if</span> (Length &gt; (PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE))) {
01257         Length = PACKET_MAX_SIZE - <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01258     }
01259 
01260     <span class="comment">//</span>
01261     <span class="comment">// Move the data to the destination buffer.</span>
01262     <span class="comment">//</span>
01263 
01264     AdditionalData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)Length;
01265 
01266 <span class="preprocessor">#if defined(_MIPS_) || defined(_ALPHA_)</span>
01267 <span class="preprocessor"></span>
01268     Destination = AdditionalData-&gt;Buffer;
01269     Source = (UCHAR * POINTER_64)m-&gt;u.ReadMemory64.TargetBaseAddress;
01270     <span class="keywordflow">while</span> (Length &gt; 0) {
01271         <span class="keywordflow">if</span> ((Address = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a2">MmDbgReadCheck64</a>(Source)) == NULL64) {
01272             <span class="keywordflow">break</span>;
01273         }
01274 
01275         *Destination++ = *Address;
01276         Source += 1;
01277         Length -= 1;
01278     }
01279 
01280 <span class="preprocessor">#endif</span>
01281 <span class="preprocessor"></span>
01282     <span class="comment">//</span>
01283     <span class="comment">// If all the data is read, then return a success status. Otherwise,</span>
01284     <span class="comment">// return an unsuccessful status.</span>
01285     <span class="comment">//</span>
01286 
01287     m-&gt;ReturnStatus = STATUS_SUCCESS;
01288     <span class="keywordflow">if</span> (Length != 0) {
01289         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01290     }
01291 
01292     <span class="comment">//</span>
01293     <span class="comment">// Set the actual number of bytes read, initialize the message header,</span>
01294     <span class="comment">// and send the reply packet to the host debugger.</span>
01295     <span class="comment">//</span>
01296 
01297     m-&gt;u.ReadMemory64.ActualBytesRead = AdditionalData-&gt;Length - Length;
01298     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01299     MessageHeader.Buffer = (PCHAR)m;
01300     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(PACKET_TYPE_KD_STATE_MANIPULATE,
01301                   &amp;MessageHeader,
01302                   AdditionalData);
01303 
01304     <span class="keywordflow">return</span>;
01305 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="kdp.h::KdpReboot" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpReboot           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/alpha_2kdreboot_8c-source.html#l00025">25</a> of file <a class="el" href="../../d1/d7/alpha_2kdreboot_8c-source.html">alpha/kdreboot.c</a>.
<p>
<pre class="fragment"><div>00031                    :
00032 
00033     Reboot <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system via <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Hal.
00034 
00035 --*/
00036 
00037 {
00038 
00039     <a class="code" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware</a>(HalRebootRoutine);
00040 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="kdp.h::KdpReceivePacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KdpReceivePacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ExpectedPacketType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageHeader</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DataLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00342">342</a> of file <a class="el" href="../../d0/d4/kdcomio_8c-source.html">kdcomio.c</a>.
<p>
<pre class="fragment"><div>00351                    :
00352 
00353     This routine receives a packet from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host machine that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> running
00354     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel debugger <a class="code" href="../../d1/d9/icmui_8def.html#a6">UI</a>.  This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> ALWAYS called after packet being
00355     sent by caller.  It first waits <span class="keywordflow">for</span> ACK packet <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> packet sent and
00356     then waits <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> packet desired.
00357 
00358     N.B. If caller <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> KdPrintString, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parameter PacketType <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00359        PACKET_TYPE_KD_ACKNOWLEDGE.  In <span class="keyword">this</span> <span class="keywordflow">case</span>, <span class="keyword">this</span> routine will <span class="keywordflow">return</span>
00360        right after <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ack packet <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> received.
00361 
00362 Arguments:
00363 
00364     PacketType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of packet that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> excepted.
00365 
00366     MessageHeader - Supplies a pointer to a string descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input
00367         message.
00368 
00369     MessageData - Supplies a pointer to a string descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
00370 
00371     DataLength - Supplies pointer to ULONG to receive length of recv. data.
00372 
00373 Return Value:
00374 
00375     <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a> - <span class="keywordflow">if</span> resend <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> required.
00376     KDP_PAKCET_TIMEOUT - <span class="keywordflow">if</span> timeout.
00377     <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a> - <span class="keywordflow">if</span> packet received.
00378 
00379 --*/
00380 
00381 {
00382 
00383     UCHAR Input;
00384     ULONG MessageLength;
00385     KD_PACKET PacketHeader;
00386     ULONG ReturnCode;
00387     ULONG Checksum;
00388 
00389 WaitForPacketLeader:
00390 
00391     <span class="comment">//</span>
00392     <span class="comment">// Read Packet Leader</span>
00393     <span class="comment">//</span>
00394 
00395     ReturnCode = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a148">KdpReceivePacketLeader</a>(PacketType, &amp;PacketHeader.PacketLeader);
00396 
00397     <span class="comment">//</span>
00398     <span class="comment">// If we can successfully read packet leader, it has high possibility that</span>
00399     <span class="comment">// kernel debugger is alive.  So reset count.</span>
00400     <span class="comment">//</span>
00401 
00402     <span class="keywordflow">if</span> (ReturnCode != <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>) {
00403         <a class="code" href="../../d8/d5/kddata_8c.html#a88">KdpNumberRetries</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a87">KdpRetryCount</a>;
00404     }
00405     <span class="keywordflow">if</span> (ReturnCode != <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>) {
00406         <span class="keywordflow">return</span> ReturnCode;
00407     }
00408 
00409     <span class="comment">//</span>
00410     <span class="comment">// Read packet type.</span>
00411     <span class="comment">//</span>
00412 
00413     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>((PCHAR)&amp;PacketHeader.PacketType,
00414                                   <span class="keyword">sizeof</span>(PacketHeader.PacketType));
00415     <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a1">CP_GET_NODATA</a>) {
00416         <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>;
00417     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a2">CP_GET_ERROR</a>) {
00418         <span class="keywordflow">if</span> (PacketHeader.PacketLeader == CONTROL_PACKET_LEADER) {
00419 
00420             <span class="comment">//</span>
00421             <span class="comment">// If read error and it is for a control packet, simply</span>
00422             <span class="comment">// preptend that we have not seen this packet.  Hopefully</span>
00423             <span class="comment">// we will receive the packet we desire which automatically acks</span>
00424             <span class="comment">// the packet we just sent.</span>
00425             <span class="comment">//</span>
00426 
00427             <span class="keywordflow">goto</span> WaitForPacketLeader;
00428         } <span class="keywordflow">else</span> {
00429 
00430             <span class="comment">//</span>
00431             <span class="comment">// if read error while reading data packet, we have to ask</span>
00432             <span class="comment">// kernel debugger to resend us the packet.</span>
00433             <span class="comment">//</span>
00434 
00435             <span class="keywordflow">goto</span> SendResendPacket;
00436         }
00437     }
00438 
00439     <span class="comment">//</span>
00440     <span class="comment">// if the packet we received is a resend request, we return true and</span>
00441     <span class="comment">// let caller resend the packet.</span>
00442     <span class="comment">//</span>
00443 
00444     <span class="keywordflow">if</span> ( PacketHeader.PacketLeader == CONTROL_PACKET_LEADER &amp;&amp;
00445          PacketHeader.PacketType == PACKET_TYPE_KD_RESEND ) {
00446         <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>;
00447     }
00448 
00449     <span class="comment">//</span>
00450     <span class="comment">// Read data length.</span>
00451     <span class="comment">//</span>
00452 
00453     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>((PCHAR)&amp;PacketHeader.ByteCount,
00454                                   <span class="keyword">sizeof</span>(PacketHeader.ByteCount));
00455     <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a1">CP_GET_NODATA</a>) {
00456         <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>;
00457     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a2">CP_GET_ERROR</a>) {
00458         <span class="keywordflow">if</span> (PacketHeader.PacketLeader == CONTROL_PACKET_LEADER) {
00459             <span class="keywordflow">goto</span> WaitForPacketLeader;
00460         } <span class="keywordflow">else</span> {
00461             <span class="keywordflow">goto</span> SendResendPacket;
00462         }
00463     }
00464 
00465     <span class="comment">//</span>
00466     <span class="comment">// Read Packet Id.</span>
00467     <span class="comment">//</span>
00468 
00469     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>((PCHAR)&amp;PacketHeader.PacketId,
00470                                   <span class="keyword">sizeof</span>(PacketHeader.PacketId));
00471 
00472     <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a1">CP_GET_NODATA</a>) {
00473         <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>;
00474     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a2">CP_GET_ERROR</a>) {
00475         <span class="keywordflow">if</span> (PacketHeader.PacketLeader == CONTROL_PACKET_LEADER) {
00476             <span class="keywordflow">goto</span> WaitForPacketLeader;
00477         } <span class="keywordflow">else</span> {
00478             <span class="keywordflow">goto</span> SendResendPacket;
00479         }
00480     }
00481 
00482     <span class="comment">//</span>
00483     <span class="comment">// Read packet checksum.</span>
00484     <span class="comment">//</span>
00485 
00486     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>((PCHAR)&amp;PacketHeader.Checksum,
00487                                   <span class="keyword">sizeof</span>(PacketHeader.Checksum));
00488     <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a1">CP_GET_NODATA</a>) {
00489         <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>;
00490     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a2">CP_GET_ERROR</a>) {
00491         <span class="keywordflow">if</span> (PacketHeader.PacketLeader == CONTROL_PACKET_LEADER) {
00492             <span class="keywordflow">goto</span> WaitForPacketLeader;
00493         } <span class="keywordflow">else</span> {
00494             <span class="keywordflow">goto</span> SendResendPacket;
00495         }
00496     }
00497 
00498     <span class="comment">//</span>
00499     <span class="comment">// A complete packet header is received.  Check its validity and</span>
00500     <span class="comment">// perform appropriate action depending on packet type.</span>
00501     <span class="comment">//</span>
00502 
00503     <span class="keywordflow">if</span> (PacketHeader.PacketLeader == CONTROL_PACKET_LEADER ) {
00504         <span class="keywordflow">if</span> (PacketHeader.PacketType == PACKET_TYPE_KD_ACKNOWLEDGE ) {
00505 
00506             <span class="comment">//</span>
00507             <span class="comment">// If we received an expected ACK packet and we are not</span>
00508             <span class="comment">// waiting for any new packet, update outgoing packet id</span>
00509             <span class="comment">// and return.  If we are NOT waiting for ACK packet</span>
00510             <span class="comment">// we will keep on waiting.  If the ACK packet</span>
00511             <span class="comment">// is not for the packet we send, ignore it and keep on waiting.</span>
00512             <span class="comment">//</span>
00513 
00514             <span class="keywordflow">if</span> (PacketHeader.PacketId !=
00515                 (<a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> &amp; ~SYNC_PACKET_ID))  {
00516                 <span class="keywordflow">goto</span> WaitForPacketLeader;
00517             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PacketType == PACKET_TYPE_KD_ACKNOWLEDGE) {
00518                 <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> ^= 1;
00519                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>;
00520             } <span class="keywordflow">else</span> {
00521                 <span class="keywordflow">goto</span> WaitForPacketLeader;
00522             }
00523         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PacketHeader.PacketType == PACKET_TYPE_KD_RESET) {
00524 
00525             <span class="comment">//</span>
00526             <span class="comment">// if we received Reset packet, reset the packet control variables</span>
00527             <span class="comment">// and resend earlier packet.</span>
00528             <span class="comment">//</span>
00529 
00530             <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> = INITIAL_PACKET_ID;
00531             <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a> = INITIAL_PACKET_ID;
00532             <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_RESET, 0L);
00533             <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>;
00534         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PacketHeader.PacketType == PACKET_TYPE_KD_RESEND) {
00535             <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>;
00536         } <span class="keywordflow">else</span> {
00537 
00538             <span class="comment">//</span>
00539             <span class="comment">// Invalid packet header, ignore it.</span>
00540             <span class="comment">//</span>
00541 
00542             <span class="keywordflow">goto</span> WaitForPacketLeader;
00543         }
00544 
00545     <span class="comment">//</span>
00546     <span class="comment">// The packet header is for data packet (not control packet).</span>
00547     <span class="comment">//</span>
00548 
00549     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PacketType == PACKET_TYPE_KD_ACKNOWLEDGE) {
00550 
00551         <span class="comment">//</span>
00552         <span class="comment">// if we are waiting for ACK packet ONLY</span>
00553         <span class="comment">// and we receive a data packet header, check if the packet id</span>
00554         <span class="comment">// is what we expected.  If yes, assume the acknowledge is lost (but</span>
00555         <span class="comment">// sent), ask sender to resend and return with PACKET_RECEIVED.</span>
00556         <span class="comment">//</span>
00557 
00558         <span class="keywordflow">if</span> (PacketHeader.PacketId == <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a>) {
00559             <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_RESEND, 0L);
00560             <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> ^= 1;
00561             <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>;
00562         } <span class="keywordflow">else</span> {
00563             <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_ACKNOWLEDGE,
00564                                  PacketHeader.PacketId
00565                                  );
00566             <span class="keywordflow">goto</span> WaitForPacketLeader;
00567         }
00568     }
00569 
00570     <span class="comment">//</span>
00571     <span class="comment">// we are waiting for data packet and we received the packet header</span>
00572     <span class="comment">// for data packet. Perform the following checkings to make sure</span>
00573     <span class="comment">// it is the packet we are waiting for.</span>
00574     <span class="comment">//</span>
00575 
00576     <span class="comment">//</span>
00577     <span class="comment">// Check ByteCount received is valid</span>
00578     <span class="comment">//</span>
00579 
00580     MessageLength = MessageHeader-&gt;MaximumLength;
00581     <span class="keywordflow">if</span> ((PacketHeader.ByteCount &gt; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)PACKET_MAX_SIZE) ||
00582         (PacketHeader.ByteCount &lt; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)MessageLength)) {
00583         <span class="keywordflow">goto</span> SendResendPacket;
00584     }
00585     *DataLength = PacketHeader.ByteCount - MessageLength;
00586 
00587     <span class="comment">//</span>
00588     <span class="comment">// Read the message header.</span>
00589     <span class="comment">//</span>
00590 
00591     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>(MessageHeader-&gt;Buffer, MessageLength);
00592     <span class="keywordflow">if</span> (ReturnCode != <a class="code" href="../../d7/d3/kd_8h.html#a0">CP_GET_SUCCESS</a>) {
00593         <span class="keywordflow">goto</span> SendResendPacket;
00594     }
00595     MessageHeader-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)MessageLength;
00596 
00597     <span class="comment">//</span>
00598     <span class="comment">// Read the message data.</span>
00599     <span class="comment">//</span>
00600 
00601     ReturnCode = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a1">KdpReceiveString</a>(MessageData-&gt;Buffer, *DataLength);
00602     <span class="keywordflow">if</span> (ReturnCode != <a class="code" href="../../d7/d3/kd_8h.html#a0">CP_GET_SUCCESS</a>) {
00603         <span class="keywordflow">goto</span> SendResendPacket;
00604     }
00605     MessageData-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)*DataLength;
00606 
00607     <span class="comment">//</span>
00608     <span class="comment">// Read packet trailing byte</span>
00609     <span class="comment">//</span>
00610 
00611     ReturnCode = <a class="code" href="../../d2/d7/hal_8h.html#a200">KdPortGetByte</a>(&amp;Input);
00612     <span class="keywordflow">if</span> (ReturnCode != <a class="code" href="../../d7/d3/kd_8h.html#a0">CP_GET_SUCCESS</a> || Input != PACKET_TRAILING_BYTE) {
00613         <span class="keywordflow">goto</span> SendResendPacket;
00614     }
00615 
00616     <span class="comment">//</span>
00617     <span class="comment">// Check PacketType is what we are waiting for.</span>
00618     <span class="comment">//</span>
00619 
00620     <span class="keywordflow">if</span> (PacketType != PacketHeader.PacketType) {
00621         <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_ACKNOWLEDGE,
00622                              PacketHeader.PacketId
00623                              );
00624         <span class="keywordflow">goto</span> WaitForPacketLeader;
00625     }
00626 
00627     <span class="comment">//</span>
00628     <span class="comment">// Check PacketId is valid.</span>
00629     <span class="comment">//</span>
00630 
00631     <span class="keywordflow">if</span> (PacketHeader.PacketId == INITIAL_PACKET_ID ||
00632         PacketHeader.PacketId == (INITIAL_PACKET_ID ^ 1)) {
00633         <span class="keywordflow">if</span> (PacketHeader.PacketId != <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a>) {
00634             <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_ACKNOWLEDGE,
00635                                  PacketHeader.PacketId
00636                                  );
00637             <span class="keywordflow">goto</span> WaitForPacketLeader;
00638         }
00639     } <span class="keywordflow">else</span> {
00640         <span class="keywordflow">goto</span> SendResendPacket;
00641     }
00642 
00643     <span class="comment">//</span>
00644     <span class="comment">// Check checksum is valid.</span>
00645     <span class="comment">//</span>
00646 
00647     Checksum = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a0">KdpComputeChecksum</a>(
00648                             MessageHeader-&gt;Buffer,
00649                             MessageHeader-&gt;Length
00650                             );
00651 
00652     Checksum += <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a0">KdpComputeChecksum</a>(
00653                             MessageData-&gt;Buffer,
00654                             MessageData-&gt;Length
00655                             );
00656     <span class="keywordflow">if</span> (Checksum != PacketHeader.Checksum) {
00657         <span class="keywordflow">goto</span> SendResendPacket;
00658     }
00659 
00660     <span class="comment">//</span>
00661     <span class="comment">// Send Acknowledge byte and the Id of the packet received.</span>
00662     <span class="comment">// Then, update the ExpectId for next incoming packet.</span>
00663     <span class="comment">//</span>
00664 
00665     <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_ACKNOWLEDGE,
00666                          PacketHeader.PacketId
00667                          );
00668 
00669     <span class="comment">//</span>
00670     <span class="comment">// We have successfully received the packet so update the</span>
00671     <span class="comment">// packet control variables and return sucess.</span>
00672     <span class="comment">//</span>
00673 
00674     <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a> ^= 1;
00675     <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>;
00676 
00677 SendResendPacket:
00678     <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a3">KdpSendControlPacket</a>(PACKET_TYPE_KD_RESEND, 0L);
00679     <span class="keywordflow">goto</span> WaitForPacketLeader;
00680 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a135" doxytag="kdp.h::KdpReceivePacketLeader" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> KdpReceivePacketLeader           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PacketType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PacketLeader</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00095">95</a> of file <a class="el" href="../../d0/d4/kdcomio_8c-source.html">kdcomio.c</a>.
<p>
<pre class="fragment"><div>00102                    :
00103 
00104     This routine waits <span class="keywordflow">for</span> a packet header leader.
00105 
00106 Arguments:
00107 
00108     PacketType - supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of packet we are expecting.
00109 
00110     PacketLeader - supplies a pointer to a ulong variable to receive
00111                    packet leader bytes.
00112 
00113 Return Value:
00114 
00115     <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a> - <span class="keywordflow">if</span> resend <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> required.
00116     KDP_PAKCET_TIMEOUT - <span class="keywordflow">if</span> timeout.
00117     <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a> - <span class="keywordflow">if</span> packet received.
00118 
00119 --*/
00120 
00121 {
00122 
00123     UCHAR Input, PreviousByte = 0;
00124     ULONG PacketId = 0;
00125     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00126     ULONG ReturnCode;
00127     BOOLEAN BreakinDetected = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00128 
00129     <span class="comment">//</span>
00130     <span class="comment">// NOTE - With all the interrupts being off, it is very hard</span>
00131     <span class="comment">// to implement the actual timeout code. (Maybe, by reading the CMOS.)</span>
00132     <span class="comment">// Here we use a loop count to wait about 3 seconds.  The CpGetByte</span>
00133     <span class="comment">// will return with error code = CP_GET_NODATA if it cannot find data</span>
00134     <span class="comment">// byte within 1 second. Kernel debugger's timeout period is 5 seconds.</span>
00135     <span class="comment">//</span>
00136 
00137     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0;
00138     <span class="keywordflow">do</span> {
00139         ReturnCode = <a class="code" href="../../d2/d7/hal_8h.html#a200">KdPortGetByte</a>(&amp;Input);
00140         <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a1">CP_GET_NODATA</a>) {
00141             <span class="keywordflow">if</span> (BreakinDetected) {
00142                 <a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00143                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a11">KDP_PACKET_RESEND</a>;
00144             } <span class="keywordflow">else</span> {
00145                 <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>;
00146             }
00147         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d7/d3/kd_8h.html#a2">CP_GET_ERROR</a>) {
00148             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0;
00149             <span class="keywordflow">continue</span>;
00150         } <span class="keywordflow">else</span> {                    <span class="comment">// if (ReturnCode == CP_GET_SUCCESS)</span>
00151             <span class="keywordflow">if</span> ( Input == PACKET_LEADER_BYTE ||
00152                  Input == CONTROL_PACKET_LEADER_BYTE ) {
00153                 <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> == 0 ) {
00154                     PreviousByte = Input;
00155                     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++;
00156                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Input == PreviousByte ) {
00157                     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++;
00158                 } <span class="keywordflow">else</span> {
00159                     PreviousByte = Input;
00160                     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 1;
00161                 }
00162             } <span class="keywordflow">else</span> {
00163 
00164                 <span class="comment">//</span>
00165                 <span class="comment">// If we detect breakin character, we need to verify it</span>
00166                 <span class="comment">// validity.  (It is possible that we missed a packet leader</span>
00167                 <span class="comment">// and the breakin character is simply a data byte in the</span>
00168                 <span class="comment">// packet.)</span>
00169                 <span class="comment">// Since kernel debugger send out breakin character ONLY</span>
00170                 <span class="comment">// when it is waiting for State Change packet.  The breakin</span>
00171                 <span class="comment">// character should not be followed by any other character</span>
00172                 <span class="comment">// except packet leader byte.</span>
00173                 <span class="comment">//</span>
00174 
00175                 <span class="keywordflow">if</span> ( Input == BREAKIN_PACKET_BYTE ) {
00176                     BreakinDetected = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00177                 } <span class="keywordflow">else</span> {
00178 
00179                     <span class="comment">//</span>
00180                     <span class="comment">// The following statement is ABSOLUTELY necessary.</span>
00181                     <span class="comment">//</span>
00182 
00183                     BreakinDetected = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00184                 }
00185                 <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0;
00186             }
00187         }
00188     } <span class="keywordflow">while</span> ( <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; 4 );
00189 
00190     <span class="keywordflow">if</span> (BreakinDetected) {
00191         <a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00192     }
00193 
00194     <span class="comment">//</span>
00195     <span class="comment">// return the packet leader and FALSE to indicate no resend is needed.</span>
00196     <span class="comment">//</span>
00197 
00198     <span class="keywordflow">if</span> ( Input == PACKET_LEADER_BYTE ) {
00199         *PacketLeader = PACKET_LEADER;
00200     } <span class="keywordflow">else</span> {
00201         *PacketLeader = CONTROL_PACKET_LEADER;
00202     }
00203 
00204     <a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00205     <span class="keywordflow">return</span> <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>;
00206 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="kdp.h::KdpReportExceptionStateChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpReportExceptionStateChange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SecondChance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02351">2351</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
<pre class="fragment"><div>02359                    :
02360 
02361     This routine sends an exception state change packet to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel
02362     debugger and waits <span class="keywordflow">for</span> a manipulate state message.
02363 
02364 Arguments:
02365 
02366     ExceptionRecord - Supplies a pointer to an exception record.
02367 
02368     ContextRecord - Supplies a pointer to a context record.
02369 
02370     SecondChance - Supplies a <span class="keywordtype">boolean</span> value that determines whether <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02371         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first or second chance <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
02372 
02373 Return Value:
02374 
02375     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> handled. Otherwise, a
02376     value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02377 
02378 --*/
02379 
02380 {
02381     STRING MessageData;
02382     STRING MessageHeader;
02383     DBGKD_WAIT_STATE_CHANGE WaitStateChange;
02384     <a class="code" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02385 
02386 <span class="preprocessor">#if i386</span>
02387 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/4_2i386_2kdtrap_8c.html#a3">KdpCheckTracePoint</a>(ExceptionRecord,ContextRecord)) <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02388 <span class="preprocessor">#endif</span>
02389 <span class="preprocessor"></span>
02390     <span class="keywordflow">do</span> {
02391 
02392         <span class="comment">//</span>
02393         <span class="comment">// Construct the wait state change message and message descriptor.</span>
02394         <span class="comment">//</span>
02395 
02396         <a class="code" href="../../d1/d7/4_2kdp_8h.html#a114">KdpSetStateChange</a>(&amp;WaitStateChange,
02397                             ExceptionRecord,
02398                             ContextRecord,
02399                             SecondChance
02400                             );
02401 
02402         MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_WAIT_STATE_CHANGE);
02403         MessageHeader.Buffer = (PCHAR)&amp;WaitStateChange;
02404 
02405 <span class="preprocessor">#if i386</span>
02406 <span class="preprocessor"></span>        <span class="comment">//</span>
02407         <span class="comment">// Construct the wait state change data and data descriptor.</span>
02408         <span class="comment">//</span>
02409 
02410         DumpTraceData(&amp;MessageData);
02411 <span class="preprocessor">#else</span>
02412 <span class="preprocessor"></span>        MessageData.Length = 0;
02413 <span class="preprocessor">#endif</span>
02414 <span class="preprocessor"></span>
02415         <span class="comment">//</span>
02416         <span class="comment">// Send packet to the kernel debugger on the host machine,</span>
02417         <span class="comment">// wait for answer.</span>
02418         <span class="comment">//</span>
02419 
02420         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a122">KdpSendWaitContinue</a>(
02421                     PACKET_TYPE_KD_STATE_CHANGE,
02422                     &amp;MessageHeader,
02423                     &amp;MessageData,
02424                     ContextRecord
02425                     );
02426 
02427     } <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == <a class="code" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>) ;
02428 
02429     <span class="keywordflow">return</span> (BOOLEAN) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02430 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="kdp.h::KdpReportLoadSymbolsStateChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpReportLoadSymbolsStateChange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>PathName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SymbolInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>UnloadSymbols</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02434">2434</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
<pre class="fragment"><div>02443                    :
02444 
02445     This routine sends a load symbols state change packet to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel
02446     debugger and waits <span class="keywordflow">for</span> a manipulate state message.
02447 
02448 Arguments:
02449 
02450     PathName - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pathname of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> image whose
02451         symbols are to be loaded.
02452 
02453     BaseOfDll - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address where <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> image was loaded.
02454 
02455     ProcessId - Unique 32-bit identifier <span class="keywordflow">for</span> process that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">using</span>
02456         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> symbols.  -1 <span class="keywordflow">for</span> system process.
02457 
02458     CheckSum - Unique 32-bit identifier from image header.
02459 
02460     UnloadSymbol - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> symbols that were previously loaded <span class="keywordflow">for</span>
02461         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> named image are to be unloaded from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debugger.
02462 
02463 Return Value:
02464 
02465     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> handled. Otherwise, a
02466     value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02467 
02468 --*/
02469 
02470 {
02471 
02472     PSTRING AdditionalData;
02473     STRING MessageData;
02474     STRING MessageHeader;
02475     DBGKD_WAIT_STATE_CHANGE WaitStateChange;
02476     <a class="code" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02477 
02478     <span class="keywordflow">do</span> {
02479         <span class="comment">//</span>
02480         <span class="comment">// Construct the wait state change message and message descriptor.</span>
02481         <span class="comment">//</span>
02482 
02483         WaitStateChange.NewState = DbgKdLoadSymbolsStateChange;
02484         WaitStateChange.ProcessorLevel = <a class="code" href="../../d4/d9/ke_8h.html#a135">KeProcessorLevel</a>;
02485         WaitStateChange.Processor = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number;
02486         WaitStateChange.NumberProcessors = (ULONG)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>;
02487         WaitStateChange.Thread = (PVOID)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
02488         WaitStateChange.ProgramCounter = (PVOID)CONTEXT_TO_PROGRAM_COUNTER(ContextRecord);
02489         <a class="code" href="../../d1/d7/4_2kdp_8h.html#a113">KdpSetLoadState</a>(&amp;WaitStateChange, ContextRecord);
02490         WaitStateChange.u.LoadSymbols.UnloadSymbols = UnloadSymbols;
02491         WaitStateChange.u.LoadSymbols.BaseOfDll = SymbolInfo-&gt;BaseOfDll;
02492         WaitStateChange.u.LoadSymbols.ProcessId = (ULONG)SymbolInfo-&gt;ProcessId;
02493         WaitStateChange.u.LoadSymbols.CheckSum = SymbolInfo-&gt;CheckSum;
02494         WaitStateChange.u.LoadSymbols.SizeOfImage = SymbolInfo-&gt;SizeOfImage;
02495         <span class="keywordflow">if</span> (ARGUMENT_PRESENT( PathName )) {
02496             WaitStateChange.u.LoadSymbols.PathNameLength =
02497                 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02498                     (PCHAR)KdpPathBuffer,
02499                     (PCHAR)PathName-&gt;Buffer,
02500                     PathName-&gt;Length
02501                     ) + 1;
02502 
02503             MessageData.Buffer = <a class="code" href="../../d8/d5/kddata_8c.html#a53">KdpPathBuffer</a>;
02504             MessageData.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)WaitStateChange.u.LoadSymbols.PathNameLength;
02505             MessageData.Buffer[MessageData.Length-1] = <span class="charliteral">'\0'</span>;
02506             AdditionalData = &amp;MessageData;
02507         } <span class="keywordflow">else</span> {
02508             WaitStateChange.u.LoadSymbols.PathNameLength = 0;
02509             AdditionalData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02510         }
02511 
02512         MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_WAIT_STATE_CHANGE);
02513         MessageHeader.Buffer = (PCHAR)&amp;WaitStateChange;
02514 
02515         <span class="comment">//</span>
02516         <span class="comment">// Send packet to the kernel debugger on the host machine, wait</span>
02517         <span class="comment">// for the reply.</span>
02518         <span class="comment">//</span>
02519 
02520         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a122">KdpSendWaitContinue</a>(
02521                     PACKET_TYPE_KD_STATE_CHANGE,
02522                     &amp;MessageHeader,
02523                     AdditionalData,
02524                     ContextRecord
02525                     );
02526 
02527     } <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == <a class="code" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>);
02528 
02529     <span class="keywordflow">return</span> (BOOLEAN) <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02530 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a127" doxytag="kdp.h::KdpRestoreAllBreakpoints" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpRestoreAllBreakpoints           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l01309">1309</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>01312 {
01313     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01314 
01315     <a class="code" href="../../d8/d5/kddata_8c.html#a86">BreakpointsSuspended</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01316 
01317     <span class="keywordflow">for</span> ( <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++ ) {
01318 
01319         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>) &amp;&amp;
01320             (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>) ) {
01321 
01322             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp;= ~<a class="code" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>;
01323             <a class="code" href="../../d1/d4/4_2kdbreak_8c.html#a9">KdpLowRestoreBreakpoint</a>(Index);
01324         }
01325     }
01326 
01327     <span class="keywordflow">return</span>;
01328 
01329 } <span class="comment">// KdpRestoreAllBreakpoints</span>
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a118" doxytag="kdp.h::KdpRestoreBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpRestoreBreakpoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01632">1632</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00826">KdpDeleteBreakpoint()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>01640                    :
01641 
01642     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a restore breakpoint state
01643     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to restore a breakpoint
01644     <span class="keyword">using</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle.
01645 
01646 Arguments:
01647 
01648     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01649 
01650     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01651 
01652     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01653 
01654 Return Value:
01655 
01656     None.
01657 
01658 --*/
01659 
01660 {
01661     PDBGKD_RESTORE_BREAKPOINT a = &amp;m-&gt;u.RestoreBreakPoint;
01662     STRING MessageHeader;
01663 
01664     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01665     MessageHeader.Buffer = (PCHAR)m;
01666 
01667     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
01668     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a105">KdpDeleteBreakpoint</a>(a-&gt;BreakPointHandle)) {
01669         m-&gt;ReturnStatus = STATUS_SUCCESS;
01670     } <span class="keywordflow">else</span> {
01671         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01672     }
01673     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01674                   PACKET_TYPE_KD_STATE_MANIPULATE,
01675                   &amp;MessageHeader,
01676                   NULL
01677                   );
01678     UNREFERENCED_PARAMETER(Context);
01679 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="kdp.h::KdpSendPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSendPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PacketType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageHeader</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING MessageData&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">683</a> of file <a class="el" href="../../d0/d4/kdcomio_8c-source.html">kdcomio.c</a>.
<p>
<pre class="fragment"><div>00691                    :
00692 
00693     This routine sends a packet to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host machine that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> running <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00694     kernel debugger and waits <span class="keywordflow">for</span> an ACK.
00695 
00696 Arguments:
00697 
00698     PacketType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of packet to send.
00699 
00700     MessageHeader - Supplies a pointer to a string descriptor that describes
00701         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message information.
00702 
00703     MessageData - Supplies a pointer to a string descriptor that describes
00704         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> optional message data.
00705 
00706 Return Value:
00707 
00708     None.
00709 
00710 --*/
00711 
00712 {
00713 
00714     KD_PACKET PacketHeader;
00715     ULONG MessageDataLength;
00716     ULONG ReturnCode;
00717     PDBGKD_DEBUG_IO DebugIo;
00718     PDBGKD_WAIT_STATE_CHANGE StateChange;
00719 
00720     <span class="keywordflow">if</span> ( ARGUMENT_PRESENT(MessageData) ) {
00721         MessageDataLength = MessageData-&gt;Length;
00722         PacketHeader.Checksum = <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a0">KdpComputeChecksum</a>(
00723                                         MessageData-&gt;Buffer,
00724                                         MessageData-&gt;Length
00725                                         );
00726     } <span class="keywordflow">else</span> {
00727         MessageDataLength = 0;
00728         PacketHeader.Checksum = 0;
00729     }
00730 
00731     PacketHeader.Checksum += <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a0">KdpComputeChecksum</a> (
00732                                     MessageHeader-&gt;Buffer,
00733                                     MessageHeader-&gt;Length
00734                                     );
00735 
00736     <span class="comment">//</span>
00737     <span class="comment">// Initialize and send the packet header.</span>
00738     <span class="comment">//</span>
00739 
00740     PacketHeader.PacketLeader = PACKET_LEADER;
00741     PacketHeader.ByteCount = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(MessageHeader-&gt;Length + MessageDataLength);
00742     PacketHeader.PacketType = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)PacketType;
00743     <a class="code" href="../../d8/d5/kddata_8c.html#a88">KdpNumberRetries</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a87">KdpRetryCount</a>;
00744     <span class="keywordflow">do</span> {
00745         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a88">KdpNumberRetries</a> == 0) {
00746 
00747             <span class="comment">//</span>
00748             <span class="comment">// If the packet is not for reporting exception, we give up</span>
00749             <span class="comment">// and declare debugger not present.</span>
00750             <span class="comment">//</span>
00751 
00752             <span class="keywordflow">if</span> (PacketType == PACKET_TYPE_KD_DEBUG_IO) {
00753                 DebugIo = (PDBGKD_DEBUG_IO)MessageHeader-&gt;Buffer;
00754                 <span class="keywordflow">if</span> (DebugIo-&gt;ApiNumber == DbgKdPrintStringApi) {
00755                     <a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00756                     <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> = INITIAL_PACKET_ID | SYNC_PACKET_ID;
00757                     <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a> = INITIAL_PACKET_ID;
00758                     <span class="keywordflow">return</span>;
00759                 }
00760             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PacketType == PACKET_TYPE_KD_STATE_CHANGE) {
00761                 StateChange = (PDBGKD_WAIT_STATE_CHANGE)MessageHeader-&gt;Buffer;
00762                 <span class="keywordflow">if</span> (StateChange-&gt;NewState == DbgKdLoadSymbolsStateChange) {
00763                     <a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00764                     <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> = INITIAL_PACKET_ID | SYNC_PACKET_ID;
00765                     <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a> = INITIAL_PACKET_ID;
00766                     <span class="keywordflow">return</span>;
00767                 }
00768             }
00769         }
00770 
00771         <span class="comment">//</span>
00772         <span class="comment">// Setting PacketId has to be in the do loop in case Packet Id was</span>
00773         <span class="comment">// reset.</span>
00774         <span class="comment">//</span>
00775 
00776         PacketHeader.PacketId = <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a>;
00777         <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a2">KdpSendString</a>((PCHAR)&amp;PacketHeader, <span class="keyword">sizeof</span>(KD_PACKET));
00778 
00779         <span class="comment">//</span>
00780         <span class="comment">// Output message header.</span>
00781         <span class="comment">//</span>
00782 
00783         <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a2">KdpSendString</a>(MessageHeader-&gt;Buffer, MessageHeader-&gt;Length);
00784 
00785         <span class="comment">//</span>
00786         <span class="comment">// Output message data.</span>
00787         <span class="comment">//</span>
00788 
00789         <span class="keywordflow">if</span> ( MessageDataLength ) {
00790             <a class="code" href="../../d0/d5/4_2kdcomio_8c.html#a2">KdpSendString</a>(MessageData-&gt;Buffer, MessageData-&gt;Length);
00791         }
00792 
00793         <span class="comment">//</span>
00794         <span class="comment">// Output a packet trailing byte</span>
00795         <span class="comment">//</span>
00796 
00797         <a class="code" href="../../d2/d7/hal_8h.html#a202">KdPortPutByte</a>(PACKET_TRAILING_BYTE);
00798 
00799         <span class="comment">//</span>
00800         <span class="comment">// Wait for the Ack Packet</span>
00801         <span class="comment">//</span>
00802 
00803         ReturnCode = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a112">KdpReceivePacket</a>(
00804                          PACKET_TYPE_KD_ACKNOWLEDGE,
00805                          NULL,
00806                          NULL,
00807                          NULL
00808                          );
00809         <span class="keywordflow">if</span> (ReturnCode == <a class="code" href="../../d0/d7/kdp_8h.html#a10">KDP_PACKET_TIMEOUT</a>) {
00810             <a class="code" href="../../d8/d5/kddata_8c.html#a88">KdpNumberRetries</a>--;
00811         }
00812     } <span class="keywordflow">while</span> (ReturnCode != <a class="code" href="../../d0/d7/kdp_8h.html#a9">KDP_PACKET_RECEIVED</a>);
00813 
00814     <span class="comment">//</span>
00815     <span class="comment">// Reset Sync bit in packet id.  The packet we sent may have Sync bit set</span>
00816     <span class="comment">//</span>
00817 
00818     <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> &amp;= ~SYNC_PACKET_ID;
00819 
00820     <span class="comment">//</span>
00821     <span class="comment">// Since we are able to talk to debugger, the retrycount is set to</span>
00822     <span class="comment">// maximum value.</span>
00823     <span class="comment">//</span>
00824 
00825     <a class="code" href="../../d8/d5/kddata_8c.html#a87">KdpRetryCount</a> = <a class="code" href="../../d3/d7/class_8h.html#a1">MAXIMUM_RETRIES</a>;
00826 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="kdp.h::KdpSendWaitContinue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a> KdpSendWaitContinue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PacketType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageHeader</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING MessageData&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a116" doxytag="kdp.h::KdpSetContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSetContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01521">1521</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00150">KdpQuickMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>01529                    :
01530 
01531     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a set context state
01532     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
01533     context.
01534 
01535 Arguments:
01536 
01537     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01538 
01539     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01540 
01541     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01542 
01543 Return Value:
01544 
01545     None.
01546 
01547 --*/
01548 
01549 {
01550     PDBGKD_SET_CONTEXT a = &amp;m-&gt;u.SetContext;
01551     STRING MessageHeader;
01552 
01553     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01554     MessageHeader.Buffer = (PCHAR)m;
01555 
01556     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == <span class="keyword">sizeof</span>(CONTEXT));
01557 
01558     <span class="keywordflow">if</span> (m-&gt;Processor &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>) {
01559         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01560     } <span class="keywordflow">else</span> {
01561         m-&gt;ReturnStatus = STATUS_SUCCESS;
01562         <span class="keywordflow">if</span> (m-&gt;Processor == (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number) {
01563             <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a>((PCHAR)Context, AdditionalData-&gt;Buffer, <span class="keyword">sizeof</span>(CONTEXT));
01564         } <span class="keywordflow">else</span> {
01565             <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a>((PCHAR)&amp;KiProcessorBlock[m-&gt;Processor]-&gt;ProcessorState.ContextFrame,
01566                           AdditionalData-&gt;Buffer,
01567                           <span class="keyword">sizeof</span>(CONTEXT)
01568                          );
01569         }
01570     }
01571 
01572     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01573                   PACKET_TYPE_KD_STATE_MANIPULATE,
01574                   &amp;MessageHeader,
01575                   NULL
01576                   );
01577 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="kdp.h::KdpSetLoadState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSetLoadState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_WAIT_STATE_CHANGE&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitStateChange</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00036">36</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00902">KdpDeleteBreakpointRange()</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00043                    :
00044 
00045     Fill in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Wait_State_Change message record <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> load symbol <span class="keywordflow">case</span>.
00046 
00047 Arguments:
00048 
00049     WaitStateChange - Supplies pointer to record to fill in
00050 
00051     ContextRecord - Supplies a pointer to a context record.
00052 
00053 Return Value:
00054 
00055     None.
00056 
00057 --*/
00058 
00059 {
00060 
00061     ULONG <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00062     PVOID <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
00063 
00064     <span class="comment">//</span>
00065     <span class="comment">// Copy the immediate instruction stream into the control report structure.</span>
00066     <span class="comment">//</span>
00067 
00068     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> =  <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(&amp;WaitStateChange-&gt;ControlReport.InstructionStream[0],
00069                            WaitStateChange-&gt;ProgramCounter,
00070                            DBGKD_MAXSTREAM);
00071 
00072     WaitStateChange-&gt;ControlReport.InstructionCount = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00073 
00074     <span class="comment">//</span>
00075     <span class="comment">// Clear breakpoints in the copied instruction stream. If any breakpoints</span>
00076     <span class="comment">// are clear, then recopy the instruction strasm.</span>
00077     <span class="comment">//</span>
00078 
00079     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> = (PVOID)((PUCHAR)(WaitStateChange-&gt;ProgramCounter) + <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - 1);
00080     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a106">KdpDeleteBreakpointRange</a>(WaitStateChange-&gt;ProgramCounter, End) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00081         <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(&amp;WaitStateChange-&gt;ControlReport.InstructionStream[0],
00082                       WaitStateChange-&gt;ProgramCounter,
00083                       Count);
00084     }
00085 
00086     <span class="comment">//</span>
00087     <span class="comment">// Copy the context record into the wait state structure.</span>
00088     <span class="comment">//</span>
00089 
00090     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>((PCHAR)&amp;WaitStateChange-&gt;Context,
00091                   (PCHAR)ContextRecord,
00092                   <span class="keyword">sizeof</span>(*ContextRecord));
00093 
00094     <span class="keywordflow">return</span>;
00095 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="kdp.h::KdpSetStateChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSetStateChange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_WAIT_STATE_CHANGE&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitStateChange</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SecondChance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00098">98</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00902">KdpDeleteBreakpointRange()</a>, <a class="el" href="../../d2/d7/alpha_2kdpcpu_8h.html#a12">KdpGetCurrentPrcb()</a>, <a class="el" href="../../d2/d7/alpha_2kdpcpu_8h.html#a13">KdpGetCurrentThread()</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00150">KdpQuickMoveMemory()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02778">KeProcessorLevel</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00107                    :
00108 
00109     Fill in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Wait_State_Change message record.
00110 
00111 Arguments:
00112 
00113     WaitStateChange - Supplies pointer to record to fill in
00114 
00115     ExceptionRecord - Supplies a pointer to an exception record.
00116 
00117     ContextRecord - Supplies a pointer to a context record.
00118 
00119     SecondChance - Supplies a <span class="keywordtype">boolean</span> value that determines whether <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00120         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first or second chance <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
00121 
00122 Return Value:
00123 
00124     None.
00125 
00126 --*/
00127 
00128 {
00129 
00130     ULONG <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00131     PVOID <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
00132 
00133     <span class="comment">//</span>
00134     <span class="comment">// Set up description of event, including exception record</span>
00135     <span class="comment">//</span>
00136 
00137     WaitStateChange-&gt;NewState = DbgKdExceptionStateChange;
00138     WaitStateChange-&gt;ProcessorLevel = <a class="code" href="../../d4/d9/ke_8h.html#a135">KeProcessorLevel</a>;
00139     WaitStateChange-&gt;Processor = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a12">KdpGetCurrentPrcb</a>()-&gt;Number;
00140     WaitStateChange-&gt;NumberProcessors = (ULONG)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>;
00141     WaitStateChange-&gt;Thread = (PVOID)<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a13">KdpGetCurrentThread</a>();
00142     WaitStateChange-&gt;ProgramCounter = (PVOID)CONTEXT_TO_PROGRAM_COUNTER(ContextRecord);
00143     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a>((PCHAR)&amp;WaitStateChange-&gt;u.Exception.ExceptionRecord,
00144                        (PCHAR)ExceptionRecord,
00145                        <span class="keyword">sizeof</span>(EXCEPTION_RECORD));
00146 
00147     WaitStateChange-&gt;u.Exception.FirstChance = !SecondChance;
00148 
00149     <span class="comment">//</span>
00150     <span class="comment">// Copy the immediate instruction stream into the control report structure.</span>
00151     <span class="comment">//</span>
00152 
00153     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> =  <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(&amp;WaitStateChange-&gt;ControlReport.InstructionStream[0],
00154                            WaitStateChange-&gt;ProgramCounter,
00155                            DBGKD_MAXSTREAM);
00156 
00157     WaitStateChange-&gt;ControlReport.InstructionCount = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00158 
00159     <span class="comment">//</span>
00160     <span class="comment">// Clear breakpoints in the copied instruction stream. If any breakpoints</span>
00161     <span class="comment">// are clear, then recopy the instruction strasm.</span>
00162     <span class="comment">//</span>
00163 
00164     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> = (PVOID)((PUCHAR)(WaitStateChange-&gt;ProgramCounter) + <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - 1);
00165     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a106">KdpDeleteBreakpointRange</a>(WaitStateChange-&gt;ProgramCounter, End) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00166         <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(&amp;WaitStateChange-&gt;ControlReport.InstructionStream[0],
00167                       WaitStateChange-&gt;ProgramCounter,
00168                       Count);
00169     }
00170 
00171     <span class="comment">//</span>
00172     <span class="comment">// Copy the context record into the wait state structure.</span>
00173     <span class="comment">//</span>
00174 
00175     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>((PCHAR)&amp;WaitStateChange-&gt;Context,
00176                   (PCHAR)ContextRecord,
00177                   <span class="keyword">sizeof</span>(*ContextRecord));
00178 
00179     <span class="keywordflow">return</span>;
00180 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="kdp.h::KdpStub" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpStub           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PreviousMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SecondChance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html#l00386">386</a> of file <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html">alpha/kdtrap.c</a>.
<p>
<pre class="fragment"><div>00397                    :
00398 
00399     This routine provides a kernel debugger stub routine that catchs debug
00400     prints in checked systems when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel debugger <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not active.
00401 
00402 Arguments:
00403 
00404     TrapFrame - Supplies a pointer to a trap frame that describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00405         trap.
00406 
00407     ExceptionFrame - Supplies a pointer to a exception frame that describes
00408         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap.
00409 
00410     ExceptionRecord - Supplies a pointer to an exception record that
00411         describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
00412 
00413     ContextRecord - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
00414 
00415     PreviousMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous processor mode.
00416 
00417     SecondChance - Supplies a <span class="keywordtype">boolean</span> value that determines whether <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00418         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second chance (TRUE) that the exception has been raised.
00419 
00420 Return Value:
00421 
00422     A value of TRUE is returned if the exception is handled. Otherwise a
00423     value of FALSE is returned.
00424 
00425 --*/
00426 
00427 {
00428 
00429     ULONG_PTR BreakpointCode;
00430 
00431     <span class="comment">//</span>
00432     <span class="comment">// Isolate the breakpoint code from the breakpoint instruction which</span>
00433     <span class="comment">// is stored by the exception dispatch code in the information field</span>
00434     <span class="comment">// of the exception record.</span>
00435     <span class="comment">//</span>
00436 
00437     BreakpointCode = ExceptionRecord-&gt;ExceptionInformation[0];
00438 
00439     <span class="comment">//</span>
00440     <span class="comment">// If the breakpoint is a debug print, debug load symbols, or debug</span>
00441     <span class="comment">// unload symbols, then return TRUE. Otherwise, return FALSE;</span>
00442     <span class="comment">//</span>
00443 
00444     <span class="keywordflow">if</span> ((BreakpointCode == DEBUG_PRINT_BREAKPOINT) ||
00445         (BreakpointCode == DEBUG_LOAD_SYMBOLS_BREAKPOINT) ||
00446         (BreakpointCode == DEBUG_UNLOAD_SYMBOLS_BREAKPOINT) ||
00447         (BreakpointCode == <a class="code" href="../../d6/d7/halmips_8h.html#a453">KERNEL_BREAKPOINT</a>)) {
00448         ContextRecord-&gt;Fir += 4;
00449         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00450     } <span class="keywordflow">else</span> {
00451         <span class="keywordflow">if</span> ( (BreakpointCode == DEBUG_STOP_BREAKPOINT) &amp;&amp;
00452              (PreviousMode == <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>) ){
00453              ContextRecord-&gt;Fir += 4;
00454              <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00455         } <span class="keywordflow">else</span> {
00456             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00457         }
00458     }
00459 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a126" doxytag="kdp.h::KdpSuspendAllBreakpoints" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSuspendAllBreakpoints           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00972">972</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>00975 {
00976     ULONG <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00977 
00978     <a class="code" href="../../d8/d5/kddata_8c.html#a86">BreakpointsSuspended</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00979 
00980     <span class="keywordflow">for</span> ( <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> = 1; <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> &lt;= BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>++ ) {
00981         <a class="code" href="../../d1/d7/4_2kdp_8h.html#a138">KdpSuspendBreakpoint</a>(Handle);
00982     }
00983 
00984     <span class="keywordflow">return</span>;
00985 
00986 } <span class="comment">// KdpSuspendAllBreakpoints</span>
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a125" doxytag="kdp.h::KdpSuspendBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpSuspendBreakpoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00954">954</a> of file <a class="el" href="../../d1/d3/kdbreak_8c-source.html">kdbreak.c</a>.
<p>
<pre class="fragment"><div>00957 {
00958     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - 1;
00959 
00960     <span class="keywordflow">if</span> ( (<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a1">KD_BREAKPOINT_IN_USE</a>) &amp;&amp;
00961         !(<a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> &amp; <a class="code" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>) ) {
00962 
00963         <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> |= <a class="code" href="../../d0/d7/kdp_8h.html#a3">KD_BREAKPOINT_SUSPENDED</a>;
00964         <a class="code" href="../../d1/d4/4_2kdbreak_8c.html#a4">KdpLowWriteContent</a>(Index);
00965     }
00966 
00967     <span class="keywordflow">return</span>;
00968 
00969 } <span class="comment">// KdpSuspendBreakpoint</span>
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="kdp.h::KdpSwitchProcessor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpSwitchProcessor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SecondChance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02318">2318</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
<pre class="fragment"><div>02323 {
02324     BOOLEAN <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02325 
02326     <span class="comment">//</span>
02327     <span class="comment">// Save port state</span>
02328     <span class="comment">//</span>
02329 
02330     <a class="code" href="../../d2/d7/hal_8h.html#a204">KdPortSave</a> ();
02331 
02332     <span class="comment">//</span>
02333     <span class="comment">// Process state change for this processor</span>
02334     <span class="comment">//</span>
02335 
02336     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a120">KdpReportExceptionStateChange</a> (
02337                 ExceptionRecord,
02338                 ContextRecord,
02339                 SecondChance
02340                 );
02341 
02342     <span class="comment">//</span>
02343     <span class="comment">// Restore port state and return status</span>
02344     <span class="comment">//</span>
02345 
02346     <a class="code" href="../../d2/d7/hal_8h.html#a203">KdPortRestore</a> ();
02347     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02348 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a128" doxytag="kdp.h::KdpTimeSlipDpcRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpTimeSlipDpcRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>DeferredContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00494">494</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
<pre class="fragment"><div>00500 {
00501     LONG OldCount, NewCount, j;
00502 
00503     <span class="comment">//</span>
00504     <span class="comment">// Reset pending count.  If the current count is 1, then clear</span>
00505     <span class="comment">// the pending count.  if the current count is greater then 1,</span>
00506     <span class="comment">// then set to one and update the time now.</span>
00507     <span class="comment">//</span>
00508 
00509     j = <a class="code" href="../../d8/d5/kddata_8c.html#a103">KdpTimeSlipPending</a>;
00510     <span class="keywordflow">do</span> {
00511         OldCount = j;
00512         NewCount = OldCount &gt; 1 ? 1 : 0;
00513 
00514         j = InterlockedCompareExchange(&amp;KdpTimeSlipPending, NewCount, OldCount);
00515 
00516     } <span class="keywordflow">while</span> (j != OldCount);
00517 
00518     <span class="comment">//</span>
00519     <span class="comment">// If new count is non-zero, then process a time slip now</span>
00520     <span class="comment">//</span>
00521 
00522     <span class="keywordflow">if</span> (NewCount) {
00523         <a class="code" href="../../d5/d8/ex_8h.html#a261">ExQueueWorkItem</a>(&amp;KdpTimeSlipWorkItem, DelayedWorkQueue);
00524     }
00525 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a129" doxytag="kdp.h::KdpTimeSlipWork" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpTimeSlipWork           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">528</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
<pre class="fragment"><div>00531 {
00532     KIRQL               OldIrql;
00533     LARGE_INTEGER       DueTime;
00534 
00535     <span class="comment">//</span>
00536     <span class="comment">// Update time from the real time clock</span>
00537     <span class="comment">//</span>
00538 
00539     <a class="code" href="../../d5/d8/ex_8h.html#a312">ExAcquireTimeRefreshLock</a>();
00540     <a class="code" href="../../d5/d8/ex_8h.html#a314">ExUpdateSystemTimeFromCmos</a> (FALSE, 0);
00541     <a class="code" href="../../d5/d8/ex_8h.html#a313">ExReleaseTimeRefreshLock</a>();
00542 
00543     <span class="comment">//</span>
00544     <span class="comment">// If there's a time service installed, signal it's time slip event</span>
00545     <span class="comment">//</span>
00546 
00547     <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a>(&amp;KdpTimeSlipEventLock, &amp;OldIrql);
00548     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a99">KdpTimeSlipEvent</a>) {
00549         <a class="code" href="../../d2/d8/eventobj_8c.html#a8">KeSetEvent</a> (KdpTimeSlipEvent, 0, FALSE);
00550     }
00551     <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a>(&amp;KdpTimeSlipEventLock, OldIrql);
00552 
00553     <span class="comment">//</span>
00554     <span class="comment">// Insert a forced delay between time slip operations</span>
00555     <span class="comment">//</span>
00556 
00557     DueTime.QuadPart = -1800000000;
00558     <a class="code" href="../../d3/d2/timerobj_8c.html#a6">KeSetTimer</a> (&amp;KdpTimeSlipTimer, DueTime, &amp;KdpTimeSlipDpc);
00559 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="kdp.h::KdpTrap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdpTrap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PreviousMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SecondChance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html#l00028">28</a> of file <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html">alpha/kdtrap.c</a>.
<p>
<pre class="fragment"><div>00039                    :
00040 
00041     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called whenever a exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> dispatched and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel
00042     debugger <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> active.
00043 
00044 Arguments:
00045 
00046     TrapFrame - Supplies a pointer to a trap frame that describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00047         trap.
00048 
00049     ExceptionFrame - Supplies a pointer to a exception frame that describes
00050         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap.
00051 
00052     ExceptionRecord - Supplies a pointer to an exception record that
00053         describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
00054 
00055     ContextRecord - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception.
00056 
00057     PreviousMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous processor mode.
00058 
00059     SecondChance - Supplies a <span class="keywordtype">boolean</span> value that determines whether <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00060         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second chance (TRUE) that the exception has been raised.
00061 
00062 Return Value:
00063 
00064     A value of TRUE is returned if the exception is handled. Otherwise a
00065     value of FALSE is returned.
00066 
00067 --*/
00068 
00069 {
00070 
00071     BOOLEAN Completion;
00072     BOOLEAN Enable;
00073     BOOLEAN UnloadSymbols = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00074     STRING Input;
00075     ULONGLONG OldFir;
00076     STRING Output;
00077     PKPRCB Prcb;
00078 
00079     <span class="comment">//</span>
00080     <span class="comment">// Enter debugger and synchronize processor execution.</span>
00081     <span class="comment">//</span>
00082 
00083     <span class="comment">//</span>
00084     <span class="comment">// If this is a breakpoint instruction, then check to determine if is</span>
00085     <span class="comment">// an internal command.</span>
00086     <span class="comment">//</span>
00087 
00088     <span class="keywordflow">if</span> ((ExceptionRecord-&gt;ExceptionCode == STATUS_BREAKPOINT) &amp;&amp;
00089         (ExceptionRecord-&gt;ExceptionInformation[0] &gt;= DEBUG_PRINT_BREAKPOINT)){
00090 
00091         <span class="comment">//</span>
00092         <span class="comment">// Switch on the breakpoint code.</span>
00093         <span class="comment">//</span>
00094 
00095         <span class="keywordflow">switch</span> (ExceptionRecord-&gt;ExceptionInformation[0]) {
00096 
00097             <span class="comment">//</span>
00098             <span class="comment">// Print a debug string.</span>
00099             <span class="comment">//</span>
00100             <span class="comment">// Arguments:</span>
00101             <span class="comment">//</span>
00102             <span class="comment">//   a0 - Supplies a pointer to an output string buffer.</span>
00103             <span class="comment">//   a1 - Supplies the length of the output string buffer.</span>
00104             <span class="comment">//</span>
00105 
00106         <span class="keywordflow">case</span> DEBUG_PRINT_BREAKPOINT:
00107             ContextRecord-&gt;Fir += 4;
00108             Output.Buffer = (PCHAR)ContextRecord-&gt;IntA0;
00109             Output.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)ContextRecord-&gt;IntA1;
00110 
00111             <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a7">KdLogDbgPrint</a>(&amp;Output);
00112 
00113             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00114 
00115                 Enable = <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a17">KdEnterDebugger</a>(TrapFrame, ExceptionFrame);
00116                 <span class="keywordflow">if</span> (<a class="code" href="../../d1/d7/4_2kdp_8h.html#a102">KdpPrintString</a>(&amp;Output)) {
00117                     ContextRecord-&gt;IntV0 = (ULONG)STATUS_BREAKPOINT;
00118                 } <span class="keywordflow">else</span> {
00119                     ContextRecord-&gt;IntV0 = (ULONG)STATUS_SUCCESS;
00120                 }
00121                 <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a18">KdExitDebugger</a>(Enable);
00122 
00123             } <span class="keywordflow">else</span> {
00124                 ContextRecord-&gt;IntV0 = (ULONG)STATUS_DEVICE_NOT_CONNECTED;
00125             }
00126 
00127             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00128 
00129 
00130             <span class="comment">//</span>
00131             <span class="comment">// Stop in the debugger</span>
00132             <span class="comment">//</span>
00133             <span class="comment">// As this is not a normal breakpoint we must increment the</span>
00134             <span class="comment">// context past the breakpoint instruction</span>
00135             <span class="comment">//</span>
00136 
00137         <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a454">BREAKIN_BREAKPOINT</a>:
00138             ContextRecord-&gt;Fir += 4;
00139             <span class="keywordflow">break</span>;
00140 
00141             <span class="comment">//</span>
00142             <span class="comment">// Print a debug prompt string, then input a string.</span>
00143             <span class="comment">//</span>
00144             <span class="comment">//   a0 - Supplies a pointer to an output string buffer.</span>
00145             <span class="comment">//   a1 - Supplies the length of the output string buffer..</span>
00146             <span class="comment">//   a2 - supplies a pointer to an input string buffer.</span>
00147             <span class="comment">//   a3 - Supplies the length of the input string bufffer.</span>
00148             <span class="comment">//</span>
00149 
00150         <span class="keywordflow">case</span> DEBUG_PROMPT_BREAKPOINT:
00151             ContextRecord-&gt;Fir += 4;
00152             Output.Buffer = (PCHAR)ContextRecord-&gt;IntA0;
00153             Output.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)ContextRecord-&gt;IntA1;
00154             Input.Buffer = (PCHAR)ContextRecord-&gt;IntA2;
00155             Input.MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)ContextRecord-&gt;IntA3;
00156 
00157             <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a7">KdLogDbgPrint</a>(&amp;Output);
00158 
00159             Enable = <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a17">KdEnterDebugger</a>(TrapFrame, ExceptionFrame);
00160 
00161             <a class="code" href="../../d1/d7/4_2kdp_8h.html#a103">KdpPromptString</a>(&amp;Output, &amp;Input);
00162 
00163             ContextRecord-&gt;IntV0 = Input.Length;
00164 
00165             <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a18">KdExitDebugger</a>(Enable);
00166             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00167 
00168             <span class="comment">//</span>
00169             <span class="comment">// Load the symbolic information for an image.</span>
00170             <span class="comment">//</span>
00171             <span class="comment">// Arguments:</span>
00172             <span class="comment">//</span>
00173             <span class="comment">//    a0 - Supplies a pointer to an output string descriptor.</span>
00174             <span class="comment">//    a1 - Supplies a the base address of the image.</span>
00175             <span class="comment">//    a2 - Supplies the current process id.</span>
00176             <span class="comment">//</span>
00177 
00178         <span class="keywordflow">case</span> DEBUG_UNLOAD_SYMBOLS_BREAKPOINT:
00179             UnloadSymbols = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00180 
00181             <span class="comment">//</span>
00182             <span class="comment">// Fall through</span>
00183             <span class="comment">//</span>
00184 
00185         <span class="keywordflow">case</span> DEBUG_LOAD_SYMBOLS_BREAKPOINT:
00186             Enable = <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a17">KdEnterDebugger</a>(TrapFrame, ExceptionFrame);
00187             Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00188             OldFir = ContextRecord-&gt;Fir;
00189             RtlCopyMemory(&amp;Prcb-&gt;ProcessorState.ContextFrame,
00190                           ContextRecord,
00191                           <span class="keyword">sizeof</span>(CONTEXT));
00192 
00193             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00194                 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a121">KdpReportLoadSymbolsStateChange</a>((PSTRING)ContextRecord-&gt;IntA0,
00195                                                 (<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a>) ContextRecord-&gt;IntA1,
00196                                                 UnloadSymbols,
00197                                                 &amp;Prcb-&gt;ProcessorState.ContextFrame);
00198 
00199             }
00200 
00201             RtlCopyMemory(ContextRecord,
00202                           &amp;Prcb-&gt;ProcessorState.ContextFrame,
00203                           <span class="keyword">sizeof</span>(CONTEXT));
00204 
00205             <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a18">KdExitDebugger</a>(Enable);
00206 
00207             <span class="comment">//</span>
00208             <span class="comment">// If the kernel debugger did not update the FIR, then increment</span>
00209             <span class="comment">// past the breakpoint instruction.</span>
00210             <span class="comment">//</span>
00211 
00212             <span class="keywordflow">if</span> (ContextRecord-&gt;Fir == OldFir) {
00213                 ContextRecord-&gt;Fir += 4;
00214             }
00215 
00216             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00217 
00218             <span class="comment">//</span>
00219             <span class="comment">// Unknown internal command.</span>
00220             <span class="comment">//</span>
00221 
00222         <span class="keywordflow">default</span>:
00223             <span class="keywordflow">break</span>;
00224         }
00225     }
00226 
00227     <span class="comment">//</span>
00228     <span class="comment">// Report state change to kernel debugger on host machine.</span>
00229     <span class="comment">//</span>
00230 
00231     Enable = <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a17">KdEnterDebugger</a>(TrapFrame, ExceptionFrame);
00232     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00233 
00234     RtlCopyMemory(&amp;Prcb-&gt;ProcessorState.ContextFrame,
00235                     ContextRecord,
00236                     sizeof (CONTEXT));
00237 
00238     Completion = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a120">KdpReportExceptionStateChange</a>(ExceptionRecord,
00239                                                &amp;Prcb-&gt;ProcessorState.ContextFrame,
00240                                                SecondChance);
00241 
00242     RtlCopyMemory(ContextRecord,
00243                   &amp;Prcb-&gt;ProcessorState.ContextFrame,
00244                   <span class="keyword">sizeof</span>(CONTEXT));
00245 
00246     <a class="code" href="../../d9/d3/4_2kdapi_8c.html#a18">KdExitDebugger</a>(Enable);
00247 
00248     <a class="code" href="../../d8/d5/kddata_8c.html#a90">KdpControlCPressed</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00249 
00250     <span class="comment">//</span>
00251     <span class="comment">// Always return TRUE if this is the first chance to handle the</span>
00252     <span class="comment">// exception.  Otherwise, return the completion status of the</span>
00253     <span class="comment">// state change reporting.</span>
00254     <span class="comment">//</span>
00255 
00256     <span class="keywordflow">if</span>( SecondChance ){
00257         <span class="keywordflow">return</span> Completion;
00258     } <span class="keywordflow">else</span> {
00259         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00260     }
00261 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a117" doxytag="kdp.h::KdpWriteBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteBreakpoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01580">1580</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d3/kdbreak_8c-source.html#l00060">KdpAddBreakpoint()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>01588                    :
01589 
01590     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a write breakpoint state
01591     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write a breakpoint
01592     and <span class="keywordflow">return</span> a handle to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint.
01593 
01594 Arguments:
01595 
01596     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01597 
01598     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01599 
01600     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01601 
01602 Return Value:
01603 
01604     None.
01605 
01606 --*/
01607 
01608 {
01609     PDBGKD_WRITE_BREAKPOINT a = &amp;m-&gt;u.WriteBreakPoint;
01610     STRING MessageHeader;
01611 
01612     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01613     MessageHeader.Buffer = (PCHAR)m;
01614 
01615     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
01616 
01617     a-&gt;BreakPointHandle = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a104">KdpAddBreakpoint</a>(a-&gt;BreakPointAddress);
01618     <span class="keywordflow">if</span> (a-&gt;BreakPointHandle != 0) {
01619         m-&gt;ReturnStatus = STATUS_SUCCESS;
01620     } <span class="keywordflow">else</span> {
01621         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01622     }
01623     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01624                   PACKET_TYPE_KD_STATE_MANIPULATE,
01625                   &amp;MessageHeader,
01626                   NULL
01627                   );
01628     UNREFERENCED_PARAMETER(Context);
01629 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="kdp.h::KdpWriteComPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteComPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a120" doxytag="kdp.h::KdpWriteControlSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteControlSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00451">451</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>.
<p>
<pre class="fragment"><div>00459                    :
00460 
00461     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a write <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> space state
00462     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write implementation
00463     specific system data.
00464 
00465 Arguments:
00466 
00467     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
00468 
00469     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
00470 
00471     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
00472 
00473 Return Value:
00474 
00475     None.
00476 
00477 --*/
00478 
00479 {
00480     PDBGKD_WRITE_MEMORY a = &amp;m-&gt;u.WriteMemory;
00481     ULONG Length;
00482     STRING MessageHeader;
00483 
00484     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
00485     MessageHeader.Buffer = (PCHAR)m;
00486 
00487     AdditionalData-&gt;Length = 0;
00488     m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
00489     a-&gt;ActualBytesWritten = 0;
00490 
00491     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00492         PACKET_TYPE_KD_STATE_MANIPULATE,
00493         &amp;MessageHeader,
00494         AdditionalData
00495         );
00496 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a123" doxytag="kdp.h::KdpWriteIoSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteIoSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00779">779</a> of file <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html">alpha/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01170">BusNumber</a>, <a class="el" href="../../d2/d7/hal_8h.html#a184">HalTranslateBusAddress()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00050">InterfaceType</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00085">PUSHORT</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00787                    :
00788 
00789     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a read io space state
00790     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to read system io
00791     locations.
00792 
00793 Arguments:
00794 
00795     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
00796 
00797     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
00798 
00799     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
00800 
00801 Return Value:
00802 
00803     None.
00804 
00805 --*/
00806 
00807 {
00808     PDBGKD_READ_WRITE_IO a = &amp;m-&gt;u.ReadWriteIo;
00809     STRING MessageHeader;
00810     INTERFACE_TYPE <a class="code" href="../../d4/d0/cmconfig_8c.html#a5">InterfaceType</a>;
00811     ULONG <a class="code" href="../../d2/d7/hal_8h.html#a75">BusNumber</a>;
00812     PHYSICAL_ADDRESS IoAddress;
00813     PHYSICAL_ADDRESS TranslatedAddress;
00814     ULONG AddressSpace;
00815     ULONG DataSize;
00816     ULONG Value;
00817 
00818     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
00819     MessageHeader.Buffer = (PCHAR)m;
00820 
00821     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
00822 
00823     m-&gt;ReturnStatus = STATUS_SUCCESS;
00824 
00825     <span class="comment">//</span>
00826     <span class="comment">// Capture the input parameters and use the default values for those</span>
00827     <span class="comment">// parameters not specified in the Api.</span>
00828     <span class="comment">//</span>
00829 
00830     <a class="code" href="../../d4/d0/cmconfig_8c.html#a5">InterfaceType</a> = Isa;
00831     <a class="code" href="../../d2/d7/hal_8h.html#a75">BusNumber</a> = 0;
00832     AddressSpace = 1;
00833     IoAddress.QuadPart = (ULONG_PTR)a-&gt;IoAddress;
00834     DataSize = a-&gt;DataSize;
00835     Value = a-&gt;DataValue;
00836 
00837     <span class="comment">//</span>
00838     <span class="comment">// Translate the bus address to the physical system address</span>
00839     <span class="comment">// or QVA.</span>
00840     <span class="comment">//</span>
00841 
00842     <span class="keywordflow">if</span>( !<a class="code" href="../../d2/d7/hal_8h.html#a184">HalTranslateBusAddress</a>( InterfaceType,
00843                                  BusNumber,
00844                                  IoAddress,
00845                                  &amp;AddressSpace,
00846                                  &amp;TranslatedAddress ) ){
00847         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00848         <span class="keywordflow">goto</span> SendWriteIoSpaceResponse;
00849     }
00850 
00851     <span class="comment">//</span>
00852     <span class="comment">// N.B. - for the moment we will only support QVAs ie. when AddressSpace</span>
00853     <span class="comment">//        is one.  It may be in later systems that we will have to</span>
00854     <span class="comment">//        check the address space, map it, perform the virtual read</span>
00855     <span class="comment">//        unmap, and then return the data - only we will have to be</span>
00856     <span class="comment">//        careful about what Irql we are to make sure the memory mgmt</span>
00857     <span class="comment">//        stuff will all work</span>
00858     <span class="comment">//</span>
00859 
00860     <span class="keywordflow">if</span>( !AddressSpace ){
00861         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00862         <span class="keywordflow">goto</span> SendWriteIoSpaceResponse;
00863     }
00864 
00865     <span class="comment">//</span>
00866     <span class="comment">// Do the IO space read using the appropriate HAL routines based upon</span>
00867     <span class="comment">// the default address space (io) and the data size requested.</span>
00868     <span class="comment">//</span>
00869 
00870     <span class="keywordflow">switch</span>( DataSize ){
00871 
00872     <span class="keywordflow">case</span> 1:
00873         WRITE_PORT_UCHAR( (PUCHAR)TranslatedAddress.QuadPart, (UCHAR)Value );
00874         <span class="keywordflow">break</span>;
00875 
00876     <span class="keywordflow">case</span> 2:
00877         WRITE_PORT_USHORT( (PUSHORT)TranslatedAddress.QuadPart, (USHORT)Value );
00878         <span class="keywordflow">break</span>;
00879 
00880     <span class="keywordflow">case</span> 4:
00881         WRITE_PORT_ULONG( (PULONG)TranslatedAddress.QuadPart, Value );
00882         <span class="keywordflow">break</span>;
00883 
00884     <span class="keywordflow">default</span>:
00885         m-&gt;ReturnStatus = STATUS_INVALID_PARAMETER;
00886     }
00887 
00888 
00889 SendWriteIoSpaceResponse:
00890 
00891     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
00892         PACKET_TYPE_KD_STATE_MANIPULATE,
00893         &amp;MessageHeader,
00894         NULL
00895         );
00896 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a124" doxytag="kdp.h::KdpWriteMachineSpecificRegister" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteMachineSpecificRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l01153">1153</a> of file <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html">i386/kdcpuapi.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d3/i386_8h.html#a53">WRMSR()</a>.
<p>
<pre class="fragment"><div>01161                    :
01162 
01163     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a write of a MSR
01164     manipulation message.  Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MSR
01165 
01166 Arguments:
01167 
01168     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01169 
01170     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
01171 
01172     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01173 
01174 Return Value:
01175 
01176     None.
01177 
01178 --*/
01179 
01180 {
01181     PDBGKD_READ_WRITE_MSR a = &amp;m-&gt;u.ReadWriteMsr;
01182     STRING MessageHeader;
01183     LARGE_INTEGER l;
01184 
01185     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
01186     MessageHeader.Buffer = (PCHAR)m;
01187 
01188     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(AdditionalData-&gt;Length == 0);
01189 
01190     m-&gt;ReturnStatus = STATUS_SUCCESS;
01191 
01192     l.HighPart = a-&gt;DataValueHigh;
01193     l.LowPart = a-&gt;DataValueLow;
01194 
01195     <span class="keywordflow">try</span> {
01196         <a class="code" href="../../d5/d3/i386_8h.html#a53">WRMSR</a> (a-&gt;Msr, l.QuadPart);
01197     } except (EXCEPTION_EXECUTE_HANDLER) {
01198         m-&gt;ReturnStatus = STATUS_NO_SUCH_DEVICE;
01199     }
01200 
01201     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
01202         PACKET_TYPE_KD_STATE_MANIPULATE,
01203         &amp;MessageHeader,
01204         NULL
01205         );
01206     UNREFERENCED_PARAMETER(Context);
01207 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a114" doxytag="kdp.h::KdpWritePhysicalMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWritePhysicalMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02680">2680</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d3/d0/mm_8h-source.html#l00166">BYTE_OFFSET</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/ppc_2debugsup_8c-source.html#l00233">MmDbgTranslatePhysicalAddress()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00190">PAGE_ALIGN</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>02688                    :
02689 
02690     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response to a write physical memory
02691     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write physical memory
02692     and <span class="keywordflow">return</span>.
02693 
02694 Arguments:
02695 
02696     m - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
02697 
02698     AdditionalData - Supplies any additional data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> message.
02699 
02700     Context - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
02701 
02702 Return Value:
02703 
02704     None.
02705 
02706 --*/
02707 
02708 {
02709     PDBGKD_WRITE_MEMORY a = &amp;m-&gt;u.WriteMemory;
02710     ULONG Length;
02711     STRING MessageHeader;
02712     PVOID VirtualAddress;
02713     PHYSICAL_ADDRESS Destination;
02714     PUCHAR Source;
02715     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> NumberBytes;
02716     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> BytesLeft;
02717 
02718     MessageHeader.Length = <span class="keyword">sizeof</span>(*m);
02719     MessageHeader.Buffer = (PCHAR)m;
02720 
02721 
02722     <span class="comment">//</span>
02723     <span class="comment">// Since the MmDbgTranslatePhysicalAddress only maps in one physical</span>
02724     <span class="comment">// page at a time, we need to break the memory move up into smaller</span>
02725     <span class="comment">// moves which don't cross page boundaries.  There are two cases we</span>
02726     <span class="comment">// need to deal with.  The area to be moved may start and end on the</span>
02727     <span class="comment">// same page, or it may start and end on different pages (with an</span>
02728     <span class="comment">// arbitrary number of pages in between)</span>
02729     <span class="comment">//</span>
02730     Destination.QuadPart = (ULONG_PTR)a-&gt;TargetBaseAddress;
02731     Source = AdditionalData-&gt;Buffer;
02732     BytesLeft = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) a-&gt;TransferCount;
02733     <span class="keywordflow">if</span>(<a class="code" href="../../d2/d1/mm_8h.html#a7">PAGE_ALIGN</a>((PUCHAR)Destination.LowPart) ==
02734        <a class="code" href="../../d2/d1/mm_8h.html#a7">PAGE_ALIGN</a>((PUCHAR)(Destination.LowPart)+BytesLeft)) {
02735         <span class="comment">//</span>
02736         <span class="comment">// Memory move starts and ends on the same page.</span>
02737         <span class="comment">//</span>
02738         VirtualAddress=<a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Destination);
02739         Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02740                                        VirtualAddress,
02741                                        Source,
02742                                        BytesLeft
02743                                       );
02744         BytesLeft -= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) Length;
02745     } <span class="keywordflow">else</span> {
02746         <span class="comment">//</span>
02747         <span class="comment">// Memory move spans page boundaries</span>
02748         <span class="comment">//</span>
02749         VirtualAddress=<a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Destination);
02750         NumberBytes = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - <a class="code" href="../../d2/d1/mm_8h.html#a6">BYTE_OFFSET</a>(VirtualAddress));
02751         Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02752                                        VirtualAddress,
02753                                        Source,
02754                                        NumberBytes
02755                                       );
02756         Source += NumberBytes;
02757         Destination.LowPart += NumberBytes;
02758         BytesLeft -= NumberBytes;
02759         <span class="keywordflow">while</span>(BytesLeft &gt; 0) {
02760             <span class="comment">//</span>
02761             <span class="comment">// Transfer a full page or the last bit,</span>
02762             <span class="comment">// whichever is smaller.</span>
02763             <span class="comment">//</span>
02764             VirtualAddress = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a>(Destination);
02765             NumberBytes = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) ((<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> &lt; BytesLeft) ? <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> : BytesLeft);
02766             Length += (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(
02767                                             VirtualAddress,
02768                                             Source,
02769                                             NumberBytes
02770                                            );
02771             Source += NumberBytes;
02772             Destination.LowPart += NumberBytes;
02773             BytesLeft -= NumberBytes;
02774         }
02775     }
02776 
02777 
02778     <span class="keywordflow">if</span> (Length == AdditionalData-&gt;Length) {
02779         m-&gt;ReturnStatus = STATUS_SUCCESS;
02780     } <span class="keywordflow">else</span> {
02781         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
02782     }
02783 
02784     a-&gt;ActualBytesWritten = Length;
02785 
02786     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(
02787                   PACKET_TYPE_KD_STATE_MANIPULATE,
02788                   &amp;MessageHeader,
02789                   NULL
02790                   );
02791     UNREFERENCED_PARAMETER(Context);
02792 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a111" doxytag="kdp.h::KdpWriteVirtualMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteVirtualMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01308">1308</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>01316                    :
01317 
01318     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a write <span class="keyword">virtual</span> memory 32-bit
01319     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write <span class="keyword">virtual</span> memory
01320     and <span class="keywordflow">return</span>.
01321 
01322 Arguments:
01323 
01324     m - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01325 
01326     AdditionalData - Supplies a pointer to a descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data to write.
01327 
01328     Context - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01329 
01330 Return Value:
01331 
01332     None.
01333 
01334 --*/
01335 
01336 {
01337 
01338     ULONG Length;
01339     STRING MessageHeader;
01340 
01341     <span class="comment">//</span>
01342     <span class="comment">// Move the data to the destination buffer.</span>
01343     <span class="comment">//</span>
01344 
01345     Length = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(m-&gt;u.WriteMemory.TargetBaseAddress,
01346                            AdditionalData-&gt;Buffer,
01347                            AdditionalData-&gt;Length);
01348 
01349     <span class="comment">//</span>
01350     <span class="comment">// If all the data is written, then return a success status. Otherwise,</span>
01351     <span class="comment">// return an unsuccessful status.</span>
01352     <span class="comment">//</span>
01353 
01354     m-&gt;ReturnStatus = STATUS_SUCCESS;
01355     <span class="keywordflow">if</span> (Length != AdditionalData-&gt;Length) {
01356         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01357     }
01358 
01359     <span class="comment">//</span>
01360     <span class="comment">// Set the actual number of bytes written, initialize the message header,</span>
01361     <span class="comment">// and send the reply packet to the host debugger.</span>
01362     <span class="comment">//</span>
01363 
01364     m-&gt;u.WriteMemory.ActualBytesWritten = Length;
01365     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01366     MessageHeader.Buffer = (PCHAR)m;
01367     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(PACKET_TYPE_KD_STATE_MANIPULATE,
01368                   &amp;MessageHeader,
01369                   NULL);
01370 
01371     <span class="keywordflow">return</span>;
01372 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a112" doxytag="kdp.h::KdpWriteVirtualMemory64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdpWriteVirtualMemory64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_MANIPULATE_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AdditionalData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01375">1375</a> of file <a class="el" href="../../d9/d2/kdapi_8c-source.html">kdapi.c</a>.
<p>
References <a class="el" href="../../d0/d4/kdcomio_8c-source.html#l00683">KdpSendPacket()</a>, <a class="el" href="../../d5/d5/ppc_2debugsup_8c-source.html#l00194">MmDbgWriteCheck64()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.
<p>
<pre class="fragment"><div>01383                    :
01384 
01385     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in response of a write <span class="keyword">virtual</span> memory 64-bit
01386     state manipulation message. Its function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to write <span class="keyword">virtual</span> memory
01387     and <span class="keywordflow">return</span>.
01388 
01389 Arguments:
01390 
01391     m - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state manipulation message.
01392 
01393     AdditionalData - Supplies a pointer to a descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data to write.
01394 
01395     Context - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current context.
01396 
01397 Return Value:
01398 
01399     None.
01400 
01401 --*/
01402 
01403 {
01404 
01405     UCHAR * POINTER_64 Address;
01406     UCHAR * POINTER_64 Destination;
01407     ULONG Length;
01408     STRING MessageHeader;
01409     PUCHAR Source;
01410     ULONG_PTR Opaque;
01411 
01412     <span class="comment">//</span>
01413     <span class="comment">// Move the data to the destination buffer.</span>
01414     <span class="comment">//</span>
01415 
01416     Length = AdditionalData-&gt;Length;
01417 
01418 <span class="preprocessor">#if defined(_MIPS_) || defined(_ALPHA_)</span>
01419 <span class="preprocessor"></span>
01420     Destination = (UCHAR * POINTER_64)m-&gt;u.WriteMemory64.TargetBaseAddress;
01421     Source = AdditionalData-&gt;Buffer;
01422     <span class="keywordflow">while</span> (Length &gt; 0) {
01423         <span class="keywordflow">if</span> ((Address = <a class="code" href="../../d4/d6/ppc_2debugsup_8c.html#a3">MmDbgWriteCheck64</a>(Destination)) == NULL64) {
01424             <span class="keywordflow">break</span>;
01425         }
01426 
01427         *Address = *Source++;
01428         Destination += 1;
01429         Length -= 1;
01430     }
01431 
01432 <span class="preprocessor">#endif</span>
01433 <span class="preprocessor"></span>
01434     <span class="comment">//</span>
01435     <span class="comment">// If all the data is written, then return a success status. Otherwise,</span>
01436     <span class="comment">// return an unsuccessful status.</span>
01437     <span class="comment">//</span>
01438 
01439     m-&gt;ReturnStatus = STATUS_SUCCESS;
01440     <span class="keywordflow">if</span> (Length != 0) {
01441         m-&gt;ReturnStatus = STATUS_UNSUCCESSFUL;
01442     }
01443 
01444     <span class="comment">//</span>
01445     <span class="comment">// Set the actual number of bytes written, initialize the message header,</span>
01446     <span class="comment">// and send the reply packet to the host debugger.</span>
01447     <span class="comment">//</span>
01448 
01449     m-&gt;u.WriteMemory64.ActualBytesWritten = AdditionalData-&gt;Length - Length;
01450     MessageHeader.Length = <span class="keyword">sizeof</span>(DBGKD_MANIPULATE_STATE);
01451     MessageHeader.Buffer = (PCHAR)m;
01452     <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a>(PACKET_TYPE_KD_STATE_MANIPULATE,
01453                   &amp;MessageHeader,
01454                   NULL);
01455 
01456     <span class="keywordflow">return</span>;
01457 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a130" doxytag="kdp.h::RtlpBreakWithStatusInstruction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpBreakWithStatusInstruction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02838">KdpGetVersion()</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a36" doxytag="kdp.h::BreakpointsSuspended" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a40">BreakpointsSuspended</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00451">451</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="kdp.h::CallLevelChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a70">CallLevelChange</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00499">499</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="kdp.h::InitialSP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a50">InitialSP</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00478">478</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="kdp.h::InstrCountInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a72">InstrCountInternal</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00501">501</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="kdp.h::InstructionsTraced" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a68">InstructionsTraced</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00497">497</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="kdp.h::IntBPsSkipping" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a61">IntBPsSkipping</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00490">490</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="kdp.h::InternalBreakpointCheckDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a53">InternalBreakpointCheckDpc</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00481">481</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="kdp.h::InternalBreakpointTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a52">InternalBreakpointTimer</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00480">480</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="kdp.h::KdDebuggerDataBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KDDEBUGGER_DATA <a class="el" href="../../d9/d1/bugcheck_8c.html#a2">KdDebuggerDataBlock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00520">520</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="kdp.h::KdDebugParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d2/struct__DEBUG__PARAMETERS.html">DEBUG_PARAMETERS</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a81">KdDebugParameters</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00517">517</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="kdp.h::KdEnteredDebugger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a91">KdEnteredDebugger</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00528">528</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="kdp.h::KdNumberOfSpecialCalls" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a49">KdNumberOfSpecialCalls</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00477">477</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="kdp.h::KdpBreakpointInstruction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KDP_BREAKPOINT_TYPE <a class="el" href="../../d1/d7/4_2kdp_8h.html#a30">KdpBreakpointInstruction</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00439">439</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="kdp.h::KdpBreakpointTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">BREAKPOINT_ENTRY</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a25">KdpBreakpointTable</a>[BREAKPOINT_TABLE_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00434">434</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="kdp.h::KdpControlCPending" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a26">KdpControlCPending</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00435">435</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="kdp.h::KdpControlCPressed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a73">KdpControlCPressed</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00504">504</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="kdp.h::KdpCurrentSymbolEnd" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a46">KdpCurrentSymbolEnd</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00474">474</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="kdp.h::KdpCurrentSymbolStart" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a45">KdpCurrentSymbolStart</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00473">473</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="kdp.h::KdpDataSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d1/d7/4_2kdp_8h.html#a82">KdpDataSpinLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00518">518</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="kdp.h::KdpDebuggerDataListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d1/d7/4_2kdp_8h.html#a42">KdpDebuggerDataListHead</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00453">453</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="kdp.h::KdpDebuggerLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d1/d7/4_2kdp_8h.html#a27">KdpDebuggerLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00436">436</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="kdp.h::KdpDebuggerStructuresInitialized" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a90">KdpDebuggerStructuresInitialized</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00527">527</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="kdp.h::KdPerformanceCounterRate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d1/d7/4_2kdp_8h.html#a36">KdPerformanceCounterRate</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00446">446</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="kdp.h::KdpInternalBPs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html">DBGKD_INTERNAL_BREAKPOINT</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a44">KdpInternalBPs</a>[DBGKD_MAX_INTERNAL_BREAKPOINTS]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00471">471</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="kdp.h::KdpMessageBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a31">KdpMessageBuffer</a>[KDP_MESSAGE_BUFFER_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00440">440</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="kdp.h::KdpNextCallLevelChange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a47">KdpNextCallLevelChange</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00475">475</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="kdp.h::KdpNextPacketIdToSend" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a34">KdpNextPacketIdToSend</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00443">443</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="kdp.h::KdpNtosImageBase" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d1/d7/4_2kdp_8h.html#a41">KdpNtosImageBase</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00452">452</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="kdp.h::KdpNumberRetries" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a75">KdpNumberRetries</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00506">506</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="kdp.h::KdpNumInternalBreakpoints" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a51">KdpNumInternalBreakpoints</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00479">479</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="kdp.h::KdpOweBreakpoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a33">KdpOweBreakpoint</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00442">442</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="kdp.h::KdpPacketIdExpected" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a35">KdpPacketIdExpected</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00444">444</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="kdp.h::KdpPathBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a32">KdpPathBuffer</a>[KDP_MESSAGE_BUFFER_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00441">441</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="kdp.h::KdpPortLocked" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a54">KdpPortLocked</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00482">482</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="kdp.h::KdpPrintSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d1/d7/4_2kdp_8h.html#a80">KdpPrintSpinLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00516">516</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="kdp.h::KdpRetryCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a74">KdpRetryCount</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00505">505</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="kdp.h::KdPrintCircularBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a77">KdPrintCircularBuffer</a>[KDPRINTBUFFERSIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00513">513</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="kdp.h::KdPrintRolloverCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a79">KdPrintRolloverCount</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00515">515</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="kdp.h::KdPrintWritePointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PUCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a78">KdPrintWritePointer</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00514">514</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="kdp.h::KdpTimeEntered" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d1/d7/4_2kdp_8h.html#a55">KdpTimeEntered</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00483">483</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="kdp.h::KdpTimeSlipDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a84">KdpTimeSlipDpc</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00521">521</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="kdp.h::KdpTimeSlipEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d1/d7/4_2kdp_8h.html#a89">KdpTimeSlipEvent</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00526">526</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="kdp.h::KdpTimeSlipEventLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d1/d7/4_2kdp_8h.html#a88">KdpTimeSlipEventLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00525">525</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="kdp.h::KdpTimeSlipPending" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a87">KdpTimeSlipPending</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00524">524</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="kdp.h::KdpTimeSlipTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a86">KdpTimeSlipTimer</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00523">523</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="kdp.h::KdpTimeSlipWorkItem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a85">KdpTimeSlipWorkItem</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00522">522</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="kdp.h::KdSpecialCalls" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a48">KdSpecialCalls</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00476">476</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="kdp.h::KdTimerDifference" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d1/d7/4_2kdp_8h.html#a39">KdTimerDifference</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00449">449</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="kdp.h::KdTimerStart" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d1/d7/4_2kdp_8h.html#a37">KdTimerStart</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00447">447</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="kdp.h::KdTimerStop" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d1/d7/4_2kdp_8h.html#a38">KdTimerStop</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00448">448</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="kdp.h::KiDebugRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/ke_8h.html#a64">PKDEBUG_ROUTINE</a> <a class="el" href="../../d0/d0/ki_8h.html#a41">KiDebugRoutine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00437">437</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l03240">KdDisableDebugger()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, and <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="kdp.h::KiDebugSwitchRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/ke_8h.html#a65">PKDEBUG_SWITCH_ROUTINE</a> <a class="el" href="../../d0/d0/ki_8h.html#a42">KiDebugSwitchRoutine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00438">438</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, and <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00220">KiFreezeTargetExecution()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="kdp.h::NextTraceDataSym" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a59">NextTraceDataSym</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00488">488</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="kdp.h::NumTraceDataSyms" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a60">NumTraceDataSyms</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00489">489</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="kdp.h::oldpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a71">oldpc</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00500">500</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="kdp.h::SymbolRecorded" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a69">SymbolRecorded</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00498">498</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="kdp.h::TraceDataBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> DBGKD_TRACE_DATA <a class="el" href="../../d1/d7/4_2kdp_8h.html#a56">TraceDataBuffer</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00485">485</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="kdp.h::TraceDataBufferPosition" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a57">TraceDataBufferPosition</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00486">486</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="kdp.h::TraceDataSyms" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d1/struct__TRACE__DATA__SYM.html">TRACE_DATA_SYM</a> <a class="el" href="../../d1/d7/4_2kdp_8h.html#a58">TraceDataSyms</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00487">487</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="kdp.h::WatchStepOver" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a62">WatchStepOver</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00491">491</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="kdp.h::WatchStepOverBreakAddr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d1/d7/4_2kdp_8h.html#a66">WatchStepOverBreakAddr</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00495">495</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="kdp.h::WatchStepOverHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a65">WatchStepOverHandle</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00494">494</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="kdp.h::WatchStepOverSuspended" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d7/4_2kdp_8h.html#a67">WatchStepOverSuspended</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00496">496</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="kdp.h::WSOEsp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d7/4_2kdp_8h.html#a64">WSOEsp</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00493">493</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="kdp.h::WSOThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d1/d7/4_2kdp_8h.html#a63">WSOThread</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/kdp_8h-source.html#l00492">492</a> of file <a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:26 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
