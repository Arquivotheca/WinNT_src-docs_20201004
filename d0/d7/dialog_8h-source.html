<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: dialog.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>dialog.h</h1><a href="../../d9/d7/dialog_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  Header File:  Dialog.H</span>
00004 <span class="comment"></span>
00005 <span class="comment">  This defines the C++ class used to encapsulate dialogs.  It supports both</span>
00006 <span class="comment">  modal and modeless styles.  This class uses a static method for the dialog</span>
00007 <span class="comment">  procedure, which automatically caches the "this" pointer for the class in the</span>
00008 <span class="comment">  DWL_USER field of the window's internal structure for the dialog.  This</span>
00009 <span class="comment">  hand-off is accomplished by setting the lParam parameter on a DialogBoxParam</span>
00010 <span class="comment">  or CreateDialogParam call to the "this" pointer.  It also saves the dialog</span>
00011 <span class="comment">  handle in a protected member for easy access from derived classes.</span>
00012 <span class="comment"></span>
00013 <span class="comment">  To create a C++ class for any specific dialog, derive the class from this</span>
00014 <span class="comment">  class, providing the dialog ID and instance handle needed to get the dialog</span>
00015 <span class="comment">  resource in the derived class constructor.  Also provide the parent window</span>
00016 <span class="comment">  handle, if there is one.</span>
00017 <span class="comment"></span>
00018 <span class="comment">  The dialog procedure then provides virtual functions for Windows messages</span>
00019 <span class="comment">  of interest.  I've added these as needed.  If I were going to a truly</span>
00020 <span class="comment">  universal class of this sort, I'd just as well go to MFC, and save the</span>
00021 <span class="comment">  debugging time, so this approach seems reasonable to me.</span>
00022 <span class="comment"></span>
00023 <span class="comment">  12-11-96- to support the hook procedure used in the application UI, I've</span>
00024 <span class="comment">  added two protected members to allow this support to be in the base class.</span>
00025 <span class="comment">  If there is a hook procedure, it gets first chance at all messages except</span>
00026 <span class="comment">  WM_INITDIALOG.  If it returns TRUE, we do no further processing, otherwise</span>
00027 <span class="comment">  we will call the various overrides, if applicable.</span>
00028 <span class="comment"></span>
00029 <span class="comment">  For WM_INITDIALOG, we call any overrides first.  The derived class' OnInit</span>
00030 <span class="comment">  procedure can then supply an LPARAM for the hook procedure (e.g., a pointer</span>
00031 <span class="comment">  to some relevant class member), if desired.  We handle the returns from the</span>
00032 <span class="comment">  calls so that if either an override or the hook procedure states it has</span>
00033 <span class="comment">  altered the focus, we return the appropriate value.  This is pretty standard</span>
00034 <span class="comment">  handling for dialog hooks, so it should serve well, and it's almost 0 code.</span>
00035 <span class="comment"></span>
00036 <span class="comment">  Copyright (c) 1996 by Microsoft Corporation</span>
00037 <span class="comment"></span>
00038 <span class="comment">  A Pretty Penny Enterprises Production</span>
00039 <span class="comment"></span>
00040 <span class="comment">  Change History:</span>
00041 <span class="comment"></span>
00042 <span class="comment">  11-01-96  a-robkj@microsoft.com- original version</span>
00043 <span class="comment">  12-11-96  a-robkj@microsoft.com   Added hook procedure support</span>
00044 <span class="comment"></span>
00045 <span class="comment">******************************************************************************/</span>
00046 
00047 <span class="preprocessor">#if !defined(DIALOG_STUFF)</span>
00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="../../d9/d7/dialog_8h.html#a0">00049</a> <span class="preprocessor">#define DIALOG_STUFF</span>
00050 <span class="preprocessor"></span>
<a name="l00051"></a><a class="code" href="../../d3/d2/classCDialog.html">00051</a> <span class="keyword">class </span><a class="code" href="../../d3/d2/classCDialog.html">CDialog</a> {
00052 
00053     <span class="keyword">static</span> INT_PTR CALLBACK    <a class="code" href="../../d3/d2/classCDialog.html#h0">DialogProc</a>(HWND hwndPage, <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uMsg, WPARAM wp,
00054                                        LPARAM lp);
<a name="l00055"></a><a class="code" href="../../d3/d2/classCDialog.html#r0">00055</a>     <span class="keywordtype">int</span>         <a class="code" href="../../d3/d2/classCDialog.html#r0">m_idMain</a>;
<a name="l00056"></a><a class="code" href="../../d3/d2/classCDialog.html#r1">00056</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        <a class="code" href="../../d3/d2/classCDialog.html#r1">m_bIsModal</a>;
00057 
00058 <span class="keyword">protected</span>:
00059 
00060     <span class="comment">//  These should be protected (accessible only from derived classes)</span>
00061     <span class="comment">//  The instance is available for string table or other resource access</span>
00062 
<a name="l00063"></a><a class="code" href="../../d3/d2/classCDialog.html#p0">00063</a>     HWND        <a class="code" href="../../d3/d2/classCDialog.html#p0">m_hwndParent</a>;
<a name="l00064"></a><a class="code" href="../../d3/d2/classCDialog.html#p1">00064</a>     HWND        <a class="code" href="../../d3/d2/classCDialog.html#p1">m_hwnd</a>;
<a name="l00065"></a><a class="code" href="../../d3/d2/classCDialog.html#p2">00065</a>     HINSTANCE   <a class="code" href="../../d3/d2/classCDialog.html#p2">m_hiWhere</a>;
<a name="l00066"></a><a class="code" href="../../d3/d2/classCDialog.html#p3">00066</a>     DLGPROC     <a class="code" href="../../d3/d2/classCDialog.html#p3">m_dpHook</a>;       <span class="comment">//  Dialog Hook Procedure</span>
<a name="l00067"></a><a class="code" href="../../d3/d2/classCDialog.html#p4">00067</a>     LPARAM      <a class="code" href="../../d3/d2/classCDialog.html#p4">m_lpHook</a>;       <span class="comment">//  LPARAM for Hook WM_INITDIALOG call</span>
00068 
00069 <span class="keyword">public</span>:
00070 
00071     <span class="comment">//  Our constructor requires the resource ID and instance.  Not</span>
00072     <span class="comment">//  unreasonable for this project.</span>
00073 
00074     <a class="code" href="../../d3/d2/classCDialog.html">CDialog</a>(HINSTANCE hiWhere, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, HWND hwndParent = NULL);
00075     <a class="code" href="../../d3/d2/classCDialog.html">CDialog</a>(<a class="code" href="../../d3/d2/classCDialog.html">CDialog</a>&amp; cdOwner, <span class="keywordtype">int</span> <span class="keywordtype">id</span>);
00076     <a class="code" href="../../d3/d2/classCDialog.html#a2">~CDialog</a>();
00077 
00078     <span class="comment">//  Modal dialog box operation</span>
00079 
00080     LONG    <a class="code" href="../../d3/d2/classCDialog.html#a3">DoModal</a>();
00081 
00082     <span class="comment">//  Modeless dialog boxes- create and destroy.  We only allow one</span>
00083     <span class="comment">//  modeless DB per instance of this class.</span>
00084 
00085     <span class="keywordtype">void</span>    <a class="code" href="../../d3/d2/classCDialog.html#a4">Create</a>();   <span class="comment">//  For modeless boxes</span>
00086     <span class="keywordtype">void</span>    <a class="code" href="../../d3/d2/classCDialog.html#a5">Destroy</a>();
00087 
00088     <span class="comment">//  This allows us to adjust the position of a dialog in its parent window.</span>
00089     <span class="comment">//  We use only the left and top members of the given rectangle.</span>
00090 
00091     <span class="keywordtype">void</span>    <a class="code" href="../../d3/d2/classCDialog.html#a6">Adjust</a>(RECT&amp; rc);
00092 
00093     <span class="comment">//  Windows message overrides</span>
00094 
00095     <span class="comment">//  WM_COMMAND- control notifications.  We assure you can always get out</span>
00096     <span class="comment">//  of a modal dialog by pressing any button to make prototyping easy.</span>
00097 
<a name="l00098"></a><a class="code" href="../../d3/d2/classCDialog.html#a7">00098</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d3/d2/classCDialog.html#a7">OnCommand</a>(WORD wNotifyCode, WORD wid, HWND hwndCtl) {
00099         <span class="comment">//  Call EndDialog for all BN_CLICKED messages on Modal boxes</span>
00100         <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d2/classCDialog.html#r1">m_bIsModal</a> &amp;&amp; wNotifyCode == BN_CLICKED)
00101             <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(<a class="code" href="../../d3/d2/classCDialog.html#p1">m_hwnd</a>, wid);
00102         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00103     }
00104 
00105     <span class="comment">//  WM_NOTIFY- common control notifications</span>
00106 
<a name="l00107"></a><a class="code" href="../../d3/d2/classCDialog.html#a8">00107</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d3/d2/classCDialog.html#a8">OnNotify</a>(<span class="keywordtype">int</span> idCtrl, LPNMHDR pnmh) {
00108         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00109     }
00110 
00111     <span class="comment">//  WM_INITDIALOG- before being called, this and m_hwnd will be valid.</span>
00112 
<a name="l00113"></a><a class="code" href="../../d3/d2/classCDialog.html#a9">00113</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d3/d2/classCDialog.html#a9">OnInit</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; }
00114 
00115     <span class="comment">//  WM_HELP and WM_CONTEXTMENU- for context-sensitive help.</span>
00116 
<a name="l00117"></a><a class="code" href="../../d3/d2/classCDialog.html#a10">00117</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d3/d2/classCDialog.html#a10">OnHelp</a>(LPHELPINFO pHelp) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; }
<a name="l00118"></a><a class="code" href="../../d3/d2/classCDialog.html#a11">00118</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d3/d2/classCDialog.html#a11">OnContextMenu</a>(HWND hwnd) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; }
00119 };
00120 
00121 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:44 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
