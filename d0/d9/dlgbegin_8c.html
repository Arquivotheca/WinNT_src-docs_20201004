<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: dlgbegin.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>dlgbegin.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d1/d8/dlgbegin_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a0">GET_DESKTOP_CHARSET</a>()&nbsp;&nbsp;&nbsp;(GetTextCharset(hdcDlg))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a1">DLGRSC_VER_NT5COMPAT_RESERVE</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a2">CD_VISIBLE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a3">CD_GLOBALEDIT</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a4">CD_USERFONT</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a5">CD_SETFOREGROUND</a>&nbsp;&nbsp;&nbsp;0x08</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a6">CD_USEDEFAULTX</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a7">CD_USEDEFAULTCX</a>&nbsp;&nbsp;&nbsp;0x20</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a11">ValidateCallback</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a12">DefShortToInt</a> (short s)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a13">SkipSz</a> (UTCHAR *lpsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a14">WordSkipSz</a> (UTCHAR *lpsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a15">DWordSkipSz</a> (UTCHAR *lpsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a16">IsFontNotGood</a> (LPWSTR szTempBuffer, LPCWSTR lpStrSubst, TEXTMETRIC *ptm)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int CALLBACK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a17">GetCharsetEnumProc</a> (LPLOGFONT lpLogFont, LPTEXTMETRIC lptm, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nType, LPARAM lpData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a18">GetACPCharSet</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a19">FixupDlgLogFont</a> (HDC hdcDlg, LPLOGFONT lpLogFont, LPDLGTEMPLATE2 lpdt, BOOLEAN fUseShellFont2, BOOLEAN *pfWillTryDefaultCharset)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a20">FixupDlgFaceName</a> (LPLOGFONT lpLogFont, BOOLEAN fUseShellFont, BOOLEAN fUseShellFont2, LPCWSTR lpStrSubst)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HFONT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a21">CreateDlgFont</a> (HDC hdcDlg, LPWORD FAR *lplpstr, LPDLGTEMPLATE2 lpdt, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwExpWinVer, UINT fSCDLGFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a22">GetDialogMonitor</a> (HWND hwndOwner, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a23">InternalCreateDialog</a> (HANDLE hmod, LPDLGTEMPLATE lpdt, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb, HWND hwndOwner, DLGPROC lpfnDialog, LPARAM lParam, UINT fSCDLGFlags)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a8">szEDITCLASS</a> [] = TEXT("Edit")</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a9">gwszShellFont</a> [] = L"MS Shell Dlg"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/dlgbegin_8c.html#a10">gwszShellFont2</a> [] = L"MS Shell Dlg 2"</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a3" doxytag="dlgbegin.c::CD_GLOBALEDIT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_GLOBALEDIT&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00470">470</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="dlgbegin.c::CD_SETFOREGROUND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_SETFOREGROUND&nbsp;&nbsp;&nbsp;0x08          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00472">472</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="dlgbegin.c::CD_USEDEFAULTCX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_USEDEFAULTCX&nbsp;&nbsp;&nbsp;0x20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00474">474</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="dlgbegin.c::CD_USEDEFAULTX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_USEDEFAULTX&nbsp;&nbsp;&nbsp;0x10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00473">473</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="dlgbegin.c::CD_USERFONT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_USERFONT&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00471">471</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="dlgbegin.c::CD_VISIBLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CD_VISIBLE&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00469">469</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="dlgbegin.c::DLGRSC_VER_NT5COMPAT_RESERVE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DLGRSC_VER_NT5COMPAT_RESERVE&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00175">175</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00177">FixupDlgLogFont()</a>, and <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="dlgbegin.c::GET_DESKTOP_CHARSET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GET_DESKTOP_CHARSET          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(GetTextCharset(hdcDlg))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00170">170</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00177">FixupDlgLogFont()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a21" doxytag="dlgbegin.c::CreateDlgFont" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HFONT CreateDlgFont           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdcDlg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWORD FAR *&nbsp;</td>
          <td class="mdname" nowrap> <em>lplpstr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDLGTEMPLATE2&nbsp;</td>
          <td class="mdname" nowrap> <em>lpdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwExpWinVer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>fSCDLGFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">282</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l13593">DWordSkipSz()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00254">FixupDlgFaceName()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00177">FixupDlgLogFont()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00106">GetCharsetEnumProc()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00023">gwszShellFont</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00480">Is400Compat</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00088">IsFontNotGood()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00624">MultDiv</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00283 {
00284     LOGFONT     LogFont;
00285     <span class="keywordtype">int</span>         fontheight, fheight;
00286     HFONT       hOldFont, hFont;
00287     WCHAR       szTempBuffer[LF_FACESIZE];
00288     LPCWSTR     lpStrSubst;
00289     TEXTMETRIC  tm;
00290     <span class="comment">// Font hacks</span>
00291     BOOLEAN     fDeleteFont;
00292     BOOLEAN     fWillTryDefaultCharset = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00293     BOOLEAN     fUseShellFont, fUseShellFont2;
00294 
00295     UNREFERENCED_PARAMETER(dwExpWinVer);
00296     UNREFERENCED_PARAMETER(fSCDLGFlags);
00297 
00298     fheight = fontheight = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(*((WORD *) *lplpstr)++);
00299 
00300     <span class="keywordflow">if</span> (fontheight == 0x7FFF) {
00301         <span class="comment">// a 0x7FFF height is our special code meaning use the message box font</span>
00302         GetObject(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hMsgFont, <span class="keyword">sizeof</span>(LOGFONT), &amp;LogFont);
00303         <span class="keywordflow">return</span> CreateFontIndirect(&amp;LogFont);
00304     }
00305 
00306     <span class="comment">//</span>
00307     <span class="comment">// The dialog template contains a font description! Use it.</span>
00308     <span class="comment">//</span>
00309 
00310     <span class="comment">// Fill the LogFont with default values</span>
00311     RtlZeroMemory(&amp;LogFont, <span class="keyword">sizeof</span>(LOGFONT));
00312 
00313     fontheight = -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a141">MultDiv</a>(fontheight, <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;dmLogPixels, 72);
00314     LogFont.lfHeight = fontheight;
00315 
00316     <span class="keywordflow">if</span> (lpdt-&gt;wDlgVer) {
00317         <span class="comment">//</span>
00318         <span class="comment">// If it's DIALOGEX, additional info should be read from</span>
00319         <span class="comment">// the template.</span>
00320         <span class="comment">//</span>
00321         LogFont.lfWeight  = *((WORD <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) *lplpstr)++;
00322         LogFont.lfItalic  = *((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) *lplpstr)++;
00323         LogFont.lfCharSet = *((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) *lplpstr)++;
00324     }
00325 
00326     <span class="comment">//</span>
00327     <span class="comment">// Per shell team request, the dialog who has DS_SETFONT</span>
00328     <span class="comment">// *and* DS_FIXEDSYS (=&gt; DS_SHELLFONT2) should have a font</span>
00329     <span class="comment">// "MS Shell Dlg 2".</span>
00330     <span class="comment">//</span>
00331     lpStrSubst = *lplpstr;
00332 
00333     <span class="comment">//</span>
00334     <span class="comment">// Set the pointer to the next item.</span>
00335     <span class="comment">//</span>
00336     *lplpstr = (WORD*)<a class="code" href="../../d2/d1/userexts_8c.html#a253">DWordSkipSz</a>(*lplpstr);
00337 
00338     fUseShellFont = _wcsicmp(lpStrSubst, gwszShellFont) == 0;
00339 
00340     <span class="comment">//</span>
00341     <span class="comment">// Later shell team request again, to use "Dlg 2" font only</span>
00342     <span class="comment">// when facename in the dialog template is "MS Shell Dlg".</span>
00343     <span class="comment">//</span>
00344     fUseShellFont2 = fUseShellFont &amp;&amp;
00345         (lpdt-&gt;style &amp; DS_SHELLFONT) == DS_SHELLFONT &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a105">Is400Compat</a>(dwExpWinVer) &amp;&amp; lpdt-&gt;wDlgVer != 0;
00346 
00347     <span class="keywordflow">if</span> (fUseShellFont2) {
00348         TAGMSG0(DBGTAG_IMM, <span class="stringliteral">"CreateDlgFont: fUseShellFont2=TRUE"</span>);
00349     }
00350 
00351     <span class="comment">//</span>
00352     <span class="comment">// Prepare the font character set.</span>
00353     <span class="comment">//</span>
00354     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d9/dlgbegin_8c.html#a19">FixupDlgLogFont</a>(hdcDlg, &amp;LogFont, lpdt, fUseShellFont2, &amp;fWillTryDefaultCharset)) {
00355         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00356     }
00357 
00358     <span class="comment">//</span>
00359     <span class="comment">// Prepare the font facename.</span>
00360     <span class="comment">//</span>
00361     <a class="code" href="../../d0/d9/dlgbegin_8c.html#a20">FixupDlgFaceName</a>(&amp;LogFont, fUseShellFont, fUseShellFont2, lpStrSubst);
00362 
00363     <span class="keywordflow">if</span> (lpdt-&gt;wDlgVer &lt; 2 &amp;&amp; lpdt-&gt;style &amp; DS_3DLOOK)
00364         LogFont.lfWeight = FW_NORMAL;
00365 
00366 TryDefaultCharset:
00367     <span class="keywordflow">if</span> (LogFont.lfCharSet == DEFAULT_CHARSET) {
00368         <span class="comment">//</span>
00369         <span class="comment">// Get character set for given facename.</span>
00370         <span class="comment">//</span>
00371         EnumFonts(hdcDlg, LogFont.lfFaceName,
00372                   (FONTENUMPROC)GetCharsetEnumProc, (LPARAM)(&amp;LogFont));
00373         <span class="comment">//</span>
00374         <span class="comment">// We already tried default charset.</span>
00375         <span class="comment">//</span>
00376         fWillTryDefaultCharset = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00377     }
00378 
00379     <span class="comment">//</span>
00380     <span class="comment">// [Windows 3.1 FarEast version did this...]</span>
00381     <span class="comment">//</span>
00382     <span class="comment">// Use FW_NORMAL as default for DIALOG template. For DIALOGEX</span>
00383     <span class="comment">// template, we need to respect the value in the template.</span>
00384     <span class="comment">//</span>
00385     <span class="keywordflow">if</span> ((!(lpdt-&gt;wDlgVer)) &amp;&amp; <span class="comment">// not DIALOGEX template ?</span>
00386         (IS_ANY_DBCS_CHARSET(LogFont.lfCharSet)) &amp;&amp; <span class="comment">// any FarEast font ?</span>
00387         (LogFont.lfWeight != FW_NORMAL)) { <span class="comment">// already FW_NORMAL ?</span>
00388 
00389         <span class="comment">//</span>
00390         <span class="comment">// Set weight to FW_NORMAL.</span>
00391         <span class="comment">//</span>
00392         LogFont.lfWeight = FW_NORMAL;
00393     }
00394 
00395     <span class="keywordflow">if</span> (!(hFont = CreateFontIndirect((LPLOGFONT) &amp;LogFont)))
00396         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00397 
00398     fDeleteFont = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00399 
00400     <span class="keywordflow">if</span> ((hOldFont = SelectFont(hdcDlg, hFont)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00401         fDeleteFont = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00402     }
00403     <span class="keywordflow">else</span> {
00404         <span class="comment">//</span>
00405         <span class="comment">// If this dialog has DS_SHELLFONT style, or the font is</span>
00406         <span class="comment">// "MS Shell Dlg", we don't judge the font integrity,</span>
00407         <span class="comment">// for they have been given the ACP based character set.</span>
00408         <span class="comment">//</span>
00409         <span class="keywordflow">if</span> (!fUseShellFont) {
00410             <span class="keywordflow">if</span> (!GetTextMetrics(hdcDlg, &amp;tm)) {
00411                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateDlgFont: GetTextMetrics failed"</span>);
00412                 fDeleteFont = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00413             }
00414             <span class="keywordflow">else</span> {
00415                 GetTextFaceAliasW(hdcDlg, <span class="keyword">sizeof</span>(szTempBuffer)/<span class="keyword">sizeof</span>(WCHAR), szTempBuffer);
00416 
00417                 <span class="comment">//</span>
00418                 <span class="comment">// If this is a low res device, we need to check if the</span>
00419                 <span class="comment">// font we're creating is smaller than the system font.</span>
00420                 <span class="comment">// If so, just use the system font.</span>
00421                 <span class="comment">//</span>
00422                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9/dlgbegin_8c.html#a16">IsFontNotGood</a>(szTempBuffer, lpStrSubst, &amp;tm)) {
00423                     <span class="comment">//</span>
00424                     <span class="comment">// Couldn't find a font with the height or facename</span>
00425                     <span class="comment">// the app wanted so use the system font instead. Note</span>
00426                     <span class="comment">// that we need to make sure the app knows it is</span>
00427                     <span class="comment">// getting the system font via the WM_SETFONT message</span>
00428                     <span class="comment">// so we still need to act as if a new font is being</span>
00429                     <span class="comment">// sent to the dialog box.</span>
00430                     <span class="comment">//</span>
00431                     fDeleteFont = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00432                 }
00433             }
00434         }
00435 
00436         UserAssert(hOldFont != NULL);
00437         SelectFont(hdcDlg, hOldFont);
00438     }
00439 
00440     <span class="keywordflow">if</span> (fDeleteFont) {
00441         DeleteFont(hFont);
00442         <span class="comment">//</span>
00443         <span class="comment">// Font is deleted, Prepare for reTry...</span>
00444         <span class="comment">//</span>
00445         hFont = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00446     }
00447 
00448     <span class="comment">// Font hack:</span>
00449     <span class="comment">//</span>
00450     <span class="comment">// 1. We fail to create font.</span>
00451     <span class="comment">// 2. We did *NOT* try to enumerate charset, yet.</span>
00452     <span class="comment">// 3. We want to try to enumerate charset</span>
00453     <span class="comment">//</span>
00454     <span class="comment">// if all of answer is 'Yes', we will try...</span>
00455     <span class="comment">//</span>
00456     <span class="keywordflow">if</span> (hFont == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; fWillTryDefaultCharset) {
00457         <span class="comment">//</span>
00458         <span class="comment">// Try DEFAULT_CHARSET.</span>
00459         <span class="comment">//</span>
00460         LogFont.lfCharSet = DEFAULT_CHARSET;
00461         <span class="keywordflow">goto</span> TryDefaultCharset;
00462     }
00463 
00464     <span class="keywordflow">return</span> hFont;
00465 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="dlgbegin.c::DefShortToInt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline int DefShortToInt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">short&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>s</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00040">40</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02743">CW2_USEDEFAULT</a>, and <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.
<p>
<pre class="fragment"><div>00041 {
00042     <span class="keywordflow">if</span> (s == (<span class="keywordtype">short</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a>) {
00043         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(WORD)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a>;
00044     } <span class="keywordflow">else</span> {
00045         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)s;
00046     }
00047 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="dlgbegin.c::DWordSkipSz" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> DWordSkipSz           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UTCHAR *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00072">72</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00887">NextDWordBoundary</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, and <a class="el" href="../../d3/d0/userexts_8c-source.html#l13551">SkipSz()</a>.
<p>
<pre class="fragment"><div>00074 {
00075     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pb = <a class="code" href="../../d2/d1/userexts_8c.html#a251">SkipSz</a>(lpsz);
00076     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a124">NextDWordBoundary</a>(pb);
00077 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="dlgbegin.c::FixupDlgFaceName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FixupDlgFaceName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGFONT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpLogFont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>fUseShellFont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>fUseShellFont2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpStrSubst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00254">254</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00075">ARRAY_SIZE</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00133">GetACPCharSet()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00024">gwszShellFont2</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d2/d4/w32_2ntuser_2rtl_2random_8c-source.html#l00146">wcsncpycch()</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">CreateDlgFont()</a>.
<p>
<pre class="fragment"><div>00259 {
00260     <span class="keywordflow">if</span> (fUseShellFont2) {
00261         <span class="comment">//</span>
00262         <span class="comment">// OK, we use "MS Shell Dlg 2" as a face name.</span>
00263         <span class="comment">//</span>
00264         <a class="code" href="../../d1/d5/w32_2ntuser_2rtl_2random_8c.html#a3">wcsncpycch</a>(lpLogFont-&gt;lfFaceName, gwszShellFont2, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a2">ARRAY_SIZE</a>(gwszShellFont2));
00265     }
00266     <span class="keywordflow">else</span> {
00267         <span class="comment">//</span>
00268         <span class="comment">// Otherwise, get the face name from the dialog template.</span>
00269         <span class="comment">//</span>
00270         <a class="code" href="../../d1/d5/w32_2ntuser_2rtl_2random_8c.html#a3">wcsncpycch</a>(lpLogFont-&gt;lfFaceName, lpStrSubst, <span class="keyword">sizeof</span>(lpLogFont-&gt;lfFaceName) / <span class="keyword">sizeof</span>(WCHAR));
00271     }
00272 
00273     <span class="comment">//</span>
00274     <span class="comment">// "MS Shell Dlg" and "MS Shell Dlg2" should have native character set ---</span>
00275     <span class="comment">//</span>
00276     <span class="keywordflow">if</span> (fUseShellFont || fUseShellFont2) {
00277         lpLogFont-&gt;lfCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d0/d9/dlgbegin_8c.html#a18">GetACPCharSet</a>();
00278     }
00279 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="dlgbegin.c::FixupDlgLogFont" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL FixupDlgLogFont           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdcDlg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPLOGFONT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpLogFont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDLGTEMPLATE2&nbsp;</td>
          <td class="mdname" nowrap> <em>lpdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>fUseShellFont2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>pfWillTryDefaultCharset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00177">177</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00175">DLGRSC_VER_NT5COMPAT_RESERVE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00170">GET_DESKTOP_CHARSET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00590">IS_DBCS_ENABLED</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">CreateDlgFont()</a>.
<p>
<pre class="fragment"><div>00183 {
00184     <span class="keywordflow">switch</span> (lpdt-&gt;wDlgVer) {
00185     <span class="keywordflow">case</span> 0:
00186         <span class="comment">// DIALOG statement, which only has a facename.</span>
00187         <span class="comment">// The new applications are not supposed to use DIALOG statement,</span>
00188         <span class="comment">// they should use DIALOGEX instead.</span>
00189         lpLogFont-&gt;lfWeight  = FW_BOLD;
00190         <span class="keywordflow">if</span> (!fUseShellFont2) {
00191             lpLogFont-&gt;lfCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d0/d9/dlgbegin_8c.html#a0">GET_DESKTOP_CHARSET</a>();
00192             *pfWillTryDefaultCharset = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00193         }
00194         <span class="keywordflow">break</span>;
00195     <span class="keywordflow">case</span> 1:
00196         <span class="comment">//</span>
00197         <span class="comment">// Win4 compatible DLG template</span>
00198         <span class="comment">//</span>
00199         <span class="keywordflow">if</span> (!fUseShellFont2) {
00200             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a125">IS_DBCS_ENABLED</a>()) {
00201                 <span class="keywordflow">if</span> (lpLogFont-&gt;lfCharSet == ANSI_CHARSET) {
00202                     <span class="comment">//</span>
00203                     <span class="comment">// When resource compiler generates dialog resource data</span>
00204                     <span class="comment">// from DIALOGEX template, it can specify 'charset'. but</span>
00205                     <span class="comment">// optional, if it is not specified, it will be filled</span>
00206                     <span class="comment">// with 0 (ANSI charset). But, on localized version,</span>
00207                     <span class="comment">// User might guess the default will be localized-charset</span>
00208                     <span class="comment">//</span>
00209                     <span class="comment">// [Dialog Resource File]</span>
00210                     <span class="comment">//</span>
00211                     <span class="comment">// DIALOGEX ...</span>
00212                     <span class="comment">// ...</span>
00213                     <span class="comment">// FONT pointsize, typeface, [weight], [italic], [charset]</span>
00214                     <span class="comment">//</span>
00215                     <span class="comment">// #100182</span>
00216                     <span class="comment">// Bogus hack:</span>
00217                     <span class="comment">// Some FE fonts started to have ANSI_CHARSET so the first attept would succeed.</span>
00218                     <span class="comment">// We should enumerate the charset from the beginning.</span>
00219                     lpLogFont-&gt;lfCharSet = DEFAULT_CHARSET;
00220                     RIPMSG0(RIP_VERBOSE, <span class="stringliteral">"No proper CharSet information in DIALOGEX"</span>);
00221                 }
00222             }
00223             <span class="comment">/*</span>
00224 <span class="comment">             * Note: Dialog resource version 2.0 or later has not been supported on</span>
00225 <span class="comment">             * Windows 95 and 98. As of Apr/98 we decided not to deploy this new feature</span>
00226 <span class="comment">             * in the standard tools. Still, NT 5 supports this new feature, preparing</span>
00227 <span class="comment">             * the future transition to do the right thing.</span>
00228 <span class="comment">             */</span>
00229             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpLogFont-&gt;lfCharSet == ANSI_CHARSET) {
00230                 <span class="comment">// If the first attempt fail, we'll enumerate the charset for the given facename</span>
00231                 *pfWillTryDefaultCharset = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00232             }
00233             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpLogFont-&gt;lfCharSet == DEFAULT_CHARSET) {
00234                 lpLogFont-&gt;lfCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d0/d9/dlgbegin_8c.html#a0">GET_DESKTOP_CHARSET</a>();
00235             }
00236         }
00237         <span class="keywordflow">break</span>;
00238     <span class="keywordflow">default</span>:
00239         <span class="keywordflow">if</span> (lpdt-&gt;wDlgVer &lt;= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a1">DLGRSC_VER_NT5COMPAT_RESERVE</a>) {
00240             <span class="comment">// we do nothing for the new resource compiler (&gt;= 2.0),</span>
00241             <span class="comment">// since this version of dialogs are guarunteed to have</span>
00242             <span class="comment">// the proper character set for the dialog font.</span>
00243         }
00244         <span class="keywordflow">else</span> {
00245             RIPMSG1(RIP_WARNING, <span class="stringliteral">"Version %d resource is not supported."</span>, lpdt-&gt;wDlgVer);
00246             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00247         }
00248         <span class="keywordflow">break</span>;
00249     }
00250 
00251     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00252 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="dlgbegin.c::GetACPCharSet" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT GetACPCharSet           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00133">133</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/nt6_2dlgbegin_8c-source.html#l00141">CreateDlgFont()</a>, <a class="el" href="../../d9/d3/editec_8c-source.html#l03820">ECGetDBCSVector()</a>, and <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00254">FixupDlgFaceName()</a>.
<p>
<pre class="fragment"><div>00134 {
00135     <span class="keyword">static</span> <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> charset = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)~0;
00136     CHARSETINFO csInfo;
00137 
00138     <span class="keywordflow">if</span> (charset != (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)~0) {
00139         <span class="keywordflow">return</span> charset;
00140     }
00141 
00142     <span class="comment">// Sundown: In the TCI_SRCCODEPAGE case, the GetACP() return value is zero-extended.</span>
00143     <span class="keywordflow">if</span> (!TranslateCharsetInfo((DWORD*)UIntToPtr( GetACP() ), &amp;csInfo, TCI_SRCCODEPAGE)) {
00144         <span class="keywordflow">return</span> DEFAULT_CHARSET;
00145     }
00146     charset = csInfo.ciCharset;
00147     UserAssert(charset != (UINT)~0);
00148     <span class="keywordflow">return</span> csInfo.ciCharset;
00149 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="dlgbegin.c::GetCharsetEnumProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int CALLBACK GetCharsetEnumProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGFONT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpLogFont</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTEXTMETRIC&nbsp;</td>
          <td class="mdname" nowrap> <em>lptm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lpData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00106">106</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">CreateDlgFont()</a>.
<p>
<pre class="fragment"><div>00111 {
00112     UNREFERENCED_PARAMETER(lptm);
00113     UNREFERENCED_PARAMETER(nType);
00114 
00115     <span class="comment">//</span>
00116     <span class="comment">// Use other than FIXED pitch sysfont when the face name isn't specified.</span>
00117     <span class="comment">//</span>
00118     <span class="keywordflow">if</span> ((lpLogFont-&gt;lfPitchAndFamily &amp; 3) == FIXED_PITCH)
00119     {
00120         <span class="keywordflow">if</span> (!lstrcmpi(lpLogFont-&gt;lfFaceName,L<span class="stringliteral">"System"</span>) ||
00121             !lstrcmpi(lpLogFont-&gt;lfFaceName,L<span class="stringliteral">"@System"</span>))
00122             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; <span class="comment">// try to get another system font metric</span>
00123     }
00124 
00125     ((LPLOGFONT)lpData)-&gt;lfCharSet = lpLogFont-&gt;lfCharSet;
00126     ((LPLOGFONT)lpData)-&gt;lfPitchAndFamily = lpLogFont-&gt;lfPitchAndFamily;
00127     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00128 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="dlgbegin.c::GetDialogMonitor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> GetDialogMonitor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00490">490</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
<pre class="fragment"><div>00491 {
00492     <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>    pMonitor;
00493     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>        pwnd;
00494     HWND        hwndForeground;
00495     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       pid;
00496 
00497     UserAssert(dwFlags == MONITOR_DEFAULTTONULL ||
00498                dwFlags == MONITOR_DEFAULTTOPRIMARY);
00499 
00500     pMonitor = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00501     <span class="keywordflow">if</span> (hwndOwner) {
00502         pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwndOwner);
00503         <span class="keywordflow">if</span> (pwnd &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a232">GETFNID</a>(pwnd) != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a196">FNID_DESKTOP</a>) {
00504             pMonitor = <a class="code" href="../../d9/d1/mmrtl_8c.html#a8">_MonitorFromWindow</a>(pwnd, MONITOR_DEFAULTTOPRIMARY);
00505         }
00506     } <span class="keywordflow">else</span> {
00507         <span class="comment">/*</span>
00508 <span class="comment">         * HACK!  They passed in no owner and are creating a top level</span>
00509 <span class="comment">         * dialog window.  Does this process own the foreground window?</span>
00510 <span class="comment">         * If so, pin to that window's monitor.  That way 16-bit apps</span>
00511 <span class="comment">         * will work mostly as expected, and old multithreaded dudes just</span>
00512 <span class="comment">         * might too.  Especially the shell, for whom many system UI pieces</span>
00513 <span class="comment">         * pop up random dialogs inside of API calls.</span>
00514 <span class="comment">         */</span>
00515 
00516         hwndForeground = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a199">NtUserGetForegroundWindow</a>();
00517         <span class="keywordflow">if</span> (hwndForeground) {
00518             <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwndForeground, &amp;pid);
00519             <span class="keywordflow">if</span> (pid == HandleToUlong(NtCurrentTeb()-&gt;ClientId.UniqueProcess)) {
00520                 pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwndForeground);
00521                 <span class="keywordflow">if</span> (pwnd) {
00522                     pMonitor = <a class="code" href="../../d9/d1/mmrtl_8c.html#a8">_MonitorFromWindow</a>(pwnd, MONITOR_DEFAULTTOPRIMARY);
00523                 }
00524             }
00525         }
00526     }
00527 
00528     <span class="keywordflow">if</span> (!pMonitor &amp;&amp; <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> == MONITOR_DEFAULTTOPRIMARY) {
00529         pMonitor = <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00530     }
00531 
00532     <span class="keywordflow">return</span> pMonitor;
00533 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="dlgbegin.c::InternalCreateDialog" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND InternalCreateDialog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDLGTEMPLATE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnDialog</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>fSCDLGFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">553</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l02696">UserRegisterWowHandlers()</a>.
<p>
<pre class="fragment"><div>00561 {
00562     HWND                hwnd;
00563     HWND                hwnd2;
00564     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>                pwnd;
00565     HWND                hwndNewFocus;
00566     HWND                hwndEditFirst = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00567     RECT                rc;
00568     WORD                w;
00569     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a>              *lpszMenu,
00570                         *lpszClass,
00571                         *lpszText,
00572                         *lpCreateParams,
00573                         *lpStr;
00574     <span class="keywordtype">int</span>                 cxChar,
00575                         cyChar;
00576     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>                f40Compat;
00577     HFONT               hNewFont = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00578     HFONT               hOldFont;
00579     LPDLGITEMTEMPLATE   lpdit;
00580     HMENU               hMenu;
00581     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>                fSuccess;
00582     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>                fWowWindow;
00583     HANDLE              hmodCreate;
00584     LPBYTE              lpCreateParamsData;
00585     DLGTEMPLATE2        <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>;
00586     DLGITEMTEMPLATE2    dit;
00587     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>               dwExpWinVer;
00588     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>               dsStyleOld;
00589     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>               bFlags = 0;
00590     HDC                 hdcDlg;
00591     <a class="code" href="../../d1/d9/struct__LARGE__STRING.html">LARGE_STRING</a>        strClassName;
00592     <a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>       pstrClassName;
00593     <a class="code" href="../../d1/d9/struct__LARGE__STRING.html">LARGE_STRING</a>        strWindowName;
00594     <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>            pMonitor;
00595 
00596     UNREFERENCED_PARAMETER(cb);
00597 
00598     <a class="code" href="../../d1/d0/inc_2user_8h.html#a848">ConnectIfNecessary</a>();
00599 
00600     UserAssert(!(fSCDLGFlags &amp; ~(SCDLG_CLIENT|SCDLG_ANSI|SCDLG_NOREVALIDATE|SCDLG_16BIT)));    <span class="comment">// These are the only valid flags</span>
00601 
00602     <span class="comment">/*</span>
00603 <span class="comment">     * Is this a Win4 extended dialog?</span>
00604 <span class="comment">     */</span>
00605     <span class="keywordflow">if</span> (((LPDLGTEMPLATE2)lpdt)-&gt;wSignature == 0xffff) {
00606 
00607         UserAssert(((LPDLGTEMPLATE2)lpdt)-&gt;wDlgVer &lt;= DLGRSC_VER_NT5COMPAT_RESERVE);
00608         RtlCopyMemory(&amp;dt, lpdt, <span class="keyword">sizeof</span> dt);
00609     } <span class="keywordflow">else</span> {
00610         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wDlgVer = 0;
00611         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wSignature = 0;
00612         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwHelpID = 0;
00613         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle = lpdt-&gt;dwExtendedStyle;
00614         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style = lpdt-&gt;style;
00615         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cDlgItems = lpdt-&gt;cdit;
00616         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x = lpdt-&gt;x;
00617         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.y = lpdt-&gt;y;
00618         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx = lpdt-&gt;cx;
00619         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy = lpdt-&gt;cy;
00620     }
00621 
00622     <span class="comment">/*</span>
00623 <span class="comment">     * If this is called from wow code, then the loword of hmod != 0.</span>
00624 <span class="comment">     * In this case, allow any DS_ style bits that were passed in win3.1</span>
00625 <span class="comment">     * to be legal in win32. Case in point: 16 bit quark xpress passes the</span>
00626 <span class="comment">     * same bit as the win32 style DS_SETFOREGROUND. Also, VC++ sample</span>
00627 <span class="comment">     * "scribble" does the same thing.</span>
00628 <span class="comment">     *</span>
00629 <span class="comment">     * For win32 apps test the DS_SETFOREGROUND bit; wow apps are not set</span>
00630 <span class="comment">     * foreground (this is the new NT semantics)</span>
00631 <span class="comment">     * We have to let no "valid" bits through because apps depend on them</span>
00632 <span class="comment">     * bug 5232.</span>
00633 <span class="comment">     */</span>
00634     dsStyleOld = LOWORD(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style);
00635 
00636     <span class="comment">/*</span>
00637 <span class="comment">     * If the app is Win4 or greater, require correct dialog style bits.</span>
00638 <span class="comment">     * Prevents conflicts with new bits introduced in Chicago</span>
00639 <span class="comment">     */</span>
00640     dwExpWinVer = <a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(hmod);
00641 
00642     <span class="keywordflow">if</span> ( f40Compat = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a105">Is400Compat</a>(dwExpWinVer) ) {
00643         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp;= (DS_VALID40 | 0xffff0000);
00644 
00645         <span class="comment">//</span>
00646         <span class="comment">// For old applications:</span>
00647         <span class="comment">//      If DS_COMMONDIALOG isn't set, don't touch DS_3DLOOK style</span>
00648         <span class="comment">// bit.  If it's there, it stays there.  If not, not.  That way old</span>
00649         <span class="comment">// apps which pass in their own templates, not commdlg's, don't get</span>
00650         <span class="comment">// forced 3D.</span>
00651         <span class="comment">//      If DS_COMMONDIALOG is there, remove DS_3DLOOK.</span>
00652         <span class="comment">//</span>
00653         <span class="comment">// For new applications:</span>
00654         <span class="comment">//      Force 3D always.</span>
00655         <span class="comment">//</span>
00656         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>) {
00657             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_COMMONDIALOG) {
00658                 <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp;= ~DS_3DLOOK;
00659                 dsStyleOld &amp;= ~DS_3DLOOK;
00660             }
00661         } <span class="keywordflow">else</span> {
00662             <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style |= DS_3DLOOK;
00663             dsStyleOld |= DS_3DLOOK;
00664         }
00665     } <span class="keywordflow">else</span> {
00666 <span class="preprocessor">#if DBG</span>
00667 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style != (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; (DS_VALID31 | DS_3DLOOK | 0xffff0000))) {
00668             RIPMSG1(RIP_WARNING, <span class="stringliteral">"CreateDialog: stripping invalid bits %lX"</span>, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style);
00669         }
00670 <span class="preprocessor">#endif // DBG</span>
00671 <span class="preprocessor"></span>
00672 
00673         <span class="comment">/*</span>
00674 <span class="comment">         * Don't strip off bits for old apps, they depend on this.  Especially 16 bit MFC apps!</span>
00675 <span class="comment">         *</span>
00676 <span class="comment">         * dt.dwStyle &amp;= (DS_VALID31 | 0xffff0000);</span>
00677 <span class="comment">         */</span>
00678     }
00679 
00680     <span class="keywordflow">if</span> (LOWORD((ULONG_PTR)hmod) == 0) {
00681         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_SETFOREGROUND)
00682             bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a5">CD_SETFOREGROUND</a>;
00683     }
00684 
00685     <span class="keywordflow">if</span> (dsStyleOld != LOWORD(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style))
00686     {
00687 
00688         RIPMSG1(f40Compat ? RIP_ERROR : RIP_WARNING,
00689                 <span class="stringliteral">"Bad dialog style bits (%x) - please remove."</span>,
00690                 LOWORD(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style));
00691         <span class="comment">// Fail new apps that pass in bogus bits!</span>
00692 
00693         <span class="keywordflow">if</span> (f40Compat) {
00694             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00695         }
00696     }
00697 
00698     <span class="keywordflow">if</span> ( <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_MODALFRAME) {
00699         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle |= WS_EX_DLGMODALFRAME | WS_EX_WINDOWEDGE;
00700     }
00701 
00702     <span class="keywordflow">if</span> (( <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_CONTEXTHELP) &amp;&amp; f40Compat) {
00703         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle |= WS_EX_CONTEXTHELP;
00704     }
00705 
00706     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_CONTROL) {
00707         <span class="comment">// Captions and system menus aren't allowed on "control" dialogs.</span>
00708         <span class="comment">// And strip DS_SYSMODAL.</span>
00709         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp;= ~(WS_CAPTION | WS_SYSMENU | DS_SYSMODAL);
00710     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; WS_DLGFRAME) {
00711         <span class="comment">// Add on window edge same way that CreateWindowEx() will</span>
00712         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle |= WS_EX_WINDOWEDGE;
00713     }
00714 
00715     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_SYSMODAL) {
00716         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle |= WS_EX_TOPMOST;
00717     }
00718 
00719     <span class="keywordflow">if</span> (!(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; WS_CHILD) || (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_CONTROL)) {
00720         <span class="comment">// only a control parent if it's not a child dialog or if it's</span>
00721         <span class="comment">// explicitly marked as a recursive dialog</span>
00722         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle |= WS_EX_CONTROLPARENT;
00723     }
00724 
00725     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x == (<span class="keywordtype">short</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a>) {
00726         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a6">CD_USEDEFAULTX</a>;
00727         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x = 0;
00728     }
00729 
00730     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx == (<span class="keywordtype">short</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a>) {
00731         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a7">CD_USEDEFAULTCX</a>;
00732         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx = 0;
00733     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx &lt; 0) {
00734         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx = 0;
00735     }
00736 
00737     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy &lt; 0) {
00738         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy = 0;
00739     }
00740 
00741 
00742     <span class="comment">// If there's a menu name string, load it.</span>
00743     lpszMenu = (LPWSTR)(((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(lpdt)) + (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wDlgVer ? <span class="keyword">sizeof</span>(DLGTEMPLATE2):<span class="keyword">sizeof</span>(DLGTEMPLATE)));
00744 
00745     <span class="comment">/*</span>
00746 <span class="comment">     * If the menu id is expressed as an ordinal and not a string,</span>
00747 <span class="comment">     * skip all 4 bytes to get to the class string.</span>
00748 <span class="comment">     */</span>
00749     w = *(LPWORD)lpszMenu;
00750 
00751     <span class="comment">/*</span>
00752 <span class="comment">     * If there's a menu name string, load it.</span>
00753 <span class="comment">     */</span>
00754     <span class="keywordflow">if</span> (w != 0) {
00755         <span class="keywordflow">if</span> ((hMenu = LoadMenu(hmod, (w == 0xFFFF) ?
00756                 MAKEINTRESOURCE(*(WORD *)((PBYTE)lpszMenu + 2)) : lpszMenu)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00757             RIPMSG0(RIP_WARNING, <span class="stringliteral">"ServerCreateDialog() failed: couldn't load menu"</span>);
00758             <span class="keywordflow">goto</span> DeleteFontAndMenuAndFail;
00759         }
00760     } <span class="keywordflow">else</span> {
00761         hMenu = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00762     }
00763 
00764     <span class="keywordflow">if</span> (w == 0xFFFF) {
00765         lpszClass = (LPWSTR)((LPBYTE)lpszMenu + 4);
00766     } <span class="keywordflow">else</span> {
00767         lpszClass = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a> *)<a class="code" href="../../d2/d1/userexts_8c.html#a252">WordSkipSz</a>(lpszMenu);
00768     }
00769 
00770     lpszText = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a> *)<a class="code" href="../../d2/d1/userexts_8c.html#a252">WordSkipSz</a>(lpszClass);
00771 
00772     lpStr = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a> *)<a class="code" href="../../d2/d1/userexts_8c.html#a252">WordSkipSz</a>(lpszText);
00773 
00774     hdcDlg = CreateCompatibleDC(NULL);
00775     <span class="keywordflow">if</span> (hdcDlg == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00776         <span class="keywordflow">goto</span> DeleteFontAndMenuAndFail;
00777 
00778     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_SETFONT) {
00779         hNewFont = <a class="code" href="../../d1/d9/nt6_2dlgbegin_8c.html#a16">CreateDlgFont</a>(hdcDlg, &amp;lpStr, &amp;dt, dwExpWinVer, fSCDLGFlags);
00780         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a4">CD_USERFONT</a>;
00781         lpdit = (LPDLGITEMTEMPLATE) <a class="code" href="../../d6/d0/usercli_8h.html#a124">NextDWordBoundary</a>(lpStr);
00782     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a105">Is400Compat</a>(dwExpWinVer) &amp;&amp; (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_FIXEDSYS)) {
00783 
00784         <span class="comment">//</span>
00785         <span class="comment">// B#2078 -- WISH for fixed width system font in dialog.  We need</span>
00786         <span class="comment">// to tell the dialog that it's using a font different from the</span>
00787         <span class="comment">// standard system font, so set CD_USERFONT bit.</span>
00788         <span class="comment">//</span>
00789         <span class="comment">// We need the 400 compat. check for CorelDraw, since they use</span>
00790         <span class="comment">// this style bit for their own purposes.</span>
00791         <span class="comment">//</span>
00792         hNewFont = GetStockObject(SYSTEM_FIXED_FONT);
00793         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a4">CD_USERFONT</a>;
00794         lpdit = (LPDLGITEMTEMPLATE)<a class="code" href="../../d6/d0/usercli_8h.html#a124">NextDWordBoundary</a>(lpStr);
00795     } <span class="keywordflow">else</span> {
00796         lpdit = (LPDLGITEMTEMPLATE)<a class="code" href="../../d6/d0/usercli_8h.html#a124">NextDWordBoundary</a>(lpStr);
00797     }
00798 
00799     <span class="comment">/*</span>
00800 <span class="comment">     * If the application requested a particular font and for some</span>
00801 <span class="comment">     * reason we couldn't find it, we just use the system font.  BUT we</span>
00802 <span class="comment">     * need to make sure we tell him he gets the system font.  Dialogs</span>
00803 <span class="comment">     * which never request a particular font get the system font and we</span>
00804 <span class="comment">     * don't bother telling them this (via the WM_SETFONT message).</span>
00805 <span class="comment">     */</span>
00806 
00807     <span class="comment">// Is it anything other than the default system font?  If we can't get</span>
00808     <span class="comment">// enough memory to select in the new font specified, just use the system</span>
00809     <span class="comment">// font.</span>
00810     <span class="keywordflow">if</span> (hNewFont &amp;&amp; (hOldFont = SelectFont(hdcDlg, hNewFont))) {
00811         <span class="comment">// Get the ave character width and height to be used</span>
00812         cxChar = GdiGetCharDimensions(hdcDlg, NULL, &amp;cyChar);
00813 
00814         SelectFont(hdcDlg, hOldFont);
00815         <span class="keywordflow">if</span> (cxChar == 0) {
00816             RIPMSG0(RIP_WARNING, <span class="stringliteral">"InternalCreateDialog: GdiGetCharDimensions failed"</span>);
00817             <span class="keywordflow">goto</span> UseSysFontMetrics;
00818         }
00819     }
00820     <span class="keywordflow">else</span>
00821     {
00822         <span class="keywordflow">if</span> (hNewFont || (bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a4">CD_USERFONT</a>))
00823             hNewFont = <a class="code" href="../../d1/d8/clglobal_8c.html#a28">ghFontSys</a>;
00824 
00825 UseSysFontMetrics:
00826         cxChar = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxSysFontChar;
00827         cyChar = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cySysFontChar;
00828     }
00829     DeleteDC(hdcDlg);
00830 
00831     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; WS_VISIBLE) {
00832         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a2">CD_VISIBLE</a>;
00833         <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp;= ~WS_VISIBLE;
00834     }
00835 
00836     <span class="keywordflow">if</span> (!(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_LOCALEDIT)) {
00837         bFlags |= <a class="code" href="../../d0/d9/dlgbegin_8c.html#a3">CD_GLOBALEDIT</a>;
00838     }
00839 
00840     <span class="comment">/* Figure out dimensions of real window</span>
00841 <span class="comment">     */</span>
00842     rc.left = rc.top = 0;
00843     rc.right = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx, cxChar);
00844     rc.bottom = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy, cyChar);
00845 
00846     <a class="code" href="../../d1/d0/inc_2user_8h.html#a1195">_AdjustWindowRectEx</a>(&amp;rc, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style, w, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle);
00847 
00848     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(rc.right - rc.left);
00849     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(rc.bottom - rc.top);
00850 
00851     <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_CENTERMOUSE) &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(MOUSEPRESENT) &amp;&amp; f40Compat) {
00852         pMonitor = <a class="code" href="../../d9/d1/mmrtl_8c.html#a6">_MonitorFromPoint</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;ptCursor, MONITOR_DEFAULTTONULL);
00853         UserAssert(pMonitor);
00854         *((LPPOINT)&amp;rc.left) = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;ptCursor;
00855         rc.left -= (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx / 2);
00856         rc.top  -= (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy / 2);
00857     } <span class="keywordflow">else</span> {
00858         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fNoDialogMonitor;
00859 
00860         pMonitor = <a class="code" href="../../d6/d0/usercli_8h.html#a762">GetDialogMonitor</a>(hwndOwner, MONITOR_DEFAULTTONULL);
00861         fNoDialogMonitor = pMonitor ? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00862         <span class="keywordflow">if</span> (!pMonitor) {
00863             pMonitor = <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00864         }
00865 
00866         <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; (DS_CENTER | DS_CENTERMOUSE)) &amp;&amp; f40Compat) {
00867             <span class="comment">/*</span>
00868 <span class="comment">             * Center to the work area of the owner monitor.</span>
00869 <span class="comment">             */</span>
00870             rc.left = (pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o4">rcWork</a>.left + pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o4">rcWork</a>.right - <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx) / 2;
00871             rc.top  = (pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o4">rcWork</a>.top + pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o4">rcWork</a>.bottom - <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy) / 2;
00872         } <span class="keywordflow">else</span> {
00873             rc.left = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x, cxChar);
00874             rc.top = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.y, cyChar);
00875 
00876             <span class="keywordflow">if</span> (!(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style &amp; DS_ABSALIGN) &amp;&amp; hwndOwner) {
00877                 <span class="comment">/*</span>
00878 <span class="comment">                 * Offset relative coordinates to the owner window. If it is</span>
00879 <span class="comment">                 * a child window, there is nothing to do.</span>
00880 <span class="comment">                 */</span>
00881                 <span class="keywordflow">if</span> ((HIWORD(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style) &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a734">MaskWF</a>(WFTYPEMASK)) != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a734">MaskWF</a>(WFCHILD)) {
00882                     <span class="comment">//This is will considre rc.left form the right hand side of the owner window if it a mirrored one.</span>
00883                     <a class="code" href="../../d3/d9/client_2wow_8c.html#a23">ClientToScreen</a>(hwndOwner, (LPPOINT)&amp;rc.left);
00884 
00885 <span class="preprocessor">#ifdef USE_MIRRORING</span>
00886 <span class="preprocessor"></span>                    <span class="comment">//It is not chiled then do Visual ClientToScreen</span>
00887                     <span class="comment">//i.e. rc.left it is form the left hand side of the owner window</span>
00888                     <span class="keywordflow">if</span> (MIRRORED_HWND(hwndOwner)) {
00889                         rc.left -= <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx;
00890                     }
00891 <span class="preprocessor">#endif</span>
00892 <span class="preprocessor"></span>
00893                 }
00894             } <span class="keywordflow">else</span> {
00895                 <span class="comment">/*</span>
00896 <span class="comment">                 * Position the dialog in screen coordinates. If the dialog's</span>
00897 <span class="comment">                 * owner is on a different monitor than specified in the</span>
00898 <span class="comment">                 * template, move the dialog to the owner window. If the owner</span>
00899 <span class="comment">                 * doesn't exist, then use the monitor from the dialog's</span>
00900 <span class="comment">                 * template.</span>
00901 <span class="comment">                 */</span>
00902 
00903                 <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>    pMonitorTemplate;
00904                 RECT        rcTemplate;
00905 
00906                 rcTemplate.left  = rc.left;
00907                 rcTemplate.top   = rc.top;
00908                 rcTemplate.right  = rc.left + <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx;
00909                 rcTemplate.bottom = rc.top + <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy;
00910 
00911                 pMonitorTemplate = <a class="code" href="../../d9/d1/mmrtl_8c.html#a7">_MonitorFromRect</a>(&amp;rcTemplate, MONITOR_DEFAULTTOPRIMARY);
00912                 <span class="keywordflow">if</span> (fNoDialogMonitor) {
00913                     pMonitor = pMonitorTemplate;
00914                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pMonitorTemplate != pMonitor) {
00915                     rc.left += pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>.left - pMonitorTemplate-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>.left;
00916                     rc.top  += pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>.top  - pMonitorTemplate-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>.top;
00917                 }
00918             }
00919         }
00920     }
00921 
00922     rc.right  = rc.left + <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx;
00923     rc.bottom = rc.top  + <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy;
00924 
00925     <span class="comment">// If the right or bottom coordinate has overflowed, then pin it back to</span>
00926     <span class="comment">// a valid rectangle.  Likely to happen if a minimized window is the owner of</span>
00927     <span class="comment">// the dialog.</span>
00928     <span class="keywordflow">if</span> (rc.left &gt; rc.right || rc.top &gt; rc.bottom) {
00929         <a class="code" href="../../d3/d6/rect_8c.html#a6">OffsetRect</a>(&amp;rc, -<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx, -<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy);
00930     }
00931 
00932    <span class="comment">//</span>
00933     <span class="comment">// Need to do this for ALL dialogs, not just top-level, since we used</span>
00934     <span class="comment">// to in 3.1.</span>
00935     <span class="comment">//</span>
00936 
00937     <span class="comment">// Clip top level dialogs within working area</span>
00938     <span class="comment">// Start child dialogs at least at (0, 0)</span>
00939     <a class="code" href="../../d6/d0/usercli_8h.html#a760">RepositionRect</a>(pMonitor, &amp;rc, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle);
00940 
00941     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x  = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)((bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a6">CD_USEDEFAULTX</a>) ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a> : rc.left);
00942     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.y  = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(rc.top);
00943     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)((bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a7">CD_USEDEFAULTCX</a>) ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a770">CW2_USEDEFAULT</a> : rc.right - rc.left);
00944     <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(rc.bottom - rc.top);
00945 
00946     <span class="keywordflow">if</span> (*lpszClass != 0) {
00947         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(lpszClass)) {
00948             <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;strClassName,
00949                     lpszClass, (UINT)-1);
00950             pstrClassName = &amp;strClassName;
00951         } <span class="keywordflow">else</span> {
00952             pstrClassName = (<a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>)lpszClass;
00953         }
00954     } <span class="keywordflow">else</span> {
00955         pstrClassName = (<a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a40">DIALOGCLASS</a>;
00956     }
00957 
00958     <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;strWindowName,
00959             lpszText, (UINT)-1);
00960 
00961     UserAssert((<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle &amp; WS_EX_MDICHILD) == 0);
00962     hwnd = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a290">NtUserCreateWindowEx</a>(
00963             <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwExStyle | ((fSCDLGFlags &amp; SCDLG_ANSI) ? WS_EX_ANSICREATOR : 0),
00964             pstrClassName,
00965             &amp;strWindowName,
00966             <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.style,
00967             <a class="code" href="../../d0/d9/dlgbegin_8c.html#a12">DefShortToInt</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.x),
00968             <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.y,
00969             <a class="code" href="../../d0/d9/dlgbegin_8c.html#a12">DefShortToInt</a>(<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cx),
00970             <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cy,
00971             hwndOwner,
00972             hMenu,
00973             hmod,
00974             (LPVOID)NULL,
00975             dwExpWinVer);
00976 
00977     <span class="keywordflow">if</span> (hwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00978         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateDialog() failed: couldn't create window"</span>);
00979 DeleteFontAndMenuAndFail:
00980         <span class="keywordflow">if</span> (hMenu != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00981             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a158">NtUserDestroyMenu</a>(hMenu);
00982         <span class="comment">/*</span>
00983 <span class="comment">         * Only delete the font if we didn't grab it</span>
00984 <span class="comment">         * from the dialog font cache.</span>
00985 <span class="comment">         */</span>
00986         <span class="keywordflow">if</span> ((hNewFont != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00987             DeleteObject(hNewFont);
00988         }
00989         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00990     }
00991 
00992     pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
00993 
00994     <span class="comment">// tell WOW the hDlg of the Window just created BEFORE they get any messages</span>
00995     <span class="comment">// at WOW32!w32win16wndprocex</span>
00996     <span class="keywordflow">if</span>(fSCDLGFlags &amp; SCDLG_16BIT) {
00997         <a class="code" href="../../d6/d0/usercli_8h.html#a765">TellWOWThehDlg</a>(hwnd);
00998     }
00999 
01000     <span class="comment">/*</span>
01001 <span class="comment">     * Before anything happens with this window, we need to mark it as a</span>
01002 <span class="comment">     * dialog window!!!! So do that.</span>
01003 <span class="comment">     */</span>
01004     <span class="keywordflow">if</span> (pwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || !<a class="code" href="../../d6/d0/usercli_8h.html#a761">ValidateDialogPwnd</a>(pwnd))
01005         <span class="keywordflow">goto</span> DeleteFontAndMenuAndFail;
01006 
01007     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwHelpID) {
01008         <a class="code" href="../../d6/d0/usercli_8h.html#a220">NtUserSetWindowContextHelpId</a>(hwnd, <a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.dwHelpID);
01009     }
01010 
01011     <span class="comment">/*</span>
01012 <span class="comment">     * Set up the system menu on this dialog box if it has one.</span>
01013 <span class="comment">     */</span>
01014     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFSYSMENU)) {
01015 
01016         <span class="comment">/*</span>
01017 <span class="comment">         * For a modal dialog box with a frame and caption, we want to</span>
01018 <span class="comment">         * delete the unselectable items from the system menu.</span>
01019 <span class="comment">         */</span>
01020         UserAssert(<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(WFSIZEBOX) == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(WFMINBOX));
01021         UserAssert(<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(WFMINBOX) == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(WFMAXBOX));
01022         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFSIZEBOX | WFMINBOX | WFMAXBOX)) {
01023 
01024             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a176">NtUserCallHwndLock</a>(hwnd, SFI_XXXSETDIALOGSYSTEMMENU);
01025         } <span class="keywordflow">else</span> {
01026 
01027             <span class="comment">/*</span>
01028 <span class="comment">             * We have to give this dialog its own copy of the system menu</span>
01029 <span class="comment">             * in case it modifies the menu.</span>
01030 <span class="comment">             */</span>
01031             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a202">NtUserGetSystemMenu</a>(hwnd, FALSE);
01032         }
01033     }
01034 
01035     <span class="comment">/*</span>
01036 <span class="comment">     * Set fDisabled to FALSE so EndDialog will Enable if dialog is ended</span>
01037 <span class="comment">     * before returning to DialogBox (or if modeless).</span>
01038 <span class="comment">     */</span>
01039     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fDisabled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01040 
01041     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;cxChar = cxChar;
01042     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;cyChar = cyChar;
01043     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;lpfnDlg = lpfnDialog;
01044     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01045     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;result = IDOK;
01046 
01047     <span class="comment">/*</span>
01048 <span class="comment">     * Need to remember Unicode status.</span>
01049 <span class="comment">     */</span>
01050     <span class="keywordflow">if</span> (fSCDLGFlags &amp; SCDLG_ANSI) {
01051         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;flags |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a794">DLGF_ANSI</a>;
01052     }
01053 
01054     <span class="comment">/*</span>
01055 <span class="comment">     * Have to do a callback here for WOW apps.  WOW needs what's in lParam</span>
01056 <span class="comment">     * before the dialog gets any messages.</span>
01057 <span class="comment">     */</span>
01058 
01059     <span class="comment">/*</span>
01060 <span class="comment">     * If the app is a Wow app then the Lo Word of the hInstance is the</span>
01061 <span class="comment">     * 16-bit hInstance.  Set the lParam, which no-one should look at</span>
01062 <span class="comment">     * but the app, to the 16 bit value</span>
01063 <span class="comment">     */</span>
01064     <span class="keywordflow">if</span> (LOWORD((ULONG_PTR)hmod) != 0) {
01065         fWowWindow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01066     } <span class="keywordflow">else</span> {
01067         fWowWindow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01068     }
01069 
01070     <span class="comment">/*</span>
01071 <span class="comment">     * If a user defined font is used, save the handle so that we can delete</span>
01072 <span class="comment">     * it when the dialog is destroyed.</span>
01073 <span class="comment">     */</span>
01074     <span class="keywordflow">if</span> (bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a4">CD_USERFONT</a>) {
01075 
01076         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hUserFont = hNewFont;
01077 
01078         <span class="keywordflow">if</span> (lpfnDialog != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01079             <span class="comment">/*</span>
01080 <span class="comment">             * Tell the dialog that it will be using this font...</span>
01081 <span class="comment">             */</span>
01082             <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, WM_SETFONT, (WPARAM)hNewFont, 0L, FALSE);
01083         }
01084     }
01085 
01086     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wDlgVer) {
01087         dit.dwHelpID = 0;
01088     }
01089 
01090     <span class="comment">/*</span>
01091 <span class="comment">     * Loop through the dialog controls, doing a CreateWindowEx() for each of</span>
01092 <span class="comment">     * them.</span>
01093 <span class="comment">     */</span>
01094     <span class="keywordflow">while</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.cDlgItems-- != 0) {
01095         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwExpWinVer2;
01096 
01097         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wDlgVer) {
01098             RtlCopyMemory(&amp;dit, lpdit, <span class="keyword">sizeof</span> dit);
01099         } <span class="keywordflow">else</span> {
01100             dit.dwHelpID = 0;
01101             dit.dwExStyle = lpdit-&gt;dwExtendedStyle;
01102             dit.style = lpdit-&gt;style;
01103             dit.x = lpdit-&gt;x;
01104             dit.y = lpdit-&gt;y;
01105             dit.cx = lpdit-&gt;cx;
01106             dit.cy = lpdit-&gt;cy;
01107             dit.dwID = lpdit-&gt;id;
01108         }
01109 
01110         dit.x = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(dit.x, cxChar);
01111         dit.y = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(dit.y, cyChar);
01112         dit.cx = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(dit.cx, cxChar);
01113         dit.cy = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(dit.cy, cyChar);
01114 
01115         lpszClass = (LPWSTR)(((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(lpdit)) + (<a class="code" href="../../d7/d4/conexts_8c.html#a26">dt</a>.wDlgVer ? <span class="keyword">sizeof</span>(DLGITEMTEMPLATE2):<span class="keyword">sizeof</span>(DLGITEMTEMPLATE)));
01116 
01117         <span class="comment">/*</span>
01118 <span class="comment">         * If the first WORD is 0xFFFF the second word is the encoded class name index.</span>
01119 <span class="comment">         * Use it to look up the class name string.</span>
01120 <span class="comment">         */</span>
01121         <span class="keywordflow">if</span> (*(LPWORD)lpszClass == 0xFFFF) {
01122             lpszText = lpszClass + 2;
01123             lpszClass = (LPWSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[*(((LPWORD)lpszClass)+1) &amp; ~<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a59">CODEBIT</a>]);
01124         } <span class="keywordflow">else</span> {
01125             lpszText = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a> *)<a class="code" href="../../d2/d1/userexts_8c.html#a251">SkipSz</a>(lpszClass);
01126         }
01127         lpszText = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1">UTCHAR</a> *)<a class="code" href="../../d6/d0/usercli_8h.html#a123">NextWordBoundary</a>(lpszText); <span class="comment">// UINT align lpszText</span>
01128 
01129         dit.dwExStyle |= WS_EX_NOPARENTNOTIFY;
01130 
01131         <span class="comment">//</span>
01132         <span class="comment">// Replace flat borders with 3D ones for DS_3DLOOK dialogs</span>
01133         <span class="comment">// We test the WINDOW style, not the template style now.  This is so</span>
01134         <span class="comment">// that 4.0 apps--who get 3D stuff automatically--can turn it off on</span>
01135         <span class="comment">// create if they want.</span>
01136         <span class="comment">//</span>
01137 
01138         <span class="comment">//</span>
01139         <span class="comment">// HACK!</span>
01140         <span class="comment">// Treat DS_3DLOOK combos like they have a WS_EX_CLIENTEDGE.  Why</span>
01141         <span class="comment">// should we have to draw the borders of a combobox ourselves?</span>
01142         <span class="comment">// We can't do the same thing for WS_BORDER though becaues of</span>
01143         <span class="comment">// PC Fools--they use the presence of WS_BORDER to distinguish</span>
01144         <span class="comment">// between lists and combos.</span>
01145         <span class="comment">//</span>
01146 
01147         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, DF3DLOOK)) {
01148             <span class="keywordflow">if</span> (    (dit.style &amp; WS_BORDER) ||
01149                     (lpszClass == MAKEINTRESOURCE(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_COMBOBOX]))) {
01150 
01151                 dit.style &amp;= ~WS_BORDER;
01152                 dit.dwExStyle |= WS_EX_CLIENTEDGE;
01153             }
01154         }
01155 
01156         <span class="comment">/*</span>
01157 <span class="comment">         * Get pointer to additional data.  lpszText can point to an encoded</span>
01158 <span class="comment">         * ordinal number for some controls (e.g.  static icon control) so</span>
01159 <span class="comment">         * we check for that here.</span>
01160 <span class="comment">         */</span>
01161         <span class="keywordflow">if</span> (*(LPWORD)lpszText == 0xFFFF) {
01162             lpCreateParams = (LPWSTR)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpszText + 4);
01163             strWindowName.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o3">Buffer</a> = lpszText;
01164             strWindowName.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o0">Length</a> = 4;
01165             strWindowName.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o1">MaximumLength</a> = 4;
01166             strWindowName.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o2">bAnsi</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01167         } <span class="keywordflow">else</span> {
01168             lpCreateParams = (LPWSTR)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d2/d1/userexts_8c.html#a252">WordSkipSz</a>(lpszText));
01169             <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;strWindowName,
01170                     lpszText, (UINT)-1);
01171         }
01172 
01173         <span class="comment">/*</span>
01174 <span class="comment">         * If control is edit control and caller wants global storage</span>
01175 <span class="comment">         * of edit text, allocate object in WOW and pass instance</span>
01176 <span class="comment">         * handle to CreateWindowEx().</span>
01177 <span class="comment">         */</span>
01178         <span class="keywordflow">if</span> (fWowWindow &amp;&amp; (bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a3">CD_GLOBALEDIT</a>) &amp;&amp;
01179                ((!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(lpszClass) &amp;&amp;
01180                     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(lpszClass) == (ATOM)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a69">ICLS_EDIT</a>])) ||
01181                (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(lpszClass) &amp;&amp;
01182                     (wcscmp(lpszClass, szEDITCLASS) == 0)))) {
01183 
01184             <span class="comment">/*</span>
01185 <span class="comment">             * Allocate only one global object (first time we see editctl.)</span>
01186 <span class="comment">             */</span>
01187             <span class="keywordflow">if</span> (!(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData)) {
01188                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData = <a class="code" href="../../d3/d8/client_8c.html#a84">GetEditDS</a>();
01189                 <span class="keywordflow">if</span> (!(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData))
01190                     <span class="keywordflow">goto</span> NoCreate;
01191             }
01192 
01193             hmodCreate = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData;
01194             dwExpWinVer2 = <a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(hmodCreate);
01195         } <span class="keywordflow">else</span> {
01196             hmodCreate = hmod;
01197             dwExpWinVer2 = dwExpWinVer;
01198         }
01199 
01200 <span class="preprocessor">#if DBG</span>
01201 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ((dit.dwExStyle &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a188">WS_EX_ANSICREATOR</a>) != 0) {
01202             RIPMSG1(RIP_WARNING, <span class="stringliteral">"Bad WS_EX_ style 0x%x for a control in the dialog"</span>,
01203                     dit.dwExStyle);
01204         }
01205 <span class="preprocessor">#endif // DBG</span>
01206 <span class="preprocessor"></span>
01207         <span class="comment">/*</span>
01208 <span class="comment">         * Get pointer to additional data.</span>
01209 <span class="comment">         *</span>
01210 <span class="comment">         * For WOW, instead of pointing lpCreateParams at the CreateParams</span>
01211 <span class="comment">         * data, set lpCreateParams to whatever DWORD is stored in the 32-bit</span>
01212 <span class="comment">         * DLGTEMPLATE's CreateParams.  WOW has already made sure that that</span>
01213 <span class="comment">         * 32-bit value is indeed a 16:16 pointer to the CreateParams in the</span>
01214 <span class="comment">         * 16-bit DLGTEMPLATE.</span>
01215 <span class="comment">         */</span>
01216 
01217         <span class="keywordflow">if</span> (*lpCreateParams) {
01218             lpCreateParamsData = (LPBYTE)lpCreateParams;
01219             <span class="keywordflow">if</span> (fWowWindow || fSCDLGFlags &amp; SCDLG_16BIT) {
01220                 lpCreateParamsData = 
01221                     (LPBYTE)ULongToPtr( *(UNALIGNED DWORD *) <span class="comment">/* Sundown WOW: zero-extension */</span>
01222                     (lpCreateParamsData + <span class="keyword">sizeof</span>(WORD)) );
01223             }
01224         } <span class="keywordflow">else</span> {
01225             lpCreateParamsData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01226         }
01227 
01228         <span class="comment">/*</span>
01229 <span class="comment">         * If the dialog template specifies a menu ID then TestwndChild(pwnd)</span>
01230 <span class="comment">         * must be TRUE or CreateWindowEx will think the ID is an hMenu rather</span>
01231 <span class="comment">         * than an ID (in a dialog template you'll never have an hMenu).</span>
01232 <span class="comment">         * However for compatibility reasons we let it go if the ID = 0.</span>
01233 <span class="comment">         */</span>
01234         <span class="keywordflow">if</span> (dit.dwID) {
01235             <span class="comment">/*</span>
01236 <span class="comment">             * This makes TestwndChild(pwnd) on this window return TRUE.</span>
01237 <span class="comment">             */</span>
01238             dit.style |= WS_CHILD;
01239             dit.style &amp;= ~WS_POPUP;
01240         }
01241 
01242         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(lpszClass)) {
01243             <a class="code" href="../../d5/d6/chartran_8c.html#a7">RtlInitLargeUnicodeString</a>((<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html">PLARGE_UNICODE_STRING</a>)&amp;strClassName,
01244                     lpszClass, (UINT)-1);
01245             pstrClassName = &amp;strClassName;
01246         } <span class="keywordflow">else</span> {
01247             pstrClassName = (<a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>)lpszClass;
01248         }
01249         UserAssert((dit.dwExStyle &amp; WS_EX_MDICHILD) == 0);
01250 
01251         hwnd2 = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a290">NtUserCreateWindowEx</a>(
01252                 dit.dwExStyle | ((fSCDLGFlags &amp; SCDLG_ANSI) ? WS_EX_ANSICREATOR : 0),
01253                 pstrClassName,
01254                 &amp;strWindowName,
01255                 dit.style,
01256                 <a class="code" href="../../d0/d9/dlgbegin_8c.html#a12">DefShortToInt</a>(dit.x),
01257                 dit.y,
01258                 <a class="code" href="../../d0/d9/dlgbegin_8c.html#a12">DefShortToInt</a>(dit.cx),
01259                 dit.cy,
01260                 hwnd,
01261                 (HMENU)LongToHandle( dit.dwID ),
01262                 hmodCreate,
01263                 lpCreateParamsData,
01264                 dwExpWinVer2);
01265 
01266         <span class="keywordflow">if</span> (hwnd2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01267 NoCreate:
01268             <span class="comment">/*</span>
01269 <span class="comment">             * Couldn't create the window -- return NULL.</span>
01270 <span class="comment">             */</span>
01271             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, DFNOFAILCREATE)) {
01272                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateDialog() failed: couldn't create control"</span>);
01273                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(hwnd);
01274                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01275             }
01276         } <span class="keywordflow">else</span> {
01277 
01278             <span class="keywordflow">if</span> (dit.dwHelpID) {
01279                 <a class="code" href="../../d6/d0/usercli_8h.html#a220">NtUserSetWindowContextHelpId</a>(hwnd2, dit.dwHelpID);
01280             }
01281 
01282         <span class="comment">/*</span>
01283 <span class="comment">         * If it is a not a default system font, set the font for all the</span>
01284 <span class="comment">         * child windows of the dialogbox.</span>
01285 <span class="comment">         */</span>
01286             <span class="keywordflow">if</span> (hNewFont != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01287                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd2, WM_SETFONT, (WPARAM)hNewFont, 0L);
01288             }
01289 
01290         <span class="comment">/*</span>
01291 <span class="comment">         * Result gets ID of last (hopefully only) defpushbutton.</span>
01292 <span class="comment">         */</span>
01293             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd2, WM_GETDLGCODE, 0, 0L) &amp; DLGC_DEFPUSHBUTTON) {
01294                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;result = dit.dwID;
01295             }
01296 
01297         }
01298         <span class="comment">/*</span>
01299 <span class="comment">         * Point at next item template</span>
01300 <span class="comment">         */</span>
01301         lpdit = (LPDLGITEMTEMPLATE)<a class="code" href="../../d6/d0/usercli_8h.html#a124">NextDWordBoundary</a>(
01302                 (LPBYTE)(lpCreateParams + 1) + *lpCreateParams);
01303     }
01304 
01305     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, DFCONTROL)) {
01306         <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndT = <a class="code" href="../../d6/d0/usercli_8h.html#a642">_GetNextDlgTabItem</a>(pwnd, NULL, FALSE);
01307         hwndEditFirst = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT);
01308     }
01309 
01310     <span class="keywordflow">if</span> (lpfnDialog != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01311         fSuccess = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, WM_INITDIALOG,
01312                                (WPARAM)hwndEditFirst, lParam, FALSE);
01313 
01314         <span class="comment">//</span>
01315         <span class="comment">// Make sure the window didn't get nuked during WM_INITDIALOG</span>
01316         <span class="comment">//</span>
01317         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)) {
01318             <span class="keywordflow">goto</span> CreateDialogReturn;
01319         }
01320         <span class="keywordflow">if</span> (fSuccess &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd) {
01321 
01322             <span class="comment">//</span>
01323             <span class="comment">// To remove the two-default-push-buttons problem, we must make</span>
01324             <span class="comment">// sure CheckDefPushButton() will remove default from other push</span>
01325             <span class="comment">// buttons.  This happens only if hwndEditFirst != hwndNewFocus;</span>
01326             <span class="comment">// So, we make it NULL here. This breaks Designer's install</span>
01327             <span class="comment">// program(which can't take a DM_GETDEFID.  So, we do a version</span>
01328             <span class="comment">// check here.</span>
01329             <span class="comment">//</span>
01330             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, DFCONTROL)) {
01331                 <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndT;
01332                 <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwndEditFirst) || <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT))
01333                     hwndEditFirst = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01334 
01335                 <span class="comment">//</span>
01336                 <span class="comment">// They could have disabled hwndEditFirst during WM_INITDIALOG.</span>
01337                 <span class="comment">// So, let use obtain the First Tab again.</span>
01338                 <span class="comment">//</span>
01339                 pwndT = <a class="code" href="../../d6/d0/usercli_8h.html#a642">_GetNextDlgTabItem</a>(pwnd, NULL, FALSE);
01340                 <span class="keywordflow">if</span> (hwndNewFocus = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT)) {
01341                     <a class="code" href="../../d6/d0/usercli_8h.html#a759">DlgSetFocus</a>(hwndNewFocus);
01342                 }
01343 
01344                 <a class="code" href="../../d6/d0/usercli_8h.html#a757">xxxCheckDefPushButton</a>(pwnd, hwndEditFirst, hwndNewFocus);
01345             }
01346         }
01347     }
01348 
01349     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwnd))
01350     {
01351         <span class="comment">// Omnis7 relies on a nonzero return even though they nuked this</span>
01352         <span class="comment">// dialog during processing of the WM_INITDIALOG message</span>
01353         <span class="comment">// -- jeffbog -- 2/24/95 -- Win95B B#12368</span>
01354         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>) {
01355             <span class="keywordflow">return</span>(hwnd);
01356         }
01357 
01358         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01359     }
01360 
01361     <span class="comment">/*</span>
01362 <span class="comment">     * UISTATE: if keyboard indicators are on and this is a topmost dialog</span>
01363 <span class="comment">     * set the internal bit.</span>
01364 <span class="comment">     */</span>
01365     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/inc_2user_8h.html#a384">TEST_KbdCuesPUSIF</a>) {
01366         <span class="comment">/*</span>
01367 <span class="comment">         * If property page, UISTATE bits were copied from parent when I was created</span>
01368 <span class="comment">         * Top level dialogs act as containers and initialize their state based on</span>
01369 <span class="comment">         * the type of the last input event, after sending UIS_INITIALIZE</span>
01370 <span class="comment">         */</span>
01371         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwnd)) {
01372             <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, WM_CHANGEUISTATE, MAKEWPARAM(UIS_INITIALIZE, 0), 0, FALSE);
01373         }
01374     }
01375 
01376     <span class="comment">/*</span>
01377 <span class="comment">     * Bring this dialog into the foreground</span>
01378 <span class="comment">     * if DS_SETFOREGROUND is set.</span>
01379 <span class="comment">     */</span>
01380     <span class="keywordflow">if</span> (bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a5">CD_SETFOREGROUND</a>) {
01381         <a class="code" href="../../d6/d0/usercli_8h.html#a228">NtUserSetForegroundWindow</a>(hwnd);
01382         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwnd)) {
01383             hwnd = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01384             <span class="keywordflow">goto</span> CreateDialogReturn;
01385         }
01386     }
01387 
01388     <span class="keywordflow">if</span> ((bFlags &amp; <a class="code" href="../../d0/d9/dlgbegin_8c.html#a2">CD_VISIBLE</a>) &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd &amp;&amp; (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFVISIBLE))) {
01389         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a237">NtUserShowWindow</a>(hwnd, SHOW_OPENWINDOW);
01390         <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>(hwnd);
01391     }
01392 
01393 CreateDialogReturn:
01394 
01395     <span class="comment">/*</span>
01396 <span class="comment">     * 17609 Gupta's SQLWin deletes the window before CreateDialog returns</span>
01397 <span class="comment">     * but still expects non-zero return value from CreateDialog so we will</span>
01398 <span class="comment">     * do like win 3.1 and not revalidate for 16 bit apps</span>
01399 <span class="comment">     */</span>
01400     <span class="keywordflow">if</span> (!(fSCDLGFlags &amp; SCDLG_NOREVALIDATE) &amp;&amp; !<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)) {
01401         hwnd = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01402     }
01403 
01404     <span class="keywordflow">return</span> hwnd;
01405 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="dlgbegin.c::IsFontNotGood" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline BOOLEAN IsFontNotGood           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szTempBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpStrSubst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>TEXTMETRIC *&nbsp;</td>
          <td class="mdname" nowrap> <em>ptm</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00088">88</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">CreateDlgFont()</a>.
<p>
<pre class="fragment"><div>00089 {
00090     <span class="comment">//</span>
00091     <span class="comment">// For FarEast version, we will allow the font smaller than system font.</span>
00092     <span class="comment">//</span>
00093     <span class="keywordflow">return</span> _wcsicmp(szTempBuffer, lpStrSubst) ||
00094                 (!IS_ANY_DBCS_CHARSET(ptm-&gt;tmCharSet) &amp;&amp;
00095                     (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXICON) &lt; 32 || <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYICON) &lt; 32) &amp;&amp;
00096                     ptm-&gt;tmHeight &lt; <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cySysFontChar);
00097 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="dlgbegin.c::SkipSz" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> SkipSz           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UTCHAR *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00054">54</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>.
<p>
<pre class="fragment"><div>00056 {
00057     <span class="keywordflow">if</span> (*lpsz == 0xFF)
00058         <span class="keywordflow">return</span> (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpsz + 4;
00059 
00060     <span class="keywordflow">while</span> (*lpsz++ != 0) ;
00061 
00062     <span class="keywordflow">return</span> (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpsz;
00063 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="dlgbegin.c::ValidateCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="dlgbegin.c::WordSkipSz" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> WordSkipSz           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UTCHAR *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00065">65</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00886">NextWordBoundary</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, and <a class="el" href="../../d3/d0/userexts_8c-source.html#l13551">SkipSz()</a>.
<p>
<pre class="fragment"><div>00067 {
00068     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pb = <a class="code" href="../../d2/d1/userexts_8c.html#a251">SkipSz</a>(lpsz);
00069     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a123">NextWordBoundary</a>(pb);
00070 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a9" doxytag="dlgbegin.c::gwszShellFont" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const WCHAR <a class="el" href="../../d0/d9/dlgbegin_8c.html#a9">gwszShellFont</a>[] = L"MS Shell Dlg"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00023">23</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00282">CreateDlgFont()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="dlgbegin.c::gwszShellFont2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const WCHAR <a class="el" href="../../d0/d9/dlgbegin_8c.html#a10">gwszShellFont2</a>[] = L"MS Shell Dlg 2"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00024">24</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00254">FixupDlgFaceName()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="dlgbegin.c::szEDITCLASS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d1/d9/nt6_2dlgbegin_8c.html#a6">szEDITCLASS</a>[] = TEXT("Edit")          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00018">18</a> of file <a class="el" href="../../d1/d8/dlgbegin_8c-source.html">dlgbegin.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
