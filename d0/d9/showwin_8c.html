<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: showwin.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>showwin.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d1/d8/showwin_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/showwin_8c.html#a0">_ShowWindowAsync</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, int cmdShow, UINT uWPFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/showwin_8c.html#a1">xxxShowWindow</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cmdShowAnimate)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/showwin_8c.html#a2">xxxShowOwnedWindows</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndOwner, UINT cmdShow, HRGN hrgnHung)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/showwin_8c.html#a3">xxxShowOwnedPopups</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndOwner, BOOL fShow)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="showwin.c::_ShowWindowAsync" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _ShowWindowAsync           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmdShow</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uWPFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/showwin_8c-source.html#l00025">25</a> of file <a class="el" href="../../d1/d8/showwin_8c-source.html">showwin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01547">GETPTI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d2/ntuser_2kernel_2input_8c-source.html#l02068">PostEventMessage()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06584">PUDF_ANIMATE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02988">QEVENT_SHOWWINDOW</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l06608">TEST_PUDF</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06260">NtUserShowWindowAsync()</a>, and <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00911">xxxSetWindowPlacement()</a>.
<p>
<pre class="fragment"><div>00026 {
00027 
00028     <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a1217">PostEventMessage</a>(
00029             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a455">GETPTI</a>(pwnd),
00030             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a455">GETPTI</a>(pwnd)-&gt;pq,
00031             QEVENT_SHOWWINDOW,
00032             NULL,
00033             uWPFlags,
00034             (WPARAM)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd),
00035             cmdShow | <a class="code" href="../../d4/d1/userk_8h.html#a657">TEST_PUDF</a>(PUDF_ANIMATE));
00036 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="showwin.c::xxxShowOwnedPopups" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxShowOwnedPopups           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fShow</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/showwin_8c-source.html#l00593">593</a> of file <a class="el" href="../../d1/d8/showwin_8c-source.html">showwin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d8/showwin_8c-source.html#l00437">xxxShowOwnedWindows()</a>.
<p>
<pre class="fragment"><div>00596 {
00597     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwndOwner);
00598 
00599     <a class="code" href="../../d4/d1/userk_8h.html#a1509">xxxShowOwnedWindows</a>(pwndOwner,
00600             (UINT)(fShow ? SW_PARENTOPENING : SW_PARENTCLOSING), NULL);
00601     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00602 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="showwin.c::xxxShowOwnedWindows" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxShowOwnedWindows           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cmdShow</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HRGN&nbsp;</td>
          <td class="mdname" nowrap> <em>hrgnHung</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/showwin_8c-source.html#l00437">437</a> of file <a class="el" href="../../d1/d8/showwin_8c-source.html">showwin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03634">BWL_ENUMLIST</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01589">CFKANJIWINDOW</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00417">FreeHwndList()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02790">PWNDDESKTOP</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01838">tagWND::rcWindow</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00194">RevalidateHwnd</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03624">tagBWL::rghwnd</a>, <a class="el" href="../../d3/d7/swp_8c-source.html#l05237">SetVisible()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02556">SetWF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01747">tagWND::spwndOwner</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02585">SV_UNSET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01609">TestCF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02561">TestwndChild</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02566">TestwndHI</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00363">ThreadLockAlways</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02223">UnionRgn</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02418">WFDISABLED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02275">WFHIDDENPOPUP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02420">WFMINIMIZED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02419">WFVISIBLE</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00688">xxxSendMessage()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/minmax_8c-source.html#l02005">xxxMinimizeHungWindow()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l01329">xxxMinMaximize()</a>, and <a class="el" href="../../d1/d8/showwin_8c-source.html#l00593">xxxShowOwnedPopups()</a>.
<p>
<pre class="fragment"><div>00441 {
00442     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fShow;
00443     <span class="keywordtype">int</span> cmdZoom;
00444     HWND *phwnd;
00445     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl;
00446     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, pwndTopOwner;
00447     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwnd;
00448 
00449     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwndOwner);
00450 
00451     <span class="comment">/*</span>
00452 <span class="comment">     * Not interested in child windows</span>
00453 <span class="comment">     */</span>
00454     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwndOwner))
00455         <span class="keywordflow">return</span>;
00456 
00457     <span class="keywordflow">if</span> ((pbwl = <a class="code" href="../../d4/d1/userk_8h.html#a1157">BuildHwndList</a>(<a class="code" href="../../d4/d1/userk_8h.html#a322">PWNDDESKTOP</a>(pwndOwner)-&gt;spwndChild, BWL_ENUMLIST, NULL)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00458         <span class="keywordflow">return</span>;
00459 
00460     <span class="comment">/*</span>
00461 <span class="comment">     * NOTE: The following code assumes the values of SW_* are 1, 2, 3, and 4</span>
00462 <span class="comment">     */</span>
00463     fShow = (cmdShow &gt;= SW_PARENTOPENING);
00464 
00465     cmdZoom = 0;
00466     <span class="keywordflow">if</span> (cmdShow == SW_OTHERZOOM)
00467         cmdZoom = SIZEZOOMHIDE;
00468 
00469     <span class="keywordflow">if</span> (cmdShow == SW_OTHERUNZOOM)
00470         cmdZoom = SIZEZOOMSHOW;
00471 
00472     <span class="comment">/*</span>
00473 <span class="comment">     * If zoom/unzoom, then open/close all popups owned by all other</span>
00474 <span class="comment">     * windows.  Otherwise, open/close popups owned by pwndOwner.</span>
00475 <span class="comment">     */</span>
00476     <span class="keywordflow">for</span> (phwnd = pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>; *phwnd != (HWND)1; phwnd++) {
00477 
00478         <span class="comment">/*</span>
00479 <span class="comment">         * Lock the window before we play with it.</span>
00480 <span class="comment">         * If the window handle is invalid, skip it</span>
00481 <span class="comment">         */</span>
00482         <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(*phwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00483             <span class="keywordflow">continue</span>;
00484 
00485         <span class="comment">/*</span>
00486 <span class="comment">         * Kanji windows can't be owned, so skip it.</span>
00487 <span class="comment">         */</span>
00488         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a485">TestCF</a>(pwnd, CFKANJIWINDOW))
00489             <span class="keywordflow">continue</span>;
00490 
00491         <span class="comment">/*</span>
00492 <span class="comment">         * If same as window passed in, skip it.</span>
00493 <span class="comment">         */</span>
00494         <span class="keywordflow">if</span> (pwnd == pwndOwner)
00495             <span class="keywordflow">continue</span>;
00496 
00497         <span class="comment">/*</span>
00498 <span class="comment">         * Find ultimate owner of popup, but only go up as far as pwndOwner.</span>
00499 <span class="comment">         */</span>
00500         <span class="keywordflow">if</span> ((pwndTopOwner = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o5">spwndOwner</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00501 
00502             <span class="comment">/*</span>
00503 <span class="comment">             * The TestwndHI is needed since if it has an icon, pwndOwner</span>
00504 <span class="comment">             * is invalid.</span>
00505 <span class="comment">             */</span>
00506             <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a740">TestwndHI</a>(pwndTopOwner) &amp;&amp; pwndTopOwner != pwndOwner &amp;&amp;
00507                     pwndTopOwner-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o5">spwndOwner</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00508                 pwndTopOwner = pwndTopOwner-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o5">spwndOwner</a>;
00509         }
00510 
00511         <span class="comment">/*</span>
00512 <span class="comment">         * Zoom/Unzoom case.</span>
00513 <span class="comment">         */</span>
00514         <span class="keywordflow">if</span> (cmdZoom != 0) {
00515 
00516             <span class="comment">/*</span>
00517 <span class="comment">             * If no parent, or parents are the same, skip.</span>
00518 <span class="comment">             */</span>
00519             <span class="keywordflow">if</span> (pwndTopOwner == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || pwndTopOwner == pwndOwner)
00520                 <span class="keywordflow">continue</span>;
00521 
00522             <span class="comment">/*</span>
00523 <span class="comment">             * If owner is iconic, then this window should stay hidden,</span>
00524 <span class="comment">             * UNLESS the minimized window is disabled, in which case we'd</span>
00525 <span class="comment">             * better show the window.</span>
00526 <span class="comment">             */</span>
00527             <span class="keywordflow">if</span> (   cmdShow == SW_OTHERUNZOOM
00528                 &amp;&amp; pwndTopOwner != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00529                 &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndTopOwner, WFMINIMIZED)
00530                 &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndTopOwner, WFDISABLED)
00531                )
00532                 <span class="keywordflow">continue</span>;
00533         } <span class="keywordflow">else</span> {
00534             <span class="comment">/*</span>
00535 <span class="comment">             * Hide/Iconize/Show/Open case.</span>
00536 <span class="comment">             */</span>
00537             <span class="comment">/*</span>
00538 <span class="comment">             * If parents aren't the same, skip.</span>
00539 <span class="comment">             */</span>
00540             <span class="keywordflow">if</span> (pwndTopOwner != pwndOwner)
00541                 <span class="keywordflow">continue</span>;
00542         }
00543 
00544         <span class="comment">/*</span>
00545 <span class="comment">         * Hide or show if:</span>
00546 <span class="comment">         * Showing &amp; this is a hidden popup</span>
00547 <span class="comment">         *   OR</span>
00548 <span class="comment">         * Hiding &amp; this is a visible window</span>
00549 <span class="comment">         */</span>
00550         <span class="keywordflow">if</span> ((fShow &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFHIDDENPOPUP)) ||
00551                 (!fShow &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFVISIBLE))) {
00552             <span class="comment">/*</span>
00553 <span class="comment">             * For hung minimization, just set the HIDDENPOPUP bit, clear</span>
00554 <span class="comment">             * the visible bit and add the window rect to the region to</span>
00555 <span class="comment">             * be repainted.</span>
00556 <span class="comment">             */</span>
00557             <span class="keywordflow">if</span> (hrgnHung != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00558                 HRGN hrgn = GreCreateRectRgnIndirect(&amp;pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o6">rcWindow</a>);
00559                 <a class="code" href="../../d4/d1/userk_8h.html#a230">UnionRgn</a>(hrgnHung, hrgnHung, hrgn);
00560                 GreDeleteObject(hrgn);
00561 
00562                 UserAssert(!fShow);
00563 
00564                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a732">SetWF</a>(pwnd, WFHIDDENPOPUP);
00565                 <a class="code" href="../../d4/d1/userk_8h.html#a1626">SetVisible</a>(pwnd, SV_UNSET);
00566             } <span class="keywordflow">else</span> {
00567                 <a class="code" href="../../d6/d0/usercli_8h.html#a37">ThreadLockAlways</a>(pwnd, &amp;tlpwnd);
00568                 <a class="code" href="../../d4/d1/userk_8h.html#a1579">xxxSendMessage</a>(pwnd, WM_SHOWWINDOW, fShow, (LONG)cmdShow);
00569                 <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwnd);
00570             }
00571         }
00572     }
00573 
00574     <span class="comment">/*</span>
00575 <span class="comment">     * Free the window list.</span>
00576 <span class="comment">     */</span>
00577     <a class="code" href="../../d4/d1/userk_8h.html#a1158">FreeHwndList</a>(pbwl);
00578 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="showwin.c::xxxShowWindow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxShowWindow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cmdShowAnimate</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/showwin_8c-source.html#l00085">85</a> of file <a class="el" href="../../d1/d8/showwin_8c-source.html">showwin.c</a>.
<p>
References <a class="el" href="../../d3/d7/rtl_2winmgr_8c-source.html#l00294">_FChildVisible()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02325">AW_SKIP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02323">AW_USE</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01598">CFSAVEBITS</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02557">ClrWF</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02465">tagUSERSTARTUPINFO::dwFlags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02573">GetFullScreen</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00099">gpqForeground</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00456">grpdeskRitInput</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01827">tagWND::head</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04323">MINMAX_ANIMATE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03319">tagTHREADINFO::ppi</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03321">tagTHREADINFO::pq</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02790">PWNDDESKTOP</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01839">tagWND::rcClient</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02574">SetFullScreen</a>, <a class="el" href="../../d3/d7/swp_8c-source.html#l05237">SetVisible()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03111">tagQ::spwndActive</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01747">tagWND::spwndOwner</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01745">tagWND::spwndParent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02586">SV_SET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02585">SV_UNSET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01609">TestCF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02561">TestwndChild</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03505">tagPROCESSINFO::usi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02411">WFBORDERMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02412">WFCAPTION</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02415">WFMAXIMIZED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02420">WFMINIMIZED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02265">WFSENDSIZEMOVE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02419">WFVISIBLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02318">WFWIN31COMPAT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02466">tagUSERSTARTUPINFO::wShowWindow</a>, <a class="el" href="../../d4/d5/focusact_8c-source.html#l02060">xxxActivateWindow()</a>, <a class="el" href="../../d4/d5/focusact_8c-source.html#l02549">xxxCheckFocus()</a>, <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00166">xxxMakeWindowForegroundWithState()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l02005">xxxMinimizeHungWindow()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l01329">xxxMinMaximize()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00688">xxxSendMessage()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l02861">xxxSendSizeMessage()</a>, and <a class="el" href="../../d3/d7/swp_8c-source.html#l01468">xxxSetWindowPos()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06274">NtUserShowWindow()</a>, <a class="el" href="../../d9/d7/fullscr_8c-source.html#l01545">xxxbFullscreenSwitch()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l00033">xxxCreateWindowEx()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l01591">xxxDestroyWindow()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l02517">xxxMNCloseHierarchy()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l03772">xxxProcessEventMessage()</a>, <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l01054">xxxSetInternalWindowPos()</a>, <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00311">xxxSetParent()</a>, <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00911">xxxSetWindowPlacement()</a>, <a class="el" href="../../d8/d3/kernel_2sbapi_8c-source.html#l00032">xxxShowScrollBar()</a>, and <a class="el" href="../../d5/d7/syscmd_8c-source.html#l00193">xxxSysCommand()</a>.
<p>
<pre class="fragment"><div>00088 {
00089     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fVisOld, fVisNew;
00090     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> swpFlags = SWP_NOMOVE | SWP_NOSIZE;
00091     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti;
00092     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bFirstMain = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00093     <span class="keywordtype">int</span> cmdShow = LOWORD(cmdShowAnimate);
00094 
00095     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00096 
00097     fVisOld = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFVISIBLE);
00098     pti = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00099 
00100     <span class="comment">/*</span>
00101 <span class="comment">     * See if this is the first "main" top level</span>
00102 <span class="comment">     * window being created by this application - if show, assume it</span>
00103 <span class="comment">     * is showing with the SW_SHOWDEFAULT command.</span>
00104 <span class="comment">     *</span>
00105 <span class="comment">     * Checks for:</span>
00106 <span class="comment">     * - cmdShow is a "default" show command</span>
00107 <span class="comment">     * - we haven't done startupinfo yet (we only use it once)</span>
00108 <span class="comment">     * - this is not a child (it is a top level window)</span>
00109 <span class="comment">     * - this has a titlebar (indicator of the main window)</span>
00110 <span class="comment">     * - it isn't owned (indicator of the main window)</span>
00111 <span class="comment">     */</span>
00112     <span class="keywordflow">if</span> ((pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o28">usi</a>.<a class="code" href="../../d0/d9/structtagUSERSTARTUPINFO.html#o5">dwFlags</a> &amp; STARTF_USESHOWWINDOW) &amp;&amp;
00113             !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwnd) &amp;&amp;
00114             (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFBORDERMASK) == (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(WFCAPTION)) &amp;&amp;
00115             (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o5">spwndOwner</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00116 
00117         bFirstMain = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00118 
00119         <span class="keywordflow">switch</span> (cmdShow) {
00120         <span class="keywordflow">case</span> SW_SHOWNORMAL:
00121         <span class="keywordflow">case</span> SW_SHOW:
00122 
00123             <span class="comment">/*</span>
00124 <span class="comment">             * Then assume default!</span>
00125 <span class="comment">             */</span>
00126             cmdShow = SW_SHOWDEFAULT;
00127             <span class="keywordflow">break</span>;
00128         }
00129     }
00130 
00131     <span class="comment">/*</span>
00132 <span class="comment">     * If this application specified SW_SHOWDEFAULT, then we get the</span>
00133 <span class="comment">     * real SW_* command from the application's STARTUPINFO structure</span>
00134 <span class="comment">     * (STARTUPINFO is passed to CreateProcess() when this application</span>
00135 <span class="comment">     * was launched).</span>
00136 <span class="comment">     */</span>
00137     <span class="keywordflow">if</span> (cmdShow == SW_SHOWDEFAULT) {
00138 
00139         <span class="comment">/*</span>
00140 <span class="comment">         * Call the client to get the SW_* command from the STARTUPINFO</span>
00141 <span class="comment">         * for this process.</span>
00142 <span class="comment">         */</span>
00143         <span class="keywordflow">if</span> (pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o28">usi</a>.<a class="code" href="../../d0/d9/structtagUSERSTARTUPINFO.html#o5">dwFlags</a> &amp; STARTF_USESHOWWINDOW) {
00144 
00145             bFirstMain = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00146 
00147             cmdShow = pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o28">usi</a>.<a class="code" href="../../d0/d9/structtagUSERSTARTUPINFO.html#o6">wShowWindow</a>;
00148 
00149             <span class="comment">/*</span>
00150 <span class="comment">             * The following code was removed in 3.51</span>
00151 <span class="comment">             *</span>
00152 <span class="comment">             * switch (cmdShow) {</span>
00153 <span class="comment">             * case SW_SHOWMINIMIZED:</span>
00154 <span class="comment">             * case SW_MINIMIZE:</span>
00155 <span class="comment">             *</span>
00156 <span class="comment">             *      *</span>
00157 <span class="comment">             *      * If the default show was "minimized", then make sure it doesn't</span>
00158 <span class="comment">             *      * become active.  Minimized is effectively "background".</span>
00159 <span class="comment">             *      *</span>
00160 <span class="comment">             *     cmdShow = SW_SHOWMINNOACTIVE;</span>
00161 <span class="comment">             *     break;</span>
00162 <span class="comment">             * }</span>
00163 <span class="comment">             *</span>
00164 <span class="comment">             */</span>
00165         }
00166     }
00167 
00168 
00169     <span class="comment">/*</span>
00170 <span class="comment">     * This is in case someone said SW_SHOWDEFAULT but has no startupinfo.</span>
00171 <span class="comment">     * Or in case cmdShow inside of STARTUPINFO is SW_SHOWDEFAULT.</span>
00172 <span class="comment">     */</span>
00173     <span class="keywordflow">if</span> (cmdShow == SW_SHOWDEFAULT)
00174         cmdShow = SW_SHOWNORMAL;
00175 
00176     <span class="comment">/*</span>
00177 <span class="comment">     * Turn off startup info.  We turn this off after the first call to</span>
00178 <span class="comment">     * ShowWindow.  If we don't apps can be started by progman with</span>
00179 <span class="comment">     * the start info being minimized and then be restored and then</span>
00180 <span class="comment">     * call ShowWindow(SW_SHOW) and the app would minimize again.</span>
00181 <span class="comment">     * Notepad had that problem 2985.</span>
00182 <span class="comment">     */</span>
00183     <span class="keywordflow">if</span> (bFirstMain) {
00184         pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o28">usi</a>.<a class="code" href="../../d0/d9/structtagUSERSTARTUPINFO.html#o5">dwFlags</a> &amp;=
00185                 ~(STARTF_USESHOWWINDOW | STARTF_USESIZE | STARTF_USEPOSITION);
00186     }
00187 
00188 
00189     <span class="comment">/*</span>
00190 <span class="comment">     * Take care of all the OLD show commands with columns &amp; iconslot.</span>
00191 <span class="comment">     */</span>
00192     <span class="keywordflow">if</span> (cmdShow &amp; 0xFF00) {
00193         <span class="keywordflow">if</span> ((cmdShow &amp; 0xFF80) == (<span class="keywordtype">int</span>)0xFF80)
00194             cmdShow = SW_SHOWMINNOACTIVE;
00195         <span class="keywordflow">else</span>
00196             cmdShow = SW_SHOW;
00197     }
00198 
00199     <span class="comment">/*</span>
00200 <span class="comment">     * Change to new fullscreen if needed and in same desktop</span>
00201 <span class="comment">     */</span>
00202     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a744">GetFullScreen</a>(pwnd) != WINDOWED)
00203             &amp;&amp; (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o0">head</a>.rpdesk == <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a176">grpdeskRitInput</a>)) {
00204         <span class="keywordflow">if</span> ((cmdShow == SW_SHOWNORMAL) ||
00205             (cmdShow == SW_RESTORE) ||
00206             (cmdShow == SW_MAXIMIZE) ||
00207             (cmdShow == SW_SHOWMAXIMIZED)) {
00208             cmdShow = SW_SHOWMINIMIZED;
00209 
00210             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a744">GetFullScreen</a>(pwnd) == FULLSCREENMIN) {
00211                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a745">SetFullScreen</a>(pwnd, FULLSCREEN);
00212             }
00213 
00214             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a29">gpqForeground</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00215                 <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a29">gpqForeground</a>-&gt;<a class="code" href="../../d7/d4/structtagQ.html#o8">spwndActive</a> == pwnd) {
00216                 <a class="code" href="../../d4/d1/userk_8h.html#a1756">xxxMakeWindowForegroundWithState</a>(NULL, 0);
00217             }
00218         }
00219     }
00220 
00221     <span class="keywordflow">switch</span> (cmdShow) {
00222     <span class="keywordflow">case</span> SW_SHOWNOACTIVATE:
00223     <span class="keywordflow">case</span> SW_SHOWNORMAL:
00224     <span class="keywordflow">case</span> SW_RESTORE:
00225 
00226         <span class="comment">/*</span>
00227 <span class="comment">         * If min/max, let xxxMinMaximize() do all the work.</span>
00228 <span class="comment">         */</span>
00229         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMINIMIZED) || <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMAXIMIZED)) {
00230             <a class="code" href="../../d4/d1/userk_8h.html#a1159">xxxMinMaximize</a>(pwnd, (UINT)cmdShow, cmdShowAnimate &amp; MINMAX_ANIMATE);
00231             <span class="keywordflow">return</span> fVisOld;
00232 
00233         } <span class="keywordflow">else</span> {
00234 
00235             <span class="comment">/*</span>
00236 <span class="comment">             * Ignore if the window is already visible.</span>
00237 <span class="comment">             */</span>
00238             <span class="keywordflow">if</span> (fVisOld) {
00239                 <span class="keywordflow">return</span> fVisOld;
00240             }
00241 
00242             swpFlags |= SWP_SHOWWINDOW;
00243             <span class="keywordflow">if</span> (   cmdShow == SW_SHOWNOACTIVATE) {
00244                 swpFlags |= SWP_NOZORDER;
00245 <span class="preprocessor">#ifdef NEVER</span>
00246 <span class="preprocessor"></span>                <span class="comment">/*</span>
00247 <span class="comment">                 * This is what win3.1 does. On NT, since each "queue" has</span>
00248 <span class="comment">                 * its own active window, there is often no active window.</span>
00249 <span class="comment">                 * In this case, win3.1 turns a SHOWNOACTIVATE into a "SHOW</span>
00250 <span class="comment">                 * with activate". Since win3.1 almost always has an active</span>
00251 <span class="comment">                 * window, this almost never happens. So on NT, we're not</span>
00252 <span class="comment">                 * going to do this check - that way we'll be more compatible</span>
00253 <span class="comment">                 * with win3.1 because we'll usally not activate (like win3.1).</span>
00254 <span class="comment">                 * With this check, this causes FoxPro 2.5 for Windows to not</span>
00255 <span class="comment">                 * properly activate its command window when first coming up.</span>
00256 <span class="comment">                 */</span>
00257                 <span class="keywordflow">if</span> (pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o3">pq</a>-&gt;<a class="code" href="../../d7/d4/structtagQ.html#o8">spwndActive</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00258                     swpFlags |= SWP_NOACTIVATE;
00259 <span class="preprocessor">#else</span>
00260 <span class="preprocessor"></span>                swpFlags |= SWP_NOACTIVATE;
00261 <span class="preprocessor">#endif</span>
00262 <span class="preprocessor"></span>            }
00263         }
00264         <span class="keywordflow">break</span>;
00265 
00266     <span class="keywordflow">case</span> SW_FORCEMINIMIZE:
00267         <a class="code" href="../../d4/d1/userk_8h.html#a1160">xxxMinimizeHungWindow</a>(pwnd);
00268         <span class="keywordflow">return</span> fVisOld;
00269 
00270     <span class="keywordflow">case</span> SW_SHOWMINNOACTIVE:
00271     <span class="keywordflow">case</span> SW_SHOWMINIMIZED:
00272     <span class="keywordflow">case</span> SW_SHOWMAXIMIZED:
00273     <span class="keywordflow">case</span> SW_MINIMIZE:
00274         <a class="code" href="../../d4/d1/userk_8h.html#a1159">xxxMinMaximize</a>(pwnd, (UINT)cmdShow, cmdShowAnimate &amp; MINMAX_ANIMATE);
00275         <span class="keywordflow">return</span> fVisOld;
00276 
00277     <span class="keywordflow">case</span> SW_SHOWNA:
00278         swpFlags |= SWP_SHOWWINDOW | SWP_NOACTIVATE;
00279 
00280 
00281         <span class="comment">/*</span>
00282 <span class="comment">         * LATER removed this to be compatible with SHOWNOACTIVATE</span>
00283 <span class="comment">         * if (pti-&gt;pq-&gt;spwndActive != NULL)</span>
00284 <span class="comment">         *     swpFlags |= SWP_NOACTIVATE;</span>
00285 <span class="comment">         */</span>
00286         <span class="keywordflow">break</span>;
00287 
00288     <span class="keywordflow">case</span> SW_SHOW:
00289 
00290         <span class="comment">/*</span>
00291 <span class="comment">         * Don't bother if it is already visible.</span>
00292 <span class="comment">         */</span>
00293         <span class="keywordflow">if</span> (fVisOld)
00294             <span class="keywordflow">return</span> fVisOld;
00295 
00296         swpFlags |= SWP_SHOWWINDOW;
00297         UserAssert(cmdShow != SW_SHOWNOACTIVATE);
00298         <span class="keywordflow">break</span>;
00299 
00300     <span class="keywordflow">case</span> SW_HIDE:
00301 
00302         <span class="comment">/*</span>
00303 <span class="comment">         * Don't bother if it is already hidden.</span>
00304 <span class="comment">         */</span>
00305         <span class="keywordflow">if</span> (!fVisOld)
00306             <span class="keywordflow">return</span> fVisOld;
00307 
00308         swpFlags |= SWP_HIDEWINDOW;
00309         <span class="keywordflow">if</span> (pwnd != pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o3">pq</a>-&gt;<a class="code" href="../../d7/d4/structtagQ.html#o8">spwndActive</a>)
00310             swpFlags |= (SWP_NOACTIVATE | SWP_NOZORDER);
00311         <span class="keywordflow">break</span>;
00312 
00313     <span class="keywordflow">default</span>:
00314         RIPERR0(ERROR_INVALID_SHOWWIN_COMMAND, RIP_VERBOSE, <span class="stringliteral">""</span>);
00315         <span class="keywordflow">return</span> fVisOld;
00316     }
00317 
00318     <span class="comment">/*</span>
00319 <span class="comment">     * If we're changing from visible to hidden or vise-versa, send</span>
00320 <span class="comment">     * WM_SHOWWINDOW.</span>
00321 <span class="comment">     */</span>
00322     fVisNew = !(cmdShow == SW_HIDE);
00323     <span class="keywordflow">if</span> (fVisNew != fVisOld) {
00324         <a class="code" href="../../d4/d1/userk_8h.html#a1579">xxxSendMessage</a>(pwnd, WM_SHOWWINDOW, fVisNew, 0L);
00325         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN31COMPAT)) {
00326             <a class="code" href="../../d4/d1/userk_8h.html#a1579">xxxSendMessage</a>(pwnd, WM_SETVISIBLE, fVisNew, 0L);
00327         }
00328     }
00329 
00330     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwnd)) {
00331         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a485">TestCF</a>(pwnd, CFSAVEBITS)) {
00332 
00333             <span class="comment">/*</span>
00334 <span class="comment">             * Activate to prevent discarding saved bits???</span>
00335 <span class="comment">             */</span>
00336             <span class="keywordflow">if</span> (cmdShow == SW_SHOW || cmdShow == SW_SHOWNORMAL) {
00337                 <a class="code" href="../../d4/d1/userk_8h.html#a1230">xxxActivateWindow</a>(pwnd, AW_USE);
00338                 swpFlags |= SWP_NOZORDER | SWP_NOACTIVATE;
00339             }
00340         }
00341     } <span class="keywordflow">else</span> {
00342 
00343         <span class="comment">/*</span>
00344 <span class="comment">         * Children can't get activation...</span>
00345 <span class="comment">         */</span>
00346         swpFlags |= (SWP_NOACTIVATE | SWP_NOZORDER);
00347     }
00348 
00349     <span class="comment">/*</span>
00350 <span class="comment">     * If our parent is hidden, don't bother to call xxxSetWindowPos.</span>
00351 <span class="comment">     */</span>
00352     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a1">_FChildVisible</a>(pwnd)) {
00353         <a class="code" href="../../d4/d1/userk_8h.html#a1615">xxxSetWindowPos</a>(pwnd, (<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>)NULL, 0, 0, 0, 0, swpFlags);
00354     } <span class="keywordflow">else</span> {
00355         <span class="keywordflow">if</span> (cmdShow == SW_HIDE)
00356             <a class="code" href="../../d4/d1/userk_8h.html#a1626">SetVisible</a>(pwnd, SV_UNSET);
00357         <span class="keywordflow">else</span>
00358             <a class="code" href="../../d4/d1/userk_8h.html#a1626">SetVisible</a>(pwnd, SV_SET);
00359     }
00360 
00361     <span class="comment">/*</span>
00362 <span class="comment">     * Send size and move messages AFTER repainting</span>
00363 <span class="comment">     */</span>
00364     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFSENDSIZEMOVE)) {
00365         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a733">ClrWF</a>(pwnd, WFSENDSIZEMOVE);
00366         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMINIMIZED)) {
00367             <a class="code" href="../../d4/d1/userk_8h.html#a1505">xxxSendSizeMessage</a>(pwnd, SIZE_MINIMIZED);
00368         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMAXIMIZED)) {
00369             <a class="code" href="../../d4/d1/userk_8h.html#a1505">xxxSendSizeMessage</a>(pwnd, SIZE_MAXIMIZED);
00370         } <span class="keywordflow">else</span> {
00371             <a class="code" href="../../d4/d1/userk_8h.html#a1505">xxxSendSizeMessage</a>(pwnd, SIZE_RESTORED);
00372         }
00373 
00374         <a class="code" href="../../d4/d1/userk_8h.html#a1579">xxxSendMessage</a>(pwnd, WM_MOVE, 0,
00375                 (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a> == <a class="code" href="../../d4/d1/userk_8h.html#a322">PWNDDESKTOP</a>(pwnd)) ?
00376                 MAKELONG(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.left, pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.top) :
00377                 MAKELONG(
00378                     pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.left - pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.left,
00379                     pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.top - pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>. top));
00380     }
00381 
00382     <span class="comment">/*</span>
00383 <span class="comment">     * If hiding and is active-foreground window, activate someone else.</span>
00384 <span class="comment">     * If hiding a active window make someone active.</span>
00385 <span class="comment">     */</span>
00386     <span class="keywordflow">if</span> (cmdShow == SW_HIDE) {
00387         <span class="keywordflow">if</span> ((pwnd == pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o3">pq</a>-&gt;<a class="code" href="../../d7/d4/structtagQ.html#o8">spwndActive</a>) &amp;&amp; (pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o3">pq</a> == <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a29">gpqForeground</a>)) {
00388             <a class="code" href="../../d4/d1/userk_8h.html#a1230">xxxActivateWindow</a>(pwnd, AW_SKIP);
00389         } <span class="keywordflow">else</span> {
00390             <a class="code" href="../../d4/d1/userk_8h.html#a1506">xxxCheckFocus</a>(pwnd);
00391         }
00392     }
00393 
00394     <span class="keywordflow">return</span> fVisOld;
00395 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:39 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
