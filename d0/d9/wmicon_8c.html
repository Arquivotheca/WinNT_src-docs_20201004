<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: wmicon.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>wmicon.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d1/d8/wmicon_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/wmicon_8c.html#a0">SetBestStretchMode</a>(hdc, bpp, fHT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/wmicon_8c.html#a1">GetCWidth</a>(cxOrg, lrF, cxDes)&nbsp;&nbsp;&nbsp;(cxOrg ? cxOrg : ((lrF &amp; DI_DEFAULTSIZE) ? SYSMET(CXICON) : cxDes))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/wmicon_8c.html#a2">GetCHeight</a>(cyOrg, lrF, cyDes)&nbsp;&nbsp;&nbsp;(cyOrg ? cyOrg : ((lrF &amp; DI_DEFAULTSIZE) ? SYSMET(CYICON) : cyDes))</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/wmicon_8c.html#a3">BltIcon</a> (HDC hdc, int x, int y, int cx, int <a class="el" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>, HDC hdcSrc, <a class="el" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a> pcur, BOOL fMask, LONG rop)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d9/wmicon_8c.html#a4">_DrawIconEx</a> (HDC hdc, int x, int y, <a class="el" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a> pcur, int cx, int <a class="el" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>, UINT istepIfAniCur, HBRUSH hbr, UINT diFlags)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="wmicon.c::GetCHeight" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GetCHeight          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cyOrg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>lrF,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cyDes&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(cyOrg ? cyOrg : ((lrF &amp; DI_DEFAULTSIZE) ? SYSMET(CYICON) : cyDes))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00023">23</a> of file <a class="el" href="../../d1/d8/wmicon_8c-source.html">wmicon.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00093">_DrawIconEx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="wmicon.c::GetCWidth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GetCWidth          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cxOrg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>lrF,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cxDes&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(cxOrg ? cxOrg : ((lrF &amp; DI_DEFAULTSIZE) ? SYSMET(CXICON) : cxDes))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00020">20</a> of file <a class="el" href="../../d1/d8/wmicon_8c-source.html">wmicon.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00093">_DrawIconEx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="wmicon.c::SetBestStretchMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SetBestStretchMode          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hdc,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>bpp,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fHT&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>GreSetStretchBltMode(hdc,                                            \
                         (fHT ? HALFTONE :                               \
                             ((bpp) == 1 ? BLACKONWHITE : COLORONCOLOR)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00015">15</a> of file <a class="el" href="../../d1/d8/wmicon_8c-source.html">wmicon.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="wmicon.c::_DrawIconEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _DrawIconEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcur</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>istepIfAniCur</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HBRUSH&nbsp;</td>
          <td class="mdname" nowrap> <em>hbr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>diFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00093">93</a> of file <a class="el" href="../../d1/d8/wmicon_8c-source.html">wmicon.c</a>.
<p>
References <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00032">BltIcon()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02176">CURSORF_ACON</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00023">GetCHeight</a>, <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00020">GetCWidth</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00493">ghdcMem</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/caption_8c-source.html#l00462">DrawCaptionIcon()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01710">NtUserDrawIconEx()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l00808">xxxPaintIconsInSwitchWindow()</a>, and <a class="el" href="../../d7/d1/mndraw_8c-source.html#l00954">xxxRealDrawMenuItem()</a>.
<p>
<pre class="fragment"><div>00103 {
00104     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00105 
00106     <span class="comment">/*</span>
00107 <span class="comment">     * If this is an animated cursor, just grab the ith frame and use it</span>
00108 <span class="comment">     * for drawing.</span>
00109 <span class="comment">     */</span>
00110     <span class="keywordflow">if</span> (pcur-&gt;CURSORF_flags &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a537">CURSORF_ACON</a>) {
00111 
00112         <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)istepIfAniCur &gt;= ((<a class="code" href="../../d1/d8/structtagACON.html">PACON</a>)pcur)-&gt;cicur) {
00113             RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"DrawIconEx, icon step out of range."</span>);
00114             <span class="keywordflow">goto</span> Done;
00115         }
00116 
00117         pcur = ((<a class="code" href="../../d1/d8/structtagACON.html">PACON</a>)pcur)-&gt;aspcur[((<a class="code" href="../../d1/d8/structtagACON.html">PACON</a>)pcur)-&gt;aicur[istepIfAniCur]];
00118     }
00119 
00120     <span class="comment">/*</span>
00121 <span class="comment">     * Setup defaults.</span>
00122 <span class="comment">     */</span>
00123     cx = <a class="code" href="../../d0/d9/wmicon_8c.html#a1">GetCWidth</a>(cx, diFlags, pcur-&gt;cx);
00124     <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> = <a class="code" href="../../d0/d9/wmicon_8c.html#a2">GetCHeight</a>(cy, diFlags, (pcur-&gt;cy / 2));
00125 
00126     <span class="keywordflow">if</span> (hbr) {
00127 
00128         HBITMAP    hbmpT = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00129         HDC        hdcT;
00130         HBITMAP    hbmpOld;
00131         POLYPATBLT PolyData;
00132 
00133         <span class="keywordflow">if</span> (hdcT = GreCreateCompatibleDC(hdc)) {
00134 
00135             <span class="keywordflow">if</span> (hbmpT = GreCreateCompatibleBitmap(hdc, cx, cy)) {
00136                 POINT pt;
00137                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bRet;
00138 
00139                 hbmpOld = GreSelectBitmap(hdcT, hbmpT);
00140 
00141                 <span class="comment">/*</span>
00142 <span class="comment">                 * Set new dc's brush origin in same relative</span>
00143 <span class="comment">                 * location as passed-in dc's.</span>
00144 <span class="comment">                 */</span>
00145                 bRet = GreGetBrushOrg(hdc, &amp;pt);
00146                 <span class="comment">/*</span>
00147 <span class="comment">                 * Bug 292396 - joejo</span>
00148 <span class="comment">                 * Stop overactive asserts by replacing with RIPMSG.</span>
00149 <span class="comment">                 */</span>
00150                 <span class="keywordflow">if</span> (bRet != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00151                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"DrawIconEx, GreGetBrushOrg failed."</span>);
00152                 }
00153 
00154                 bRet = GreSetBrushOrg(hdcT, pt.x, pt.y, NULL);
00155                 <span class="keywordflow">if</span> (bRet != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00156                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"DrawIconEx, GreSetBrushOrg failed."</span>);
00157                 }
00158 
00159                 PolyData.x         = 0;
00160                 PolyData.y         = 0;
00161                 PolyData.cx        = cx;
00162                 PolyData.cy        = <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
00163                 PolyData.BrClr.hbr = hbr;
00164 
00165                 bRet = GrePolyPatBlt(hdcT, PATCOPY, &amp;PolyData, 1, PPB_BRUSH);
00166                 <span class="keywordflow">if</span> (bRet != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00167                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"DrawIconEx, GrePolyPatBlt failed."</span>);
00168                 }
00169                 
00170                 <span class="comment">/*</span>
00171 <span class="comment">                 * Output the image to the temporary memoryDC.</span>
00172 <span class="comment">                 */</span>
00173                 <a class="code" href="../../d0/d9/wmicon_8c.html#a3">BltIcon</a>(hdcT, 0, 0, cx, cy, ghdcMem, pcur, TRUE, SRCAND);
00174                 <a class="code" href="../../d0/d9/wmicon_8c.html#a3">BltIcon</a>(hdcT, 0, 0, cx, cy, ghdcMem, pcur, FALSE, SRCINVERT);
00175 
00176                 <span class="comment">/*</span>
00177 <span class="comment">                 * Blt the bitmap to the original DC.</span>
00178 <span class="comment">                 */</span>
00179                 GreBitBlt(hdc, x, y, cx, cy, hdcT, 0, 0, SRCCOPY, (COLORREF)-1);
00180 
00181                 GreSelectBitmap(hdcT, hbmpOld);
00182 
00183                 bRet = GreDeleteObject(hbmpT);
00184                 <span class="keywordflow">if</span> (bRet != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00185                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"DrawIconEx, GreDeleteObject failed. Possible Leak"</span>);
00186                 }
00187                 
00188                 fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00189             }
00190 
00191             GreDeleteDC(hdcT);
00192         }
00193 
00194     } <span class="keywordflow">else</span> {
00195 
00196         <span class="keywordflow">if</span> (diFlags &amp; DI_MASK) {
00197 
00198             <a class="code" href="../../d0/d9/wmicon_8c.html#a3">BltIcon</a>(hdc,
00199                     x,
00200                     y,
00201                     cx,
00202                     cy,
00203                     ghdcMem,
00204                     pcur,
00205                     TRUE,
00206                     ((diFlags &amp; DI_IMAGE) ? SRCAND : SRCCOPY));
00207         }
00208 
00209         <span class="keywordflow">if</span> (diFlags &amp; DI_IMAGE) {
00210 
00211             <a class="code" href="../../d0/d9/wmicon_8c.html#a3">BltIcon</a>(hdc,
00212                     x,
00213                     y,
00214                     cx,
00215                     cy,
00216                     ghdcMem,
00217                     pcur,
00218                     FALSE,
00219                     ((diFlags &amp; DI_MASK) ? SRCINVERT : SRCCOPY));
00220         }
00221 
00222         fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00223     }
00224 
00225 Done:
00226 
00227     <span class="keywordflow">return</span> fSuccess;
00228 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="wmicon.c::BltIcon" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL BltIcon           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdcSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcur</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>rop</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00032">32</a> of file <a class="el" href="../../d1/d8/wmicon_8c-source.html">wmicon.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00299">SetBestStretchMode</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/wmicon_8c-source.html#l00093">_DrawIconEx()</a>, and <a class="el" href="../../d2/d4/caption_8c-source.html#l00401">BltMe4Times()</a>.
<p>
<pre class="fragment"><div>00042 {
00043     HBITMAP hbmpSave;
00044     HBITMAP hbmpUse;
00045     LONG    rgbText;
00046     LONG    rgbBk;
00047     <span class="keywordtype">int</span>     nMode;
00048 
00049     <span class="comment">/*</span>
00050 <span class="comment">     * Setup the DC for drawing</span>
00051 <span class="comment">     */</span>
00052     hbmpUse = (fMask || !pcur-&gt;hbmColor ? pcur-&gt;hbmMask : pcur-&gt;hbmColor);
00053 
00054     rgbBk   = GreSetBkColor(hdc, 0x00FFFFFFL);
00055     rgbText = GreSetTextColor(hdc, 0x00000000L);
00056     nMode   = <a class="code" href="../../d6/d0/usercli_8h.html#a31">SetBestStretchMode</a>(hdc, pcur-&gt;bpp, FALSE);
00057 
00058     hbmpSave = GreSelectBitmap(hdcSrc, hbmpUse);
00059 
00060     <span class="comment">/*</span>
00061 <span class="comment">     * Do the output to the surface.  By passing in (-1) as the background</span>
00062 <span class="comment">     * color, we are telling GDI to use the background-color already set</span>
00063 <span class="comment">     * in the DC.</span>
00064 <span class="comment">     */</span>
00065     GreStretchBlt(hdc,
00066                   x,
00067                   y,
00068                   cx,
00069                   cy,
00070                   hdcSrc,
00071                   0,
00072                   (fMask || pcur-&gt;hbmColor ? 0 : pcur-&gt;cy / 2),
00073                   pcur-&gt;cx,
00074                   pcur-&gt;cy / 2,
00075                   rop,
00076                   (COLORREF)-1);
00077 
00078     GreSetStretchBltMode(hdc, nMode);
00079     GreSetTextColor(hdc, rgbText);
00080     GreSetBkColor(hdc, rgbBk);
00081 
00082     GreSelectBitmap(hdcSrc, hbmpSave);
00083 
00084     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00085 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:09 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
