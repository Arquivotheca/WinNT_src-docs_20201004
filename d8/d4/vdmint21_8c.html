<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: vdmint21.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>vdmint21.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>
<code>#include "<a class="el" href="../../d2/d4/vdmntos_8h-source.html">vdmntos.h</a>"</code><br>

<p>
<a href="../../d9/d3/vdmint21_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a0">IDT_ACCESS_DPL_USER</a>&nbsp;&nbsp;&nbsp;0x6000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a1">IDT_ACCESS_TYPE_386_TRAP</a>&nbsp;&nbsp;&nbsp;0xF00</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a2">IDT_ACCESS_TYPE_286_TRAP</a>&nbsp;&nbsp;&nbsp;0x700</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a3">IDT_ACCESS_PRESENT</a>&nbsp;&nbsp;&nbsp;0x8000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a4">LDT_MASK</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a5">KiLoadInt21Entry</a>()&nbsp;&nbsp;&nbsp;KeGetPcr()-&gt;<a class="el" href="../../d6/d9/kernlini_8c.html#a27">IDT</a>[0x21] = PsGetCurrentProcess()-&gt;Pcb.Int21Descriptor</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a6">Ki386GetSelectorParameters</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector, OUT PULONG Flags, OUT PULONG Base, OUT PULONG Limit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a7">Ki386LoadTargetInt21Entry</a> (IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a54">PKIPI_CONTEXT</a> SignalDone, IN PVOID Parameter1, IN PVOID Parameter2, IN PVOID Parameter3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d4/vdmint21_8c.html#a8">Ke386SetVdmInterruptHandler</a> (<a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process, ULONG Interrupt, <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector, ULONG <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>, BOOLEAN Gate32)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="vdmint21.c::IDT_ACCESS_DPL_USER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IDT_ACCESS_DPL_USER&nbsp;&nbsp;&nbsp;0x6000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00030">30</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="vdmint21.c::IDT_ACCESS_PRESENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IDT_ACCESS_PRESENT&nbsp;&nbsp;&nbsp;0x8000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00033">33</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="vdmint21.c::IDT_ACCESS_TYPE_286_TRAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IDT_ACCESS_TYPE_286_TRAP&nbsp;&nbsp;&nbsp;0x700          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00032">32</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="vdmint21.c::IDT_ACCESS_TYPE_386_TRAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IDT_ACCESS_TYPE_386_TRAP&nbsp;&nbsp;&nbsp;0xF00          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00031">31</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="vdmint21.c::KiLoadInt21Entry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KiLoadInt21Entry          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;KeGetPcr()-&gt;<a class="el" href="../../d6/d9/kernlini_8c.html#a27">IDT</a>[0x21] = PsGetCurrentProcess()-&gt;Pcb.Int21Descriptor</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00060">60</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>, and <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00194">Ki386LoadTargetInt21Entry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="vdmint21.c::LDT_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LDT_MASK&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00034">34</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a8" doxytag="vdmint21.c::Ke386SetVdmInterruptHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS Ke386SetVdmInterruptHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Interrupt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Gate32</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">64</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00030">IDT_ACCESS_DPL_USER</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00033">IDT_ACCESS_PRESENT</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00032">IDT_ACCESS_TYPE_286_TRAP</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00031">IDT_ACCESS_TYPE_386_TRAP</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d8/d4/vdmint21_8c.html#a6">Ki386GetSelectorParameters()</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00194">Ki386LoadTargetInt21Entry()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00060">KiLoadInt21Entry</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00034">LDT_MASK</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/vdmentry_8c-source.html#l00051">NtVdmControl()</a>.
<p>
<pre class="fragment"><div>00074                    :
00075 
00076     The specified (software) interrupt entry of IDT will be updated to
00077     point to the specified handler.  For all threads which belong to the
00078     specified process, their execution processors will be notified to
00079     make the same change.
00080 
00081     This function only exists on i386 and i386 compatible processors.
00082 
00083     No checking is done on the validity of the interrupt handler.
00084 
00085 Arguments:
00086 
00087     Process - Pointer to <a class="code" href="../../d5/d7/struct__KPROCESS.html">KPROCESS</a> object describing the process for
00088         which the <span class="keywordtype">int</span> 21 entry is to be set.
00089 
00090     Interrupt - The software interrupt vector which will be updated.
00091 
00092     Selector, offset - Specified the address of the new handler.
00093 
00094     Gate32 - True if the gate should be 32 bit, false otherwise
00095 
00096 Return Value:
00097 
00098     NTSTATUS.
00099 
00100 --*/
00101 
00102 {
00103 
00104     KIRQL OldIrql;
00105     BOOLEAN LocalProcessor;
00106     KAFFINITY TargetProcessors;
00107     PKPRCB  Prcb;
00108     KIDTENTRY IdtDescriptor;
00109     ULONG Flags, Base, Limit;
00110 
00111     <span class="comment">//</span>
00112     <span class="comment">// Check the validity of the request</span>
00113     <span class="comment">// 1. Currently, we support int21 redirection only</span>
00114     <span class="comment">// 2. The specified interrupt handler must be in user space.</span>
00115     <span class="comment">//</span>
00116 
00117     <span class="keywordflow">if</span> (Interrupt != 0x21 || <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> &gt;= (ULONG)MM_HIGHEST_USER_ADDRESS ||
00118         !<a class="code" href="../../d8/d4/vdmint21_8c.html#a6">Ki386GetSelectorParameters</a>(Selector, &amp;Flags, &amp;Base, &amp;Limit) ){
00119         <span class="keywordflow">return</span>(STATUS_INVALID_PARAMETER);
00120     }
00121 
00122     <span class="comment">//</span>
00123     <span class="comment">// Initialize the contents of the IDT entry</span>
00124     <span class="comment">//</span>
00125 
00126     IdtDescriptor.Offset = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>;
00127     IdtDescriptor.Selector = Selector | RPL_MASK | <a class="code" href="../../d8/d4/vdmint21_8c.html#a4">LDT_MASK</a>;
00128     IdtDescriptor.ExtendedOffset = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> &gt;&gt; 16);
00129     IdtDescriptor.Access = <a class="code" href="../../d8/d4/vdmint21_8c.html#a0">IDT_ACCESS_DPL_USER</a> | <a class="code" href="../../d8/d4/vdmint21_8c.html#a3">IDT_ACCESS_PRESENT</a>;
00130     <span class="keywordflow">if</span> (Gate32) {
00131         IdtDescriptor.Access |= <a class="code" href="../../d8/d4/vdmint21_8c.html#a1">IDT_ACCESS_TYPE_386_TRAP</a>;
00132 
00133     } <span class="keywordflow">else</span> {
00134         IdtDescriptor.Access |= <a class="code" href="../../d8/d4/vdmint21_8c.html#a2">IDT_ACCESS_TYPE_286_TRAP</a>;
00135     }
00136 
00137     <span class="comment">//</span>
00138     <span class="comment">// Acquire the context swap lock so a context switch will not occur.</span>
00139     <span class="comment">//</span>
00140 
00141     <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00142 
00143     <span class="comment">//</span>
00144     <span class="comment">// Set the Ldt fields in the process object</span>
00145     <span class="comment">//</span>
00146 
00147     Process-&gt;Int21Descriptor = IdtDescriptor;
00148 
00149     <span class="comment">//</span>
00150     <span class="comment">// Tell all processors active for this process to reload their LDTs</span>
00151     <span class="comment">//</span>
00152 
00153 <span class="preprocessor">#if !defined(NT_UP)</span>
00154 <span class="preprocessor"></span>
00155     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00156     TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a> &amp; ~Prcb-&gt;SetMember;
00157     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00158         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00159                         Ki386LoadTargetInt21Entry,
00160                         NULL,
00161                         NULL,
00162                         NULL);
00163     }
00164 
00165 <span class="preprocessor">#endif</span>
00166 <span class="preprocessor"></span>
00167     <a class="code" href="../../d8/d4/vdmint21_8c.html#a5">KiLoadInt21Entry</a>();
00168 
00169 <span class="preprocessor">#if !defined(NT_UP)</span>
00170 <span class="preprocessor"></span>
00171     <span class="comment">//</span>
00172     <span class="comment">// Wait until all of the target processors have finished reloading</span>
00173     <span class="comment">// their LDT.</span>
00174     <span class="comment">//</span>
00175 
00176     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00177         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00178     }
00179 
00180 <span class="preprocessor">#endif</span>
00181 <span class="preprocessor"></span>
00182     <span class="comment">//</span>
00183     <span class="comment">// Restore IRQL and unlock the context swap lock.</span>
00184     <span class="comment">//</span>
00185 
00186     <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00187     <span class="keywordflow">return</span> STATUS_SUCCESS;
00188 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="vdmint21.c::Ki386GetSelectorParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ki386GetSelectorParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Base</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01045">PushPmInterrupt()</a>, and <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01034">VdmConvertToLinearAddress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="vdmint21.c::Ki386LoadTargetInt21Entry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ki386LoadTargetInt21Entry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a54">PKIPI_CONTEXT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00194">194</a> of file <a class="el" href="../../d9/d3/vdmint21_8c-source.html">vdmint21.c</a>.
<p>
References <a class="el" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone()</a>, and <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00060">KiLoadInt21Entry</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/vdmint21_8c-source.html#l00064">Ke386SetVdmInterruptHandler()</a>.
<p>
<pre class="fragment"><div>00202                    :
00203 
00204     Reload local Ldt <span class="keyword">register</span> and clear signal bit in TargetProcessor mask
00205 
00206 Arguments:
00207 
00208     Argument - pointer to a ipi packet structure.
00209     ReadyFlag - Pointer to flag to be set once LDTR has been reloaded
00210 
00211 Return Value:
00212 
00213     none.
00214 
00215 --*/
00216 
00217 {
00218 
00219     <span class="comment">//</span>
00220     <span class="comment">// Set the int 21 entry of IDT from currently active process object</span>
00221     <span class="comment">//</span>
00222 
00223     <a class="code" href="../../d8/d4/vdmint21_8c.html#a5">KiLoadInt21Entry</a>();
00224     <a class="code" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone</a>(PacketContext);
00225     <span class="keywordflow">return</span>;
00226 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:07 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
