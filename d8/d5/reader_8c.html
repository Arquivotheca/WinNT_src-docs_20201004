<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: reader.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>reader.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d9/d4/reader_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a0">TIMERID</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a1">READERCLASS</a>&nbsp;&nbsp;&nbsp;L"User32_ReaderMode"</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>__inline&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a3">FReader2Dim</a> (<a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a4">FReaderVert</a> (<a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a5">FReaderHorz</a> (<a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a6">FReaderDiag</a> (<a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a7">ReaderSetCursor</a> (<a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr, UINT uCursor)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a8">ReaderMouseMove</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, <a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a9">ReaderFeedback</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, <a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT CALLBACK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a10">ReaderWndProc</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a11">ReaderProcInternal</a> (LPARAM lParam, int nCode, int dx, int dy)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a12">EnterReaderMode</a> (<a class="el" href="../../d0/d5/structtagREADERMODE.html">PREADERMODE</a> prdrm)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a13">FScrollEnabled</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, BOOL fVert)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a14">EnterReaderModeHelper</a> (HWND hwnd)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ATOM&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/reader_8c.html#a2">gatomReaderMode</a> = 0</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="reader.c::READERCLASS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define READERCLASS&nbsp;&nbsp;&nbsp;L"User32_ReaderMode"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00352">352</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00355">EnterReaderMode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="reader.c::TIMERID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TIMERID&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00015">15</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a12" doxytag="reader.c::EnterReaderMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnterReaderMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/structtagREADERMODE.html">PREADERMODE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prdrm</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00355">355</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01197">_CreateWindowEx()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00835">FNID_DDE_BIT</a>, <a class="el" href="../../d9/d5/ntuser_2client_2globals_8h-source.html#l00056">gatomReaderMode</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00096">GetCapture()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00352">READERCLASS</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>, and <a class="el" href="../../d6/d0/usercli_8h.html#a636">RegisterClassExWOWW()</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00415">EnterReaderModeHelper()</a>.
<p>
<pre class="fragment"><div>00356 {
00357     WNDCLASSEX wce;
00358 
00359     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a12">GetCapture</a>() != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00360         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00361 
00362     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/ntuser_2client_2globals_8h.html#a32">gatomReaderMode</a> == 0) {
00363         wce.cbSize = <span class="keyword">sizeof</span>(wce);
00364         wce.style = CS_DBLCLKS | CS_HREDRAW | CS_VREDRAW;
00365         wce.lpfnWndProc = <a class="code" href="../../d8/d5/reader_8c.html#a10">ReaderWndProc</a>;
00366         wce.cbClsExtra = 0;
00367         wce.cbWndExtra = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>);
00368         wce.hInstance = <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>;
00369         wce.hIcon = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00370         wce.hCursor = LoadCursor(NULL, IDC_ARROW);
00371         wce.hbrBackground = GetStockObject(WHITE_BRUSH);
00372         wce.lpszMenuName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00373         wce.lpszClassName = <a class="code" href="../../d8/d5/reader_8c.html#a1">READERCLASS</a>;
00374         wce.hIconSm = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00375 
00376         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d6/ntuser_2client_2globals_8h.html#a32">gatomReaderMode</a> = <a class="code" href="../../d6/d0/usercli_8h.html#a636">RegisterClassExWOWW</a>(&amp;wce, NULL, FNID_DDE_BIT)) == 0) {
00377             RIPMSG0(RIP_WARNING, <span class="stringliteral">"EnterReaderMode: failed to register ReaderMode"</span>);
00378             <span class="keywordflow">return</span> 0;
00379         }
00380     }
00381 
00382     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a624">_CreateWindowEx</a>(0, READERCLASS, NULL, 0, 0, 0, 0, 0,
00383             NULL, NULL, hmodUser, (PVOID)prdrm, 0) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00384 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="reader.c::EnterReaderModeHelper" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EnterReaderModeHelper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00415">415</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02163">tagREADERMODE::cbSize</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02164">tagREADERMODE::dwFlags</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00355">EnterReaderMode()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00391">FScrollEnabled()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02166">tagREADERMODE::lParam</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02165">tagREADERMODE::pfnReaderModeProc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02170">RDRMODE_HORZ</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02169">RDRMODE_VERT</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00311">ReaderProcInternal()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/lb1_8c-source.html#l00032">ListBoxWndProcWorker()</a>, and <a class="el" href="../../d2/d4/editml_8c-source.html#l03457">MLEditWndProc()</a>.
<p>
<pre class="fragment"><div>00416 {
00417     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
00418     <a class="code" href="../../d0/d5/structtagREADERMODE.html">READERMODE</a> rdrm;
00419 
00420     rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o0">cbSize</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/structtagREADERMODE.html">READERMODE</a>);
00421     rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o2">pfnReaderModeProc</a> = <a class="code" href="../../d8/d5/reader_8c.html#a11">ReaderProcInternal</a>;
00422     rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o3">lParam</a> = (LPARAM)hwnd;
00423     rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o1">dwFlags</a> = 0;
00424 
00425     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a13">FScrollEnabled</a>(pwnd, TRUE)) {
00426         rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o1">dwFlags</a> |= <a class="code" href="../../d6/d0/usercli_8h.html#a284">RDRMODE_VERT</a>;
00427     }
00428     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a13">FScrollEnabled</a>(pwnd, FALSE)) {
00429         rdrm.<a class="code" href="../../d0/d5/structtagREADERMODE.html#o1">dwFlags</a> |= <a class="code" href="../../d6/d0/usercli_8h.html#a285">RDRMODE_HORZ</a>;
00430     }
00431 
00432     <span class="keywordflow">return</span> <a class="code" href="../../d8/d5/reader_8c.html#a12">EnterReaderMode</a>(&amp;rdrm);
00433 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="reader.c::FReader2Dim" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline FReader2Dim           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00017">17</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a401">PREADERINFO</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02170">RDRMODE_HORZ</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02169">RDRMODE_VERT</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>, and <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.
<p>
<pre class="fragment"><div>00018 {
00019     <span class="keywordflow">return</span> ((prdr-&gt;dwFlags &amp; (<a class="code" href="../../d6/d0/usercli_8h.html#a285">RDRMODE_HORZ</a> | <a class="code" href="../../d6/d0/usercli_8h.html#a284">RDRMODE_VERT</a>)) == 
00020             (<a class="code" href="../../d6/d0/usercli_8h.html#a285">RDRMODE_HORZ</a> | <a class="code" href="../../d6/d0/usercli_8h.html#a284">RDRMODE_VERT</a>));
00021 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="reader.c::FReaderDiag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline FReaderDiag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00030">30</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l02171">RDRMODE_DIAG</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>.
<p>
<pre class="fragment"><div>00031 {
00032     <span class="keywordflow">return</span> (prdr-&gt;dwFlags &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a286">RDRMODE_DIAG</a>);
00033 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="reader.c::FReaderHorz" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline FReaderHorz           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00026">26</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l02170">RDRMODE_HORZ</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>, and <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.
<p>
<pre class="fragment"><div>00027 {
00028     <span class="keywordflow">return</span> (prdr-&gt;dwFlags &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a285">RDRMODE_HORZ</a>);
00029 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="reader.c::FReaderVert" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline FReaderVert           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00022">22</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l02169">RDRMODE_VERT</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>, and <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.
<p>
<pre class="fragment"><div>00023 {
00024     <span class="keywordflow">return</span> (prdr-&gt;dwFlags &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a284">RDRMODE_VERT</a>);
00025 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="reader.c::FScrollEnabled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL FScrollEnabled           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fVert</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00391">391</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00210">REBASEALWAYS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02261">WFHPRESENT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02260">WFVPRESENT</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01790">tagSBINFO::WSBflags</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00415">EnterReaderModeHelper()</a>.
<p>
<pre class="fragment"><div>00392 {
00393     <a class="code" href="../../d5/d5/structtagSBINFO.html">PSBINFO</a> pw;
00394     <span class="keywordtype">int</span> nFlags;
00395 
00396     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, fVert ? WFVPRESENT : WFHPRESENT))
00397         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00398 
00399     <span class="keywordflow">if</span> ((pw = (<a class="code" href="../../d5/d5/structtagSBINFO.html">PSBINFO</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a24">REBASEALWAYS</a>(pwnd, pSBInfo)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00400         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00401 
00402     nFlags = fVert ? (pw-&gt;<a class="code" href="../../d5/d5/structtagSBINFO.html#o0">WSBflags</a> &gt;&gt; 2) : pw-&gt;<a class="code" href="../../d5/d5/structtagSBINFO.html#o0">WSBflags</a>;
00403 
00404     <span class="keywordflow">if</span> ((nFlags &amp; SB_DISABLE_MASK) == SB_DISABLE_MASK)
00405         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00406 
00407     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00408 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="reader.c::ReaderFeedback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ReaderFeedback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>prdr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00141">141</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l02179">tagREADERINFO::dx</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02180">tagREADERINFO::dy</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02174">RDRCODE_SCROLL</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.
<p>
<pre class="fragment"><div>00142 {
00143     <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o1">dx</a> == 0 &amp;&amp; prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o2">dy</a> == 0)
00144         <span class="keywordflow">return</span>;
00145 
00146     <span class="keywordflow">if</span> (prdr-&gt;pfnReaderModeProc(prdr-&gt;lParam, RDRCODE_SCROLL, 
00147             prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o1">dx</a>, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o2">dy</a>) == 0) {
00148         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(pwnd));
00149     }
00150 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="reader.c::ReaderMouseMove" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ReaderMouseMove           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>prdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">57</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00893">_ClientToScreen()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02354">abs</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02179">tagREADERINFO::dx</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02180">tagREADERINFO::dy</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00017">FReader2Dim()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00030">FReaderDiag()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00026">FReaderHorz()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00022">FReaderVert()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00143">GET_X_LPARAM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00147">GET_Y_LPARAM</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01838">tagWND::rcWindow</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00040">ReaderSetCursor()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>.
<p>
<pre class="fragment"><div>00058 {
00059     <span class="keywordtype">int</span> dx = 0, dy = 0;
00060     LPRECT prc = &amp;pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o6">rcWindow</a>;
00061     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uCursor;
00062     POINT pt = {<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a7">GET_X_LPARAM</a>(lParam), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a8">GET_Y_LPARAM</a>(lParam)};
00063     
00064     <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a18">_ClientToScreen</a>(pwnd, &amp;pt);
00065 
00066     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a4">FReaderVert</a>(prdr)) {
00067         <span class="keywordflow">if</span> (pt.y &lt; prc-&gt;top) {
00068             dy = pt.y - prc-&gt;top;
00069         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pt.y &gt; prc-&gt;bottom) {
00070             dy = pt.y - prc-&gt;bottom;
00071         }
00072     }
00073 
00074     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a5">FReaderHorz</a>(prdr)) {
00075         <span class="keywordflow">if</span> (pt.x &lt; prc-&gt;left) {
00076             dx = pt.x - prc-&gt;left;
00077         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pt.x &gt; prc-&gt;right) {
00078             dx = pt.x - prc-&gt;right;
00079         }
00080     }
00081     
00082     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a3">FReader2Dim</a>(prdr)) {
00083         <span class="keywordflow">if</span> (dx == 0 &amp;&amp; dy == 0) {
00084             <a class="code" href="../../d8/d5/reader_8c.html#a7">ReaderSetCursor</a>(prdr, OCR_RDR2DIM);
00085             <span class="keywordflow">goto</span> Exit;
00086         }
00087         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d5/reader_8c.html#a6">FReaderDiag</a>(prdr)) {
00088             <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o2">dy</a> != 0) {
00089                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(dx) &gt; <a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o2">dy</a>)) {
00090                     dy = 0;
00091                 } <span class="keywordflow">else</span> {
00092                     dx = 0;
00093                 }
00094             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o1">dx</a> != 0) {
00095                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(dy) &gt; <a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o1">dx</a>)) {
00096                     dx = 0;
00097                 } <span class="keywordflow">else</span> {
00098                     dy = 0;
00099                 }
00100             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dy != 0) {
00101                 dx = 0;
00102             }
00103         }
00104     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a4">FReaderVert</a>(prdr) &amp;&amp; dy == 0) {
00105         <a class="code" href="../../d8/d5/reader_8c.html#a7">ReaderSetCursor</a>(prdr, OCR_RDRVERT);
00106         <span class="keywordflow">goto</span> Exit;
00107     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a5">FReaderHorz</a>(prdr) &amp;&amp; dx == 0) {
00108         <a class="code" href="../../d8/d5/reader_8c.html#a7">ReaderSetCursor</a>(prdr, OCR_RDRHORZ);
00109         <span class="keywordflow">goto</span> Exit;
00110     }
00111 
00112     <span class="keywordflow">if</span> (dx == 0) {
00113         uCursor = (dy &gt; 0) ? OCR_RDRSOUTH : OCR_RDRNORTH;
00114     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dx &gt; 0) {
00115         <span class="keywordflow">if</span> (dy == 0) {
00116             uCursor = OCR_RDREAST;
00117         } <span class="keywordflow">else</span> {
00118             uCursor = (dy &gt; 0) ? OCR_RDRSOUTHEAST : OCR_RDRNORTHEAST;
00119         }
00120     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dx &lt; 0) {
00121         <span class="keywordflow">if</span> (dy == 0) {
00122             uCursor = OCR_RDRWEST;
00123         } <span class="keywordflow">else</span> {
00124             uCursor = (dy &gt; 0) ? OCR_RDRSOUTHWEST : OCR_RDRNORTHWEST;
00125         }
00126     }
00127 
00128     <a class="code" href="../../d8/d5/reader_8c.html#a7">ReaderSetCursor</a>(prdr, uCursor);
00129 
00130 Exit:
00131     prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o1">dx</a> = dx;
00132     prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o2">dy</a> = dy;
00133 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="reader.c::ReaderProcInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG ReaderProcInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dy</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00311">311</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02354">abs</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02174">RDRCODE_SCROLL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d4/d7/client_8c-source.html#l03608">UpdateWindow()</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00415">EnterReaderModeHelper()</a>.
<p>
<pre class="fragment"><div>00312 {
00313     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwDelay;
00314     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uMsg, uCode;
00315     <span class="keywordtype">int</span> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>, nAbs;
00316 
00317     <span class="keywordflow">if</span> (nCode != <a class="code" href="../../d6/d0/usercli_8h.html#a288">RDRCODE_SCROLL</a>)
00318         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00319 
00320     <span class="keywordflow">if</span> (dy != 0) {
00321         uCode = SB_LINEUP;
00322         uMsg = WM_VSCROLL;
00323         <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = dy;
00324     } <span class="keywordflow">else</span> {
00325         uCode = SB_LINELEFT;
00326         uMsg = WM_HSCROLL;
00327         <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = dx;
00328     }
00329 
00330     nAbs = <a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(n);
00331     <span class="keywordflow">if</span> (nAbs &gt;= 120) {
00332         uCode += 2;
00333         dwDelay = 0;
00334     } <span class="keywordflow">else</span> {
00335         dwDelay = 1000 - (nAbs / 2) * 15;
00336     }
00337 
00338     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> &gt; 0) {
00339         uCode += 1;
00340     }
00341 
00342     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>((HWND)lParam, uMsg, MAKELONG(uCode, dwDelay), 0);
00343     <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>((HWND)lParam);
00344     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00345 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="reader.c::ReaderSetCursor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ReaderSetCursor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>prdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uCursor</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00040">40</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05886">NtUserSetCursor()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02181">tagREADERINFO::uCursor</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>.
<p>
<pre class="fragment"><div>00041 {
00042     <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o3">uCursor</a> != uCursor) {
00043         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a224">NtUserSetCursor</a>(LoadCursor(NULL, MAKEINTRESOURCE(uCursor)));
00044         prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o3">uCursor</a> = uCursor;
00045     }
00046 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="reader.c::ReaderWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT CALLBACK ReaderWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">158</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
References <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00629">DefWindowProc()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00017">FReader2Dim()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00026">FReaderHorz()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00022">FReaderVert()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00143">GET_X_LPARAM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00147">GET_Y_LPARAM</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00608">GetClientRect()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00624">GetCursorPos()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02182">tagREADERINFO::hbm</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05388">NtUserKillTimer()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05822">NtUserSetCapture()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05902">NtUserSetFocus()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06092">NtUserSetTimer()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02180">NtUserSetWindowPos()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a2">pcs</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a398">PREADERMODE</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a403">PREADERWND</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00118">PtInRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02175">RDRCODE_END</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02173">RDRCODE_START</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00141">ReaderFeedback()</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a400">READERINFO</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a397">READERMODE</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00057">ReaderMouseMove()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03414">ReleaseCapture()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00906">SetWindowRgn()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00015">TIMERID</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00355">EnterReaderMode()</a>.
<p>
<pre class="fragment"><div>00159 {
00160     HDC hdc, hdcMem;
00161     HPEN hpen, hpenOld;
00162     HBRUSH hbrOld;
00163     HRGN hrgn;
00164     RECT rc;
00165     POINT pt;
00166     <span class="keywordtype">int</span> nBitmap, cx, <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
00167     <a class="code" href="../../d9/d4/structtagREADERINFO.html">PREADERINFO</a> prdr;
00168     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00169     LPCREATESTRUCT <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>;
00170     <a class="code" href="../../d0/d5/structtagREADERMODE.html">PREADERMODE</a> prdrm;
00171     BITMAP bmp;
00172 
00173     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00174         <span class="keywordflow">return</span> 0;
00175 
00176     prdr = ((<a class="code" href="../../d1/d5/structtagREADERWND.html">PREADERWND</a>)pwnd)-&gt;prdr;
00177 
00178     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00179     <span class="keywordflow">case</span> WM_TIMER:
00180         <a class="code" href="../../d8/d5/reader_8c.html#a9">ReaderFeedback</a>(pwnd, prdr);
00181         <span class="keywordflow">return</span> 0;
00182 
00183     <span class="keywordflow">case</span> WM_MOUSEWHEEL:
00184     <span class="keywordflow">case</span> WM_LBUTTONUP:
00185     <span class="keywordflow">case</span> WM_RBUTTONUP:
00186     <span class="keywordflow">case</span> WM_XBUTTONUP:
00187     <span class="keywordflow">case</span> WM_LBUTTONDOWN:
00188     <span class="keywordflow">case</span> WM_RBUTTONDOWN:
00189     <span class="keywordflow">case</span> WM_MBUTTONDOWN:
00190     <span class="keywordflow">case</span> WM_XBUTTONDOWN:
00191     <span class="keywordflow">case</span> WM_KEYDOWN:
00192         <a class="code" href="../../d3/d8/client_8c.html#a124">ReleaseCapture</a>();
00193         <span class="keywordflow">return</span> 0;
00194 
00195     <span class="keywordflow">case</span> WM_MOUSEMOVE:
00196         <a class="code" href="../../d8/d5/reader_8c.html#a8">ReaderMouseMove</a>(pwnd, prdr, lParam);
00197         <span class="keywordflow">return</span> 0;
00198 
00199     <span class="keywordflow">case</span> WM_MBUTTONUP:
00200         pt.x = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a7">GET_X_LPARAM</a>(lParam);
00201         pt.y = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a8">GET_Y_LPARAM</a>(lParam);
00202         <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(hwnd, &amp;rc);
00203         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/rect_8c.html#a5">PtInRect</a>(&amp;rc, pt)) {
00204             <a class="code" href="../../d3/d8/client_8c.html#a124">ReleaseCapture</a>();
00205         }
00206         <span class="keywordflow">return</span> 0;
00207 
00208     <span class="keywordflow">case</span> WM_CAPTURECHANGED:
00209         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(hwnd);
00210         <span class="keywordflow">return</span> 0;
00211 
00212     <span class="keywordflow">case</span> WM_NCDESTROY:
00213         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a208">NtUserKillTimer</a>(hwnd, TIMERID);
00214         
00215         prdr-&gt;pfnReaderModeProc(prdr-&gt;lParam, RDRCODE_END, 0, 0);
00216         
00217         <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00218             DeleteObject(prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a>);
00219         }
00220         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(prdr);
00221         <span class="keywordflow">return</span> 0;
00222 
00223     <span class="keywordflow">case</span> WM_CREATE:
00224         <span class="keywordflow">if</span> ((prdr = <a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(HEAP_ZERO_MEMORY, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structtagREADERINFO.html">READERINFO</a>))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00225             <span class="keywordflow">return</span> -1;
00226 
00227         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a> = (LPCREATESTRUCT)lParam;
00228         prdrm = (<a class="code" href="../../d0/d5/structtagREADERMODE.html">PREADERMODE</a>)<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;lpCreateParams;
00229         RtlCopyMemory(prdr, prdrm, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/structtagREADERMODE.html">READERMODE</a>));
00230         <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(hwnd, 0, (LONG_PTR)prdr);
00231 
00232         <span class="keywordflow">if</span> (prdr-&gt;pfnReaderModeProc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00233             <span class="keywordflow">return</span> -1;
00234         }
00235 
00236         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a3">FReader2Dim</a>(prdr)) {
00237             nBitmap = OBM_RDR2DIM;
00238         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a4">FReaderVert</a>(prdr)) {
00239             nBitmap = OBM_RDRVERT;
00240         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/reader_8c.html#a5">FReaderHorz</a>(prdr)) {
00241             nBitmap = OBM_RDRHORZ;
00242         } <span class="keywordflow">else</span> {
00243             <span class="keywordflow">return</span> -1;
00244         }
00245 
00246         SetWindowLong(hwnd, GWL_EXSTYLE, WS_EX_TOOLWINDOW);
00247         SetWindowLong(hwnd, GWL_STYLE, WS_POPUP | WS_CLIPSIBLINGS);
00248 
00249         prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a> = LoadBitmap(hmodUser, MAKEINTRESOURCE(nBitmap));
00250         <span class="keywordflow">if</span> (prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || 
00251                 GetObject(prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a>, <span class="keyword">sizeof</span>(BITMAP), &amp;bmp) == 0) {
00252             <span class="keywordflow">return</span> -1;
00253         }
00254 
00255         <span class="keywordflow">if</span> (prdr-&gt;pfnReaderModeProc(prdr-&gt;lParam, RDRCODE_START, 0, 0) == 0) {
00256             <span class="keywordflow">return</span> -1;
00257         }
00258 
00259         prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o5">dxBmp</a> = bmp.bmWidth;
00260         prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o6">dyBmp</a> = bmp.bmHeight;
00261 
00262         cx = bmp.bmWidth + 1;
00263         <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> = bmp.bmHeight + 1;
00264 
00265         <a class="code" href="../../d3/d9/client_2wow_8c.html#a25">GetCursorPos</a>(&amp;pt);
00266         pt.x -= cx/2;
00267         pt.y -= <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>/2;
00268 
00269         <span class="keywordflow">if</span> ((hrgn = CreateEllipticRgn(0, 0, cx, cy)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00270             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a22">SetWindowRgn</a>(hwnd, hrgn, FALSE);
00271         }
00272 
00273         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a115">NtUserSetWindowPos</a>(hwnd, HWND_TOPMOST, pt.x, pt.y, cx, cy,
00274                 SWP_SHOWWINDOW | SWP_NOACTIVATE);
00275 
00276         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a221">NtUserSetCapture</a>(hwnd);
00277         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a225">NtUserSetFocus</a>(hwnd);
00278         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a230">NtUserSetTimer</a>(hwnd, TIMERID, 10, NULL);
00279         <span class="keywordflow">return</span> 0;
00280 
00281     <span class="keywordflow">case</span> WM_ERASEBKGND:
00282         hdc = (HDC)wParam;
00283     
00284         <span class="keywordflow">if</span> ((hdcMem = CreateCompatibleDC(hdc)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00285             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00286 
00287         SelectObject(hdcMem, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o4">hbm</a>);
00288         hpen = CreatePen(PS_SOLID, 1, RGB(0, 0, 0));
00289         hpenOld = (HPEN)SelectObject(hdc, hpen);
00290         hbrOld = (HBRUSH)SelectObject(hdc, GetStockObject(NULL_BRUSH));
00291         
00292         BitBlt(hdc, 0, 0, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o5">dxBmp</a>, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o6">dyBmp</a>, hdcMem, 0, 0, SRCCOPY);
00293         Ellipse(hdc, 0, 0, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o5">dxBmp</a>, prdr-&gt;<a class="code" href="../../d9/d4/structtagREADERINFO.html#o6">dyBmp</a>);
00294         
00295         SelectObject(hdc, hpenOld);
00296         SelectObject(hdc, hbrOld);
00297 
00298         DeleteObject(hpen);
00299         DeleteObject(hdcMem);
00300         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00301     }
00302 
00303     <span class="keywordflow">return</span> <a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(hwnd, msg, wParam, lParam);
00304 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="reader.c::gatomReaderMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ATOM <a class="el" href="../../d8/d5/reader_8c.html#a2">gatomReaderMode</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/reader_8c-source.html#l00353">353</a> of file <a class="el" href="../../d9/d4/reader_8c-source.html">reader.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/reader_8c-source.html#l00355">EnterReaderMode()</a>, and <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l01210">SmoothScrollWindowEx()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
