<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtbatcr.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>rtbatcr.c File Reference</h1><code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>

<p>
<a href="../../d9/d9/rtbatcr_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>&nbsp;&nbsp;&nbsp;1024</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a12">main</a> (int, char *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a13">processargs</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a14">main</a> (int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a15">processargs</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a2">KeyPath</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a3">KeyName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a4">NumberChildren</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a5">NumberValues</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a6">BaseName</a> [WORK_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a7">formatbuffer</a> [WORK_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a8">format</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a9">CreateVolatile</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a> [WORK_SIZE]</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="rtbatcr.c::WORK_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORK_SIZE&nbsp;&nbsp;&nbsp;1024          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00051">51</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/rttrecpy_8c-source.html#l00114">Copy()</a>, <a class="el" href="../../d1/d0/rtdeltre_8c-source.html#l00103">Delete()</a>, <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00223">DumpValues()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, and <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00313">print()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a14" doxytag="rtbatcr.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">71</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
References <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00062">BaseName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00065">CreateVolatile</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00056">failure</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00064">format</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00063">formatbuffer</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00058">KeyPath</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00060">NumberChildren</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00061">NumberValues</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/rtbatcr_8c.html#a13">processargs()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00663">RtlAppendStringToString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00196">RtlCopyString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d6/d9/heappage_8c.html#a68">sprintf()</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00051">WORK_SIZE</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00068">workbuffer</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00067">WorkName</a>.
<p>
<pre class="fragment"><div>00075 {
00076     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00077     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00078     HANDLE          BaseHandle;
00079     HANDLE          WorkHandle;
00080     ULONG           Disposition;
00081     UNICODE_STRING  ClassName;
00082     ULONG           i;
00083     ULONG           j;
00084     PUCHAR  p;
00085     ULONG           CreateOption;
00086 
00087     <span class="comment">//</span>
00088     <span class="comment">// Process args</span>
00089     <span class="comment">//</span>
00090 
00091     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a13">processargs</a>(argc, argv);
00092 
00093 
00094     <span class="comment">//</span>
00095     <span class="comment">// Set up and create/open KeyPath|KeyName</span>
00096     <span class="comment">//</span>
00097 
00098     printf(<span class="stringliteral">"rtbatcr: starting\n"</span>);
00099 
00100     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.MaximumLength = <a class="code" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>;
00101     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Length = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00102     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Buffer = &amp;(<a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[0]);
00103 
00104     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>((PSTRING)&amp;WorkName, (PSTRING)&amp;KeyPath);
00105 
00106     p = <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Buffer;
00107     p += <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Length;
00108     *p = <span class="charliteral">'\\'</span>;
00109     p++;
00110     *p = <span class="charliteral">'\0'</span>;
00111     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Length += 2;
00112 
00113     <a class="code" href="../../d2/d7/string_8c.html#a16">RtlAppendStringToString</a>((PSTRING)&amp;WorkName, (PSTRING)&amp;KeyName);
00114 
00115     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00116         &amp;ClassName,
00117         L<span class="stringliteral">"Test Class Name"</span>
00118         );
00119 
00120     InitializeObjectAttributes(
00121         &amp;ObjectAttributes,
00122         &amp;WorkName,
00123         0,
00124         (HANDLE)NULL,
00125         NULL
00126         );
00127     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00128 
00129     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/rtbatcr_8c.html#a9">CreateVolatile</a>) {
00130         CreateOption = REG_OPTION_VOLATILE;
00131     } <span class="keywordflow">else</span> {
00132         CreateOption = 0;
00133     }
00134 
00135     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a14">NtCreateKey</a>(
00136                 &amp;BaseHandle,
00137                 MAXIMUM_ALLOWED,
00138                 &amp;ObjectAttributes,
00139                 0,
00140                 &amp;ClassName,
00141                 CreateOption,
00142                 &amp;Disposition
00143                 );
00144     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00145         printf(<span class="stringliteral">"rtbatcr: t0: %08lx\n"</span>, status);
00146         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00147         <span class="keywordflow">goto</span> punt;
00148     }
00149 
00150 
00151     <span class="comment">//</span>
00152     <span class="comment">// Create NumberChildren subkeys</span>
00153     <span class="comment">//</span>
00154 
00155     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d0/rtbatcr_8c.html#a4">NumberChildren</a>; i++) {
00156 
00157         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(formatbuffer, <span class="stringliteral">"%s%d"</span>, BaseName, i);
00158         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;format, formatbuffer);
00159         <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(&amp;WorkName, &amp;format, FALSE);
00160 
00161 
00162         InitializeObjectAttributes(
00163             &amp;ObjectAttributes,
00164             &amp;WorkName,
00165             0,
00166             BaseHandle,
00167             NULL
00168             );
00169         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00170 
00171         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a14">NtCreateKey</a>(
00172                     &amp;WorkHandle,
00173                     MAXIMUM_ALLOWED,
00174                     &amp;ObjectAttributes,
00175                     0,
00176                     &amp;ClassName,
00177                     CreateOption,
00178                     &amp;Disposition
00179                     );
00180         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00181             printf(<span class="stringliteral">"rtbatcr: t1: status = %08lx i = %d\n"</span>, status, i);
00182             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00183         }
00184 
00185         <span class="comment">//</span>
00186         <span class="comment">// Create NumberValues value entries for each (current) key</span>
00187         <span class="comment">//</span>
00188 
00189         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d8/d0/rtbatcr_8c.html#a5">NumberValues</a>; j++) {
00190 
00191             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(formatbuffer, <span class="stringliteral">"%s%d"</span>, BaseName, j);
00192             <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;format, formatbuffer);
00193             <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(&amp;WorkName, &amp;format, FALSE);
00194 
00195             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(
00196                 formatbuffer, <span class="stringliteral">"This is a rtbatcr value for %s%d"</span>, BaseName, j
00197                 );
00198 
00199             status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00200                         WorkHandle,
00201                         &amp;WorkName,
00202                         j,
00203                         j,
00204                         formatbuffer,
00205                         <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(formatbuffer)+1
00206                         );
00207             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00208                 printf(<span class="stringliteral">"rtbatcr: t2: status = %08lx j = %d\n"</span>, status, j);
00209                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00210             }
00211         }
00212         <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(WorkHandle);
00213     }
00214 
00215 punt:
00216     printf(<span class="stringliteral">"rtbatcr: %d failures\n"</span>, failure);
00217     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(failure);
00218 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="rtbatcr.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00075">75</a> of file <a class="el" href="../../d5/d1/rtmisc1_8c-source.html">rtmisc1.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00823">expectstring()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00056">failure</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00739">NameClassAndTitle()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00610">NtEnumerateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00756">NtEnumerateValueKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02018">NtQueryKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02187">NtQueryValueKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00064">TITLE_INDEX_1</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00065">TITLE_INDEX_2</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00066">TITLE_INDEX_3</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00067">TYPE_1</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00068">TYPE_2</a>, and <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>.
<p>
<pre class="fragment"><div>00076 {
00077     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00078     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00079     UNICODE_STRING  <a class="code" href="../../d8/d0/rtbatcr_8c.html#a3">KeyName</a>;
00080     UNICODE_STRING  KeyName2;
00081     UNICODE_STRING  ClassName;
00082     UNICODE_STRING  ClassName2;
00083     UNICODE_STRING  <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>;
00084     UNICODE_STRING  ValueName2;
00085     HANDLE          BaseHandle;
00086     HANDLE          Testhand1;
00087     ULONG           Disposition;
00088     LARGE_INTEGER   CompTime;
00089     ULONG           buffer[100];
00090     ULONG           bufsize = <span class="keyword">sizeof</span>(ULONG) * 100;
00091     PKEY_NODE_INFORMATION NodeInformation;
00092     PKEY_VALUE_FULL_INFORMATION KeyValueInformation;
00093     PKEY_VALUE_BASIC_INFORMATION KeyValueBasic;
00094     ULONG           ResultLength;
00095     PUCHAR          datastring = <span class="stringliteral">"Some simple ascii data for use as a value"</span>;
00096     PUCHAR          datastring2 = <span class="stringliteral">"Some more not so simple data $#"</span>;
00097     ULONG           expected;
00098     PVOID           tp;
00099 
00100 
00101     printf(<span class="stringliteral">"rtmisc1: starting\n"</span>);
00102 
00103     NodeInformation = (PKEY_NODE_INFORMATION)&amp;(buffer[0]);
00104     KeyValueInformation = (PKEY_VALUE_FULL_INFORMATION)&amp;(buffer[0]);
00105     KeyValueBasic = (PKEY_VALUE_BASIC_INFORMATION)&amp;(buffer[0]);
00106 
00107     <span class="comment">//</span>
00108     <span class="comment">// t0: Perform all operations against a base node, open it here.</span>
00109     <span class="comment">//</span>
00110 
00111     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00112         &amp;KeyName,
00113         L<span class="stringliteral">"\\REGISTRY\\MACHINE\\TEST"</span>
00114         );
00115 
00116     InitializeObjectAttributes(
00117         &amp;ObjectAttributes,
00118         &amp;KeyName,
00119         0,
00120         (HANDLE)NULL,
00121         NULL
00122         );
00123     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00124 
00125     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a23">NtOpenKey</a>(
00126                 &amp;BaseHandle,
00127                 MAXIMUM_ALLOWED,
00128                 &amp;ObjectAttributes
00129                 );
00130     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00131         printf(<span class="stringliteral">"rtmisc1: t0: %08lx\n"</span>, status);
00132         <span class="keywordflow">goto</span> punt;
00133     }
00134 
00135 
00136     <span class="comment">//</span>
00137     <span class="comment">// t1: Create a key with class and title index</span>
00138     <span class="comment">//</span>
00139 
00140     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00141         &amp;ClassName,
00142         L<span class="stringliteral">"t1 Class Name"</span>
00143         );
00144 
00145     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00146         &amp;KeyName,
00147         L<span class="stringliteral">"first_test_node"</span>
00148         );
00149 
00150     InitializeObjectAttributes(
00151         &amp;ObjectAttributes,
00152         &amp;KeyName,
00153         0,
00154         BaseHandle,
00155         NULL
00156         );
00157     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00158 
00159     NtQuerySystemTime(&amp;CompTime);
00160 
00161 <span class="comment">//  printf("ClassName@%08lx  KeyName@%08lx\n",</span>
00162 <span class="comment">//          ClassName.Buffer, KeyName.Buffer);</span>
00163 
00164     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a14">NtCreateKey</a>(
00165                 &amp;Testhand1,
00166                 MAXIMUM_ALLOWED,
00167                 &amp;ObjectAttributes,
00168                 TITLE_INDEX_1,
00169                 &amp;ClassName,
00170                 0,
00171                 &amp;Disposition
00172                 );
00173     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00174         printf(<span class="stringliteral">"rtmisc1: t1: %08lx\n"</span>, status);
00175         <span class="keywordflow">goto</span> punt;
00176     }
00177 
00178     <span class="keywordflow">if</span> (Disposition != REG_CREATED_NEW_KEY) {
00179         printf(<span class="stringliteral">"rtmisc1: t1a: got old key, expected to create new one\n"</span>);
00180         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00181     }
00182 
00183     <span class="comment">//</span>
00184     <span class="comment">// t2: See if we can get data back, and if it makes sense</span>
00185     <span class="comment">//</span>
00186 
00187     RtlZeroMemory(NodeInformation, bufsize);
00188     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a24">NtQueryKey</a>(
00189                 Testhand1,
00190                 KeyNodeInformation,
00191                 NodeInformation,
00192                 bufsize,
00193                 &amp;ResultLength
00194                 );
00195     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00196         printf(<span class="stringliteral">"rtmisc1: t2a: %08lx\n"</span>, status);
00197         <span class="keywordflow">goto</span> punt;
00198     }
00199     <span class="keywordflow">if</span> (ResultLength != 80) {
00200         printf(<span class="stringliteral">"rtmisc1: t2i: expect 80, ResultLength = %d\n"</span>, ResultLength);
00201         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00202     }
00203 
00204 
00205     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00206         NodeInformation,
00207         ClassName,
00208         TITLE_INDEX_1,
00209         KeyName,
00210         CompTime,
00211         FALSE,          <span class="comment">// time must be &gt;= CompTime</span>
00212         <span class="stringliteral">"rtmisc1: t2b: "</span>
00213         );
00214     CompTime = NodeInformation-&gt;LastWriteTime;
00215 
00216     status = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(Testhand1);
00217     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00218         printf(<span class="stringliteral">"rtmisc1: t2c: %08lx\n"</span>);
00219         <span class="keywordflow">goto</span> punt;
00220     }
00221 
00222 
00223     <span class="comment">//</span>
00224     <span class="comment">// t3: Reopen the key with create, see if data still there.</span>
00225     <span class="comment">//</span>
00226 
00227     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a14">NtCreateKey</a>(
00228                 &amp;Testhand1,
00229                 MAXIMUM_ALLOWED,
00230                 &amp;ObjectAttributes,
00231                 TITLE_INDEX_1,
00232                 &amp;ClassName,
00233                 0,
00234                 &amp;Disposition
00235                 );
00236     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00237         printf(<span class="stringliteral">"rtmisc1: t3: %08lx\n"</span>, status);
00238         <span class="keywordflow">goto</span> punt;
00239     }
00240 
00241     <span class="keywordflow">if</span> (Disposition != REG_OPENED_EXISTING_KEY) {
00242         printf(<span class="stringliteral">"rtmisc1: t3a failure\n"</span>);
00243         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00244     }
00245 
00246     RtlZeroMemory(NodeInformation, bufsize);
00247     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a24">NtQueryKey</a>(
00248                 Testhand1,
00249                 KeyNodeInformation,
00250                 NodeInformation,
00251                 bufsize,
00252                 &amp;ResultLength
00253                 );
00254     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00255         printf(<span class="stringliteral">"rtmisc1: t3b: %08lx\n"</span>, status);
00256         <span class="keywordflow">goto</span> punt;
00257     }
00258 
00259     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00260         NodeInformation,
00261         ClassName,
00262         TITLE_INDEX_1,
00263         KeyName,
00264         CompTime,
00265         FALSE,          <span class="comment">// time must be &gt;= CompTime</span>
00266         <span class="stringliteral">"rtmisc1: t3c: "</span>
00267         );
00268 
00269     status = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(Testhand1);
00270     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00271         printf(<span class="stringliteral">"rtmisc1: t3d: %08lx\n"</span>);
00272         <span class="keywordflow">goto</span> punt;
00273     }
00274 
00275 
00276     <span class="comment">//</span>
00277     <span class="comment">// t4: Reopen the key with open, see if data still there.</span>
00278     <span class="comment">//</span>
00279 
00280     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a23">NtOpenKey</a>(
00281                 &amp;Testhand1,
00282                 MAXIMUM_ALLOWED,
00283                 &amp;ObjectAttributes
00284                 );
00285     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00286         printf(<span class="stringliteral">"rtmisc1: t4: %08lx\n"</span>, status);
00287         <span class="keywordflow">goto</span> punt;
00288     }
00289 
00290     RtlZeroMemory(NodeInformation, bufsize);
00291     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a24">NtQueryKey</a>(
00292                 Testhand1,
00293                 KeyNodeInformation,
00294                 NodeInformation,
00295                 bufsize,
00296                 &amp;ResultLength
00297                 );
00298     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00299         printf(<span class="stringliteral">"rtmisc1: t4a: %08lx\n"</span>, status);
00300         <span class="keywordflow">goto</span> punt;
00301     }
00302 
00303     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00304         NodeInformation,
00305         ClassName,
00306         TITLE_INDEX_1,
00307         KeyName,
00308         CompTime,
00309         FALSE,          <span class="comment">// time must be &gt;= CompTime</span>
00310         <span class="stringliteral">"rtmisc1: t4b: "</span>
00311         );
00312 
00313 <span class="comment">//  status = NtClose(Testhand1);</span>
00314 <span class="comment">//  if (!NT_SUCCESS(status)) {</span>
00315 <span class="comment">//      printf("rtmisc1: t4c: %08lx\n");</span>
00316 <span class="comment">//      exit(1);</span>
00317 <span class="comment">//  }</span>
00318 
00319 
00320     <span class="comment">//</span>
00321     <span class="comment">// t5: Create a value</span>
00322     <span class="comment">//</span>
00323 
00324     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00325         &amp;ValueName,
00326         L<span class="stringliteral">"the very first value stored in the registry"</span>
00327         );
00328 
00329 
00330     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00331                 Testhand1,
00332                 &amp;ValueName,
00333                 TITLE_INDEX_2,
00334                 TYPE_1,
00335                 datastring,
00336                 <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(datastring)+1
00337                 );
00338     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00339         printf(<span class="stringliteral">"rtmisc1: t5: %08lx\n"</span>, status);
00340         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00341     }
00342 
00343 
00344     <span class="comment">//</span>
00345     <span class="comment">// t6: Read the value back</span>
00346     <span class="comment">//</span>
00347 
00348     RtlZeroMemory(KeyValueInformation, bufsize);
00349     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a25">NtQueryValueKey</a>(
00350                 Testhand1,
00351                 &amp;ValueName,
00352                 KeyValueFullInformation,
00353                 KeyValueInformation,
00354                 bufsize,
00355                 &amp;ResultLength
00356                 );
00357     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00358         printf(<span class="stringliteral">"rtmisc1: t6: %08lx\n"</span>, status);
00359         <span class="keywordflow">goto</span> punt;
00360     }
00361     expected = FIELD_OFFSET(KEY_VALUE_FULL_INFORMATION, Name) +
00362                     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(datastring) + 1;
00363     <span class="keywordflow">if</span> (ResultLength != expected) {
00364         printf(<span class="stringliteral">"rtmisc1: t6a: expected = %08lx actual = %08lx"</span>,
00365                 expected, ResultLength);
00366         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00367     }
00368 
00369     <span class="keywordflow">if</span> ( (KeyValueInformation-&gt;TitleIndex != <a class="code" href="../../d4/d2/rtmisc1_8c.html#a1">TITLE_INDEX_2</a>)         ||
00370          (KeyValueInformation-&gt;Type != <a class="code" href="../../d4/d2/rtmisc1_8c.html#a3">TYPE_1</a>)                      ||
00371          (KeyValueInformation-&gt;NameLength != <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length)      ||
00372          (KeyValueInformation-&gt;DataLength != <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(datastring)+1))
00373     {
00374         printf(<span class="stringliteral">"rtmisc1: t6b: wrong description data\n"</span>);
00375         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00376     }
00377 
00378 
00379     tp = (PWSTR)&amp;(KeyValueInformation-&gt;Name[0]);
00380     <span class="keywordflow">if</span> (wcsncmp(<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Buffer, tp, (<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length/<span class="keyword">sizeof</span>(WCHAR))) != 0) {
00381         printf(<span class="stringliteral">"rtmisc1: t6c: wrong name\n"</span>);
00382         <a class="code" href="../../d4/d2/rtmisc1_8c.html#a8">expectstring</a>(
00383             <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Buffer,
00384             (<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length/<span class="keyword">sizeof</span>(WCHAR)),
00385             (PWSTR)&amp;(KeyValueInformation-&gt;Name[0]),
00386             (KeyValueInformation-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR))
00387             );
00388         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00389     }
00390 
00391 
00392     tp = (PUCHAR)KeyValueInformation + KeyValueInformation-&gt;DataOffset;
00393     <span class="keywordflow">if</span> (strcmp(tp, datastring) != 0) {
00394         printf(<span class="stringliteral">"rtmisc1: t6d: wrong data\n"</span>);
00395         printf(<span class="stringliteral">"expected '%s', got '%s'\n"</span>, datastring, tp);
00396         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00397     }
00398 
00399     <span class="comment">//</span>
00400     <span class="comment">// t7: Create a second value</span>
00401     <span class="comment">//</span>
00402 
00403     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00404         &amp;ValueName2,
00405         L<span class="stringliteral">"the second value stored in the registry"</span>
00406         );
00407 
00408 
00409     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00410                 Testhand1,
00411                 &amp;ValueName2,
00412                 TITLE_INDEX_3,
00413                 TYPE_2,
00414                 datastring2,
00415                 <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(datastring2)+1
00416                 );
00417     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00418         printf(<span class="stringliteral">"rtmisc1: t7: %08lx\n"</span>, status);
00419         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00420     }
00421 
00422     <span class="comment">//</span>
00423     <span class="comment">// t8: Read the second value back (short form)</span>
00424     <span class="comment">//</span>
00425 
00426     RtlZeroMemory(KeyValueBasic, bufsize);
00427     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a25">NtQueryValueKey</a>(
00428                 Testhand1,
00429                 &amp;ValueName2,
00430                 KeyValueBasicInformation,
00431                 KeyValueBasic,
00432                 bufsize,
00433                 &amp;ResultLength
00434                 );
00435     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00436         printf(<span class="stringliteral">"rtmisc1: t8: %08lx\n"</span>, status);
00437         <span class="keywordflow">goto</span> punt;
00438     }
00439 
00440     expected = FIELD_OFFSET(KEY_VALUE_BASIC_INFORMATION, Name) +
00441                     ValueName2.Length;
00442     <span class="keywordflow">if</span> (ResultLength != expected) {
00443         printf(<span class="stringliteral">"rtmisc1: t8a: expected = %08lx actual = %08lx"</span>,
00444                 expected, ResultLength);
00445         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00446     }
00447 
00448     <span class="keywordflow">if</span> ( (KeyValueBasic-&gt;TitleIndex != <a class="code" href="../../d4/d2/rtmisc1_8c.html#a2">TITLE_INDEX_3</a>)         ||
00449          (KeyValueBasic-&gt;Type != <a class="code" href="../../d4/d2/rtmisc1_8c.html#a4">TYPE_2</a>)                      ||
00450          (KeyValueBasic-&gt;NameLength != ValueName2.Length))
00451     {
00452         printf(<span class="stringliteral">"rtmisc1: t8b: wrong description data\n"</span>);
00453         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00454     }
00455 
00456 
00457     tp = (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]);
00458     <span class="keywordflow">if</span> (wcsncmp(ValueName2.Buffer, tp, (ValueName2.Length/<span class="keyword">sizeof</span>(WCHAR))) != 0) {
00459         printf(<span class="stringliteral">"rtmisc1: t8c: wrong name\n"</span>);
00460         <a class="code" href="../../d4/d2/rtmisc1_8c.html#a8">expectstring</a>(
00461             ValueName2.Buffer,
00462             (ValueName2.Length/<span class="keyword">sizeof</span>(WCHAR)),
00463             (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]),
00464             (KeyValueBasic-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR))
00465             );
00466         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00467     }
00468 
00469 
00470     <span class="comment">//</span>
00471     <span class="comment">// t9: Enumerate the values (short form)</span>
00472     <span class="comment">//</span>
00473 
00474     RtlZeroMemory(KeyValueBasic, bufsize);
00475     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a18">NtEnumerateValueKey</a>(
00476                 Testhand1,
00477                 0,              <span class="comment">// Index</span>
00478                 KeyValueBasicInformation,
00479                 KeyValueBasic,
00480                 bufsize,
00481                 &amp;ResultLength
00482                 );
00483     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00484         printf(<span class="stringliteral">"rtmisc1: t9: %08lx\n"</span>, status);
00485         <span class="keywordflow">goto</span> punt;
00486     }
00487 
00488     expected = FIELD_OFFSET(KEY_VALUE_BASIC_INFORMATION, Name) +
00489                     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length;
00490     <span class="keywordflow">if</span> (ResultLength != expected) {
00491         printf(<span class="stringliteral">"rtmisc1: t9a: expected = %08lx actual = %08lx"</span>,
00492                 expected, ResultLength);
00493         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00494     }
00495 
00496     <span class="keywordflow">if</span> (KeyValueBasic-&gt;NameLength != <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length)
00497     {
00498         printf(<span class="stringliteral">"rtmisc1: t9b: wrong description data\n"</span>);
00499         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00500     }
00501 
00502 
00503     tp = (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]);
00504     <span class="keywordflow">if</span> (wcsncmp(<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Buffer, tp, (<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length/<span class="keyword">sizeof</span>(WCHAR))) != 0) {
00505         printf(<span class="stringliteral">"rtmisc1: t9c: wrong name\n"</span>);
00506         <a class="code" href="../../d4/d2/rtmisc1_8c.html#a8">expectstring</a>(
00507             <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Buffer,
00508             (<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length/<span class="keyword">sizeof</span>(WCHAR)),
00509             (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]),
00510             (KeyValueBasic-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR))
00511             );
00512         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00513     }
00514 
00515     RtlZeroMemory(KeyValueBasic, bufsize);
00516     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a18">NtEnumerateValueKey</a>(
00517                 Testhand1,
00518                 1,              <span class="comment">// Index</span>
00519                 KeyValueBasicInformation,
00520                 KeyValueBasic,
00521                 bufsize,
00522                 &amp;ResultLength
00523                 );
00524     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00525         printf(<span class="stringliteral">"rtmisc1: t9d: %08lx\n"</span>, status);
00526         <span class="keywordflow">goto</span> punt;
00527     }
00528 
00529     expected = FIELD_OFFSET(KEY_VALUE_BASIC_INFORMATION, Name) +
00530                     ValueName2.Length;
00531     <span class="keywordflow">if</span> (ResultLength != expected) {
00532         printf(<span class="stringliteral">"rtmisc1: t9e: expected = %08lx actual = %08lx"</span>,
00533                 expected, ResultLength);
00534         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00535     }
00536 
00537     <span class="keywordflow">if</span> (KeyValueBasic-&gt;NameLength != ValueName2.Length)
00538     {
00539         printf(<span class="stringliteral">"rtmisc1: t9f: wrong description data\n"</span>);
00540         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00541     }
00542 
00543 
00544     tp = (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]);
00545     <span class="keywordflow">if</span> (wcsncmp(ValueName2.Buffer, tp, (ValueName2.Length/<span class="keyword">sizeof</span>(WCHAR))) != 0) {
00546         printf(<span class="stringliteral">"rtmisc1: t9g: wrong name\n"</span>);
00547         <a class="code" href="../../d4/d2/rtmisc1_8c.html#a8">expectstring</a>(
00548             ValueName2.Buffer,
00549             (ValueName2.Length/<span class="keyword">sizeof</span>(WCHAR)),
00550             (PWSTR)&amp;(KeyValueBasic-&gt;Name[0]),
00551             (KeyValueBasic-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR))
00552             );
00553         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00554     }
00555 
00556     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a18">NtEnumerateValueKey</a>(
00557                 Testhand1,
00558                 2,              <span class="comment">// Index</span>
00559                 KeyValueBasicInformation,
00560                 KeyValueBasic,
00561                 bufsize,
00562                 &amp;ResultLength
00563                 );
00564     <span class="keywordflow">if</span> (status != STATUS_NO_MORE_ENTRIES) {
00565         printf(<span class="stringliteral">"rtmisc1: t9h: %08lx\n"</span>, status);
00566         <span class="keywordflow">goto</span> punt;
00567     }
00568 
00569     <span class="comment">//</span>
00570     <span class="comment">// t10: create a second subkey and ennumerate the subkeys</span>
00571     <span class="comment">//</span>
00572 
00573     status = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(Testhand1);
00574     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00575         printf(<span class="stringliteral">"rtmisc1: t10a: %08lx\n"</span>, status);
00576         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00577     }
00578 
00579     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00580         &amp;ClassName2,
00581         L<span class="stringliteral">"t2 Class Name"</span>
00582         );
00583 
00584     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00585         &amp;KeyName2,
00586         L<span class="stringliteral">"second_test_node"</span>
00587         );
00588 
00589     InitializeObjectAttributes(
00590         &amp;ObjectAttributes,
00591         &amp;KeyName2,
00592         0,
00593         BaseHandle,
00594         NULL
00595         );
00596     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00597 
00598     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a14">NtCreateKey</a>(
00599                 &amp;Testhand1,
00600                 MAXIMUM_ALLOWED,
00601                 &amp;ObjectAttributes,
00602                 TITLE_INDEX_2,
00603                 &amp;ClassName2,
00604                 0,
00605                 &amp;Disposition
00606                 );
00607     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00608         printf(<span class="stringliteral">"rtmisc1: t10b: %08lx\n"</span>, status);
00609         <span class="keywordflow">goto</span> punt;
00610     }
00611 
00612     <span class="keywordflow">if</span> (Disposition != REG_CREATED_NEW_KEY) {
00613         printf(<span class="stringliteral">"rtmisc1: t10c: got old key, expected to create new one\n"</span>);
00614         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00615     }
00616 
00617     <span class="comment">//</span>
00618     <span class="comment">// See if we can get data back, and if it makes sense</span>
00619     <span class="comment">//</span>
00620 
00621     RtlZeroMemory(NodeInformation, bufsize);
00622     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a24">NtQueryKey</a>(
00623                 Testhand1,
00624                 KeyNodeInformation,
00625                 NodeInformation,
00626                 bufsize,
00627                 &amp;ResultLength
00628                 );
00629     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00630         printf(<span class="stringliteral">"rtmisc1: t10d: %08lx\n"</span>, status);
00631         <span class="keywordflow">goto</span> punt;
00632     }
00633     CompTime = NodeInformation-&gt;LastWriteTime;
00634 
00635 
00636     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00637         NodeInformation,
00638         ClassName2,
00639         TITLE_INDEX_2,
00640         KeyName2,
00641         CompTime,
00642         TRUE,
00643         <span class="stringliteral">"rtmisc1: t10e: "</span>
00644         );
00645 
00646     status = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>(Testhand1);
00647     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00648         printf(<span class="stringliteral">"rtmisc1: t10f: %08lx\n"</span>);
00649         <span class="keywordflow">goto</span> punt;
00650     }
00651 
00652 
00653     RtlZeroMemory(NodeInformation, bufsize);
00654     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a17">NtEnumerateKey</a>(
00655                 BaseHandle,
00656                 0,
00657                 KeyNodeInformation,
00658                 NodeInformation,
00659                 bufsize,
00660                 &amp;ResultLength
00661                 );
00662     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00663         printf(<span class="stringliteral">"rtmisc1: t10g: %08lx\n"</span>, status);
00664         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00665     }
00666     CompTime = NodeInformation-&gt;LastWriteTime;
00667 
00668     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00669         NodeInformation,
00670         ClassName,
00671         TITLE_INDEX_1,
00672         KeyName,
00673         CompTime,
00674         TRUE,
00675         <span class="stringliteral">"rtmisc1: t10h: "</span>
00676         );
00677 
00678 
00679     RtlZeroMemory(NodeInformation, bufsize);
00680     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a17">NtEnumerateKey</a>(
00681                 BaseHandle,
00682                 1,
00683                 KeyNodeInformation,
00684                 NodeInformation,
00685                 bufsize,
00686                 &amp;ResultLength
00687                 );
00688     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00689         printf(<span class="stringliteral">"rtmisc1: t10i: %08lx\n"</span>, status);
00690         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00691     }
00692     CompTime = NodeInformation-&gt;LastWriteTime;
00693 
00694     <a class="code" href="../../d4/d2/rtmisc1_8c.html#a7">NameClassAndTitle</a>(
00695         NodeInformation,
00696         ClassName2,
00697         TITLE_INDEX_2,
00698         KeyName2,
00699         CompTime,
00700         TRUE,
00701         <span class="stringliteral">"rtmisc1: t10j: "</span>
00702         );
00703 
00704 
00705     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a17">NtEnumerateKey</a>(
00706                 BaseHandle,
00707                 2,
00708                 KeyNodeInformation,
00709                 NodeInformation,
00710                 bufsize,
00711                 &amp;ResultLength
00712                 );
00713     <span class="keywordflow">if</span> (status != STATUS_NO_MORE_ENTRIES) {
00714         printf(<span class="stringliteral">"rtmisc1: t10k: %08lx\n"</span>, status);
00715         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00716     }
00717 
00718     <span class="comment">//</span>
00719     <span class="comment">// Summary report</span>
00720     <span class="comment">//</span>
00721 
00722     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>) {
00723         printf(<span class="stringliteral">"rtmisc1: success"</span>);
00724         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(0);
00725     } <span class="keywordflow">else</span> {
00726         printf(<span class="stringliteral">"rtmisc1: failed, %d failures\n"</span>, failure);
00727         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00728     }
00729 
00730 punt:
00731     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00732     printf(<span class="stringliteral">"rtmisc1: failed, %d failures\n"</span>, failure);
00733     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00734 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="rtbatcr.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">222</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
References <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00062">BaseName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00065">CreateVolatile</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00058">KeyPath</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00060">NumberChildren</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00061">NumberValues</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00226 {
00227     ANSI_STRING temp;
00228 
00229     <span class="keywordflow">if</span> ( (argc &lt; 3) || (argc &gt; 7) )
00230     {
00231         printf(<span class="stringliteral">"Usage: %s [volatile] &lt;KeyPath&gt; &lt;KeyName&gt; [&lt;basename&gt; &lt;#children&gt; &lt;#values&gt;]\n"</span>,
00232                 argv[0]);
00233         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00234     }
00235 
00236     <span class="keywordflow">if</span> (_stricmp(argv[1],<span class="stringliteral">"volatile"</span>)==0) {
00237         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a9">CreateVolatile</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00238         ++argv;
00239     }
00240 
00241     <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(
00242         &amp;temp,
00243         argv[1]
00244         );
00245 
00246     <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
00247         &amp;KeyPath,
00248         &amp;temp,
00249         TRUE
00250         );
00251 
00252     <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(
00253         &amp;temp,
00254         argv[2]
00255         );
00256 
00257     <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
00258         &amp;KeyName,
00259         &amp;temp,
00260         TRUE
00261         );
00262 
00263     <span class="keywordflow">if</span> (argc &lt; 6) {
00264 
00265         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a4">NumberChildren</a> = 0;
00266         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a5">NumberValues</a> = 0;
00267 
00268     } <span class="keywordflow">else</span> {
00269 
00270         strcpy(BaseName, argv[3]);
00271         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a4">NumberChildren</a> = atoi(argv[4]);
00272         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a5">NumberValues</a> = atoi(argv[5]);
00273 
00274     }
00275     <span class="keywordflow">return</span>;
00276 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="rtbatcr.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a6" doxytag="rtbatcr.c::BaseName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a6">BaseName</a>[WORK_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00062">62</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00046">CmpOpenHiveFiles()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00954">IopLoadDumpDriver()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="rtbatcr.c::CreateVolatile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d0/rtbatcr_8c.html#a9">CreateVolatile</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00065">65</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="rtbatcr.c::failure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a1">failure</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00056">56</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00238">MmProbeAndLockPages()</a>, and <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00739">NameClassAndTitle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="rtbatcr.c::format" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a8">format</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00064">64</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l02348">AddPublicObject()</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00166">DrawTextA()</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00047">DrawTextExA()</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00131">DrawTextW()</a>, <a class="el" href="../../d5/d0/genmips_8c-source.html#l00993">dumpf()</a>, <a class="el" href="../../d9/d7/ntuser_2kernel_2clipbrd_8c-source.html#l02482">FindClipFormat()</a>, <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l02427">GiveObject()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08962">NtUserGetClipboardFormatName()</a>, and <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l02385">RemovePublicObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="rtbatcr.c::formatbuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a7">formatbuffer</a>[WORK_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00063">63</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="rtbatcr.c::KeyName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a3">KeyName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">59</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01853">CmpCacheLookup()</a>, <a class="el" href="../../d3/d2/cmtrecpy_8c-source.html#l00251">CmpCopySyncTree2()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l04234">CmpCreatePredefined()</a>, <a class="el" href="../../d8/d0/cmindex_8c-source.html#l00722">CmpDoCompareKeyName()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l00963">CmpDoOpen()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l01284">CmpFindProfileOption()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01235">CmpFlushNotify()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03764">CmpFreePostBlock()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l00076">CmpGetAcpiProfileInformation()</a>, <a class="el" href="../../d3/d2/cmtrecpy_8c-source.html#l01515">CmpInitializeKeyNameString()</a>, <a class="el" href="../../d5/d0/config_2alpha_2init_8c-source.html#l00037">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03983">CmpLinkKeyToHive()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01378">CmpNotifyChangeKey()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d7/d2/rttrecpy_8c-source.html#l00114">Copy()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00137">ExpUuidLoadSequenceNumber()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00220">ExpUuidSaveSequenceNumber()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00323">FsRtlGetCompatibilityModeValue()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l01371">FsRtlGetTunnelParameterValue()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00453">FtCreateKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00411">FtDeleteKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00357">FtOpenKey()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01844">IopApplyFunctionToSubKeys()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01156">IopCreateRegistryKeyEx()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05902">IopDeleteKeyRecursive()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05846">IopDeleteKeyRecursiveCallback()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l01454">IopGetServiceType()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00879">IopInitializeDeviceInstanceKey()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00819">IopInitializeDeviceKey()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05325">IopOpenRegistryKey()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01104">IopOpenRegistryKeyEx()</a>, <a class="el" href="../../d1/d1/pri__bld_2pnpsubs_8c-source.html#l01140">IopOpenRegistryKeyPersist()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02297">KiMoveRegTree()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>, <a class="el" href="../../d5/d1/rtmisc1_8c-source.html#l00739">NameClassAndTitle()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>, <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00425">SepAdtInitializeAuditingOptions()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00117">SepAdtInitializeBounds()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00242">SepAdtInitializeCrashOnFail()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00329">SepAdtInitializePrivilegeAuditing()</a>, and <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00153">SepAuditFailed()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="rtbatcr.c::KeyPath" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a2">KeyPath</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00058">58</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03983">CmpLinkKeyToHive()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00666">ExpGetCurrentUserUILanguage()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00486">ExpGetUILanguagePolicy()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00585">ExpSetCurrentUserUILanguage()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00137">ExpUuidLoadSequenceNumber()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00220">ExpUuidSaveSequenceNumber()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l01796">LdrQueryImageFileExecutionOptions()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00258">NtSetDefaultLocale()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>, <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>, <a class="el" href="../../d6/d4/prodtype_8c-source.html#l00030">RtlGetNtProductType()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, and <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00744">RtlQueryRegistryValues()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="rtbatcr.c::NumberChildren" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a4">NumberChildren</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00060">60</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="rtbatcr.c::NumberValues" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a5">NumberValues</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00061">61</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="rtbatcr.c::workbuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a10">workbuffer</a>[WORK_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00068">68</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="rtbatcr.c::WorkName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a9">WorkName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00067">67</a> of file <a class="el" href="../../d9/d9/rtbatcr_8c-source.html">rtbatcr.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/cminit_8c-source.html#l00046">CmpOpenHiveFiles()</a>, <a class="el" href="../../d1/d0/rtdeltre_8c-source.html#l00103">Delete()</a>, <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, and <a class="el" href="../../d0/d0/rtdelkey_8c-source.html#l00104">processargs()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:30 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
