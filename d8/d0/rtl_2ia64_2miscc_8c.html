<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtl/ia64/miscc.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>miscc.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>

<p>
<a href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a0">RtlpFlushRSE</a> (OUT PULONGLONG BackingStore, OUT PULONGLONG RNat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a1">RtlpCaptureRnats</a> (IN OUT PCONTEXT ContextRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a2">Rtlp64GetBStoreLimits</a> (OUT PULONGLONG LowBStoreLimit, OUT PULONGLONG HighBStoreLimit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a3">RtlpGetStackLimits</a> (OUT PULONG_PTR LowStackLimit, OUT PULONG_PTR HighStackLimit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a4">Rtlp64GetStackLimits</a> (OUT PULONGLONG LowStackLimit, OUT PULONGLONG HighStackLimit)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="rtl/ia64/miscc.c::Rtlp64GetBStoreLimits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Rtlp64GetBStoreLimits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>LowBStoreLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>HighBStoreLimit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html#l00075">75</a> of file <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html">rtl/ia64/miscc.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d8/ia64_2exdsptch_8c-source.html#l00985">RtlDispatchException()</a>, <a class="el" href="../../d4/d1/ia64_2getcalr_8c-source.html#l00033">RtlGetCallersAddress()</a>, and <a class="el" href="../../d8/d8/ia64_2exdsptch_8c-source.html#l00605">RtlUnwind2()</a>.
<p>
<pre class="fragment"><div>00082                    :
00083 
00084     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current backing store limits based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 
00085     current processor mode.
00086 
00087 Arguments:
00088 
00089     LowBStoreLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00090         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> backing store.
00091 
00092     HighBStoreLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00093         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> backing store.
00094 
00095 Return Value:
00096 
00097     None.
00098 
00099 --*/
00100 
00101 {
00102 <span class="preprocessor">#if defined(NTOS_KERNEL_RUNTIME)</span>
00103 <span class="preprocessor"></span>
00104     <span class="comment">//</span>
00105     <span class="comment">// Kernel Mode</span>
00106     <span class="comment">//</span>
00107 
00108     *LowBStoreLimit = (ULONGLONG)(PCR-&gt;InitialBStore);
00109     *HighBStoreLimit = (ULONGLONG)(PCR-&gt;BStoreLimit);
00110 
00111 <span class="preprocessor">#else</span>
00112 <span class="preprocessor"></span>
00113     <span class="comment">//</span>
00114     <span class="comment">// User Mode</span>
00115     <span class="comment">//</span>
00116 
00117     PTEB CurrentTeb = NtCurrentTeb();
00118 
00119     *HighBStoreLimit = (ULONGLONG)CurrentTeb-&gt;BStoreLimit;
00120     *LowBStoreLimit = (ULONGLONG)CurrentTeb-&gt;NtTib.StackBase;
00121 
00122 <span class="preprocessor">#endif // defined(NTOS_KERNEL_RUNTIME)</span>
00123 <span class="preprocessor"></span>}
    
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="rtl/ia64/miscc.c::Rtlp64GetStackLimits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Rtlp64GetStackLimits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>LowStackLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>HighStackLimit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html#l00178">178</a> of file <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html">rtl/ia64/miscc.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d8/ia64_2exdsptch_8c-source.html#l00985">RtlDispatchException()</a>, <a class="el" href="../../d4/d1/ia64_2getcalr_8c-source.html#l00033">RtlGetCallersAddress()</a>, and <a class="el" href="../../d8/d8/ia64_2exdsptch_8c-source.html#l00605">RtlUnwind2()</a>.
<p>
<pre class="fragment"><div>00185                    :
00186 
00187     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current memory stack limits based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 
00188     current processor mode.
00189 
00190 Arguments:
00191 
00192     LowStackLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00193         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory stack.
00194 
00195     HighStackLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00196         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory stack.
00197 
00198 Return Value:
00199 
00200     None.
00201 
00202 --*/
00203 
00204 {
00205 
00206 <span class="preprocessor">#if defined(NTOS_KERNEL_RUNTIME)</span>
00207 <span class="preprocessor"></span>
00208     <span class="comment">//</span>
00209     <span class="comment">// Kernel Mode</span>
00210     <span class="comment">//</span>
00211 
00212     *HighStackLimit = (ULONG_PTR)PCR-&gt;InitialStack;
00213     *LowStackLimit = (ULONG_PTR)PCR-&gt;StackLimit;
00214 
00215 <span class="preprocessor">#else</span>
00216 <span class="preprocessor"></span>
00217     <span class="comment">//</span>
00218     <span class="comment">// User Mode</span>
00219     <span class="comment">//</span>
00220 
00221     PTEB CurrentTeb = NtCurrentTeb();
00222 
00223     *HighStackLimit = (ULONGLONG)CurrentTeb-&gt;NtTib.StackBase;
00224     *LowStackLimit = (ULONGLONG)CurrentTeb-&gt;NtTib.StackLimit;
00225 
00226 <span class="preprocessor">#endif // defined(NTOS_KERNEL_RUNTIME)</span>
00227 <span class="preprocessor"></span>}
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="rtl/ia64/miscc.c::RtlpCaptureRnats" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpCaptureRnats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ContextRecord</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html#l00037">37</a> of file <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html">rtl/ia64/miscc.c</a>.
<p>
References <a class="el" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a0">RtlpFlushRSE()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/ia64_2exceptn_8c-source.html#l00230">KiDispatchException()</a>.
<p>
<pre class="fragment"><div>00043                    :
00044 
00045     This function captures Nat bits of all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> stacked registers in
00046     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> RSE frame specified in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context record.
00047 --*/
00048 {
00049     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> BsFrameSize;                  <span class="comment">// in 8-byte units</span>
00050     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> TempFrameSize;                <span class="comment">// in 8-byte units</span>
00051     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> RNatSaveIndex;
00052     ULONGLONG Rnat;
00053     ULONGLONG Bsp;
00054     ULONGLONG TopRnatAddress;
00055 
00056     <a class="code" href="../../d8/d0/rtl_2ia64_2miscc_8c.html#a0">RtlpFlushRSE</a>(&amp;Bsp, &amp;Rnat);
00057 
00058     BsFrameSize = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)ContextRecord-&gt;StIFS &amp; PFS_SIZE_MASK;
00059     RNatSaveIndex = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(ContextRecord-&gt;RsBSP &gt;&gt; 3) &amp; NAT_BITS_PER_RNAT_REG;
00060     TempFrameSize = RNatSaveIndex + BsFrameSize - NAT_BITS_PER_RNAT_REG;
00061     <span class="keywordflow">while</span> (TempFrameSize &gt;= 0) {
00062         BsFrameSize++;
00063         TempFrameSize -= NAT_BITS_PER_RNAT_REG;
00064     }
00065     TopRnatAddress = (ContextRecord-&gt;RsBSP + BsFrameSize * 8) | RNAT_ALIGNMENT;
00066     <span class="keywordflow">if</span> (TopRnatAddress &lt; Bsp) {
00067         ContextRecord-&gt;RsRNAT = *(PULONGLONG)TopRnatAddress;
00068     } <span class="keywordflow">else</span> {
00069         ContextRecord-&gt;RsRNAT = Rnat;
00070     }
00071 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="rtl/ia64/miscc.c::RtlpFlushRSE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpFlushRSE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BackingStore</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>RNat</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d5/ke_2ia64_2context_8c-source.html#l00646">KiFlushUserRseState()</a>, and <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html#l00037">RtlpCaptureRnats()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="rtl/ia64/miscc.c::RtlpGetStackLimits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpGetStackLimits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>LowStackLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>HighStackLimit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html#l00126">126</a> of file <a class="el" href="../../d9/d9/rtl_2ia64_2miscc_8c-source.html">rtl/ia64/miscc.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00162">RtlDispatchException()</a>, <a class="el" href="../../d3/d1/alpha_2getcalr_8c-source.html#l00039">RtlGetCallersAddress()</a>, <a class="el" href="../../d7/d8/i386_2exdsptch_8c-source.html#l00303">RtlUnwind()</a>, <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00883">RtlUnwind2()</a>, <a class="el" href="../../d7/d8/unwindr_8c-source.html#l00492">RtlUnwindReturn()</a>, and <a class="el" href="../../d7/d8/unwindr_8c-source.html#l00076">RtlUnwindRfp()</a>.
<p>
<pre class="fragment"><div>00133                    :
00134 
00135     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current memory stack limits based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 
00136     current processor mode.
00137 
00138 Arguments:
00139 
00140     LowStackLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00141         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory stack.
00142 
00143     HighStackLimit - Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive
00144         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory stack.
00145 
00146 Return Value:
00147 
00148     None.
00149 
00150 --*/
00151 
00152 {
00153 
00154 <span class="preprocessor">#if defined(NTOS_KERNEL_RUNTIME)</span>
00155 <span class="preprocessor"></span>
00156     <span class="comment">//</span>
00157     <span class="comment">// Kernel Mode</span>
00158     <span class="comment">//</span>
00159 
00160     *HighStackLimit = (ULONG_PTR)PCR-&gt;InitialStack;
00161     *LowStackLimit = (ULONG_PTR)PCR-&gt;StackLimit;
00162 
00163 <span class="preprocessor">#else</span>
00164 <span class="preprocessor"></span>
00165     <span class="comment">//</span>
00166     <span class="comment">// User Mode</span>
00167     <span class="comment">//</span>
00168 
00169     PTEB CurrentTeb = NtCurrentTeb();
00170 
00171     *HighStackLimit = (ULONG_PTR)CurrentTeb-&gt;NtTib.StackBase;
00172     *LowStackLimit = (ULONG_PTR)CurrentTeb-&gt;NtTib.StackLimit;
00173 
00174 <span class="preprocessor">#endif // defined(NTOS_KERNEL_RUNTIME)</span>
00175 <span class="preprocessor"></span>}

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:43 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
