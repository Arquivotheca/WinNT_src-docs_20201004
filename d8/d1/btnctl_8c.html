<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: btnctl.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>btnctl.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d9/d0/btnctl_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/structtagBTNDATA.html">tagBTNDATA</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a0">CBR_CLIENTRECT</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a1">CBR_CHECKBOX</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a3">CBR_GROUPTEXT</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a4">CBR_GROUPFRAME</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a5">CBR_PUSHBUTTON</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a6">IMAGE_BMMAX</a>&nbsp;&nbsp;&nbsp;IMAGE_CURSOR+1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a7">IsValidImage</a>(imageType, realType, max)&nbsp;&nbsp;&nbsp;((imageType &lt; max) &amp;&amp; (<a class="el" href="../../d5/d5/statctl_8c.html#a10">rgbType</a>[imageType] == realType))</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d9/structtagBTNDATA.html">tagBTNDATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a10">BTNDATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d9/structtagBTNDATA.html">tagBTNDATA</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a11">LPBTNDATA</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a13">xxxDrawButton</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc, UINT pbfPush)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a14">IsPushButton</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a15">GetAlignment</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a16">BNSetFont</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HFONT hfn, BOOL fRedraw)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBRUSH&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a17">xxxBNInitDC</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDC&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HBRUSH *lphbr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a20">xxxBNOwnerDraw</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc, UINT itemAction)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, HDC hdc, LPRECT lprc, int code, UINT pbfFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a22">BNMultiExtent</a> (WORD wFlags, HDC hdc, LPRECT lprcMax, LPWSTR lpsz, int cch, <a class="el" href="../../d9/d5/ndismain_8h.html#a264">PINT</a> pcx, <a class="el" href="../../d9/d5/ndismain_8h.html#a264">PINT</a> pcy)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a23">BNMultiDraw</a> (HDC hdc, <a class="el" href="../../d1/d9/structtagBTNDATA.html">LPBTNDATA</a> lpbd, int cch, int cx, int <a class="el" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a24">xxxBNSetCapture</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, UINT codeMouse)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT code)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, BOOL fCheck)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc, BOOL dbt, BOOL fDepress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a28">xxxButtonDrawCheck</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc, HBRUSH hbr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a29">xxxButtonDrawNewState</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc, HBRUSH hbr, UINT sOld)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a30">xxxBNPaint</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn, HDC hdc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a31">RepaintButton</a> (<a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a32">ButtonWndProcWorker</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fAnsi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a33">ButtonWndProcA</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a34">ButtonWndProcW</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a8">mpStyleCbr</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a9">rgbType</a> [IMAGE_BMMAX]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d4/struct__LOOKASIDE.html">LOOKASIDE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/btnctl_8c.html#a12">ButtonLookaside</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="btnctl.c::CBR_CHECKBOX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_CHECKBOX&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00019">19</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">xxxButtonDrawCheck()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="btnctl.c::CBR_CHECKTEXT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_CHECKTEXT&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00020">20</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="btnctl.c::CBR_CLIENTRECT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_CLIENTRECT&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00018">18</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="btnctl.c::CBR_GROUPFRAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_GROUPFRAME&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00022">22</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="btnctl.c::CBR_GROUPTEXT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_GROUPTEXT&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00021">21</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="btnctl.c::CBR_PUSHBUTTON" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBR_PUSHBUTTON&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00023">23</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="btnctl.c::IMAGE_BMMAX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IMAGE_BMMAX&nbsp;&nbsp;&nbsp;IMAGE_CURSOR+1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00040">40</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="btnctl.c::IsValidImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IsValidImage          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">imageType,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>realType,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>max&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((imageType &lt; max) &amp;&amp; (<a class="el" href="../../d5/d5/statctl_8c.html#a10">rgbType</a>[imageType] == realType))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00047">47</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d6/d4/statctl_8c-source.html#l00840">StaticWndProcWorker()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a10" doxytag="btnctl.c::BTNDATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d9/structtagBTNDATA.html">tagBTNDATA</a>  <a class="el" href="../../d1/d9/structtagBTNDATA.html">BTNDATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="btnctl.c::LPBTNDATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d9/structtagBTNDATA.html">tagBTNDATA</a> *  <a class="el" href="../../d1/d9/structtagBTNDATA.html">LPBTNDATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a21" doxytag="btnctl.c::BNCalcRect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void BNCalcRect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>pbfFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">361</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02448">BFBOTTOM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02445">BFCENTER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02446">BFHORZMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02443">BFLEFT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02444">BFRIGHT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02438">BFRIGHTBUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02447">BFTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02449">BFVCENTER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02450">BFVERTMASK</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00019">CBR_CHECKBOX</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00020">CBR_CHECKTEXT</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00022">CBR_GROUPFRAME</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00021">CBR_GROUPTEXT</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00023">CBR_PUSHBUTTON</a>, <a class="el" href="../../d4/d5/visrgn_8c-source.html#l00194">EmptyRect</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00136">GetAlignment()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00165">InflateRect()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00463">_LARGE_UNICODE_STRING::Length</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01031">OBI_CHECK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00398">PBF_DEFAULT</a>, <a class="el" href="../../d9/d9/rtl_2text_8c-source.html#l00072">PSMGetTextExtent()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00213">REBASE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00245">SetRectEmpty</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01855">tagWND::strName</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00065">szOneChar</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02319">WFWIN40COMPAT</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">xxxButtonDrawCheck()</a>.
<p>
<pre class="fragment"><div>00367 {
00368     <span class="keywordtype">int</span> cch;
00369     SIZE extent;
00370     <span class="keywordtype">int</span> dy;
00371     LPWSTR lpName;
00372     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> align;
00373 
00374     <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, lprc);
00375 
00376     align = <a class="code" href="../../d8/d1/btnctl_8c.html#a15">GetAlignment</a>(pwnd);
00377 
00378     <span class="keywordflow">switch</span> (code) {
00379     <span class="keywordflow">case</span> <a class="code" href="../../d8/d1/btnctl_8c.html#a5">CBR_PUSHBUTTON</a>:
00380         <span class="comment">// Subtract out raised edge all around</span>
00381         <a class="code" href="../../d3/d6/rect_8c.html#a7">InflateRect</a>(lprc, -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE), -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE));
00382 
00383         <span class="keywordflow">if</span> (pbfFlags &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a51">PBF_DEFAULT</a>)
00384             <a class="code" href="../../d3/d6/rect_8c.html#a7">InflateRect</a>(lprc, -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER), -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER));
00385         <span class="keywordflow">break</span>;
00386 
00387     <span class="keywordflow">case</span> <a class="code" href="../../d8/d1/btnctl_8c.html#a1">CBR_CHECKBOX</a>:
00388         <span class="keywordflow">switch</span> (align &amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFVERTMASK))
00389         {
00390         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFVCENTER):
00391                 lprc-&gt;top = (lprc-&gt;top + lprc-&gt;bottom - <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].<a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>) / 2;
00392                 <span class="keywordflow">break</span>;
00393 
00394             <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFTOP):
00395             case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a669">BFBOTTOM</a>):
00396                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1234">PSMGetTextExtent</a>(hdc, (LPWSTR)<a class="code" href="../../d1/d8/clglobal_8c.html#a14">szOneChar</a>, 1, &amp;extent);
00397                 dy = extent.cy + extent.cy/4;
00398 
00399                 <span class="comment">// Save vertical extent</span>
00400                 extent.cx = dy;
00401 
00402                 <span class="comment">// Get centered amount</span>
00403 
00404                 dy = (dy - <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].cy) / 2;
00405                 <span class="keywordflow">if</span> ((align &amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFVERTMASK)) == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFTOP))
00406                     lprc-&gt;top += dy;
00407                 <span class="keywordflow">else</span>
00408                     lprc-&gt;top = lprc-&gt;bottom - extent.cx + dy;
00409                 <span class="keywordflow">break</span>;
00410         }
00411 
00412         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFRIGHTBUTTON))
00413             lprc-&gt;left = lprc-&gt;right - <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].cx;
00414         <span class="keywordflow">else</span>
00415             lprc-&gt;right = lprc-&gt;left + <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].cx;
00416 
00417         <span class="keywordflow">break</span>;
00418 
00419     <span class="keywordflow">case</span> <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>:
00420         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFRIGHTBUTTON)) {
00421             lprc-&gt;right -= <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].cx;
00422 
00423             <span class="comment">// More spacing for 4.0 dudes</span>
00424             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT)) {
00425                 <a class="code" href="../../d8/d0/rtl_2text_8c.html#a0">PSMGetTextExtent</a>(hdc, szOneChar, 1, &amp;extent);
00426                 lprc-&gt;right -= extent.cx  / 2;
00427             }
00428         } <span class="keywordflow">else</span> {
00429             lprc-&gt;left += <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>].cx;
00430 
00431             <span class="comment">// More spacing for 4.0 dudes</span>
00432             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT)) {
00433                 <a class="code" href="../../d8/d0/rtl_2text_8c.html#a0">PSMGetTextExtent</a>(hdc, szOneChar, 1, &amp;extent);
00434                 lprc-&gt;left +=  extent.cx / 2;
00435             }
00436         }
00437         <span class="keywordflow">break</span>;
00438 
00439     <span class="keywordflow">case</span> <a class="code" href="../../d8/d1/btnctl_8c.html#a3">CBR_GROUPTEXT</a>:
00440         <span class="keywordflow">if</span> (!pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o17">strName</a>.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o0">Length</a>)
00441             <span class="keywordflow">goto</span> <a class="code" href="../../d3/d6/visrgn_8c.html#a3">EmptyRect</a>;
00442 
00443         lpName = <a class="code" href="../../d6/d0/usercli_8h.html#a26">REBASE</a>(pwnd, strName.Buffer);
00444         <span class="keywordflow">if</span> (!(cch = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o17">strName</a>.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o0">Length</a> / <span class="keyword">sizeof</span>(WCHAR))) {
00445 <a class="code" href="../../d3/d6/visrgn_8c.html#a3">EmptyRect</a>:
00446             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a35">SetRectEmpty</a>(lprc);
00447             <span class="keywordflow">break</span>;
00448         }
00449 
00450         <a class="code" href="../../d8/d0/rtl_2text_8c.html#a0">PSMGetTextExtent</a>(hdc, lpName, cch, &amp;extent);
00451         extent.cx += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE) * 2;
00452 
00453         <span class="keywordflow">switch</span> (align &amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFHORZMASK))
00454         {
00455         <span class="comment">// BFLEFT, nothing</span>
00456         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFLEFT):
00457             lprc-&gt;left += (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxSysFontChar - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER));
00458             lprc-&gt;right = lprc-&gt;left + (<span class="keywordtype">int</span>)(extent.cx);
00459             <span class="keywordflow">break</span>;
00460 
00461         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFRIGHT):
00462             lprc-&gt;right -= (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxSysFontChar - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER));
00463             lprc-&gt;left = lprc-&gt;right - (<span class="keywordtype">int</span>)(extent.cx);
00464             <span class="keywordflow">break</span>;
00465 
00466         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFCENTER):
00467             lprc-&gt;left = (lprc-&gt;left + lprc-&gt;right - (<a class="code" href="../../d3/d8/propapi_8h.html#a49">int</a>)(extent.cx)) / 2;
00468             lprc-&gt;right = lprc-&gt;left + (<span class="keywordtype">int</span>)(extent.cx);
00469             <span class="keywordflow">break</span>;
00470         }
00471 
00472         <span class="comment">// Center aligned.</span>
00473         lprc-&gt;bottom = lprc-&gt;top + extent.cy + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE);
00474         <span class="keywordflow">break</span>;
00475 
00476     <span class="keywordflow">case</span> <a class="code" href="../../d8/d1/btnctl_8c.html#a4">CBR_GROUPFRAME</a>:
00477         <a class="code" href="../../d8/d0/rtl_2text_8c.html#a0">PSMGetTextExtent</a>(hdc, (LPWSTR)szOneChar, 1, &amp;extent);
00478         lprc-&gt;top += extent.cy / 2;
00479         <span class="keywordflow">break</span>;
00480     }
00481 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="btnctl.c::BNMultiDraw" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL BNMultiDraw           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d9/structtagBTNDATA.html">LPBTNDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpbd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cy</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00534">534</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01692">DrawTextExW()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03190">tagBUTN::fPaintKbdCuesOnly</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00051">tagBTNDATA::lpsz</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00052">tagBTNDATA::pbutn</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02524">WEFPUIACCELHIDDEN</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00053">tagBTNDATA::wFlags</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.
<p>
<pre class="fragment"><div>00540 {
00541     RECT rcT;
00542     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> dtFlags = DT_WORDBREAK | DT_EDITCONTROL;
00543     <a class="code" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn = lpbd-&gt;<a class="code" href="../../d1/d9/structtagBTNDATA.html#o1">pbutn</a>;
00544 
00545     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>, WEFPUIACCELHIDDEN)) {
00546         dtFlags |= DT_HIDEPREFIX;
00547     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>){
00548         dtFlags |= DT_PREFIXONLY;
00549     }
00550 
00551     rcT.left    = 0;
00552     rcT.top     = 0;
00553     rcT.right   = cx;
00554     rcT.bottom  = <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
00555 
00556     <span class="comment">// Horizontal alignment</span>
00557     UserAssert(DT_LEFT == 0);
00558     <span class="keywordflow">switch</span> (lpbd-&gt;<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a> &amp; LOWORD(BS_HORZMASK)) {
00559         <span class="keywordflow">case</span> LOWORD(BS_CENTER):
00560             dtFlags |= DT_CENTER;
00561             <span class="keywordflow">break</span>;
00562 
00563         <span class="keywordflow">case</span> LOWORD(BS_RIGHT):
00564             dtFlags |= DT_RIGHT;
00565             <span class="keywordflow">break</span>;
00566     }
00567 
00568     <span class="comment">// Vertical alignment</span>
00569     UserAssert(DT_TOP == 0);
00570     <span class="keywordflow">switch</span> (lpbd-&gt;<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a> &amp; LOWORD(BS_VERTMASK)) {
00571         <span class="keywordflow">case</span> LOWORD(BS_VCENTER):
00572             dtFlags |= DT_VCENTER;
00573             <span class="keywordflow">break</span>;
00574 
00575         <span class="keywordflow">case</span> LOWORD(BS_BOTTOM):
00576             dtFlags |= DT_BOTTOM;
00577             <span class="keywordflow">break</span>;
00578     }
00579 
00580     <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a51">DrawTextExW</a>(hdc, lpbd-&gt;<a class="code" href="../../d1/d9/structtagBTNDATA.html#o0">lpsz</a>, cch, &amp;rcT, dtFlags, NULL);
00581     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00582 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="btnctl.c::BNMultiExtent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void BNMultiExtent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprcMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d5/ndismain_8h.html#a264">PINT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d5/ndismain_8h.html#a264">PINT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcy</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00491">491</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00243">CopyRect</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01692">DrawTextExW()</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00165">InflateRect()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">PINT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.
<p>
<pre class="fragment"><div>00499 {
00500     RECT rcT;
00501 
00502     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> dtFlags = DT_CALCRECT | DT_WORDBREAK | DT_EDITCONTROL;
00503     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a33">CopyRect</a>(&amp;rcT, lprcMax);
00504 
00505     <span class="comment">// Note that since we're just calculating the maximum dimensions,</span>
00506     <span class="comment">// left-justification and top-justification are not important.</span>
00507     <span class="comment">// Also, remember to leave margins horz and vert that follow our rules</span>
00508     <span class="comment">// in DrawBtnText().</span>
00509 
00510     <a class="code" href="../../d3/d6/rect_8c.html#a7">InflateRect</a>(&amp;rcT, -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE), -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER));
00511 
00512     <span class="keywordflow">if</span> ((wFlags &amp; LOWORD(BS_HORZMASK)) == LOWORD(BS_CENTER))
00513         dtFlags |= DT_CENTER;
00514 
00515     <span class="keywordflow">if</span> ((wFlags &amp; LOWORD(BS_VERTMASK)) == LOWORD(BS_VCENTER))
00516         dtFlags |= DT_VCENTER;
00517 
00518     <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a51">DrawTextExW</a>(hdc, lpsz, cch, &amp;rcT, dtFlags, NULL);
00519 
00520     <span class="keywordflow">if</span> (pcx)
00521         *pcx = rcT.right-rcT.left;
00522     <span class="keywordflow">if</span> (pcy)
00523         *pcy = rcT.bottom-rcT.top;
00524 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="btnctl.c::BNReleaseDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void BNReleaseDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00288">288</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00103">ghFontSys</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03188">tagBUTN::hFont</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01052">ReleaseDC()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02373">WEFRTLREADING</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01322">RepaintButton()</a>.
<p>
<pre class="fragment"><div>00291 {
00292     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00293 
00294     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd,WEFRTLREADING))
00295         SetTextAlign(hdc, GetTextAlign(hdc) &amp; ~TA_RTLREADING);
00296 
00297     <span class="keywordflow">if</span> (pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a>) {
00298         SelectObject(hdc, ghFontSys);
00299     }
00300 
00301     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hdc);
00302 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="btnctl.c::BNSetFont" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void BNSetFont           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HFONT&nbsp;</td>
          <td class="mdname" nowrap> <em>hfn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fRedraw</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00171">171</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03188">tagBUTN::hFont</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d3/d7/rtl_2winmgr_8c-source.html#l00537">IsVisible()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05330">NtUserInvalidateRect()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.
<p>
<pre class="fragment"><div>00175 {
00176     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00177 
00178     pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a> = hfn;
00179 
00180     <span class="keywordflow">if</span> (fRedraw &amp;&amp; <a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a6">IsVisible</a>(pwnd)) {
00181         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a206">NtUserInvalidateRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), NULL, TRUE);
00182     }
00183 
00184 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="btnctl.c::ButtonWndProcA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT WINAPI ButtonWndProcA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01907">1907</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00574">DefWindowProcWorker()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00793">FNID_BUTTON</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00144">FWINDOWMSG</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>.
<p>
<pre class="fragment"><div>01912 {
01913     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01914 
01915     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01916         <span class="keywordflow">return</span> (0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01917     }
01918 
01919     <span class="comment">/*</span>
01920 <span class="comment">     * If the control is not interested in this message,</span>
01921 <span class="comment">     * pass it to DefWindowProc.</span>
01922 <span class="comment">     */</span>
01923     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a10">FWINDOWMSG</a>(message, FNID_BUTTON))
01924         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message, wParam, lParam, TRUE);
01925 
01926     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a611">ButtonWndProcWorker</a>(pwnd, message, wParam, lParam, TRUE);
01927 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="btnctl.c::ButtonWndProcW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT WINAPI ButtonWndProcW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01929">1929</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00574">DefWindowProcWorker()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00793">FNID_BUTTON</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00144">FWINDOWMSG</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>, and <a class="el" href="../../d7/d7/clinit_8c-source.html#l00378">RW_RegisterControls()</a>.
<p>
<pre class="fragment"><div>01934 {
01935     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01936 
01937     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01938         <span class="keywordflow">return</span> (0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01939     }
01940 
01941     <span class="comment">/*</span>
01942 <span class="comment">     * If the control is not interested in this message,</span>
01943 <span class="comment">     * pass it to DefWindowProc.</span>
01944 <span class="comment">     */</span>
01945     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a10">FWINDOWMSG</a>(message, FNID_BUTTON))
01946         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message, wParam, lParam, FALSE);
01947 
01948     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a611">ButtonWndProcWorker</a>(pwnd, message, wParam, lParam, FALSE);
01949 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="btnctl.c::ButtonWndProcWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT APIENTRY ButtonWndProcWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fAnsi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">1338</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01171">_DefSetText()</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01738">tagCLS::atomClassName</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02441">BFIMAGEMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02455">BFNOTIFY</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02453">BFPUSHLIKE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00288">BNReleaseDC()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00171">BNSetFont()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00392">BST_CAPTURED</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00390">BST_CHECKMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00394">BST_DONTCLICK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00395">BST_INBMCLICK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00391">BST_INCLICK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00393">BST_MOUSE</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1097">BUTN</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00058">ButtonLookaside</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00021">CBR_GROUPTEXT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2kernel_2random_8c-source.html#l00102">ClearWindowState()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00404">DBT_FOCUS</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00574">DefWindowProcWorker()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00793">FNID_BUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00836">FNID_CLEANEDUP_BIT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03190">tagBUTN::fPaintKbdCuesOnly</a>, <a class="el" href="../../d2/d1/rtlinit_8c-source.html#l00344">FreeLookasideEntry()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01265">FWINABLE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03188">tagBUTN::hFont</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03189">tagBUTN::hImage</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00349">ICLS_DIALOG</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00040">IMAGE_BMMAX</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00270">INITCONTROLLOOKASIDE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02596">ISBSTEXTOROD</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00047">IsValidImage</a>, <a class="el" href="../../d3/d7/rtl_2winmgr_8c-source.html#l00537">IsVisible()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00354">NotifyWinEvent()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07752">NtUserAlterWindowStyle()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06520">NtUserBeginPaint()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06575">NtUserEndPaint()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05330">NtUserInvalidateRect()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07715">NtUserSetWindowFNID()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d0/client_2draw_8c-source.html#l00025">PaintRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00397">PBF_PUSHABLE</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1100">PBUTNWND</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00118">PtInRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00210">REBASEALWAYS</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01322">RepaintButton()</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00270">SendMessageWorker()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2kernel_2random_8c-source.html#l00083">SetWindowState()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01745">tagWND::spwndParent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02561">TestwndChild</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00362">ThreadLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00368">Unlock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00227">VALIDATECLASSANDSIZE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02372">WEFRIGHT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02401">WFTABSTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02419">WFVISIBLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02318">WFWIN31COMPAT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02319">WFWIN40COMPAT</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00258">xxxBNGetDC()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00310">xxxBNOwnerDraw()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00654">xxxBNReleaseCapture()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00590">xxxBNSetCapture()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">xxxButtonDrawCheck()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">xxxButtonDrawNewState()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00625">xxxButtonNotifyParent()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01159">xxxDrawButton()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01907">ButtonWndProcA()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01929">ButtonWndProcW()</a>, and <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>.
<p>
<pre class="fragment"><div>01344 {
01345     HWND hwnd = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd);
01346     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> bsWnd;
01347     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> wOldState;
01348     RECT rc;
01349     POINT pt;
01350     HDC hdc;
01351     HBRUSH      hbr;
01352     PAINTSTRUCT ps;
01353     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndParent;
01354     <a class="code" href="../../d2/d9/structtagBUTN.html">PBUTN</a> pbutn;
01355     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent;
01356     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fInit = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01357     LONG lResult;
01358 
01359     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
01360 
01361     bsWnd = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK);
01362 
01363     <a class="code" href="../../d6/d0/usercli_8h.html#a28">VALIDATECLASSANDSIZE</a>(pwnd, FNID_BUTTON);
01364     <a class="code" href="../../d6/d0/usercli_8h.html#a29">INITCONTROLLOOKASIDE</a>(&amp;ButtonLookaside, <a class="code" href="../../d2/d9/structtagBUTN.html">BUTN</a>, spwnd, 8);
01365 
01366     <span class="comment">/*</span>
01367 <span class="comment">     * Get the pbutn for the given window now since we will use it a lot in</span>
01368 <span class="comment">     * various handlers. This was stored using SetWindowLong(hwnd,0,pbutn) when</span>
01369 <span class="comment">     * we initially created the button control.</span>
01370 <span class="comment">     */</span>
01371     pbutn = ((<a class="code" href="../../d3/d9/structtagBUTNWND.html">PBUTNWND</a>)pwnd)-&gt;pbutn;
01372 
01373     <span class="keywordflow">switch</span> (message) {
01374     <span class="keywordflow">case</span> WM_NCHITTEST:
01375         <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX)) {
01376             <span class="keywordflow">return</span> (LONG)HTTRANSPARENT;
01377         } <span class="keywordflow">else</span> {
01378             <span class="keywordflow">goto</span> CallDWP;
01379         }
01380 
01381     <span class="keywordflow">case</span> WM_ERASEBKGND:
01382         <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW)) {
01383 
01384             <span class="comment">/*</span>
01385 <span class="comment">             * Handle erase background for owner draw buttons.</span>
01386 <span class="comment">             */</span>
01387             <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;rc);
01388             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>, &amp;tlpwndParent);
01389             pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01390             <a class="code" href="../../d6/d0/usercli_8h.html#a645">PaintRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), hwnd, (HDC)wParam, (HBRUSH)CTLCOLOR_BTN, &amp;rc);
01391             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
01392         }
01393 
01394         <span class="comment">/*</span>
01395 <span class="comment">         * Do nothing for other buttons, but don't let DefWndProc() do it</span>
01396 <span class="comment">         * either.  It will be erased in xxxBNPaint().</span>
01397 <span class="comment">         */</span>
01398         <span class="keywordflow">return</span> (LONG)<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01399 
01400     <span class="keywordflow">case</span> WM_PRINTCLIENT:
01401         <a class="code" href="../../d8/d1/btnctl_8c.html#a30">xxxBNPaint</a>(pbutn, (HDC)wParam);
01402         <span class="keywordflow">break</span>;
01403 
01404     <span class="keywordflow">case</span> WM_PAINT:
01405 
01406         <span class="comment">/*</span>
01407 <span class="comment">         * If wParam != NULL, then this is a subclassed paint.</span>
01408 <span class="comment">         */</span>
01409         <span class="keywordflow">if</span> ((hdc = (HDC)wParam) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01410             hdc = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a246">NtUserBeginPaint</a>(hwnd, &amp;ps);
01411 
01412         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a6">IsVisible</a>(pwnd))
01413             <a class="code" href="../../d8/d1/btnctl_8c.html#a30">xxxBNPaint</a>(pbutn, hdc);
01414 
01415         <span class="keywordflow">if</span> (!wParam)
01416             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a248">NtUserEndPaint</a>(hwnd, &amp;ps);
01417         <span class="keywordflow">break</span>;
01418 
01419     <span class="keywordflow">case</span> WM_SETFOCUS:
01420         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= BST_FOCUS;
01421         <span class="keywordflow">if</span> ((hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, NULL)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01422             <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc, DBT_FOCUS, FALSE);
01423 
01424             <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01425         }
01426 
01427         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFNOTIFY))
01428             <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_SETFOCUS);
01429 
01430         <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a45">BST_INCLICK</a>)) {
01431             <span class="keywordflow">switch</span> (bsWnd) {
01432             <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_RADIOBUTTON):
01433             case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTORADIOBUTTON):
01434                 if (!(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a48">BST_DONTCLICK</a>)) {
01435                     <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>)) {
01436                         <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_CLICKED);
01437                     }
01438                 }
01439                 <span class="keywordflow">break</span>;
01440             }
01441         }
01442         <span class="keywordflow">break</span>;
01443 
01444     <span class="keywordflow">case</span> WM_GETDLGCODE:
01445         <span class="keywordflow">switch</span> (bsWnd) {
01446         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_DEFPUSHBUTTON):
01447             wParam = DLGC_DEFPUSHBUTTON;
01448             <span class="keywordflow">break</span>;
01449 
01450         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_PUSHBUTTON):
01451         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_PUSHBOX):
01452             wParam = DLGC_UNDEFPUSHBUTTON;
01453             <span class="keywordflow">break</span>;
01454 
01455         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTORADIOBUTTON):
01456         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_RADIOBUTTON):
01457             wParam = DLGC_RADIOBUTTON;
01458             <span class="keywordflow">break</span>;
01459 
01460         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX):
01461             return (LONG)DLGC_STATIC;
01462 
01463         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_CHECKBOX):
01464         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTOCHECKBOX):
01465 
01466             <span class="comment">/*</span>
01467 <span class="comment">             * If this is a char that is a '=/+', or '-', we want it</span>
01468 <span class="comment">             */</span>
01469             if (lParam &amp;&amp; ((LPMSG)lParam)-&gt;message == WM_CHAR) {
01470                 <span class="keywordflow">switch</span> (wParam) {
01471                 <span class="keywordflow">case</span> TEXT(<span class="charliteral">'='</span>):
01472                 case TEXT('+'):
01473                 case TEXT('-'):
01474                     wParam = DLGC_WANTCHARS;
01475                     <span class="keywordflow">break</span>;
01476 
01477                 <span class="keywordflow">default</span>:
01478                     wParam = 0;
01479                 }
01480             } <span class="keywordflow">else</span> {
01481                 wParam = 0;
01482             }
01483             <span class="keywordflow">break</span>;
01484 
01485         <span class="keywordflow">default</span>:
01486             wParam = 0;
01487         }
01488         <span class="keywordflow">return</span> (LONG)(wParam | DLGC_BUTTON);
01489 
01490     <span class="keywordflow">case</span> WM_CAPTURECHANGED:
01491         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a>) {
01492             <span class="comment">// Unwittingly, we've been kicked out of capture,</span>
01493             <span class="comment">// so undepress etc.</span>
01494             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>)
01495                 <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETSTATE, FALSE, 0, FALSE);
01496             <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~(<a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a> | <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>);
01497         }
01498         <span class="keywordflow">break</span>;
01499 
01500     <span class="keywordflow">case</span> WM_KILLFOCUS:
01501 
01502         <span class="comment">/*</span>
01503 <span class="comment">         * If we are losing the focus and we are in "capture mode", click</span>
01504 <span class="comment">         * the button.  This allows tab and space keys to overlap for</span>
01505 <span class="comment">         * fast toggle of a series of buttons.</span>
01506 <span class="comment">         */</span>
01507         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>) {
01508 
01509             <span class="comment">/*</span>
01510 <span class="comment">             * If for some reason we are killing the focus, and we have the</span>
01511 <span class="comment">             * mouse captured, don't notify the parent we got clicked.  This</span>
01512 <span class="comment">             * breaks Omnis Quartz otherwise.</span>
01513 <span class="comment">             */</span>
01514             <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETSTATE, FALSE, 0, FALSE);
01515         }
01516 
01517         <a class="code" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a>(pbutn, TRUE);
01518 
01519         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~BST_FOCUS;
01520         <span class="keywordflow">if</span> ((hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, NULL)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01521             <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc, DBT_FOCUS, FALSE);
01522 
01523             <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01524         }
01525 
01526         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFNOTIFY))
01527             <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_KILLFOCUS);
01528 
01529         <span class="comment">/*</span>
01530 <span class="comment">         * Since the bold border around the defpushbutton is done by</span>
01531 <span class="comment">         * someone else, we need to invalidate the rect so that the</span>
01532 <span class="comment">         * focus rect is repainted properly.</span>
01533 <span class="comment">         */</span>
01534         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a206">NtUserInvalidateRect</a>(hwnd, NULL, FALSE);
01535         <span class="keywordflow">break</span>;
01536 
01537     <span class="keywordflow">case</span> WM_LBUTTONDBLCLK:
01538 
01539         <span class="comment">/*</span>
01540 <span class="comment">         * Double click messages are recognized for BS_RADIOBUTTON,</span>
01541 <span class="comment">         * BS_USERBUTTON, and BS_OWNERDRAW styles.  For all other buttons,</span>
01542 <span class="comment">         * double click is handled like a normal button down.</span>
01543 <span class="comment">         */</span>
01544         <span class="keywordflow">switch</span> (bsWnd) {
01545         <span class="keywordflow">default</span>:
01546             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFNOTIFY))
01547                 <span class="keywordflow">goto</span> btnclick;
01548 
01549         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON):
01550         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_RADIOBUTTON):
01551         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW):
01552             <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_DOUBLECLICKED);
01553             <span class="keywordflow">break</span>;
01554         }
01555         <span class="keywordflow">break</span>;
01556 
01557     <span class="keywordflow">case</span> WM_LBUTTONUP:
01558         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>) {
01559             <a class="code" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a>(pbutn, TRUE);
01560         }
01561         <span class="keywordflow">break</span>;
01562 
01563     <span class="keywordflow">case</span> WM_MOUSEMOVE:
01564         <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>)) {
01565             <span class="keywordflow">break</span>;
01566         }
01567 
01568         <span class="comment">/*</span>
01569 <span class="comment">         *** FALL THRU **</span>
01570 <span class="comment">         */</span>
01571     <span class="keywordflow">case</span> WM_LBUTTONDOWN:
01572 btnclick:
01573         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/btnctl_8c.html#a24">xxxBNSetCapture</a>(pbutn, BST_MOUSE)) {
01574             <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;rc);
01575             POINTSTOPOINT(pt, lParam);
01576             <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETSTATE, <a class="code" href="../../d3/d6/rect_8c.html#a5">PtInRect</a>(&amp;rc, pt), 0, FALSE);
01577         }
01578         <span class="keywordflow">break</span>;
01579 
01580     <span class="keywordflow">case</span> WM_CHAR:
01581         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>)
01582             <span class="keywordflow">goto</span> CallDWP;
01583 
01584         <span class="keywordflow">if</span> (bsWnd != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_CHECKBOX) &amp;&amp;
01585             bsWnd != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTOCHECKBOX))
01586             <span class="keywordflow">goto</span> CallDWP;
01587 
01588         <span class="keywordflow">switch</span> (wParam) {
01589         <span class="keywordflow">case</span> TEXT(<span class="charliteral">'+'</span>):
01590         case TEXT('='):
01591             wParam = 1;    <span class="comment">// we must Set the check mark on.</span>
01592             <span class="keywordflow">goto</span>   SetCheck;
01593 
01594         <span class="keywordflow">case</span> TEXT(<span class="charliteral">'-'</span>):
01595             wParam = 0;    <span class="comment">// Set the check mark off.</span>
01596 SetCheck:
01597             <span class="comment">// Must notify only if the check status changes</span>
01598             <span class="keywordflow">if</span> ((WORD)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>) != (WORD)wParam)
01599             {
01600                 <span class="comment">// We must check/uncheck only if it is AUTO</span>
01601                 <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTOCHECKBOX))
01602                 {
01603                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/btnctl_8c.html#a24">xxxBNSetCapture</a>(pbutn, 0))
01604                     {
01605                         <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETCHECK, wParam, 0, FALSE);
01606 
01607                         <a class="code" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a>(pbutn, TRUE);
01608                     }
01609                 }
01610 
01611                 <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_CLICKED);
01612             }
01613             <span class="keywordflow">break</span>;
01614 
01615         <span class="keywordflow">default</span>:
01616             <span class="keywordflow">goto</span> CallDWP;
01617         }
01618         <span class="keywordflow">break</span>;
01619 
01620     <span class="keywordflow">case</span> BM_CLICK:
01621         <span class="comment">// Don't recurse into this code!</span>
01622         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a49">BST_INBMCLICK</a>)
01623             <span class="keywordflow">break</span>;
01624 
01625         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= <a class="code" href="../../d6/d0/usercli_8h.html#a49">BST_INBMCLICK</a>;
01626         <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, WM_LBUTTONDOWN, 0, 0, FALSE);
01627         <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, WM_LBUTTONUP, 0, 0, FALSE);
01628         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~<a class="code" href="../../d6/d0/usercli_8h.html#a49">BST_INBMCLICK</a>;
01629 
01630         <span class="comment">/*</span>
01631 <span class="comment">         *** FALL THRU **</span>
01632 <span class="comment">         */</span>
01633 
01634     <span class="keywordflow">case</span> WM_KEYDOWN:
01635         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>)
01636             <span class="keywordflow">break</span>;
01637 
01638         <span class="keywordflow">if</span> (wParam == VK_SPACE) {
01639             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/btnctl_8c.html#a24">xxxBNSetCapture</a>(pbutn, 0)) {
01640                 <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETSTATE, TRUE, 0, FALSE);
01641             }
01642         } <span class="keywordflow">else</span> {
01643             <a class="code" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a>(pbutn, FALSE);
01644         }
01645         <span class="keywordflow">break</span>;
01646 
01647     <span class="keywordflow">case</span> WM_KEYUP:
01648     <span class="keywordflow">case</span> WM_SYSKEYUP:
01649         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>) {
01650             <span class="keywordflow">goto</span> CallDWP;
01651         }
01652 
01653         <span class="comment">/*</span>
01654 <span class="comment">         * Don't cancel the capture mode on the up of the tab in case the</span>
01655 <span class="comment">         * guy is overlapping tab and space keys.</span>
01656 <span class="comment">         */</span>
01657         <span class="keywordflow">if</span> (wParam == VK_TAB) {
01658             <span class="keywordflow">goto</span> CallDWP;
01659         }
01660 
01661         <span class="comment">/*</span>
01662 <span class="comment">         * WARNING: pwnd is history after this call!</span>
01663 <span class="comment">         */</span>
01664         <a class="code" href="../../d8/d1/btnctl_8c.html#a26">xxxBNReleaseCapture</a>(pbutn, (wParam == VK_SPACE));
01665 
01666         <span class="keywordflow">if</span> (message == WM_SYSKEYUP) {
01667             <span class="keywordflow">goto</span> CallDWP;
01668         }
01669         <span class="keywordflow">break</span>;
01670 
01671     <span class="keywordflow">case</span> BM_GETSTATE:
01672         <span class="keywordflow">return</span> (LONG)<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn);
01673 
01674     <span class="keywordflow">case</span> BM_SETSTATE:
01675         wOldState = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED);
01676         <span class="keywordflow">if</span> (wParam) {
01677             <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= BST_PUSHED;
01678         } <span class="keywordflow">else</span> {
01679             <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~BST_PUSHED;
01680         }
01681 
01682         <span class="keywordflow">if</span> ((hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, &amp;hbr)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01683             <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON)) {
01684                 <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, (UINT)(wParam ? BN_PUSHED : BN_UNPUSHED));
01685             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW)) {
01686                 <span class="keywordflow">if</span> (wOldState != (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED)) {
01687                     <span class="comment">/*</span>
01688 <span class="comment">                     * Only notify for drawing if state has changed..</span>
01689 <span class="comment">                     */</span>
01690                     <a class="code" href="../../d8/d1/btnctl_8c.html#a20">xxxBNOwnerDraw</a>(pbutn, hdc, ODA_SELECT);
01691                 }
01692             } <span class="keywordflow">else</span> {
01693                 <a class="code" href="../../d8/d1/btnctl_8c.html#a29">xxxButtonDrawNewState</a>(pbutn, hdc, hbr, wOldState);
01694             }
01695 
01696             <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01697         }
01698         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>() &amp;&amp; (wOldState != (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED))) {
01699             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_OBJECT_STATECHANGE, hwnd, OBJID_CLIENT, INDEXID_CONTAINER);
01700         }
01701         <span class="keywordflow">break</span>;
01702 
01703     <span class="keywordflow">case</span> BM_GETCHECK:
01704         <span class="keywordflow">return</span> (LONG)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>);
01705 
01706     <span class="keywordflow">case</span> BM_SETCHECK:
01707         <span class="keywordflow">switch</span> (bsWnd) {
01708         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_RADIOBUTTON):
01709         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTORADIOBUTTON):
01710             if (wParam) {
01711                     <a class="code" href="../../d4/d1/userk_8h.html#a1628">SetWindowState</a>(pwnd, WFTABSTOP);
01712             } <span class="keywordflow">else</span> {
01713                     <a class="code" href="../../d4/d1/userk_8h.html#a1629">ClearWindowState</a>(pwnd, WFTABSTOP);
01714             }
01715 
01716             <span class="comment">/*</span>
01717 <span class="comment">             *** FALL THRU **</span>
01718 <span class="comment">             */</span>
01719         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_CHECKBOX):
01720         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTOCHECKBOX):
01721             if (wParam) {
01722                 wParam = 1;
01723             }
01724             <span class="keywordflow">goto</span> CheckIt;
01725 
01726         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_3STATE):
01727         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_AUTO3STATE):
01728             if (wParam &gt; BST_INDETERMINATE) {
01729                 wParam = BST_INDETERMINATE;
01730             }
01731 CheckIt:
01732             <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>) != (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)wParam) {
01733                 <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~<a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>;
01734                 <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)wParam;
01735 
01736                 <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a6">IsVisible</a>(pwnd))
01737                     <span class="keywordflow">break</span>;
01738 
01739                 <span class="keywordflow">if</span> ((hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, &amp;hbr)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01740                     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFPUSHLIKE)) {
01741                         <a class="code" href="../../d8/d1/btnctl_8c.html#a13">xxxDrawButton</a>(pbutn, hdc, PBF_PUSHABLE);
01742                     } <span class="keywordflow">else</span> {
01743                         <a class="code" href="../../d8/d1/btnctl_8c.html#a28">xxxButtonDrawCheck</a>(pbutn, hdc, hbr);
01744                     }
01745                     <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01746                 }
01747 
01748                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>())
01749                     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_OBJECT_STATECHANGE, hwnd, OBJID_CLIENT, INDEXID_CONTAINER);
01750             }
01751             <span class="keywordflow">break</span>;
01752         }
01753         <span class="keywordflow">break</span>;
01754 
01755     <span class="keywordflow">case</span> BM_SETSTYLE:
01756         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a285">NtUserAlterWindowStyle</a>(hwnd, BS_TYPEMASK, (DWORD)wParam);
01757 
01758         <span class="keywordflow">if</span> (lParam) {
01759             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a206">NtUserInvalidateRect</a>(hwnd, NULL, TRUE);
01760         }
01761         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>()) {
01762             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_OBJECT_STATECHANGE, hwnd, OBJID_CLIENT, INDEXID_CONTAINER);
01763         }
01764         <span class="keywordflow">break</span>;
01765 
01766     <span class="keywordflow">case</span> WM_SETTEXT:
01767 
01768         <span class="comment">/*</span>
01769 <span class="comment">         * In case the new group name is longer than the old name,</span>
01770 <span class="comment">         * this paints over the old name before repainting the group</span>
01771 <span class="comment">         * box with the new name.</span>
01772 <span class="comment">         */</span>
01773         <span class="keywordflow">if</span> (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX)) {
01774             hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, &amp;hbr);
01775             <span class="keywordflow">if</span> (hdc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01776                 <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, CBR_GROUPTEXT, 0);
01777                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a206">NtUserInvalidateRect</a>(hwnd, &amp;rc, TRUE);
01778 
01779                 pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01780                 <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>, &amp;tlpwndParent);
01781                 <a class="code" href="../../d6/d0/usercli_8h.html#a645">PaintRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), hwnd, hdc, hbr, &amp;rc);
01782                 <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
01783 
01784                 <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01785             }
01786         }
01787 
01788         lResult = <a class="code" href="../../d6/d0/usercli_8h.html#a622">_DefSetText</a>(hwnd, (LPWSTR)lParam, (BOOL)fAnsi);
01789 
01790         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>()) {
01791             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_OBJECT_NAMECHANGE, hwnd, OBJID_WINDOW, INDEXID_CONTAINER);
01792         }
01793         <span class="keywordflow">goto</span> DoEnable;
01794 
01795         <span class="comment">/*</span>
01796 <span class="comment">         *** FALL THRU **</span>
01797 <span class="comment">         */</span>
01798     <span class="keywordflow">case</span> WM_ENABLE:
01799         lResult = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
01800 DoEnable:
01801         <a class="code" href="../../d8/d1/btnctl_8c.html#a31">RepaintButton</a>(pbutn);
01802         <span class="keywordflow">return</span> lResult;
01803 
01804     <span class="keywordflow">case</span> WM_SETFONT:
01805         <span class="comment">/*</span>
01806 <span class="comment">         * wParam - handle to the font</span>
01807 <span class="comment">         * lParam - if true, redraw else don't</span>
01808 <span class="comment">         */</span>
01809         <a class="code" href="../../d8/d1/btnctl_8c.html#a16">BNSetFont</a>(pbutn, (HFONT)wParam, (BOOL)(lParam != 0));
01810         <span class="keywordflow">break</span>;
01811 
01812     <span class="keywordflow">case</span> WM_GETFONT:
01813         <span class="keywordflow">return</span> (LRESULT)pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a>;
01814 
01815     <span class="keywordflow">case</span> BM_GETIMAGE:
01816     <span class="keywordflow">case</span> BM_SETIMAGE:
01817         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d1/btnctl_8c.html#a7">IsValidImage</a>(wParam, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFIMAGEMASK), IMAGE_BMMAX)) {
01818             RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"Invalid button image type"</span>);
01819         } <span class="keywordflow">else</span> {
01820             HANDLE  hOld = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>;
01821 
01822             <span class="keywordflow">if</span> (message == BM_SETIMAGE) {
01823                 pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a> = (HANDLE)lParam;
01824                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFVISIBLE)) {
01825                     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a206">NtUserInvalidateRect</a>(hwnd, NULL, TRUE);
01826                 }
01827             }
01828             <span class="keywordflow">return</span> (LRESULT)hOld;
01829         }
01830         <span class="keywordflow">break</span>;
01831 
01832     <span class="keywordflow">case</span> WM_NCDESTROY:
01833     <span class="keywordflow">case</span> WM_FINALDESTROY:
01834         <span class="keywordflow">if</span> (pbutn) {
01835             <a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>);
01836             <a class="code" href="../../d6/d0/usercli_8h.html#a408">FreeLookasideEntry</a>(&amp;ButtonLookaside, pbutn);
01837         }
01838         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a284">NtUserSetWindowFNID</a>(hwnd, FNID_CLEANEDUP_BIT);
01839         <span class="keywordflow">break</span>;
01840 
01841     <span class="keywordflow">case</span> WM_NCCREATE:
01842         <span class="comment">// Borland's OBEX has a button with style 0x98; We didn't strip</span>
01843         <span class="comment">// these bits in win3.1 because we checked for 0x08.</span>
01844         <span class="comment">// Stripping these bits cause a GP Fault in OBEX.</span>
01845         <span class="comment">// For win3.1 guys, I use the old code to strip the style bits.</span>
01846         <span class="comment">//</span>
01847         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN31COMPAT)) {
01848             <span class="keywordflow">if</span>(((!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT)) &amp;&amp;
01849                 (((<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(pwnd-&gt;style)) &amp; (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(~BS_LEFTTEXT))) == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON))) ||
01850                (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT) &amp;&amp;
01851                (bsWnd == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON))))
01852             {
01853                 <span class="comment">// BS_USERBUTTON is no longer allowed for 3.1 and beyond.</span>
01854                 <span class="comment">// Just turn to normal push button.</span>
01855                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a285">NtUserAlterWindowStyle</a>(hwnd, BS_TYPEMASK, 0);
01856                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"BS_USERBUTTON no longer supported"</span>);
01857             }
01858         }
01859         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd,WEFRIGHT)) {
01860             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a285">NtUserAlterWindowStyle</a>(hwnd, BS_RIGHT | BS_RIGHTBUTTON, BS_RIGHT | BS_RIGHTBUTTON);
01861         }
01862         <span class="keywordflow">goto</span> CallDWP;
01863 
01864     <span class="keywordflow">case</span> WM_INPUTLANGCHANGEREQUEST:
01865 
01866         <span class="comment">//</span>
01867         <span class="comment">// #115190</span>
01868         <span class="comment">// If the window is one of controls on top of dialogbox,</span>
01869         <span class="comment">// let the parent dialog handle it.</span>
01870         <span class="comment">//</span>
01871         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwnd) &amp;&amp; pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>) {
01872             <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01873             <span class="keywordflow">if</span> (pwndParent) {
01874                 <a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a> pclsParent = <a class="code" href="../../d6/d0/usercli_8h.html#a24">REBASEALWAYS</a>(pwndParent, pcls);
01875 
01876                 UserAssert(pclsParent != NULL);
01877                 <span class="keywordflow">if</span> (pclsParent-&gt;<a class="code" href="../../d7/d0/structtagCLS.html#o1">atomClassName</a> == <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a76">ICLS_DIALOG</a>]) {
01878                     RIPMSG0(RIP_VERBOSE, <span class="stringliteral">"Button: WM_INPUTLANGCHANGEREQUEST is sent to parent.\n"</span>);
01879                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwndParent, message, wParam, lParam, FALSE);
01880                 }
01881             }
01882         }
01883         <span class="keywordflow">goto</span> CallDWP;
01884 
01885     <span class="keywordflow">case</span> WM_UPDATEUISTATE:
01886         {
01887             <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message, wParam, lParam, fAnsi);
01888             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/inc_2user_8h.html#a668">ISBSTEXTOROD</a>(pwnd)) {
01889                 pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01890                 <a class="code" href="../../d8/d1/btnctl_8c.html#a31">RepaintButton</a>(pbutn);
01891                 pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01892             }
01893         }
01894         <span class="keywordflow">break</span>;
01895 
01896     <span class="keywordflow">default</span>:
01897 CallDWP:
01898         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message, wParam, lParam, fAnsi);
01899     }
01900 
01901     <span class="keywordflow">return</span> 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
01902 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="btnctl.c::GetAlignment" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WORD GetAlignment           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00136">136</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02445">BFCENTER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02446">BFHORZMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02443">BFLEFT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02449">BFVCENTER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02450">BFVERTMASK</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00071">IsPushButton()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.
<p>
<pre class="fragment"><div>00138 {
00139     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> bHorz;
00140     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> bVert;
00141 
00142     bHorz = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFHORZMASK);
00143     bVert = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFVERTMASK);
00144 
00145     <span class="keywordflow">if</span> (!bHorz || !bVert) {
00146         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/btnctl_8c.html#a14">IsPushButton</a>(pwnd)) {
00147             <span class="keywordflow">if</span> (!bHorz)
00148                 bHorz = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFCENTER);
00149         } <span class="keywordflow">else</span> {
00150             <span class="keywordflow">if</span> (!bHorz)
00151                 bHorz = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFLEFT);
00152         }
00153 
00154         <span class="keywordflow">if</span> (!bVert)
00155             bVert = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFVCENTER);
00156     }
00157 
00158     <span class="keywordflow">return</span> bHorz | bVert;
00159 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="btnctl.c::IsPushButton" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT IsPushButton           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00071">71</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02453">BFPUSHLIKE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00398">PBF_DEFAULT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00397">PBF_PUSHABLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00136">GetAlignment()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">xxxButtonDrawNewState()</a>.
<p>
<pre class="fragment"><div>00073 {
00074     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> bStyle;
00075     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> flags;
00076 
00077     bStyle = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK);
00078 
00079     flags = 0;
00080 
00081     <span class="keywordflow">switch</span> (bStyle) {
00082         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_PUSHBUTTON):
00083             flags |= <a class="code" href="../../d6/d0/usercli_8h.html#a50">PBF_PUSHABLE</a>;
00084             <span class="keywordflow">break</span>;
00085 
00086         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_DEFPUSHBUTTON):
00087             flags |= <a class="code" href="../../d6/d0/usercli_8h.html#a50">PBF_PUSHABLE</a> | <a class="code" href="../../d6/d0/usercli_8h.html#a51">PBF_DEFAULT</a>;
00088             <span class="keywordflow">break</span>;
00089 
00090         <span class="keywordflow">default</span>:
00091             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFPUSHLIKE))
00092                 flags |= <a class="code" href="../../d6/d0/usercli_8h.html#a50">PBF_PUSHABLE</a>;
00093             <span class="keywordflow">break</span>;
00094     }
00095 
00096     <span class="keywordflow">return</span>(flags);
00097 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="btnctl.c::RepaintButton" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RepaintButton           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pbutn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01322">1322</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00288">BNReleaseDC()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00258">xxxBNGetDC()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.
<p>
<pre class="fragment"><div>01323 {
01324     HDC hdc = <a class="code" href="../../d8/d1/btnctl_8c.html#a18">xxxBNGetDC</a>(pbutn, NULL);
01325     <span class="keywordflow">if</span> (hdc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01326         <a class="code" href="../../d8/d1/btnctl_8c.html#a30">xxxBNPaint</a>(pbutn, hdc);
01327         <a class="code" href="../../d8/d1/btnctl_8c.html#a19">BNReleaseDC</a>(pbutn, hdc);
01328     }
01329 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="btnctl.c::xxxBNDrawText" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxBNDrawText           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>dbt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fDepress</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">722</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02440">BFBITMAP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02448">BFBOTTOM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02446">BFHORZMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02439">BFICON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02443">BFLEFT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02454">BFMULTILINE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02444">BFRIGHT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02447">BFTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02450">BFVERTMASK</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00534">BNMultiDraw()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00491">BNMultiExtent()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00390">BST_CHECKMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00023">CBR_PUSHBUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00243">CopyRect</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00404">DBT_FOCUS</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00403">DBT_TEXT</a>, <a class="el" href="../../d4/d8/clrect_8c-source.html#l00026">DrawFocusRect()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03190">tagBUTN::fPaintKbdCuesOnly</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00136">GetAlignment()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00184">HIBYTE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03189">tagBUTN::hImage</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00165">InflateRect()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00071">IsPushButton()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00463">_LARGE_UNICODE_STRING::Length</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d8/d1/btnctl_8c.html#a11">LPBTNDATA</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00051">tagBTNDATA::lpsz</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00025">mpStyleCbr</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01669">NtUserGetIconSize()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00052">tagBTNDATA::pbutn</a>, <a class="el" href="../../d9/d9/rtl_2text_8c-source.html#l00072">PSMGetTextExtent()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00213">REBASE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01855">tagWND::strName</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00212">SYSHBR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00204">SYSRGB</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02524">WEFPUIACCELHIDDEN</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02523">WEFPUIFOCUSHIDDEN</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02418">WFDISABLED</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00053">tagBTNDATA::wFlags</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00310">xxxBNOwnerDraw()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01159">xxxDrawButton()</a>.
<p>
<pre class="fragment"><div>00727 {
00728     RECT    rc;
00729     HBRUSH  hbr;
00730     <span class="keywordtype">int</span>     x;
00731     <span class="keywordtype">int</span>     y;
00732     <span class="keywordtype">int</span>     cx;
00733     <span class="keywordtype">int</span>     <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
00734     LPWSTR   lpName;
00735     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    bStyle;
00736     <span class="keywordtype">int</span>     cch;
00737     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    dsFlags;
00738     <a class="code" href="../../d1/d9/structtagBTNDATA.html">BTNDATA</a> bdt;
00739     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    pbfPush;
00740     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>    pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00741 
00742     bStyle = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK);
00743 
00744     <span class="keywordflow">if</span> (bStyle &gt; <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d1/btnctl_8c.html#a8">mpStyleCbr</a>)) {
00745         RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"Invalid button style"</span>);
00746     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bStyle == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX)) &amp;&amp; (dbt == <a class="code" href="../../d6/d0/usercli_8h.html#a53">DBT_FOCUS</a>))
00747         <span class="keywordflow">return</span>;
00748 
00749     pbfPush = <a class="code" href="../../d8/d1/btnctl_8c.html#a14">IsPushButton</a>(pwnd);
00750     <span class="keywordflow">if</span> (pbfPush) {
00751         <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, CBR_PUSHBUTTON, pbfPush);
00752         IntersectClipRect(hdc, rc.left, rc.top, rc.right, rc.bottom);
00753 
00754         <span class="comment">//</span>
00755         <span class="comment">// This is because we were too stupid to have WM_CTLCOLOR,</span>
00756         <span class="comment">// CTLCOLOR_BTN actually set up the damned button colors.  For</span>
00757         <span class="comment">// old apps, CTLCOLOR_BTN needs to work like CTLCOLOR_STATIC.</span>
00758         <span class="comment">//</span>
00759         SetBkColor(hdc, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(3DFACE));
00760         SetTextColor(hdc, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(BTNTEXT));
00761         hbr = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a22">SYSHBR</a>(BTNTEXT);
00762     } <span class="keywordflow">else</span> {
00763         <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, mpStyleCbr[bStyle], pbfPush);
00764 
00765         <span class="comment">// Skip stuff for ownerdraw buttons, since we aren't going to</span>
00766         <span class="comment">// draw text/image.</span>
00767         <span class="keywordflow">if</span> (bStyle == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW))
00768             <span class="keywordflow">goto</span> DrawFocus;
00769         <span class="keywordflow">else</span>
00770             hbr = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a22">SYSHBR</a>(WINDOWTEXT);
00771     }
00772 
00773     <span class="comment">// Alignment</span>
00774     bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a> = <a class="code" href="../../d8/d1/btnctl_8c.html#a15">GetAlignment</a>(pwnd);
00775     bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o1">pbutn</a> = pbutn;
00776 
00777     <span class="comment">// Bail if we have nothing to draw</span>
00778     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFBITMAP)) {
00779         BITMAP bmp;
00780 
00781         <span class="comment">// Bitmap button</span>
00782         <span class="keywordflow">if</span> (!pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>)
00783             <span class="keywordflow">return</span>;
00784 
00785         GetObject(pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>, <span class="keyword">sizeof</span>(BITMAP), &amp;bmp);
00786         cx = bmp.bmWidth;
00787         <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> = bmp.bmHeight;
00788 
00789         dsFlags = DST_BITMAP;
00790         <span class="keywordflow">goto</span> UseImageForName;
00791     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFICON)) {
00792         <span class="comment">// Icon button</span>
00793         <span class="keywordflow">if</span> (!pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>)
00794             <span class="keywordflow">return</span>;
00795 
00796         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a106">NtUserGetIconSize</a>(pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>, 0, &amp;cx, &amp;cy);
00797         <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> /= 2;    <span class="comment">// The bitmap height is half because a Mask is present in NT</span>
00798 
00799         dsFlags = DST_ICON;
00800 UseImageForName:
00801         lpName = (LPWSTR)pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o3">hImage</a>;
00802         cch = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00803     } <span class="keywordflow">else</span> {
00804         <span class="comment">// Text button</span>
00805         <span class="keywordflow">if</span> (!pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o17">strName</a>.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o0">Length</a>)
00806             <span class="keywordflow">return</span>;
00807 
00808         lpName = <a class="code" href="../../d6/d0/usercli_8h.html#a26">REBASE</a>(pwnd, strName.Buffer);
00809         cch    = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o17">strName</a>.<a class="code" href="../../d2/d9/struct__LARGE__UNICODE__STRING.html#o0">Length</a> / <span class="keyword">sizeof</span>(WCHAR);
00810 
00811         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFMULTILINE)) {
00812 
00813             bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o0">lpsz</a> = lpName;
00814 
00815             <a class="code" href="../../d8/d1/btnctl_8c.html#a22">BNMultiExtent</a>(bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a>, hdc, &amp;rc, lpName, cch, &amp;cx, &amp;cy);
00816 
00817             lpName = (LPWSTR)(<a class="code" href="../../d1/d9/structtagBTNDATA.html">LPBTNDATA</a>)&amp;bdt;
00818             dsFlags = DST_COMPLEX;
00819 
00820         } <span class="keywordflow">else</span> {
00821             SIZE size;
00822 
00823             <a class="code" href="../../d8/d0/rtl_2text_8c.html#a0">PSMGetTextExtent</a>(hdc, lpName, cch, &amp;size);
00824             cx = size.cx;
00825             <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> = size.cy;
00826             <span class="comment">/*</span>
00827 <span class="comment">             * If the control doesn't need underlines, set DST_HIDEPREFIX and</span>
00828 <span class="comment">             * also do not show the focus indicator</span>
00829 <span class="comment">             */</span>
00830             dsFlags = DST_PREFIXTEXT;
00831             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WEFPUIACCELHIDDEN)) {
00832                 dsFlags |= DSS_HIDEPREFIX;
00833             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>) {
00834                 dsFlags |= DSS_PREFIXONLY;
00835             }
00836         }
00837 
00838 
00839         <span class="comment">//</span>
00840         <span class="comment">// Add on a pixel or two of vertical space to make centering</span>
00841         <span class="comment">// happier.  That way underline won't abut focus rect unless</span>
00842         <span class="comment">// spacing is really tight.</span>
00843         <span class="comment">//</span>
00844         <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>++;
00845     }
00846 
00847     <span class="comment">//</span>
00848     <span class="comment">// ALIGNMENT</span>
00849     <span class="comment">//</span>
00850 
00851     <span class="comment">// Horizontal</span>
00852     <span class="keywordflow">switch</span> (bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a> &amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFHORZMASK)) {
00853         <span class="comment">//</span>
00854         <span class="comment">// For left &amp; right justified, we leave a margin of CXEDGE on either</span>
00855         <span class="comment">// side for eye-pleasing space.</span>
00856         <span class="comment">//</span>
00857         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFLEFT):
00858             x = rc.left + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE);
00859             <span class="keywordflow">break</span>;
00860 
00861         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFRIGHT):
00862             x = rc.right - cx - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE);
00863             <span class="keywordflow">break</span>;
00864 
00865         <span class="keywordflow">default</span>:
00866             x = (rc.left + rc.right - cx) / 2;
00867             <span class="keywordflow">break</span>;
00868     }
00869 
00870     <span class="comment">// Vertical</span>
00871     <span class="keywordflow">switch</span> (bdt.<a class="code" href="../../d1/d9/structtagBTNDATA.html#o2">wFlags</a> &amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFVERTMASK)) {
00872         <span class="comment">//</span>
00873         <span class="comment">// For top &amp; bottom justified, we leave a margin of CYBORDER on</span>
00874         <span class="comment">// either side for more eye-pleasing space.</span>
00875         <span class="comment">//</span>
00876         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFTOP):
00877             y = rc.top + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
00878             <span class="keywordflow">break</span>;
00879 
00880         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BFBOTTOM):
00881             y = rc.bottom - <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
00882             <span class="keywordflow">break</span>;
00883 
00884         <span class="keywordflow">default</span>:
00885             y = (rc.top + rc.bottom - <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>) / 2;
00886             <span class="keywordflow">break</span>;
00887     }
00888 
00889     <span class="comment">//</span>
00890     <span class="comment">// Draw the text</span>
00891     <span class="comment">//</span>
00892     <span class="keywordflow">if</span> (dbt &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a52">DBT_TEXT</a>) {
00893         <span class="comment">//</span>
00894         <span class="comment">// This isn't called for USER buttons.</span>
00895         <span class="comment">//</span>
00896         UserAssert(bStyle != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON));
00897 
00898         <span class="keywordflow">if</span> (fDepress) {
00899             x += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER);
00900             y += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
00901         }
00902 
00903         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDISABLED)) {
00904             UserAssert(<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(BFICON) == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(BFBITMAP));
00905             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(SLOWMACHINE)  &amp;&amp;
00906                 !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFICON | BFBITMAP) &amp;&amp;
00907                 (GetBkColor(hdc) != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(GRAYTEXT)))
00908             {
00909                 <span class="comment">// Perf &amp;&amp; consistency with menus, statics</span>
00910                 SetTextColor(hdc, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(GRAYTEXT));
00911             }
00912             <span class="keywordflow">else</span>
00913                 dsFlags |= DSS_DISABLED;
00914         }
00915 
00916         <span class="comment">//</span>
00917         <span class="comment">// Use transparent mode for checked push buttons since we're going to</span>
00918         <span class="comment">// fill background with dither.</span>
00919         <span class="comment">//</span>
00920         <span class="keywordflow">if</span> (pbfPush) {
00921             <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>) {
00922                 <span class="keywordflow">case</span> BST_INDETERMINATE:
00923                     hbr = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a22">SYSHBR</a>(GRAYTEXT);
00924                     dsFlags |= DSS_MONO;
00925                     <span class="comment">// FALL THRU</span>
00926 
00927                 <span class="keywordflow">case</span> BST_CHECKED:
00928                     <span class="comment">// Drawing on dithered background...</span>
00929                     SetBkMode(hdc, TRANSPARENT);
00930                     <span class="keywordflow">break</span>;
00931             }
00932         }
00933 
00934         <span class="comment">//</span>
00935         <span class="comment">// Use brush and colors currently selected into hdc when we grabbed</span>
00936         <span class="comment">// color</span>
00937         <span class="comment">//</span>
00938         DrawState(hdc, hbr, (DRAWSTATEPROC)BNMultiDraw, (LPARAM)lpName,
00939             (WPARAM)cch, x, y, cx, cy,
00940             dsFlags);
00941     }
00942 
00943     <span class="comment">// Draw focus rect.</span>
00944     <span class="comment">//</span>
00945     <span class="comment">// This can get called for OWNERDRAW and USERDRAW buttons. However, only</span>
00946     <span class="comment">// OWNERDRAW buttons let the owner change the drawing of the focus button.</span>
00947 DrawFocus:
00948     <span class="keywordflow">if</span> (dbt &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a53">DBT_FOCUS</a>) {
00949         <span class="keywordflow">if</span> (bStyle == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW)) {
00950             <span class="comment">// For ownerdraw buttons, this is only called in response to a</span>
00951             <span class="comment">// WM_SETFOCUS or WM_KILL FOCUS message.  So, we can check the</span>
00952             <span class="comment">// new state of the focus by looking at the BUTTONSTATE bits</span>
00953             <span class="comment">// which are set before this procedure is called.</span>
00954             <a class="code" href="../../d8/d1/btnctl_8c.html#a20">xxxBNOwnerDraw</a>(pbutn, hdc, ODA_FOCUS);
00955         } <span class="keywordflow">else</span> {
00956             <span class="comment">// Don't draw the focus if underlines are not turned on</span>
00957             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WEFPUIFOCUSHIDDEN)) {
00958 
00959                 <span class="comment">// Let focus rect always hug edge of push buttons.  We already</span>
00960                 <span class="comment">// have the client area setup for push buttons, so we don't have</span>
00961                 <span class="comment">// to do anything.</span>
00962                 <span class="keywordflow">if</span> (!pbfPush) {
00963 
00964                     RECT rcClient;
00965 
00966                     <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;rcClient);
00967                     <span class="keywordflow">if</span> (bStyle == <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON))
00968                         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a33">CopyRect</a>(&amp;rc, &amp;rcClient);
00969                     <span class="keywordflow">else</span> {
00970                         <span class="comment">// Try to leave a border all around text.  That causes</span>
00971                         <span class="comment">// focus to hug text.</span>
00972                         rc.top = <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(rcClient.top, y-<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER));
00973                         rc.bottom = <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(rcClient.bottom, rc.top + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE) + cy);
00974 
00975                         rc.left = <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(rcClient.left, x-<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER));
00976                         rc.right = <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(rcClient.right, rc.left + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE) + cx);
00977                     }
00978                 } <span class="keywordflow">else</span>
00979                     <a class="code" href="../../d3/d6/rect_8c.html#a7">InflateRect</a>(&amp;rc, -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER), -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER));
00980 
00981                 <span class="comment">// Are back &amp; fore colors set properly?</span>
00982                 <a class="code" href="../../d3/d9/clrect_8c.html#a0">DrawFocusRect</a>(hdc, &amp;rc);
00983             }
00984         }
00985     }
00986 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="btnctl.c::xxxBNGetDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDC xxxBNGetDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HBRUSH *&nbsp;</td>
          <td class="mdname" nowrap> <em>lphbr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00258">258</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d3/d7/rtl_2winmgr_8c-source.html#l00537">IsVisible()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06624">NtUserGetDC()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00193">xxxBNInitDC()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01322">RepaintButton()</a>.
<p>
<pre class="fragment"><div>00261 {
00262     HDC hdc;
00263     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00264 
00265     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00266 
00267     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a6">IsVisible</a>(pwnd)) {
00268         HBRUSH  hbr;
00269 
00270         hdc = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a250">NtUserGetDC</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd));
00271         hbr = <a class="code" href="../../d8/d1/btnctl_8c.html#a17">xxxBNInitDC</a>(pbutn, hdc);
00272 
00273         <span class="keywordflow">if</span> (lphbr!=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00274             *lphbr = hbr;
00275 
00276         <span class="keywordflow">return</span> hdc;
00277     }
00278 
00279     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00280 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="btnctl.c::xxxBNInitDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBRUSH xxxBNInitDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00193">193</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02453">BFPUSHLIKE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01581">GetControlBrush</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03188">tagBUTN::hFont</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01839">tagWND::rcClient</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02373">WEFRTLREADING</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02319">WFWIN40COMPAT</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00258">xxxBNGetDC()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.
<p>
<pre class="fragment"><div>00196 {
00197     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    wColor;
00198     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    bStyle;
00199     HBRUSH  hbr;
00200     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00201 
00202     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00203 
00204     <span class="comment">/*</span>
00205 <span class="comment">     * Set BkMode before getting brush so that the app can change it to</span>
00206 <span class="comment">     * transparent if it wants.</span>
00207 <span class="comment">     */</span>
00208     SetBkMode(hdc, OPAQUE);
00209 
00210     bStyle = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK);
00211 
00212     <span class="keywordflow">switch</span> (bStyle) {
00213         <span class="keywordflow">default</span>:
00214             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT) &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFPUSHLIKE)) {
00215                 wColor = WM_CTLCOLORSTATIC;
00216                 <span class="keywordflow">break</span>;
00217             }
00218 
00219         <span class="keywordflow">case</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_PUSHBUTTON):
00220         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_DEFPUSHBUTTON):
00221         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW):
00222         case <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_USERBUTTON):
00223             wColor = WM_CTLCOLORBTN;
00224             <span class="keywordflow">break</span>;
00225     }
00226 
00227     hbr = <a class="code" href="../../d6/d0/usercli_8h.html#a235">GetControlBrush</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hdc, wColor);
00228 
00229     <span class="comment">/*</span>
00230 <span class="comment">     * Select in the user's font if set, and save the old font so that we can</span>
00231 <span class="comment">     * restore it when we release the dc.</span>
00232 <span class="comment">     */</span>
00233     <span class="keywordflow">if</span> (pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a>) {
00234         SelectObject(hdc, pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a>);
00235     }
00236 
00237     <span class="comment">/*</span>
00238 <span class="comment">     * Clip output to the window rect if needed.</span>
00239 <span class="comment">     */</span>
00240     <span class="keywordflow">if</span> (bStyle != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX)) {
00241         IntersectClipRect(hdc, 0, 0,
00242             pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.right - pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.left,
00243             pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.bottom - pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>.top);
00244     }
00245 
00246     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd,WEFRTLREADING))
00247         SetTextAlign(hdc, TA_RTLREADING | GetTextAlign(hdc));
00248 
00249     <span class="keywordflow">return</span>(hbr);
00250 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="btnctl.c::xxxBNOwnerDraw" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxBNOwnerDraw           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>itemAction</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00310">310</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01764">tagWND::spmenu</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00362">ThreadLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02524">WEFPUIACCELHIDDEN</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02523">WEFPUIFOCUSHIDDEN</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02418">WFDISABLED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.
<p>
<pre class="fragment"><div>00314 {
00315     DRAWITEMSTRUCT drawItemStruct;
00316     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndParent;
00317     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00318     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> itemState = 0;
00319 
00320     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WEFPUIFOCUSHIDDEN)) {
00321         itemState |= ODS_NOFOCUSRECT;
00322     }
00323     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WEFPUIACCELHIDDEN)) {
00324         itemState |= ODS_NOACCEL;
00325     }
00326     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_FOCUS) {
00327         itemState |= ODS_FOCUS;
00328     }
00329     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED) {
00330         itemState |= ODS_SELECTED;
00331     }
00332 
00333     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDISABLED))
00334         itemState |= ODS_DISABLED;
00335 
00336     drawItemStruct.CtlType = ODT_BUTTON;
00337     drawItemStruct.CtlID = PtrToUlong(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>);
00338     drawItemStruct.itemAction = itemAction;
00339     drawItemStruct.itemState = itemState;
00340     drawItemStruct.hwndItem = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd);
00341     drawItemStruct.hDC = hdc;
00342     <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;drawItemStruct.rcItem);
00343     drawItemStruct.itemData = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00344 
00345     <span class="comment">/*</span>
00346 <span class="comment">     * Send a WM_DRAWITEM message to the parent</span>
00347 <span class="comment">     * IanJa:  in this case pMenu is being used as the control ID</span>
00348 <span class="comment">     */</span>
00349     <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent), &amp;tlpwndParent);
00350     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent)), WM_DRAWITEM, (WPARAM)pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>,
00351             (LPARAM)&amp;drawItemStruct);
00352     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
00353 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="btnctl.c::xxxBNPaint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxBNPaint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">1206</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02456">BFFLAT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00022">CBR_GROUPFRAME</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00021">CBR_GROUPTEXT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00404">DBT_FOCUS</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00403">DBT_TEXT</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l00896">DrawEdge()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03190">tagBUTN::fPaintKbdCuesOnly</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00103">ghFontSys</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03188">tagBUTN::hFont</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00071">IsPushButton()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d8/d0/client_2draw_8c-source.html#l00025">PaintRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01745">tagWND::spwndParent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00362">ThreadLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02418">WFDISABLED</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00193">xxxBNInitDC()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00310">xxxBNOwnerDraw()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">xxxButtonDrawCheck()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">xxxButtonDrawNewState()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00625">xxxButtonNotifyParent()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01159">xxxDrawButton()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01322">RepaintButton()</a>.
<p>
<pre class="fragment"><div>01209 {
01210     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> bsWnd;
01211     RECT rc;
01212     HBRUSH  hbr;
01213     HBRUSH hbrBtnSave;
01214     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndParent;
01215     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> pbfPush;
01216     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
01217     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent;
01218 
01219     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
01220 
01221     hbr = <a class="code" href="../../d8/d1/btnctl_8c.html#a17">xxxBNInitDC</a>(pbutn, hdc);
01222 
01223     bsWnd = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK);
01224     pbfPush = <a class="code" href="../../d8/d1/btnctl_8c.html#a14">IsPushButton</a>(pwnd);
01225     <span class="keywordflow">if</span> (!pbfPush &amp;&amp; !pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>) {
01226         <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;rc);
01227 
01228         <span class="keywordflow">if</span> ((bsWnd != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_OWNERDRAW)) &amp;&amp;
01229             (bsWnd != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(BS_GROUPBOX))) {
01230              <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>, &amp;tlpwndParent);
01231              pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01232              <a class="code" href="../../d6/d0/usercli_8h.html#a645">PaintRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hdc, hbr, &amp;rc);
01233              <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
01234         }
01235 
01236         hbrBtnSave = SelectObject(hdc, hbr);
01237     }
01238 
01239     <span class="keywordflow">switch</span> (bsWnd) {
01240     <span class="keywordflow">case</span> BS_CHECKBOX:
01241     <span class="keywordflow">case</span> BS_RADIOBUTTON:
01242     <span class="keywordflow">case</span> BS_AUTORADIOBUTTON:
01243     <span class="keywordflow">case</span> BS_3STATE:
01244     <span class="keywordflow">case</span> BS_AUTOCHECKBOX:
01245     <span class="keywordflow">case</span> BS_AUTO3STATE:
01246         <span class="keywordflow">if</span> (!pbfPush) {
01247             <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc,
01248                 DBT_TEXT | (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_FOCUS ? DBT_FOCUS : 0), FALSE);
01249             <span class="keywordflow">if</span> (!pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>) {
01250                 <a class="code" href="../../d8/d1/btnctl_8c.html#a28">xxxButtonDrawCheck</a>(pbutn, hdc, hbr);
01251             }
01252             <span class="keywordflow">break</span>;
01253         }
01254         <span class="comment">/*</span>
01255 <span class="comment">         * Fall through for PUSHLIKE buttons</span>
01256 <span class="comment">         */</span>
01257 
01258     <span class="keywordflow">case</span> BS_PUSHBUTTON:
01259     <span class="keywordflow">case</span> BS_DEFPUSHBUTTON:
01260         <a class="code" href="../../d8/d1/btnctl_8c.html#a13">xxxDrawButton</a>(pbutn, hdc, pbfPush);
01261         <span class="keywordflow">break</span>;
01262 
01263     <span class="keywordflow">case</span> BS_PUSHBOX:
01264         <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc,
01265             DBT_TEXT | (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_FOCUS ? DBT_FOCUS : 0), FALSE);
01266 
01267         <a class="code" href="../../d8/d1/btnctl_8c.html#a29">xxxButtonDrawNewState</a>(pbutn, hdc, hbr, 0);
01268         <span class="keywordflow">break</span>;
01269 
01270     <span class="keywordflow">case</span> BS_USERBUTTON:
01271         <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_PAINT);
01272 
01273         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED) {
01274             <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_PUSHED);
01275         }
01276         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDISABLED)) {
01277             <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_DISABLE);
01278         }
01279         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_FOCUS) {
01280             <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc, DBT_FOCUS, FALSE);
01281         }
01282         <span class="keywordflow">break</span>;
01283 
01284     <span class="keywordflow">case</span> BS_OWNERDRAW:
01285         <a class="code" href="../../d8/d1/btnctl_8c.html#a20">xxxBNOwnerDraw</a>(pbutn, hdc, ODA_DRAWENTIRE);
01286         <span class="keywordflow">break</span>;
01287 
01288     <span class="keywordflow">case</span> BS_GROUPBOX:
01289         <span class="keywordflow">if</span> (!pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>) {
01290             <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, CBR_GROUPFRAME, 0);
01291             <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a15">DrawEdge</a>(hdc, &amp;rc, EDGE_ETCHED, BF_RECT |
01292                 (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFFLAT) ? BF_FLAT | BF_MONO : 0));
01293 
01294             <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, CBR_GROUPTEXT, 0);
01295             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>, &amp;tlpwndParent);
01296             pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01297             <a class="code" href="../../d6/d0/usercli_8h.html#a645">PaintRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hdc, hbr, &amp;rc);
01298             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
01299         }
01300 
01301         <span class="comment">/*</span>
01302 <span class="comment">         * FillRect(hdc, &amp;rc, hbrBtn);</span>
01303 <span class="comment">         */</span>
01304         <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc, DBT_TEXT, FALSE);
01305         <span class="keywordflow">break</span>;
01306     }
01307 
01308     <span class="keywordflow">if</span> (!pbfPush)
01309         SelectObject(hdc, hbrBtnSave);
01310 
01311     <span class="comment">/*</span>
01312 <span class="comment">     * Release the font which may have been loaded by xxxButtonInitDC.</span>
01313 <span class="comment">     */</span>
01314     <span class="keywordflow">if</span> (pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o2">hFont</a>) {
01315         SelectObject(hdc, ghFontSys);
01316     }
01317 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="btnctl.c::xxxBNReleaseCapture" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxBNReleaseCapture           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fCheck</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00654">654</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/dlgmgrc_8c-source.html#l00439">_GetNextDlgGroupItem()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00392">BST_CAPTURED</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00390">BST_CHECKMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00393">BST_MOUSE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01570">NtUserReleaseCapture</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00270">SendMessageWorker()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00362">ThreadLock</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00625">xxxButtonNotifyParent()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.
<p>
<pre class="fragment"><div>00657 {
00658     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndT;
00659     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> check;
00660     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fNotifyParent = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00661     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndT;
00662     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00663 
00664     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00665 
00666     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED) {
00667         <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETSTATE, FALSE, 0, FALSE);
00668         <span class="keywordflow">if</span> (fCheck) {
00669             <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK)) {
00670             <span class="keywordflow">case</span> BS_AUTOCHECKBOX:
00671             <span class="keywordflow">case</span> BS_AUTO3STATE:
00672                 check = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)((<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>) + 1);
00673 
00674                 <span class="keywordflow">if</span> (check &gt; (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK) == BS_AUTO3STATE? BST_INDETERMINATE : BST_CHECKED)) {
00675                     check = BST_UNCHECKED;
00676                 }
00677                 <a class="code" href="../../d6/d0/usercli_8h.html#a600">SendMessageWorker</a>(pwnd, BM_SETCHECK, check, 0, FALSE);
00678                 <span class="keywordflow">break</span>;
00679 
00680             <span class="keywordflow">case</span> BS_AUTORADIOBUTTON:
00681                 pwndT = pwnd;
00682                 <span class="keywordflow">do</span> {
00683                     <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT, &amp;tlpwndT);
00684 
00685                     <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT), WM_GETDLGCODE, 0, 0L) &amp;
00686                             DLGC_RADIOBUTTON) {
00687                         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT), BM_SETCHECK, (pwnd == pwndT), 0L);
00688                     }
00689                     pwndT = <a class="code" href="../../d6/d0/usercli_8h.html#a641">_GetNextDlgGroupItem</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwndT, spwndParent),
00690                             pwndT, FALSE);
00691                     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT);
00692 
00693                 } <span class="keywordflow">while</span> (pwndT != pwnd);
00694             }
00695 
00696             fNotifyParent = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00697         }
00698     }
00699 
00700     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a>) {
00701         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~(<a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a> | <a class="code" href="../../d6/d0/usercli_8h.html#a47">BST_MOUSE</a>);
00702         <a class="code" href="../../d6/d0/usercli_8h.html#a225">NtUserReleaseCapture</a>();
00703     }
00704 
00705     <span class="keywordflow">if</span> (fNotifyParent) {
00706 
00707         <span class="comment">/*</span>
00708 <span class="comment">         * We have to do the notification after setting the buttonstate bits.</span>
00709 <span class="comment">         */</span>
00710         <a class="code" href="../../d8/d1/btnctl_8c.html#a25">xxxButtonNotifyParent</a>(pwnd, BN_CLICKED);
00711     }
00712 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="btnctl.c::xxxBNSetCapture" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxBNSetCapture           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>codeMouse</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00590">590</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00392">BST_CAPTURED</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00391">BST_INCLICK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05822">NtUserSetCapture()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05902">NtUserSetFocus()</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.
<p>
<pre class="fragment"><div>00593 {
00594     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
00595 
00596     <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= codeMouse;
00597 
00598     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00599 
00600     <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a>)) {
00601         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a221">NtUserSetCapture</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd));
00602         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= <a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a>;
00603 
00604         <span class="comment">/*</span>
00605 <span class="comment">         * To prevent redundant CLICK messages, we set the INCLICK bit so</span>
00606 <span class="comment">         * the WM_SETFOCUS code will not do a xxxButtonNotifyParent(BN_CLICKED).</span>
00607 <span class="comment">         */</span>
00608 
00609         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) |= <a class="code" href="../../d6/d0/usercli_8h.html#a45">BST_INCLICK</a>;
00610 
00611         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a225">NtUserSetFocus</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd));
00612 
00613         <a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;= ~<a class="code" href="../../d6/d0/usercli_8h.html#a45">BST_INCLICK</a>;
00614     }
00615     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a46">BST_CAPTURED</a>);
00616 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="btnctl.c::xxxButtonDrawCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxButtonDrawCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HBRUSH&nbsp;</td>
          <td class="mdname" nowrap> <em>hbr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">995</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02456">BFFLAT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00361">BNCalcRect()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00390">BST_CHECKMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00019">CBR_CHECKBOX</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01020">tagOEMBITMAPINFO::cx</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01021">tagOEMBITMAPINFO::cy</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00948">DOBI_CHECK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00950">DOBI_CHECKDOWN</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00949">DOBI_DOWN</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l00729">DrawFrameControl()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09755">NtUserBitBltSysBmp()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01041">OBI_3STATE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01031">OBI_CHECK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01036">OBI_RADIO</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01030">OBI_RADIOMASK</a>, <a class="el" href="../../d8/d0/client_2draw_8c-source.html#l00025">PaintRect()</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a997">POEMBITMAPINFO</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01745">tagWND::spwndParent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00363">ThreadLockAlways</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02418">WFDISABLED</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01018">tagOEMBITMAPINFO::x</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01019">tagOEMBITMAPINFO::y</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">xxxButtonDrawNewState()</a>.
<p>
<pre class="fragment"><div>00999 {
01000     RECT rc;
01001     <span class="keywordtype">int</span> bm;
01002     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> flags;
01003     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fDoubleBlt = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01004     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwnd;
01005     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
01006     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent;
01007 
01008     <a class="code" href="../../d8/d1/btnctl_8c.html#a21">BNCalcRect</a>(pwnd, hdc, &amp;rc, CBR_CHECKBOX, 0);
01009 
01010     flags = 0;
01011     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>)
01012         flags |= DFCS_CHECKED;
01013     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED)
01014         flags |= DFCS_PUSHED;
01015     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDISABLED))
01016         flags |= DFCS_INACTIVE;
01017 
01018     bm = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>;
01019     <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK)) {
01020         <span class="keywordflow">case</span> BS_AUTORADIOBUTTON:
01021         <span class="keywordflow">case</span> BS_RADIOBUTTON:
01022             fDoubleBlt = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01023             bm = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a344">OBI_RADIO</a>;
01024             flags |= DFCS_BUTTONRADIO;
01025             <span class="keywordflow">break</span>;
01026 
01027         <span class="keywordflow">case</span> BS_3STATE:
01028         <span class="keywordflow">case</span> BS_AUTO3STATE:
01029             <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>) == BST_INDETERMINATE) {
01030                 bm = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a349">OBI_3STATE</a>;
01031                 flags |= DFCS_BUTTON3STATE;
01032                 <span class="keywordflow">break</span>;
01033             }
01034             <span class="comment">// FALL THRU</span>
01035 
01036         <span class="keywordflow">default</span>:
01037             flags |= DFCS_BUTTONCHECK;
01038             <span class="keywordflow">break</span>;
01039     }
01040 
01041     rc.right = rc.left + <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cx;
01042     rc.bottom = rc.top + <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cy;
01043 
01044     <a class="code" href="../../d6/d0/usercli_8h.html#a37">ThreadLockAlways</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>, &amp;tlpwnd);
01045     pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
01046     <a class="code" href="../../d6/d0/usercli_8h.html#a645">PaintRect</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hdc, hbr, &amp;rc);
01047     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwnd);
01048 
01049     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFFLAT) &amp;&amp; <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;BitCount != 1) {
01050         flags |= DFCS_MONO | DFCS_FLAT;
01051         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a14">DrawFrameControl</a>(hdc, &amp;rc, DFC_BUTTON, flags);
01052     } <span class="keywordflow">else</span> {
01053 
01054         <span class="keywordflow">switch</span> (flags &amp; (DFCS_CHECKED | DFCS_PUSHED | DFCS_INACTIVE))
01055         {
01056         <span class="keywordflow">case</span> 0:
01057             <span class="keywordflow">break</span>;
01058 
01059         <span class="keywordflow">case</span> DFCS_CHECKED:
01060             bm += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a260">DOBI_CHECK</a>;
01061             <span class="keywordflow">break</span>;
01062 
01063         <span class="comment">// These are mutually exclusive!</span>
01064         <span class="keywordflow">case</span> DFCS_PUSHED:
01065         <span class="keywordflow">case</span> DFCS_INACTIVE:
01066             bm += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a261">DOBI_DOWN</a>;        <span class="comment">// DOBI_DOWN == DOBI_INACTIVE</span>
01067             <span class="keywordflow">break</span>;
01068 
01069         <span class="keywordflow">case</span> DFCS_CHECKED | DFCS_PUSHED:
01070             bm += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a262">DOBI_CHECKDOWN</a>;
01071             <span class="keywordflow">break</span>;
01072 
01073         <span class="keywordflow">case</span> DFCS_CHECKED | DFCS_INACTIVE:
01074             bm += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a262">DOBI_CHECKDOWN</a> + 1;
01075             <span class="keywordflow">break</span>;
01076         }
01077 
01078         <span class="keywordflow">if</span> (fDoubleBlt) {
01079             <span class="comment">// This is a diamond-shaped radio button -- Blt with a mask so that</span>
01080             <span class="comment">// the exterior keeps the same color as the window's background</span>
01081             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clrTextSave = SetTextColor(hdc, 0x00000000L);
01082             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clrBkSave   = SetBkColor(hdc, 0x00FFFFFFL);
01083             <a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html">POEMBITMAPINFO</a> pOem = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a338">OBI_RADIOMASK</a>;
01084 
01085             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a330">NtUserBitBltSysBmp</a>(hdc, rc.left, rc.top, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o2">cx</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o3">cy</a>,
01086                     pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o0">x</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o1">y</a>, SRCAND);
01087 
01088             pOem = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi + bm;
01089             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a330">NtUserBitBltSysBmp</a>(hdc, rc.left, rc.top, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o2">cx</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o3">cy</a>,
01090                     pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o0">x</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o1">y</a>, SRCINVERT);
01091 
01092             SetTextColor(hdc, clrTextSave);
01093             SetBkColor(hdc, clrBkSave);
01094         } <span class="keywordflow">else</span> {
01095             <a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html">POEMBITMAPINFO</a> pOem = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi + bm;
01096             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwROP = 0;
01097 <span class="preprocessor">#ifdef USE_MIRRORING</span>
01098 <span class="preprocessor"></span>            <span class="comment">// We do not want to mirror the check box.</span>
01099             <span class="keywordflow">if</span> (MIRRORED_HDC(hdc)) {
01100                 dwROP = NOMIRRORBITMAP;
01101             }
01102 <span class="preprocessor">#endif</span>
01103 <span class="preprocessor"></span>            <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a330">NtUserBitBltSysBmp</a>(hdc, rc.left, rc.top, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o2">cx</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o3">cy</a>, 
01104                     pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o0">x</a>, pOem-&gt;<a class="code" href="../../d0/d3/structtagOEMBITMAPINFO.html#o1">y</a>, SRCCOPY | dwROP);
01105         }
01106     }
01107 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="btnctl.c::xxxButtonDrawNewState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxButtonDrawNewState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HBRUSH&nbsp;</td>
          <td class="mdname" nowrap> <em>hbr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>sOld</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">1116</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02436">BFTYPEMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00071">IsPushButton()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00995">xxxButtonDrawCheck()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01159">xxxDrawButton()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>.
<p>
<pre class="fragment"><div>01121 {
01122     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
01123 
01124     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
01125 
01126     <span class="keywordflow">if</span> (sOld != (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED)) {
01127         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    pbfPush;
01128 
01129         pbfPush = <a class="code" href="../../d8/d1/btnctl_8c.html#a14">IsPushButton</a>(pwnd);
01130 
01131         <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFTYPEMASK)) {
01132         <span class="keywordflow">case</span> BS_GROUPBOX:
01133         <span class="keywordflow">case</span> BS_OWNERDRAW:
01134             <span class="keywordflow">break</span>;
01135 
01136         <span class="keywordflow">default</span>:
01137             <span class="keywordflow">if</span> (!pbfPush) {
01138                 <a class="code" href="../../d8/d1/btnctl_8c.html#a28">xxxButtonDrawCheck</a>(pbutn, hdc, hbr);
01139                 <span class="keywordflow">break</span>;
01140             }
01141 
01142         <span class="keywordflow">case</span> BS_PUSHBUTTON:
01143         <span class="keywordflow">case</span> BS_DEFPUSHBUTTON:
01144         <span class="keywordflow">case</span> BS_PUSHBOX:
01145             <a class="code" href="../../d8/d1/btnctl_8c.html#a13">xxxDrawButton</a>(pbutn, hdc, pbfPush);
01146             <span class="keywordflow">break</span>;
01147         }
01148     }
01149 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="btnctl.c::xxxButtonNotifyParent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxButtonNotifyParent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00625">625</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01514">HW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00215">REBASEPWND</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01745">tagWND::spwndParent</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00362">ThreadLock</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00654">xxxBNReleaseCapture()</a>.
<p>
<pre class="fragment"><div>00628 {
00629     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndParent;
00630     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent;            <span class="comment">// Parent if it exists</span>
00631 
00632     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00633 
00634     <span class="keywordflow">if</span> (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o3">spwndParent</a>)
00635         pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent);
00636     <span class="keywordflow">else</span>
00637         pwndParent = pwnd;
00638 
00639     <span class="comment">/*</span>
00640 <span class="comment">     * Note: A button's pwnd-&gt;spmenu is used to store the control ID</span>
00641 <span class="comment">     */</span>
00642     <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndParent, &amp;tlpwndParent);
00643     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndParent), WM_COMMAND,
00644             MAKELONG(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pwnd-&gt;spmenu), code), (LPARAM)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd));
00645     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndParent);
00646 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="btnctl.c::xxxDrawButton" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void xxxDrawButton           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d9/structtagBUTN.html">PBUTN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbutn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>pbfPush</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01159">1159</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
References <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00924">_GetClientRect()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02456">BFFLAT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00390">BST_CHECKMASK</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00388">BUTTONSTATE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00404">DBT_FOCUS</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00403">DBT_TEXT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00711">DF_WINDOWFRAME</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l01188">DrawFrame()</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l01125">DrawPushButton()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03190">tagBUTN::fPaintKbdCuesOnly</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00165">InflateRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00398">PBF_DEFAULT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03186">tagBUTN::spwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02319">WFWIN40COMPAT</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01206">xxxBNPaint()</a>, and <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01116">xxxButtonDrawNewState()</a>.
<p>
<pre class="fragment"><div>01163 {
01164     RECT rc;
01165     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> flags = 0;
01166     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> state = 0;
01167     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd = pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o0">spwnd</a>;
01168 
01169     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; BST_PUSHED)
01170         state |= DFCS_PUSHED;
01171 
01172     <span class="keywordflow">if</span> (!pbutn-&gt;<a class="code" href="../../d2/d9/structtagBUTN.html#o4">fPaintKbdCuesOnly</a>) {
01173         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a44">BST_CHECKMASK</a>)
01174             state |= DFCS_CHECKED;
01175 
01176         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT))
01177             flags = BF_SOFT;
01178 
01179         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, BFFLAT))
01180             flags |= BF_FLAT | BF_MONO;
01181 
01182         <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a19">_GetClientRect</a>(pwnd, &amp;rc);
01183 
01184         <span class="keywordflow">if</span> (pbfPush &amp; <a class="code" href="../../d6/d0/usercli_8h.html#a51">PBF_DEFAULT</a>) {
01185             <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a17">DrawFrame</a>(hdc, &amp;rc, 1, DF_WINDOWFRAME);
01186             <a class="code" href="../../d3/d6/rect_8c.html#a7">InflateRect</a>(&amp;rc, -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER), -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER));
01187 
01188             <span class="keywordflow">if</span> (state &amp; DFCS_PUSHED)
01189                 flags |= BF_FLAT;
01190         }
01191 
01192         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a16">DrawPushButton</a>(hdc, &amp;rc, state, flags);
01193     }
01194 
01195     <a class="code" href="../../d8/d1/btnctl_8c.html#a27">xxxBNDrawText</a>(pbutn, hdc, DBT_TEXT | (<a class="code" href="../../d6/d0/usercli_8h.html#a43">BUTTONSTATE</a>(pbutn) &amp;
01196            BST_FOCUS ? DBT_FOCUS : 0), (state &amp; DFCS_PUSHED));
01197 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a12" doxytag="btnctl.c::ButtonLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d4/struct__LOOKASIDE.html">LOOKASIDE</a> <a class="el" href="../../d8/d1/btnctl_8c.html#a12">ButtonLookaside</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00058">58</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l01338">ButtonWndProcWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="btnctl.c::mpStyleCbr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d8/d1/btnctl_8c.html#a8">mpStyleCbr</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <a class="code" href="../../d8/d1/btnctl_8c.html#a5">CBR_PUSHBUTTON</a>,  
    <a class="code" href="../../d8/d1/btnctl_8c.html#a5">CBR_PUSHBUTTON</a>,  
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a3">CBR_GROUPTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a0">CBR_CLIENTRECT</a>,  
    <a class="code" href="../../d8/d1/btnctl_8c.html#a2">CBR_CHECKTEXT</a>,   
    <a class="code" href="../../d8/d1/btnctl_8c.html#a0">CBR_CLIENTRECT</a>,  
    <a class="code" href="../../d8/d1/btnctl_8c.html#a0">CBR_CLIENTRECT</a>,  
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00025">25</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00722">xxxBNDrawText()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="btnctl.c::rgbType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d5/statctl_8c.html#a10">rgbType</a>[IMAGE_BMMAX]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    BS_BITMAP,          
    BS_ICON,            
    BS_ICON             
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00041">41</a> of file <a class="el" href="../../d9/d0/btnctl_8c-source.html">btnctl.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:57 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
