<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: fdengine.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>fdengine.c File Reference</h1><code>#include "<a class="el" href="../../d4/d2/arcinst_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d9/d0/fdengine_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a0">ARCDBG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a1">CHANGED_DONT_ZAP</a>&nbsp;&nbsp;&nbsp;((BOOLEAN)(5))</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a11">OpenDisks</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a12">CloseDisks</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a13">GetGeometry</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a14">CheckIfDiskIsOffLine</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a15">InitializePartitionLists</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a16">GetRegions</a> (IN ULONG Disk, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p, IN BOOLEAN WantUsedRegions, IN BOOLEAN WantFreeRegions, IN BOOLEAN WantLogicalRegions, OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *Region, OUT ULONG *RegionCount, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> RegionType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a17">AddRegionEntry</a> (IN OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *Regions, IN OUT ULONG *RegionCount, IN ULONG SizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> RegionType, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> Partition, IN LARGE_INTEGER AlignedRegionOffset, IN LARGE_INTEGER AlignedRegionSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a18">AddPartitionToLinkedList</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **Head, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a19">IsInLinkedList</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> List)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a20">IsInLogicalList</a> (IN ULONG Disk, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a21">IsInPartitionList</a> (IN ULONG Disk, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a22">AlignTowardsDiskStart</a> (IN ULONG Disk, IN LARGE_INTEGER <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a23">AlignTowardsDiskEnd</a> (IN ULONG Disk, IN LARGE_INTEGER <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a24">FreeLinkedPartitionList</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **q)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a25">MergeFreePartitions</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a26">RenumberPartitions</a> (ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a27">FreePartitionInfoLinkedLists</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **ListHeadArray)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a28">DiskLengthBytes</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a> (IN ULONG Disk, IN LARGE_INTEGER <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>, IN LARGE_INTEGER Length, IN UCHAR SysID, IN BOOLEAN Update, IN BOOLEAN Active, IN BOOLEAN Recognized)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a30">FdiskInitialize</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a31">FdiskCleanUp</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a32">DetermineCreateSizeAndOffset</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN LARGE_INTEGER MinimumSize, IN ULONG CreationSizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> Type, OUT PLARGE_INTEGER CreationStart, OUT PLARGE_INTEGER CreationSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a33">CreatePartitionEx</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN LARGE_INTEGER MinimumSize, IN ULONG CreationSizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> Type, IN UCHAR SysId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a34">CreatePartition</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN ULONG CreationSizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> Type)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a35">DeletePartition</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a36">GetDiskRegions</a> (IN ULONG Disk, IN BOOLEAN WantUsedRegions, IN BOOLEAN WantFreeRegions, IN BOOLEAN WantPrimaryRegions, IN BOOLEAN WantLogicalRegions, OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *Region, OUT ULONG *RegionCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a37">AddRegionEntry</a> (OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *Regions, OUT ULONG *RegionCount, IN ULONG SizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> RegionType, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> Partition, IN LARGE_INTEGER AlignedRegionOffset, IN LARGE_INTEGER AlignedRegionSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN ULONG RegionCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a> (IN OUT <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **Head, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a40">RenumberPartitions</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a41">FindPartitionElement</a> (IN ULONG Disk, IN ULONG Partition)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a42">SetSysID</a> (IN ULONG Disk, IN ULONG Partition, IN UCHAR SysID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a43">SetSysID2</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN UCHAR SysID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a44">GetHiddenSectorCount</a> (IN ULONG Disk, IN ULONG Partition)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a45">FreeLinkedPartitionList</a> (IN OUT <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *q)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a46">FreePartitionInfoLinkedLists</a> (IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *ListHeadArray)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a47">InitializeFreeSpace</a> (IN ULONG Disk, IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *PartitionList, IN LARGE_INTEGER StartOffset, IN LARGE_INTEGER Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a48">InitializeLogicalVolumeList</a> (IN ULONG Disk, IN PDRIVE_LAYOUT_INFORMATION DriveLayout, IN ULONG PartitionNumber)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a49">InitializePrimaryPartitionList</a> (IN ULONG Disk, IN PDRIVE_LAYOUT_INFORMATION DriveLayout, OUT PULONG NextPartitionNumber)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a> (IN LARGE_INTEGER ByteCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a51">DiskSizeMB</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a> (IN UCHAR SysID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a53">IsAnyCreationAllowed</a> (IN ULONG Disk, IN BOOLEAN AllowMultiplePrimaries, OUT PBOOLEAN AnyAllowed, OUT PBOOLEAN PrimaryAllowed, OUT PBOOLEAN ExtendedAllowed, OUT PBOOLEAN LogicalAllowed)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a54">IsCreationOfPrimaryAllowed</a> (IN ULONG Disk, IN BOOLEAN AllowMultiplePrimaries, OUT BOOLEAN *Allowed)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a55">IsCreationOfExtendedAllowed</a> (IN ULONG Disk, OUT BOOLEAN *Allowed)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a56">IsCreationOfLogicalAllowed</a> (IN ULONG Disk, OUT BOOLEAN *Allowed)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a57">DoesAnyPartitionExist</a> (IN ULONG Disk, OUT PBOOLEAN AnyExists, OUT PBOOLEAN PrimaryExists, OUT PBOOLEAN ExtendedExists, OUT PBOOLEAN LogicalExists)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a58">DoesAnyPrimaryExist</a> (IN ULONG Disk, OUT BOOLEAN *Exists)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a59">DoesExtendedExist</a> (IN ULONG Disk, OUT BOOLEAN *Exists)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a60">DoesAnyLogicalExist</a> (IN ULONG Disk, OUT BOOLEAN *Exists)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a61">GetDiskCount</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a62">GetDiskName</a> (ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a63">GetSysIDName</a> (UCHAR SysID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a64">UnusedEntryFill</a> (IN PPARTITION_INFORMATION pinfo, IN ULONG EntryCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a65">MakeBootRec</a> (ULONG Disk, PPARTITION_INFORMATION pinfo, <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> pLogical, <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> pNextLogical)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a66">ZapSector</a> (ULONG Disk, LARGE_INTEGER <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a67">WriteDriveLayout</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a68">CommitPartitionChanges</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a69">HavePartitionsBeenChanged</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a70">FdMarkDiskDirty</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a71">FdSetPersistentData</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN ULONG Data)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a72">FdGetMinimumSizeMB</a> (IN ULONG Disk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a73">FdGetMaximumSizeMB</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> CreationType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a74">FdGetExactSize</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN BOOLEAN ForExtended)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a75">FdGetExactOffset</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a76">FdCrosses1024Cylinder</a> (IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Region, IN ULONG CreationSizeMB, IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a> RegionType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a77">IsDiskOffLine</a> (IN ULONG Disk)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a3">DiskNames</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d8/struct__tagDISKGEOM.html">DISKGEOM</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PBOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a9">UNKNOWN</a> [] = "Unknown <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/fdengine_8c.html#a10">SysIDStrings</a> [256]</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="fdengine.c::ARCDBG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ARCDBG          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00026">26</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="fdengine.c::CHANGED_DONT_ZAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CHANGED_DONT_ZAP&nbsp;&nbsp;&nbsp;((BOOLEAN)(5))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00055">55</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01366">SetSysID()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01409">SetSysID2()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a39" doxytag="fdengine.c::AddPartitionToLinkedList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID AddPartitionToLinkedList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>Head</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01051">1051</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00380">_tagPARTITION::Prev</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01607">InitializeFreeSpace()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>.
<p>
<pre class="fragment"><div>01058                    :
01059 
01060     This routine adds a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> structure to a doubly-linked
01061     list, sorted by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> field in ascending order.
01062 
01063 Arguments:
01064 
01065     Head    - pointer to pointer to first element in list
01066 
01067     p       - pointer to item to be added to list
01068 
01069 Return Value:
01070 
01071     None.
01072 
01073 --*/
01074 
01075 {
01076     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *cur,*prev;
01077 
01078     <span class="keywordflow">if</span>((cur = *Head) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01079         *Head = p;
01080         <span class="keywordflow">return</span>;
01081     }
01082 
01083     <span class="keywordflow">if</span>(p-&gt;Offset.QuadPart &lt; cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart) {
01084         p-&gt;Next = cur;
01085         cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a> = p;
01086         *Head = p;
01087         <span class="keywordflow">return</span>;
01088     }
01089 
01090     prev = *Head;
01091     cur = cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01092 
01093     <span class="keywordflow">while</span>(cur) {
01094         <span class="keywordflow">if</span>(p-&gt;Offset.QuadPart &lt; cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart) {
01095 
01096             p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a> = cur;
01097             p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a> = prev;
01098             prev-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a> = p;
01099             cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a> = p;
01100             <span class="keywordflow">return</span>;
01101         }
01102         prev = cur;
01103         cur = cur-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01104     }
01105 
01106     prev-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a> = p;
01107     p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a> = prev;
01108     <span class="keywordflow">return</span>;
01109 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="fdengine.c::AddPartitionToLinkedList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID AddPartitionToLinkedList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>Head</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="fdengine.c::AddRegionEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN AddRegionEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Regions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT ULONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Partition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>AlignedRegionOffset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>AlignedRegionSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00965">965</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00564">_tagREGION_DESCRIPTOR::Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00395">_tagREGION_DATA::AlignedRegionOffset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00396">_tagREGION_DATA::AlignedRegionSize</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00559">_tagREGION_DESCRIPTOR::Disk</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00562">_tagREGION_DESCRIPTOR::OriginalPartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00394">_tagREGION_DATA::Partition</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00561">_tagREGION_DESCRIPTOR::PartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00558">_tagREGION_DESCRIPTOR::PersistentData</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00331">ReallocateMemory</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00565">_tagREGION_DESCRIPTOR::Recognized</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00563">_tagREGION_DESCRIPTOR::RegionType</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00567">_tagREGION_DESCRIPTOR::Reserved</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00560">_tagREGION_DESCRIPTOR::SizeMB</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00566">_tagREGION_DESCRIPTOR::SysID</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>.
<p>
<pre class="fragment"><div>00974 {
00975     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> p;
00976     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>       data;
00977 
00978     p = <a class="code" href="../../d4/d9/arcinst_8h.html#a21">ReallocateMemory</a>(*Regions,((*RegionCount) + 1) * <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">REGION_DESCRIPTOR</a>));
00979     <span class="keywordflow">if</span>(p == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00980         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00981     } <span class="keywordflow">else</span> {
00982         *Regions = p;
00983         (*RegionCount)++;
00984     }
00985 
00986     p = &amp;(*Regions)[(*RegionCount)-1];
00987 
00988     <span class="keywordflow">if</span>(!(p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o9">Reserved</a> = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">REGION_DATA</a>)))) {
00989         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00990     }
00991 
00992     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o1">Disk</a>                    = Partition-&gt;Disk;
00993     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o8">SysID</a>                   = Partition-&gt;SysID;
00994     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o2">SizeMB</a>                  = SizeMB;
00995     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o6">Active</a>                  = Partition-&gt;Active;
00996     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o7">Recognized</a>              = Partition-&gt;Recognized;
00997     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o3">PartitionNumber</a>         = Partition-&gt;PartitionNumber;
00998     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o4">OriginalPartitionNumber</a> = Partition-&gt;OriginalPartitionNumber;
00999     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o5">RegionType</a>              = RegionType;
01000     p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o0">PersistentData</a>          = Partition-&gt;PersistentData;
01001 
01002     data = p-&gt;<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o9">Reserved</a>;
01003 
01004     data-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>             = Partition;
01005     data-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>   = AlignedRegionOffset;
01006     data-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>     = AlignedRegionSize;
01007 
01008     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01009 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="fdengine.c::AddRegionEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN AddRegionEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Regions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT ULONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Partition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>AlignedRegionOffset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>AlignedRegionSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="fdengine.c::AlignTowardsDiskEnd" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER AlignTowardsDiskEnd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02073">2073</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02038">AlignTowardsDiskStart()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, and <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>.
<p>
<pre class="fragment"><div>02080                    :
02081 
02082     This routine snaps a byte offset to a cylinder boundary, towards
02083     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
02084 
02085 Arguments:
02086 
02087     Disk - index of disk whose offset <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be snapped
02088 
02089     <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> - byte offset to be aligned (snapped to cylinder boundary)
02090 
02091 Return Value:
02092 
02093     Aligned offset.
02094 
02095 --*/
02096 
02097 {
02098     LARGE_INTEGER mod;
02099     LARGE_INTEGER LargeInteger;
02100 
02101     mod.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart % <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
02102     <span class="keywordflow">if</span>(mod.QuadPart != 0) {
02103 
02104         LargeInteger.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart + <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
02105         <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> = <a class="code" href="../../d8/d1/fdengine_8c.html#a22">AlignTowardsDiskStart</a>(Disk,
02106                                        LargeInteger
02107                                       );
02108     }
02109     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>);
02110 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="fdengine.c::AlignTowardsDiskStart" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER AlignTowardsDiskStart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02038">2038</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, and <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02073">AlignTowardsDiskEnd()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>.
<p>
<pre class="fragment"><div>02045                    :
02046 
02047     This routine snaps a byte offset to a cylinder boundary, towards
02048     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
02049 
02050 Arguments:
02051 
02052     Disk - index of disk whose offset <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be snapped
02053 
02054     <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> - byte offset to be aligned (snapped to cylinder boundary)
02055 
02056 Return Value:
02057 
02058     Aligned offset.
02059 
02060 --*/
02061 
02062 {
02063     LARGE_INTEGER mod;
02064     LARGE_INTEGER Result;
02065 
02066     mod.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart % <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
02067     Result.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart - mod.QuadPart;
02068     <span class="keywordflow">return</span>(Result);
02069 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="fdengine.c::AllocatePartitionStructure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> AllocatePartitionStructure           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SysID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Update</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Active</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Recognized</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01541">1541</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d7/d7/fs__rec_8h.html#a39a20">Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00388">_tagPARTITION::Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00383">_tagPARTITION::Disk</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00384">_tagPARTITION::OriginalPartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00385">_tagPARTITION::PartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00386">_tagPARTITION::PersistentData</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00380">_tagPARTITION::Prev</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00389">_tagPARTITION::Recognized</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01607">InitializeFreeSpace()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>.
<p>
<pre class="fragment"><div>01553                    :
01554 
01555     This routine allocates space <span class="keywordflow">for</span>, and initializes a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a>
01556     structure.
01557 
01558 Arguments:
01559 
01560     Disk    - index of disk, one of whose regions <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a>
01561               strucure describes.
01562 
01563     <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>  - byte offset of region on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk
01564 
01565     Length  - length in bytes of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> region
01566 
01567     SysID   - system <span class="keywordtype">id</span> of region, of <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a> of <span class="keyword">this</span> <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a>
01568               <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> actually a free space.
01569 
01570     Update  - whether <span class="keyword">this</span> <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> dirty, ie, has changed and needs
01571               to be written to disk.
01572 
01573     <a class="code" href="../../d7/d7/fs__rec_8h.html#a39a20">Active</a>  - flag <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> BootIndicator field in a partition table entry,
01574               indicates to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> x86 master boot program which partition
01575               <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> active.
01576 
01577     Recognized - whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> recognized by NT
01578 
01579 Return Value:
01580 
01581     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <span class="keywordflow">if</span> allocation failed, or <span class="keyword">new</span> initialized <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> strucure.
01582 
01583 --*/
01584 
01585 {
01586     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a>));
01587 
01588     <span class="keywordflow">if</span>(p) {
01589         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>                    = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01590         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a>                    = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01591         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>                  = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>;
01592         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>                  = Length;
01593         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o4">Disk</a>                    = Disk;
01594         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a>                  = Update;
01595         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o9">Active</a>                  = <a class="code" href="../../d7/d7/fs__rec_8h.html#a39a20">Active</a>;
01596         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o10">Recognized</a>              = Recognized;
01597         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>                   = SysID;
01598         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = 0;
01599         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a>         = 0;
01600         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o7">PersistentData</a>          = 0;
01601     }
01602     <span class="keywordflow">return</span>(p);
01603 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="fdengine.c::CheckIfDiskIsOffLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN CheckIfDiskIsOffLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00302">302</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02615">GetDiskName()</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00036">LowCloseDisk()</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00006">LowOpenDisk()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>.
<p>
<pre class="fragment"><div>00308                    :
00309 
00310     Determine whether a disk <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> off-line by attempting to open <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00311     If <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> diskman, also attempt to read from <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00312 
00313 Arguments:
00314 
00315     Disk - supplies number of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk to check
00316 
00317 Return Value:
00318 
00319     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> disk <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> off-line, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disk <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> on-line.
00320 
00321 --*/
00322 
00323 {
00324     ULONG <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00325     BOOLEAN IsOffLine;
00326 
00327     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d6/low_8c.html#a9">LowOpenDisk</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a62">GetDiskName</a>(Disk),&amp;Handle) == <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
00328 
00329         IsOffLine = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00330         <a class="code" href="../../d1/d6/low_8c.html#a10">LowCloseDisk</a>(Handle);
00331 
00332     } <span class="keywordflow">else</span> {
00333 
00334         IsOffLine = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00335     }
00336 
00337     <span class="keywordflow">return</span>(IsOffLine);
00338 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="fdengine.c::CloseDisks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CloseDisks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="fdengine.c::CommitPartitionChanges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> CommitPartitionChanges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">3063</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03121">HavePartitionsBeenChanged()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00384">_tagPARTITION::OriginalPartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00385">_tagPARTITION::PartitionNumber</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>.
<p>
<pre class="fragment"><div>03069                    :
03070 
03071     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry point <span class="keywordflow">for</span> updating <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> on-disk partition
03072     structures of a disk.  The disk <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> written to <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition
03073     structure has been changed by adding or deleting partitions.
03074 
03075 Arguments:
03076 
03077     Disk - index of disk whose on-disk partition structure <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be updated.
03078 
03079 Return Value:
03080 
03081     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
03082 
03083 --*/
03084 
03085 {
03086     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>  p;
03087     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
03088 
03089     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(!OffLine[Disk]);
03090 
03091     <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a69">HavePartitionsBeenChanged</a>(Disk)) {
03092         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
03093     }
03094 
03095     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a67">WriteDriveLayout</a>(Disk)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
03096         <span class="keywordflow">return</span>(status);
03097     }
03098 
03099     <span class="comment">// BUGBUG for ARC and NT MIPS, update NVRAM vars so partitions are right.</span>
03100     <span class="comment">//        Do that here, before partition numbers are reassigned.</span>
03101 
03102     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Disk];
03103     <span class="keywordflow">while</span>(p) {
03104         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03105         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a>;
03106         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
03107     }
03108     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Disk];
03109     <span class="keywordflow">while</span>(p) {
03110         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03111         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a>;
03112         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
03113     }
03114 
03115     <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[Disk] = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03116     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
03117 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="fdengine.c::CreatePartition" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> CreatePartition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationSizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00698">698</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a72">SYSID_BIGFAT</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>.
<p>
<pre class="fragment"><div>00703 {
00704     LARGE_INTEGER   LargeZero;
00705 
00706     LargeZero.QuadPart = 0;
00707     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a33">CreatePartitionEx</a>(Region,
00708                              LargeZero,
00709                              CreationSizeMB,
00710                              Type,
00711                              (UCHAR)((Type == REGION_EXTENDED) ? SYSID_EXTENDED
00712                                                                : SYSID_BIGFAT
00713                                     )
00714                             )
00715           );
00716 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="fdengine.c::CreatePartitionEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> CreatePartitionEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>MinimumSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationSizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SysId</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">549</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01051">AddPartitionToLinkedList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01541">AllocatePartitionStructure()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00429">DetermineCreateSizeAndOffset()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00383">_tagPARTITION::Disk</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01209">MergeFreePartitions()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00394">_tagREGION_DATA::Partition</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00389">_tagPARTITION::Recognized</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00698">CreatePartition()</a>.
<p>
<pre class="fragment"><div>00559                    :
00560 
00561     This routine creates a partition from a free region on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.  The
00562     partition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> always created at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> beginning of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> free space, and any
00563     left over space at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> kept on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> free space list.
00564 
00565 Arguments:
00566 
00567     Region  - a region descriptor returned by <a class="code" href="../../d8/d1/fdengine_8c.html#a36">GetDiskRegions</a>().  Must
00568               be an unused region.
00569 
00570     CreationSizeMB - size of partition to create, in MB.
00571 
00572     Type    - <a class="code" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>, <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, or <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <span class="keywordflow">for</span>
00573               creating a primary partition, extended pasrtition, or
00574               logical volume, respectively.
00575 
00576     SysId - system <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> byte to be assigned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition
00577 
00578 Return Value:
00579 
00580     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
00581 
00582 --*/
00583 
00584 {
00585     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>    p1,p2,p3;
00586     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>  CreateData = Region-&gt;Reserved;
00587     LARGE_INTEGER CreationStart,CreationSize,LeftOver;
00588     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>   *PartitionList;
00589 
00590     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Region-&gt;SysID == SYSID_UNUSED);
00591 
00592     <a class="code" href="../../d8/d1/fdengine_8c.html#a32">DetermineCreateSizeAndOffset</a>( Region,
00593                                   MinimumSize,
00594                                   CreationSizeMB,
00595                                   Type,
00596                                   &amp;CreationStart,
00597                                   &amp;CreationSize
00598                                 );
00599 
00600     <span class="comment">//</span>
00601     <span class="comment">// now we've got the start and size of the partition to be created.</span>
00602     <span class="comment">// If there's left-over at the beginning of the free space (after</span>
00603     <span class="comment">// alignment), make a new PARTITION structure.</span>
00604 
00605     p1 = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00606     LeftOver.QuadPart = (CreationStart.QuadPart - CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart);
00607 
00608     <span class="keywordflow">if</span>(LeftOver.QuadPart &gt; 0) {
00609 
00610         p1 = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Region-&gt;Disk,
00611                                         CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>,
00612                                         LeftOver,
00613                                         SYSID_UNUSED,
00614                                         FALSE,
00615                                         FALSE,
00616                                         FALSE
00617                                        );
00618         <span class="keywordflow">if</span>(p1 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00619             <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00620         }
00621     }
00622 
00623     <span class="comment">// make a new partition structure for space being left free as</span>
00624     <span class="comment">// a result of this creation.</span>
00625 
00626     p2 = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00627     LeftOver.QuadPart = (CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart + CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>.QuadPart) -
00628                         (CreationStart.QuadPart + CreationSize.QuadPart);
00629 
00630     <span class="keywordflow">if</span>(LeftOver.QuadPart != 0) {
00631 
00632         LARGE_INTEGER   TmpResult;
00633 
00634         TmpResult.QuadPart = CreationStart.QuadPart + CreationSize.QuadPart;
00635         p2 = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Region-&gt;Disk,
00636                                         TmpResult,
00637                                         LeftOver,
00638                                         SYSID_UNUSED,
00639                                         FALSE,
00640                                         FALSE,
00641                                         FALSE
00642                                        );
00643         <span class="keywordflow">if</span>(p2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00644             <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00645         }
00646     }
00647 
00648     <span class="comment">// adjust the free partition's fields.</span>
00649 
00650     CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a> = CreationStart;
00651     CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a> = CreationSize;
00652     CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>  = SysId;
00653     CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00654     CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o10">Recognized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00655 
00656     <span class="comment">// if we just created an extended partition, show the whole thing</span>
00657     <span class="comment">// as one free logical region.</span>
00658 
00659     <span class="keywordflow">if</span>(Type == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>) {
00660 
00661         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(LogicalVolumes[Region-&gt;Disk] == NULL);
00662 
00663         p3 = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Region-&gt;Disk,
00664                                         CreationStart,
00665                                         CreationSize,
00666                                         SYSID_UNUSED,
00667                                         FALSE,
00668                                         FALSE,
00669                                         FALSE
00670                                        );
00671         <span class="keywordflow">if</span>(p3 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00672             <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00673         }
00674         <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(&amp;LogicalVolumes[Region-&gt;Disk],p3);
00675     }
00676 
00677     PartitionList = (Type == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>)
00678                   ? &amp;<a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Region-&gt;Disk]
00679                   : &amp;<a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Region-&gt;Disk];
00680 
00681     <span class="keywordflow">if</span>(p1) {
00682         <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(PartitionList,p1);
00683     }
00684     <span class="keywordflow">if</span>(p2) {
00685         <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(PartitionList,p2);
00686     }
00687 
00688     <a class="code" href="../../d8/d1/fdengine_8c.html#a25">MergeFreePartitions</a>(*PartitionList);
00689     <a class="code" href="../../d8/d1/fdengine_8c.html#a40">RenumberPartitions</a>(Region-&gt;Disk);
00690 
00691     <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[Region-&gt;Disk] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00692 
00693     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00694 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="fdengine.c::DeletePartition" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> DeletePartition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Region</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">721</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00388">_tagPARTITION::Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00383">_tagPARTITION::Disk</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01473">FreeLinkedPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01149">IsInLogicalList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01179">IsInPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01209">MergeFreePartitions()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00384">_tagPARTITION::OriginalPartitionNumber</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00394">_tagREGION_DATA::Partition</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>.
<p>
<pre class="fragment"><div>00727                    :
00728 
00729     This routine deletes a partition, returning its space to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00730     free space on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.  If deleting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> extended partition,
00731     all logical volumes within <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> are also deleted.
00732 
00733 Arguments:
00734 
00735     Region  - a region descriptor returned by <a class="code" href="../../d8/d1/fdengine_8c.html#a36">GetDiskRegions</a>().  Must
00736               be a used region.
00737 
00738 Return Value:
00739 
00740     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
00741 
00742 --*/
00743 
00744 {
00745     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>  RegionData = Region-&gt;Reserved;
00746     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>   *PartitionList;
00747 
00748     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(    <a class="code" href="../../d8/d1/fdengine_8c.html#a21">IsInPartitionList</a>(Region-&gt;Disk,RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>)
00749           || <a class="code" href="../../d8/d1/fdengine_8c.html#a20">IsInLogicalList</a>  (Region-&gt;Disk,RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>)
00750         );
00751 
00752     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(Region-&gt;SysID)) {
00753 
00754         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a21">IsInPartitionList</a>(Region-&gt;Disk,RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>));
00755 
00756         <span class="comment">// Deleting extended partition.  Also delete all logical volumes.</span>
00757 
00758         <a class="code" href="../../d8/d1/fdengine_8c.html#a45">FreeLinkedPartitionList</a>(&amp;LogicalVolumes[Region-&gt;Disk]);
00759     }
00760 
00761     RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>  = <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>;
00762     RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00763     RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o9">Active</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00764     RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o0">Partition</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = 0;
00765 
00766     PartitionList = (Region-&gt;RegionType == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>)
00767                   ? &amp;<a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Region-&gt;Disk]
00768                   : &amp;<a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Region-&gt;Disk];
00769 
00770     <a class="code" href="../../d8/d1/fdengine_8c.html#a25">MergeFreePartitions</a>(*PartitionList);
00771     <a class="code" href="../../d8/d1/fdengine_8c.html#a40">RenumberPartitions</a>(Region-&gt;Disk);
00772 
00773     <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[Region-&gt;Disk] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00774 
00775     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00776 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="fdengine.c::DetermineCreateSizeAndOffset" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DetermineCreateSizeAndOffset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>MinimumSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationSizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationStart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00429">429</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00395">_tagREGION_DATA::AlignedRegionOffset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00396">_tagREGION_DATA::AlignedRegionSize</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00339">ONE_MEG</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03324">FdCrosses1024Cylinder()</a>.
<p>
<pre class="fragment"><div>00440                    :
00441 
00442     Determine <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> actual offset and size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition, given <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00443     size in megabytes.
00444 
00445 Arguments:
00446 
00447     Region  - a region descriptor returned by <a class="code" href="../../d8/d1/fdengine_8c.html#a36">GetDiskRegions</a>().  Must
00448               be an unused region.
00449 
00450     MinimumSize - <span class="keywordflow">if</span> non-0, <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d4/mrcf_8c.html#a3">minimum</a> size that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition
00451         or logical drive can be.
00452 
00453     CreationSizeMB - If MinimumSize <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> 0, size of partition to create, in MB.
00454 
00455     Type    - <a class="code" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>, <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, or <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <span class="keywordflow">for</span>
00456               creating a primary partition, extended partition, or
00457               logical volume, respectively.
00458 
00459     CreationStart - receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> offset where <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition should be placed.
00460 
00461     CreationSize - receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exact size <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition.
00462 
00463 Return Value:
00464 
00465     None.
00466 
00467 --*/
00468 
00469 {
00470     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a> CreateData = Region-&gt;Reserved;
00471     LARGE_INTEGER CSize,CStart;
00472     LARGE_INTEGER Mod;
00473     ULONG  bpc = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
00474     ULONG  bpt = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>;
00475 
00476     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Region-&gt;SysID == SYSID_UNUSED);
00477 
00478     <span class="comment">//</span>
00479     <span class="comment">// If we are creating a partition at offset 0, adjust the aligned region</span>
00480     <span class="comment">// offset and the aligned region size, because no partition can actually</span>
00481     <span class="comment">// start at offset 0.</span>
00482     <span class="comment">//</span>
00483 
00484     <span class="keywordflow">if</span>(CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>.QuadPart == 0) {
00485 
00486         LARGE_INTEGER Delta;
00487 
00488         <span class="keywordflow">if</span>(Type == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>) {
00489 
00490             Delta.QuadPart = bpc;
00491 
00492         } <span class="keywordflow">else</span> {
00493 
00494             <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Type == REGION_PRIMARY);
00495             Delta.QuadPart = bpt;
00496         }
00497 
00498         CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a> = Delta;
00499         CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>.QuadPart = (CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>.QuadPart - Delta.QuadPart);
00500     }
00501 
00502     CStart = CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>;
00503     <span class="keywordflow">if</span>(MinimumSize.QuadPart == 0) {
00504         CSize.QuadPart = UInt32x32To64(CreationSizeMB,ONE_MEG);
00505     } <span class="keywordflow">else</span> {
00506         CSize = MinimumSize;
00507         <span class="keywordflow">if</span>(Type == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>) {
00508             CSize.QuadPart = CSize.QuadPart + bpt;
00509         }
00510     }
00511 
00512     <span class="comment">//</span>
00513     <span class="comment">// Decide whether to align the ending cylinder up or down.</span>
00514     <span class="comment">// If the offset of end of the partition is more than half way into the</span>
00515     <span class="comment">// final cylinder, align towrds the disk end.  Otherwise align toward</span>
00516     <span class="comment">// the disk start.</span>
00517     <span class="comment">//</span>
00518 
00519     Mod.QuadPart = (CStart.QuadPart + CSize.QuadPart) % bpc;
00520 
00521     <span class="keywordflow">if</span>(Mod.QuadPart != 0) {
00522 
00523         <span class="keywordflow">if</span>((MinimumSize.QuadPart != 0) || (Mod.QuadPart &gt; bpc/2)) {
00524             CSize.QuadPart = (CSize.QuadPart + (bpc - Mod.QuadPart));
00525         } <span class="keywordflow">else</span> {
00526             CSize.QuadPart = (CSize.QuadPart - Mod.QuadPart);        <span class="comment">// snap downwards tp cyl boundary</span>
00527         }
00528     }
00529 
00530     <span class="keywordflow">if</span>(CSize.QuadPart &gt; CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>.QuadPart) {
00531 
00532         <span class="comment">//</span>
00533         <span class="comment">// Space available in the free space isn't large enough to accomodate</span>
00534         <span class="comment">// the request in its entirety;  just use the entire free space.</span>
00535         <span class="comment">//</span>
00536 
00537         CSize  = CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>;
00538     }
00539 
00540     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(CStart.QuadPart != 0);
00541     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(CSize.QuadPart != 0);
00542 
00543     *CreationStart = CStart;
00544     *CreationSize  = CSize;
00545 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="fdengine.c::DiskLengthBytes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER DiskLengthBytes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01940">1940</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00353">_tagDISKGEOM::Cylinders</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02011">DiskSizeMB()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>.
<p>
<pre class="fragment"><div>01946                    :
01947 
01948     This routine determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk length in bytes.  This value
01949     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> calculated from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk geometry information.
01950 
01951 Arguments:
01952 
01953     Disk - index of disk whose size <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> desired
01954 
01955 Return Value:
01956 
01957     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> of Disk.
01958 
01959 --*/
01960 
01961 {
01962     LARGE_INTEGER l;
01963 
01964     l.QuadPart = (ULONGLONG)<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o0">Cylinders</a>.QuadPart
01965                * (ULONGLONG)<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
01966 
01967     <span class="keywordflow">return</span>(l);
01968 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="fdengine.c::DiskSizeMB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG DiskSizeMB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02011">2011</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01940">DiskLengthBytes()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01972">SIZEMB()</a>.
<p>
<pre class="fragment"><div>02017                    :
02018 
02019     This routine determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk length in megabytes.  The returned
02020     value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> rounded down after division by 1024*1024.
02021 
02022 Arguments:
02023 
02024     Disk - index of disk whose size <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> desired
02025 
02026 Return Value:
02027 
02028     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> of Disk.
02029 
02030 --*/
02031 
02032 {
02033     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a28">DiskLengthBytes</a>(Disk)));
02034 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="fdengine.c::DoesAnyLogicalExist" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> DoesAnyLogicalExist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Exists</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02546">2546</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00614">GetUsedLogicalDiskRegions</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02394">DoesAnyPartitionExist()</a>.
<p>
<pre class="fragment"><div>02553                    :
02554 
02555     This routine determines whether any logical volumes exist
02556     on a given disk.
02557 
02558 Arguments:
02559 
02560     Disk   - index of disk to check
02561 
02562     Exists - returns whether any logical volumes exist on Disk
02563 
02564 Return Value:
02565 
02566     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02567 
02568 --*/
02569 
02570 {
02571     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02572     ULONG               RegionCount;
02573     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02574 
02575     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a35">GetUsedLogicalDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02576     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02577         <span class="keywordflow">return</span>(status);
02578     }
02579 
02580     *Exists = (BOOLEAN)(RegionCount != 0);
02581     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02582     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02583 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="fdengine.c::DoesAnyPartitionExist" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> DoesAnyPartitionExist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AnyExists</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>PrimaryExists</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ExtendedExists</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalExists</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02394">2394</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02546">DoesAnyLogicalExist()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02446">DoesAnyPrimaryExist()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02496">DoesExtendedExist()</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>.
<p>
<pre class="fragment"><div>02404                    :
02405 
02406     This routine determines whether any partition exists on a given disk.
02407     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> based on three sub queries: whether there are any primary or
02408     extended partitions, or logical volumes on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
02409 
02410 Arguments:
02411 
02412     Disk            - index of disk to check
02413 
02414     AnyExists - returns whether any partitions exist on Disk
02415 
02416     PrimaryExists - returns whether any primary partitions exist on Disk
02417 
02418     ExtendedExists - returns whether there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> an extended partition on Disk
02419 
02420     LogicalExists - returns whether any logical volumes exist on Disk
02421 
02422 Return Value:
02423 
02424     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02425 
02426 --*/
02427 
02428 {
02429     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
02430 
02431     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a58">DoesAnyPrimaryExist</a>(Disk,PrimaryExists )) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02432         <span class="keywordflow">return</span>(status);
02433     }
02434     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a59">DoesExtendedExist</a>  (Disk,ExtendedExists)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02435         <span class="keywordflow">return</span>(status);
02436     }
02437     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a60">DoesAnyLogicalExist</a>(Disk,LogicalExists )) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02438         <span class="keywordflow">return</span>(status);
02439     }
02440     *AnyExists = (BOOLEAN)(*PrimaryExists || *ExtendedExists || *LogicalExists);
02441     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02442 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="fdengine.c::DoesAnyPrimaryExist" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> DoesAnyPrimaryExist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Exists</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02446">2446</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00611">GetUsedPrimaryDiskRegions</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02394">DoesAnyPartitionExist()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>.
<p>
<pre class="fragment"><div>02453                    :
02454 
02455     This routine determines whether any non-extended primary partition exists
02456     on a given disk.
02457 
02458 Arguments:
02459 
02460     Disk   - index of disk to check
02461 
02462     Exists - returns whether any primary partitions exist on Disk
02463 
02464 Return Value:
02465 
02466     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02467 
02468 --*/
02469 
02470 {
02471     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02472     ULONG               RegionCount,i;
02473     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02474 
02475     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a34">GetUsedPrimaryDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02476     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02477         <span class="keywordflow">return</span>(status);
02478     }
02479 
02480     *Exists = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02481 
02482     <span class="keywordflow">for</span>(i=0; i&lt;RegionCount; i++) {
02483         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].RegionType != REGION_LOGICAL);
02484         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].SysID != SYSID_UNUSED);
02485         <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(Regions[i].SysID)) {
02486             *Exists = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02487             <span class="keywordflow">break</span>;
02488         }
02489     }
02490     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02491     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02492 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="fdengine.c::DoesExtendedExist" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> DoesExtendedExist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Exists</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02496">2496</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00611">GetUsedPrimaryDiskRegions</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02394">DoesAnyPartitionExist()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02333">IsCreationOfLogicalAllowed()</a>.
<p>
<pre class="fragment"><div>02503                    :
02504 
02505     This routine determines whether an extended partition exists
02506     on a given disk.
02507 
02508 Arguments:
02509 
02510     Disk   - index of disk to check
02511 
02512     Exists - returns whether an extended partition exists on Disk
02513 
02514 Return Value:
02515 
02516     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02517 
02518 --*/
02519 
02520 {
02521     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02522     ULONG               RegionCount,i;
02523     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02524 
02525     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a34">GetUsedPrimaryDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02526     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02527         <span class="keywordflow">return</span>(status);
02528     }
02529 
02530     *Exists = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02531 
02532     <span class="keywordflow">for</span>(i=0; i&lt;RegionCount; i++) {
02533         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].RegionType != REGION_LOGICAL);
02534         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].SysID != SYSID_UNUSED);
02535         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(Regions[i].SysID)) {
02536             *Exists = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02537             <span class="keywordflow">break</span>;
02538         }
02539     }
02540     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02541     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02542 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="fdengine.c::FdCrosses1024Cylinder" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN FdCrosses1024Cylinder           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationSizeMB</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03324">3324</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00429">DetermineCreateSizeAndOffset()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
<pre class="fragment"><div>03332                    :
03333 
03334     Determine whether a used region corsses <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 1024th cylinder, or whether
03335     a partition created within a free space will cross <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 1024th cylinder.
03336 
03337 Arguments:
03338 
03339     Region - region describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition to check.
03340 
03341     CreationSizeMB - <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Region <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keywordflow">for</span> a free space, <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of
03342         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition to be checked.
03343 
03344     RegionType - one of <a class="code" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>, <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, or <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>
03345 
03346 Return Value:
03347 
03348     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end cylinder &gt;= 1024.
03349 
03350 --*/
03351 
03352 {
03353     LARGE_INTEGER <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>,<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>,<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>, LargeZero;
03354 
03355     <span class="keywordflow">if</span>(Region-&gt;SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
03356 
03357         <span class="comment">//</span>
03358         <span class="comment">// Determine the exact size and offset of the partition, according</span>
03359         <span class="comment">// to how CreatePartitionEx() will do it.</span>
03360         <span class="comment">//</span>
03361 
03362         LargeZero.QuadPart = 0;
03363         <a class="code" href="../../d8/d1/fdengine_8c.html#a32">DetermineCreateSizeAndOffset</a>( Region,
03364                                       LargeZero,
03365                                       CreationSizeMB,
03366                                       RegionType,
03367                                       &amp;Start,
03368                                       &amp;Size
03369                                     );
03370 
03371     } <span class="keywordflow">else</span> {
03372 
03373         <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> = ((<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>)(Region-&gt;Reserved))-&gt;Partition-&gt;Offset;
03374         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>  = ((<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>)(Region-&gt;Reserved))-&gt;Partition-&gt;Length;
03375     }
03376 
03377     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>.QuadPart = (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>.QuadPart + <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>.QuadPart) - 1;
03378 
03379     <span class="comment">//</span>
03380     <span class="comment">// End is the last byte in the partition.  Divide by the number of</span>
03381     <span class="comment">// bytes in a cylinder and see whether the result is &gt; 1023.</span>
03382     <span class="comment">//</span>
03383 
03384     <span class="keywordflow">return</span>( (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>.QuadPart / <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>) &gt; 1023 );
03385 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="fdengine.c::FdGetExactOffset" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER FdGetExactOffset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Region</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03281">3281</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
<pre class="fragment"><div>03287                    :
03288 
03289     Determine where a given partition _actually_ starts, which may be
03290     different than where <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> appears because of EBR reserved tracks, etc.
03291 
03292     NOTE: This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not meant to operate on unused regions or
03293     extended partitions.  In these cases, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> just returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> apparant offset.
03294 
03295 Arguments:
03296 
03297     Region - region describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition to check.
03298 
03299 Return Value:
03300 
03301     Actual offset
03302 
03303 --*/
03304 
03305 {
03306     LARGE_INTEGER <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> = ((<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>)(Region-&gt;Reserved))-&gt;Partition-&gt;Offset;
03307 
03308     <span class="keywordflow">if</span>((Region-&gt;SysID != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) &amp;&amp; (Region-&gt;RegionType == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>)) {
03309 
03310         <span class="comment">//</span>
03311         <span class="comment">// The region is a logical volume.</span>
03312         <span class="comment">// Account for the reserved EBR track.</span>
03313         <span class="comment">//</span>
03314 
03315         <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart +
03316                                  <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>;
03317     }
03318 
03319     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>);
03320 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="fdengine.c::FdGetExactSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER FdGetExactSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ForExtended</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03231">3231</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00395">_tagREGION_DATA::AlignedRegionOffset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00396">_tagREGION_DATA::AlignedRegionSize</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
<pre class="fragment"><div>03235 {
03236     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>  RegionData = Region-&gt;Reserved;
03237     LARGE_INTEGER LargeSize = RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>;
03238     LARGE_INTEGER BytesPerTrack;
03239     LARGE_INTEGER BytesPerCylinder;
03240 
03241     BytesPerTrack.QuadPart = (<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>);
03242     BytesPerCylinder.QuadPart = (<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>);
03243 
03244     <span class="keywordflow">if</span>(Region-&gt;RegionType == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>) {
03245 
03246         <span class="comment">//</span>
03247         <span class="comment">// The region is within the extended partition.  It doesn't matter</span>
03248         <span class="comment">// whether it's free space or used -- in either case, we need to</span>
03249         <span class="comment">// account for the reserved EBR track.</span>
03250         <span class="comment">//</span>
03251 
03252         LargeSize.QuadPart = LargeSize.QuadPart - BytesPerTrack.QuadPart;
03253 
03254     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Region-&gt;SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
03255 
03256         <span class="comment">//</span>
03257         <span class="comment">// The region is unused space not inside the extended partition.</span>
03258         <span class="comment">// We must know whether the caller will put a primary or extended</span>
03259         <span class="comment">// partition there -- a primary partition can use all the space, but</span>
03260         <span class="comment">// a logical volume in the extended partition won't include the first</span>
03261         <span class="comment">// track.  If the free space starts at offset 0 on the disk, a special</span>
03262         <span class="comment">// calculation must be used to move the start of the partition to</span>
03263         <span class="comment">// skip a track for a primary or a cylinder and a track for an</span>
03264         <span class="comment">// extended+logical.</span>
03265         <span class="comment">//</span>
03266 
03267         <span class="keywordflow">if</span>((RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>.QuadPart == 0) || ForExtended) {
03268             LargeSize.QuadPart = LargeSize.QuadPart - BytesPerTrack.QuadPart;
03269         }
03270 
03271         <span class="keywordflow">if</span>((RegionData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>.QuadPart == 0) &amp;&amp; ForExtended) {
03272             LargeSize.QuadPart = LargeSize.QuadPart - BytesPerCylinder.QuadPart;
03273         }
03274     }
03275 
03276     <span class="keywordflow">return</span>(LargeSize);
03277 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="fdengine.c::FdGetMaximumSizeMB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG FdGetMaximumSizeMB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CreationType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03203">3203</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00395">_tagREGION_DATA::AlignedRegionOffset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00396">_tagREGION_DATA::AlignedRegionSize</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01972">SIZEMB()</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
<pre class="fragment"><div>03207 {
03208     <a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a> CreateData = Region-&gt;Reserved;
03209     LARGE_INTEGER MaxSize = CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o2">AlignedRegionSize</a>;
03210 
03211     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Region-&gt;SysID == SYSID_UNUSED);
03212 
03213     <span class="keywordflow">if</span>(CreateData-&gt;<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html#o1">AlignedRegionOffset</a>.QuadPart == 0) {
03214 
03215         ULONG Delta;
03216 
03217         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>((CreationType == REGION_EXTENDED) || (CreationType == REGION_PRIMARY))
03218 
03219         Delta = (CreationType == <a class="code" href="../../d4/d9/arcinst_8h.html#a175a68">REGION_EXTENDED</a>)
03220               ? <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>
03221               : <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Region-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>;
03222 
03223         MaxSize.QuadPart = MaxSize.QuadPart - Delta;
03224     }
03225 
03226     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a>(MaxSize));
03227 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="fdengine.c::FdGetMinimumSizeMB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG FdGetMinimumSizeMB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03172">3172</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01972">SIZEMB()</a>.
<p>
<pre class="fragment"><div>03178                    :
03179 
03180     Return <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d4/mrcf_8c.html#a3">minimum</a> size <span class="keywordflow">for</span> a partition on a given disk.
03181 
03182     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> rounded size of one cylinder or 1, whichever <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> greater.
03183 
03184 Arguments:
03185 
03186     Region - region describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition to check.
03187 
03188 Return Value:
03189 
03190     Actual offset
03191 
03192 --*/
03193 
03194 {
03195     LARGE_INTEGER   LargeInteger;
03196 
03197     LargeInteger.QuadPart = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a>;
03198     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a>(LargeInteger),1));
03199 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="fdengine.c::FdiskCleanUp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FdiskCleanUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">258</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01508">FreePartitionInfoLinkedLists()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00786">LowFreeFdiskPathList()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>.
<p>
<pre class="fragment"><div>00264                    :
00265 
00266     This routine deallocates storage used by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partitioning engine.
00267 
00268 Arguments:
00269 
00270     None.
00271 
00272 Return Value:
00273 
00274     None.
00275 
00276 --*/
00277 
00278 {
00279     <a class="code" href="../../d1/d6/low_8c.html#a22">LowFreeFdiskPathList</a>(DiskNames,CountOfDisks);
00280 
00281     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00282         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DiskGeometryArray);
00283     }
00284     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00285         <a class="code" href="../../d8/d1/fdengine_8c.html#a46">FreePartitionInfoLinkedLists</a>(PrimaryPartitions);
00286         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(PrimaryPartitions);
00287     }
00288     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00289         <a class="code" href="../../d8/d1/fdengine_8c.html#a46">FreePartitionInfoLinkedLists</a>(LogicalVolumes);
00290         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(LogicalVolumes);
00291     }
00292     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00293         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(ChangesMade);
00294     }
00295     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00296         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(OffLine);
00297     }
00298 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="fdengine.c::FdiskInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> FdiskInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">183</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d0/d6/almisc_8c-source.html#l01483">AlPrint()</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00302">CheckIfDiskIsOffLine()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>, <a class="el" href="../../d2/d9/arccodes_8h.html#a24a14">ENODEV</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">GetGeometry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00756">LowQueryFdiskPathList()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a47">PPARTITION</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>.
<p>
Referenced by <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00090">main()</a>.
<p>
<pre class="fragment"><div>00189                    :
00190 
00191     This routine initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partitioning engine, including allocating
00192     arrays, determining attached disk devices, and reading their
00193     partition tables.
00194 
00195 Arguments:
00196 
00197     None.
00198 
00199 Return Value:
00200 
00201     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
00202 
00203 --*/
00204 
00205 {
00206     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
00207     ULONG        i;
00208 
00209 
00210     <span class="keywordflow">if</span>((status = <a class="code" href="../../d1/d6/low_8c.html#a21">LowQueryFdiskPathList</a>(&amp;DiskNames,&amp;CountOfDisks)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
00211         <span class="keywordflow">return</span>(status);
00212     }
00213 
00214 <span class="preprocessor">#if 0</span>
00215 <span class="preprocessor"></span><span class="preprocessor">#ifdef ARCDBG</span>
00216 <span class="preprocessor"></span>    <a class="code" href="../../d4/d9/arcinst_8h.html#a114">AlPrint</a>(<span class="stringliteral">"Disk count = %u\r\n"</span>,CountOfDisks);
00217     <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>; i++) {
00218         <a class="code" href="../../d4/d9/arcinst_8h.html#a114">AlPrint</a>(<span class="stringliteral">"Disk %u: %s\r\n"</span>,i,DiskNames[i]);
00219     }
00220     WaitKey();
00221 <span class="preprocessor">#endif</span>
00222 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00223 <span class="preprocessor"></span>
00224     <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00225     <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00226     <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00227 
00228     <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>      = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(CountOfDisks * <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html">DISKGEOM</a>  ))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00229     || ((<a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>            = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(CountOfDisks * <span class="keyword">sizeof</span>(BOOLEAN   ))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00230     || ((<a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>      = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(CountOfDisks * <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00231     || ((<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>                = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(CountOfDisks * <span class="keyword">sizeof</span>(BOOLEAN   ))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00232     || ((<a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>         = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(CountOfDisks * <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>))
00233     {
00234         <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00235     }
00236 
00237     <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>; i++) {
00238         <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00239         <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00240         <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[i] = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00241         <a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[i] = <a class="code" href="../../d8/d1/fdengine_8c.html#a14">CheckIfDiskIsOffLine</a>(i);
00242         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[i]) {
00243             <span class="keywordflow">return</span>(<a class="code" href="../../d2/d9/arccodes_8h.html#a24a14">ENODEV</a>);
00244         }
00245     }
00246 
00247     <span class="keywordflow">if</span>(((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a13">GetGeometry</a>()             ) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>)
00248     || ((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a15">InitializePartitionLists</a>()) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>))
00249     {
00250         <span class="keywordflow">return</span>(status);
00251     }
00252 
00253     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00254 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="fdengine.c::FdMarkDiskDirty" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FdMarkDiskDirty           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03152">3152</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>03155 {
03156     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(!OffLine[Disk]);
03157 
03158     <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[Disk] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03159 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="fdengine.c::FdSetPersistentData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FdSetPersistentData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03162">3162</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
<pre class="fragment"><div>03166 {
03167     ((<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>)(Region-&gt;Reserved))-&gt;Partition-&gt;PersistentData = Data;
03168 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="fdengine.c::FindPartitionElement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> FindPartitionElement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Partition</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">1312</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00385">_tagPARTITION::PartitionNumber</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01425">GetHiddenSectorCount()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01366">SetSysID()</a>.
<p>
<pre class="fragment"><div>01319                    :
01320 
01321     This routine locates a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element <span class="keywordflow">for</span> a disk/partition
01322     number pair.  The partition number <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01323     system assigns to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition.
01324 
01325 Arguments:
01326 
01327     Disk - index of relevent disk
01328 
01329     Partition - partition number of partition to find
01330 
01331 Return Value:
01332 
01333     pointer to <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element, or <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <span class="keywordflow">if</span> not found.
01334 
01335 --*/
01336 
01337 {
01338     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p;
01339 
01340     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Partition);
01341 
01342     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Disk];
01343     <span class="keywordflow">while</span>(p) {
01344         <span class="keywordflow">if</span>((p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>)
01345         &amp;&amp; !<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>)
01346         &amp;&amp; (p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a> == Partition))
01347         {
01348             <span class="keywordflow">return</span>(p);
01349         }
01350         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01351     }
01352     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Disk];
01353     <span class="keywordflow">while</span>(p) {
01354         <span class="keywordflow">if</span>((p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>)
01355         &amp;&amp; (p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a> == Partition))
01356         {
01357             <span class="keywordflow">return</span>(p);
01358         }
01359         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01360     }
01361     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01362 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="fdengine.c::FreeLinkedPartitionList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeLinkedPartitionList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>q</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01473">1473</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01508">FreePartitionInfoLinkedLists()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>.
<p>
<pre class="fragment"><div>01479                    :
01480 
01481     This routine frees a linked list of <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> elements. The head
01482     pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.
01483 
01484 Arguments:
01485 
01486     p - pointer to pointer to first element of list to free.
01487 
01488 Return Value:
01489 
01490     None.
01491 
01492 --*/
01493 
01494 {
01495     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01496     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> *p = *q;
01497 
01498     <span class="keywordflow">while</span>(p) {
01499         <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01500         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(p);
01501         p = <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01502     }
01503     *q = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01504 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="fdengine.c::FreeLinkedPartitionList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeLinkedPartitionList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>q</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="fdengine.c::FreePartitionInfoLinkedLists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreePartitionInfoLinkedLists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ListHeadArray</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01508">1508</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01473">FreeLinkedPartitionList()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>.
<p>
<pre class="fragment"><div>01514                    :
01515 
01516     This routine frees <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> linked lists of <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> elements
01517     <span class="keywordflow">for</span> each disk.
01518 
01519 Arguments:
01520 
01521     ListHeadArray - pointer to array of pointers to first elements of
01522                     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element lists.
01523 
01524 Return Value:
01525 
01526     None.
01527 
01528 --*/
01529 
01530 {
01531     ULONG i;
01532 
01533     <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>; i++) {
01534 
01535         <a class="code" href="../../d8/d1/fdengine_8c.html#a45">FreeLinkedPartitionList</a>(&amp;ListHeadArray[i]);
01536     }
01537 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="fdengine.c::FreePartitionInfoLinkedLists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreePartitionInfoLinkedLists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ListHeadArray</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="fdengine.c::FreeRegionArray" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeRegionArray           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">1013</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02546">DoesAnyLogicalExist()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02446">DoesAnyPrimaryExist()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02496">DoesExtendedExist()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02272">IsCreationOfExtendedAllowed()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02333">IsCreationOfLogicalAllowed()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02198">IsCreationOfPrimaryAllowed()</a>.
<p>
<pre class="fragment"><div>01020                    :
01021 
01022     This routine frees a region array returned by <a class="code" href="../../d8/d1/fdengine_8c.html#a36">GetDiskRegions</a>().
01023 
01024 Arguments:
01025 
01026     Region          - pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> array of regions to be freed
01027 
01028     RegionCount     - number of items in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Region array
01029 
01030 Return Value:
01031 
01032     None.
01033 
01034 --*/
01035 
01036 {
01037     ULONG i;
01038 
01039     <span class="keywordflow">for</span>(i=0; i&lt;RegionCount; i++) {
01040 
01041         <span class="keywordflow">if</span>(Region[i].Reserved) {
01042             <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(Region[i].Reserved);
01043         }
01044     }
01045     <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(Region);
01046 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="fdengine.c::GetDiskCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG GetDiskCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02587">2587</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00149">ChooseDisk()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00681">ConfigureSystemPartitions()</a>.
<p>
<pre class="fragment"><div>02593                    :
02594 
02595     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of attached partitionable disk
02596     devices.  The returned value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one greater than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum index
02597     allowed <span class="keywordflow">for</span> Disk parameters to partitioning engine <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a>.
02598 
02599 Arguments:
02600 
02601     None.
02602 
02603 Return Value:
02604 
02605     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> of disks.
02606 
02607 --*/
02608 
02609 {
02610     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>);
02611 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="fdengine.c::GetDiskName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR GetDiskName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02615">2615</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00302">CheckIfDiskIsOffLine()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00149">ChooseDisk()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00542">DoSystemPartitionCreate()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00129">IsBootSelectionPartition()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02823">ZapSector()</a>.
<p>
<pre class="fragment"><div>02621                    :
02622 
02623     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system name <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk device whose
02624     index <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> given.
02625 
02626 Arguments:
02627 
02628     Disk - index of disk whose name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> desired.
02629 
02630 Return Value:
02631 
02632     System name <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk device.  The caller must not attempt to
02633     free <span class="keyword">this</span> buffer or modify <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
02634 
02635 --*/
02636 
02637 {
02638     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a3">DiskNames</a>[Disk]);
02639 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="fdengine.c::GetDiskRegions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> GetDiskRegions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantUsedRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantFreeRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantPrimaryRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantLogicalRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT ULONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00780">780</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a175a67">REGION_PRIMARY</a>.
<p>
<pre class="fragment"><div>00792                    :
00793 
00794     This routine returns an array of region descriptors to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
00795     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> region desscriptor describes a space on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk, either used
00796     or free.  The caller can <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> which <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of regions are returned.
00797 
00798     The caller must free <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> returned array via <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>().
00799 
00800 Arguments:
00801 
00802     Disk            - index of disk whose regions are to be returned
00803 
00804     WantUsedRegions - whether to <span class="keywordflow">return</span> used disk regions
00805 
00806     WantFreeRegions - whether to <span class="keywordflow">return</span> free disk regions
00807 
00808     WantPrimaryRegions - whether to <span class="keywordflow">return</span> regions not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00809                          extended partition
00810 
00811     WantLogicalRegions - whether to <span class="keywordflow">return</span> regions within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00812                          extended partition
00813 
00814     Region          - where to put a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> array of regions
00815 
00816     RegionCount     - where to put <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of items in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> returned
00817                       Region array
00818 
00819 Return Value:
00820 
00821     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
00822 
00823 --*/
00824 
00825 {
00826     *Region = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(0);
00827     *RegionCount = 0;
00828 
00829     <span class="keywordflow">if</span>(WantPrimaryRegions) {
00830         <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a16">GetRegions</a>(Disk,
00831                           PrimaryPartitions[Disk],
00832                           WantUsedRegions,
00833                           WantFreeRegions,
00834                           WantLogicalRegions,
00835                           Region,
00836                           RegionCount,
00837                           REGION_PRIMARY
00838                          )
00839               );
00840     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(WantLogicalRegions) {
00841         <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a16">GetRegions</a>(Disk,
00842                           LogicalVolumes[Disk],
00843                           WantUsedRegions,
00844                           WantFreeRegions,
00845                           FALSE,
00846                           Region,
00847                           RegionCount,
00848                           REGION_LOGICAL
00849                          )
00850               );
00851     }
00852     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00853 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="fdengine.c::GetGeometry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> GetGeometry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">342</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00356">_tagDISKGEOM::BytesPerSector</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00353">_tagDISKGEOM::Cylinders</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00354">_tagDISKGEOM::Heads</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00059">LowGetDriveGeometry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00230">SectorSize</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00355">_tagDISKGEOM::SectorsPerTrack</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>.
<p>
<pre class="fragment"><div>00348                    :
00349 
00350     This routine determines disk geometry <span class="keywordflow">for</span> each disk device.
00351     Disk geometry includes heads, sectors per track, cylinder count,
00352     and bytes per sector.  It also includes bytes per track and
00353     bytes per cylinder, which are calculated from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other values
00354     <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> convenience of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> rest of <span class="keyword">this</span> module.
00355 
00356     Geometry information <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a> global variable.
00357 
00358     Geometry information <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> undefined <span class="keywordflow">for</span> an off-line disk.
00359 
00360 Arguments:
00361 
00362     None.
00363 
00364 Return Value:
00365 
00366     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
00367 
00368 --*/
00369 
00370 {
00371     ULONG       i;
00372     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
00373     ULONG       TotalSectorCount,
00374                 <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>,
00375                 SectorsPerTrack,
00376                 Heads;
00377 
00378     <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>; i++) {
00379 
00380         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[i]) {
00381             <span class="keywordflow">continue</span>;
00382         }
00383 
00384         <span class="keywordflow">if</span>((status = <a class="code" href="../../d1/d6/low_8c.html#a11">LowGetDriveGeometry</a>(DiskNames[i],&amp;TotalSectorCount,&amp;SectorSize,&amp;SectorsPerTrack,&amp;Heads)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
00385             <span class="keywordflow">return</span>(status);
00386         }
00387 
00388         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o3">BytesPerSector</a>   = <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>;
00389         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o2">SectorsPerTrack</a>  = SectorsPerTrack;
00390         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o1">Heads</a>            = Heads;
00391         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o0">Cylinders</a>.QuadPart = TotalSectorCount / (SectorsPerTrack * Heads);
00392         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>    = SectorsPerTrack * <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>;
00393         <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[i].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a> = SectorsPerTrack * <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a> * Heads;
00394     }
00395     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00396 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="fdengine.c::GetHiddenSectorCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG GetHiddenSectorCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Partition</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01425">1425</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00356">_tagDISKGEOM::BytesPerSector</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">FindPartitionElement()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01149">IsInLogicalList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01179">IsInPartitionList()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00337">LOWPART</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00355">_tagDISKGEOM::SectorsPerTrack</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00542">DoSystemPartitionCreate()</a>.
<p>
<pre class="fragment"><div>01432                    :
01433 
01434     This routine determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hidden sector count <span class="keywordflow">for</span> a
01435     partition.  This value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used by <a class="code" href="../../d8/d0/rtbatcr_8c.html#a8">format</a> and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed in
01436     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> BPB of a FAT partition when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> formatted.
01437 
01438 Arguments:
01439 
01440     Disk - index of relevent disk
01441 
01442     Partition - partition number of relevent partition
01443 
01444 Return Value:
01445 
01446     The number of hidden sectors (will be 0 <span class="keywordflow">if</span> the partition
01447     does not exist).
01448 
01449 --*/
01450 
01451 {
01452     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p = <a class="code" href="../../d8/d1/fdengine_8c.html#a41">FindPartitionElement</a>(Disk,Partition);
01453     ULONG      HiddenSectorCount = 0;
01454     LARGE_INTEGER   Result;
01455 
01456     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(p);
01457 
01458     <span class="keywordflow">if</span>(p) {
01459 
01460         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a20">IsInLogicalList</a>(Disk,p)) {
01461             HiddenSectorCount = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o2">SectorsPerTrack</a>;
01462         } <span class="keywordflow">else</span> {
01463             <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a21">IsInPartitionList</a>(Disk,p));
01464             Result.QuadPart = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart / <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o3">BytesPerSector</a>;
01465             HiddenSectorCount = <a class="code" href="../../d4/d9/arcinst_8h.html#a25">LOWPART</a>(Result);
01466         }
01467     }
01468     <span class="keywordflow">return</span>(HiddenSectorCount);
01469 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="fdengine.c::GetRegions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> GetRegions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantUsedRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantFreeRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WantLogicalRegions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT ULONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/arcinst_8h.html#a175">REGION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RegionType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">859</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00965">AddRegionEntry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02073">AlignTowardsDiskEnd()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02038">AlignTowardsDiskStart()</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00358">_tagDISKGEOM::BytesPerCylinder</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01972">SIZEMB()</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00780">GetDiskRegions()</a>.
<p>
<pre class="fragment"><div>00869 {
00870     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>   status;
00871     LARGE_INTEGER AlignedOffset,AlignedSize;
00872     ULONG         SizeMB;
00873 
00874     <span class="keywordflow">while</span>(p) {
00875 
00876         <span class="keywordflow">if</span>(p-&gt;SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
00877 
00878             <span class="keywordflow">if</span>(WantFreeRegions) {
00879 
00880                 LARGE_INTEGER   Result1, Result2;
00881 
00882                 AlignedOffset = <a class="code" href="../../d8/d1/fdengine_8c.html#a23">AlignTowardsDiskEnd</a>(p-&gt;Disk,p-&gt;Offset);
00883 
00884                 Result2.QuadPart = p-&gt;Offset.QuadPart + p-&gt;Length.QuadPart;
00885                 Result1 = <a class="code" href="../../d8/d1/fdengine_8c.html#a22">AlignTowardsDiskStart</a>(p-&gt;Disk,Result2);
00886                 AlignedSize.QuadPart   = Result1.QuadPart - AlignedOffset.QuadPart;
00887 
00888                 SizeMB        = <a class="code" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a>(AlignedSize);
00889 
00890 
00891                 <span class="comment">//</span>
00892                 <span class="comment">// Show the space free if it is greater than 1 meg, AND</span>
00893                 <span class="comment">// it is not a space starting at the beginning of the disk</span>
00894                 <span class="comment">// and of length &lt;= 1 cylinder.</span>
00895                 <span class="comment">// This prevents the user from seeing the first cylinder</span>
00896                 <span class="comment">// of the disk as free (could otherwise happen with an</span>
00897                 <span class="comment">// extended partition starting on cylinder 1 and cylinders</span>
00898                 <span class="comment">// of 1 megabyte or larger).</span>
00899                 <span class="comment">//</span>
00900 
00901                 <span class="keywordflow">if</span>(    (AlignedSize.QuadPart &gt; 0)
00902                     &amp;&amp; SizeMB
00903                     &amp;&amp; (    (p-&gt;Offset.QuadPart != 0)
00904                          || ( p-&gt;Length.QuadPart &gt;
00905                               <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[p-&gt;Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o4">BytesPerCylinder</a> )
00906                        )
00907                   )
00908                 {
00909                     <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a37">AddRegionEntry</a>(Region,
00910                                        RegionCount,
00911                                        SizeMB,
00912                                        RegionType,
00913                                        p,
00914                                        AlignedOffset,
00915                                        AlignedSize
00916                                       ))
00917                     {
00918                         <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00919                     }
00920                 }
00921             }
00922         } <span class="keywordflow">else</span> {
00923 
00924             <span class="keywordflow">if</span>(WantUsedRegions) {
00925 
00926                 AlignedOffset = p-&gt;Offset;
00927                 AlignedSize   = p-&gt;Length;
00928                 SizeMB        = <a class="code" href="../../d8/d1/fdengine_8c.html#a50">SIZEMB</a>(AlignedSize);
00929 
00930                 <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a37">AddRegionEntry</a>(Region,
00931                                    RegionCount,
00932                                    SizeMB,
00933                                    RegionType,
00934                                    p,
00935                                    AlignedOffset,
00936                                    AlignedSize
00937                                   ))
00938                 {
00939                     <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
00940                 }
00941             }
00942 
00943             <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;SysID) &amp;&amp; WantLogicalRegions) {
00944                 status = <a class="code" href="../../d8/d1/fdengine_8c.html#a16">GetRegions</a>(Disk,
00945                                     LogicalVolumes[Disk],
00946                                     WantUsedRegions,
00947                                     WantFreeRegions,
00948                                     FALSE,
00949                                     Region,
00950                                     RegionCount,
00951                                     REGION_LOGICAL
00952                                    );
00953                 <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
00954                     <span class="keywordflow">return</span>(status);
00955                 }
00956             }
00957         }
00958         p = p-&gt;Next;
00959     }
00960     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
00961 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="fdengine.c::GetSysIDName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR GetSysIDName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SysID</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02719">2719</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02646">SysIDStrings</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>.
<p>
<pre class="fragment"><div>02725                    :
02726 
02727     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name <span class="keywordflow">for</span> a given system <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>.
02728 
02729 Arguments:
02730 
02731     SysID - system <span class="keywordtype">id</span> in question
02732 
02733 Return Value:
02734 
02735     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> of system <span class="keywordtype">id</span>.  The caller must not attempt to free or
02736     modify <span class="keyword">this</span> buffer.
02737 
02738 --*/
02739 
02740 {
02741     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a10">SysIDStrings</a>[SysID]);
02742 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="fdengine.c::HavePartitionsBeenChanged" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN HavePartitionsBeenChanged           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03121">3121</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>.
<p>
<pre class="fragment"><div>03127                    :
03128 
03129     This routine returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given disk's partition structures
03130     have been modified by adding or deleting partitions, since <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
03131     on-disk structures were last written by a call to <a class="code" href="../../d4/d9/arcinst_8h.html#a158">CommitPartitionChanges</a>
03132     (or first read).
03133 
03134 Arguments:
03135 
03136     Disk - index of disk to check
03137 
03138 Return Value:
03139 
03140     <span class="keyword">true</span> <span class="keywordflow">if</span> Disk's partition structure has changed.
03141 
03142 --*/
03143 
03144 {
03145     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[Disk]) {
03146         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(!ChangesMade[Disk]);
03147     }
03148     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[Disk]);
03149 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="fdengine.c::InitializeFreeSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> InitializeFreeSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>PartitionList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>StartOffset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01607">1607</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01051">AddPartitionToLinkedList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01541">AllocatePartitionStructure()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>.
<p>
<pre class="fragment"><div>01616                    :
01617 
01618     This routine determines all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> free spaces within a given area
01619     on a disk, allocates <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> structures to describe them,
01620     and adds these structures to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> relevent partition list
01621     (primary partitions or logical volumes).
01622 
01623     No rounding or alignment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed here.  Spaces of even one
01624     byte will be counted and inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition list.
01625 
01626 Arguments:
01627 
01628     Disk    - index of disk whose free spaces are being sought.
01629 
01630     PartitionList - pointer to first element on <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> list that
01631                     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> free spaces will go in.
01632 
01633     StartOffset - start offset of area on disk to consider (ie, 0 <span class="keywordflow">for</span>
01634                   primary spaces or the first byte of the extended
01635                   partition <span class="keywordflow">for</span> logical spaces).
01636 
01637     Length - length of area on disk to consider (ie, size of disk
01638              <span class="keywordflow">for</span> primary spaces or size of extended partition <span class="keywordflow">for</span>
01639              logical spaces).
01640 
01641 Return Value:
01642 
01643     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
01644 
01645 --*/
01646 
01647 {
01648     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>              p = *PartitionList,q;
01649     LARGE_INTEGER           <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>,<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
01650 
01651     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> = StartOffset;
01652 
01653     <span class="keywordflow">while</span>(p) {
01654 
01655         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>.QuadPart = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart - <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>.QuadPart;
01656 
01657         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>.QuadPart &gt; 0) {
01658 
01659             <span class="keywordflow">if</span>(!(q = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Disk,
01660                                                 Start,
01661                                                 Size,
01662                                                 SYSID_UNUSED,
01663                                                 FALSE,
01664                                                 FALSE,
01665                                                 FALSE
01666                                                )
01667                 )
01668               )
01669             {
01670                 <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
01671             }
01672 
01673             <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(PartitionList,q);
01674         }
01675 
01676         <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>.QuadPart = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart + p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>.QuadPart;
01677 
01678         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01679 
01680     }
01681 
01682     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>.QuadPart = (StartOffset.QuadPart + Length.QuadPart) - <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>.QuadPart;
01683 
01684     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>.QuadPart &gt; 0) {
01685 
01686         <span class="keywordflow">if</span>(!(q = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Disk,
01687                                             Start,
01688                                             Size,
01689                                             SYSID_UNUSED,
01690                                             FALSE,
01691                                             FALSE,
01692                                             FALSE
01693                                            )
01694             )
01695           )
01696         {
01697             <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
01698         }
01699 
01700         <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(PartitionList,q);
01701     }
01702 
01703     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
01704 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="fdengine.c::InitializeLogicalVolumeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> InitializeLogicalVolumeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PDRIVE_LAYOUT_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>DriveLayout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PartitionNumber</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">1708</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01051">AddPartitionToLinkedList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01541">AllocatePartitionStructure()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00356">_tagDISKGEOM::BytesPerSector</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01473">FreeLinkedPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01607">InitializeFreeSpace()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00384">_tagPARTITION::OriginalPartitionNumber</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>.
<p>
<pre class="fragment"><div>01716                    :
01717 
01718     This routine creates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> logical volume linked list of
01719     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> structures <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given disk.
01720 
01721 Arguments:
01722 
01723     Disk    - index of disk
01724 
01725     DriveLayout - pointer to structure describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> raw partition
01726                   layout of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
01727 
01728     PartitionNumber - number to assign to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first logical volume
01729                       on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
01730 
01731 Return Value:
01732 
01733     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
01734 
01735 --*/
01736 
01737 {
01738     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>             p,q;
01739     ULONG                   i,j;
01740     PPARTITION_INFORMATION d;
01741     LARGE_INTEGER          HiddenBytes;
01742     ULONG                  BytesPerSector = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o3">BytesPerSector</a>;
01743     LARGE_INTEGER          Result1, Result2;
01744 
01745     <a class="code" href="../../d8/d1/fdengine_8c.html#a45">FreeLinkedPartitionList</a>(&amp;LogicalVolumes[Disk]);
01746 
01747     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Disk];
01748     <span class="keywordflow">while</span>(p) {
01749         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>)) {
01750             <span class="keywordflow">break</span>;
01751         }
01752         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01753     }
01754 
01755     <span class="keywordflow">if</span>(p) {
01756         <span class="keywordflow">for</span>(i=<a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>; i&lt;DriveLayout-&gt;PartitionCount; i+=<a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>) {
01757 
01758             <span class="keywordflow">for</span>(j=i; j&lt;i+<a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>; j++) {
01759 
01760                 d = &amp;DriveLayout-&gt;PartitionEntry[j];
01761 
01762                 <span class="keywordflow">if</span>((d-&gt;PartitionType != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) &amp;&amp; (d-&gt;PartitionType != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>)) {
01763 
01764                     HiddenBytes.QuadPart = UInt32x32To64(d-&gt;HiddenSectors,BytesPerSector);
01765 
01766                     Result1.QuadPart = d-&gt;StartingOffset.QuadPart - HiddenBytes.QuadPart;
01767                     Result2.QuadPart = d-&gt;PartitionLength.QuadPart + HiddenBytes.QuadPart;
01768                     <span class="keywordflow">if</span>(!(q = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Disk,
01769                                                         Result1,
01770                                                         Result2,
01771                                                         d-&gt;PartitionType,
01772                                                         FALSE,
01773                                                         d-&gt;BootIndicator,
01774                                                         d-&gt;RecognizedPartition
01775                                                        )
01776                         )
01777                       )
01778                     {
01779                         <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
01780                     }
01781 
01782                     q-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = PartitionNumber++;
01783                     <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(&amp;LogicalVolumes[Disk],q);
01784 
01785                     <span class="keywordflow">break</span>;
01786                 }
01787             }
01788         }
01789         <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a47">InitializeFreeSpace</a>(Disk,
01790                                    &amp;LogicalVolumes[Disk],
01791                                    p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>,
01792                                    p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>
01793                                   )
01794               );
01795     }
01796     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
01797 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="fdengine.c::InitializePartitionLists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> InitializePartitionLists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">1882</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">CountOfDisks</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00812">LowGetDiskLayout()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>.
<p>
<pre class="fragment"><div>01888                    :
01889 
01890     This routine scans <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> PARTITION_INFO array returned <span class="keywordflow">for</span> each disk
01891     by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OS.  <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> linked list of <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> structures <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> layered on top
01892     of each array;  <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> net result <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a sorted list that covers an entire
01893     disk, because free spaces are also factored in as '<a class="code" href="../../d0/d2/config_2test_2init386_8c.html#a0">dummy</a>' partitions.
01894 
01895 Arguments:
01896 
01897     None.
01898 
01899 Return Value:
01900 
01901     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
01902 
01903 --*/
01904 
01905 {
01906     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>               status;
01907     ULONG                     Disk;
01908     PDRIVE_LAYOUT_INFORMATION DriveLayout;
01909     ULONG                     PNum;
01910 
01911 
01912     <span class="keywordflow">for</span>(Disk=0; Disk&lt;<a class="code" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>; Disk++) {
01913 
01914         <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[Disk]) {
01915             <span class="keywordflow">continue</span>;
01916         }
01917 
01918         <span class="keywordflow">if</span>((status = <a class="code" href="../../d1/d6/low_8c.html#a23">LowGetDiskLayout</a>(DiskNames[Disk],&amp;DriveLayout)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
01919             <span class="keywordflow">return</span>(status);
01920         }
01921 
01922         <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a49">InitializePrimaryPartitionList</a>(Disk,DriveLayout,&amp;PNum)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
01923             <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
01924             <span class="keywordflow">return</span>(status);
01925         }
01926         <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a48">InitializeLogicalVolumeList</a>(Disk,DriveLayout,PNum)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
01927             <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
01928             <span class="keywordflow">return</span>(status);
01929         }
01930 
01931         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
01932         <a class="code" href="../../d8/d1/fdengine_8c.html#a40">RenumberPartitions</a>(Disk);
01933     }
01934     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
01935 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="fdengine.c::InitializePrimaryPartitionList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> InitializePrimaryPartitionList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PDRIVE_LAYOUT_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>DriveLayout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NextPartitionNumber</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">1801</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01051">AddPartitionToLinkedList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01541">AllocatePartitionStructure()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01940">DiskLengthBytes()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01473">FreeLinkedPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01607">InitializeFreeSpace()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00384">_tagPARTITION::OriginalPartitionNumber</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>.
<p>
<pre class="fragment"><div>01809                    :
01810 
01811     This routine creates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> primary partition linked list of
01812     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> structures <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given disk.
01813 
01814 Arguments:
01815 
01816     Disk    - index of disk
01817 
01818     DriveLayout - pointer to structure describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> raw partition
01819                   layout of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.
01820 
01821     NextPartitionNumber - where to put partition number that should be
01822                           assigned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first logical volume on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01823                           disk.
01824 
01825 Return Value:
01826 
01827     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
01828 
01829 --*/
01830 
01831 {
01832     ULONG                  i;
01833     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>             p;
01834     PPARTITION_INFORMATION d;
01835     ULONG                  PartitionNumber = 1;
01836     LARGE_INTEGER          LargeZero;
01837 
01838     <a class="code" href="../../d8/d1/fdengine_8c.html#a45">FreeLinkedPartitionList</a>(&amp;PrimaryPartitions[Disk]);
01839 
01840     <span class="keywordflow">if</span>(DriveLayout-&gt;PartitionCount &gt;= <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>) {
01841 
01842         <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>; i++) {
01843 
01844             d = &amp;DriveLayout-&gt;PartitionEntry[i];
01845 
01846             <span class="keywordflow">if</span>(d-&gt;PartitionType != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
01847 
01848                 <span class="keywordflow">if</span>(!(p = <a class="code" href="../../d8/d1/fdengine_8c.html#a29">AllocatePartitionStructure</a>(Disk,
01849                                                     d-&gt;StartingOffset,
01850                                                     d-&gt;PartitionLength,
01851                                                     d-&gt;PartitionType,
01852                                                     FALSE,
01853                                                     d-&gt;BootIndicator,
01854                                                     d-&gt;RecognizedPartition
01855                                                    )
01856                     )
01857                   )
01858                 {
01859                     <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
01860                 }
01861 
01862                 p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o5">OriginalPartitionNumber</a> = <a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>)
01863                                            ? 0
01864                                            : PartitionNumber++;
01865 
01866                 <a class="code" href="../../d8/d1/fdengine_8c.html#a39">AddPartitionToLinkedList</a>(&amp;PrimaryPartitions[Disk],p);
01867             }
01868         }
01869     }
01870     *NextPartitionNumber = PartitionNumber;
01871     LargeZero.QuadPart = 0;
01872     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a47">InitializeFreeSpace</a>(Disk,
01873                                &amp;PrimaryPartitions[Disk],
01874                                LargeZero,
01875                                <a class="code" href="../../d8/d1/fdengine_8c.html#a28">DiskLengthBytes</a>(Disk)
01876                               )
01877           );
01878 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="fdengine.c::IsAnyCreationAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> IsAnyCreationAllowed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowMultiplePrimaries</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AnyAllowed</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>PrimaryAllowed</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ExtendedAllowed</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalAllowed</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02141">2141</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02272">IsCreationOfExtendedAllowed()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02333">IsCreationOfLogicalAllowed()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02198">IsCreationOfPrimaryAllowed()</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00224">DoPartitionCreate()</a>.
<p>
<pre class="fragment"><div>02152                    :
02153 
02154     This routine determines whether any partition may be created on a
02155     given disk, based on three sub-queries -- whether creation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02156     of a primary partition, an extended partition, or a logical volume.
02157 
02158 Arguments:
02159 
02160     Disk            - index of disk to check
02161 
02162     AllowMultiplePrimaries - whether to allow multiple primary partitions
02163 
02164     AnyAllowed - returns whether any creation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02165 
02166     PrimaryAllowed - returns whether creation of a primary partition
02167                      <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02168 
02169     ExtendedAllowed - returns whether creation of an extended partition
02170                       <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02171 
02172     Logical Allowed - returns whether creation of a logical volume <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed.
02173 
02174 Return Value:
02175 
02176     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02177 
02178 --*/
02179 
02180 {
02181     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
02182 
02183     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a54">IsCreationOfPrimaryAllowed</a>(Disk,AllowMultiplePrimaries,PrimaryAllowed)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02184         <span class="keywordflow">return</span>(status);
02185     }
02186     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a55">IsCreationOfExtendedAllowed</a>(Disk,ExtendedAllowed)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02187         <span class="keywordflow">return</span>(status);
02188     }
02189     <span class="keywordflow">if</span>((status = <a class="code" href="../../d8/d1/fdengine_8c.html#a56">IsCreationOfLogicalAllowed</a>(Disk,LogicalAllowed)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02190         <span class="keywordflow">return</span>(status);
02191     }
02192     *AnyAllowed = (BOOLEAN)(*PrimaryAllowed || *ExtendedAllowed || *LogicalAllowed);
02193     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02194 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="fdengine.c::IsCreationOfExtendedAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> IsCreationOfExtendedAllowed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Allowed</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02272">2272</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00605">GetPrimaryDiskRegions</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00566">_tagREGION_DESCRIPTOR::SysID</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02141">IsAnyCreationAllowed()</a>.
<p>
<pre class="fragment"><div>02279                    :
02280 
02281     This routine determines whether creation of an extended partition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02282     allowed.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">true</span> when there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a free entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MBR,
02283     there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> free primary space on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk, and there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no existing
02284     extended partition.
02285 
02286 Arguments:
02287 
02288     Disk            - index of disk to check
02289 
02290     Allowed - returns whether creation of an extended partition
02291               <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02292 
02293 Return Value:
02294 
02295     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02296 
02297 --*/
02298 
02299 {
02300     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02301     ULONG              RegionCount;
02302     ULONG              UsedCount,FreeCount,i;
02303     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02304 
02305     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a32">GetPrimaryDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02306     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02307         <span class="keywordflow">return</span>(status);
02308     }
02309 
02310     <span class="keywordflow">for</span>(UsedCount = FreeCount = i = 0; i&lt;RegionCount; i++) {
02311         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].RegionType != REGION_LOGICAL);
02312         <span class="keywordflow">if</span>(Regions[i].<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o8">SysID</a> == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
02313             <span class="comment">// BUGBUG should adjust the size here and see if it's non0 first</span>
02314             <span class="comment">// (ie, take into account that the extended partition can't</span>
02315             <span class="comment">// start on cyl 0).</span>
02316             FreeCount++;
02317         } <span class="keywordflow">else</span> {
02318             UsedCount++;
02319             <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(Regions[i].SysID)) {
02320                 <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02321                 *Allowed = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02322                 <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02323             }
02324         }
02325     }
02326     *Allowed = (BOOLEAN)((UsedCount &lt; <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>) &amp;&amp; FreeCount);
02327     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02328     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02329 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="fdengine.c::IsCreationOfLogicalAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> IsCreationOfLogicalAllowed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Allowed</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02333">2333</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02496">DoesExtendedExist()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00608">GetLogicalDiskRegions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00566">_tagREGION_DESCRIPTOR::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02141">IsAnyCreationAllowed()</a>.
<p>
<pre class="fragment"><div>02340                    :
02341 
02342     This routine determines whether creation of a logical volume <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02343     allowed.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">true</span> when there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> an extended partition and
02344     free space within <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
02345 
02346 Arguments:
02347 
02348     Disk            - index of disk to check
02349 
02350     Allowed - returns whether creation of a logical volume <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02351 
02352 Return Value:
02353 
02354     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02355 
02356 --*/
02357 
02358 {
02359     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02360     ULONG              RegionCount;
02361     ULONG              i;
02362     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02363     BOOLEAN            ExtendedExists;
02364 
02365     *Allowed = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02366 
02367     status = <a class="code" href="../../d8/d1/fdengine_8c.html#a59">DoesExtendedExist</a>(Disk,&amp;ExtendedExists);
02368     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02369         <span class="keywordflow">return</span>(status);
02370     }
02371     <span class="keywordflow">if</span>(!ExtendedExists) {
02372         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02373     }
02374 
02375     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a33">GetLogicalDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02376     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02377         <span class="keywordflow">return</span>(status);
02378     }
02379 
02380     <span class="keywordflow">for</span>(i = 0; i&lt;RegionCount; i++) {
02381         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].RegionType == REGION_LOGICAL);
02382         <span class="keywordflow">if</span>(Regions[i].<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o8">SysID</a> == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
02383             *Allowed = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02384             <span class="keywordflow">break</span>;
02385         }
02386     }
02387     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02388     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02389 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="fdengine.c::IsCreationOfPrimaryAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> IsCreationOfPrimaryAllowed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowMultiplePrimaries</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT BOOLEAN *&nbsp;</td>
          <td class="mdname" nowrap> <em>Allowed</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02198">2198</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01013">FreeRegionArray()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00605">GetPrimaryDiskRegions</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00565">_tagREGION_DESCRIPTOR::Recognized</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a175a69">REGION_LOGICAL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00566">_tagREGION_DESCRIPTOR::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02141">IsAnyCreationAllowed()</a>.
<p>
<pre class="fragment"><div>02206                    :
02207 
02208     This routine determines whether creation of a primary partition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02209     allowed.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">true</span> when there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a free entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MBR and
02210     there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> free primary space on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk.  If multiple primaries
02211     are not allowed, then there must also not exist any primary partitions
02212     in order <span class="keywordflow">for</span> a primary creation to be allowed.
02213 
02214 Arguments:
02215 
02216     Disk            - index of disk to check
02217 
02218     AllowMultiplePrimaries - whether existnace of primary partition
02219                              disallows creation of a primary partition
02220 
02221     Allowed - returns whether creation of a primary partition
02222               <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allowed
02223 
02224 Return Value:
02225 
02226     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code
02227 
02228 --*/
02229 
02230 {
02231     <a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a> Regions;
02232     ULONG              RegionCount;
02233     ULONG              UsedCount,RecogCount,i;
02234     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>        status;
02235     BOOLEAN            FreeSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02236 
02237     status = <a class="code" href="../../d4/d9/arcinst_8h.html#a32">GetPrimaryDiskRegions</a>(Disk,&amp;Regions,&amp;RegionCount);
02238     <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02239         <span class="keywordflow">return</span>(status);
02240     }
02241 
02242     <span class="keywordflow">for</span>(UsedCount = RecogCount = i = 0; i&lt;RegionCount; i++) {
02243         <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(Regions[i].RegionType != REGION_LOGICAL);
02244         <span class="keywordflow">if</span>(Regions[i].<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o8">SysID</a> == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
02245             FreeSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02246         } <span class="keywordflow">else</span> {
02247             UsedCount++;
02248             <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(Regions[i].SysID) &amp;&amp; Regions[i].<a class="code" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html#o7">Recognized</a>) {
02249                 RecogCount++;
02250             }
02251         }
02252     }
02253     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(UsedCount &lt;= ENTRIES_PER_BOOTSECTOR);
02254     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(RecogCount &lt;= ENTRIES_PER_BOOTSECTOR);
02255     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(RecogCount &lt;= UsedCount);
02256 
02257     <span class="keywordflow">if</span>((UsedCount &lt; <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>)
02258     &amp;&amp; FreeSpace
02259     &amp;&amp; (!RecogCount || AllowMultiplePrimaries))
02260     {
02261         *Allowed = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02262     } <span class="keywordflow">else</span> {
02263         *Allowed = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02264     }
02265 
02266     <a class="code" href="../../d8/d1/fdengine_8c.html#a38">FreeRegionArray</a>(Regions,RegionCount);
02267     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>);
02268 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="fdengine.c::IsDiskOffLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsDiskOffLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03389">3389</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">OffLine</a>.
<p>
<pre class="fragment"><div>03392 {
03393     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>[Disk]);
03394 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="fdengine.c::IsExtended" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsExtended           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN UCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SysID</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">2114</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02446">DoesAnyPrimaryExist()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02496">DoesExtendedExist()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00409">DoPartitionDelete()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">FindPartitionElement()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02272">IsCreationOfExtendedAllowed()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02198">IsCreationOfPrimaryAllowed()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.
<p>
<pre class="fragment"><div>02120                    :
02121 
02122     This routine determines whether a given system <span class="keywordtype">id</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keywordflow">for</span> an
02123     extended <a class="code" href="../../d4/d4/iafptrap_8c.html#a9">type</a> (ie, link) entry.
02124 
02125 Arguments:
02126 
02127     SysID - system <span class="keywordtype">id</span> to be tested.
02128 
02129 Return Value:
02130 
02131     true/false based on whether SysID is for an extended type.
02132 
02133 --*/
02134 
02135 {
02136     <span class="keywordflow">return</span>((BOOLEAN)(SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>));
02137 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="fdengine.c::IsInLinkedList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsInLinkedList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>List</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01113">1113</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00094">List</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01149">IsInLogicalList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01179">IsInPartitionList()</a>.
<p>
<pre class="fragment"><div>01120                    :
01121 
01122     This routine determines whether a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in
01123     a given linked list of <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> elements.
01124 
01125 Arguments:
01126 
01127     p       - pointer to element to be checked <span class="keywordflow">for</span>
01128 
01129     <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>    - first element in list to be scanned
01130 
01131 Return Value:
01132 
01133     <span class="keyword">true</span> <span class="keywordflow">if</span> p found in <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>, <span class="keyword">false</span> otherwise
01134 
01135 --*/
01136 
01137 {
01138     <span class="keywordflow">while</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>) {
01139         <span class="keywordflow">if</span>(p == <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>) {
01140             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01141         }
01142         <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>-&gt;Next;
01143     }
01144     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01145 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="fdengine.c::IsInLogicalList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsInLogicalList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01149">1149</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01113">IsInLinkedList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01425">GetHiddenSectorCount()</a>.
<p>
<pre class="fragment"><div>01156                    :
01157 
01158     This routine determines whether a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in
01159     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> logical volume list <span class="keywordflow">for</span> a given disk.
01160 
01161 Arguments:
01162 
01163     Disk    - index of disk to be checked
01164 
01165     p       - pointer to element to be checked <span class="keywordflow">for</span>
01166 
01167 Return Value:
01168 
01169     <span class="keyword">true</span> <span class="keywordflow">if</span> p found in Disk's logical volume list, <span class="keyword">false</span> otherwise
01170 
01171 --*/
01172 
01173 {
01174     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a19">IsInLinkedList</a>(p,LogicalVolumes[Disk]));
01175 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="fdengine.c::IsInPartitionList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsInPartitionList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01179">1179</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01113">IsInLinkedList()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01425">GetHiddenSectorCount()</a>.
<p>
<pre class="fragment"><div>01186                    :
01187 
01188     This routine determines whether a <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in
01189     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> primary partition list <span class="keywordflow">for</span> a given disk.
01190 
01191 Arguments:
01192 
01193     Disk    - index of disk to be checked
01194 
01195     p       - pointer to element to be checked <span class="keywordflow">for</span>
01196 
01197 Return Value:
01198 
01199     <span class="keyword">true</span> <span class="keywordflow">if</span> p found in Disk's primary partition list, <span class="keyword">false</span> otherwise
01200 
01201 --*/
01202 
01203 {
01204     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a19">IsInLinkedList</a>(p,PrimaryPartitions[Disk]));
01205 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="fdengine.c::MakeBootRec" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER MakeBootRec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PPARTITION_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>pinfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pLogical</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pNextLogical</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02771">2771</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00388">_tagPARTITION::Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00359">_tagDISKGEOM::BytesPerTrack</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00355">_tagDISKGEOM::SectorsPerTrack</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02748">UnusedEntryFill()</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.
<p>
<pre class="fragment"><div>02777 {
02778     ULONG         Entry = 0;
02779     LARGE_INTEGER BytesPerTrack;
02780     LARGE_INTEGER SectorsPerTrack;
02781     LARGE_INTEGER StartingOffset;
02782 
02783     BytesPerTrack.QuadPart = (<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o5">BytesPerTrack</a>);
02784     SectorsPerTrack.QuadPart = (<a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o2">SectorsPerTrack</a>);
02785     StartingOffset.QuadPart = 0;
02786 
02787 <span class="comment">//  ASRT(pLogical || pNextLogical);</span>
02788 
02789     <span class="keywordflow">if</span>(pLogical) {
02790 
02791         pinfo[Entry].StartingOffset.QuadPart   = pLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart + BytesPerTrack.QuadPart;
02792         pinfo[Entry].PartitionLength.QuadPart  = pLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>.QuadPart - BytesPerTrack.QuadPart;
02793         pinfo[Entry].HiddenSectors    = SectorsPerTrack.LowPart;
02794         pinfo[Entry].RewritePartition = pLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a>;
02795         pinfo[Entry].BootIndicator    = pLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o9">Active</a>;
02796         pinfo[Entry].PartitionType    = pLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>;
02797 
02798         <span class="keywordflow">if</span>(pinfo[Entry].RewritePartition) {
02799             StartingOffset = pinfo[Entry].StartingOffset;
02800         }
02801 
02802         Entry++;
02803     }
02804 
02805     <span class="keywordflow">if</span>(pNextLogical) {
02806 
02807         pinfo[Entry].StartingOffset   = pNextLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>;
02808         pinfo[Entry].PartitionLength  = pNextLogical-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>;
02809         pinfo[Entry].HiddenSectors    = 0;
02810         pinfo[Entry].RewritePartition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02811         pinfo[Entry].BootIndicator    = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02812         pinfo[Entry].PartitionType    = <a class="code" href="../../d4/d9/arcinst_8h.html#a176a71">SYSID_EXTENDED</a>;
02813 
02814         Entry++;
02815     }
02816 
02817     <a class="code" href="../../d8/d1/fdengine_8c.html#a64">UnusedEntryFill</a>(pinfo+Entry,ENTRIES_PER_BOOTSECTOR-Entry);
02818     <span class="keywordflow">return</span>(StartingOffset);
02819 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="fdengine.c::MergeFreePartitions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MergeFreePartitions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01209">1209</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00380">_tagPARTITION::Prev</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>.
<p>
<pre class="fragment"><div>01215                    :
01216 
01217     This routine merges adjacent free space elements in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01218     given linked list of <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> elements.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> designed
01219     to be called after adding or deleting a partition.
01220 
01221 Arguments:
01222 
01223     p - pointer to first item in list whose free elements are to
01224         be merged.
01225 
01226 Return Value:
01227 
01228     None.
01229 
01230 --*/
01231 
01232 {
01233     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> next;
01234 
01235     <span class="keywordflow">while</span>(p &amp;&amp; p-&gt;Next) {
01236 
01237         <span class="keywordflow">if</span>((p-&gt;SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) &amp;&amp; (p-&gt;Next-&gt;SysID == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>)) {
01238 
01239             next = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01240 
01241             p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>.QuadPart = (next-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>.QuadPart + next-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>.QuadPart) - p-&gt;Offset.QuadPart;
01242 
01243             <span class="keywordflow">if</span>(p-&gt;Next = next-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>) {
01244                 next-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o1">Prev</a> = p;
01245             }
01246 
01247             <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(next);
01248 
01249         } <span class="keywordflow">else</span> {
01250             p = p-&gt;Next;
01251         }
01252     }
01253 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="fdengine.c::OpenDisks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> OpenDisks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="fdengine.c::RenumberPartitions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RenumberPartitions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">1257</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00385">_tagPARTITION::PartitionNumber</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, and <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>.
<p>
<pre class="fragment"><div>01263                    :
01264 
01265     This routine determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition number <span class="keywordflow">for</span> each region
01266     on a disk.  For a used region, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition number <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number
01267     that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system will assign to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition.  All partitions
01268     (except <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> extended partition) are numbered first starting at 1,
01269     and then all logical volumes in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> extended partition.
01270     For a free region, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition number <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01271     system WOULD assign to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> space were to be
01272     converted to a partition and all other regions on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk were
01273     left as <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>.
01274 
01275     The partition numbers are stored in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> elements.
01276 
01277 Arguments:
01278 
01279     Disk - index of disk whose partitions are to be renumbered.
01280 
01281 Return Value:
01282 
01283     None.
01284 
01285 --*/
01286 
01287 {
01288     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p = <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Disk];
01289     ULONG      <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = 1;
01290 
01291     <span class="keywordflow">while</span>(p) {
01292         <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>)) {
01293             p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a> = <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01294             <span class="keywordflow">if</span>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
01295                 <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>++;
01296             }
01297         }
01298         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01299     }
01300     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Disk];
01301     <span class="keywordflow">while</span>(p) {
01302         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o6">PartitionNumber</a> = <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01303         <span class="keywordflow">if</span>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
01304             <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>++;
01305         }
01306         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
01307     }
01308 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="fdengine.c::RenumberPartitions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RenumberPartitions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="fdengine.c::SetSysID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetSysID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Partition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SysID</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01366">1366</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00055">CHANGED_DONT_ZAP</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00383">_tagPARTITION::Disk</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">FindPartitionElement()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/partit_8c-source.html#l00573">DoMakePartitionSystemPartition()</a>, and <a class="el" href="../../d8/d2/partit_8c-source.html#l00542">DoSystemPartitionCreate()</a>.
<p>
<pre class="fragment"><div>01374                    :
01375 
01376     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system <span class="keywordtype">id</span> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given partition
01377     on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> given disk.
01378 
01379 Arguments:
01380 
01381     Disk - index of relevent disk
01382 
01383     Partition - partition number of relevent partition
01384 
01385     SysID - <span class="keyword">new</span> system <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> <span class="keywordflow">for</span> Partition on Disk
01386 
01387 Return Value:
01388 
01389     None.
01390 
01391 --*/
01392 
01393 {
01394     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p = <a class="code" href="../../d8/d1/fdengine_8c.html#a41">FindPartitionElement</a>(Disk,Partition);
01395 
01396     <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(p);
01397 
01398     <span class="keywordflow">if</span>(p) {
01399         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> = SysID;
01400         <span class="keywordflow">if</span>(!p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a>) {
01401             p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d8/d1/fdengine_8c.html#a1">CHANGED_DONT_ZAP</a>;
01402         }
01403         <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o4">Disk</a>] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01404     }
01405 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="fdengine.c::SetSysID2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetSysID2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__tagREGION__DESCRIPTOR.html">PREGION_DESCRIPTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Region</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SysID</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01409">1409</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00055">CHANGED_DONT_ZAP</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">ChangesMade</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00383">_tagPARTITION::Disk</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>.
<p>
<pre class="fragment"><div>01413 {
01414     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> p = ((<a class="code" href="../../d3/d9/struct__tagREGION__DATA.html">PREGION_DATA</a>)(Region-&gt;Reserved))-&gt;Partition;
01415 
01416     p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> = SysID;
01417     <span class="keywordflow">if</span>(!p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a>) {
01418         p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> = <a class="code" href="../../d8/d1/fdengine_8c.html#a1">CHANGED_DONT_ZAP</a>;
01419     }
01420     <a class="code" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>[p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o4">Disk</a>] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01421 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="fdengine.c::SIZEMB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG SIZEMB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ByteCount</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01972">1972</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00339">ONE_MEG</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02011">DiskSizeMB()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03203">FdGetMaximumSizeMB()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03172">FdGetMinimumSizeMB()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>.
<p>
<pre class="fragment"><div>01978                    :
01979 
01980     Calculate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size in megabytes of a given byte count. The value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01981     properly rounded (ie, not merely truncated).
01982 
01983     This function replaces a macro of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same name that was truncating
01984     instead of rounding.
01985 
01986 Arguments:
01987 
01988     ByteCount - supplies number of bytes
01989 
01990 Return Value:
01991 
01992     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> in MB equivalent to ByteCount.
01993 
01994 --*/
01995 
01996 {
01997     ULONG Remainder;
01998     ULONG SizeMB;
01999 
02000     SizeMB = (ULONG)((ULONGLONG)ByteCount.QuadPart / (ULONGLONG)<a class="code" href="../../d4/d9/arcinst_8h.html#a26">ONE_MEG</a>);
02001     Remainder = (ULONG)((ULONGLONG)ByteCount.QuadPart % (ULONGLONG)<a class="code" href="../../d4/d9/arcinst_8h.html#a26">ONE_MEG</a>);
02002 
02003     <span class="keywordflow">if</span>(Remainder &gt;= <a class="code" href="../../d4/d9/arcinst_8h.html#a26">ONE_MEG</a>/2) {
02004         SizeMB++;
02005     }
02006 
02007     <span class="keywordflow">return</span>(SizeMB);
02008 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="fdengine.c::UnusedEntryFill" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UnusedEntryFill           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PPARTITION_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>pinfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>EntryCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02748">2748</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d5/ttime_8c-source.html#l00031">Zero</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02771">MakeBootRec()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.
<p>
<pre class="fragment"><div>02752 {
02753     ULONG         i;
02754     LARGE_INTEGER <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a>;
02755 
02756     <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a>.QuadPart = 0;
02757 
02758     <span class="keywordflow">for</span>(i=0; i&lt;EntryCount; i++) {
02759 
02760         pinfo[i].StartingOffset   = <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a>;
02761         pinfo[i].PartitionLength  = <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a>;
02762         pinfo[i].HiddenSectors    = 0;
02763         pinfo[i].PartitionType    = <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>;
02764         pinfo[i].BootIndicator    = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02765         pinfo[i].RewritePartition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02766     }
02767 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="fdengine.c::WriteDriveLayout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> WriteDriveLayout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Disk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">2886</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00388">_tagPARTITION::Active</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00411">ASRT</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00055">CHANGED_DONT_ZAP</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">DiskNames</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00346">ENTRIES_PER_BOOTSECTOR</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02114">IsExtended()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00382">_tagPARTITION::Length</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">LogicalVolumes</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l01076">LowSetDiskLayout()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02771">MakeBootRec()</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00379">_tagPARTITION::Next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00381">_tagPARTITION::Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">PrimaryPartitions</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00390">_tagPARTITION::SysID</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02748">UnusedEntryFill()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00387">_tagPARTITION::Update</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02823">ZapSector()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>.
<p>
<pre class="fragment"><div>02892                    :
02893 
02894     This routine writes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current partition layout <span class="keywordflow">for</span> a given disk
02895     <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> to disk.  The <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a>-level <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PARTITION</a> lists are transformed into
02896     a DRIVE_LAYOUT_INFORMATION structure before being passed down
02897     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a>-level partition table writing routine.
02898 
02899 Arguments:
02900 
02901     Disk - index of disk whose on-disk partition structure <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be updated.
02902 
02903 Return Value:
02904 
02905     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
02906 
02907 --*/
02908 
02909 {
02910     PDRIVE_LAYOUT_INFORMATION DriveLayout;
02911     PPARTITION_INFORMATION    pinfo;
02912     <a class="code" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>                <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>,p;
02913     ULONG                     EntryCount;
02914     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a>               status;
02915     LARGE_INTEGER             StartingOffset;
02916     LARGE_INTEGER             ExtendedStartingOffset;
02917 
02918     ExtendedStartingOffset.QuadPart = 0;
02919 
02920     <span class="comment">// allocate a huge buffer now to avoid complicated dynamic</span>
02921     <span class="comment">// reallocation schemes later.</span>
02922 
02923     <span class="keywordflow">if</span>(!(DriveLayout = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(250 * <span class="keyword">sizeof</span>(PARTITION_INFORMATION)))) {
02924         <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
02925     }
02926 
02927     pinfo = &amp;DriveLayout-&gt;PartitionEntry[0];
02928 
02929     <span class="comment">// first do the mbr.</span>
02930 
02931     EntryCount=0;
02932     p = <a class="code" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>[Disk];
02933 
02934     <span class="keywordflow">while</span>(p) {
02935 
02936         <span class="keywordflow">if</span>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
02937 
02938             <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(EntryCount &lt; ENTRIES_PER_BOOTSECTOR);
02939 
02940             <span class="keywordflow">if</span>(<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>)) {
02941                 ExtendedStartingOffset = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>;
02942             }
02943 
02944             pinfo[EntryCount].StartingOffset   = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o2">Offset</a>;
02945             pinfo[EntryCount].PartitionLength  = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o3">Length</a>;
02946             pinfo[EntryCount].PartitionType    = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a>;
02947             pinfo[EntryCount].BootIndicator    = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o9">Active</a>;
02948             pinfo[EntryCount].RewritePartition = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a>;
02949 
02950             <span class="comment">// BUGBUG we know that this field is not used by the</span>
02951             <span class="comment">//        set drive layout IOCTL or the ARC stub.</span>
02952 
02953             pinfo[EntryCount].HiddenSectors    = 0;
02954 
02955             <span class="comment">// if we're creating this partition, clear out the</span>
02956             <span class="comment">// filesystem boot sector.</span>
02957 
02958             <span class="keywordflow">if</span>(pinfo[EntryCount].RewritePartition
02959             &amp;&amp; (p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> != <a class="code" href="../../d8/d1/fdengine_8c.html#a1">CHANGED_DONT_ZAP</a>)
02960             &amp;&amp; !<a class="code" href="../../d8/d1/fdengine_8c.html#a52">IsExtended</a>(pinfo[EntryCount].PartitionType))
02961             {
02962                 status = <a class="code" href="../../d8/d1/fdengine_8c.html#a66">ZapSector</a>(Disk,pinfo[EntryCount].StartingOffset);
02963                 <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02964                     <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
02965                     <span class="keywordflow">return</span>(status);
02966                 }
02967             }
02968 
02969             EntryCount++;
02970         }
02971         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
02972     }
02973 
02974     <span class="comment">// fill the remainder of the MBR with unused entries.</span>
02975     <span class="comment">// NOTE that there will thus always be an MBR even if there</span>
02976     <span class="comment">// are no partitions defined.</span>
02977 
02978     <a class="code" href="../../d8/d1/fdengine_8c.html#a64">UnusedEntryFill</a>(pinfo+EntryCount,ENTRIES_PER_BOOTSECTOR - EntryCount);
02979     EntryCount = <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>;
02980 
02981     <span class="comment">//</span>
02982     <span class="comment">// now handle the logical volumes.</span>
02983     <span class="comment">// first check to see whether we need a dummy EBR at the beginning</span>
02984     <span class="comment">// of the extended partition.  This is the case when there is</span>
02985     <span class="comment">// free space at the beginning of the extended partition.</span>
02986 <span class="preprocessor">#if 0</span>
02987 <span class="preprocessor"></span>    <span class="comment">// Also handle the case where we are creating an empty extended</span>
02988     <span class="comment">// partition -- need to zap the first sector to eliminate any residue</span>
02989     <span class="comment">// that might start an EBR chain.</span>
02990 <span class="preprocessor">#else</span>
02991 <span class="preprocessor"></span>    <span class="comment">// BUGBUG 4/24/92 tedm:  Currently the io subsystem returns an error</span>
02992     <span class="comment">// status (status_bad_master_boot_record) if any mbr or ebr is bad.</span>
02993     <span class="comment">// Zeroing the first sector of the extended partition therefore causes</span>
02994     <span class="comment">// the whole disk to be seen as empty.  So create a blank, but valid,</span>
02995     <span class="comment">// EBR in the 'empty extended partition' case.  Code is in the 'else'</span>
02996     <span class="comment">// part of the #if 0, below.</span>
02997 <span class="preprocessor">#endif</span>
02998 <span class="preprocessor"></span>    <span class="comment">//</span>
02999 
03000     <span class="keywordflow">if</span>((p = <a class="code" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>[Disk]) &amp;&amp; (p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> == <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>)) {
03001         <span class="keywordflow">if</span>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>) {
03002             <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != SYSID_UNUSED);
03003 
03004             <a class="code" href="../../d8/d1/fdengine_8c.html#a65">MakeBootRec</a>(Disk,pinfo+EntryCount,NULL,p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>);
03005             EntryCount += <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>;
03006             p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
03007         } <span class="keywordflow">else</span> {
03008             <a class="code" href="../../d4/d9/arcinst_8h.html#a28">ASRT</a>(ExtendedStartingOffset.QuadPart != 0);
03009 <span class="preprocessor">#if 0</span>
03010 <span class="preprocessor"></span>            status = <a class="code" href="../../d8/d1/fdengine_8c.html#a66">ZapSector</a>(Disk,ExtendedStartingOffset);
03011             <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
03012                 <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
03013                 <span class="keywordflow">return</span>(status);
03014             }
03015 <span class="preprocessor">#else</span>
03016 <span class="preprocessor"></span>            <a class="code" href="../../d8/d1/fdengine_8c.html#a65">MakeBootRec</a>(Disk,pinfo+EntryCount,NULL,NULL);
03017             EntryCount += <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>;
03018 <span class="preprocessor">#endif</span>
03019 <span class="preprocessor"></span>        }
03020     }
03021 
03022     <span class="keywordflow">while</span>(p) {
03023         <span class="keywordflow">if</span>(p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o11">SysID</a> != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
03024 
03025             <span class="comment">// find the next logical volume.</span>
03026 
03027             <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
03028             <span class="keywordflow">while</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>) {
03029                 <span class="keywordflow">if</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>-&gt;SysID != <a class="code" href="../../d4/d9/arcinst_8h.html#a176a70">SYSID_UNUSED</a>) {
03030                     <span class="keywordflow">break</span>;
03031                 }
03032                 <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>-&gt;Next;
03033             }
03034 
03035             StartingOffset = <a class="code" href="../../d8/d1/fdengine_8c.html#a65">MakeBootRec</a>(Disk,pinfo+EntryCount,p,n);
03036 
03037             <span class="comment">// if we're creating a volume, clear out its filesystem</span>
03038             <span class="comment">// boot sector so it starts out fresh.</span>
03039 
03040             <span class="keywordflow">if</span>((StartingOffset.QuadPart != 0) &amp;&amp; (p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o8">Update</a> != <a class="code" href="../../d8/d1/fdengine_8c.html#a1">CHANGED_DONT_ZAP</a>)) {
03041                 status = <a class="code" href="../../d8/d1/fdengine_8c.html#a66">ZapSector</a>(Disk,StartingOffset);
03042                 <span class="keywordflow">if</span>(status != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
03043                     <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
03044                     <span class="keywordflow">return</span>(status);
03045                 }
03046             }
03047 
03048             EntryCount += <a class="code" href="../../d4/d9/arcinst_8h.html#a27">ENTRIES_PER_BOOTSECTOR</a>;
03049         }
03050         p = p-&gt;<a class="code" href="../../d2/d9/struct__tagPARTITION.html#o0">Next</a>;
03051     }
03052 
03053     DriveLayout-&gt;PartitionCount = EntryCount;
03054     status = <a class="code" href="../../d1/d6/low_8c.html#a27">LowSetDiskLayout</a>(DiskNames[Disk],DriveLayout);
03055 
03056     <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(DriveLayout);
03057 
03058     <span class="keywordflow">return</span>(status);
03059 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="fdengine.c::ZapSector" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> ZapSector           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Disk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02823">2823</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
References <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00330">AllocateMemory</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00040">ARC_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00356">_tagDISKGEOM::BytesPerSector</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">DiskGeometryArray</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00332">FreeMemory</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02615">GetDiskName()</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00036">LowCloseDisk()</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00006">LowOpenDisk()</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00337">LOWPART</a>, <a class="el" href="../../d2/d5/low_8c-source.html#l00281">LowWriteSectors()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l00033">Offset</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00334">OK_STATUS</a>, <a class="el" href="../../d5/d8/arcinst_8h-source.html#l00335">RETURN_OUT_OF_MEMORY</a>, and <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00230">SectorSize</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.
<p>
<pre class="fragment"><div>02830                    :
02831 
02832     This routine writes zeros into a sector at a given offset.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02833     used to clear <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> a <span class="keyword">new</span> partition's filesystem boot record, so that
02834     no previous filesystem appears in a <span class="keyword">new</span> partition; or to clear <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02835     first EBR in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> extended partition <span class="keywordflow">if</span> there are to be no logical vols.
02836 
02837 Arguments:
02838 
02839     Disk - disk to write to
02840 
02841     <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a> - byte offset to a newly created partition on Disk
02842 
02843 Return Value:
02844 
02845     <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a> or error code.
02846 
02847 --*/
02848 
02849 {
02850     ULONG       <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a> = <a class="code" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>[Disk].<a class="code" href="../../d6/d8/struct__tagDISKGEOM.html#o3">BytesPerSector</a>;
02851     ULONG       i;
02852     PCHAR       SectorBuffer,AlignedSectorBuffer;
02853     <a class="code" href="../../d1/d9/arc_8h.html#a44">ARC_STATUS</a> status;
02854     ULONG    <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
02855     LARGE_INTEGER   LargeInteger;
02856 
02857     <span class="keywordflow">if</span>((SectorBuffer = <a class="code" href="../../d4/d9/arcinst_8h.html#a20">AllocateMemory</a>(2*SectorSize)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02858         <a class="code" href="../../d4/d9/arcinst_8h.html#a24">RETURN_OUT_OF_MEMORY</a>;
02859     }
02860 
02861     AlignedSectorBuffer = (PCHAR)(((ULONG)SectorBuffer+<a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>) &amp; ~(<a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>-1));
02862 
02863     <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>; AlignedSectorBuffer[i++] = 0);
02864 
02865     <span class="keywordflow">if</span>((status = <a class="code" href="../../d1/d6/low_8c.html#a9">LowOpenDisk</a>(<a class="code" href="../../d8/d1/fdengine_8c.html#a62">GetDiskName</a>(Disk),&amp;Handle)) != <a class="code" href="../../d4/d9/arcinst_8h.html#a23">OK_STATUS</a>) {
02866         <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(SectorBuffer);
02867         <span class="keywordflow">return</span>(status);
02868     }
02869 
02870     LargeInteger.QuadPart = <a class="code" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>.QuadPart / <a class="code" href="../../d3/d8/udfprocs_8h.html#a42">SectorSize</a>;
02871     status = <a class="code" href="../../d1/d6/low_8c.html#a14">LowWriteSectors</a>(Handle,
02872                              SectorSize,
02873                              <a class="code" href="../../d4/d9/arcinst_8h.html#a25">LOWPART</a>(LargeInteger),
02874                              1,
02875                              AlignedSectorBuffer
02876                             );
02877 
02878     <a class="code" href="../../d1/d6/low_8c.html#a10">LowCloseDisk</a>(Handle);
02879     <a class="code" href="../../d4/d9/arcinst_8h.html#a22">FreeMemory</a>(SectorBuffer);
02880 
02881     <span class="keywordflow">return</span>(status);
02882 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a8" doxytag="fdengine.c::ChangesMade" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN* <a class="el" href="../../d8/d1/fdengine_8c.html#a8">ChangesMade</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00048">48</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03152">FdMarkDiskDirty()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03121">HavePartitionsBeenChanged()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00432">NtAdjustGroupsToken()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01366">SetSysID()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01409">SetSysID2()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="fdengine.c::CountOfDisks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/fdengine_8c.html#a2">CountOfDisks</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00030">30</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01508">FreePartitionInfoLinkedLists()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02587">GetDiskCount()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">GetGeometry()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="fdengine.c::DiskGeometryArray" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d8/struct__tagDISKGEOM.html">DISKGEOM</a>* <a class="el" href="../../d8/d1/fdengine_8c.html#a4">DiskGeometryArray</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00035">35</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02073">AlignTowardsDiskEnd()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02038">AlignTowardsDiskStart()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00429">DetermineCreateSizeAndOffset()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01940">DiskLengthBytes()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03324">FdCrosses1024Cylinder()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03281">FdGetExactOffset()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03231">FdGetExactSize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03203">FdGetMaximumSizeMB()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03172">FdGetMinimumSizeMB()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">GetGeometry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01425">GetHiddenSectorCount()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02771">MakeBootRec()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02823">ZapSector()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="fdengine.c::DiskNames" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR* <a class="el" href="../../d8/d1/fdengine_8c.html#a3">DiskNames</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00031">31</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02615">GetDiskName()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">GetGeometry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="fdengine.c::LogicalVolumes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a> * <a class="el" href="../../d8/d1/fdengine_8c.html#a6">LogicalVolumes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">37</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">FindPartitionElement()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00780">GetDiskRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00859">GetRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01149">IsInLogicalList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="fdengine.c::OffLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PBOOLEAN <a class="el" href="../../d8/d1/fdengine_8c.html#a7">OffLine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00043">43</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03152">FdMarkDiskDirty()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00342">GetGeometry()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03121">HavePartitionsBeenChanged()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01882">InitializePartitionLists()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03389">IsDiskOffLine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="fdengine.c::PrimaryPartitions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d9/struct__tagPARTITION.html">PPARTITION</a>* <a class="el" href="../../d8/d1/fdengine_8c.html#a5">PrimaryPartitions</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00037">37</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l03063">CommitPartitionChanges()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00549">CreatePartitionEx()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00721">DeletePartition()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00258">FdiskCleanUp()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00183">FdiskInitialize()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01312">FindPartitionElement()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l00780">GetDiskRegions()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01708">InitializeLogicalVolumeList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01801">InitializePrimaryPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01179">IsInPartitionList()</a>, <a class="el" href="../../d9/d0/fdengine_8c-source.html#l01257">RenumberPartitions()</a>, and <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02886">WriteDriveLayout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="fdengine.c::SysIDStrings" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR <a class="el" href="../../d8/d1/fdengine_8c.html#a10">SysIDStrings</a>[256]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02646">2646</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02719">GetSysIDName()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="fdengine.c::UNKNOWN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="../../d8/d1/fdengine_8c.html#a9">UNKNOWN</a>[] = "Unknown <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/fdengine_8c-source.html#l02644">2644</a> of file <a class="el" href="../../d9/d0/fdengine_8c-source.html">fdengine.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:37 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
