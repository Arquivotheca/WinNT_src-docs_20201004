<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: hivestat.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>hivestat.c File Reference</h1><code>#include "<a class="el" href="../../d6/d6/regutil_8h-source.html">regutil.h</a>"</code><br>
<code>#include "<a class="el" href="../../d1/d4/edithive_8h-source.html">edithive.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;windows.h&gt;</code><br>

<p>
<a href="../../d9/d0/hivestat_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a21">ParseArgs</a> (int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a22">ScanHive</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a23">ScanCell</a> (<a class="el" href="../../d8/d4/struct__HCELL.html">PHCELL</a> <a class="el" href="../../d7/d0/cmdat2_8c.html#a24">Cell</a>, ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a24">ScanKeyNode</a> (IN <a class="el" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a> Node, IN ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a25">ScanKeyValue</a> (IN <a class="el" href="../../d7/d5/struct__CM__KEY__VALUE.html">PCM_KEY_VALUE</a> Value, IN ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a26">ScanKeySD</a> (IN <a class="el" href="../../d6/d5/struct__CM__KEY__SECURITY.html">PCM_KEY_SECURITY</a> Security, IN ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a27">ScanKeyIndex</a> (IN <a class="el" href="../../d1/d5/struct__CM__KEY__INDEX.html">PCM_KEY_INDEX</a> <a class="el" href="../../d7/d0/cmdat2_8c.html#a27">Index</a>, IN ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a28">ScanUnknown</a> (IN <a class="el" href="../../d4/d9/struct__CELL__DATA.html">PCELL_DATA</a> Data, IN ULONG CellSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a29">main</a> (int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a30">ScanHive</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a31">ScanCell</a> (IN <a class="el" href="../../d8/d4/struct__HCELL.html">PHCELL</a> <a class="el" href="../../d7/d0/cmdat2_8c.html#a24">Cell</a>, IN ULONG CellSize)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a0">helptext</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a1">DoCellType</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a2">DoSummary</a> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a3">DoTraceBin</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a6">AccessKeys</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a7">AccessValues</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a8">AccessSD</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCTSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a9">FileName</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a10">HiveVersion</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a11">SizeKeyData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a12">SizeValueData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a13">SizeSDData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a14">SizeIndexData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a15">SizeUnknownData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a16">NumKeyData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a17">NumValueData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a18">NumSDData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a19">NumIndexData</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d1/hivestat_8c.html#a20">NumUnknownData</a> = 0</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a29" doxytag="hivestat.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00177">177</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.
<p>
<pre class="fragment"><div>00181 {
00182     <a class="code" href="../../d8/d1/hivestat_8c.html#a21">ParseArgs</a>(argc, argv);
00183     <a class="code" href="../../d8/d1/hivestat_8c.html#a30">ScanHive</a>();
00184     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(0);
00185 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="hivestat.c::ParseArgs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ParseArgs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">188</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00154">AccessKeys</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00156">AccessSD</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00155">AccessValues</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00148">DoCellType</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00149">DoSummary</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00152">DoTraceAlloc</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00150">DoTraceBin</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00151">DoTraceFree</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/rtload_8c-source.html#l00047">FileName</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00067">helptext</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00177">main()</a>.
<p>
<pre class="fragment"><div>00194                    :
00195 
00196     Read arguments and set <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> arguments and <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> name from them.
00197 
00198 Arguments:
00199 
00200     argc, argv, standard meaning
00201 
00202 Return Value:
00203 
00204     None.
00205 
00206 --*/
00207 {
00208     <span class="keywordtype">char</span> *p;
00209     <span class="keywordtype">int</span> i;
00210     BOOLEAN command;
00211 
00212     <span class="keywordflow">if</span> (argc == 1) {
00213         <span class="keywordflow">for</span> (i = 0; <a class="code" href="../../d8/d1/hivestat_8c.html#a0">helptext</a>[i] != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; i++) {
00214             fprintf(stderr, <span class="stringliteral">"%s\n"</span>, helptext[i]);
00215         }
00216         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00217     }
00218 
00219     <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {
00220         p = argv[i];
00221 
00222         <span class="keywordflow">if</span> (*p == <span class="charliteral">'+'</span>) {
00223             <span class="comment">// switch something on</span>
00224             command = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00225 
00226         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">'-'</span>) {
00227             <span class="comment">// switch something off</span>
00228             command = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00229 
00230         } <span class="keywordflow">else</span> {
00231             <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a> = p;
00232             <span class="keywordflow">continue</span>;
00233         }
00234 
00235         p++;
00236         <span class="keywordflow">if</span> (*p == <span class="charliteral">'\0'</span>)
00237             <span class="keywordflow">continue</span>;
00238 
00239         <span class="keywordflow">switch</span> (*p) {
00240         <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
00241         <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
00242             <a class="code" href="../../d8/d1/hivestat_8c.html#a2">DoSummary</a> = command;
00243             <span class="keywordflow">break</span>;
00244 
00245         <span class="keywordflow">case</span> <span class="charliteral">'c'</span>:
00246         <span class="keywordflow">case</span> <span class="charliteral">'C'</span>:
00247             <a class="code" href="../../d8/d1/hivestat_8c.html#a1">DoCellType</a> = command;
00248             <span class="keywordflow">break</span>;
00249 
00250         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
00251         <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
00252             p++;
00253             <span class="keywordflow">while</span> (*p != <span class="charliteral">'\0'</span>) {
00254                 <span class="keywordflow">switch</span> (*p) {
00255                     <span class="keywordflow">case</span> <span class="charliteral">'k'</span>:
00256                     <span class="keywordflow">case</span> <span class="charliteral">'K'</span>:
00257                         <a class="code" href="../../d8/d1/hivestat_8c.html#a6">AccessKeys</a> = command;
00258                         <span class="keywordflow">break</span>;
00259 
00260                     <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
00261                     <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
00262                         <a class="code" href="../../d8/d1/hivestat_8c.html#a8">AccessSD</a> = command;
00263                         <span class="keywordflow">break</span>;
00264 
00265                     <span class="keywordflow">case</span> <span class="charliteral">'v'</span>:
00266                     <span class="keywordflow">case</span> <span class="charliteral">'V'</span>:
00267                         <a class="code" href="../../d8/d1/hivestat_8c.html#a7">AccessValues</a> = command;
00268                         <span class="keywordflow">break</span>;
00269 
00270                     <span class="keywordflow">default</span>:
00271                         <span class="keywordflow">break</span>;
00272                 }
00273                 p++;
00274             }
00275             <span class="keywordflow">break</span>;
00276 
00277         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>:
00278         <span class="keywordflow">case</span> <span class="charliteral">'T'</span>:
00279             p++;
00280             <span class="keywordflow">while</span> (*p != <span class="charliteral">'\0'</span>) {
00281 
00282                 <span class="keywordflow">switch</span> (*p) {
00283                 <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:
00284                 <span class="keywordflow">case</span> <span class="charliteral">'B'</span>:
00285                     <a class="code" href="../../d8/d1/hivestat_8c.html#a3">DoTraceBin</a> = command;
00286                     <span class="keywordflow">break</span>;
00287 
00288                 <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
00289                 <span class="keywordflow">case</span> <span class="charliteral">'A'</span>:
00290                     <a class="code" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a> = command;
00291                     <span class="keywordflow">break</span>;
00292 
00293                 <span class="keywordflow">case</span> <span class="charliteral">'f'</span>:
00294                 <span class="keywordflow">case</span> <span class="charliteral">'F'</span>:
00295                     <a class="code" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a> = command;
00296                     <span class="keywordflow">break</span>;
00297 
00298                 <span class="keywordflow">case</span> <span class="charliteral">'c'</span>:
00299                 <span class="keywordflow">case</span> <span class="charliteral">'C'</span>:
00300                     <a class="code" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a> = command;
00301                     <a class="code" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a> = command;
00302                     <span class="keywordflow">break</span>;
00303 
00304                 <span class="keywordflow">default</span>:
00305                     <span class="keywordflow">break</span>;
00306                 }
00307 
00308                 p++;
00309             }
00310             <span class="keywordflow">break</span>;
00311 
00312         <span class="keywordflow">default</span>:
00313             <span class="keywordflow">break</span>;
00314         }
00315     }
00316     <span class="keywordflow">return</span>;
00317 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="hivestat.c::ScanCell" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanCell           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d4/struct__HCELL.html">PHCELL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Cell</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">612</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00096">Cell</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00372">CM_KEY_INDEX_LEAF</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00371">CM_KEY_INDEX_ROOT</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00422">CM_KEY_NODE_SIGNATURE</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00517">CM_KEY_SECURITY_SIGNATURE</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00485">CM_KEY_VALUE_SIGNATURE</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00148">DoCellType</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00159">HiveVersion</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00540">_CELL_DATA::_u::KeyIndex</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00537">_CELL_DATA::_u::KeyNode</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00539">_CELL_DATA::_u::KeySecurity</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00538">_CELL_DATA::_u::KeyValue</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00765">ScanKeyIndex()</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00697">ScanKeyNode()</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00749">ScanKeySD()</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00722">ScanKeyValue()</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00775">ScanUnknown()</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00387">_CM_KEY_INDEX::Signature</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00520">_CM_KEY_SECURITY::Signature</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00495">_CM_KEY_VALUE::Signature</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00449">_CM_KEY_NODE::Signature</a>, and <a class="el" href="../../d4/d9/struct__CELL__DATA.html#o0">_CELL_DATA::u</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.
<p>
<pre class="fragment"><div>00619                    :
00620 
00621     Given a pointer to an <a class="code" href="../../d8/d4/struct__HCELL.html">HCELL</a>, <span class="keyword">this</span> tries to figure <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> what <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
00622     of data <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> (key, value, SD, etc.) and gather interesting
00623     statistics about <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00624 
00625 Arguments:
00626 
00627     Cell - Supplies a pointer to the HCELL
00628 
00629     CellSize - Supplies the size of the HCELL
00630 
00631 Return Value:
00632 
00633     None, sets some global statistics depending on content of the cell.
00634 
00635 --*/
00636 
00637 {
00638     <a class="code" href="../../d4/d9/struct__CELL__DATA.html">PCELL_DATA</a> Data;
00639 
00640     if (!DoCellType) {
00641         <span class="keywordflow">return</span>;
00642     }
00643 
00644     <span class="keywordflow">if</span> (HiveVersion==1) {
00645         Data = (<a class="code" href="../../d4/d9/struct__CELL__DATA.html">PCELL_DATA</a>)&amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a>-&gt;u.OldCell.u.UserData;
00646     } <span class="keywordflow">else</span> {
00647         Data = (<a class="code" href="../../d4/d9/struct__CELL__DATA.html">PCELL_DATA</a>)&amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a7">Cell</a>-&gt;u.NewCell.u.UserData;
00648     }
00649 
00650     <span class="comment">//</span>
00651     <span class="comment">// grovel through the data, see if we can figure out what it looks like</span>
00652     <span class="comment">//</span>
00653     <span class="keywordflow">if</span> ((Data-&gt;u.KeyNode.Signature == <a class="code" href="../../d9/d0/cmdata_8h.html#a25">CM_KEY_NODE_SIGNATURE</a>) &amp;&amp;
00654         (CellSize &gt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d5/struct__CM__KEY__NODE.html">CM_KEY_NODE</a>))) {
00655 
00656         <span class="comment">//</span>
00657         <span class="comment">// probably a key node</span>
00658         <span class="comment">//</span>
00659         <a class="code" href="../../d8/d1/hivestat_8c.html#a24">ScanKeyNode</a>(&amp;Data-&gt;u.KeyNode, CellSize);
00660 
00661     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Data-&gt;u.KeyValue.Signature == <a class="code" href="../../d9/d0/cmdata_8h.html#a34">CM_KEY_VALUE_SIGNATURE</a>) &amp;&amp;
00662                (CellSize &gt; <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d5/struct__CM__KEY__VALUE.html">CM_KEY_VALUE</a>))) {
00663 
00664         <span class="comment">//</span>
00665         <span class="comment">// probably a key value</span>
00666         <span class="comment">//</span>
00667         <a class="code" href="../../d8/d1/hivestat_8c.html#a25">ScanKeyValue</a>(&amp;Data-&gt;u.KeyValue, CellSize);
00668 
00669     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Data-&gt;u.KeySecurity.Signature == <a class="code" href="../../d9/d0/cmdata_8h.html#a39">CM_KEY_SECURITY_SIGNATURE</a>) &amp;&amp;
00670                (CellSize &gt; <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d5/struct__CM__KEY__SECURITY.html">CM_KEY_SECURITY</a>))) {
00671 
00672         <span class="comment">//</span>
00673         <span class="comment">// probably a security descriptor</span>
00674         <span class="comment">//</span>
00675         <a class="code" href="../../d8/d1/hivestat_8c.html#a26">ScanKeySD</a>(&amp;Data-&gt;u.KeySecurity, CellSize);
00676 
00677     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Data-&gt;u.KeyIndex.Signature == <a class="code" href="../../d9/d0/cmdata_8h.html#a18">CM_KEY_INDEX_ROOT</a>) ||
00678                (Data-&gt;u.KeyIndex.Signature == <a class="code" href="../../d9/d0/cmdata_8h.html#a19">CM_KEY_INDEX_LEAF</a>)) {
00679         <span class="comment">//</span>
00680         <span class="comment">// probably a key index</span>
00681         <span class="comment">//</span>
00682         <a class="code" href="../../d8/d1/hivestat_8c.html#a27">ScanKeyIndex</a>(&amp;Data-&gt;u.KeyIndex, CellSize);
00683 
00684     } <span class="keywordflow">else</span> {
00685         <span class="comment">//</span>
00686         <span class="comment">// Nothing with a signature, could be either</span>
00687         <span class="comment">//  name</span>
00688         <span class="comment">//  key list</span>
00689         <span class="comment">//  value data</span>
00690         <span class="comment">//</span>
00691         <a class="code" href="../../d8/d1/hivestat_8c.html#a28">ScanUnknown</a>(Data, CellSize);
00692 
00693     }
00694 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="hivestat.c::ScanCell" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanCell           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d4/struct__HCELL.html">PHCELL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Cell</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="hivestat.c::ScanHive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanHive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">320</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00148">DoCellType</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00149">DoSummary</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00152">DoTraceAlloc</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00150">DoTraceBin</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00151">DoTraceFree</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d3/d1/rtload_8c-source.html#l00047">FileName</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00187">HBIN_SIGNATURE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00122">HBLOCK_SIZE</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00159">HiveVersion</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00325">HSYS_MAJOR</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00326">HSYS_MINOR</a>, <a class="el" href="../../d6/d3/rxact_8c-source.html#l00212">INVALID_HANDLE_VALUE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00167">_HCELL::Last</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00344">_HBASE_BLOCK::Length</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00339">_HBASE_BLOCK::Major</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00340">_HBASE_BLOCK::Minor</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00173">NumIndexData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00170">NumKeyData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00172">NumSDData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00174">NumUnknownData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00171">NumValueData</a>, <a class="el" href="../../d4/d8/ntfsexp_8h.html#a141a69">OPEN_EXISTING</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00192">_HBIN::Signature</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00164">_HCELL::Size</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00194">_HBIN::Size</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00167">SizeIndexData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00164">SizeKeyData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00166">SizeSDData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00168">SizeUnknownData</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00165">SizeValueData</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00177">main()</a>.
<p>
<pre class="fragment"><div>00324                    :
00325 
00326     Scan <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hive, report what we see, based on <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> arguments.
00327 
00328 --*/
00329 {
00330     <span class="keyword">static</span> <span class="keywordtype">char</span> buffer[<a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>];
00331     <a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html">PHBASE_BLOCK</a> bbp;
00332     HANDLE filehandle;
00333     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> rf;
00334     ULONG readcount;
00335     ULONG hivelength;
00336     ULONG hiveposition;
00337     <a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a> cp;
00338     <a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a> guard;
00339     <a class="code" href="../../d7/d4/struct__HBIN.html">PHBIN</a> hbp;
00340     ULONG hoff;
00341     ULONG StatBinCount = 0;
00342     ULONG StatBinTotal = 0;
00343     ULONG StatBinMax = 0;
00344     ULONG StatFreeCount = 0;
00345     ULONG StatFreeTotal = 0;
00346     ULONG StatFreeMax = 0;
00347     ULONG StatAllocCount = 0;
00348     ULONG StatAllocTotal = 0;
00349     ULONG StatAllocMax = 0;
00350     ULONG binread;
00351     ULONG binsize;
00352     ULONG cellsize;
00353     ULONG boff;
00354     ULONG lboff;
00355     ULONG SizeTotal;
00356 
00357     <span class="comment">//</span>
00358     <span class="comment">// open the file</span>
00359     <span class="comment">//</span>
00360     filehandle = CreateFile(FileName, GENERIC_READ, FILE_SHARE_READ, NULL,
00361                             OPEN_EXISTING, FILE_FLAG_SEQUENTIAL_SCAN, NULL);
00362 
00363     <span class="keywordflow">if</span> (filehandle == <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>) {
00364         fprintf(stderr,
00365                 <span class="stringliteral">"hivestat: Could not open file '%s' error = %08lx\n"</span>,
00366                 FileName, GetLastError()
00367                 );
00368         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00369     }
00370 
00371 
00372     <span class="comment">//</span>
00373     <span class="comment">// read the header</span>
00374     <span class="comment">//</span>
00375     rf = ReadFile(filehandle, buffer, HBLOCK_SIZE, &amp;readcount, NULL);
00376     <span class="keywordflow">if</span> ( ( ! rf ) || (readcount != <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>) ) {
00377         fprintf(stderr, <span class="stringliteral">"hivestat: '%s' - cannot read base block!\n"</span>, FileName);
00378         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00379     }
00380 
00381     bbp = (<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html">PHBASE_BLOCK</a>)(&amp;(buffer[0]));
00382 
00383     <span class="keywordflow">if</span> ((bbp-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o4">Major</a> != <a class="code" href="../../d0/d1/hivedata_8h.html#a27">HSYS_MAJOR</a>) ||
00384         (bbp-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o5">Minor</a> &gt; <a class="code" href="../../d0/d1/hivedata_8h.html#a28">HSYS_MINOR</a>))
00385     {
00386         fprintf(stderr,
00387                 <span class="stringliteral">"hivestat: major/minor != %d/%d get newer hivestat\n"</span>,
00388                 HSYS_MAJOR, HSYS_MINOR
00389                 );
00390         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00391     }
00392 
00393     <a class="code" href="../../d8/d1/hivestat_8c.html#a10">HiveVersion</a> = bbp-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o5">Minor</a>;
00394 
00395     hivelength = bbp-&gt;<a class="code" href="../../d6/d4/struct__HBASE__BLOCK.html#o9">Length</a> + <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00396     hiveposition = <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00397     hoff = 0;
00398 
00399     printf(<span class="stringliteral">"hivestat: '%s'\n"</span>, FileName);
00400     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a3">DoTraceBin</a> || <a class="code" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a> || <a class="code" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a>) {
00401         printf(<span class="stringliteral">"\nTrace\n"</span>);
00402         printf(<span class="stringliteral">"bi=bin, fr=free, al=allocated\n"</span>);
00403         printf(<span class="stringliteral">"offset is file offset, sub HBLOCK to get HCELL\n"</span>);
00404         printf(<span class="stringliteral">"type,offset,size\n"</span>);
00405         printf(<span class="stringliteral">"\n"</span>);
00406     }
00407 
00408     <span class="comment">//</span>
00409     <span class="comment">// scan the hive</span>
00410     <span class="comment">//</span>
00411     guard = (<a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a>)(&amp;(buffer[0]) + <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>);
00412 
00413     <span class="comment">//</span>
00414     <span class="comment">// hiveposition is file relative offset of next block we will read</span>
00415     <span class="comment">//</span>
00416     <span class="comment">// hoff is the file relative offset of the last block we read</span>
00417     <span class="comment">//</span>
00418     <span class="comment">// hivelength is actual length of file (header's recorded length plus</span>
00419     <span class="comment">// the size of the header.</span>
00420     <span class="comment">//</span>
00421     <span class="comment">// cp is pointer into memory, within range of buffer, it's a cell pointer</span>
00422     <span class="comment">//</span>
00423     <span class="keywordflow">while</span> (hiveposition &lt; hivelength) {
00424 
00425         <span class="comment">//</span>
00426         <span class="comment">// read in first block of bin, check signature, get bin stats</span>
00427         <span class="comment">//</span>
00428         rf = ReadFile(filehandle, buffer, HBLOCK_SIZE, &amp;readcount, NULL);
00429         <span class="keywordflow">if</span> ( ( ! rf ) || (readcount != <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>) ) {
00430             fprintf(stderr, <span class="stringliteral">"hivestat: '%s' read error @%08lx\n"</span>, FileName, hiveposition);
00431             <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00432         }
00433         hbp = (<a class="code" href="../../d7/d4/struct__HBIN.html">PHBIN</a>)(&amp;(buffer[0]));
00434 
00435         <span class="keywordflow">if</span> (hbp-&gt;<a class="code" href="../../d7/d4/struct__HBIN.html#o0">Signature</a> != <a class="code" href="../../d0/d1/hivedata_8h.html#a24">HBIN_SIGNATURE</a>) {
00436             fprintf(stderr,
00437                     <span class="stringliteral">"hivestat: '%s' bad bin sign. @%08lx\n"</span>, FileName, hiveposition);
00438             <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00439         }
00440         hiveposition += <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00441         hoff += <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00442         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(hoff+HBLOCK_SIZE == hiveposition);
00443 
00444         StatBinCount++;
00445         binsize = hbp-&gt;<a class="code" href="../../d7/d4/struct__HBIN.html#o2">Size</a>;
00446         StatBinTotal += binsize;
00447         <span class="keywordflow">if</span> (binsize &gt; StatBinMax) {
00448             StatBinMax = binsize;
00449         }
00450 
00451         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a3">DoTraceBin</a>) {
00452             printf(<span class="stringliteral">"bi,x%08lx,%ld\n"</span>, hoff, binsize);
00453         }
00454 
00455         <span class="comment">//</span>
00456         <span class="comment">// scan the bin</span>
00457         <span class="comment">//</span>
00458         <span class="comment">// cp = pointer to cell we are looking at</span>
00459         <span class="comment">// boff = offset within bin</span>
00460         <span class="comment">// lboff = last offset within bin, used only for consistency checks</span>
00461         <span class="comment">// binread = number of bytes of bin we've read so far</span>
00462         <span class="comment">//</span>
00463         cp = (<a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a>)((PUCHAR)hbp + <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/struct__HBIN.html">HBIN</a>));
00464         boff = <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/struct__HBIN.html">HBIN</a>);
00465         lboff = -1;
00466         binread = <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00467 
00468         <span class="keywordflow">while</span> (binread &lt;= binsize) {
00469 
00470             <span class="comment">//</span>
00471             <span class="comment">// if free, do free stuff</span>
00472             <span class="comment">// else do alloc stuff</span>
00473             <span class="comment">// do full stuff</span>
00474             <span class="comment">//</span>
00475             <span class="keywordflow">if</span> (cp-&gt;<a class="code" href="../../d8/d4/struct__HCELL.html#o0">Size</a> &gt; 0) {
00476                 <span class="comment">//</span>
00477                 <span class="comment">// free</span>
00478                 <span class="comment">//</span>
00479                 cellsize = cp-&gt;<a class="code" href="../../d8/d4/struct__HCELL.html#o0">Size</a>;
00480                 StatFreeCount++;
00481                 StatFreeTotal += cellsize;
00482                 <span class="keywordflow">if</span> (cellsize &gt; StatFreeMax) {
00483                     StatFreeMax = cellsize;
00484                 }
00485 
00486                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a>) {
00487                     printf(<span class="stringliteral">"fr,x%08lx,%ld\n"</span>,
00488                            hoff+((PUCHAR)cp - &amp;(buffer[0])), cellsize);
00489                 }
00490 
00491 
00492             } <span class="keywordflow">else</span> {
00493                 <span class="comment">//</span>
00494                 <span class="comment">// alloc</span>
00495                 <span class="comment">//</span>
00496                 cellsize = -1 * cp-&gt;<a class="code" href="../../d8/d4/struct__HCELL.html#o0">Size</a>;
00497                 StatAllocCount++;
00498                 StatAllocTotal += cellsize;
00499                 <span class="keywordflow">if</span> (cellsize &gt; StatAllocMax) {
00500                     StatAllocMax = cellsize;
00501                 }
00502 
00503                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a>) {
00504                     printf(<span class="stringliteral">"al,x%08lx,%ld\n"</span>,
00505                            hoff+((PUCHAR)cp - &amp;(buffer[0])), cellsize);
00506                 }
00507 
00508                 <a class="code" href="../../d8/d1/hivestat_8c.html#a31">ScanCell</a>(cp,cellsize);
00509 
00510             }
00511 
00512             <span class="comment">//</span>
00513             <span class="comment">// do basic consistency check</span>
00514             <span class="comment">//</span>
00515 <span class="preprocessor">#if 0</span>
00516 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (cp-&gt;<a class="code" href="../../d8/d4/struct__HCELL.html#o1">Last</a> != lboff) {
00517                 printf(<span class="stringliteral">"e!,x%08lx  bad LAST pointer %08lx\n"</span>,
00518                         hoff+((PUCHAR)cp - &amp;(buffer[0])), cp-&gt;<a class="code" href="../../d8/d4/struct__HCELL.html#o1">Last</a>);
00519             }
00520 <span class="preprocessor">#endif</span>
00521 <span class="preprocessor"></span>
00522             <span class="comment">//</span>
00523             <span class="comment">// advance to next cell</span>
00524             <span class="comment">//</span>
00525             lboff = boff;
00526             cp = (<a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a>)((PUCHAR)cp + cellsize);
00527             boff += cellsize;
00528 
00529             <span class="comment">//</span>
00530             <span class="comment">// scan ahead in bin, if cp has reached off end of block,</span>
00531             <span class="comment">// AND there's bin left to read.</span>
00532             <span class="comment">// do this BEFORE breaking out for boff at end.</span>
00533             <span class="comment">//</span>
00534             <span class="keywordflow">while</span> ( (cp &gt;= guard) &amp;&amp; (binread &lt; binsize) ) {
00535 
00536                 rf = ReadFile(filehandle, buffer, HBLOCK_SIZE, &amp;readcount, NULL);
00537                 <span class="keywordflow">if</span> ( ( ! rf ) || (readcount != <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>) ) {
00538                     fprintf(stderr, <span class="stringliteral">"hivestat: '%s' read error @%08lx\n"</span>, FileName, hiveposition);
00539                     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00540                 }
00541                 cp = (<a class="code" href="../../d8/d4/struct__HCELL.html">PHCELL</a>)((PUCHAR)cp - <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>);
00542                 hiveposition += <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00543                 hoff += <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00544                 binread += <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00545                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(hoff+HBLOCK_SIZE == hiveposition);
00546             }
00547 
00548             <span class="keywordflow">if</span> (boff &gt;= binsize) {
00549                 <span class="keywordflow">break</span>;              <span class="comment">// we are done with this bin</span>
00550             }
00551         }
00552     }
00553 
00554     <span class="comment">//</span>
00555     <span class="comment">// Traces are done, stats gathered, print summary</span>
00556     <span class="comment">//</span>
00557     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a2">DoSummary</a>) {
00558 
00559         printf(<span class="stringliteral">"\nSummary:\n"</span>);
00560         printf(<span class="stringliteral">"type\tcount/max single/total space\n"</span>);
00561         printf(<span class="stringliteral">"%s\t%7ld\t%7ld\t%7ld\n"</span>,
00562                 <span class="stringliteral">"bin"</span>, StatBinCount, StatBinMax, StatBinTotal);
00563         printf(<span class="stringliteral">"%s\t%7ld\t%7ld\t%7ld\n"</span>,
00564                 <span class="stringliteral">"free"</span>, StatFreeCount, StatFreeMax, StatFreeTotal);
00565         printf(<span class="stringliteral">"%s\t%7ld\t%7ld\t%7ld\n"</span>,
00566                 <span class="stringliteral">"alloc"</span>, StatAllocCount, StatAllocMax, StatAllocTotal);
00567 
00568     }
00569 
00570     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a2">DoSummary</a> &amp;&amp; <a class="code" href="../../d8/d1/hivestat_8c.html#a1">DoCellType</a>) {
00571 
00572         printf(<span class="stringliteral">"\n"</span>);
00573 
00574         SizeTotal = <a class="code" href="../../d8/d1/hivestat_8c.html#a11">SizeKeyData</a> +
00575                     <a class="code" href="../../d8/d1/hivestat_8c.html#a12">SizeValueData</a> +
00576                     <a class="code" href="../../d8/d1/hivestat_8c.html#a13">SizeSDData</a> +
00577                     <a class="code" href="../../d8/d1/hivestat_8c.html#a14">SizeIndexData</a> +
00578                     <a class="code" href="../../d8/d1/hivestat_8c.html#a15">SizeUnknownData</a>;
00579 
00580         printf(<span class="stringliteral">"Total Key Data     %7d (%5.2f %%)\n"</span>, SizeKeyData,
00581             (<span class="keywordtype">float</span>)SizeKeyData*100/SizeTotal);
00582         printf(<span class="stringliteral">"Total Value Data   %7d (%5.2f %%)\n"</span>, SizeValueData,
00583             (<span class="keywordtype">float</span>)SizeValueData*100/SizeTotal);
00584         printf(<span class="stringliteral">"Total SD Data      %7d (%5.2f %%)\n"</span>, SizeSDData,
00585             (<span class="keywordtype">float</span>)SizeSDData*100/SizeTotal);
00586         printf(<span class="stringliteral">"Total Index Data   %7d (%5.2f %%)\n"</span>, SizeIndexData,
00587             (<span class="keywordtype">float</span>)SizeIndexData*100/SizeTotal);
00588         printf(<span class="stringliteral">"Total Unknown Data %7d (%5.2f %%)\n"</span>, SizeUnknownData,
00589             (<span class="keywordtype">float</span>)SizeUnknownData*100/SizeTotal);
00590 
00591         printf(<span class="stringliteral">"\n"</span>);
00592         printf(<span class="stringliteral">"Average Key Data     %8.2f (%d cells)\n"</span>,
00593             (<span class="keywordtype">float</span>)SizeKeyData/NumKeyData,
00594             NumKeyData);
00595         printf(<span class="stringliteral">"Average Value Data   %8.2f (%d cells)\n"</span>,
00596             (<span class="keywordtype">float</span>)SizeValueData/NumValueData,
00597             NumValueData);
00598         printf(<span class="stringliteral">"Average SD Data      %8.2f (%d cells)\n"</span>,
00599             (<span class="keywordtype">float</span>)SizeSDData/NumSDData,
00600             NumSDData);
00601         printf(<span class="stringliteral">"Average Index Data   %8.2f (%d cells)\n"</span>,
00602             (<span class="keywordtype">float</span>)SizeIndexData/NumIndexData,
00603             NumIndexData);
00604         printf(<span class="stringliteral">"Average Unknown Data %8.2f (%d cells)\n"</span>,
00605             (<span class="keywordtype">float</span>)SizeUnknownData/NumUnknownData,
00606             NumUnknownData);
00607     }
00608     <span class="keywordflow">return</span>;
00609 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="hivestat.c::ScanHive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanHive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="hivestat.c::ScanKeyIndex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanKeyIndex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__CM__KEY__INDEX.html">PCM_KEY_INDEX</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Index</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00765">765</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00173">NumIndexData</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00167">SizeIndexData</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>.
<p>
<pre class="fragment"><div>00769 {
00770     <a class="code" href="../../d8/d1/hivestat_8c.html#a14">SizeIndexData</a> += CellSize;
00771     <a class="code" href="../../d8/d1/hivestat_8c.html#a19">NumIndexData</a>++;
00772 
00773 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="hivestat.c::ScanKeyNode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanKeyNode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d5/struct__CM__KEY__NODE.html">PCM_KEY_NODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Node</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00697">697</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00154">AccessKeys</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00170">NumKeyData</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00164">SizeKeyData</a>, and <a class="el" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>.
<p>
<pre class="fragment"><div>00701 {
00702     <span class="keywordtype">int</span> i;
00703 
00704     <a class="code" href="../../d8/d1/hivestat_8c.html#a11">SizeKeyData</a> += CellSize;
00705     <a class="code" href="../../d8/d1/hivestat_8c.html#a16">NumKeyData</a>++;
00706 
00707     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a6">AccessKeys</a>) {
00708         printf(<span class="stringliteral">"%d, %d, %d, %d, \""</span>,
00709                Node-&gt;SubKeyCounts[Stable],
00710                Node-&gt;ValueList.Count,
00711                Node-&gt;NameLength,
00712                Node-&gt;ClassLength);
00713 
00714         <span class="keywordflow">for</span> (i=0; i &lt; Node-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR); i++) {
00715             printf(<span class="stringliteral">"%c"</span>,(CHAR)Node-&gt;Name[i]);
00716         }
00717         printf(<span class="stringliteral">"\"\n"</span>);
00718     }
00719 
00720 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="hivestat.c::ScanKeySD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanKeySD           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d5/struct__CM__KEY__SECURITY.html">PCM_KEY_SECURITY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Security</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00749">749</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00156">AccessSD</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00172">NumSDData</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00166">SizeSDData</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>.
<p>
<pre class="fragment"><div>00753 {
00754     <a class="code" href="../../d8/d1/hivestat_8c.html#a13">SizeSDData</a> += CellSize;
00755     <a class="code" href="../../d8/d1/hivestat_8c.html#a18">NumSDData</a>++;
00756 
00757     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a8">AccessSD</a>) {
00758         printf(<span class="stringliteral">"%d,%d\n"</span>,
00759                Security-&gt;ReferenceCount,
00760                Security-&gt;DescriptorLength);
00761     }
00762 
00763 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="hivestat.c::ScanKeyValue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanKeyValue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d5/struct__CM__KEY__VALUE.html">PCM_KEY_VALUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00722">722</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00155">AccessValues</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d0/d0/cmdata_8h-source.html#l00487">CM_KEY_VALUE_SPECIAL_SIZE</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00171">NumValueData</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00165">SizeValueData</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>.
<p>
<pre class="fragment"><div>00726 {
00727     <span class="keywordtype">int</span> i;
00728     <span class="keywordtype">int</span> DataLength;
00729 
00730     <a class="code" href="../../d8/d1/hivestat_8c.html#a12">SizeValueData</a> += CellSize;
00731     <a class="code" href="../../d8/d1/hivestat_8c.html#a17">NumValueData</a>++;
00732     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/hivestat_8c.html#a7">AccessValues</a>) {
00733         DataLength = Value-&gt;DataLength;
00734         <span class="keywordflow">if</span> (DataLength &gt;= <a class="code" href="../../d9/d0/cmdata_8h.html#a35">CM_KEY_VALUE_SPECIAL_SIZE</a>) {
00735             DataLength -= <a class="code" href="../../d9/d0/cmdata_8h.html#a35">CM_KEY_VALUE_SPECIAL_SIZE</a>;
00736         }
00737         printf(<span class="stringliteral">"%d, %d, \""</span>,
00738                DataLength,
00739                Value-&gt;NameLength);
00740 
00741         <span class="keywordflow">for</span> (i=0; i &lt; Value-&gt;NameLength/<span class="keyword">sizeof</span>(WCHAR); i++) {
00742             printf(<span class="stringliteral">"%c"</span>,(CHAR)Value-&gt;Name[i]);
00743         }
00744         printf(<span class="stringliteral">"\"\n"</span>);
00745     }
00746 
00747 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="hivestat.c::ScanUnknown" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ScanUnknown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__CELL__DATA.html">PCELL_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CellSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00775">775</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
References <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00174">NumUnknownData</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00168">SizeUnknownData</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>.
<p>
<pre class="fragment"><div>00779 {
00780     <a class="code" href="../../d8/d1/hivestat_8c.html#a15">SizeUnknownData</a> += CellSize;
00781     <a class="code" href="../../d8/d1/hivestat_8c.html#a20">NumUnknownData</a>++;
00782 
00783 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a6" doxytag="hivestat.c::AccessKeys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a6">AccessKeys</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00154">154</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00697">ScanKeyNode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="hivestat.c::AccessSD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a8">AccessSD</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00156">156</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00749">ScanKeySD()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="hivestat.c::AccessValues" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a7">AccessValues</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00155">155</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00722">ScanKeyValue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="hivestat.c::DoCellType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a1">DoCellType</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00148">148</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="hivestat.c::DoSummary" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a2">DoSummary</a> = TRUE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00149">149</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="hivestat.c::DoTraceAlloc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a5">DoTraceAlloc</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00152">152</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="hivestat.c::DoTraceBin" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a3">DoTraceBin</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00150">150</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="hivestat.c::DoTraceFree" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d8/d1/hivestat_8c.html#a4">DoTraceFree</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00151">151</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="hivestat.c::FileName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCTSTR <a class="el" href="../../d8/d1/hivestat_8c.html#a9">FileName</a> = NULL          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00157">157</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="hivestat.c::helptext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR* <a class="el" href="../../d8/d1/hivestat_8c.html#a0">helptext</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
 <span class="stringliteral">"hivestat:                                                               "</span>,
 <span class="stringliteral">"Statistics:                                                             "</span>,
 <span class="stringliteral">"    Short:  # of bins                                                   "</span>,
 <span class="stringliteral">"            average bin size                                            "</span>,
 <span class="stringliteral">"            max bin size                                                "</span>,
 <span class="stringliteral">"            # of cells                                                  "</span>,
 <span class="stringliteral">"            # of free cells                                             "</span>,
 <span class="stringliteral">"            # of allocated cells                                        "</span>,
 <span class="stringliteral">"            average free cell size                                      "</span>,
 <span class="stringliteral">"            total free size                                             "</span>,
 <span class="stringliteral">"            max free cell size                                          "</span>,
 <span class="stringliteral">"            average allocated size                                      "</span>,
 <span class="stringliteral">"            total allocated size                                        "</span>,
 <span class="stringliteral">"            max allocated cell size                                     "</span>,
 <span class="stringliteral">"            overhead summary (header, bin headers, cell headers)        "</span>,
 <span class="stringliteral">"    Long: bin#, offset, size                                            "</span>,
 <span class="stringliteral">"          cell offset, size, allocated                                  "</span>,
 <span class="stringliteral">"          cell offset, size, free                                       "</span>,
 <span class="stringliteral">"Usage: {[+|-][&lt;option&gt;]} &lt;filename&gt;                                     "</span>,
 <span class="stringliteral">"       (+ = on by default, - = off by default)                          "</span>,
 <span class="stringliteral">"       +s = summary - all of the short statistics                       "</span>,
 <span class="stringliteral">"       -t[bafc] = trace, line per entry, bin, allocated, free, all cells"</span>,
 <span class="stringliteral">"            (+tbc == +tbaf)                                             "</span>,
 <span class="stringliteral">"       -c = cell type summary                                           "</span>,
 <span class="stringliteral">"       -a[kvs] = Access Export (key nodes, values, SDs)                 "</span>,
 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00067">67</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00188">ParseArgs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="hivestat.c::HiveVersion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a10">HiveVersion</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00159">159</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00612">ScanCell()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="hivestat.c::NumIndexData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a19">NumIndexData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00173">173</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00765">ScanKeyIndex()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="hivestat.c::NumKeyData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a16">NumKeyData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00170">170</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00697">ScanKeyNode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="hivestat.c::NumSDData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a18">NumSDData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00172">172</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00749">ScanKeySD()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="hivestat.c::NumUnknownData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a20">NumUnknownData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00174">174</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00775">ScanUnknown()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="hivestat.c::NumValueData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a17">NumValueData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00171">171</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00722">ScanKeyValue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="hivestat.c::SizeIndexData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a14">SizeIndexData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00167">167</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00765">ScanKeyIndex()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="hivestat.c::SizeKeyData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a11">SizeKeyData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00164">164</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00697">ScanKeyNode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="hivestat.c::SizeSDData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a13">SizeSDData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00166">166</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00749">ScanKeySD()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="hivestat.c::SizeUnknownData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a15">SizeUnknownData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00168">168</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00775">ScanUnknown()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="hivestat.c::SizeValueData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d1/hivestat_8c.html#a12">SizeValueData</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00165">165</a> of file <a class="el" href="../../d9/d0/hivestat_8c-source.html">hivestat.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00320">ScanHive()</a>, and <a class="el" href="../../d9/d0/hivestat_8c-source.html#l00722">ScanKeyValue()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:05 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
