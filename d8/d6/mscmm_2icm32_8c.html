<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mscmm/icm32.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>icm32.c File Reference</h1><code>#include "Windef.h"</code><br>
<code>#include "WinGdi.h"</code><br>
<code>#include &lt;wtypes.h&gt;</code><br>
<code>#include &lt;winbase.h&gt;</code><br>
<code>#include &lt;WindowsX.h&gt;</code><br>
<code>#include "ICM.h"</code><br>
<code>#include "General.h"</code><br>
<code>#include "MemProf.h"</code><br>

<p>
<a href="../../d9/d5/mscmm_2icm32_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a0">CMM_WIN_VERSION</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a1">CMM_IDENT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a2">CMM_DRIVER_LEVEL</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a3">CMM_DLL_VERSION</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a4">CMM_VERSION</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a5">CMS_LEVEL_1</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a6">DllExport</a>&nbsp;&nbsp;&nbsp;__declspec( dllexport )</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef HANDLE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a9">LPHPROFILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a10">LPARGBQUAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef COLORREF FAR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a11">LPCOLORREF</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a15">DllMain</a> (HINSTANCE hinstDLL, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fdwReason, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpvReserved)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a16">CMCreateMultiProfileTransform</a> (<a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a9">LPHPROFILE</a> lpahProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *aIntentArr, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nIntents, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a17">FillProfileFromLog</a> (LPLOGCOLORSPACEA lpColorSpace, PPROFILE theProf)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a18">FillProfileFromLogW</a> (LPLOGCOLORSPACEW lpColorSpace, PPROFILE theProf)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a19">CMCreateProfile</a> (LPLOGCOLORSPACEA lpColorSpace, <a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> *lpProfileData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a20">StoreTransform</a> (<a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> aRef)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a> (BMFORMAT <a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>, long *pixelSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a22">CMGetTransform</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a23">CMCreateMultiProfileTransformInternal</a> (<a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> *cw, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a> lpahProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *aIntentArr, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nIntents, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCreateLink)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a24">CMGetInfo</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a25">CMCreateTransformExtInternal</a> (<a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> *cwOut, <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a8">UINT32</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a8">UINT32</a> lcsIntent, HPROFILE aProf, LPBYTE ptDeRef, LPBYTE pdDeRef)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a26">WriteProf</a> (LPSTR name, <a class="el" href="../../d6/d3/structicProfile.html">icProfile</a> *theProf, long currentSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a27">CMCreateTransformExt</a> (LPLOGCOLORSPACEA lpColorSpace, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpDevCharacter, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpTargetDevCharacter, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a28">CMCreateTransform</a> (LPLOGCOLORSPACEA lpColorSpace, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpDevCharacter, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpTargetDevCharacter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a29">CMCreateTransformExtW</a> (LPLOGCOLORSPACEW lpColorSpace, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpDevCharacter, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpTargetDevCharacter, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a30">CMCreateTransformW</a> (LPLOGCOLORSPACEW lpColorSpace, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpDevCharacter, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> lpTargetDevCharacter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a31">CMDeleteTransform</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a32">CMCreateProfile</a> (LPLOGCOLORSPACEA lpColorSpace, LPBYTE *lpProfileData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a33">CMCreateProfileW</a> (LPLOGCOLORSPACEW lpColorSpace, LPBYTE *lpProfileData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a34">CMCreateDeviceLinkProfile</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a> lpahProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nProfiles, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *aIntentArr, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nIntents, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, LPBYTE *lpProfileData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a35">CMIsProfileValid</a> (HPROFILE hProfile, LPBOOL lpbValid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a36">CMTranslateColors</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, LPCOLOR lpaInputColors, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nColors, COLORTYPE ctInput, LPCOLOR lpaOutputColors, COLORTYPE ctOutput)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a37">CMCheckColors</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, LPCOLOR lpaInputColors, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> nColors, COLORTYPE ctInput, LPBYTE lpaResult)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a38">CMTranslateRGBs</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpSrcBits, BMFORMAT bmInput, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwWidth, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwHeight, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwStride, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpDestBits, BMFORMAT bmOutput, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwTranslateDirection)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a39">CMTranslateRGBsExt</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpSrcBits, BMFORMAT bmInput, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwWidth, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwHeight, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwInputStride, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpDestBits, BMFORMAT bmOutput, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwOutputStride, LPBMCALLBACKFN lpfnCallback, LPARAM ulCallbackData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a40">CMCheckRGBs</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpSrcBits, BMFORMAT bmInput, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwWidth, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwHeight, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwStride, LPBYTE lpDestBits, PBMCALLBACKFN pfnCallback, LPARAM ulCallbackData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a41">CMTranslateRGB</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, COLORREF colorRef, <a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a11">LPCOLORREF</a> lpColorRef, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a42">CMCheckColorsInGamut</a> (<a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> hcmTransform, RGBTRIPLE *lpaRGBTriplet, LPBYTE lpBuffer, UINT nCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a43">CMConvertColorNameToIndex</a> (HPROFILE aProf, LPCOLOR_NAME aColorNameArr, LPDWORD aDWordArr, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> count)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a44">CMConvertIndexToColorName</a> (HPROFILE aProf, LPDWORD aDWordArr, LPCOLOR_NAME aColorNameArr, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> count)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a45">CMGetNamedProfileInfo</a> (HPROFILE aProf, LPNAMED_PROFILE_INFO Info)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a> [1000] = {0}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CRITICAL_SECTION&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a14">GlobalCriticalSection</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a3" doxytag="mscmm/icm32.c::CMM_DLL_VERSION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMM_DLL_VERSION&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00031">31</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">CMGetInfo()</a>, and <a class="el" href="../../d1/d3/color_8c-source.html#l00773">GetCMMInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="mscmm/icm32.c::CMM_DRIVER_LEVEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMM_DRIVER_LEVEL&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00030">30</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">CMGetInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="mscmm/icm32.c::CMM_IDENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMM_IDENT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00029">29</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">CMGetInfo()</a>, <a class="el" href="../../d1/d3/color_8c-source.html#l00773">GetCMMInfo()</a>, <a class="el" href="../../d3/d0/object_8c-source.html#l00564">GetColorMatchingModule()</a>, and <a class="el" href="../../d3/d0/object_8c-source.html#l00477">ValidColorMatchingModule()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mscmm/icm32.c::CMM_VERSION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMM_VERSION&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00032">32</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">CMGetInfo()</a>, <a class="el" href="../../d3/d0/object_8c-source.html#l00564">GetColorMatchingModule()</a>, and <a class="el" href="../../d3/d0/object_8c-source.html#l00477">ValidColorMatchingModule()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="mscmm/icm32.c::CMM_WIN_VERSION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMM_WIN_VERSION&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00028">28</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">CMGetInfo()</a>, and <a class="el" href="../../d1/d3/color_8c-source.html#l00773">GetCMMInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="mscmm/icm32.c::CMS_LEVEL_1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMS_LEVEL_1&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00033">33</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="mscmm/icm32.c::DllExport" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DllExport&nbsp;&nbsp;&nbsp;__declspec( dllexport )          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00088">88</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a7" doxytag="mscmm/icm32.c::HCMTRANSFORM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef HANDLE <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">35</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00626">CMCreateMultiProfileTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00410">CMCreateTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00282">CMCreateTransformExt()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00446">CMCreateTransformExtW()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00509">CMCreateTransformW()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00658">CMDeleteTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01729">CMGetTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01356">CMTranslateRGB()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01054">CMTranslateRGBs()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01759">StoreTransform()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="mscmm/icm32.c::LPARGBQUAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> <a class="el" href="../../d8/d6/mscmm_2icm32_8c.html#a10">LPARGBQUAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00038">38</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="mscmm/icm32.c::LPCOLORREF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef COLORREF FAR* <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a11">LPCOLORREF</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00039">39</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="mscmm/icm32.c::LPDEVCHARACTER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00036">36</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="mscmm/icm32.c::LPHPROFILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef HANDLE* <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00037">37</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a37" doxytag="mscmm/icm32.c::CMCheckColors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCheckColors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCOLOR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpaInputColors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nColors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>COLORTYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>ctInput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpaResult</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01005">1005</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, and <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00316">CWCheckColorsMS()</a>.
<p>
<pre class="fragment"><div>01010 {
01011         <span class="keywordtype">long</span> matchErr;
01012 
01013         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a5">CWCheckColorsMS</a>( <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform ), (<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *)lpaInputColors, nColors, lpaResult );
01014         <span class="keywordflow">if</span>( matchErr ){
01015                 SetLastError( matchErr );
01016                 <span class="keywordflow">return</span> 0;
01017         }
01018         <span class="keywordflow">return</span> 1;
01019 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="mscmm/icm32.c::CMCheckColorsInGamut" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCheckColorsInGamut           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>RGBTRIPLE *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpaRGBTriplet</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01435">1435</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00347">CMBitmapCallBackUPP</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00113">CWCheckBitmap()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00290">CMBitmap::height</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00290">CMBitmap::image</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00292">CMBitmap::pixelSize</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00291">CMBitmap::rowBytes</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00293">CMBitmap::space</a>, and <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00289">CMBitmap::width</a>.
<p>
<pre class="fragment"><div>01439 {
01440         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                                InBitmap,OutBitmap;
01441         <span class="keywordtype">long</span> matchErr;
01442         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> aBgrMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01443 
01444         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>          = (<span class="keywordtype">char</span> *)(lpaRGBTriplet);
01445         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>          = nCount;
01446         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>         = 1;
01447         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>       = 3*nCount;
01448         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>      = 24;
01449         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>          = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01450         OutBitmap = InBitmap;   
01451         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>      = nCount;       <span class="comment">// perhaps wrong format?</span>
01452         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>     = 8;
01453         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>         = (<span class="keywordtype">char</span> *)lpBuffer;
01454 
01455         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a1">CWCheckBitmap</a>(       <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform ), &amp;InBitmap,
01456                                                                 (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a27">CMBitmapCallBackUPP</a>)0,(<span class="keywordtype">void</span> *)NULL,&amp;OutBitmap );
01457         <span class="keywordflow">if</span>( matchErr ){
01458                 SetLastError( matchErr );
01459                 <span class="keywordflow">return</span> 0;
01460         }
01461         <span class="keywordflow">return</span> 1;
01462 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="mscmm/icm32.c::CMCheckRGBs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCheckRGBs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpSrcBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>bmInput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwHeight</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwStride</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDestBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PBMCALLBACKFN&nbsp;</td>
          <td class="mdname" nowrap> <em>pfnCallback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>ulCallbackData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01279">1279</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00347">CMBitmapCallBackUPP</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00022">CMBitmapColorSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a67">cmGamutResultSpace</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace()</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00113">CWCheckBitmap()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00290">CMBitmap::height</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00290">CMBitmap::image</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00292">CMBitmap::pixelSize</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00291">CMBitmap::rowBytes</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00293">CMBitmap::space</a>, and <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00289">CMBitmap::width</a>.
<p>
<pre class="fragment"><div>01289 {
01290         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>              spaceIn,spaceOut;
01291         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                                InBitmap,OutBitmap;
01292         <span class="keywordtype">long</span> matchErr, inPixelSize;
01293         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> aBgrMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01294 
01295         spaceIn = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a>( bmInput, &amp;inPixelSize );
01296         <span class="keywordflow">if</span>( spaceIn == 0 ){
01297                 SetLastError( (DWORD)cmInvalidColorSpace );
01298                 <span class="keywordflow">return</span> 0;
01299         }
01300         spaceOut = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;
01301 
01302         <span class="keywordflow">if</span>( spaceOut == 0 )<span class="keywordflow">return</span> 0;
01303         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>          = lpSrcBits;
01304         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>          = dwWidth;
01305         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>         = dwHeight;
01306         <span class="keywordflow">if</span>( dwStride == 0 ){
01307                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> = ( dwWidth * (inPixelSize / 8) + 3 ) &amp; ~3;
01308         }
01309         <span class="keywordflow">else</span>{
01310                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>       = dwStride;
01311         }
01312         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>      = inPixelSize;
01313         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>          = spaceIn;
01314                 
01315         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>         = lpDestBits;
01316         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>         = dwWidth;
01317         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>        = dwHeight;
01318         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>      = dwWidth;      <span class="comment">// perhaps wrong format?</span>
01319         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>     = 8;
01320         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>         = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a67">cmGamutResultSpace</a>;
01321 
01322         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a1">CWCheckBitmap</a>(       <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform ), &amp;InBitmap,
01323                                                                 (CMBitmapCallBackUPP)pfnCallback,(<span class="keywordtype">void</span> *)ulCallbackData,&amp;OutBitmap );
01324         
01325         <span class="keywordflow">if</span>( matchErr ){
01326                 SetLastError( matchErr );
01327                 <span class="keywordflow">return</span> 0;
01328         }
01329         <span class="keywordflow">return</span> 1;
01330 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="mscmm/icm32.c::CMConvertColorNameToIndex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMConvertColorNameToIndex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>aProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCOLOR_NAME&nbsp;</td>
          <td class="mdname" nowrap> <em>aColorNameArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>aDWordArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01787">1787</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a143">CMConvNameToIndexProfile()</a>, and <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00023">CMError</a>.
<p>
<pre class="fragment"><div>01788 {
01789         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err;
01790 
01791         err = <a class="code" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a143">CMConvNameToIndexProfile</a>( aProf, aColorNameArr, aDWordArr, count );
01792         <span class="keywordflow">if</span>( err ){
01793                 SetLastError( err );
01794                 <span class="keywordflow">return</span> 0;
01795         }
01796         <span class="keywordflow">return</span> 1;
01797 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="mscmm/icm32.c::CMConvertIndexToColorName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMConvertIndexToColorName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>aProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>aDWordArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCOLOR_NAME&nbsp;</td>
          <td class="mdname" nowrap> <em>aColorNameArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01799">1799</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a145">CMConvIndexToNameProfile()</a>.
<p>
<pre class="fragment"><div>01800 {
01801         <span class="keywordtype">long</span> matchErr;
01802 
01803         matchErr = <a class="code" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a145">CMConvIndexToNameProfile</a>( aProf, aDWordArr, aColorNameArr, count );
01804         <span class="keywordflow">if</span>( matchErr ){
01805                 SetLastError( matchErr );
01806                 <span class="keywordflow">return</span> 0;
01807         }
01808         <span class="keywordflow">return</span> 1;
01809 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="mscmm/icm32.c::CMCreateDeviceLinkProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCreateDeviceLinkProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpahProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>aIntentArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nIntents</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpProfileData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00812">812</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00176">CMConcatProfileSet</a>, <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00516">CMCreateMultiProfileTransformInternal()</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00025">CMProfileRef</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00171">CMConcatProfileSet::count</a>, <a class="el" href="../../d2/d6/w98_2lh__open_2pi__color_8c-source.html#l00375">CWDisposeColorWorld()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l01281">DeviceLinkFill()</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00099">DisposeIfPtr()</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00170">CMConcatProfileSet::keyIndex</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00071">OSErr</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00172">CMConcatProfileSet::profileSet</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00052">Ptr</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00072">SmartNewPtrClear()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00032">UINT32</a>.
<p>
<pre class="fragment"><div>00818 {
00819         <span class="keywordtype">long</span>                            err;
00820         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                           aOSErr;
00821         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>                      cw;
00822         <a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a>      *profileSet;
00823         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                          i;
00824 
00825         *lpProfileData = 0;
00826         
00827         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a23">CMCreateMultiProfileTransformInternal</a>( &amp;cw, lpahProfiles, nProfiles, aIntentArr, nIntents, dwFlags, 0 );
00828         <span class="keywordflow">if</span>( err ){
00829                 SetLastError( err );
00830                 <span class="keywordflow">return</span> 0;
00831         }
00832         profileSet = (<a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a6">SmartNewPtrClear</a>(<span class="keyword">sizeof</span> (<a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a>) + (nProfiles)* <span class="keyword">sizeof</span>(CMProfileRef),&amp;aOSErr);
00833         err = aOSErr;
00834         <span class="keywordflow">if</span> (aOSErr == 0 )
00835         {
00836                 profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o0">keyIndex</a> = 0;
00837                 profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o1">count</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)nProfiles;
00838                 <span class="keywordflow">for</span>( i=0; i&lt;nProfiles; i++)
00839                         profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o2">profileSet</a>[i] = (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a13">CMProfileRef</a>)((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(((PVOID *)lpahProfiles)[i]));
00840         }
00841         <span class="keywordflow">else</span> <span class="keywordflow">goto</span> CleanupAndExit;
00842 
00843         err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a6">DeviceLinkFill</a>( (CMMModelPtr)cw, profileSet, (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> **)lpProfileData, aIntentArr[0]  );
00844         profileSet= (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a16">CMConcatProfileSet</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr) profileSet );
00845 
00846         <span class="keywordflow">if</span>( err )<span class="keywordflow">goto</span> CleanupAndExit;
00847         <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a6">CWDisposeColorWorld</a> ( cw );
00848         <span class="keywordflow">return</span> 1;
00849 
00850 CleanupAndExit:
00851         <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a6">CWDisposeColorWorld</a> ( cw );
00852         SetLastError( err );
00853         <span class="keywordflow">return</span> 0;
00854 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="mscmm/icm32.c::CMCreateMultiProfileTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMCreateMultiProfileTransform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpahProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>aIntentArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nIntents</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00626">626</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00516">CMCreateMultiProfileTransformInternal()</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, and <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a20">StoreTransform()</a>.
<p>
<pre class="fragment"><div>00631 {
00632         <span class="keywordtype">long</span>                            err;
00633         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>                      cw;
00634 
00635         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a23">CMCreateMultiProfileTransformInternal</a>( &amp;cw, lpahProfiles, nProfiles, aIntentArr, nIntents, dwFlags, 0 );
00636         <span class="keywordflow">if</span>( err ){
00637                 SetLastError( err );
00638                 <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)(ULONG_PTR)(err &amp; 255);
00639         }
00640         cw = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a20">StoreTransform</a>( cw );
00641         <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)cw;
00642 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="mscmm/icm32.c::CMCreateMultiProfileTransformInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long CMCreateMultiProfileTransformInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a9">LPHPROFILE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpahProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nProfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>aIntentArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nIntents</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwCreateLink</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00516">516</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a116">cmBestMode</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00176">CMConcatProfileSet</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a115">cmDraftMode</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a114">cmNormalMode</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00025">CMProfileRef</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00171">CMConcatProfileSet::count</a>, <a class="el" href="../../d2/d6/w98_2lh__open_2pi__color_8c-source.html#l00283">CWConcatColorWorld4MS()</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00099">DisposeIfPtr()</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00306">icAbsoluteColorimetric</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00303">icPerceptual</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00304">icRelativeColorimetric</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00333">kCreateGamutLutMask</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00170">CMConcatProfileSet::keyIndex</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00332">kLookupOnlyMask</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00334">kUseRelColorimetric</a>, <a class="el" href="../../d8/d5/mscmm_2memprof_8c-source.html#l00046">MyNewDeviceLink()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00071">OSErr</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00172">CMConcatProfileSet::profileSet</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00052">Ptr</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00072">SmartNewPtrClear()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00032">UINT32</a>.
<p>
<pre class="fragment"><div>00523 {
00524         <a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a>      *profileSet;
00525         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                           aOSErr;
00526         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>                           i;
00527         <span class="keywordtype">long</span>                            err;
00528         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                          theFlags;
00529         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                          *arrIntents = 0;;
00530 
00531         profileSet = (<a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a6">SmartNewPtrClear</a>( <span class="keyword">sizeof</span> (<a class="code" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a>) + (nProfiles)* <span class="keyword">sizeof</span>(CMProfileRef), &amp;aOSErr );
00532         <span class="keywordflow">if</span> (aOSErr == 0 )
00533         {
00534                 profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o0">keyIndex</a> = 0;
00535                 profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o1">count</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)nProfiles;
00536                 <span class="keywordflow">for</span>( i=0; i&lt;nProfiles; i++)
00537                         profileSet-&gt;<a class="code" href="../../d9/d3/structCMConcatProfileSet.html#o2">profileSet</a>[i] = (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a13">CMProfileRef</a>)((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(((PVOID *)lpahProfiles)[i]));
00538         }
00539         <span class="keywordflow">else</span> <span class="keywordflow">return</span> ERROR_NOT_ENOUGH_MEMORY;
00540 
00541         <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; 0xffff ){
00542                 <span class="keywordflow">case</span> BEST_MODE:
00543                         theFlags = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a116">cmBestMode</a>;
00544                         <span class="keywordflow">break</span>;
00545                 <span class="keywordflow">case</span> PROOF_MODE:
00546                         theFlags = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a115">cmDraftMode</a>;
00547                         <span class="keywordflow">break</span>;
00548                 <span class="keywordflow">default</span>:
00549                         theFlags = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a153a114">cmNormalMode</a>;
00550                         <span class="keywordflow">break</span>;
00551         }
00552         <span class="keywordflow">if</span>( ! (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; ENABLE_GAMUT_CHECKING) ){
00553                 theFlags |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a4">kCreateGamutLutMask</a>;
00554         }
00555         <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; USE_RELATIVE_COLORIMETRIC ){
00556                 theFlags |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a5">kUseRelColorimetric</a>;
00557         }
00558         <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; FAST_TRANSLATE ){
00559                 theFlags |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a3">kLookupOnlyMask</a>;
00560         }
00561         <span class="keywordflow">if</span>( nProfiles &gt; 1 &amp;&amp; nIntents == 1 ){
00562                 arrIntents = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a6">SmartNewPtrClear</a>( nProfiles * <span class="keyword">sizeof</span> (UINT32), &amp;aOSErr);
00563                 <span class="keywordflow">if</span> (aOSErr != 0 ){
00564                         err = ERROR_NOT_ENOUGH_MEMORY;
00565                         <span class="keywordflow">goto</span> CleanupAndExit;
00566                 }
00567                 arrIntents[0] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>;
00568                 arrIntents[1] = aIntentArr[0];
00569                 <span class="keywordflow">for</span>( i=2; i&lt;nProfiles; i++){
00570                         arrIntents[i] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>;
00571                         <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a5">kUseRelColorimetric</a> ) arrIntents[i] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>;
00572                 }
00573                 err = <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a4">CWConcatColorWorld4MS</a>( cw, profileSet, arrIntents, nProfiles, theFlags );
00574                 arrIntents= (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr) arrIntents );
00575         }
00576         <span class="keywordflow">else</span>{
00577                 err = <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a4">CWConcatColorWorld4MS</a>( cw, profileSet, aIntentArr, nIntents, theFlags );
00578         }
00579 <span class="preprocessor">#ifdef WRITE_PROFILE</span>
00580 <span class="preprocessor"></span>        <span class="keywordflow">if</span>( err == 0 ){
00581                 err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a2">MyNewDeviceLink</a>( *cw, profileSet, <span class="stringliteral">"MyCreateTransform.pf"</span> );
00582                 <span class="comment">//goto CleanupAndExit;</span>
00583         }
00584 <span class="preprocessor">#endif</span>
00585 <span class="preprocessor"></span>CleanupAndExit:
00586         profileSet= (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a16">CMConcatProfileSet</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr) profileSet );
00587         <span class="keywordflow">return</span> err;
00588 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="mscmm/icm32.c::CMCreateProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCreateProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpProfileData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00712">712</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, and <a class="el" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a1">MyNewAbstract()</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00282">CMCreateTransformExt()</a>.
<p>
<pre class="fragment"><div>00714 {
00715         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw=0;
00716         <span class="keywordtype">long</span> err;
00717 
00718         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] ) <span class="keywordflow">return</span> 0;
00719         err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a1">MyNewAbstract</a>( lpColorSpace, (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> **)lpProfileData );
00720         <span class="comment">//err = FillProfileFromLog( lpColorSpace, &amp;theProf );</span>
00721         <span class="keywordflow">if</span>( err ){
00722                 SetLastError( err );
00723                 <span class="keywordflow">goto</span> CleanupAndExit;
00724         }
00725         <span class="keywordflow">return</span> 1;
00726 CleanupAndExit:
00727         <span class="keywordflow">return</span> 0;
00728 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="mscmm/icm32.c::CMCreateProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCreateProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpProfileData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="mscmm/icm32.c::CMCreateProfileW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMCreateProfileW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpProfileData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00751">751</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, and <a class="el" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a0">MyNewAbstractW()</a>.
<p>
<pre class="fragment"><div>00753 {
00754         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw=0;
00755         <span class="keywordtype">long</span> err;
00756 
00757         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] ) <span class="keywordflow">return</span> 0;
00758         err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a0">MyNewAbstractW</a>( lpColorSpace, (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> **)lpProfileData );
00759         <span class="comment">//err = FillProfileFromLogW( lpColorSpace, &amp;theProf );</span>
00760         <span class="keywordflow">if</span>( err ){
00761                 SetLastError( err );
00762                 <span class="keywordflow">goto</span> CleanupAndExit;
00763         }
00764         <span class="keywordflow">return</span> 1;
00765 CleanupAndExit:
00766         <span class="keywordflow">return</span> 0;
00767 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="mscmm/icm32.c::CMCreateTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMCreateTransform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpTargetDevCharacter</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00410">410</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00282">CMCreateTransformExt()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>.
<p>
<pre class="fragment"><div>00413 {
00414         <span class="keywordflow">return</span> <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a27">CMCreateTransformExt</a>( lpColorSpace, lpDevCharacter, lpTargetDevCharacter, PROOF_MODE | ENABLE_GAMUT_CHECKING | 0x80000000 );
00415 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="mscmm/icm32.c::CMCreateTransformExt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMCreateTransformExt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpTargetDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00282">282</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00271">CloseColorProfile()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00712">CMCreateProfile()</a>, <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00167">CMCreateTransformExtInternal()</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a17">FillProfileFromLog()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d4/d8/ntfsexp_8h.html#a141a69">OPEN_EXISTING</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00106">pd</a>, and <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a26">WriteProf()</a>.
<p>
<pre class="fragment"><div>00286 {
00287         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw=0;
00288         <span class="keywordtype">long</span> err;
00289         LPBYTE pt,<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>, ptDeRef, pdDeRef;
00290         HPROFILE aProf;
00291         PROFILE theProf;
00292     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>   bWin95;
00293     OSVERSIONINFO osvi;
00294 
00295 <span class="preprocessor">#if 0                           </span><span class="comment">/* Test for CMCreateProfile */</span>
00296         <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a19">CMCreateProfile</a>( lpColorSpace, &amp;pt );
00297         err = *(<span class="keywordtype">long</span> *)pt;
00298         SwapLong(&amp;err);
00299         <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a26">WriteProf</a>( <span class="stringliteral">"CMCreateProfile.icc"</span>, (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)pt, err );
00300         GlobalFreePtr( pt );
00301 <span class="preprocessor">#endif</span>
00302 <span class="preprocessor"></span>
00303 
00304         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a17">FillProfileFromLog</a>( lpColorSpace, &amp;theProf );
00305         <span class="keywordflow">if</span>( err ){
00306                 SetLastError( err );
00307                 <span class="keywordflow">goto</span> CleanupAndExit;
00308         }
00309         aProf = OpenColorProfile(&amp;theProf, PROFILE_READ, FILE_SHARE_READ, OPEN_EXISTING );
00310         <span class="keywordflow">if</span>( !aProf ){
00311                 err = GetLastError();
00312                 <span class="keywordflow">goto</span> CleanupAndExit;
00313         }
00314     osvi.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(OSVERSIONINFO);
00315     GetVersionEx(&amp;osvi);
00316     bWin95 = osvi.dwMajorVersion == 4 &amp;&amp;
00317              osvi.dwMinorVersion == 0 &amp;&amp;
00318              osvi.dwPlatformId == VER_PLATFORM_WIN32_WINDOWS;
00319 
00320     <span class="keywordflow">if</span> (bWin95)
00321     {
00322         PROFILE myProf;
00323         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   l;
00324 
00325         <span class="comment">//</span>
00326         <span class="comment">// Handles are not provided below LCS structure, so create handles</span>
00327         <span class="comment">//</span>
00328 
00329         myProf.dwType = PROFILE_MEMBUFFER;
00330         myProf.pProfileData = lpDevCharacter;
00331         l = *(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(myProf.pProfileData);
00332         myProf.cbDataSize = SwapLong(&amp;l);
00333         pdDeRef = OpenColorProfile(&amp;myProf, PROFILE_READ, FILE_SHARE_READ, OPEN_EXISTING );
00334         <span class="keywordflow">if</span>( !pdDeRef ){
00335                 err = GetLastError();
00336                 <span class="keywordflow">goto</span> CleanupAndExit;
00337         }
00338 
00339         ptDeRef = 0;
00340         <span class="keywordflow">if</span> (lpTargetDevCharacter)
00341         {
00342             myProf.dwType = PROFILE_MEMBUFFER;
00343             myProf.pProfileData = lpTargetDevCharacter;
00344             l = *(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(myProf.pProfileData);
00345             myProf.cbDataSize = SwapLong(&amp;l);
00346             ptDeRef = OpenColorProfile(&amp;myProf, PROFILE_READ, FILE_SHARE_READ, OPEN_EXISTING );
00347             <span class="keywordflow">if</span>( !ptDeRef ){
00348                     err = GetLastError();
00349                     <span class="keywordflow">goto</span> CleanupAndExit;
00350             }
00351         }
00352     }
00353     <span class="keywordflow">else</span>
00354     {
00355                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = ((LPBYTE)lpColorSpace+<span class="keyword">sizeof</span>(LOGCOLORSPACEA));
00356                 pdDeRef= (LPBYTE)*(PULONG_PTR)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>;
00357 
00358                 pt = ((LPBYTE)lpColorSpace+<span class="keyword">sizeof</span>(LOGCOLORSPACEA)+<span class="keyword">sizeof</span>(HPROFILE));
00359                 ptDeRef= (LPBYTE)*(PULONG_PTR)pt;
00360         }
00361 
00362         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a25">CMCreateTransformExtInternal</a>(     &amp;cw, dwFlags,
00363                                 lpColorSpace-&gt;lcsIntent, aProf, ptDeRef, pdDeRef );
00364 
00365 CleanupAndExit:
00366         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] == 0 ){
00367                 <span class="keywordflow">if</span>( theProf.pProfileData )GlobalFreePtr( theProf.pProfileData );
00368                 theProf.pProfileData = 0;
00369         }
00370     <span class="keywordflow">if</span> (bWin95)
00371     {
00372         <span class="keywordflow">if</span> (pdDeRef)
00373         {
00374             <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>(pdDeRef);
00375         }
00376         <span class="keywordflow">if</span> (ptDeRef)
00377         {
00378             <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>(ptDeRef);
00379         }
00380     }
00381         <span class="keywordflow">if</span>( err ){
00382                 <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)(ULONG_PTR)(err &amp; 255);
00383         }
00384         <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)cw;
00385 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="mscmm/icm32.c::CMCreateTransformExtInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long CMCreateTransformExtInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cwOut</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a8">UINT32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a8">UINT32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lcsIntent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>aProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>ptDeRef</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>pdDeRef</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00167">167</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00271">CloseColorProfile()</a>, <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00516">CMCreateMultiProfileTransformInternal()</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d2/d6/w98_2lh__open_2pi__color_8c-source.html#l00375">CWDisposeColorWorld()</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00038">DATA_2_PTR</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00306">icAbsoluteColorimetric</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00303">icPerceptual</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00304">icRelativeColorimetric</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00305">icSaturation</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00036">LCS_GM_BUSINESS</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00037">LCS_GM_GRAPHICS</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00041">LOCK_DATA</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a20">StoreTransform()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00032">UINT32</a>, and <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00042">UNLOCK_DATA</a>.
<p>
<pre class="fragment"><div>00173 {
00174         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw=0;
00175         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw2=0;
00176         <span class="keywordtype">long</span> err;
00177         HPROFILE saveProf;
00178         HPROFILE hArray[3];
00179         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> aIntent[3];
00180         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> aUINT32,count;
00181         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a> theModelPtr;
00182 
00183         *cwOut = 0;
00184         aIntent[0] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>;
00185         <span class="keywordflow">switch</span>( lcsIntent ){
00186           <span class="keywordflow">case</span> <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a21">LCS_GM_BUSINESS</a>:
00187                 aIntent[1] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>;
00188                 <span class="keywordflow">break</span>;
00189           <span class="keywordflow">case</span> <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a22">LCS_GM_GRAPHICS</a>:
00190                 aIntent[1] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>;
00191                 <span class="keywordflow">break</span>;
00192           <span class="keywordflow">case</span> LCS_GM_ABS_COLORIMETRIC:
00193                 aIntent[1] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>;
00194                 <span class="keywordflow">break</span>;
00195           <span class="keywordflow">default</span>:
00196                 aIntent[1] = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>;
00197                 <span class="keywordflow">break</span>;
00198         }
00199         <span class="keywordflow">if</span>( ptDeRef == 0 ){
00200                 count = 2;
00201                 hArray[0] =  aProf;
00202                 hArray[1] =  pdDeRef;
00203         }
00204         <span class="keywordflow">else</span>{
00205                 count = 3;
00206                 hArray[0] =  aProf;
00207                 hArray[1] =  ptDeRef;
00208                 hArray[2] =  pdDeRef;
00209                 <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; USE_RELATIVE_COLORIMETRIC )aIntent[2] = INTENT_RELATIVE_COLORIMETRIC;
00210                 <span class="keywordflow">else</span> aIntent[2] = INTENT_ABSOLUTE_COLORIMETRIC;
00211         }
00212 
00213         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a23">CMCreateMultiProfileTransformInternal</a>( &amp;cw, hArray, count, aIntent, count, dwFlags, 0 );
00214         <span class="keywordflow">if</span>( err ){
00215                 <span class="keywordflow">goto</span> CleanupAndExit;
00216         }
00217         <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; 0x80000000 ){                             <span class="comment">/* this is for the backward transform */</span>
00218                 count--;
00219                 saveProf = hArray[count];
00220                 hArray[count] =  hArray[0];
00221                 hArray[0] =  saveProf;
00222                 aUINT32 = aIntent[count];
00223                 aIntent[count] = aIntent[0];
00224                 aIntent[0] = aUINT32;
00225 
00226                 count++;
00227                 err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a23">CMCreateMultiProfileTransformInternal</a>( &amp;cw2, hArray, count, aIntent, count, dwFlags, 0 );
00228                 <span class="keywordflow">if</span>( err ){
00229                         <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a6">CWDisposeColorWorld</a>( cw );      <span class="comment">/* delete other cw */</span>
00230                         <span class="keywordflow">goto</span> CleanupAndExit;
00231                 }
00232                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>( cw );
00233                 theModelPtr = (<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)(<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>( cw ));
00234                 theModelPtr-&gt;pBackwardTransform = cw2;
00235                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( aTrans );
00236         }
00237 
00238 CleanupAndExit:
00239         <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>( aProf );
00240         <span class="keywordflow">if</span>( err ){
00241                 SetLastError( err );
00242                 cw = (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>)(ULONG_PTR)(err &amp; 255);
00243         }
00244         <span class="keywordflow">else</span>{
00245                 cw = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a20">StoreTransform</a>( cw );
00246         }
00247         *cwOut = cw;
00248         <span class="keywordflow">return</span> 0;
00249 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="mscmm/icm32.c::CMCreateTransformExtW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMCreateTransformExtW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpTargetDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00446">446</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00167">CMCreateTransformExtInternal()</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a18">FillProfileFromLogW()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d4/d8/ntfsexp_8h.html#a141a69">OPEN_EXISTING</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00168">OpenColorProfileW()</a>, and <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00106">pd</a>.
<p>
<pre class="fragment"><div>00450 {
00451         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw=0;
00452         <span class="keywordtype">long</span> err;
00453         LPBYTE pt,<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>, ptDeRef, pdDeRef;
00454         HPROFILE aProf;
00455         PROFILE theProf;
00456 
00457         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a18">FillProfileFromLogW</a>( lpColorSpace, &amp;theProf );
00458         <span class="keywordflow">if</span>( err ){
00459                 SetLastError( err );
00460                 <span class="keywordflow">goto</span> CleanupAndExit;
00461         }
00462         aProf = <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a12">OpenColorProfileW</a>(&amp;theProf, PROFILE_READ, FILE_SHARE_READ, OPEN_EXISTING );
00463         <span class="keywordflow">if</span>( !aProf ){
00464                 err = GetLastError();
00465                 <span class="keywordflow">goto</span> CleanupAndExit;
00466         }
00467         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = ((LPBYTE)lpColorSpace+<span class="keyword">sizeof</span>(LOGCOLORSPACEW));
00468         pdDeRef= (LPBYTE)*(PULONG_PTR)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>;
00469 
00470         pt = ((LPBYTE)lpColorSpace+<span class="keyword">sizeof</span>(LOGCOLORSPACEW)+<span class="keyword">sizeof</span>(HPROFILE));
00471         ptDeRef= (LPBYTE)*(PULONG_PTR)pt;
00472 
00473         err = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a25">CMCreateTransformExtInternal</a>(     &amp;cw, dwFlags,
00474                                 lpColorSpace-&gt;lcsIntent, aProf, ptDeRef, pdDeRef );
00475 
00476 CleanupAndExit:
00477         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] == 0 ){
00478                 <span class="keywordflow">if</span>( theProf.pProfileData )GlobalFreePtr( theProf.pProfileData );
00479                 theProf.pProfileData = 0;
00480         }
00481         <span class="keywordflow">if</span>( err ){
00482                 <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)(ULONG_PTR)(err &amp; 255);
00483         }
00484         <span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)cw;
00485 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="mscmm/icm32.c::CMCreateTransformW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMCreateTransformW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDevCharacter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a8">LPDEVCHARACTER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpTargetDevCharacter</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00509">509</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d0/d6/w98_2mscmm_2icm32_8c-source.html#l00446">CMCreateTransformExtW()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>.
<p>
<pre class="fragment"><div>00512 {
00513         <span class="keywordflow">return</span> <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a29">CMCreateTransformExtW</a>( lpColorSpace, lpDevCharacter, lpTargetDevCharacter, PROOF_MODE | ENABLE_GAMUT_CHECKING );
00514 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="mscmm/icm32.c::CMDeleteTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMDeleteTransform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hcmTransform</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00658">658</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d2/d6/w98_2lh__open_2pi__color_8c-source.html#l00375">CWDisposeColorWorld()</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00038">DATA_2_PTR</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00051">GlobalCriticalSection</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00048">IndexTransform</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00041">LOCK_DATA</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00049">TheTransform</a>, and <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00042">UNLOCK_DATA</a>.
<p>
<pre class="fragment"><div>00659 {
00660         <span class="keywordtype">long</span> actTransform = (<span class="keywordtype">long</span>)(ULONG_PTR)hcmTransform - 256;
00661         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> aTrans = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00662         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a> theModelPtr;
00663         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> theWorldRef;
00664     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bReturn = 0;
00665 
00666         __try {
00667                 EnterCriticalSection(&amp;GlobalCriticalSection);
00668                 <span class="keywordflow">if</span>( actTransform &lt; IndexTransform &amp;&amp; actTransform &gt;= 0 ){
00669                         aTrans = <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[actTransform];
00670                         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[ actTransform ] = 0;
00671                         <span class="keywordflow">if</span>( actTransform == <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a>-1 )<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a>--;
00672                         bReturn = 1;
00673                 }
00674         }
00675         __finally{
00676                 LeaveCriticalSection(&amp;GlobalCriticalSection);
00677                 
00678                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>( aTrans );
00679                 theModelPtr = (<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)(<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>( aTrans ));
00680                 theWorldRef = theModelPtr-&gt;pBackwardTransform;
00681                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( aTrans );
00682                 <span class="keywordflow">if</span>( theWorldRef != 0 ){
00683                         <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a6">CWDisposeColorWorld</a>( theWorldRef );
00684                 }
00685 
00686                 <a class="code" href="../../d1/d7/w98_2lh__open_2pi__color_8c.html#a6">CWDisposeColorWorld</a>( aTrans );
00687         }
00688     <span class="keywordflow">return</span> bReturn;
00689 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="mscmm/icm32.c::CMGetDataColorSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a> CMGetDataColorSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>long *&nbsp;</td>
          <td class="mdname" nowrap> <em>pixelSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01557">1557</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00022">CMBitmapColorSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a76">cmKYMCSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a109">cmMCEight8Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a106">cmMCFive8Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a108">cmMCSeven8Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a107">cmMCSix8Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>, and <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>.
<p>
<pre class="fragment"><div>01558 {
01559         <span class="keywordflow">switch</span>(  bmMode ){
01560         <span class="keywordflow">case</span> BM_565RGB:
01561                 *pixelSize = 16;
01562                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01563                 <span class="keywordflow">break</span>;
01564     <span class="keywordflow">case</span> BM_x555RGB:
01565                 *pixelSize = 16;
01566                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01567                 <span class="keywordflow">break</span>;
01568         <span class="keywordflow">case</span> BM_x555XYZ:
01569                 *pixelSize = 16;
01570                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>;
01571                 <span class="keywordflow">break</span>;
01572         <span class="keywordflow">case</span> BM_x555Yxy:
01573                 *pixelSize = 16;
01574                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>;
01575                 <span class="keywordflow">break</span>;
01576         <span class="keywordflow">case</span> BM_x555Lab:
01577                 *pixelSize = 16;
01578                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>;
01579                 <span class="keywordflow">break</span>;
01580         <span class="keywordflow">case</span> BM_x555G3CH:
01581                 *pixelSize = 16;
01582                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>;
01583                 <span class="keywordflow">break</span>;
01584         <span class="keywordflow">case</span> BM_RGBTRIPLETS:
01585                 *pixelSize = 24;
01586                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>;
01587                 <span class="keywordflow">break</span>;
01588         <span class="keywordflow">case</span> BM_BGRTRIPLETS:
01589                 *pixelSize = 24;
01590                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01591                 <span class="keywordflow">break</span>;
01592         <span class="keywordflow">case</span> BM_XYZTRIPLETS:
01593                 *pixelSize = 24;
01594                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>;
01595                 <span class="keywordflow">break</span>;
01596         <span class="keywordflow">case</span> BM_YxyTRIPLETS:
01597                 *pixelSize = 24;
01598                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>;
01599                 <span class="keywordflow">break</span>;
01600         <span class="keywordflow">case</span> BM_LabTRIPLETS:
01601                 *pixelSize = 24;
01602                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>;
01603                 <span class="keywordflow">break</span>;
01604         <span class="keywordflow">case</span> BM_G3CHTRIPLETS:
01605                 *pixelSize = 24;
01606                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>;
01607                 <span class="keywordflow">break</span>;
01608         <span class="keywordflow">case</span> BM_5CHANNEL:
01609                 *pixelSize = 40;
01610                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a106">cmMCFive8Space</a>;
01611                 <span class="keywordflow">break</span>;
01612         <span class="keywordflow">case</span> BM_6CHANNEL:
01613                 *pixelSize = 48;
01614                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a107">cmMCSix8Space</a>;
01615                 <span class="keywordflow">break</span>;
01616         <span class="keywordflow">case</span> BM_7CHANNEL:
01617                 *pixelSize = 56;
01618                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a108">cmMCSeven8Space</a>;
01619                 <span class="keywordflow">break</span>;
01620         <span class="keywordflow">case</span> BM_8CHANNEL:
01621                 *pixelSize = 64;
01622                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a109">cmMCEight8Space</a>;
01623                 <span class="keywordflow">break</span>;
01624         <span class="keywordflow">case</span> BM_GRAY:
01625                 *pixelSize = 8;
01626                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;
01627                 <span class="keywordflow">break</span>;
01628         <span class="keywordflow">case</span> BM_xRGBQUADS:
01629                 *pixelSize = 32;
01630                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a>;
01631                 <span class="keywordflow">break</span>;
01632         <span class="keywordflow">case</span> BM_xBGRQUADS:
01633                 *pixelSize = 32;
01634                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>;
01635                 <span class="keywordflow">break</span>;
01636 <span class="preprocessor">#if 0</span>
01637 <span class="preprocessor"></span>        <span class="keywordflow">case</span> BM_xXYZQUADS:
01638                 *pixelSize = 32;
01639                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>;
01640                 <span class="keywordflow">break</span>;
01641         <span class="keywordflow">case</span> BM_xYxyQUADS:
01642                 *pixelSize = 32;
01643                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>;
01644                 <span class="keywordflow">break</span>;
01645         <span class="keywordflow">case</span> BM_xLabQUADS:
01646                 *pixelSize = 32;
01647                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>;
01648                 <span class="keywordflow">break</span>;
01649 <span class="preprocessor">#endif</span>
01650 <span class="preprocessor"></span>    <span class="keywordflow">case</span> BM_xG3CHQUADS:
01651                 *pixelSize = 32;
01652                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>;
01653                 <span class="keywordflow">break</span>;
01654         <span class="keywordflow">case</span> BM_CMYKQUADS:
01655                 *pixelSize = 32;
01656                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a76">cmKYMCSpace</a>;
01657                 <span class="keywordflow">break</span>;
01658         <span class="keywordflow">case</span> BM_KYMCQUADS:
01659                 *pixelSize = 32;
01660                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>;
01661                 <span class="keywordflow">break</span>;
01662         <span class="keywordflow">case</span> BM_10b_RGB:
01663                 *pixelSize = 32;
01664                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01665                 <span class="keywordflow">break</span>;
01666         <span class="keywordflow">case</span> BM_10b_XYZ:
01667                 *pixelSize = 32;
01668                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>;
01669                 <span class="keywordflow">break</span>;
01670         <span class="keywordflow">case</span> BM_10b_Yxy:
01671                 *pixelSize = 32;
01672                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>;
01673                 <span class="keywordflow">break</span>;
01674         <span class="keywordflow">case</span> BM_10b_Lab:
01675                 *pixelSize = 32;
01676                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>;
01677                 <span class="keywordflow">break</span>;
01678         <span class="keywordflow">case</span> BM_10b_G3CH:
01679                 *pixelSize = 32;
01680                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>;
01681                 <span class="keywordflow">break</span>;
01682         <span class="keywordflow">case</span> BM_16b_RGB:
01683                 *pixelSize = 48;
01684                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>;
01685                 <span class="keywordflow">break</span>;
01686         <span class="keywordflow">case</span> BM_16b_XYZ:
01687                 *pixelSize = 48;
01688                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>;
01689                 <span class="keywordflow">break</span>;
01690         <span class="keywordflow">case</span> BM_16b_Yxy:
01691                 *pixelSize = 48;
01692                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>;
01693                 <span class="keywordflow">break</span>;
01694         <span class="keywordflow">case</span> BM_16b_Lab:
01695                 *pixelSize = 48;
01696                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>;
01697                 <span class="keywordflow">break</span>;
01698         <span class="keywordflow">case</span> BM_16b_G3CH:
01699                 *pixelSize = 48;
01700                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>;
01701                 <span class="keywordflow">break</span>;
01702         <span class="keywordflow">case</span> BM_16b_GRAY:
01703                 *pixelSize = 16;
01704                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;
01705                 <span class="keywordflow">break</span>;
01706         <span class="keywordflow">case</span> BM_NAMED_INDEX:
01707                 *pixelSize = 32;
01708                 <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>;
01709                 <span class="keywordflow">break</span>;
01710         <span class="keywordflow">default</span>:
01711                 *pixelSize = 0;
01712                 <span class="keywordflow">return</span> 0;
01713         }
01714 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="mscmm/icm32.c::CMGetInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI CMGetInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwInfo</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00134">134</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00031">CMM_DLL_VERSION</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00030">CMM_DRIVER_LEVEL</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00029">CMM_IDENT</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00032">CMM_VERSION</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00028">CMM_WIN_VERSION</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00012">CMS_LEVEL_1</a>, and <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
<pre class="fragment"><div>00135 {
00136         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ret = 0;
00137         <span class="keywordflow">switch</span>( dwInfo ){
00138         <span class="keywordflow">case</span> <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a4">CMM_VERSION</a>:
00139                 ret = 0x00050000;
00140                 <span class="keywordflow">break</span>;
00141         <span class="keywordflow">case</span> <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a0">CMM_WIN_VERSION</a>:
00142                 ret = 0x00040000;
00143                 <span class="keywordflow">break</span>;
00144         <span class="keywordflow">case</span> <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a3">CMM_DLL_VERSION</a>:
00145                 ret = 0x00010000;
00146                 <span class="keywordflow">break</span>;
00147         <span class="keywordflow">case</span> <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a1">CMM_IDENT</a>:
00148                 ret = 'Win ';
00149                 <span class="keywordflow">break</span>;
00150         <span class="keywordflow">case</span> CMM_LOGOICON:
00151                 ret = 100;
00152                 <span class="keywordflow">break</span>;
00153         <span class="keywordflow">case</span> CMM_DESCRIPTION:
00154                 ret = 100;
00155                 <span class="keywordflow">break</span>;
00156         <span class="keywordflow">case</span> <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a2">CMM_DRIVER_LEVEL</a>:
00157                 ret = <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a4">CMS_LEVEL_1</a>;
00158                 <span class="keywordflow">break</span>;
00159         <span class="keywordflow">default</span>:
00160                 ret = 0;
00161                 <span class="keywordflow">break</span>;
00162         }
00163         <span class="keywordflow">return</span>  ret;
00164 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="mscmm/icm32.c::CMGetNamedProfileInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMGetNamedProfileInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>aProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPNAMED_PROFILE_INFO&nbsp;</td>
          <td class="mdname" nowrap> <em>Info</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01811">1811</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a147">CMGetNamedProfileInfoProfile()</a>, and <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00311">pCMNamedProfileInfo</a>.
<p>
<pre class="fragment"><div>01812 {
01813         <span class="keywordtype">long</span> matchErr;
01814 
01815         matchErr = <a class="code" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a147">CMGetNamedProfileInfoProfile</a>( aProf, (<a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">pCMNamedProfileInfo</a>)Info );
01816         <span class="keywordflow">if</span>( matchErr ){
01817                 SetLastError( matchErr );
01818                 <span class="keywordflow">return</span> 0;
01819         }
01820         <span class="keywordflow">return</span> 1;
01821 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="mscmm/icm32.c::CMGetTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> WINAPI CMGetTransform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hcmTransform</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01729">1729</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00051">GlobalCriticalSection</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00049">TheTransform</a>.
<p>
<pre class="fragment"><div>01730 {
01731         <span class="keywordtype">long</span> actTransform = (<span class="keywordtype">long</span>)(ULONG_PTR)hcmTransform - 256;
01732         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> aTrans = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01733 
01734         __try {
01735                 EnterCriticalSection(&amp;GlobalCriticalSection);
01736                 <span class="keywordflow">if</span>( actTransform &lt; IndexTransform &amp;&amp; actTransform &gt;= 0 ){
01737                         aTrans = <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[actTransform];
01738                 }
01739         }
01740         __finally{
01741                 LeaveCriticalSection(&amp;GlobalCriticalSection);
01742         }
01743     <span class="keywordflow">return</span> aTrans;
01744 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="mscmm/icm32.c::CMIsProfileValid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMIsProfileValid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>hProfile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>lpbValid</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00918">918</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00050">Boolean</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00025">CMProfileRef</a>, and <a class="el" href="../../d1/d9/w98_2lh__open_2pi__valid_8h.html#a0">CMValidateProfile()</a>.
<p>
<pre class="fragment"><div>00921 {
00922         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> valid;
00923 
00924         <a class="code" href="../../d1/d9/w98_2lh__open_2pi__valid_8h.html#a0">CMValidateProfile</a>( (CMProfileRef)hProfile, &amp;valid );
00925 
00926         *lpbValid = valid;
00927         <span class="keywordflow">return</span> valid;
00928 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="mscmm/icm32.c::CMTranslateColors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMTranslateColors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCOLOR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpaInputColors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nColors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>COLORTYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>ctInput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCOLOR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpaOutputColors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>COLORTYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>ctOutput</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00955">955</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00273">CWMatchColors()</a>, and <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
<pre class="fragment"><div>00961 {
00962         <span class="keywordtype">long</span> matchErr;
00963         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> i;
00964 
00965     <span class="keywordflow">if</span> (lpaOutputColors != lpaInputColors){
00966         <span class="keywordflow">for</span>( i=0; i&lt;nColors; i++) lpaOutputColors[ i ] = lpaInputColors[ i ];
00967     }
00968 
00969         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a4">CWMatchColors</a>( <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform ), (<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *)lpaOutputColors, nColors );
00970         <span class="keywordflow">if</span>( matchErr ){
00971                 SetLastError( matchErr );
00972                 <span class="keywordflow">return</span> 0;
00973         }
00974         <span class="keywordflow">return</span> 1;
00975 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="mscmm/icm32.c::CMTranslateRGB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMTranslateRGB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>COLORREF&nbsp;</td>
          <td class="mdname" nowrap> <em>colorRef</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a11">LPCOLORREF</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorRef</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01356">1356</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00347">CMBitmapCallBackUPP</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00022">CMBitmapColorSpace</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a84">cmKYMC32Space</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00020">CMS_BACKWARD</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00395">CWGetColorSpaces()</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00056">CWMatchBitmap()</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00038">DATA_2_PTR</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00290">CMBitmap::height</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00256">icSigCmykData</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00290">CMBitmap::image</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00041">LOCK_DATA</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00292">CMBitmap::pixelSize</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00291">CMBitmap::rowBytes</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00293">CMBitmap::space</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00042">UNLOCK_DATA</a>, and <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00289">CMBitmap::width</a>.
<p>
<pre class="fragment"><div>01361 {
01362         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>              spaceIn;
01363         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                                InBitmap,OutBitmap;
01364         <span class="keywordtype">long</span> matchErr;
01365         COLORREF aColorRef = colorRef;
01366         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> aBgrMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01367         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a> In,Out;
01368         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a> theModelPtr;
01369         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> theWorldRef;
01370         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> theTransform = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform );
01371         
01372         <span class="keywordflow">if</span>( <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> == <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a9">CMS_BACKWARD</a> ){
01373                 <span class="keywordflow">if</span>( theTransform == 0 ){
01374                         SetLastError( (DWORD)cmparamErr );
01375                         <span class="keywordflow">return</span> 0;
01376                 }
01377                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>( theTransform );
01378                 theModelPtr = (<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)(<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>( theTransform ));
01379                 theWorldRef = theModelPtr-&gt;pBackwardTransform;
01380                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( theTransform );
01381                 <span class="keywordflow">if</span>( theWorldRef == 0 ){
01382                         SetLastError( (DWORD)cmparamErr );
01383                         <span class="keywordflow">return</span> 0;
01384                 }
01385                 theTransform = (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)theWorldRef;
01386         }
01387 
01388         spaceIn = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>;
01389         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>          = (<span class="keywordtype">char</span> *)(&amp;aColorRef);
01390         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>          = 1;
01391         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>         = 1;
01392         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>       = 4;
01393         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>      = 32;
01394         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>          = spaceIn;
01395         OutBitmap = InBitmap;   
01396         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>         = (<span class="keywordtype">char</span> *)lpColorRef;
01397 
01398         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a7">CWGetColorSpaces</a>( theTransform, &amp;In, &amp;Out );
01399         <span class="keywordflow">if</span>( matchErr ){
01400                 SetLastError( matchErr );
01401                 <span class="keywordflow">return</span> 0;
01402         }
01403         <span class="keywordflow">if</span>( Out == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a> ) OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a> = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a84">cmKYMC32Space</a>;
01404         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a0">CWMatchBitmap</a>(       theTransform, &amp;InBitmap,
01405                                                                 (CMBitmapCallBackUPP)0,(<span class="keywordtype">void</span> *)NULL,&amp;OutBitmap );
01406         <span class="keywordflow">if</span>( matchErr ){
01407                 SetLastError( matchErr );
01408                 <span class="keywordflow">return</span> 0;
01409         }
01410         <span class="keywordflow">return</span> 1;
01411 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="mscmm/icm32.c::CMTranslateRGBs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMTranslateRGBs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpSrcBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>bmInput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwHeight</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwStride</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDestBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>bmOutput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwTranslateDirection</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01054">1054</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00347">CMBitmapCallBackUPP</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00022">CMBitmapColorSpace</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace()</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00020">CMS_BACKWARD</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00056">CWMatchBitmap()</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00038">DATA_2_PTR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00290">CMBitmap::height</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00290">CMBitmap::image</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00041">LOCK_DATA</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00292">CMBitmap::pixelSize</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00291">CMBitmap::rowBytes</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00293">CMBitmap::space</a>, <a class="el" href="../../d6/d5/lh__core_2defines_8h-source.html#l00042">UNLOCK_DATA</a>, and <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00289">CMBitmap::width</a>.
<p>
<pre class="fragment"><div>01063 {
01064         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>              spaceIn,spaceOut;
01065         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                                InBitmap,OutBitmap;
01066         <span class="keywordtype">long</span> matchErr, inPixelSize, outPixelSize;
01067         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> aBgrMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01068         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a> theModelPtr;
01069         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> theWorldRef;
01070         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> theTransform = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform );
01071         
01072         <span class="keywordflow">if</span>( dwTranslateDirection == <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a9">CMS_BACKWARD</a> ){
01073                 <span class="keywordflow">if</span>( theTransform == 0 ){
01074                         SetLastError( (DWORD)cmparamErr );
01075                         <span class="keywordflow">return</span> 0;
01076                 }
01077                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>( theTransform );
01078                 theModelPtr = (<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)(<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>( theTransform ));
01079                 theWorldRef = theModelPtr-&gt;pBackwardTransform;
01080                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( theTransform );
01081                 <span class="keywordflow">if</span>( theWorldRef == 0 ){
01082                         SetLastError( (DWORD)cmparamErr );
01083                         <span class="keywordflow">return</span> 0;
01084                 }
01085                 theTransform = (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)theWorldRef;
01086         }
01087 
01088         spaceIn = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a>( bmInput, &amp;inPixelSize );
01089         <span class="keywordflow">if</span>( spaceIn == 0 ){
01090                 SetLastError( (DWORD)cmInvalidColorSpace );
01091                 <span class="keywordflow">return</span> 0;
01092         }
01093         spaceOut = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a>( bmOutput, &amp;outPixelSize );
01094         <span class="keywordflow">if</span>( spaceOut == 0 ){
01095                 SetLastError( (DWORD)cmInvalidColorSpace );
01096                 <span class="keywordflow">return</span> 0;
01097         }
01098         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>          = lpSrcBits;
01099         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>          = dwWidth;
01100         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>         = dwHeight;
01101         <span class="keywordflow">if</span>( dwStride == 0 ){
01102                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> = ( dwWidth * (inPixelSize / 8) + 3 ) &amp; ~3;
01103         }
01104         <span class="keywordflow">else</span>{
01105                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>       = dwStride;
01106         }
01107         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>      = inPixelSize;
01108         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>          = spaceIn;
01109                 
01110         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>         = lpDestBits;
01111         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>         = dwWidth;
01112         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>        = dwHeight;
01113         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>      = ( dwWidth * (outPixelSize / 8) + 3 ) &amp; ~3;
01114         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>     = outPixelSize;
01115         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>         = spaceOut;
01116 
01117         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a0">CWMatchBitmap</a>( theTransform, &amp;InBitmap,
01118                                                           (CMBitmapCallBackUPP)0,(<span class="keywordtype">void</span> *)NULL,&amp;OutBitmap );
01119         <span class="keywordflow">if</span>( matchErr ){
01120                 SetLastError( matchErr );
01121                 <span class="keywordflow">return</span> 0;
01122         }
01123         <span class="keywordflow">return</span> 1;
01124 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="mscmm/icm32.c::CMTranslateRGBsExt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI CMTranslateRGBsExt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>hcmTransform</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpSrcBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>bmInput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwHeight</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInputStride</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDestBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BMFORMAT&nbsp;</td>
          <td class="mdname" nowrap> <em>bmOutput</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwOutputStride</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBMCALLBACKFN&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnCallback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>ulCallbackData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01169">1169</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00347">CMBitmapCallBackUPP</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00022">CMBitmapColorSpace</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace()</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform()</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>, <a class="el" href="../../d4/d7/w98_2lh__open_2pi__run_8c-source.html#l00056">CWMatchBitmap()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00290">CMBitmap::height</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00290">CMBitmap::image</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00292">CMBitmap::pixelSize</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00291">CMBitmap::rowBytes</a>, <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00293">CMBitmap::space</a>, and <a class="el" href="../../d4/d5/w98_2lh__open_2pi__app_8h-source.html#l00289">CMBitmap::width</a>.
<p>
<pre class="fragment"><div>01180 {
01181         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>              spaceIn,spaceOut;
01182         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                                InBitmap,OutBitmap;
01183         <span class="keywordtype">long</span> matchErr, inPixelSize, outPixelSize;
01184         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> aBgrMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01185 
01186         spaceIn = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a>( bmInput, &amp;inPixelSize );
01187         <span class="keywordflow">if</span>( spaceIn == 0 ){
01188                 SetLastError( (DWORD)cmInvalidColorSpace );
01189                 <span class="keywordflow">return</span> 0;
01190         }
01191         spaceOut = <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a21">CMGetDataColorSpace</a>( bmOutput, &amp;outPixelSize );
01192         <span class="keywordflow">if</span>( spaceOut == 0 ){
01193                 SetLastError( (DWORD)cmInvalidColorSpace );
01194                 <span class="keywordflow">return</span> 0;
01195         }
01196         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>          = lpSrcBits;
01197         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>          = dwWidth;
01198         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>         = dwHeight;
01199         <span class="keywordflow">if</span>( dwInputStride == 0 ){
01200                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> = ( dwWidth * (inPixelSize / 8) + 3 ) &amp; ~3;
01201         }
01202         <span class="keywordflow">else</span>{
01203                 InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>       = dwInputStride;
01204         }
01205         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>      = inPixelSize;
01206         InBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>          = spaceIn;
01207                 
01208         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>         = lpDestBits;
01209         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>         = dwWidth;
01210         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>        = dwHeight;
01211         <span class="keywordflow">if</span>( dwOutputStride == 0 ){
01212                 OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> = ( dwWidth * (outPixelSize / 8) + 3 ) &amp; ~3;
01213         }
01214         <span class="keywordflow">else</span>{
01215                 OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>      = dwOutputStride;
01216         }
01217         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>     = outPixelSize;
01218         OutBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>         = spaceOut;
01219 
01220         matchErr = <a class="code" href="../../d3/d8/w98_2lh__open_2pi__run_8c.html#a0">CWMatchBitmap</a>( <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a22">CMGetTransform</a>( hcmTransform ), &amp;InBitmap,
01221                                                           (CMBitmapCallBackUPP)lpfnCallback,(<span class="keywordtype">void</span> *)ulCallbackData,&amp;OutBitmap );
01222         <span class="keywordflow">if</span>( matchErr ){
01223                 SetLastError( matchErr );
01224                 <span class="keywordflow">return</span> 0;
01225         }
01226         <span class="keywordflow">return</span> 1;
01227 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="mscmm/icm32.c::DllMain" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI DllMain           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hinstDLL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fdwReason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpvReserved</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00071">71</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00051">GlobalCriticalSection</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00074 {
00075 <span class="keywordflow">switch</span> (fdwReason)
00076    {
00077    <span class="keywordflow">case</span> DLL_PROCESS_ATTACH:
00078       DisableThreadLibraryCalls(hinstDLL);
00079           InitializeCriticalSection(&amp;GlobalCriticalSection);
00080       <span class="keywordflow">break</span>;
00081    <span class="keywordflow">case</span> DLL_PROCESS_DETACH:
00082       DeleteCriticalSection(&amp;GlobalCriticalSection);
00083       <span class="keywordflow">break</span>;
00084    }
00085 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00086 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="mscmm/icm32.c::FillProfileFromLog" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long FillProfileFromLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>theProf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01478">1478</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00023">CMError</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00031">LCS_CALIBRATED_RGB</a>, and <a class="el" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a1">MyNewAbstract()</a>.
<p>
<pre class="fragment"><div>01480 {
01481         <span class="keywordtype">long</span> l;
01482         <a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *aProf;
01483         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>  err = -1;
01484 
01485         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] ){
01486                 theProf-&gt;pProfileData = (<span class="keywordtype">char</span> *)lpColorSpace-&gt;lcsFilename;
01487                 theProf-&gt;dwType = PROFILE_FILENAME;
01488                 theProf-&gt;cbDataSize = lstrlenA((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)theProf-&gt;pProfileData) * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>);
01489                 err = 0;
01490         }
01491         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsCSType == <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a17">LCS_CALIBRATED_RGB</a> ){
01492                 err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a1">MyNewAbstract</a>( lpColorSpace, &amp;aProf );
01493                 theProf-&gt;pProfileData = ((PVOID *)aProf);
01494                 theProf-&gt;dwType = PROFILE_MEMBUFFER;
01495                 l = *(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(theProf-&gt;pProfileData);
01496                 theProf-&gt;cbDataSize = SwapLong(&amp;l);
01497         }
01498         <span class="keywordflow">else</span>  theProf-&gt;pProfileData = 0;
01499 
01500         <span class="keywordflow">return</span> err;
01501 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="mscmm/icm32.c::FillProfileFromLogW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long FillProfileFromLogW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPLOGCOLORSPACEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorSpace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PPROFILE&nbsp;</td>
          <td class="mdname" nowrap> <em>theProf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01518">1518</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00023">CMError</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d5/aug98_2dll32_2icm_8h-source.html#l00031">LCS_CALIBRATED_RGB</a>, and <a class="el" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a0">MyNewAbstractW()</a>.
<p>
<pre class="fragment"><div>01520 {
01521         <span class="keywordtype">long</span> l;
01522         <a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *aProf;
01523         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>  err = -1;
01524 
01525         <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsFilename[0] ){
01526                 theProf-&gt;pProfileData = (<span class="keywordtype">char</span> *)lpColorSpace-&gt;lcsFilename;
01527                 theProf-&gt;dwType = PROFILE_FILENAME;
01528                 theProf-&gt;cbDataSize = lstrlenW((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)theProf-&gt;pProfileData) * <span class="keyword">sizeof</span>(WCHAR);
01529                 err = 0;
01530         }
01531         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( lpColorSpace-&gt;lcsCSType == <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a17">LCS_CALIBRATED_RGB</a> ){
01532                 err = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a0">MyNewAbstractW</a>( lpColorSpace, &amp;aProf );
01533                 theProf-&gt;pProfileData = ((PVOID *)aProf);
01534                 theProf-&gt;dwType = PROFILE_MEMBUFFER;
01535                 l = *(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *)(theProf-&gt;pProfileData);
01536                 theProf-&gt;cbDataSize = SwapLong(&amp;l);
01537         }
01538         <span class="keywordflow">else</span>  theProf-&gt;pProfileData = 0;
01539 
01540         <span class="keywordflow">return</span> err;
01541 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="mscmm/icm32.c::StoreTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> StoreTransform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>aRef</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01759">1759</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
References <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00350">CMWorldRef</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00051">GlobalCriticalSection</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00035">HCMTRANSFORM</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00048">IndexTransform</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00049">TheTransform</a>.
<p>
<pre class="fragment"><div>01760 {
01761         <span class="keywordtype">long</span> i;
01762     <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01763         
01764         __try {
01765                 EnterCriticalSection(&amp;GlobalCriticalSection);
01766 
01767                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a> &gt;= 1000 )<span class="keywordflow">return</span> (<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a>)ERROR_NOT_ENOUGH_MEMORY;
01768                 <span class="keywordflow">for</span>( i = 0; i&lt;<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a> ; i++ ){
01769                         <span class="keywordflow">if</span>( <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[i] == 0 ){
01770                                 <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[i] = aRef;
01771                                 cw = (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>)(ULONG_PTR)(i + 256 );
01772                         }
01773                 }
01774                 <span class="keywordflow">if</span>( i &gt;= <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a> ){
01775                         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a13">TheTransform</a>[<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a>] = aRef;
01776                         <a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a>++;
01777                         cw = (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a28">CMWorldRef</a>)(ULONG_PTR)(<a class="code" href="../../d8/d6/mscmm_2icm32_8c.html#a12">IndexTransform</a> - 1 + 256);
01778                 }
01779         }
01780         __finally{
01781                 LeaveCriticalSection(&amp;GlobalCriticalSection);
01782         }
01783 
01784    <span class="keywordflow">return</span> cw;
01785 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="mscmm/icm32.c::WriteProf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void WriteProf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d3/structicProfile.html">icProfile</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>theProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>currentSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a14" doxytag="mscmm/icm32.c::GlobalCriticalSection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CRITICAL_SECTION <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a14">GlobalCriticalSection</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00051">51</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00658">CMDeleteTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01729">CMGetTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00071">DllMain()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01759">StoreTransform()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="mscmm/icm32.c::IndexTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a12">IndexTransform</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00048">48</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00658">CMDeleteTransform()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01759">StoreTransform()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="mscmm/icm32.c::TheTransform" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a7">HCMTRANSFORM</a> <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a13">TheTransform</a>[1000] = {0}          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00049">49</a> of file <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html">mscmm/icm32.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l00658">CMDeleteTransform()</a>, <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01729">CMGetTransform()</a>, and <a class="el" href="../../d9/d5/mscmm_2icm32_8c-source.html#l01759">StoreTransform()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:08 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
