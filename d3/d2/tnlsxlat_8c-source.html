<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tnlsxlat.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tnlsxlat.c</h1><a href="../../d2/d3/tnlsxlat_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    tnlsxlat.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Test program for the Nlsxlat Procedures</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Ian James     [IanJa]    03-Feb-1994</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00022 
00023 <span class="preprocessor">#include "nt.h"</span>
00024 <span class="preprocessor">#include "ntrtl.h"</span>
00025 
<a name="l00026"></a><a class="code" href="../../d2/d3/tnlsxlat_8c.html#a0">00026</a> <span class="preprocessor">#define NELEM(p) (sizeof(p) / sizeof(*(p)))</span>
00027 <span class="preprocessor"></span>
<a name="l00028"></a><a class="code" href="../../d2/d3/tnlsxlat_8c.html#a1">00028</a> <span class="keywordtype">char</span> <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a1">OEMBuff</a>[1000];
<a name="l00029"></a><a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">00029</a> <span class="keywordtype">char</span> <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[1000];
<a name="l00030"></a><a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">00030</a> WCHAR <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>[2000];
00031 
00032 <span class="keywordtype">int</span>
<a name="l00033"></a><a class="code" href="../../d2/d3/tnlsxlat_8c.html#a4">00033</a> <a class="code" href="../../d2/d5/editreg_8c.html#a87">main</a>(
00034     <span class="keywordtype">int</span> argc,
00035     <span class="keywordtype">char</span> *argv[]
00036     )
00037 {
00038     ULONG j;
00039     ULONG cb;
00040     <span class="keywordtype">char</span> *pch;
00041 
00042     printf(<span class="stringliteral">"Start NlsXlatTest()\n"</span>);
00043 
00044     <span class="comment">//</span>
00045     <span class="comment">//  First initialize the buffers</span>
00046     <span class="comment">//</span>
00047 
00048     <span class="keywordflow">for</span> (j = 0; j &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a1">OEMBuff</a>); j++) {
00049         <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a1">OEMBuff</a>[j] = (<span class="keywordtype">char</span>)(j * 17);
00050         <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[j] = (<span class="keywordtype">char</span>)(j * 19);
00051     }
00052 
00053     <span class="comment">//</span>
00054     <span class="comment">//  TEST 1</span>
00055     <span class="comment">//  RtlMultiByteToUnicodeN, RtlUnicodeToMultiByteN</span>
00056     <span class="comment">//</span>
00057 
00058     printf(<span class="stringliteral">"Test 1: MultiByteToUnicodeN &amp; RtlUnicodeToMultiByteN\n"</span>);
00059 
00060     <span class="comment">// TEST 1.1</span>
00061     <span class="comment">//</span>
00062     printf(<span class="stringliteral">"  Test 1.1: A-&gt;U U-&gt;A\n"</span>);
00063 
00064     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>), &amp;cb, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>));
00065     printf(<span class="stringliteral">"    %d bytes converted to Unicode\n"</span>, cb);
00066     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>), &amp;cb, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>));
00067     printf(<span class="stringliteral">"    %d bytes converted back to ANSI\n"</span>, cb);
00068 
00069     <span class="keywordflow">for</span> (j = 0; j &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>); j++) {
00070         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[j] != (<span class="keywordtype">char</span>)(j * 19)) {
00071             printf(<span class="stringliteral">"ABuff[%d] was 0x%02x, now 0x%02x\n"</span>,
00072                     j, (<span class="keywordtype">char</span>)(j * 19), <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[j]);
00073             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00074         }
00075     }
00076     printf(<span class="stringliteral">"    Test 1.1 OK\n"</span>);
00077 
00078     <span class="comment">// TEST 1.2</span>
00079     <span class="comment">//</span>
00080     printf(<span class="stringliteral">"  Test 1.2: A-&gt;U U-&gt;A (source &amp; dest buffers the same)\n"</span>);
00081     RtlCopyMemory(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>));
00082     
00083     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>), &amp;cb, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>));
00084     printf(<span class="stringliteral">"    %d bytes converted to Unicode\n"</span>, cb);
00085     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>), &amp;cb, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>));
00086     printf(<span class="stringliteral">"    %d bytes converted back to ANSI\n"</span>, cb);
00087 
00088     pch = (LPSTR)<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a3">UBuff</a>;
00089     <span class="keywordflow">for</span> (j = 0; j &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>); j++) {
00090         <span class="keywordflow">if</span> (pch[j] != <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[j]) {
00091             printf(<span class="stringliteral">"    ABuff[%d] was 0x%02x, was turned into 0x%02x\n"</span>,
00092                     j, <a class="code" href="../../d2/d3/tnlsxlat_8c.html#a2">ABuff</a>[j], pch[j]);
00093             printf(<span class="stringliteral">"    Test 1.2 FAILED!\n"</span>);
00094             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00095         }
00096     }
00097 
00098     printf(<span class="stringliteral">"    Test 1.2 OK!\n"</span>);
00099 
00100     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00101 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:00 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
