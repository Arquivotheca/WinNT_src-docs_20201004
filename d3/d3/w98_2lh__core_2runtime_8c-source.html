<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: runtime.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>runtime.c</h1><a href="../../d2/d4/w98_2lh__core_2runtime_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment">        File:           LHCMRuntime.c</span>
00003 <span class="comment"></span>
00004 <span class="comment">        Contains:       </span>
00005 <span class="comment"></span>
00006 <span class="comment">        Written by:     U. J. Krabbenhoeft</span>
00007 <span class="comment"></span>
00008 <span class="comment">        Copyright:      © 1993-1997 by Heidelberger Druckmaschinen AG, all rights reserved.</span>
00009 <span class="comment"></span>
00010 <span class="comment">        Version:        </span>
00011 <span class="comment">*/</span>
00012 
00013 <span class="preprocessor">#ifndef LHGeneralIncs_h</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#include "General.h"</span>
00015 <span class="preprocessor">#endif</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#ifndef LHCalcEngine_h</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#include "CalcEng.h"</span>
00019 <span class="preprocessor">#endif</span>
00020 <span class="preprocessor"></span>
00021 <span class="preprocessor">#ifndef LHCalcEngine1Dim_h</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#include "CalcEng1.h"</span>
00023 <span class="preprocessor">#endif</span>
00024 <span class="preprocessor"></span>
00025 <span class="preprocessor">#ifdef ALLOW_MMX</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#ifndef LHCalcEngineFas_h</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#include "CalcEnF.h"</span>
00028 <span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00030 <span class="preprocessor"></span>
00031 <span class="preprocessor">#ifndef LHCalcNDim_h</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#include "CalcNDim.h"</span>
00033 <span class="preprocessor">#endif</span>
00034 <span class="preprocessor"></span>
00035 <span class="preprocessor">#ifndef LHCMRuntime_h</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#include "Runtime.h"</span>
00037 <span class="preprocessor">#endif</span>
00038 <span class="preprocessor"></span>
00039 <span class="preprocessor">#if ! realThing</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define kThisFile kCMMRuntimeID</span>
00042 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> gUSE_NDIM_FOR_BITMAP;
00043 <span class="preprocessor">#endif</span>
00044 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00045 <span class="preprocessor"></span>
00046 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>
00047 {
<a name="l00048"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">00048</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a>;
<a name="l00049"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">00049</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a>;
<a name="l00050"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">00050</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>;
<a name="l00051"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">00051</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a>;
<a name="l00052"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o11">00052</a>         <span class="keywordtype">void</span>*   <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>;
<a name="l00053"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o12">00053</a>         <span class="keywordtype">void</span>*   <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>;
<a name="l00054"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">00054</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
<a name="l00055"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o7">00055</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o7">processedLinesOut</a>;
<a name="l00056"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">00056</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a>;
<a name="l00057"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">00057</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a>;
<a name="l00058"></a><a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">00058</a>         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> <a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a>;
00059 } <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>;
00060 
00061 <span class="comment">/* -------------------------------------------------------------------------------------------------------------- */</span>
<a name="l00062"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a0">00062</a> <span class="preprocessor">#define kProgressTicks  30                      </span><span class="comment">/* .5secs -&gt; min. time between calls of progressproc */</span>
<a name="l00063"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a1">00063</a> <span class="preprocessor">#define kMaxTempBlock   300 * 1024      </span><span class="comment">/* allow max. 300 kByte temp buffer */</span>
00064 
00065 <span class="comment">/* -------------------------------------------------------------------------------------------------------------- */</span>
<a name="l00066"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a8">00066</a> <span class="keyword">typedef</span> <a class="code" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a11">CMError</a>  (*CalcProcPtr)(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParamPtr,
00067                                                             <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>  lutParamPtr );
00068 
<a name="l00069"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a9">00069</a> <span class="keyword">typedef</span> <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>      <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a9">CalcProcUPP</a>;
<a name="l00070"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a10">00070</a> <span class="keyword">typedef</span> <a class="code" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a11">CMError</a>  (*CalcProc1DimPtr)(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParamPtr,
00071                                                                         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>  lutParamPtr, <span class="keywordtype">char</span> OutDim );
00072 
<a name="l00073"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a11">00073</a> <span class="keyword">typedef</span> <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a10">CalcProc1DimPtr</a>          <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a11">CalcProc1DimUPP</a>;
<a name="l00074"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a2">00074</a> <span class="preprocessor">#define NewCalcProc(userRoutine)                \</span>
00075 <span class="preprocessor">                ((CalcProcUPP) (userRoutine))</span>
<a name="l00076"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a3">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define NewCalcProc1Dim(userRoutine)            \</span>
00077 <span class="preprocessor">                ((CalcProc1DimUPP) (userRoutine))</span>
<a name="l00078"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a4">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define CallCalcProc(userRoutine, calcParamPtr, lutParamPtr)            \</span>
00079 <span class="preprocessor">                (*(userRoutine))( (calcParamPtr), (lutParamPtr) )</span>
00080 <span class="preprocessor"></span>
00081 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00082 <span class="comment">        local prototypes</span>
00083 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00084 
00085 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a12">Convert5To8</a>                             ( Ptr           dataPtr5,
00086                                                                   Ptr           dataPtr8,
00087                                                                   SINT32        startLine,
00088                                                                   SINT32        height,
00089                                                                   SINT32        width,
00090                                                                   SINT32        rowBytes5 );
00091 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a13">Convert8To5</a>                             ( Ptr           dataPtr8,
00092                                                                   Ptr           dataPtr5,
00093                                                                   SINT32        startLine,
00094                                                                   SINT32        height,
00095                                                                   SINT32        width,
00096                                                                   SINT32        rowBytes5 );
00097 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a14">Convert8To1</a>                             ( Ptr           dataPtr8,
00098                                                                   Ptr           dataPtr5,
00099                                                                   SINT32        startLine,
00100                                                                   SINT32        height,
00101                                                                   SINT32        width,
00102                                                                   SINT32        rowBytes5 );
00103 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a15">Convert16To10</a>                   ( Ptr           dataPtr16, 
00104                                                                   Ptr           dataPtr10,
00105                                                                   SINT32        startLine,
00106                                                                   SINT32        height,
00107                                                                   SINT32        width,
00108                                                                   SINT32        rowBytes10 );   
00109 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a16">Convert10To16</a>                   ( Ptr           dataPtr10, 
00110                                                                   Ptr           dataPtr16,
00111                                                                   SINT32        startLine,
00112                                                                   SINT32        height,
00113                                                                   SINT32        width,
00114                                                                   SINT32        rowBytes10 );           
00115 
00116 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a17">FillLutParam</a>                    ( <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00117                                                                   CMMModelPtr           modelingData );
00118 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a18">FillLutParamChk</a>                 ( <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00119                                                                   CMMModelPtr           modelingData );
00120 
00121 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a19">FillCalcParam</a>                   ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00122                                                                   <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *      bitMap, 
00123                                                                   <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *      matchedBitMap );
00124 
00125 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a20">FillCalcParamCM</a>                 ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00126                                                                   <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00127                                                                   <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>*                      myColors,
00128                                                                   SINT32                                count );
00129 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a21">CheckInputColorSpace</a>    ( <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*       bitMap,
00130                                                                   <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00131                                                                   <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info,
00132                                                                   OSType                        inColorSpace,
00133                                                                   <span class="keywordtype">long</span>                          colorLutInDim );
00134 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a22">CheckOutputColorSpace</a>   ( <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*       bitMap,
00135                                                                   <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00136                                                                   <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info,
00137                                                                   OSType                        outColorSpace,
00138                                                                   <span class="keywordtype">long</span>                          colorLutOutDim );
00139 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a23">SetOutputColorSpaceInplace</a>      ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00140                                                                           <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info,
00141                                                                           OSType                        outColorSpace );
00142 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a24">CheckOutputColorSpaceChk</a>( <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*       bitMap,
00143                                                                   <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00144                                                                   <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info );
00145 
00146 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a25">AllocBufferCheckCM</a>              ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00147                                                                   <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info );
00148                                                                   
00149 <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>     <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a26">FindLookupRoutine</a>       ( <span class="keyword">const</span> <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>*             lutParam,
00150                                                                   <span class="keyword">const</span> <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>* info );
00151 
00152 <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>     <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>         ( <span class="keyword">const</span> <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>*    calcParam,
00153                                                                   <span class="keyword">const</span> <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>*             lutParam,
00154                                                                   <span class="keyword">const</span> <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>* info,
00155                                                                   <span class="keyword">const</span> Boolean                 lookupOnly );
00156 
00157 
00158 <span class="preprocessor">#ifdef __MWERKS__</span>
00159 <span class="preprocessor"></span><span class="preprocessor">#pragma mark ================  packing/unpacking  ================</span>
00160 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00161 <span class="preprocessor"></span>
00162 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00163 <span class="comment">        Convert5To8                                                             convert cmRGB16Space to cmRGB24Space</span>
00164 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00165 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>
00166 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a12">Convert5To8</a>     ( Ptr           dataPtr5,
00167                           Ptr           dataPtr8,
00168                           SINT32        startLine,
00169                           SINT32        height,
00170                           SINT32        width,
00171                           SINT32        rowBytes5 )
00172 {
00173         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*         srcPtr16;
00174         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*          destPtr8   = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)dataPtr8;
00175         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>           data8;
00176         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>          three5Bits;
00177         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          lineLoop;
00178         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          pixelLoop;
00179         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>           err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00180         
00181         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert5To8"</span>)
00182         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00183         {
00184                 srcPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)(dataPtr5 + (lineLoop*rowBytes5));
00185                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00186                 {
00187                         three5Bits = *srcPtr16++;
00188                         
00189                         data8 = (three5Bits &gt;&gt; 10) &amp; 0x001F;    
00190                         *destPtr8++ = (data8 &lt;&lt; 3) | (data8 &gt;&gt;2);
00191                         
00192                         data8 = (three5Bits &gt;&gt; 5) &amp; 0x001F;
00193                         *destPtr8++ = (data8 &lt;&lt; 3) | (data8 &gt;&gt;2);
00194         
00195                         data8 = three5Bits &amp; 0x001F;    
00196                         *destPtr8++ = (data8 &lt;&lt; 3) | (data8 &gt;&gt;2);
00197                 }
00198         }
00199         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert5To8"</span>)
00200         return err;
00201 }
00202 
00203 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00204 <span class="comment">        Convert8To5                                                             convert cmRGB24Space to cmRGB16Space</span>
00205 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00206 OSErr
00207 Convert8To5     ( Ptr           dataPtr8,
00208                           Ptr           dataPtr5,
00209                           SINT32        startLine,
00210                           SINT32        height,
00211                           SINT32        width,
00212                           SINT32        rowBytes5 )
00213 {
00214         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>* destPtr16;
00215         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*  srcPtr8         = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)dataPtr8;
00216         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>  three5Bits;
00217         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  lineLoop;
00218         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  pixelLoop;
00219         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00220         
00221         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert8To5"</span>)
00222         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00223         {
00224                 destPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)(dataPtr5 + (lineLoop*rowBytes5));
00225                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00226                 {
00227                         three5Bits  = (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00F8) &lt;&lt; 7);       
00228                         srcPtr8++;
00229                         three5Bits |= (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00F8) &lt;&lt; 2);       
00230                         srcPtr8++;
00231                         three5Bits |= (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00F8) &gt;&gt; 3);       
00232                         srcPtr8++;
00233 
00234                         *destPtr16++ = three5Bits;
00235                 }
00236         }
00237         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert8To5"</span>)
00238         return err;
00239 }
00240 #ifdef PI_Application_h
00241 OSErr   Convert565To8                   ( Ptr           dataPtr5,
00242                                                                   Ptr           dataPtr8,
00243                                                                   SINT32        startLine,
00244                                                                   SINT32        height,
00245                                                                   SINT32        width,
00246                                                                   SINT32        rowBytes5 );
00247 OSErr   Convert8To565                   ( Ptr           dataPtr8,
00248                                                                   Ptr           dataPtr5,
00249                                                                   SINT32        startLine,
00250                                                                   SINT32        height,
00251                                                                   SINT32        width,
00252                                                                   SINT32        rowBytes5 );
00253 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00254 <span class="comment">        Convert565To8                                                           convert cmRGB16_565Space to cmRGB24Space</span>
00255 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00256 OSErr
00257 Convert565To8( Ptr              dataPtr5,
00258                           Ptr           dataPtr8,
00259                           SINT32        startLine,
00260                           SINT32        height,
00261                           SINT32        width,
00262                           SINT32        rowBytes5 )
00263 {
00264         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*         srcPtr16;
00265         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*          destPtr8   = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)dataPtr8;
00266         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>           data8;
00267         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>          three5Bits;
00268         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          lineLoop;
00269         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          pixelLoop;
00270         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>           err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00271         
00272         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert565To8"</span>)
00273         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00274         {
00275                 srcPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)(dataPtr5 + (lineLoop*rowBytes5));
00276                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00277                 {
00278                         three5Bits = *srcPtr16++;
00279                         
00280                         data8 = (three5Bits &gt;&gt; 11) &amp; 0x001F;    
00281                         *destPtr8++ = (data8 &lt;&lt; 3) | (data8 &gt;&gt;2);
00282                         
00283                         data8 = (three5Bits &gt;&gt; 5) &amp; 0x003F;
00284                         *destPtr8++ = (data8 &lt;&lt; 2) | (data8 &gt;&gt;4);
00285         
00286                         data8 = three5Bits &amp; 0x001F;    
00287                         *destPtr8++ = (data8 &lt;&lt; 3) | (data8 &gt;&gt;2);
00288                 }
00289         }
00290         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert565To8"</span>)
00291         return err;
00292 }
00293 
00294 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00295 <span class="comment">        Convert8To565                                                           convert cmRGB24Space to cmRGB16_565Space</span>
00296 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00297 OSErr
00298 Convert8To565( Ptr              dataPtr8,
00299                           Ptr           dataPtr5,
00300                           SINT32        startLine,
00301                           SINT32        height,
00302                           SINT32        width,
00303                           SINT32        rowBytes5 )
00304 {
00305         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>* destPtr16;
00306         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*  srcPtr8         = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)dataPtr8;
00307         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>  three5Bits;
00308         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  lineLoop;
00309         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  pixelLoop;
00310         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00311         
00312         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert8To565"</span>)
00313         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00314         {
00315                 destPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)(dataPtr5 + (lineLoop*rowBytes5));
00316                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00317                 {
00318                         three5Bits  = (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00F8) &lt;&lt; 8);       
00319                         srcPtr8++;
00320                         three5Bits |= (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00FC) &lt;&lt; 3);       
00321                         srcPtr8++;
00322                         three5Bits |= (((<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)*srcPtr8 &amp; 0x00F8) &gt;&gt; 3);       
00323                         srcPtr8++;
00324 
00325                         *destPtr16++ = three5Bits;
00326                 }
00327         }
00328         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert8To565"</span>)
00329         return err;
00330 }
00331 #endif
00332 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00333 <span class="comment">        Convert8To1                                                             convert 8-bit to 1-bit (gamut result)</span>
00334 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00335 OSErr
00336 Convert8To1     ( Ptr           dataPtr8,
00337                           Ptr           dataPtr1,
00338                           SINT32        startLine,
00339                           SINT32        height,
00340                           SINT32        width,
00341                           SINT32        rowBytes1 )
00342 {
00343         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*  destPtr8;
00344         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*  srcPtr8  = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)dataPtr8;
00345         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>   theWord  = 0;
00346         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  lineLoop;
00347         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  pixelLoop;
00348         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00349 
00350         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert8To1"</span>)
00351         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00352         {
00353                 destPtr8 = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)(dataPtr1 + (lineLoop*rowBytes1));
00354                 <span class="keywordflow">for</span> ( pixelLoop = 0; pixelLoop &lt; width; pixelLoop++ )
00355                 {
00356                         <span class="keywordflow">if</span> (*srcPtr8)
00357                                 theWord |= (1&lt;&lt; (7- ( pixelLoop &amp; 7)));
00358                         <span class="keywordflow">if</span> ( (pixelLoop &amp; 7) == 7)
00359                         {
00360                                 *destPtr8++ = theWord;
00361                                 theWord = 0;
00362                         }
00363                         srcPtr8 ++;
00364                 }
00365                 <span class="keywordflow">if</span> (width % 8)
00366                 {
00367                         *destPtr8 = theWord | ( ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)255 &gt;&gt; (width % 8)));
00368                         theWord = 0;
00369                 }
00370         }
00371         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert8To1"</span>)
00372         return err;
00373 }
00374 
00375 <span class="comment">/* -----------------------------------------------------------------------</span>
00376 <span class="comment">        Convert16To10</span>
00377 <span class="comment">   ----------------------------------------------------------------------- */</span>
00378 OSErr
00379 Convert16To10   ( Ptr           dataPtr16, 
00380                                   Ptr           dataPtr10,
00381                                   SINT32        startLine,
00382                                   SINT32        height,
00383                                   SINT32        width,
00384                                   SINT32        rowBytes10 )
00385 {
00386         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>          data16_1;
00387         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>          data16_2;
00388         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>          data16_3;
00389         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*         srcPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)dataPtr16;
00390         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>*         destPtr32;
00391         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          lineLoop;
00392         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          pixelLoop;
00393         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00394 
00395         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert16To10"</span>)
00396         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00397         {
00398                 destPtr32 = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>*)( dataPtr10 + (lineLoop * rowBytes10));
00399                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00400                 {
00401                         data16_1 = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)*srcPtr16++  &amp; 0x0000FFC0) &lt;&lt; 14;
00402                         data16_2 = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)*srcPtr16++  &amp; 0x0000FFC0) &lt;&lt;  4;
00403                         data16_3 = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)*srcPtr16++  &amp; 0x0000FFC0) &gt;&gt;  6;
00404                         *destPtr32++ = data16_1 | data16_2 | data16_3;
00405                 }
00406         }
00407         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert16To10"</span>)
00408         return err;
00409 }
00410 
00411 <span class="comment">/* -----------------------------------------------------------------------</span>
00412 <span class="comment">        Convert10To16</span>
00413 <span class="comment">   ----------------------------------------------------------------------- */</span>
00414 OSErr
00415 Convert10To16   ( Ptr           dataPtr10, 
00416                                   Ptr           dataPtr16,
00417                                   SINT32        startLine,
00418                                   SINT32        height,
00419                                   SINT32        width,
00420                                   SINT32        rowBytes10 )            
00421 {
00422         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>          data16;
00423         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>          data32;
00424         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>*         srcPtr32;
00425         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*         destPtr16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>*)dataPtr16;
00426         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          lineLoop;
00427         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          pixelLoop;
00428         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00429 
00430         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"Convert10To16"</span>)
00431         for (lineLoop = startLine;  lineLoop &lt; startLine + height; lineLoop++)
00432         {
00433                 srcPtr32 = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>*)( dataPtr10 + (lineLoop * rowBytes10));
00434                 <span class="keywordflow">for</span> (pixelLoop = 0; pixelLoop &lt; width; pixelLoop++)
00435                 {
00436                         data32 = *srcPtr32++;
00437                         data16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)(data32&gt;&gt;14) &amp; 0x0FFC0;
00438                         *destPtr16++  = data16 | data16&gt;&gt;10;
00439                         data16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)(data32&gt;&gt;4) &amp; 0x0FFC0;
00440                         *destPtr16++  = data16 | data16&gt;&gt;10;
00441                         data16 = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>)(data32&lt;&lt;6);
00442                         *destPtr16++  = data16 | data16&gt;&gt;10;
00443                 }
00444         }
00445         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"Convert10To16"</span>)
00446         return err;
00447 }
00448 
00449 #ifdef __MWERKS__
00450 #pragma mark ================  setup &amp; checking  ================
00451 #endif
00452 
00453 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00454 <span class="comment">        FillLutParam</span>
00455 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00456 CMError
00457 FillLutParam    ( <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00458                                   CMMModelPtr           modelingData )
00459 {
00460         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00461 
00462         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FillLutParam"</span>)
00463         *lutParam = (modelingData)-&gt;lutParam;
00464 <span class="preprocessor">#if ! LUTS_ARE_PTR_BASED</span>
00465 <span class="preprocessor"></span>        lutParam-&gt;inputLut                        = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;lutParam.inputLut;
00466         lutParam-&gt;outputLut                       = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;lutParam.outputLut;
00467         lutParam-&gt;colorLut                        = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;lutParam.colorLut;
00468 <span class="preprocessor">#endif</span>
00469 <span class="preprocessor"></span>        <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"FillLutParam"</span>)
00470         return err;
00471 }
00472 
00473 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00474 <span class="comment">        FillLutParamChk</span>
00475 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00476 CMError
00477 FillLutParamChk         ( <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00478                                           CMMModelPtr           modelingData )
00479 {
00480         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00481 
00482         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FillLutParamChk"</span>)
00483         *lutParam = (modelingData)-&gt;gamutLutParam;
00484 <span class="preprocessor">#if ! LUTS_ARE_PTR_BASED</span>
00485 <span class="preprocessor"></span>        lutParam-&gt;inputLut              = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;gamutLutParam.inputLut;
00486         lutParam-&gt;outputLut             = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;gamutLutParam.outputLut;
00487         lutParam-&gt;colorLut              = <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(modelingData)-&gt;gamutLutParam.colorLut;
00488 <span class="preprocessor">#endif</span>
00489 <span class="preprocessor"></span>        <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"FillLutParamChk"</span>)
00490         return err;
00491 }
00492 
00493 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00494 <span class="comment">        FillCalcParam</span>
00495 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00496 CMError
00497 FillCalcParam   ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00498                                   const <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *      bitMap, 
00499                                   const <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *      matchedBitMap )
00500 {
00501         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00502 
00503         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FillCalcParam"</span>)
00504 
00505         calcParam-&gt;cmInputColorSpace    = bitMap-&gt;space;
00506         calcParam-&gt;cmOutputColorSpace   = matchedBitMap-&gt;space;
00507         calcParam-&gt;cmPixelPerLine               = bitMap-&gt;width;
00508         calcParam-&gt;cmInputBytesPerLine  = bitMap-&gt;rowBytes;
00509         calcParam-&gt;cmOutputBytesPerLine = matchedBitMap-&gt;rowBytes;
00510         calcParam-&gt;cmLineCount                  = bitMap-&gt;height;
00511 
00512         LH_END_PROC("FillCalcParam")
00513         return err;
00514 }
00515 
00516 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00517 <span class="comment">        FillCalcParamCM</span>
00518 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00519 CMError
00520 FillCalcParamCM ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00521                                   <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParamPtr</a>         lutParam,
00522                                   <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>*                      myColors,
00523                                   SINT32                        count )
00524 {
00525         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  loop;
00526         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00527 
00528         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FillCalcParamCM"</span>)
00529         
00530         calcParam-&gt;cmInputPixelOffset  = sizeof(<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>);
00531         calcParam-&gt;cmOutputPixelOffset = sizeof(CMColor);
00532 
00533         <span class="comment">/* ---------------------------------------------------------- handle input */</span>
00534         switch (lutParam-&gt;colorLutInDim)
00535         {
00536                 <span class="keywordflow">case</span> 1:
00537                         calcParam-&gt;cmInputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;     <span class="comment">/* cmGraySpace is 16 bit */</span>
00538                         calcParam-&gt;inputData[0] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors;
00539                         <span class="keywordflow">break</span>;
00540                 <span class="keywordflow">case</span> 3:
00541                         calcParam-&gt;cmInputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
00542                         calcParam-&gt;inputData[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors);
00543                         calcParam-&gt;inputData[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 2;
00544                         calcParam-&gt;inputData[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 4;
00545                         <span class="keywordflow">break</span>;
00546                 <span class="keywordflow">case</span> 4:
00547                         calcParam-&gt;cmInputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
00548                         calcParam-&gt;inputData[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors);
00549                         calcParam-&gt;inputData[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 2;
00550                         calcParam-&gt;inputData[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 4;
00551                         calcParam-&gt;inputData[3] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 6;
00552                         <span class="keywordflow">break</span>;
00553                 <span class="keywordflow">case</span> 5:
00554                 <span class="keywordflow">case</span> 6:
00555                 <span class="keywordflow">case</span> 7:
00556                 <span class="keywordflow">case</span> 8:
00557 <span class="preprocessor">#if ( CM_MAX_COLOR_CHANNELS == 15 )</span>
00558 <span class="preprocessor"></span>                <span class="keywordflow">case</span> 2:
00559                 <span class="keywordflow">case</span> 9:
00560                 <span class="keywordflow">case</span> 10:
00561                 <span class="keywordflow">case</span> 11:
00562                 <span class="keywordflow">case</span> 12:
00563                 <span class="keywordflow">case</span> 13:
00564                 <span class="keywordflow">case</span> 14:
00565                 <span class="keywordflow">case</span> 15:
00566 <span class="preprocessor">#endif  </span>
00567 <span class="preprocessor"></span>                        calcParam-&gt;cmInputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a72">cmMCFiveSpace</a> + lutParam-&gt;colorLutInDim-5;
00568                         calcParam-&gt;cmInputColorSpace |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
00569                         <span class="keywordflow">for</span> (loop = 0; loop&lt;lutParam-&gt;colorLutInDim; loop++)
00570                                 calcParam-&gt;inputData[loop]      = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + loop;
00571                         <span class="keywordflow">break</span>;
00572         }
00573         
00574         <span class="comment">/* ---------------------------------------------------------- handle output */</span>
00575         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutOutDim)
00576         {
00577                 <span class="keywordflow">case</span> 1:
00578                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;    <span class="comment">/* cmGraySpace is 16 bit */</span>
00579                         calcParam-&gt;outputData[0]        = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors;
00580                         <span class="keywordflow">break</span>;
00581                 <span class="keywordflow">case</span> 3:
00582                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
00583                         calcParam-&gt;outputData[0]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors);
00584                         calcParam-&gt;outputData[1]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 2;
00585                         calcParam-&gt;outputData[2]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 4;
00586                         <span class="keywordflow">break</span>;
00587                 <span class="keywordflow">case</span> 4:
00588                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
00589                         calcParam-&gt;outputData[0]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors);
00590                         calcParam-&gt;outputData[1]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 2;
00591                         calcParam-&gt;outputData[2]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 4;
00592                         calcParam-&gt;outputData[3]        = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + 6;
00593                         <span class="keywordflow">break</span>;
00594                 <span class="keywordflow">case</span> 5:
00595                 <span class="keywordflow">case</span> 6:
00596                 <span class="keywordflow">case</span> 7:
00597                 <span class="keywordflow">case</span> 8:
00598 <span class="preprocessor">#if ( CM_MAX_COLOR_CHANNELS == 15 )</span>
00599 <span class="preprocessor"></span>                <span class="keywordflow">case</span> 2:
00600                 <span class="keywordflow">case</span> 9:
00601                 <span class="keywordflow">case</span> 10:
00602                 <span class="keywordflow">case</span> 11:
00603                 <span class="keywordflow">case</span> 12:
00604                 <span class="keywordflow">case</span> 13:
00605                 <span class="keywordflow">case</span> 14:
00606                 <span class="keywordflow">case</span> 15:
00607 <span class="preprocessor">#endif</span>
00608 <span class="preprocessor"></span>                        calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a72">cmMCFiveSpace</a> + lutParam-&gt;colorLutOutDim - 5;
00609                         calcParam-&gt;cmOutputColorSpace |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
00610                         <span class="keywordflow">for</span> (loop = 0; loop&lt;lutParam-&gt;colorLutOutDim; loop++)
00611                                 calcParam-&gt;outputData[loop]     = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)myColors) + loop;
00612                         <span class="keywordflow">break</span>;
00613         }
00614         calcParam-&gt;cmPixelPerLine               = count;
00615         calcParam-&gt;cmInputBytesPerLine  = count*<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>);
00616         calcParam-&gt;cmOutputBytesPerLine = count*<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>);
00617         calcParam-&gt;cmLineCount                  = 1;
00618         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"FillCalcParamCM"</span>)
00619         return err;
00620 }
00621 
00622 #ifdef PI_Application_h
00623 #define ALLOW_16BIT_DATA
00624 #else
<a name="l00625"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a5">00625</a> #define Byte_Factor 1
00626 #endif
00627         
00628 CMError Do8To555Setup( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParam, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info, SINT32 *theLinesAtOnce, <span class="keywordtype">long</span> reverseOrder );
00629 CMError Do8To555Setup( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParam, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info, SINT32 *theLinesAtOnce, <span class="keywordtype">long</span> reverseOrder )
00630 {
00631         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes,linesAtOnce,bufferSize;
00632         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00633 
00634         *theLinesAtOnce = 0;
00635         newRowBytes = calcParam-&gt;cmPixelPerLine * 3;    <span class="comment">/* TempBuffer -&gt; cmRGB24Space */</span>
00636         linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
00637         <span class="keywordflow">if</span> (linesAtOnce == 0)
00638                 linesAtOnce = 1;
00639         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;cmLineCount)
00640                 linesAtOnce = calcParam-&gt;cmLineCount;
00641                 
00642         bufferSize = newRowBytes * linesAtOnce;
00643         info-&gt;processedLinesOut = 0;
00644         info-&gt;origSizeOut               = 5;
00645         info-&gt;usedSizeOut               = 8;
00646         info-&gt;tempOutBuffer     = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize, &amp;iErr);
00647         info-&gt;outputPixelSize = 16;
00648         <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
00649         {
00650                 <span class="keywordflow">return</span> iErr;
00651         }
00652 
00653         calcParam-&gt;cmLineCount                  = linesAtOnce;
00654         calcParam-&gt;cmOutputColorSpace   = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a92">cmRGB24Space</a>;
00655         calcParam-&gt;cmOutputBytesPerLine = newRowBytes;
00656         <span class="keywordflow">if</span>( reverseOrder ){
00657                 calcParam-&gt;outputData[2]                =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer;
00658                 calcParam-&gt;outputData[1]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+1;
00659                 calcParam-&gt;outputData[0]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+2;
00660         }
00661         <span class="keywordflow">else</span>{
00662                 calcParam-&gt;outputData[0]                =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer;
00663                 calcParam-&gt;outputData[1]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+1;
00664                 calcParam-&gt;outputData[2]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+2;
00665         }
00666         calcParam-&gt;cmOutputPixelOffset  = 3;
00667         *theLinesAtOnce = linesAtOnce;
00668         <span class="keywordflow">return</span> 0;
00669 }
00670 
00671 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParam, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info, SINT32 *theLinesAtOnce, <span class="keywordtype">long</span> reverseOrder );
00672 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a> calcParam, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info, SINT32 *theLinesAtOnce, <span class="keywordtype">long</span> reverseOrder )
00673 {
00674         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes,linesAtOnce,bufferSize;
00675         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00676 
00677         *theLinesAtOnce = 0;
00678         newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o2">cmPixelPerLine</a> * 3;    <span class="comment">/* TempBuffer -&gt; cmRGB24Space */</span>
00679         linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
00680         <span class="keywordflow">if</span> (linesAtOnce == 0)
00681                 linesAtOnce = 1;
00682         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>)
00683                 linesAtOnce = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
00684                 
00685         bufferSize = newRowBytes * linesAtOnce;
00686         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> = 0;
00687         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 5;
00688         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 8;
00689         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize, &amp;iErr);
00690         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 16;
00691         <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
00692         {
00693                 <span class="keywordflow">return</span> iErr;
00694         }
00695         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>                  = linesAtOnce;
00696         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a>    = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a92">cmRGB24Space</a>;
00697         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>  = newRowBytes;
00698         <span class="keywordflow">if</span>( reverseOrder ){
00699                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>;
00700                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+1;
00701                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+2;
00702         }
00703         <span class="keywordflow">else</span>{
00704                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>;
00705                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+1;
00706                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+2;
00707         }
00708         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = 3;
00709         *theLinesAtOnce = linesAtOnce;
00710         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00711 }
00712 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
00713 <span class="comment">        CheckInputColorSpace</span>
00714 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
00715 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>
00716 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a21">CheckInputColorSpace</a> (<span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*   bitMap,
00717                                           <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
00718                                           <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info,
00719                                           OSType                        inColorSpace,
00720                                           <span class="keywordtype">long</span>                          colorLutInDim )
00721 {
00722         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00723         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes;
00724         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  bufferSize;
00725         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  linesAtOnce;
00726         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  loop;
00727         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00728         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>      inputBitMapColorSpace = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a>;
00729 <span class="preprocessor">#ifdef ALLOW_16BIT_DATA</span>
00730 <span class="preprocessor"></span>        <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a> <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>=1;
00731 <span class="preprocessor">#endif</span>
00732 <span class="preprocessor"></span>
00733         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CheckInputColorSpace"</span>)
00734         colorLutInDim=colorLutInDim;
00735         
00736 #ifdef ALLOW_16BIT_DATA
00737         if( inputBitMapColorSpace &amp; cm16PerChannelPacking &amp;&amp; (inputBitMapColorSpace &amp; 31) != cmGraySpace){
00738                 <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a> = 2;
00739                 inputBitMapColorSpace &amp;= ~<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
00740                 inputBitMapColorSpace |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
00741         }
00742 <span class="preprocessor">#endif</span>
00743 <span class="preprocessor"></span>        info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
00744         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
00745         <span class="keywordflow">switch</span> ( inputBitMapColorSpace )
00746         {
00747                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a55">cmNoSpace</a>:
00748                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00749                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a58">cmHSVSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00750                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a59">cmHLSSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00751                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00752                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00753                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a62">cmLUVSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00754                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00755                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a72">cmMCFiveSpace</a>:                     <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00756                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a73">cmMCSixSpace</a>:                      <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00757                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a74">cmMCSevenSpace</a>:            <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00758                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a75">cmMCEightSpace</a>:            <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00759                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a67">cmGamutResultSpace</a>:        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00760                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a91">cmGamutResult1Space</a>:       <span class="comment">/* not as colorspace for CMMatchBitmap */</span>
00761 <span class="preprocessor">#ifdef PI_Application_h</span>
00762 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a70">cmYCCSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00763                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00764 <span class="preprocessor">#endif</span>
00765 <span class="preprocessor"></span>                        err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a35">cmInvalidSrcMap</a>;
00766                         <span class="keywordflow">break</span>;
00767                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>:                       <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00768                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a76">cmKYMCSpace</a>:                       <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
00769                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a35">cmInvalidSrcMap</a>;
00770 <span class="preprocessor">#if ! realThing</span>
00771 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> ( (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
00772                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00773                         <span class="keywordflow">else</span>
00774                         {
00775                                 err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00776                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[0];
00777                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[2];
00778                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[4];
00779                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[6];
00780                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = 8;
00781                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 16;
00782                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 16;
00783                         }
00784 <span class="preprocessor">#endif</span>
00785 <span class="preprocessor"></span>                        <span class="keywordflow">break</span>;
00786                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>:
00787                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
00788                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00789                         <span class="keywordflow">else</span> 
00790                         {
00791                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[0];
00792                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = 2;
00793                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 16;
00794                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 16;
00795                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 16;
00796                         }
00797                         <span class="keywordflow">break</span>;
00798                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a78">cmGrayASpace</a>:
00799                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
00800                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00801                         <span class="keywordflow">else</span>
00802                         {
00803                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[0];
00804                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[2];
00805                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = 4;
00806                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 16;
00807                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 16;
00808                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 32;
00809                         }
00810                         <span class="keywordflow">break</span>;
00811                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a95">cmLAB24Space</a>:
00812                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00813                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00814                         <span class="keywordflow">else</span>
00815                         {
00816                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00817                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00818                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00819                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
00820                                         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
00821                         }
00822                         <span class="keywordflow">break</span>;
00823 
00824                 <span class="comment">/* separated cmRGB24Space and cmRGB32Space to reflect the bitmap format definition changes. */</span>
00825                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a92">cmRGB24Space</a>:
00826                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
00827                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00828                         <span class="keywordflow">else</span>
00829                         {
00830                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00831                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00832                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00833                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
00834                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
00835                         }
00836                         <span class="keywordflow">break</span>;
00837                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a81">cmRGB32Space</a>:
00838                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
00839                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00840                         <span class="keywordflow">else</span>
00841                         {
00842                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00843                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00844                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00845                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00846                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00847                                         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00848                         }
00849                         <span class="keywordflow">break</span>;
00850 
00851                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a77">cmRGBASpace</a>:
00852                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>:
00853                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
00854                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00855                         <span class="keywordflow">else</span>
00856                         {
00857                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00858                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00859                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00860                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00861                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00862                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00863                         }
00864                         <span class="keywordflow">break</span>;
00865                         
00866 <span class="preprocessor">#ifdef PI_Application_h</span>
00867 <span class="preprocessor"></span>
00868                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
00869                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
00870                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00871                         <span class="keywordflow">else</span> 
00872                         {
00873                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[0];
00874                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = 1;
00875                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 8;
00876                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 8;
00877                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 8;
00878                         }
00879                         <span class="keywordflow">break</span>;
00880                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a78">cmGrayASpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
00881                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
00882                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00883                         <span class="keywordflow">else</span>
00884                         {
00885                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[0];
00886                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[1];
00887                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = 2;
00888                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 8;
00889                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 8;
00890                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 16;
00891                         }
00892                         <span class="keywordflow">break</span>;
00893 
00894 
00895                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a102">cmBGR24Space</a>:
00896                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
00897                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00898                         <span class="keywordflow">else</span>
00899                         {
00900                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00901                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00902                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00903                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
00904                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
00905                         }
00906                         <span class="keywordflow">break</span>;
00907                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a>:
00908                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
00909                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00910                         <span class="keywordflow">else</span>
00911                         {
00912                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00913                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00914                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00915                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00916                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00917                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00918                         }
00919                         <span class="keywordflow">break</span>;
00920 
00921                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a98">cmYCC32Space</a>:
00922                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
00923                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00924                         <span class="keywordflow">else</span>
00925                         {
00926                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0]         = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00927                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1]         = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00928                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2]         = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00929                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3]         = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00930                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>   = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00931                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00932                         }
00933                         <span class="keywordflow">break</span>;
00934                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a97">cmYCC24Space</a>:
00935                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
00936                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00937                         <span class="keywordflow">else</span>
00938                         {
00939                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00940                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00941                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00942                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
00943                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
00944                         }
00945                         <span class="keywordflow">break</span>;
00946 
00947                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a99">cmYCCASpace</a>:
00948                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a100">cmYCCA32Space</a>:
00949                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
00950                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00951                         <span class="keywordflow">else</span>
00952                         {
00953                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00954                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00955                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00956                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00957                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00958                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00959                         }
00960                         <span class="keywordflow">break</span>;
00961                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a101">cmAYCC32Space</a>:
00962                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
00963                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00964                         <span class="keywordflow">else</span>
00965                         {
00966                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00967                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00968                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00969                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00970                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00971                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00972                         }
00973                         <span class="keywordflow">break</span>;
00974                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:
00975                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00976                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00977                         <span class="keywordflow">else</span>
00978                         {
00979                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00980                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00981                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00982                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00983                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00984                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00985                         }
00986                         <span class="keywordflow">break</span>;
00987                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:
00988                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
00989                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
00990                         <span class="keywordflow">else</span>
00991                         {
00992                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
00993                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
00994                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
00995                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
00996                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
00997                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
00998                         }
00999                         <span class="keywordflow">break</span>;
01000                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:
01001                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)
01002                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01003                         <span class="keywordflow">else</span>
01004                         {
01005                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01006                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01007                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01008                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01009                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01010                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01011                         }
01012                         <span class="keywordflow">break</span>;
01013                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
01014                         {
01015                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; colorLutInDim; loop++)
01016                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01017                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*colorLutInDim;
01018                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*colorLutInDim*8;
01019                         }
01020                         <span class="keywordflow">break</span>;
01021                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a>:
01022                         {
01023                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; (colorLutInDim+1); loop++)
01024                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01025                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*(colorLutInDim+1);
01026                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*(colorLutInDim+1)*8;
01027                         }
01028                         <span class="keywordflow">break</span>;
01029                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a94">cmCMY24Space</a>:
01030                         <span class="keywordflow">if</span> ( inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a> )
01031                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01032                         <span class="keywordflow">else</span>
01033                         {
01034                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01035                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01036                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01037                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01038                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01039                         }
01040                         <span class="keywordflow">break</span>;
01041 <span class="preprocessor">#endif</span>
01042 <span class="preprocessor"></span>
01043                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a83">cmCMYK32Space</a>:
01044                         <span class="keywordflow">if</span> ( (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
01045                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01046                         <span class="keywordflow">else</span>
01047                         {
01048                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01049                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01050                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01051                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01052                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01053                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01054                         }
01055                         <span class="keywordflow">break</span>;
01056                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a84">cmKYMC32Space</a>:
01057                         <span class="keywordflow">if</span> ( (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
01058                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01059                         <span class="keywordflow">else</span>
01060                         {
01061                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01062                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01063                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01064                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01065                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01066                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01067                         }
01068                         <span class="keywordflow">break</span>;
01069                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a82">cmARGB32Space</a>:
01070                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01071                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01072                         <span class="keywordflow">else</span>
01073                         {
01074                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01075                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01076                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01077                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[3] = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01078                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01079                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01080                         }
01081                         <span class="keywordflow">break</span>;
01082                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a106">cmMCFive8Space</a>:
01083                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a121">icSigMCH5Data</a>)
01084                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01085                         <span class="keywordflow">else</span>
01086                         {
01087                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 5; loop++)
01088                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01089                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*5;
01090                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*40;
01091                         }
01092                         <span class="keywordflow">break</span>;
01093                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a107">cmMCSix8Space</a>:
01094                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a122">icSigMCH6Data</a>)
01095                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01096                         <span class="keywordflow">else</span>
01097                         {
01098                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 6; loop++)
01099                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01100                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*6;
01101                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*48;
01102                         }
01103                         <span class="keywordflow">break</span>;
01104                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a108">cmMCSeven8Space</a>:
01105                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a123">icSigMCH7Data</a>)
01106                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01107                         <span class="keywordflow">else</span>
01108                         {
01109                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 7; loop++)
01110                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01111                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*7;
01112                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*56;
01113                         }
01114                         <span class="keywordflow">break</span>;
01115                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a109">cmMCEight8Space</a>:
01116                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a124">icSigMCH8Data</a>)
01117                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01118                         <span class="keywordflow">else</span>
01119                         {
01120                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 8; loop++)
01121                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01122                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
01123                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*64;
01124                         }
01125                         <span class="keywordflow">break</span>;
01126 <span class="preprocessor">#if ( CM_MAX_COLOR_CHANNELS == 15 )</span>
01127 <span class="preprocessor"></span>                <span class="keywordflow">case</span> cmMC98Space:
01128                 <span class="keywordflow">case</span> cmMCa8Space:
01129                 <span class="keywordflow">case</span> cmMCb8Space:
01130                 <span class="keywordflow">case</span> cmMCc8Space:
01131                 <span class="keywordflow">case</span> cmMCd8Space:
01132                 <span class="keywordflow">case</span> cmMCe8Space:
01133                 <span class="keywordflow">case</span> cmMCf8Space:
01134                 <span class="keywordflow">case</span> cmMC28Space:
01135                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a124">icSigMCH8Data</a>)
01136                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01137                         <span class="keywordflow">else</span>
01138                         {
01139                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 8; loop++)
01140                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[loop]      = &amp;bitMap-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01141                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
01142                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*64;
01143                         }
01144                         <span class="keywordflow">break</span>;
01145 <span class="preprocessor">#endif</span>
01146 <span class="preprocessor"></span><span class="preprocessor">#ifdef PI_Application_h</span>
01147 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:
01148                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
01149                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01150                         <span class="keywordflow">else</span>{
01151                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01152                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01153                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01154                         }
01155                         <span class="keywordflow">break</span>;
01156                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:
01157                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
01158                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01159                         <span class="keywordflow">else</span>{
01160                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01161                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01162                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01163                         }
01164                         <span class="keywordflow">break</span>;
01165                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:
01166                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)
01167                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01168                         <span class="keywordflow">else</span>{
01169                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01170                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01171                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01172                         }
01173                         <span class="keywordflow">break</span>;
01174                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>:
01175                         {
01176                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01177                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01178                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01179                         }
01180                         <span class="keywordflow">break</span>;
01181                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>:
01182                         {
01183                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01184                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01185                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01186                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 6;
01187                         }
01188                         <span class="keywordflow">break</span>;
01189                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:
01190                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01191                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01192                         <span class="keywordflow">else</span>{
01193                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01194                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 1 );
01195                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01196                         }
01197                         <span class="keywordflow">break</span>;
01198                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:
01199                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01200                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01201                         <span class="keywordflow">else</span>{
01202                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01203                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 1 );
01204                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01205                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 6;
01206                         }
01207                         <span class="keywordflow">break</span>;
01208                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a80">cmRGB16_565Space</a>:
01209 <span class="preprocessor">#endif</span>
01210 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a79">cmRGB16Space</a>:
01211                         <span class="keywordflow">if</span> (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01212                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01213                         <span class="keywordflow">else</span>{
01214                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
01215                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a29">Do555To8Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01216                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01217 <span class="preprocessor">#ifdef PI_Application_h</span>
01218 <span class="preprocessor"></span>                                <span class="keywordflow">if</span>( inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a80">cmRGB16_565Space</a> ){
01219                                         info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 6;
01220                                 }
01221 <span class="preprocessor">#endif</span>
01222 <span class="preprocessor"></span>                        }
01223                         <span class="keywordflow">break</span>;
01224                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>:
01225                         <span class="keywordflow">if</span>( (inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a132">icSigNamedData</a>)){
01226                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01227                         }
01228                         <span class="keywordflow">else</span>{
01229                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o2">cmPixelPerLine</a> * 3;    <span class="comment">/* TempBuffer -&gt; 32 BIT */</span>
01230                                 linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
01231                                 <span class="keywordflow">if</span> (linesAtOnce == 0)
01232                                         linesAtOnce = 1;
01233                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>)
01234                                         linesAtOnce = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
01235                                         
01236                                 bufferSize = newRowBytes * linesAtOnce;
01237                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> = 0;
01238                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 8;
01239                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 8;
01240                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize, &amp;iErr);
01241                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 32;
01242                                 <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
01243                                 {
01244                                         err = iErr;
01245                                         <span class="keywordflow">goto</span> CleanupAndExit;
01246                                 }
01247         
01248                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>                  = linesAtOnce;
01249                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a> = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a95">cmLAB24Space</a>;
01250                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+0;
01251                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+1;
01252                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+2;
01253 
01254                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>  = newRowBytes;
01255                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = 3;
01256                         }
01257                         <span class="keywordflow">break</span>;
01258                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a85">cmHSV32Space</a>:
01259                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a86">cmHLS32Space</a>:
01260                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a87">cmYXY32Space</a>:
01261                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a88">cmXYZ32Space</a>:
01262                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a89">cmLUV32Space</a>:
01263                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a90">cmLAB32Space</a>:
01264 <span class="preprocessor">#ifdef PI_Application_h</span>
01265 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01266                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01267                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01268 <span class="preprocessor">#endif</span>
01269 <span class="preprocessor"></span>                        <span class="keywordflow">if</span>(  (  ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a85">cmHSV32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a116">icSigHsvData</a>)) ||
01270                                         ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a86">cmHLS32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a117">icSigHlsData</a>)) ||
01271                                         ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a87">cmYXY32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)) ||
01272                                         ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a88">cmXYZ32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)) ||
01273                                         ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a89">cmLUV32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a111">icSigLuvData</a>)) ||
01274                                         ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a90">cmLAB32Space</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>))  
01275 <span class="preprocessor">#ifdef PI_Application_h</span>
01276 <span class="preprocessor"></span>                                        || ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)) 
01277                                         || ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)) 
01278                                         || ((inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (inColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a119">icSigMCH3Data</a>)) 
01279 <span class="preprocessor">#endif</span>
01280 <span class="preprocessor"></span>                                        )
01281 <span class="preprocessor">#if ! realThing</span>
01282 <span class="preprocessor"></span>                                        &amp;&amp; <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  
01283 <span class="preprocessor">#endif</span>
01284 <span class="preprocessor"></span>                                )
01285                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01286                         <span class="keywordflow">else</span>{
01287                                 newRowBytes = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o2">cmPixelPerLine</a> * 3 * <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);   <span class="comment">/* TempBuffer -&gt; cm16PerChannelPacking */</span>
01288                                 linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
01289                                 <span class="keywordflow">if</span> (linesAtOnce == 0)
01290                                         linesAtOnce = 1;
01291                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>)
01292                                         linesAtOnce = calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
01293                                         
01294                                 bufferSize = newRowBytes * linesAtOnce;
01295                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> = 0;
01296                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> = 10;
01297                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a> = 16;
01298                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize, &amp;iErr);
01299                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> = 32;
01300                                 <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
01301                                 {
01302                                         err = iErr;
01303                                         <span class="keywordflow">goto</span> CleanupAndExit;
01304                                 }
01305         
01306                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>                  = linesAtOnce;
01307                                 <span class="keywordflow">if</span>( inputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> ){
01308                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a> = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>;
01309                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+4;
01310                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+2;
01311                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+0;
01312                                 }
01313                                 <span class="keywordflow">else</span>{
01314                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a> = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01315                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[0] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+0;
01316                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[1] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+2;
01317                                         calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[2] = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>)+4;
01318                                 }
01319                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>  = newRowBytes;
01320                                 calcParam-&gt;<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = 6;
01321                         }
01322                         <span class="keywordflow">break</span>;
01323                 <span class="keywordflow">default</span>:
01324                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a35">cmInvalidSrcMap</a>;
01325                         <span class="keywordflow">break</span>;
01326         }
01327         
01328 CleanupAndExit:
01329         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CheckInputColorSpace"</span>)
01330         return err;
01331 }
01332 
01333 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
01334 <span class="comment">        CheckOutputColorSpace</span>
01335 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
01336 CMError
01337 CheckOutputColorSpace (const <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*  bitMap,
01338                                            <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>       calcParam,
01339                                            <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*      info,
01340                                            OSType                       outColorSpace,
01341                                            <span class="keywordtype">long</span>                         colorLutOutDim )
01342 {
01343         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
01344         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes;
01345         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  bufferSize;
01346         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  linesAtOnce;
01347         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  loop;
01348         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
01349         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a10">CMBitmapColorSpace</a>      outputBitMapColorSpace = calcParam-&gt;cmOutputColorSpace;
01350 <span class="preprocessor">#ifdef ALLOW_16BIT_DATA</span>
01351 <span class="preprocessor"></span>        <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a> <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>=1;
01352 <span class="preprocessor">#endif</span>
01353 <span class="preprocessor"></span>
01354         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CheckOutputColorSpace"</span>)
01355         colorLutOutDim = colorLutOutDim;
01356         
01357 #ifdef ALLOW_16BIT_DATA
01358         if( outputBitMapColorSpace &amp; cm16PerChannelPacking &amp;&amp; (outputBitMapColorSpace &amp; 31) != cmGraySpace){
01359                 <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a> = 2;
01360                 outputBitMapColorSpace &amp;= ~<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
01361                 outputBitMapColorSpace |= <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
01362         }
01363 <span class="preprocessor">#endif</span>
01364 <span class="preprocessor"></span>        info-&gt;origSizeOut = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
01365         info-&gt;usedSizeOut = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
01366         <span class="keywordflow">switch</span> ( outputBitMapColorSpace )
01367         {
01368                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a55">cmNoSpace</a>:
01369                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01370                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a58">cmHSVSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01371                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a59">cmHLSSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01372                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01373                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01374                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a62">cmLUVSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01375                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01376                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a72">cmMCFiveSpace</a>:                     <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01377                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a73">cmMCSixSpace</a>:                      <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01378                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a74">cmMCSevenSpace</a>:            <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01379                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a75">cmMCEightSpace</a>:            <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01380                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a67">cmGamutResultSpace</a>:        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01381                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a91">cmGamutResult1Space</a>:       <span class="comment">/* not as colorspace for CMMatchBitmap */</span>
01382 <span class="preprocessor">#ifdef PI_Application_h</span>
01383 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a70">cmYCCSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01384                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:                        <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01385 <span class="preprocessor">#endif</span>
01386 <span class="preprocessor"></span>                        err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
01387                         <span class="keywordflow">break</span>;
01388                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a57">cmCMYKSpace</a>:                       <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01389                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a76">cmKYMCSpace</a>:                       <span class="comment">/* "... bitmap never uses this constant alone..." */</span>
01390                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
01391 <span class="preprocessor">#if ! realThing</span>
01392 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> ( (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
01393                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01394                         <span class="keywordflow">else</span>
01395                         {
01396                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
01397                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[2];
01398                                 calcParam-&gt;outputData[2]                = &amp;bitMap-&gt;image[4];
01399                                 calcParam-&gt;outputData[3]                = &amp;bitMap-&gt;image[6];
01400                                 calcParam-&gt;cmOutputPixelOffset  = 8;
01401                                 info-&gt;usedSizeOut = 16;
01402                         }
01403 <span class="preprocessor">#endif</span>
01404 <span class="preprocessor"></span>                        <span class="keywordflow">break</span>;
01405                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>:
01406                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
01407                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01408                         <span class="keywordflow">else</span>
01409                         {
01410                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
01411                                 calcParam-&gt;cmOutputPixelOffset  = 2;
01412                                 info-&gt;usedSizeOut = 16;
01413                                 info-&gt;outputPixelSize = 16;
01414                         }
01415                         <span class="keywordflow">break</span>;
01416                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a78">cmGrayASpace</a>:
01417                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
01418                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01419                         <span class="keywordflow">else</span>
01420                         {
01421                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
01422                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[2];
01423                                 calcParam-&gt;cmOutputPixelOffset  = 4;
01424                                 info-&gt;usedSizeOut = 16;
01425                                 info-&gt;outputPixelSize = 32;
01426                         }
01427                         <span class="keywordflow">break</span>;
01428                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a95">cmLAB24Space</a>:
01429                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
01430                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01431                         <span class="keywordflow">else</span>
01432                         {
01433                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01434                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01435                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01436                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01437                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01438                         }
01439                         <span class="keywordflow">break</span>;
01440 
01441                 <span class="comment">/* separated cmRGB24Space and cmRGB32Space to reflect the bitmap format definition changes. */</span>
01442                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a92">cmRGB24Space</a>:
01443                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01444                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01445                         <span class="keywordflow">else</span>
01446                         {
01447                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01448                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01449                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01450                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01451                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01452                         }
01453                         <span class="keywordflow">break</span>;
01454                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a81">cmRGB32Space</a>:
01455                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01456                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01457                         <span class="keywordflow">else</span>
01458                                 {
01459                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01460                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01461                                 calcParam-&gt;outputData[2]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01462                                 calcParam-&gt;outputData[3]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01463                                 calcParam-&gt;cmOutputPixelOffset  = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01464                                 calcParam-&gt;clearMask                    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01465                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01466                         }
01467                         <span class="keywordflow">break</span>;
01468 
01469                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a77">cmRGBASpace</a>:
01470                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a93">cmRGBA32Space</a>:
01471                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01472                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01473                                 <span class="keywordflow">else</span>
01474                                 {
01475                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01476                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01477                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01478                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01479                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01480                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01481                         }
01482                         <span class="keywordflow">break</span>;
01483 
01484 <span class="preprocessor">#ifdef PI_Application_h</span>
01485 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
01486                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
01487                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01488                         <span class="keywordflow">else</span>
01489                         {
01490                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
01491                                 calcParam-&gt;cmOutputPixelOffset  = 1;
01492                                 info-&gt;usedSizeOut = 8;
01493                                 info-&gt;outputPixelSize = 8;
01494                         }
01495                         <span class="keywordflow">break</span>;
01496                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a78">cmGrayASpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
01497                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>)
01498                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01499                         <span class="keywordflow">else</span>
01500                         {
01501                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
01502                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[1];
01503                                 calcParam-&gt;cmOutputPixelOffset  = 2;
01504                                 info-&gt;usedSizeOut = 8;
01505                                 info-&gt;outputPixelSize = 16;
01506                         }
01507                         <span class="keywordflow">break</span>;
01508 
01509                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a102">cmBGR24Space</a>:
01510                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01511                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01512                         <span class="keywordflow">else</span>
01513                         {
01514                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01515                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01516                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01517                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01518                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01519                         }
01520                         <span class="keywordflow">break</span>;
01521                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a>:
01522                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01523                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01524                         <span class="keywordflow">else</span>
01525                                 {
01526                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01527                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01528                                 calcParam-&gt;outputData[2]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01529                                 calcParam-&gt;outputData[3]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01530                                 calcParam-&gt;cmOutputPixelOffset  = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01531                                 calcParam-&gt;clearMask                    = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01532                                 calcParam-&gt;copyAlpha                    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01533                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01534                         }
01535                         <span class="keywordflow">break</span>;
01536 
01537                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a97">cmYCC24Space</a>:              <span class="comment">/* cmYCC24Space and cmYCC32Space have the same value !!!        */</span>
01538                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
01539                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01540                         <span class="keywordflow">else</span>
01541                         {
01542                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01543                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01544                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01545                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01546                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01547                         }
01548                         <span class="keywordflow">break</span>;
01549                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a98">cmYCC32Space</a>:
01550                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
01551                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01552                         <span class="keywordflow">else</span>
01553                         {
01554                                 calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01555                                 calcParam-&gt;outputData[1]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01556                                 calcParam-&gt;outputData[2]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01557                                 calcParam-&gt;outputData[3]                = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01558                                 calcParam-&gt;cmOutputPixelOffset  = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01559                                 calcParam-&gt;clearMask                    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01560                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01561                         }
01562                         <span class="keywordflow">break</span>;
01563 
01564                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a99">cmYCCASpace</a>:
01565                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a100">cmYCCA32Space</a>:
01566                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
01567                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01568                         <span class="keywordflow">else</span>
01569                         {
01570                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01571                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01572                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01573                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01574                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01575                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01576                         }
01577                         <span class="keywordflow">break</span>;
01578                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a101">cmAYCC32Space</a>:
01579                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a112">icSigYCbCrData</a>)
01580                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01581                         <span class="keywordflow">else</span>
01582                         {
01583                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01584                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01585                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01586                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01587                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01588                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01589                         }
01590                         <span class="keywordflow">break</span>;
01591                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:
01592                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
01593                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01594                         <span class="keywordflow">else</span>
01595                         {
01596                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01597                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01598                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01599                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01600                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01601                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01602                         }
01603                         <span class="keywordflow">break</span>;
01604                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:
01605                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
01606                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01607                         <span class="keywordflow">else</span>
01608                         {
01609                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01610                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01611                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01612                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01613                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01614                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01615                         }
01616                         <span class="keywordflow">break</span>;
01617                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:
01618                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)
01619                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01620                         <span class="keywordflow">else</span>
01621                         {
01622                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01623                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01624                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01625                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01626                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01627                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01628                         }
01629                         <span class="keywordflow">break</span>;
01630                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>:
01631                         {
01632                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; colorLutOutDim; loop++)
01633                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01634                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*colorLutOutDim;
01635                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*colorLutOutDim*8;
01636                         }
01637                         <span class="keywordflow">break</span>;
01638                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a46">cmLong8ColorPacking</a>:
01639                         {
01640                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; (colorLutOutDim+1); loop++)
01641                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01642                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*(colorLutOutDim+1);
01643                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*(colorLutOutDim+1)*8;
01644                         }
01645                         <span class="keywordflow">break</span>;
01646                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a94">cmCMY24Space</a>:
01647                         <span class="keywordflow">if</span> ( outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a> )
01648                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01649                         <span class="keywordflow">else</span>
01650                         {
01651                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01652                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01653                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01654                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3;
01655                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*24;
01656                         }
01657                         <span class="keywordflow">break</span>;
01658 <span class="preprocessor">#endif</span>
01659 <span class="preprocessor"></span>
01660                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a83">cmCMYK32Space</a>:
01661                         <span class="keywordflow">if</span> ( (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
01662                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01663                         <span class="keywordflow">else</span>
01664                         {
01665                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01666                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01667                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01668                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01669                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01670                                 <span class="keywordflow">if</span> (outColorSpace == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>)                                      <span class="comment">/* if we have CMY-Data - clear the k */</span>
01671                                         calcParam-&gt;clearMask    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01672                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01673                         }
01674                         <span class="keywordflow">break</span>;
01675                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a84">cmKYMC32Space</a>:
01676                         <span class="keywordflow">if</span> ( (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>) )
01677                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01678                         <span class="keywordflow">else</span>
01679                         {
01680                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01681                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01682                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01683                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01684                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01685                                 <span class="keywordflow">if</span> (outColorSpace == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>)                                      <span class="comment">/* if we have CMY-Data - clear the k */</span>
01686                                         calcParam-&gt;clearMask    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01687                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01688                         }
01689                         <span class="keywordflow">break</span>;
01690                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a82">cmARGB32Space</a>:
01691                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01692                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01693                         <span class="keywordflow">else</span>
01694                         {
01695                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*1];
01696                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*2];
01697                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*3];
01698                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*0];
01699                                 calcParam-&gt;cmOutputPixelOffset =<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*4;
01700                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*32;
01701                         }
01702                         <span class="keywordflow">break</span>;
01703                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a106">cmMCFive8Space</a>:
01704                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a121">icSigMCH5Data</a>)
01705                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01706                         <span class="keywordflow">else</span>
01707                         {
01708                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 5; loop++)
01709                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01710                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*5;
01711                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*40;
01712                         }
01713                         <span class="keywordflow">break</span>;
01714                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a107">cmMCSix8Space</a>:
01715                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a122">icSigMCH6Data</a>)
01716                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01717                         <span class="keywordflow">else</span>
01718                         {
01719                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 6; loop++)
01720                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01721                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*6;
01722                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*48;
01723                         }
01724                         <span class="keywordflow">break</span>;
01725                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a108">cmMCSeven8Space</a>:
01726                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a123">icSigMCH7Data</a>)
01727                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01728                         <span class="keywordflow">else</span>
01729                         {
01730                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 7; loop++)
01731                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01732                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*7;
01733                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*56;
01734                         }
01735                         <span class="keywordflow">break</span>;
01736                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a109">cmMCEight8Space</a>:
01737                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a124">icSigMCH8Data</a>)
01738                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01739                         <span class="keywordflow">else</span>
01740                         {
01741                                 <span class="keywordflow">for</span> (loop = 0; loop&lt; 8; loop++)
01742                                         calcParam-&gt;outputData[loop]     = &amp;bitMap-&gt;image[<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*loop];
01743                                 calcParam-&gt;cmOutputPixelOffset = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*8;
01744                                 info-&gt;outputPixelSize = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a5">Byte_Factor</a>*64;
01745                         }
01746                         <span class="keywordflow">break</span>;
01747 <span class="preprocessor">#ifdef PI_Application_h</span>
01748 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a63">cmLABSpace</a>:
01749                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
01750                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01751                         <span class="keywordflow">else</span>{
01752                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01753                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01754                         }
01755                         <span class="keywordflow">break</span>;
01756                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a61">cmXYZSpace</a>:
01757                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
01758                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01759                         <span class="keywordflow">else</span>{
01760                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01761                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01762                         }
01763                         <span class="keywordflow">break</span>;
01764                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a60">cmYXYSpace</a>:
01765                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)
01766                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01767                         <span class="keywordflow">else</span>{
01768                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01769                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01770                         }
01771                         <span class="keywordflow">break</span>;
01772                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>:
01773                         {
01774                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01775                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01776                         }
01777                         <span class="keywordflow">break</span>;
01778                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a>:
01779                         {
01780                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01781                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01782                                 info-&gt;origSizeOut = 6;
01783                         }
01784                         <span class="keywordflow">break</span>;
01785                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:
01786                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01787                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01788                         <span class="keywordflow">else</span>{
01789                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 1 );
01790                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01791                         }
01792                         <span class="keywordflow">break</span>;
01793                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>:
01794                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01795                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01796                         <span class="keywordflow">else</span>{
01797                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 1 );
01798                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01799                                 info-&gt;origSizeOut = 6;
01800                         }
01801                         <span class="keywordflow">break</span>;
01802                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a80">cmRGB16_565Space</a>:
01803 <span class="preprocessor">#endif</span>
01804 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a79">cmRGB16Space</a>:
01805                         <span class="keywordflow">if</span> (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)
01806                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01807                         <span class="keywordflow">else</span>{
01808                                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a28">Do8To555Setup</a>( calcParam, info, &amp;linesAtOnce, 0 );
01809                                 <span class="keywordflow">if</span>( err ) <span class="keywordflow">goto</span> CleanupAndExit;
01810 <span class="preprocessor">#ifdef PI_Application_h</span>
01811 <span class="preprocessor"></span>                                <span class="keywordflow">if</span>( outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a80">cmRGB16_565Space</a> ){
01812                                         info-&gt;origSizeOut = 6;
01813                                 }
01814 <span class="preprocessor">#endif</span>
01815 <span class="preprocessor"></span>                        }
01816                         <span class="keywordflow">break</span>;
01817                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>:
01818                         <span class="keywordflow">if</span>( (outColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a105">cmNamedIndexed32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a132">icSigNamedData</a>)){
01819                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01820                         }
01821                         <span class="keywordflow">else</span>{
01822                                 calcParam-&gt;outputData[0]        = &amp;bitMap-&gt;image[0];
01823                                 calcParam-&gt;outputData[1]        = &amp;bitMap-&gt;image[1];
01824                                 calcParam-&gt;outputData[2]        = &amp;bitMap-&gt;image[2];
01825                                 calcParam-&gt;outputData[3]        = &amp;bitMap-&gt;image[3];
01826                                 calcParam-&gt;cmOutputPixelOffset = 4;
01827                                 info-&gt;outputPixelSize = 32;
01828                         }
01829                         <span class="keywordflow">break</span>;
01830                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a85">cmHSV32Space</a>:
01831                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a86">cmHLS32Space</a>:
01832                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a87">cmYXY32Space</a>:
01833                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a88">cmXYZ32Space</a>:
01834                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a89">cmLUV32Space</a>:
01835                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a90">cmLAB32Space</a>:
01836 <span class="preprocessor">#ifdef PI_Application_h</span>
01837 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01838                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01839                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>:
01840 <span class="preprocessor">#endif</span>
01841 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> ( (  ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a85">cmHSV32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a116">icSigHsvData</a>)) ||
01842                                         ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a86">cmHLS32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a117">icSigHlsData</a>)) ||
01843                                         ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a87">cmYXY32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>)) ||
01844                                         ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a88">cmXYZ32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)) ||
01845                                         ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a89">cmLUV32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a111">icSigLuvData</a>)) ||
01846                                         ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a90">cmLAB32Space</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)) 
01847 <span class="preprocessor">#ifdef PI_Application_h</span>
01848 <span class="preprocessor"></span>                                        || ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)) 
01849                                         || ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>)) 
01850                                         || ((outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a68">cmGenericSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a>) &amp;&amp; (outColorSpace != <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a119">icSigMCH3Data</a>)) 
01851 <span class="preprocessor">#endif</span>
01852 <span class="preprocessor"></span>                                        )
01853 <span class="preprocessor">#if ! realThing</span>
01854 <span class="preprocessor"></span>                                        &amp;&amp; <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>
01855 <span class="preprocessor">#endif</span>
01856 <span class="preprocessor"></span>                                )
01857                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a34">cmInvalidColorSpace</a>;
01858                         <span class="keywordflow">else</span>{
01859                                 newRowBytes = calcParam-&gt;cmPixelPerLine * 3 * <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);   <span class="comment">/* TempBuffer -&gt; cm16PerChannelPacking */</span>
01860                                 linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
01861                                 <span class="keywordflow">if</span> (linesAtOnce == 0)
01862                                         linesAtOnce = 1;
01863                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;cmLineCount)
01864                                         linesAtOnce = calcParam-&gt;cmLineCount;
01865                                         
01866                                 bufferSize = newRowBytes * linesAtOnce;
01867                                 info-&gt;processedLinesOut = 0;
01868                                 info-&gt;origSizeOut               = 10;
01869                                 info-&gt;usedSizeOut               = 16;
01870                                 info-&gt;tempOutBuffer     = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize, &amp;iErr);
01871                                 info-&gt;outputPixelSize = 32;
01872                                 <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
01873                                 {
01874                                         err = iErr;
01875                                         <span class="keywordflow">goto</span> CleanupAndExit;
01876                                 }
01877                                 
01878                                 calcParam-&gt;cmLineCount                  = linesAtOnce;
01879                                 calcParam-&gt;cmOutputBytesPerLine = newRowBytes;
01880                                 <span class="keywordflow">if</span>( outputBitMapColorSpace == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> + <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a47">cmLong10ColorPacking</a> ){
01881                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>;
01882                                         calcParam-&gt;outputData[0]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+4;
01883                                         calcParam-&gt;outputData[1]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+2;
01884                                         calcParam-&gt;outputData[2]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+0;
01885                                 }
01886                                 <span class="keywordflow">else</span>{
01887                                         calcParam-&gt;cmOutputColorSpace   = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a>;
01888                                         calcParam-&gt;outputData[0]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+0;
01889                                         calcParam-&gt;outputData[1]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+2;
01890                                         calcParam-&gt;outputData[2]                = ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer)+4;
01891                                 }
01892                                 calcParam-&gt;cmOutputPixelOffset = 6;
01893                         }
01894                         <span class="keywordflow">break</span>;
01895                 <span class="keywordflow">default</span>:
01896                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
01897                         <span class="keywordflow">break</span>;
01898         }
01899 
01900 CleanupAndExit:
01901         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CheckOutputColorSpace"</span>)
01902         return err;
01903 }
01904 
01905 
01906 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
01907 <span class="comment">        SetOutputColorSpaceInplace</span>
01908 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
01909 CMError
01910 SetOutputColorSpaceInplace      ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
01911                                                           <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info,
01912                                                           OSType                        outColorSpace )
01913 {
01914         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
01915 
01916         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"SetOutputColorSpaceInplace"</span>)
01917 
01918         switch ( outColorSpace )
01919         {
01920                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>:
01921                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a88">cmXYZ32Space</a>;
01922                         <span class="keywordflow">break</span>;
01923                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a111">icSigLuvData</a>:
01924                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a89">cmLUV32Space</a>;
01925                         <span class="keywordflow">break</span>;          
01926                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a113">icSigYxyData</a>:
01927                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a87">cmYXY32Space</a>;
01928                         <span class="keywordflow">break</span>;
01929                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a116">icSigHsvData</a>:
01930                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a85">cmHSV32Space</a>;           
01931                         <span class="keywordflow">break</span>;
01932                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a117">icSigHlsData</a>:
01933                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a86">cmHLS32Space</a>;
01934                         <span class="keywordflow">break</span>;
01935                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a115">icSigGrayData</a>:
01936                         <span class="keywordflow">if</span> (calcParam-&gt;cmInputPixelOffset == 1)
01937                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
01938                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcParam-&gt;cmInputPixelOffset == 2)
01939                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>;
01940                         <span class="keywordflow">else</span> 
01941                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a78">cmGrayASpace</a>;
01942                         <span class="keywordflow">break</span>;
01943 
01944                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a114">icSigRgbData</a>:
01945                         <span class="comment">/* based on the size of the input bitmap, select the right rgb packing format */</span>        
01946 <span class="preprocessor">#ifdef PI_Application_h</span>
01947 <span class="preprocessor"></span>                        <span class="keywordflow">if</span>( (calcParam-&gt;cmInputColorSpace &amp; 0x1f) == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> ){
01948                                 <span class="keywordflow">if</span> (info-&gt;inputPixelSize &lt; 24){
01949                                         <span class="keywordflow">if</span> (info-&gt;origSizeIn == 6){
01950                                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a45">cmWord565ColorPacking</a>;
01951                                         }
01952                                         <span class="keywordflow">else</span>{                                                                                                                                           <span class="comment">/* output is 5 bit */</span>
01953                                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a44">cmWord5ColorPacking</a>;
01954                                         }
01955                                 }
01956                                 <span class="keywordflow">if</span> (info-&gt;inputPixelSize &lt; 32)
01957                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a102">cmBGR24Space</a>;
01958                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 32)
01959                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a>;
01960                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 48)
01961                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a69">cmBGRSpace</a> | <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
01962                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 64)
01963                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a103">cmBGR32Space</a> | <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
01964                                 <span class="keywordflow">break</span>;
01965                         }
01966 <span class="preprocessor">#endif</span>
01967 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> (info-&gt;inputPixelSize &lt; 24)
01968 <span class="preprocessor">#ifdef PI_Application_h</span>
01969 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> (info-&gt;origSizeIn == 6){
01970                                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a80">cmRGB16_565Space</a>;
01971                                 }
01972                                 <span class="keywordflow">else</span>                                                                                                                                            <span class="comment">/* output is 5 bit */</span>
01973 <span class="preprocessor">#endif</span>
01974 <span class="preprocessor"></span>                                calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a79">cmRGB16Space</a>;
01975                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize &lt; 32)
01976                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a92">cmRGB24Space</a>;
01977                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 32)
01978                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a81">cmRGB32Space</a>;
01979                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 48)
01980                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a56">cmRGBSpace</a> | <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
01981                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;inputPixelSize == 64)
01982                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a81">cmRGB32Space</a> | <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a53">cm16PerChannelPacking</a>;
01983                         <span class="keywordflow">break</span>;
01984                         
01985                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>:
01986                         <span class="comment">/* based on the size of the input bitmap, select the right lab packing format */</span>        
01987                         <span class="keywordflow">if</span> (info-&gt;inputPixelSize &lt; 32)
01988                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a95">cmLAB24Space</a>;
01989                         <span class="keywordflow">else</span>
01990                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a90">cmLAB32Space</a>;
01991                         <span class="keywordflow">break</span>;
01992                         
01993                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>:
01994                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a94">cmCMY24Space</a>;
01995                         <span class="keywordflow">break</span>;
01996                 <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>:
01997 <span class="preprocessor">#ifdef PI_Application_h</span>
01998 <span class="preprocessor"></span>                        <span class="keywordflow">if</span>( (calcParam-&gt;cmInputColorSpace &amp; 0x1f) == <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a76">cmKYMCSpace</a> ){
01999                                 calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a84">cmKYMC32Space</a>;
02000                                 <span class="keywordflow">break</span>;
02001                         }
02002 <span class="preprocessor">#endif</span>
02003 <span class="preprocessor"></span>                        calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a83">cmCMYK32Space</a>;
02004                         <span class="keywordflow">break</span>;
02005                         
02006                 <span class="keywordflow">case</span> <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a121">icSigMCH5Data</a>:
02007                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a106">cmMCFive8Space</a>;
02008                         <span class="keywordflow">break</span>;
02009                 <span class="keywordflow">case</span> <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a122">icSigMCH6Data</a>:
02010                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a107">cmMCSix8Space</a>;
02011                         <span class="keywordflow">break</span>;
02012                 <span class="keywordflow">case</span> <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a123">icSigMCH7Data</a>:
02013                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a108">cmMCSeven8Space</a>;
02014                         <span class="keywordflow">break</span>;
02015                 <span class="keywordflow">case</span> <a class="code" href="../../d4/d7/mscmm_2lh__core_2profile_8h.html#a186a124">icSigMCH8Data</a>:
02016                         calcParam-&gt;cmOutputColorSpace = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a109">cmMCEight8Space</a>;
02017                         <span class="keywordflow">break</span>;
02018                 <span class="keywordflow">default</span>:
02019                         <span class="keywordflow">break</span>;
02020         }
02021  
02022         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"SetOutputColorSpaceInplace"</span>)
02023         return err;
02024 }
02025 
02026 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
02027 <span class="comment">        CheckOutputColorSpaceChk</span>
02028 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
02029 CMError
02030 CheckOutputColorSpaceChk  ( const <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>*     bitMap,
02031                                                         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>  calcParam,
02032                                                         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>* info )
02033 {
02034         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02035         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes;
02036         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  bufferSize;
02037         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  linesAtOnce;
02038         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02039 
02040         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CheckOutputColorSpaceChk"</span>)
02041         switch ( bitMap-&gt;space)
02042         {
02043                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a91">cmGamutResult1Space</a>:
02044                         newRowBytes = calcParam-&gt;cmPixelPerLine;                <span class="comment">/* TempBuffer -&gt; 1 byte per pixel */</span>
02045                         linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
02046                         <span class="keywordflow">if</span> (linesAtOnce == 0)
02047                                 linesAtOnce = 1;
02048                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;cmLineCount)
02049                                 linesAtOnce = calcParam-&gt;cmLineCount;
02050                                 
02051                         bufferSize = newRowBytes * linesAtOnce;
02052                         info-&gt;processedLinesOut = 0;
02053                         info-&gt;origSizeOut = 1;
02054                         info-&gt;usedSizeOut = 8;                          <span class="comment">/* ACHTUNG !!!!! bufferSize*info-&gt;usedSizeOut */</span>
02055                         info-&gt;tempOutBuffer     = (<span class="keywordtype">void</span>*)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a5">SmartNewPtr</a>(bufferSize*info-&gt;usedSizeOut, &amp;iErr);
02056                         <span class="keywordflow">if</span> (iErr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>)
02057                         {
02058                                 err = iErr;
02059                                 <span class="keywordflow">goto</span> CleanupAndExit;
02060                         }
02061         
02062                         calcParam-&gt;cmLineCount                   = linesAtOnce;
02063                         calcParam-&gt;cmOutputColorSpace    = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
02064                         calcParam-&gt;cmOutputBytesPerLine  = newRowBytes;
02065                         calcParam-&gt;outputData[0]                 =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer;
02066                         calcParam-&gt;cmOutputPixelOffset   = 1;
02067                         <span class="keywordflow">break</span>;
02068                 <span class="keywordflow">case</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a67">cmGamutResultSpace</a>:
02069                         newRowBytes = calcParam-&gt;cmPixelPerLine;                <span class="comment">/* TempBuffer -&gt; 1 byte per pixel */</span>
02070                         linesAtOnce = (<a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a>) / newRowBytes;
02071                         <span class="keywordflow">if</span> (linesAtOnce == 0)
02072                                 linesAtOnce = 1;
02073                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linesAtOnce &gt; calcParam-&gt;cmLineCount)
02074                                 linesAtOnce = calcParam-&gt;cmLineCount;
02075                                 
02076                         bufferSize = newRowBytes * linesAtOnce;
02077                         info-&gt;processedLinesOut = 0;
02078                         info-&gt;origSizeOut = 8;
02079                         info-&gt;usedSizeOut = 8;
02080                         info-&gt;tempOutBuffer     = 0;
02081         
02082                         calcParam-&gt;cmLineCount                   = linesAtOnce;
02083                         calcParam-&gt;cmOutputColorSpace    = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
02084                         calcParam-&gt;cmOutputBytesPerLine  = newRowBytes;
02085                         calcParam-&gt;cmOutputPixelOffset   = 1;
02086                         calcParam-&gt;outputData[0]                = &amp;bitMap-&gt;image[0];
02087                         <span class="keywordflow">break</span>;
02088                 <span class="keywordflow">default</span>:
02089                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
02090                         <span class="keywordflow">break</span>;
02091         }
02092 CleanupAndExit:
02093         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CheckOutputColorSpaceChk"</span>)
02094         return err;
02095 }
02096 
02097 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
02098 <span class="comment">        AllocBufferCheckCM</span>
02099 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
02100 CMError
02101 AllocBufferCheckCM      ( <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParamPtr</a>        calcParam,
02102                                           <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*       info )
02103 {
02104         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02105         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  newRowBytes;
02106         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  bufferSize;
02107         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>  linesAtOnce;
02108         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>  iErr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02109         
02110         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"AllocBufferCheckCM"</span>)
02111         newRowBytes = calcParam-&gt;cmPixelPerLine;                <span class="comment">/* TempBuffer -&gt; 1 byte per pixel */</span>
02112         linesAtOnce = (kMaxTempBlock) / newRowBytes;
02113         if (linesAtOnce == 0)
02114                 linesAtOnce = 1;
02115         else if (linesAtOnce &gt; calcParam-&gt;cmLineCount)
02116                 linesAtOnce = calcParam-&gt;cmLineCount;
02117                 
02118         bufferSize = newRowBytes * linesAtOnce;
02119         info-&gt;processedLinesOut = 0;
02120         info-&gt;origSizeOut = 1;
02121         info-&gt;usedSizeOut = 8;
02122         info-&gt;tempOutBuffer     = (<span class="keywordtype">void</span>*)SmartNewPtr(bufferSize, &amp;iErr);
02123         if (iErr != noErr)
02124         {
02125                 err = iErr;
02126                 <span class="keywordflow">goto</span> CleanupAndExit;
02127         }
02128 
02129         calcParam-&gt;cmLineCount                   = linesAtOnce;
02130         calcParam-&gt;cmOutputColorSpace    = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a65">cmGraySpace</a>|<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a51">cm8PerChannelPacking</a>;
02131         calcParam-&gt;cmOutputBytesPerLine  = newRowBytes;
02132         calcParam-&gt;outputData[0]                 =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info-&gt;tempOutBuffer;
02133         calcParam-&gt;cmOutputPixelOffset   = 1;
02134 
02135 CleanupAndExit:
02136         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"AllocBufferCheckCM"</span>)
02137         return err;
02138 }
02139 
02140 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
02141 <span class="comment">        FindLookupRoutine</span>
02142 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
02143 CalcProcPtr
02144 FindLookupRoutine   ( const <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>*         lutParam,
02145                                           const <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>* info )
02146 {
02147         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             proc2call       = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
02148 <span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
02149 <span class="preprocessor"></span>        <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02150 <span class="preprocessor">#endif</span>
02151 <span class="preprocessor"></span>        <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FindLookupRoutine"</span>)
02152 
02153         switch ( lutParam-&gt;colorLutInDim )
02154         {
02155                 <span class="keywordflow">case</span> 3:                                                                                                                                                                         <span class="comment">/* 3 -&gt;                                                                                                                 */</span>
02156                         <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutOutDim )
02157                         {
02158                                 <span class="keywordflow">case</span> 3:                                                                                                                                                         <span class="comment">/* 3 -&gt; 3                                                                                                               */</span>
02159                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02160                                         {       
02161                                                 <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8                                                                    */</span>
02162                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02163                                                         {
02164                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 8                                                            */</span>
02165                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02166                                                                         {
02167                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8                                   */</span>
02168                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02169                                                                                         {
02170 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02171 <span class="preprocessor"></span>                                                                                                <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8           Grid 16         */</span>
02172                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G16_LO);
02173                                                                                                         <span class="keywordflow">break</span>;
02174 <span class="preprocessor">#endif</span>
02175 <span class="preprocessor"></span>                                                                                                <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8           Grid 32         */</span>
02176                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G32_LO);
02177                                                                                                         <span class="keywordflow">break</span>;
02178                                                                                         }
02179                                                                                         <span class="keywordflow">break</span>;
02180 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02181 <span class="preprocessor"></span>                                                                                <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16                                  */</span>                      
02182                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02183                                                                                         {
02184                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16          Grid 16         */</span>
02185                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut16_G16_LO);
02186                                                                                                         <span class="keywordflow">break</span>;
02187                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16          Grid 32         */</span>
02188                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut16_G32_LO);
02189                                                                                                         <span class="keywordflow">break</span>;
02190                                                                                         }
02191                                                                                         <span class="keywordflow">break</span>;
02192 <span class="preprocessor">#endif</span>
02193 <span class="preprocessor"></span>                                                                        }
02194                                                                         <span class="keywordflow">break</span>;
02195 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02196 <span class="preprocessor"></span>                                                                <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16                                                           */</span>
02197 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02198 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02199                                                                         {
02200                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8                                   */</span>
02201                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02202                                                                                         {
02203                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8           Grid 16         */</span>
02204                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut8_G16_LO);
02205                                                                                                         <span class="keywordflow">break</span>;
02206                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8           Grid 32         */</span>
02207                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut8_G32_LO);
02208                                                                                                         <span class="keywordflow">break</span>;
02209                                                                                         }
02210                                                                                         <span class="keywordflow">break</span>;
02211                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16                                  */</span>
02212                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02213                                                                                         {
02214                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16          Grid 16         */</span>
02215                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut16_G16_LO);
02216                                                                                                         <span class="keywordflow">break</span>;
02217                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16          Grid 32         */</span>
02218                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut16_G32_LO);
02219                                                                                                         <span class="keywordflow">break</span>;
02220                                                                                         }
02221                                                                                         <span class="keywordflow">break</span>;
02222                                                                         }
02223 <span class="preprocessor">#endif</span>
02224 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02225 <span class="preprocessor">#endif</span>
02226 <span class="preprocessor"></span>                                                        }
02227 
02228                                                         <span class="keywordflow">break</span>;
02229 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02230 <span class="preprocessor"></span>                                                <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16                                                                   */</span>
02231                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02232                                                         {
02233                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 8                                                            */</span>
02234 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02235 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02236                                                                         {
02237                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8                                   */</span>
02238                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02239                                                                                         {
02240                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8           Grid 16         */</span>
02241                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut8_G16_LO);
02242                                                                                                         <span class="keywordflow">break</span>;
02243                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8           Grid 32         */</span>
02244                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut8_G32_LO);
02245                                                                                                         <span class="keywordflow">break</span>;
02246                                                                                         }
02247                                                                                         <span class="keywordflow">break</span>;
02248                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16                                  */</span>
02249                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02250                                                                                         {
02251                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16          Grid 16         */</span>
02252                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut16_G16_LO);
02253                                                                                                         <span class="keywordflow">break</span>;
02254                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16          Grid 32         */</span>
02255                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut16_G32_LO);
02256                                                                                                         <span class="keywordflow">break</span>;
02257                                                                                         }
02258                                                                                         <span class="keywordflow">break</span>;
02259                                                                         }
02260 <span class="preprocessor">#endif</span>
02261 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02262                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16                                                           */</span>
02263 <span class="preprocessor">#if LH_CALC_ENGINE_16_BIT_LO</span>
02264 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02265                                                                         {
02266                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8                                   */</span>
02267                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02268                                                                                         {
02269                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8           Grid 16         */</span>
02270                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut8_G16_LO);
02271                                                                                                         <span class="keywordflow">break</span>;
02272                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8           Grid 32         */</span>
02273                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut8_G32_LO);
02274                                                                                                         <span class="keywordflow">break</span>;
02275                                                                                         }
02276                                                                                         <span class="keywordflow">break</span>;
02277                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16                                  */</span>
02278                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02279                                                                                         {
02280                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16          Grid 16         */</span>
02281                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut16_G16_LO);
02282                                                                                                         <span class="keywordflow">break</span>;
02283                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16          Grid 32         */</span>
02284                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut16_G32_LO);
02285                                                                                                         <span class="keywordflow">break</span>;
02286                                                                                         }
02287                                                                                         <span class="keywordflow">break</span>;
02288                                                                         }
02289 <span class="preprocessor">#endif</span>
02290 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02291                                                         }
02292                                                         <span class="keywordflow">break</span>;
02293 <span class="preprocessor">#endif</span>
02294 <span class="preprocessor"></span>                                        }
02295                                         <span class="keywordflow">break</span>;
02296 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02297 <span class="preprocessor"></span>                                <span class="keywordflow">case</span> 4:                                                                                                                                                         <span class="comment">/* 3 -&gt; 4                                                                                                               */</span>
02298                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02299                                         {
02300                                                 <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8                                                                                    */</span>
02301                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02302                                                         {
02303                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 8                                                            */</span>
02304                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02305                                                                         {
02306                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8                                   */</span>
02307                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02308                                                                                         {
02309                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8           Grid 16         */</span>
02310                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G16_LO);
02311                                                                                                         <span class="keywordflow">break</span>;
02312                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8           Grid 32         */</span>
02313                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G32_LO);
02314                                                                                                         <span class="keywordflow">break</span>;
02315                                                                                         }
02316                                                                                         <span class="keywordflow">break</span>;
02317                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16                                  */</span>
02318                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02319                                                                                         {
02320                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16          Grid 16         */</span>
02321                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut16_G16_LO);
02322                                                                                                         <span class="keywordflow">break</span>;
02323                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16          Grid 32         */</span>
02324                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut16_G32_LO);
02325                                                                                                         <span class="keywordflow">break</span>;
02326                                                                                         }
02327                                                                                         <span class="keywordflow">break</span>;
02328                                                                         }
02329                                                                         <span class="keywordflow">break</span>;
02330                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16                                                           */</span>
02331 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02332 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02333                                                                         {
02334                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8                                   */</span>
02335                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02336                                                                                         {
02337                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8           Grid 16         */</span>
02338                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut8_G16_LO);
02339                                                                                                         <span class="keywordflow">break</span>;
02340                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8           Grid 32         */</span>
02341                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut8_G32_LO);
02342                                                                                                         <span class="keywordflow">break</span>;
02343                                                                                         }
02344                                                                                         <span class="keywordflow">break</span>;
02345                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16                                  */</span>
02346                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02347                                                                                         {
02348                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16          Grid 16         */</span>
02349                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut16_G16_LO);
02350                                                                                                         <span class="keywordflow">break</span>;
02351                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16          Grid 32         */</span>
02352                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut16_G32_LO);
02353                                                                                                         <span class="keywordflow">break</span>;
02354                                                                                         }
02355                                                                                         <span class="keywordflow">break</span>;
02356                                                                         }
02357 <span class="preprocessor">#endif</span>
02358 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02359                                                         }
02360                                                         <span class="keywordflow">break</span>;
02361                                                 <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16                                                                                   */</span>
02362                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02363                                                         {
02364                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 8                                                            */</span>
02365 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02366 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02367                                                                         {
02368                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8                                   */</span>
02369                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02370                                                                                         {
02371                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8           Grid 16         */</span>
02372                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut8_G16_LO);
02373                                                                                                         <span class="keywordflow">break</span>;
02374                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8           Grid 32         */</span>
02375                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut8_G32_LO);
02376                                                                                                         <span class="keywordflow">break</span>;
02377                                                                                         }
02378                                                                                         <span class="keywordflow">break</span>;
02379                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16                                  */</span>
02380                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02381                                                                                         {
02382                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16          Grid 16         */</span>
02383                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut16_G16_LO);
02384                                                                                                         <span class="keywordflow">break</span>;
02385                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16          Grid 32         */</span>
02386                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut16_G32_LO);
02387                                                                                                         <span class="keywordflow">break</span>;
02388                                                                                         }
02389                                                                                         <span class="keywordflow">break</span>;
02390                                                                         }
02391 <span class="preprocessor">#endif</span>
02392 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02393                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16                                                           */</span>
02394 <span class="preprocessor">#if LH_CALC_ENGINE_16_BIT_LO</span>
02395 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02396                                                                         {
02397                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8                                   */</span>
02398                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02399                                                                                         {
02400                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8           Grid 16         */</span>
02401                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut8_G16_LO);
02402                                                                                                         <span class="keywordflow">break</span>;
02403                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8           Grid 32         */</span>
02404                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut8_G32_LO);
02405                                                                                                         <span class="keywordflow">break</span>;
02406                                                                                         }
02407                                                                                         <span class="keywordflow">break</span>;
02408                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16                                  */</span>
02409                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02410                                                                                         {
02411                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16          Grid 16         */</span>
02412                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut16_G16_LO);
02413                                                                                                         <span class="keywordflow">break</span>;
02414                                                                                                 <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16          Grid 32         */</span>
02415                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut16_G32_LO);
02416                                                                                                         <span class="keywordflow">break</span>;
02417                                                                                         }
02418                                                                                         <span class="keywordflow">break</span>;
02419                                                                         }
02420 <span class="preprocessor">#endif</span>
02421 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02422                                                         }
02423                                                         <span class="keywordflow">break</span>;
02424                                         }
02425                                         <span class="keywordflow">break</span>;
02426 <span class="preprocessor">#endif</span>
02427 <span class="preprocessor"></span>                        }
02428                         <span class="keywordflow">break</span>;
02429 <span class="preprocessor">#if LH_CALC_ENGINE_ALL_FORMATS_LO</span>
02430 <span class="preprocessor"></span>                <span class="keywordflow">case</span> 4:                                                                                                                                                                         <span class="comment">/* 4 -&gt;                                                                                                                 */</span>
02431                         <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutOutDim )
02432                         {
02433                                 <span class="keywordflow">case</span> 3:                                                                                                                                                         <span class="comment">/* 4 -&gt; 3                                                                                                               */</span>
02434                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02435                                         {
02436                                                 <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8                                                                                    */</span>
02437                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02438                                                         {
02439                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8                                                            */</span>
02440                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02441                                                                         {
02442                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8                                   */</span>
02443                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02444                                                                                         {
02445                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8           Grid 8          */</span>
02446                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G8_LO);
02447                                                                                                         <span class="keywordflow">break</span>;
02448                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8           Grid 16         */</span>
02449                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G16_LO);
02450                                                                                                         <span class="keywordflow">break</span>;
02451                                                                                         }
02452                                                                                         <span class="keywordflow">break</span>;
02453                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16                                  */</span>
02454                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02455                                                                                         {
02456                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16          Grid 8          */</span>
02457                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut16_G8_LO);
02458                                                                                                         <span class="keywordflow">break</span>;
02459                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16          Grid 16         */</span>
02460                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut16_G16_LO);
02461                                                                                                         <span class="keywordflow">break</span>;
02462                                                                                         }
02463                                                                                         <span class="keywordflow">break</span>;
02464                                                                         }
02465                                                                         <span class="keywordflow">break</span>;
02466                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16                                                           */</span>
02467 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02468 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02469                                                                         {
02470                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8                                   */</span>
02471                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02472                                                                                         {
02473                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8           Grid 8          */</span>
02474                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut8_G8_LO);
02475                                                                                                         <span class="keywordflow">break</span>;
02476                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8           Grid 16         */</span>
02477                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut8_G16_LO);
02478                                                                                                         <span class="keywordflow">break</span>;
02479                                                                                         }
02480                                                                                         <span class="keywordflow">break</span>;
02481                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16                                  */</span>
02482                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02483                                                                                         {
02484                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16          Grid 8          */</span>
02485                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut16_G8_LO);
02486                                                                                                         <span class="keywordflow">break</span>;
02487                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16          Grid 16         */</span>
02488                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut16_G16_LO);
02489                                                                                                         <span class="keywordflow">break</span>;
02490                                                                                         }
02491                                                                                         <span class="keywordflow">break</span>;
02492                                                                         }
02493 <span class="preprocessor">#endif</span>
02494 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02495                                                         }
02496                                                         <span class="keywordflow">break</span>;
02497                                                 <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16                                                                                   */</span>
02498                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02499                                                         {
02500                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8                                                            */</span>
02501 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02502 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02503                                                                         {
02504                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8                                   */</span>
02505                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02506                                                                                         {
02507                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8           Grid 8          */</span>
02508                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut8_G8_LO);
02509                                                                                                         <span class="keywordflow">break</span>;
02510                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8           Grid 16         */</span>
02511                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut8_G16_LO);
02512                                                                                                         <span class="keywordflow">break</span>;
02513                                                                                         }
02514                                                                                         <span class="keywordflow">break</span>;
02515                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16                                  */</span>
02516                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02517                                                                                         {
02518                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16          Grid 8          */</span>
02519                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut16_G8_LO);
02520                                                                                                         <span class="keywordflow">break</span>;
02521                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16          Grid 16         */</span>
02522                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut16_G16_LO);
02523                                                                                                         <span class="keywordflow">break</span>;
02524                                                                                         }
02525                                                                                         <span class="keywordflow">break</span>;
02526                                                                         }
02527 <span class="preprocessor">#endif</span>
02528 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02529                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16                                                           */</span>
02530 <span class="preprocessor">#if LH_CALC_ENGINE_16_BIT_LO</span>
02531 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02532                                                                         {
02533                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8                                   */</span>
02534                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02535                                                                                         {
02536                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8           Grid 8          */</span>
02537                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut8_G8_LO);
02538                                                                                                         <span class="keywordflow">break</span>;
02539                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8           Grid 16         */</span>
02540                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut8_G16_LO);
02541                                                                                                         <span class="keywordflow">break</span>;
02542                                                                                         }
02543                                                                                         <span class="keywordflow">break</span>;
02544                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16                                  */</span>
02545                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02546                                                                                         {
02547                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16          Grid 8          */</span>
02548                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut16_G8_LO);
02549                                                                                                         <span class="keywordflow">break</span>;
02550                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16          Grid 16         */</span>
02551                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut16_G16_LO);
02552                                                                                                         <span class="keywordflow">break</span>;
02553                                                                                         }
02554                                                                                         <span class="keywordflow">break</span>;
02555                                                                         }
02556 <span class="preprocessor">#endif</span>
02557 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02558                                                         }
02559                                                         <span class="keywordflow">break</span>;
02560                                         }
02561                                         <span class="keywordflow">break</span>;
02562                                 <span class="keywordflow">case</span> 4:                                                                                                                                                         <span class="comment">/* 4 -&gt; 4                                                                                                               */</span>
02563                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02564                                         {
02565                                                 <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8                                                                                    */</span>
02566                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02567                                                         {
02568                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8                                                            */</span>
02569                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02570                                                                         {
02571                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8                                   */</span>
02572                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02573                                                                                         {
02574                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8           Grid 8          */</span>
02575                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G8_LO);
02576                                                                                                         <span class="keywordflow">break</span>;
02577                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8           Grid 16         */</span>
02578                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G16_LO);
02579                                                                                                         <span class="keywordflow">break</span>;
02580                                                                                         }
02581                                                                                         <span class="keywordflow">break</span>;
02582                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16                                  */</span>
02583                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02584                                                                                         {
02585                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16          Grid 8          */</span>
02586                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut16_G8_LO);
02587                                                                                                         <span class="keywordflow">break</span>;
02588                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16          Grid 16         */</span>
02589                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut16_G16_LO);
02590                                                                                                         <span class="keywordflow">break</span>;
02591                                                                                         }
02592                                                                                         <span class="keywordflow">break</span>;
02593                                                                         }
02594                                                                         <span class="keywordflow">break</span>;
02595                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16                                                           */</span>
02596 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02597 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02598                                                                         {
02599                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8                                   */</span>
02600                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02601                                                                                         {
02602                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8           Grid 8          */</span>
02603                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut8_G8_LO);
02604                                                                                                         <span class="keywordflow">break</span>;
02605                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8           Grid 16         */</span>
02606                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut8_G16_LO);
02607                                                                                                         <span class="keywordflow">break</span>;
02608                                                                                         }
02609                                                                                         <span class="keywordflow">break</span>;
02610                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16                                  */</span>
02611                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02612                                                                                         {
02613                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16          Grid 8          */</span>
02614                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut16_G8_LO);
02615                                                                                                         <span class="keywordflow">break</span>;
02616                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16          Grid 16         */</span>
02617                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut16_G16_LO);
02618                                                                                                         <span class="keywordflow">break</span>;
02619                                                                                         }
02620                                                                                         <span class="keywordflow">break</span>;
02621                                                                         }
02622 <span class="preprocessor">#endif</span>
02623 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02624                                                         }
02625                                                         <span class="keywordflow">break</span>;
02626                                                 <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16                                                                                   */</span>
02627                                                         <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02628                                                         {
02629                                                                 <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8                                                            */</span>
02630 <span class="preprocessor">#if LH_CALC_ENGINE_MIXED_DATAFORMAT</span>
02631 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02632                                                                         {
02633                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8                                   */</span>
02634                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02635                                                                                         {
02636                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8           Grid 8          */</span>
02637                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut8_G8_LO);
02638                                                                                                         <span class="keywordflow">break</span>;
02639                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8           Grid 16         */</span>
02640                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut8_G16_LO);
02641                                                                                                         <span class="keywordflow">break</span>;
02642                                                                                         }
02643                                                                                         <span class="keywordflow">break</span>;
02644                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16                                  */</span>
02645                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02646                                                                                         {
02647                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16          Grid 8          */</span>
02648                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut16_G8_LO);
02649                                                                                                         <span class="keywordflow">break</span>;
02650                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16          Grid 16         */</span>
02651                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut16_G16_LO);
02652                                                                                                         <span class="keywordflow">break</span>;
02653                                                                                         }
02654                                                                                         <span class="keywordflow">break</span>;
02655                                                                         }
02656 <span class="preprocessor">#endif</span>
02657 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02658                                                                 <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16                                                           */</span>
02659 <span class="preprocessor">#if LH_CALC_ENGINE_16_BIT_LO</span>
02660 <span class="preprocessor"></span>                                                                        <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02661                                                                         {
02662                                                                                 <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8                                   */</span>
02663                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02664                                                                                         {
02665                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8           Grid 8          */</span>
02666                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut8_G8_LO);
02667                                                                                                         <span class="keywordflow">break</span>;
02668                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8           Grid 16         */</span>
02669                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut8_G16_LO);
02670                                                                                                         <span class="keywordflow">break</span>;
02671                                                                                         }
02672                                                                                         <span class="keywordflow">break</span>;
02673                                                                                 <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16                                  */</span>
02674                                                                                         <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02675                                                                                         {
02676                                                                                                 <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16          Grid 8          */</span>
02677                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut16_G8_LO);
02678                                                                                                         <span class="keywordflow">break</span>;
02679                                                                                                 <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16          Grid 16         */</span>
02680                                                                                                         proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut16_G16_LO);
02681                                                                                                         <span class="keywordflow">break</span>;
02682                                                                                         }
02683                                                                                         <span class="keywordflow">break</span>;
02684                                                                         }
02685 <span class="preprocessor">#endif</span>
02686 <span class="preprocessor"></span>                                                                        <span class="keywordflow">break</span>;
02687                                                         }
02688                                                         <span class="keywordflow">break</span>;
02689                                         }
02690                                         <span class="keywordflow">break</span>;
02691                         }
02692                         <span class="keywordflow">break</span>;
02693 <span class="preprocessor">#endif</span>
02694 <span class="preprocessor"></span>        }
02695 
02696         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"FindLookupRoutine"</span>)
02697         return proc2call;
02698 }
02699 
02700 #ifdef ALLOW_MMX
02701 #define cpuid   __asm _emit 0x0F __asm _emit 0xA2
02702 
02703 #define CPUID_FLAG              0x00200000
02704 #define MMX_FLAG                0x00800000
02705 #define FAMILY_5_FLAG   0x00000500 <span class="comment">/* Pentium, not Pentium II */</span>
02706 #define FAMILY_MASK             0x00000F00
02707 
02708 <span class="comment">/*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*</span>
02709 <span class="comment">*                                                                    *</span>
02710 <span class="comment">*                                                                    *</span>
02711 <span class="comment">*   DetectMMX                                                        *</span>
02712 <span class="comment">*                                                                    *</span>
02713 <span class="comment">*   Inputs   : none                                                  *</span>
02714 <span class="comment">*                                                                    *</span>
02715 <span class="comment">*   Outputs  : TRUE - CPU has MMX                                    *</span>
02716 <span class="comment">*                                                                    *</span>
02717 <span class="comment">*   Abstract : This function detects existance of MMX-Technology.    *</span>
02718 <span class="comment">*                                                                    *</span>
02719 <span class="comment">*                                                                    *</span>
02720 <span class="comment">*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*/</span>
02721 
02722 static LH_UINT32 DetectMMX (<span class="keywordtype">void</span>)
02723 {
02724     <a class="code" href="../../d0/d3/lh__core_2calcenf_8h.html#a7">LH_UINT32</a>    fMMX = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02725 
02726     __asm {
02727 
02728             push    edx             ; 
02729             push    ebx             ; 
02730                         push    eax             ; 
02731             pushfd                  ; Push flags on stack
02732             pop     eax             ; and get flags into eax
02733             xor     eax, CPUID_FLAG ; Toggle <a class="code" href="../../d5/d3/i386_8h.html#a50">CPUID</a> flag
02734             push    eax             ; Move flags back into
02735             popfd                   ; flags reg
02736             pushfd                  ; Get flags into ebx
02737             pop     ebx
02738             and     ebx, CPUID_FLAG ; Mask <a class="code" href="../../d5/d3/i386_8h.html#a50">CPUID</a> flag
02739             and     eax, CPUID_FLAG
02740             cmp     eax, ebx        ; <a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a> toggled bit
02741             jnz     Done            ; CPU does not support <a class="code" href="../../d5/d3/i386_8h.html#a50">CPUID</a>
02742 
02743             mov     eax, 1          ; Set <a class="code" href="../../d5/d3/i386_8h.html#a50">CPUID</a> mode
02744             cpuid
02745             test    edx, MMX_FLAG   ; Check MMX-Technology bit
02746             jz      Done            ; CPU has no MMX-Technology
02747                         and             eax, FAMILY_MASK        ; mask <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> family bits
02748             cmp     eax, FAMILY_5_FLAG  ; Check Family 5 bits
02749             jnz     Done            ; CPU has no MMX-Technology
02750 
02751             mov     fMMX, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>      ; CPU has MMX-Technology
02752 Done:
02753             ;pushfd                        ; <a class="code" href="../../d0/d2/config_2test_2init386_8c.html#a0">dummy</a>
02754                         pop     eax             ;
02755             pop     ebx             ; 
02756             pop     edx             ; 
02757    }
02758 
02759     <span class="keywordflow">return</span> (fMMX);
02760 }
02761 
02762 <span class="preprocessor">#endif</span>
02763 <span class="preprocessor"></span><span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
02764 <span class="comment">        FindCalcRoutine</span>
02765 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
02766 <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>
02767 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>(        <span class="keyword">const</span> <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>*              calcParam,
02768                                         <span class="keyword">const</span> <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>*               lutParam,
02769                                         <span class="keyword">const</span> <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>*   info,
02770                                         <span class="keyword">const</span> Boolean                   lookupOnly )
02771 {
02772         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  index           = 0;
02773         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             proc2call       = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
02774 <span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
02775 <span class="preprocessor"></span>        <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
02776 <span class="preprocessor">#endif</span>
02777 <span class="preprocessor"></span>        
02778         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"FindCalcRoutine"</span>)
02779 
02780         calcParam  = calcParam;
02781 <span class="comment">/* to reduce the code size change the next line to 0 - this will call DoNDim instead of the optimized functions */</span>
02782 #if 1
02783         if (lookupOnly)
02784                 proc2call = FindLookupRoutine(lutParam, info);
02785         if (proc2call == nil)
02786         {
02787                 <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutInDim )
02788                 {
02789                         <span class="keywordflow">case</span> 1:                                                                                                                                                                         <span class="comment">/* 1 -&gt;                                                                                                                 */</span>
02790                                 <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutOutDim )
02791                                 {
02792                                         <span class="keywordflow">case</span> 1:                                                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4                                                                                                           */</span>
02793                                         <span class="keywordflow">case</span> 3:                                                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4                                                                                                   */</span>
02794                                         <span class="keywordflow">case</span> 4:                                                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4                                                                                                   */</span>
02795                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02796                                                 {       
02797                                                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8                                                                    */</span>
02798                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02799                                                                 {
02800                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8                                                            */</span>
02801                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02802                                                                                 {
02803                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8                                   */</span>
02804                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02805                                                                                                 {
02806 <span class="preprocessor">#if LH_Calc1toX_Di8_Do8_Lut8_G128 != LH_CALC_USE_DO_N_DIM</span>
02807 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8           Grid 16         */</span>
02808                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di8_Do8_Lut8_G128);
02809                                                                                                                 <span class="keywordflow">break</span>;
02810 <span class="preprocessor">#endif</span>
02811 <span class="preprocessor"></span>                                                                                                }
02812                                                                                                 <span class="keywordflow">break</span>;
02813                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16                                  */</span>                      
02814                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02815                                                                                                 {
02816 <span class="preprocessor">#if LH_Calc1toX_Di8_Do8_Lut16_G128 != LH_CALC_USE_DO_N_DIM</span>
02817 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16          Grid 16         */</span>
02818                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di8_Do8_Lut16_G128);
02819                                                                                                                 <span class="keywordflow">break</span>;
02820 <span class="preprocessor">#endif</span>
02821 <span class="preprocessor"></span>                                                                                                }
02822                                                                                                 <span class="keywordflow">break</span>;
02823                                                                                 }
02824                                                                                 <span class="keywordflow">break</span>;
02825                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 16                                                           */</span>
02826                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02827                                                                                 {
02828                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8                                   */</span>
02829                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02830                                                                                                 {
02831 <span class="preprocessor">#if LH_Calc1toX_Di8_Do16_Lut8_G128 != LH_CALC_USE_DO_N_DIM</span>
02832 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8           Grid 16         */</span>
02833                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di8_Do16_Lut8_G128);
02834                                                                                                                 <span class="keywordflow">break</span>;
02835 <span class="preprocessor">#endif</span>
02836 <span class="preprocessor"></span>                                                                                                }
02837                                                                                                 <span class="keywordflow">break</span>;
02838                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16                                  */</span>                      
02839                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02840                                                                                                 {
02841 <span class="preprocessor">#if LH_Calc1toX_Di8_Do16_Lut16_G128 != LH_CALC_USE_DO_N_DIM</span>
02842 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16          Grid 16         */</span>
02843                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di8_Do16_Lut16_G128);
02844                                                                                                                 <span class="keywordflow">break</span>;
02845 <span class="preprocessor">#endif</span>
02846 <span class="preprocessor"></span>                                                                                                }
02847                                                                                                 <span class="keywordflow">break</span>;
02848                                                                                 }
02849                                                                                 <span class="keywordflow">break</span>;
02850                                                                 }
02851                                                                 <span class="keywordflow">break</span>;
02852                                                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 16                                                                   */</span>
02853                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02854                                                                 {
02855                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8                                                            */</span>
02856                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02857                                                                                 {
02858                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8                                   */</span>
02859                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02860                                                                                                 {
02861 <span class="preprocessor">#if LH_Calc1toX_Di16_Do8_Lut8_G128 != LH_CALC_USE_DO_N_DIM</span>
02862 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8           Grid 16         */</span>
02863                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di16_Do8_Lut8_G128);
02864                                                                                                                 <span class="keywordflow">break</span>;
02865 <span class="preprocessor">#endif</span>
02866 <span class="preprocessor"></span>                                                                                                }
02867                                                                                                 <span class="keywordflow">break</span>;
02868                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16                                  */</span>                      
02869                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02870                                                                                                 {
02871 <span class="preprocessor">#if LH_Calc1toX_Di16_Do8_Lut16_G128 != LH_CALC_USE_DO_N_DIM</span>
02872 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16          Grid 16         */</span>
02873                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di16_Do8_Lut16_G128);
02874                                                                                                                 <span class="keywordflow">break</span>;
02875 <span class="preprocessor">#endif</span>
02876 <span class="preprocessor"></span>                                                                                                }
02877                                                                                                 <span class="keywordflow">break</span>;
02878                                                                                 }
02879                                                                                 <span class="keywordflow">break</span>;
02880                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 16                                                           */</span>
02881                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02882                                                                                 {
02883                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8                                   */</span>
02884                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02885                                                                                                 {
02886 <span class="preprocessor">#if LH_Calc1toX_Di16_Do16_Lut8_G128 != LH_CALC_USE_DO_N_DIM</span>
02887 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 8           Grid 16         */</span>
02888                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di16_Do16_Lut8_G128);
02889                                                                                                                 <span class="keywordflow">break</span>;
02890 <span class="preprocessor">#endif</span>
02891 <span class="preprocessor"></span>                                                                                                }
02892                                                                                                 <span class="keywordflow">break</span>;
02893                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16                                  */</span>                      
02894                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02895                                                                                                 {
02896 <span class="preprocessor">#if LH_Calc1toX_Di16_Do16_Lut16_G128 != LH_CALC_USE_DO_N_DIM</span>
02897 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 128:                                                                                       <span class="comment">/* 1 -&gt; 1,3,4   Di 8            Do 8            Lut 16          Grid 16         */</span>
02898                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc1toX_Di16_Do16_Lut16_G128);
02899                                                                                                                 <span class="keywordflow">break</span>;
02900 <span class="preprocessor">#endif</span>
02901 <span class="preprocessor"></span>                                                                                                }
02902                                                                                                 <span class="keywordflow">break</span>;
02903                                                                                 }
02904                                                                                 <span class="keywordflow">break</span>;
02905                                                                 }
02906                                                                 <span class="keywordflow">break</span>;
02907                                                 }
02908                                                 <span class="keywordflow">break</span>;
02909                                         }
02910                                         <span class="keywordflow">break</span>;
02911                         <span class="keywordflow">case</span> 3:                                                                                                                                                                         <span class="comment">/* 3 -&gt;                                                                                                                 */</span>
02912                                 <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutOutDim )
02913                                 {
02914                                         <span class="keywordflow">case</span> 3:                                                                                                                                                         <span class="comment">/* 3 -&gt; 3                                                                                                               */</span>
02915                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
02916                                                 {       
02917                                                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8                                                                    */</span>
02918                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
02919                                                                 {
02920                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 8                                                            */</span>
02921                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02922                                                                                 {
02923                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8                                   */</span>
02924                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02925                                                                                                 {
02926 <span class="preprocessor">#if LH_Calc3to3_Di8_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
02927 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8           Grid 16         */</span>
02928 <span class="preprocessor">#ifdef ALLOW_MMX</span>
02929 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
02930                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G16_F);
02931                                                         }
02932                                                         <span class="keywordflow">else</span>
02933 <span class="preprocessor">#endif</span>
02934 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE</span>
02935 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
02936                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G16_Old);
02937                                                                                                                 }
02938                                                                                                                 <span class="keywordflow">else</span>
02939 <span class="preprocessor">#endif</span>
02940 <span class="preprocessor"></span>                                                                                                                proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G16);
02941                                                                                                                 <span class="keywordflow">break</span>;
02942 <span class="preprocessor">#endif</span>
02943 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di8_Do8_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
02944 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 8           Grid 32         */</span>
02945 <span class="preprocessor">#ifdef ALLOW_MMX</span>
02946 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
02947                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G32_F);
02948                                                         }
02949                                                         <span class="keywordflow">else</span>
02950 <span class="preprocessor">#endif</span>
02951 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE</span>
02952 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
02953                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G32_Old);
02954                                                                                                                 }
02955                                                                                                                 <span class="keywordflow">else</span>
02956 <span class="preprocessor">#endif</span>
02957 <span class="preprocessor"></span>                                                                                                                proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut8_G32);
02958                                                                                                                 <span class="keywordflow">break</span>;
02959 <span class="preprocessor">#endif</span>
02960 <span class="preprocessor"></span>                                                                                                }
02961                                                                                                 <span class="keywordflow">break</span>;
02962                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16                                  */</span>                      
02963                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02964                                                                                                 {
02965 <span class="preprocessor">#if LH_Calc3to3_Di8_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
02966 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16          Grid 16         */</span>
02967                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut16_G16);
02968                                                                                                                 <span class="keywordflow">break</span>;
02969 <span class="preprocessor">#endif</span>
02970 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di8_Do8_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
02971 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 8            Lut 16          Grid 32         */</span>
02972                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do8_Lut16_G32);
02973                                                                                                                 <span class="keywordflow">break</span>;
02974 <span class="preprocessor">#endif</span>
02975 <span class="preprocessor"></span>                                                                                                }
02976                                                                                                 <span class="keywordflow">break</span>;
02977                                                                                 }
02978                                                                                 <span class="keywordflow">break</span>;
02979                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16                                                           */</span>
02980                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
02981                                                                                 {
02982                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8                                   */</span>
02983                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02984                                                                                                 {
02985 <span class="preprocessor">#if LH_Calc3to3_Di8_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
02986 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8           Grid 16         */</span>
02987                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut8_G16);
02988                                                                                                                 <span class="keywordflow">break</span>;
02989 <span class="preprocessor">#endif</span>
02990 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di8_Do16_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
02991 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 8           Grid 32         */</span>
02992                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut8_G32);
02993                                                                                                                 <span class="keywordflow">break</span>;
02994 <span class="preprocessor">#endif</span>
02995 <span class="preprocessor"></span>                                                                                                }
02996                                                                                                 <span class="keywordflow">break</span>;
02997                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16                                  */</span>
02998                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
02999                                                                                                 {
03000 <span class="preprocessor">#if LH_Calc3to3_Di8_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03001 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16          Grid 16         */</span>
03002                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut16_G16);
03003                                                                                                                 <span class="keywordflow">break</span>;
03004 <span class="preprocessor">#endif</span>
03005 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di8_Do16_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03006 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 8            Do 16           Lut 16          Grid 32         */</span>
03007                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di8_Do16_Lut16_G32);
03008                                                                                                                 <span class="keywordflow">break</span>;
03009 <span class="preprocessor">#endif</span>
03010 <span class="preprocessor"></span>                                                                                                }
03011                                                                                                 <span class="keywordflow">break</span>;
03012                                                                                 }
03013                                                                                 <span class="keywordflow">break</span>;
03014                                                                 }
03015                                                                 <span class="keywordflow">break</span>;
03016                                                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16                                                                   */</span>
03017                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03018                                                                 {
03019                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 8                                                            */</span>
03020                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03021                                                                                 {
03022                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8                                   */</span>
03023                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03024                                                                                                 {
03025 <span class="preprocessor">#if LH_Calc3to3_Di16_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03026 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8           Grid 16         */</span>
03027                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut8_G16);
03028                                                                                                                 <span class="keywordflow">break</span>;
03029 <span class="preprocessor">#endif</span>
03030 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di16_Do8_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03031 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 8           Grid 32         */</span>
03032                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut8_G32);
03033                                                                                                                 <span class="keywordflow">break</span>;
03034 <span class="preprocessor">#endif</span>
03035 <span class="preprocessor"></span>                                                                                                }
03036                                                                                                 <span class="keywordflow">break</span>;
03037                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16                                  */</span>
03038                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03039                                                                                                 {
03040 <span class="preprocessor">#if LH_Calc3to3_Di16_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03041 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16          Grid 16         */</span>
03042                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut16_G16);
03043                                                                                                                 <span class="keywordflow">break</span>;
03044 <span class="preprocessor">#endif</span>
03045 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di16_Do8_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03046 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 8            Lut 16          Grid 32         */</span>
03047                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do8_Lut16_G32);
03048                                                                                                                 <span class="keywordflow">break</span>;
03049 <span class="preprocessor">#endif</span>
03050 <span class="preprocessor"></span>                                                                                                }
03051                                                                                                 <span class="keywordflow">break</span>;
03052                                                                                 }
03053                                                                                 <span class="keywordflow">break</span>;
03054                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16                                                           */</span>
03055                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03056                                                                                 {
03057                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8                                   */</span>
03058                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03059                                                                                                 {
03060 <span class="preprocessor">#if LH_Calc3to3_Di16_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03061 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8           Grid 16         */</span>
03062                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut8_G16);
03063                                                                                                                 <span class="keywordflow">break</span>;
03064 <span class="preprocessor">#endif</span>
03065 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di16_Do16_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03066 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 8           Grid 32         */</span>
03067                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut8_G32);
03068                                                                                                                 <span class="keywordflow">break</span>;
03069 <span class="preprocessor">#endif</span>
03070 <span class="preprocessor"></span>                                                                                                }
03071                                                                                                 <span class="keywordflow">break</span>;
03072                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16                                  */</span>
03073                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03074                                                                                                 {
03075 <span class="preprocessor">#if LH_Calc3to3_Di16_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03076 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16          Grid 16         */</span>
03077                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut16_G16);
03078                                                                                                                 <span class="keywordflow">break</span>;
03079 <span class="preprocessor">#endif</span>
03080 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to3_Di16_Do16_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03081 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 3               Di 16           Do 16           Lut 16          Grid 32         */</span>
03082                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to3_Di16_Do16_Lut16_G32);
03083                                                                                                                 <span class="keywordflow">break</span>;
03084 <span class="preprocessor">#endif</span>
03085 <span class="preprocessor"></span>                                                                                                }
03086                                                                                                 <span class="keywordflow">break</span>;
03087                                                                                 }
03088                                                                                 <span class="keywordflow">break</span>;
03089                                                                 }
03090                                                                 <span class="keywordflow">break</span>;
03091                                                 }
03092                                                 <span class="keywordflow">break</span>;
03093                                         <span class="keywordflow">case</span> 4:                                                                                                                                                         <span class="comment">/* 3 -&gt; 4                                                                                                               */</span>
03094                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
03095                                                 {
03096                                                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8                                                                                    */</span>
03097                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03098                                                                 {
03099                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 8                                                            */</span>
03100                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03101                                                                                 {
03102                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8                                   */</span>
03103                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03104                                                                                                 {
03105 <span class="preprocessor">#if LH_Calc3to4_Di8_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03106 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8           Grid 16         */</span>
03107 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03108 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03109                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G16_F);
03110                                                         }
03111                                                         <span class="keywordflow">else</span>
03112 <span class="preprocessor">#endif</span>
03113 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE</span>
03114 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03115                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G16_Old);
03116                                                                                                                 }
03117                                                                                                                 <span class="keywordflow">else</span>
03118 <span class="preprocessor">#endif</span>
03119 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G16);
03120                                                                                                                 <span class="keywordflow">break</span>;
03121 <span class="preprocessor">#endif</span>
03122 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di8_Do8_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03123 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 8           Grid 32         */</span>
03124 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03125 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03126                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G32_F);
03127                                                         }
03128                                                         <span class="keywordflow">else</span>
03129 <span class="preprocessor">#endif</span>
03130 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE</span>
03131 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03132                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G32_Old);
03133                                                                                                                 }
03134                                                                                                                 <span class="keywordflow">else</span>
03135 <span class="preprocessor">#endif</span>
03136 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut8_G32);
03137                                                                                                                 <span class="keywordflow">break</span>;
03138 <span class="preprocessor">#endif</span>
03139 <span class="preprocessor"></span>                                                                                                }
03140                                                                                                 <span class="keywordflow">break</span>;
03141                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16                                  */</span>
03142                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03143                                                                                                 {
03144 <span class="preprocessor">#if LH_Calc3to4_Di8_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03145 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16          Grid 16         */</span>
03146                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut16_G16);
03147                                                                                                                 <span class="keywordflow">break</span>;
03148 <span class="preprocessor">#endif</span>
03149 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di8_Do8_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03150 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 8            Lut 16          Grid 32         */</span>
03151                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do8_Lut16_G32);
03152                                                                                                                 <span class="keywordflow">break</span>;
03153 <span class="preprocessor">#endif</span>
03154 <span class="preprocessor"></span>                                                                                                }
03155                                                                                                 <span class="keywordflow">break</span>;
03156                                                                                 }
03157                                                                                 <span class="keywordflow">break</span>;
03158                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16                                                           */</span>
03159                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03160                                                                                 {
03161                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8                                   */</span>
03162                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03163                                                                                                 {
03164 <span class="preprocessor">#if LH_Calc3to4_Di8_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03165 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8           Grid 16         */</span>
03166                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut8_G16);
03167                                                                                                                 <span class="keywordflow">break</span>;
03168 <span class="preprocessor">#endif</span>
03169 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di8_Do16_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03170 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 8           Grid 32         */</span>
03171                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut8_G32);
03172                                                                                                                 <span class="keywordflow">break</span>;
03173 <span class="preprocessor">#endif</span>
03174 <span class="preprocessor"></span>                                                                                                }
03175                                                                                                 <span class="keywordflow">break</span>;
03176                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16                                  */</span>
03177                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03178                                                                                                 {
03179 <span class="preprocessor">#if LH_Calc3to4_Di8_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03180 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16          Grid 16         */</span>
03181                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut16_G16);
03182                                                                                                                 <span class="keywordflow">break</span>;
03183 <span class="preprocessor">#endif</span>
03184 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di8_Do16_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03185 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 8            Do 16           Lut 16          Grid 32         */</span>
03186                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di8_Do16_Lut16_G32);
03187                                                                                                                 <span class="keywordflow">break</span>;
03188 <span class="preprocessor">#endif</span>
03189 <span class="preprocessor"></span>                                                                                                }
03190                                                                                                 <span class="keywordflow">break</span>;
03191                                                                                 }
03192                                                                                 <span class="keywordflow">break</span>;
03193                                                                 }
03194                                                                 <span class="keywordflow">break</span>;
03195                                                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16                                                                                   */</span>
03196                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03197                                                                 {
03198                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 8                                                            */</span>
03199                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03200                                                                                 {
03201                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8                                   */</span>
03202                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03203                                                                                                 {
03204 <span class="preprocessor">#if LH_Calc3to4_Di16_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03205 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8           Grid 16         */</span>
03206                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut8_G16);
03207                                                                                                                 <span class="keywordflow">break</span>;
03208 <span class="preprocessor">#endif</span>
03209 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di16_Do8_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03210 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 8           Grid 32         */</span>
03211                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut8_G32);
03212                                                                                                                 <span class="keywordflow">break</span>;
03213 <span class="preprocessor">#endif</span>
03214 <span class="preprocessor"></span>                                                                                                }
03215                                                                                                 <span class="keywordflow">break</span>;
03216                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16                                  */</span>
03217                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03218                                                                                                 {
03219 <span class="preprocessor">#if LH_Calc3to4_Di16_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03220 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16          Grid 16         */</span>
03221                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut16_G16);
03222                                                                                                                 <span class="keywordflow">break</span>;
03223 <span class="preprocessor">#endif</span>
03224 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di16_Do8_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03225 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 8            Lut 16          Grid 32         */</span>
03226                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do8_Lut16_G32);
03227                                                                                                                 <span class="keywordflow">break</span>;
03228 <span class="preprocessor">#endif</span>
03229 <span class="preprocessor"></span>                                                                                                }
03230                                                                                                 <span class="keywordflow">break</span>;
03231                                                                                 }
03232                                                                                 <span class="keywordflow">break</span>;
03233                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16                                                           */</span>
03234                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03235                                                                                 {
03236                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8                                   */</span>
03237                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03238                                                                                                 {
03239 <span class="preprocessor">#if LH_Calc3to4_Di16_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03240 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8           Grid 16         */</span>
03241                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut8_G16);
03242                                                                                                                 <span class="keywordflow">break</span>;
03243 <span class="preprocessor">#endif</span>
03244 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di16_Do16_Lut8_G32 != LH_CALC_USE_DO_N_DIM</span>
03245 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 8           Grid 32         */</span>
03246                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut8_G32);
03247                                                                                                                 <span class="keywordflow">break</span>;
03248 <span class="preprocessor">#endif</span>
03249 <span class="preprocessor"></span>                                                                                                }
03250                                                                                                 <span class="keywordflow">break</span>;
03251                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16                                  */</span>
03252                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03253                                                                                                 {
03254 <span class="preprocessor">#if LH_Calc3to4_Di16_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03255 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16          Grid 16         */</span>
03256                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut16_G16);
03257                                                                                                                 <span class="keywordflow">break</span>;
03258 <span class="preprocessor">#endif</span>
03259 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc3to4_Di16_Do16_Lut16_G32 != LH_CALC_USE_DO_N_DIM</span>
03260 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 32:                                                                                        <span class="comment">/* 3 -&gt; 4               Di 16           Do 16           Lut 16          Grid 32         */</span>
03261                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc3to4_Di16_Do16_Lut16_G32);
03262                                                                                                                 <span class="keywordflow">break</span>;
03263 <span class="preprocessor">#endif</span>
03264 <span class="preprocessor"></span>                                                                                                }
03265                                                                                                 <span class="keywordflow">break</span>;
03266                                                                                 }
03267                                                                                 <span class="keywordflow">break</span>;
03268                                                                 }
03269                                                                 <span class="keywordflow">break</span>;
03270                                                 }
03271                                                 <span class="keywordflow">break</span>;
03272                                 }
03273                                 <span class="keywordflow">break</span>;
03274                         <span class="keywordflow">case</span> 4:                                                                                                                                                                         <span class="comment">/* 4 -&gt;                                                                                                                 */</span>
03275                                 <span class="keywordflow">switch</span> ( lutParam-&gt;colorLutOutDim )
03276                                 {
03277                                         <span class="keywordflow">case</span> 3:                                                                                                                                                         <span class="comment">/* 4 -&gt; 3                                                                                                               */</span>
03278                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
03279                                                 {
03280                                                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8                                                                                    */</span>
03281                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03282                                                                 {
03283                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8                                                            */</span>
03284                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03285                                                                                 {
03286                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8                                   */</span>
03287                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03288                                                                                                 {
03289 <span class="preprocessor">#if LH_Calc4to3_Di8_Do8_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03290 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8           Grid 8          */</span>
03291 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03292 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03293                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G8_F);
03294                                                         }
03295                                                         <span class="keywordflow">else</span>
03296 <span class="preprocessor">#endif</span>
03297 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE_4DIM</span>
03298 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03299                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G8_Old);
03300                                                                                                                 }
03301                                                                                                                 <span class="keywordflow">else</span>
03302 <span class="preprocessor">#endif</span>
03303 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G8);
03304                                                                                                                 <span class="keywordflow">break</span>;
03305 <span class="preprocessor">#endif</span>
03306 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di8_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03307 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 8           Grid 16         */</span>
03308 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03309 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03310                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G16_F);
03311                                                         }
03312                                                         <span class="keywordflow">else</span>
03313 <span class="preprocessor">#endif</span>
03314 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE_4DIM</span>
03315 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03316                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G16_Old);
03317                                                                                                                 }
03318                                                                                                                 <span class="keywordflow">else</span>
03319 <span class="preprocessor">#endif</span>
03320 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut8_G16);
03321                                                                                                                 <span class="keywordflow">break</span>;
03322 <span class="preprocessor">#endif</span>
03323 <span class="preprocessor"></span>                                                                                                }
03324                                                                                                 <span class="keywordflow">break</span>;
03325                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16                                  */</span>
03326                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03327                                                                                                 {
03328 <span class="preprocessor">#if LH_Calc4to3_Di8_Do8_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03329 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16          Grid 8          */</span>
03330                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut16_G8);
03331                                                                                                                 <span class="keywordflow">break</span>;
03332 <span class="preprocessor">#endif</span>
03333 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di8_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03334 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 8            Lut 16          Grid 16         */</span>
03335                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do8_Lut16_G16);
03336                                                                                                                 <span class="keywordflow">break</span>;
03337 <span class="preprocessor">#endif</span>
03338 <span class="preprocessor"></span>                                                                                                }
03339                                                                                                 <span class="keywordflow">break</span>;
03340                                                                                 }
03341                                                                                 <span class="keywordflow">break</span>;
03342                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16                                                           */</span>
03343                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03344                                                                                 {
03345                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8                                   */</span>
03346                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03347                                                                                                 {
03348 <span class="preprocessor">#if LH_Calc4to3_Di8_Do16_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03349 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8           Grid 8          */</span>
03350                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut8_G8);
03351                                                                                                                 <span class="keywordflow">break</span>;
03352 <span class="preprocessor">#endif</span>
03353 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di8_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03354 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 8           Grid 16         */</span>
03355                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut8_G16);
03356                                                                                                                 <span class="keywordflow">break</span>;
03357 <span class="preprocessor">#endif</span>
03358 <span class="preprocessor"></span>                                                                                                }
03359                                                                                                 <span class="keywordflow">break</span>;
03360                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16                                  */</span>
03361                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03362                                                                                                 {
03363 <span class="preprocessor">#if LH_Calc4to3_Di8_Do16_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03364 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16          Grid 8          */</span>
03365                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut16_G8);
03366                                                                                                                 <span class="keywordflow">break</span>;
03367 <span class="preprocessor">#endif</span>
03368 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di8_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03369 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 8            Do 16           Lut 16          Grid 16         */</span>
03370                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di8_Do16_Lut16_G16);
03371                                                                                                                 <span class="keywordflow">break</span>;
03372 <span class="preprocessor">#endif</span>
03373 <span class="preprocessor"></span>                                                                                                }
03374                                                                                                 <span class="keywordflow">break</span>;
03375                                                                                 }
03376                                                                                 <span class="keywordflow">break</span>;
03377                                                                 }
03378                                                                 <span class="keywordflow">break</span>;
03379                                                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16                                                                                   */</span>
03380                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03381                                                                 {
03382                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8                                                            */</span>
03383                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03384                                                                                 {
03385                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8                                   */</span>
03386                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03387                                                                                                 {
03388 <span class="preprocessor">#if LH_Calc4to3_Di16_Do8_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03389 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8           Grid 8          */</span>
03390                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut8_G8);
03391                                                                                                                 <span class="keywordflow">break</span>;
03392 <span class="preprocessor">#endif</span>
03393 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di16_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03394 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 8           Grid 16         */</span>
03395                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut8_G16);
03396                                                                                                                 <span class="keywordflow">break</span>;
03397 <span class="preprocessor">#endif</span>
03398 <span class="preprocessor"></span>                                                                                                }
03399                                                                                                 <span class="keywordflow">break</span>;
03400                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16                                  */</span>
03401                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03402                                                                                                 {
03403 <span class="preprocessor">#if LH_Calc4to3_Di16_Do8_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03404 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16          Grid 8          */</span>
03405                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut16_G8);
03406                                                                                                                 <span class="keywordflow">break</span>;
03407 <span class="preprocessor">#endif</span>
03408 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di16_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03409 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 8            Lut 16          Grid 16         */</span>
03410                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do8_Lut16_G16);
03411                                                                                                                 <span class="keywordflow">break</span>;
03412 <span class="preprocessor">#endif</span>
03413 <span class="preprocessor"></span>                                                                                                }
03414                                                                                                 <span class="keywordflow">break</span>;
03415                                                                                 }
03416                                                                                 <span class="keywordflow">break</span>;
03417                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16                                                           */</span>
03418                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03419                                                                                 {
03420                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8                                   */</span>
03421                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03422                                                                                                 {
03423 <span class="preprocessor">#if LH_Calc4to3_Di16_Do16_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03424 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8           Grid 8          */</span>
03425                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut8_G8);
03426                                                                                                                 <span class="keywordflow">break</span>;
03427 <span class="preprocessor">#endif</span>
03428 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di16_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03429 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 8           Grid 16         */</span>
03430                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut8_G16);
03431                                                                                                                 <span class="keywordflow">break</span>;
03432 <span class="preprocessor">#endif</span>
03433 <span class="preprocessor"></span>                                                                                                }
03434                                                                                                 <span class="keywordflow">break</span>;
03435                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16                                  */</span>
03436                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03437                                                                                                 {
03438 <span class="preprocessor">#if LH_Calc4to3_Di16_Do16_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03439 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16          Grid 8          */</span>
03440                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut16_G8);
03441                                                                                                                 <span class="keywordflow">break</span>;
03442 <span class="preprocessor">#endif</span>
03443 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to3_Di16_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03444 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 3               Di 16           Do 16           Lut 16          Grid 16         */</span>
03445                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to3_Di16_Do16_Lut16_G16);
03446                                                                                                                 <span class="keywordflow">break</span>;
03447 <span class="preprocessor">#endif</span>
03448 <span class="preprocessor"></span>                                                                                                }
03449                                                                                                 <span class="keywordflow">break</span>;
03450                                                                                 }
03451                                                                                 <span class="keywordflow">break</span>;
03452                                                                 }
03453                                                                 <span class="keywordflow">break</span>;
03454                                                 }
03455                                                 <span class="keywordflow">break</span>;
03456                                         <span class="keywordflow">case</span> 4:                                                                                                                                                         <span class="comment">/* 4 -&gt; 4                                                                                                               */</span>
03457                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeIn)
03458                                                 {
03459                                                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8                                                                                    */</span>
03460                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03461                                                                 {
03462                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8                                                            */</span>
03463                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03464                                                                                 {
03465                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8                                   */</span>
03466                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03467                                                                                                 {
03468 <span class="preprocessor">#if LH_Calc4to4_Di8_Do8_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03469 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8           Grid 8          */</span>
03470 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03471 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03472                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G8_F);
03473                                                         }
03474                                                         <span class="keywordflow">else</span>
03475 <span class="preprocessor">#endif</span>
03476 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE_4DIM</span>
03477 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03478                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G8_Old);
03479                                                                                                                 }
03480                                                                                                                 <span class="keywordflow">else</span>
03481 <span class="preprocessor">#endif</span>
03482 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G8);
03483                                                                                                                 <span class="keywordflow">break</span>;
03484 <span class="preprocessor">#endif</span>
03485 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di8_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03486 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 8           Grid 16         */</span>
03487 <span class="preprocessor">#ifdef ALLOW_MMX</span>
03488 <span class="preprocessor"></span>                                                        <span class="keywordflow">if</span> (DetectMMX()) {
03489                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G16_F);
03490                                                         }
03491                                                         <span class="keywordflow">else</span>
03492 <span class="preprocessor">#endif</span>
03493 <span class="preprocessor"></span><span class="preprocessor">#if LH_CALC_USE_ADDITIONAL_OLD_CODE_4DIM</span>
03494 <span class="preprocessor"></span>                                                                                                                <span class="keywordflow">if</span>( !info-&gt;inPlace ){
03495                                                                                                                     proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G16_Old);
03496                                                                                                                 }
03497                                                                                                                 <span class="keywordflow">else</span>
03498 <span class="preprocessor">#endif</span>
03499 <span class="preprocessor"></span>                                                                                                                        proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut8_G16);
03500                                                                                                                 <span class="keywordflow">break</span>;
03501 <span class="preprocessor">#endif</span>
03502 <span class="preprocessor"></span>                                                                                                }
03503                                                                                                 <span class="keywordflow">break</span>;
03504                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16                                  */</span>
03505                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03506                                                                                                 {
03507 <span class="preprocessor">#if LH_Calc4to4_Di8_Do8_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03508 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16          Grid 8          */</span>
03509                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut16_G8);
03510                                                                                                                 <span class="keywordflow">break</span>;
03511 <span class="preprocessor">#endif</span>
03512 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di8_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03513 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 8            Lut 16          Grid 16         */</span>
03514                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do8_Lut16_G16);
03515                                                                                                                 <span class="keywordflow">break</span>;
03516 <span class="preprocessor">#endif</span>
03517 <span class="preprocessor"></span>                                                                                                }
03518                                                                                                 <span class="keywordflow">break</span>;
03519                                                                                 }
03520                                                                                 <span class="keywordflow">break</span>;
03521                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16                                                           */</span>
03522                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03523                                                                                 {
03524                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8                                   */</span>
03525                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03526                                                                                                 {
03527 <span class="preprocessor">#if LH_Calc4to4_Di8_Do16_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03528 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8           Grid 8          */</span>
03529                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut8_G8);
03530                                                                                                                 <span class="keywordflow">break</span>;
03531 <span class="preprocessor">#endif</span>
03532 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di8_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03533 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 8           Grid 16         */</span>
03534                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut8_G16);
03535                                                                                                                 <span class="keywordflow">break</span>;
03536 <span class="preprocessor">#endif</span>
03537 <span class="preprocessor"></span>                                                                                                }
03538                                                                                                 <span class="keywordflow">break</span>;
03539                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16                                  */</span>
03540                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03541                                                                                                 {
03542 <span class="preprocessor">#if LH_Calc4to4_Di8_Do16_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03543 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16          Grid 8          */</span>
03544                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut16_G8);
03545                                                                                                                 <span class="keywordflow">break</span>;
03546 <span class="preprocessor">#endif</span>
03547 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di8_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03548 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 8            Do 16           Lut 16          Grid 16         */</span>
03549                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di8_Do16_Lut16_G16);
03550                                                                                                                 <span class="keywordflow">break</span>;
03551 <span class="preprocessor">#endif</span>
03552 <span class="preprocessor"></span>                                                                                                }
03553                                                                                                 <span class="keywordflow">break</span>;
03554                                                                                 }
03555                                                                                 <span class="keywordflow">break</span>;
03556                                                                 }
03557                                                                 <span class="keywordflow">break</span>;
03558                                                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16                                                                                   */</span>
03559                                                                 <span class="keywordflow">switch</span> (info-&gt;usedSizeOut)
03560                                                                 {
03561                                                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8                                                            */</span>
03562                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03563                                                                                 {
03564                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8                                   */</span>
03565                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03566                                                                                                 {
03567 <span class="preprocessor">#if LH_Calc4to4_Di16_Do8_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03568 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8           Grid 8          */</span>
03569                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut8_G8);
03570                                                                                                                 <span class="keywordflow">break</span>;
03571 <span class="preprocessor">#endif</span>
03572 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di16_Do8_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03573 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 8           Grid 16         */</span>
03574                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut8_G16);
03575                                                                                                                 <span class="keywordflow">break</span>;
03576 <span class="preprocessor">#endif</span>
03577 <span class="preprocessor"></span>                                                                                                }
03578                                                                                                 <span class="keywordflow">break</span>;
03579                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16                                  */</span>
03580                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03581                                                                                                 {
03582 <span class="preprocessor">#if LH_Calc4to4_Di16_Do8_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03583 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16          Grid 8          */</span>
03584                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut16_G8);
03585                                                                                                                 <span class="keywordflow">break</span>;
03586 <span class="preprocessor">#endif</span>
03587 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di16_Do8_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03588 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 8            Lut 16          Grid 16         */</span>
03589                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do8_Lut16_G16);
03590                                                                                                                 <span class="keywordflow">break</span>;
03591 <span class="preprocessor">#endif</span>
03592 <span class="preprocessor"></span>                                                                                                }
03593                                                                                                 <span class="keywordflow">break</span>;
03594                                                                                 }
03595                                                                                 <span class="keywordflow">break</span>;
03596                                                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16                                                           */</span>
03597                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutWordSize)
03598                                                                                 {
03599                                                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8                                   */</span>
03600                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03601                                                                                                 {
03602 <span class="preprocessor">#if LH_Calc4to4_Di16_Do16_Lut8_G8 != LH_CALC_USE_DO_N_DIM</span>
03603 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8           Grid 8          */</span>
03604                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut8_G8);
03605                                                                                                                 <span class="keywordflow">break</span>;
03606 <span class="preprocessor">#endif</span>
03607 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di16_Do16_Lut8_G16 != LH_CALC_USE_DO_N_DIM</span>
03608 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 8           Grid 16         */</span>
03609                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut8_G16);
03610                                                                                                                 <span class="keywordflow">break</span>;
03611 <span class="preprocessor">#endif</span>
03612 <span class="preprocessor"></span>                                                                                                }
03613                                                                                                 <span class="keywordflow">break</span>;
03614                                                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16                                  */</span>
03615                                                                                                 <span class="keywordflow">switch</span> (lutParam-&gt;colorLutGridPoints)
03616                                                                                                 {
03617 <span class="preprocessor">#if LH_Calc4to4_Di16_Do16_Lut16_G8 != LH_CALC_USE_DO_N_DIM</span>
03618 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 8:                                                                                         <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16          Grid 8          */</span>
03619                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut16_G8);
03620                                                                                                                 <span class="keywordflow">break</span>;
03621 <span class="preprocessor">#endif</span>
03622 <span class="preprocessor"></span><span class="preprocessor">#if LH_Calc4to4_Di16_Do16_Lut16_G16 != LH_CALC_USE_DO_N_DIM</span>
03623 <span class="preprocessor"></span>                                                                                                        <span class="keywordflow">case</span> 16:                                                                                        <span class="comment">/* 4 -&gt; 4               Di 16           Do 16           Lut 16          Grid 16         */</span>
03624                                                                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(LHCalc4to4_Di16_Do16_Lut16_G16);
03625                                                                                                                 <span class="keywordflow">break</span>;
03626 <span class="preprocessor">#endif</span>
03627 <span class="preprocessor"></span>                                                                                                }
03628                                                                                                 <span class="keywordflow">break</span>;
03629                                                                                 }
03630                                                                                 <span class="keywordflow">break</span>;
03631                                                                 }
03632                                                                 <span class="keywordflow">break</span>;
03633                                                 }
03634                                                 <span class="keywordflow">break</span>;
03635                                 }
03636                                 <span class="keywordflow">break</span>;
03637                 }
03638   }
03639 <span class="preprocessor">#endif</span>
03640 <span class="preprocessor"></span>  
03641         <span class="keywordflow">if</span> ( ( proc2call == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> )
03642 <span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
03643 <span class="preprocessor"></span>                 || ( gUSE_NDIM_FOR_BITMAP )
03644 <span class="preprocessor">#endif</span>
03645 <span class="preprocessor"></span>                )                                               
03646         {
03647                 <span class="keywordflow">switch</span> (info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>)
03648                 {
03649                         <span class="keywordflow">case</span> 8:                                                                                                                                         <span class="comment">/*      Di 8                                                    */</span>
03650                                 <span class="keywordflow">switch</span> (info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a>)
03651                                 {
03652                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/*      Di 8            Do 8                            */</span>
03653                                                 <span class="keywordflow">switch</span> (lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>)
03654                                                 {
03655                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/*      Di 8            Do 8            Lut 8   */</span>
03656                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data8To8_Lut8);
03657                                                                 <span class="keywordflow">break</span>;
03658                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/*      Di 8            Do 8            Lut 16  */</span>
03659                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data8To8_Lut16);
03660                                                                 <span class="keywordflow">break</span>;
03661                                                 }
03662                                                 <span class="keywordflow">break</span>;
03663                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/*      Di 8            Do 16                           */</span>
03664                                                 <span class="keywordflow">switch</span> (lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>)
03665                                                 {
03666                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/*      Di 8            Do 16           Lut 8   */</span>
03667                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data8To16_Lut8);
03668                                                                 <span class="keywordflow">break</span>;
03669                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/*      Di 8            Do 16           Lut 16  */</span>
03670                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data8To16_Lut16);
03671                                                                 <span class="keywordflow">break</span>;
03672                                                 }
03673                                                 <span class="keywordflow">break</span>;
03674                                 }
03675                                 <span class="keywordflow">break</span>;
03676                         <span class="keywordflow">case</span> 16:                                                                                                                                        <span class="comment">/*      Di 16                                                   */</span>
03677                                 <span class="keywordflow">switch</span> (info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a>)
03678                                 {
03679                                         <span class="keywordflow">case</span> 8:                                                                                                                         <span class="comment">/*      Di 16           Do 8                            */</span>
03680                                                 <span class="keywordflow">switch</span> (lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>)
03681                                                 {
03682                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/*      Di 16           Do 8            Lut 8   */</span>
03683                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data16To8_Lut8);
03684                                                                 <span class="keywordflow">break</span>;
03685                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/*      Di 16           Do 8            Lut 16  */</span>
03686                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data16To8_Lut16);
03687                                                                 <span class="keywordflow">break</span>;
03688                                                 }
03689                                                 <span class="keywordflow">break</span>;
03690                                         <span class="keywordflow">case</span> 16:                                                                                                                        <span class="comment">/*      Di 16           Do 16                           */</span>
03691                                                 <span class="keywordflow">switch</span> (lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>)
03692                                                 {
03693                                                         <span class="keywordflow">case</span> 8:                                                                                                         <span class="comment">/*      Di 16           Do 16           Lut 8   */</span>
03694                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data16To16_Lut8);
03695                                                                 <span class="keywordflow">break</span>;
03696                                                         <span class="keywordflow">case</span> 16:                                                                                                        <span class="comment">/*      Di 16           Do 16           Lut 16  */</span>
03697                                                                 proc2call = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a2">NewCalcProc</a>(CalcNDim_Data16To16_Lut16);
03698                                                                 <span class="keywordflow">break</span>;
03699                                                 }
03700                                                 <span class="keywordflow">break</span>;
03701                                 }
03702                                 <span class="keywordflow">break</span>;
03703                 }
03704         }
03705 
03706 <span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
03707 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( DebugCheck(kThisFile, kDebugMiscInfo) )
03708         {
03709                 <span class="keywordflow">if</span> ( gUSE_NDIM_FOR_BITMAP )
03710                         <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>(<span class="stringliteral">"DoNDIM:     %1d-&gt;%1d   Di %2d   Do %2d   Grid %2d  Lut %2d\n"</span>,      lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>, lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>,
03711                                                                                                                                                                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>, info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a>,
03712                                                                                                                                                                                 lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o8">colorLutGridPoints</a>, lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>);
03713                 <span class="keywordflow">else</span>
03714                         <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>(<span class="stringliteral">"OPTIMIZED:  %1d-&gt;%1d   Di %2d   Do %2d   Grid %2d  Lut %2d\n"</span>,      lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>, lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>,
03715                                                                                                                                                                                 info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>, info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a>,
03716                                                                                                                                                                                 lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o8">colorLutGridPoints</a>, lutParam-&gt;<a class="code" href="../../d0/d4/structCMLutParam.html#o9">colorLutWordSize</a>);
03717         }
03718         <span class="keywordflow">if</span> (proc2call == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
03719                 <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>(<span class="stringliteral">"¥ ERROR: FindCalcRoutine is nil !!!\n"</span>);
03720 <span class="preprocessor">#endif</span>
03721 <span class="preprocessor"></span>        <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"FindCalcRoutine"</span>)
03722         return proc2call;
03723 }
03724 
03725 #ifdef __MWERKS__
03726 #pragma mark ================  Match/Check CMColors  ================
03727 #endif
03728 
03729 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
03730 <span class="comment">        LHMatchColorsPrivate</span>
03731 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
03732 CMError
<a name="l03733"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a30">03733</a> LHMatchColorsPrivate     (CMMModelPtr           modelingData, 
03734                                                   <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>*                      myColors, 
03735                                                   SINT32                        count)
03736 {
03737         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
03738         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
03739         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
03740         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
03741         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine   = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
03742 
03743         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHMatchColorsPrivate"</span>)
03744         
03745         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
03746         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
03747         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
03748 
03749         <span class="comment">/* preprocess for NamedColor stuff */</span>
03750         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a17">NamedColorProfileOnly</a>){
03751                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a7">ConvertNamedIndexToColors</a>(modelingData,myColors,count); 
03752                 <span class="keywordflow">goto</span> CleanupAndExit;
03753         } 
03754         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf==<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a18">NamedColorProfileAtBegin</a>){
03755                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a6">ConvertNamedIndexToPCS</a>(modelingData,myColors,count); 
03756                 <span class="keywordflow">if</span> (err) <span class="keywordflow">goto</span> CleanupAndExit;
03757         }
03758 
03759         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
03760         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
03761  
03762         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a>  = 16;
03763         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> = 16;
03764         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>  = 16;
03765         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a> = 16;
03766 
03767         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a17">FillLutParam</a>(&amp;lutParam, modelingData);
03768         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a20">FillCalcParamCM</a>(&amp;calcParam, &amp;lutParam, myColors, count );
03769         
03770         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03771         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup );
03772         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
03773         {
03774                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
03775                 <span class="keywordflow">goto</span> CleanupAndExit;
03776         }
03777                 
03778         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);
03779         <span class="keywordflow">if</span> (err)
03780                 <span class="keywordflow">goto</span> CleanupAndExit;
03781         
03782         <span class="comment">/* postprocess for NamedColor stuff */</span>
03783         err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a8">ConvertPCSToNamedIndex</a>(modelingData,myColors,count); 
03784 
03785 CleanupAndExit:
03786         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
03787         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
03788         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
03789 
03790         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHMatchColorsPrivate"</span>)
03791         <span class="keywordflow">return</span> err;
03792 }
03793 
03794 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
03795 <span class="comment">        LHCheckColorsPrivateMS</span>
03796 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
<a name="l03797"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a31">03797</a> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a4">LHCheckColorsPrivateMS</a>( CMMModelPtr             modelingData, 
03798                                                                 <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>*                myColors, 
03799                                                                 UINT32                  count, 
03800                                                                 UINT8                   *result )
03801 {
03802         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
03803         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
03804         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
03805         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
03806         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine   = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
03807 
03808         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHCheckColorsPrivateMS"</span>)
03809         
03810         <span class="keywordflow">if</span>( (modelingData)-&gt;gamutLutParam.colorLut == 0 )<span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
03811         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
03812         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
03813         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
03814 
03815         <span class="comment">/* preprocess for NamedColor stuff */</span>
03816         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a17">NamedColorProfileOnly</a>){
03817                 err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>;
03818                 <span class="keywordflow">goto</span> CleanupAndExit;
03819         } 
03820         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf==<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a18">NamedColorProfileAtBegin</a>){
03821                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a6">ConvertNamedIndexToPCS</a>(modelingData,myColors,count); 
03822                 <span class="keywordflow">if</span> (err) <span class="keywordflow">goto</span> CleanupAndExit;
03823         }
03824 
03825         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
03826         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
03827  
03828         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a>  = 16;
03829         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> = 8;
03830         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>  = 16;
03831         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a> = 8;
03832 
03833         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a18">FillLutParamChk</a>(&amp;lutParam, modelingData);
03834         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a20">FillCalcParamCM</a>(&amp;calcParam, &amp;lutParam, myColors, count );
03835         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[0] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)result;
03836         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a> = count*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>);
03837         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a> = 1;
03838         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o1">cmOutputColorSpace</a> = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a151a96">cmGraySpace8Bit</a>; <span class="comment">/* cmGraySpace is 16 bit */</span>
03839 
03840         
03841         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a> *)myColors == result;
03842         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup );
03843         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
03844         {
03845                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
03846                 <span class="keywordflow">goto</span> CleanupAndExit;
03847         }
03848                 
03849         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);
03850         <span class="keywordflow">if</span> (err)
03851                 <span class="keywordflow">goto</span> CleanupAndExit;
03852         
03853         <span class="comment">/* postprocess for NamedColor stuff */</span>
03854         <span class="keywordflow">if</span>( modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a> ){
03855                 err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>;
03856                 <span class="keywordflow">goto</span> CleanupAndExit;
03857         }
03858 CleanupAndExit:
03859         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
03860         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
03861         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
03862 
03863         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHCheckColorsPrivateMS"</span>)
03864         <span class="keywordflow">return</span> err;
03865 }
03866 
03867 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
03868 <span class="comment">        LHCheckColorsPrivate</span>
03869 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
03870 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> 
<a name="l03871"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a32">03871</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a3">LHCheckColorsPrivate</a>    ( CMMModelPtr           modelingData, 
03872                                                   <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>*                      myColors, 
03873                                                   UINT32                        count, 
03874                                                   UINT8                         *result )
03875 {
03876         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
03877         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
03878         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
03879         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
03880         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine   = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
03881         
03882         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHCheckColorsPrivate"</span>)
03883         
03884         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
03885         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
03886  
03887         <span class="comment">/* disabling check colors with Named Color Profile */</span>
03888         <span class="keywordflow">if</span> ( modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a17">NamedColorProfileOnly</a> ||
03889                  modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a> ){
03890                 err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>;
03891                 <span class="keywordflow">goto</span> CleanupAndExit;
03892         }
03893         
03894         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a>  = 16;
03895         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> = 16;
03896         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o2">usedSizeIn</a>  = 16;
03897         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o3">usedSizeOut</a> = 16;
03898 
03899         <span class="keywordflow">if</span>( (modelingData)-&gt;gamutLutParam.colorLut == 0 )<span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
03900         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
03901         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
03902         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
03903 
03904         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a18">FillLutParamChk</a>(&amp;lutParam, modelingData);
03905         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a20">FillCalcParamCM</a>(&amp;calcParam, &amp;lutParam, myColors, count );
03906 
03907         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a25">AllocBufferCheckCM</a>(&amp;calcParam, &amp;info);
03908         
03909         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
03910         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup  );
03911         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
03912         {
03913                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
03914                 <span class="keywordflow">goto</span> CleanupAndExit;
03915         }
03916                 
03917         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine, &amp;calcParam, &amp;lutParam);
03918         
03919         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a14">Convert8To1</a>( (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)result, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>, count, count*<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>));                 
03920 
03921         <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>);
03922         
03923 CleanupAndExit:
03924         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
03925         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
03926         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
03927         
03928         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHCheckColorsPrivate"</span>)
03929         <span class="keywordflow">return</span> err;
03930 }
03931 
03932 <span class="keywordtype">void</span> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a33">CopyIndexData</a>( <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *bitMapIn, <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *bitMapOut, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info );
03933 <span class="keywordtype">void</span> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a33">CopyIndexData</a>( <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *bitMapIn, <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *bitMapOut, <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a> *info )
03934 {
03935         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                     imgIn=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03936         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                     imgOut=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03937         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>          i,j;
03938 <span class="preprocessor">#ifdef DEBUG_OUTPUT</span>
03939 <span class="preprocessor"></span>        <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
03940 <span class="preprocessor">#endif  </span>
03941 <span class="preprocessor"></span>        <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CopyIndexData"</span>)
03942 
03943         for( i=0; i&lt;bitMapIn-&gt;height; i++ ){
03944                 imgIn = bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> + i * bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>;
03945                 imgOut = bitMapOut-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> + i * bitMapOut-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>;
03946                 <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> == 24 ){
03947                         <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a> == 24 ){
03948                                 <span class="keywordflow">for</span> (j=0;j&lt;bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>;j++) {
03949                                         *imgOut++  = *imgIn++;
03950                                         *imgOut++  = *imgIn++;
03951                                         *imgOut++  = *imgIn++;
03952                                 }
03953                         }
03954                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a> == 32 ){
03955                                 <span class="keywordflow">for</span> (j=0;j&lt;bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>;j++) {
03956                                         *imgOut++  = *imgIn++;
03957                                         *imgOut++  = *imgIn++;
03958                                         *imgOut++  = *imgIn++;
03959                                         imgOut++;
03960                                 }
03961                         }
03962                 }
03963                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> == 32 ){
03964                         <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a> == 24 ){
03965                                 <span class="keywordflow">for</span> (j=0;j&lt;bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>;j++) {
03966                                         *imgOut++  = *imgIn++;
03967                                         *imgOut++  = *imgIn++;
03968                                         *imgOut++  = *imgIn++;
03969                                         imgIn++;
03970                                 }
03971                         }
03972                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info-&gt;<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a> == 32 ){
03973                                 <span class="keywordflow">for</span> (j=0;j&lt;bitMapIn-&gt;<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>;j++) {
03974                                         *imgOut++  = *imgIn++;
03975                                         *imgOut++  = *imgIn++;
03976                                         *imgOut++  = *imgIn++;
03977                                         imgOut++;
03978                                         imgIn++;
03979                                 }
03980                         }
03981                 }
03982         }
03983         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CopyIndexData"</span>)
03984         return;
03985 }
03986 
03987 #ifdef __MWERKS__
03988 #pragma mark ================  Match/Check CMBitmaps  ================
03989 #endif
03990 
03991 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
03992 <span class="comment">        LHMatchBitMapPrivate</span>
03993 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
03994 CMError
<a name="l03995"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a34">03995</a> LHMatchBitMapPrivate     ( CMMModelPtr                  modelingData, 
03996                                                    const <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *             inBitMap, 
03997                                                    CMBitmapCallBackUPP  progressProc, 
03998                                                    <span class="keywordtype">void</span> *                               refCon, 
03999                                                    <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a> *                   outBitMap )
04000 {
04001         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
04002         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
04003         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
04004         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
04005         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine     = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04006         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                bitMapOut;
04007         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                bitMapIn                        = *inBitMap;
04008         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>                  inColorSpace    = modelingData-&gt;firstColorSpace;
04009         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>                  outColorSpace   = modelingData-&gt;lastColorSpace;
04010         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04011         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  offset;
04012         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  progressTimer;
04013         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  dimLoop;
04014         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 matchInPlace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04015         <span class="keywordtype">long</span>                    progressProcCount = 0;
04016         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  inLineCount;
04017         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                             aBuffer;
04018         
04019         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHMatchBitMapPrivate"</span>)
04020 
04021         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
04022         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
04023         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
04024 
04025         <span class="keywordflow">if</span>( outBitMap == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> ){
04026                 bitMapOut = *inBitMap;
04027                 matchInPlace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04028         }
04029         <span class="keywordflow">else</span>{
04030                 bitMapOut       = *outBitMap;
04031         }
04032 
04033         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
04034         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
04035 
04036         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a17">FillLutParam</a>(&amp;lutParam, modelingData);
04037         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a19">FillCalcParam</a>(&amp;calcParam, &amp;bitMapIn, &amp;bitMapOut);
04038         
04039         err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a21">CheckInputColorSpace</a>( &amp;bitMapIn, &amp;calcParam, &amp;info, inColorSpace, lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a> );
04040         inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04041         <span class="keywordflow">if</span> (err)
04042                 <span class="keywordflow">goto</span> CleanupAndExit;
04043                 
04044         <span class="keywordflow">if</span> (matchInPlace){
04045                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a23">SetOutputColorSpaceInplace</a>( &amp;calcParam, &amp;info, outColorSpace);
04046                 <span class="keywordflow">if</span> (err)
04047                         <span class="keywordflow">goto</span> CleanupAndExit;
04048         }
04049         err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a22">CheckOutputColorSpace</a>( &amp;bitMapOut, &amp;calcParam, &amp;info, outColorSpace, lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a> );
04050         <span class="keywordflow">if</span> (err)
04051                 <span class="keywordflow">goto</span> CleanupAndExit;
04052         
04053         <span class="keywordflow">if</span> (matchInPlace)               <span class="comment">/* matching in place - check if pixel sizes are ok */</span>
04054         {
04055                 <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o8">inputPixelSize</a> &lt; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o9">outputPixelSize</a>)
04056                 {
04057                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
04058                         <span class="keywordflow">goto</span> CleanupAndExit;
04059                 }               
04060                 <span class="comment">/* set the color space field to the output color space */</span>
04061                 bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a> = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o1">cmOutputColorSpace</a>;
04062         } <span class="keywordflow">else</span>
04063         {
04064                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o10">copyAlpha</a> = (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a> &amp; <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a43">cmAlphaSpace</a>) &amp;&amp; (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o1">cmOutputColorSpace</a> &amp; <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a43">cmAlphaSpace</a>);
04065         }
04066 
04067         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> == bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04068         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup );
04069         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04070         {
04071                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
04072                 <span class="keywordflow">goto</span> CleanupAndExit;
04073         }
04074         
04075         <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> &amp;&amp; calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> &lt; calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a> ){
04076                         <span class="keywordflow">for</span>( dimLoop=0; dimLoop&lt;8; dimLoop++){                                  <span class="comment">/* now work backwards                           */</span>
04077                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] + (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>-1) * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a> + (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o2">cmPixelPerLine</a>-1) * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>;
04078                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] + (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>-1) * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a> + (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o2">cmPixelPerLine</a>-1) * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a>;
04079                         }
04080                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = -calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>;   
04081                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a> = -calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a>;
04082                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a> = -calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04083                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a> = -calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a>;
04084         }
04085         <span class="comment">/* ------------------------------------------------- 8 or 16 bit data --------------------------------------------------------- */</span>
04086         <span class="keywordflow">if</span> ((info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)&amp;&amp; modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a16">NoNamedColorProfile</a>)
04087         {
04088                 <span class="keywordflow">if</span> (progressProc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04089                         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);          <span class="comment">/* no callback proc - do it all in one step */</span>
04090                 <span class="keywordflow">else</span>
04091                 {
04092                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a> / calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04093                         <span class="keywordflow">if</span> (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &lt; 1)
04094                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = 1;
04095                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>)
04096                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>;
04097                                 
04098                         progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04099                         <span class="keywordflow">while</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> &lt;  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04100                         {
04101                                 err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);
04102                         
04103                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>; dimLoop++)
04104                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04105                                         
04106                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>; dimLoop++)
04107                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop]  + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a>;
04108         
04109                                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> += calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04110                                 <span class="keywordflow">if</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04111                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>-info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04112                                                 
04113                                 <span class="comment">/* - - - - - handle CMBitmapCallBackProc - - - - - */</span>
04114                                 <span class="keywordflow">if</span> ( progressProc &amp;&amp; ( progressTimer + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a0">kProgressTicks</a> &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>()) )  
04115                                 {
04116                                         progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04117                                         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, (<span class="keywordtype">void</span> *)refCon ))
04118                                         {
04119                                                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> =  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>; 
04120                                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a39">userCanceledErr</a>;
04121                                         } <span class="keywordflow">else</span>
04122                                                 progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04123                                                 progressProcCount = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04124                                 }
04125                         }
04126                 }
04127         }
04128         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf != <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a17">NamedColorProfileOnly</a> ){
04129                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> = 0;
04130                 progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04131                 <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04132                         <span class="keywordflow">if</span>( inLineCount &gt; calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> )inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04133                 }
04134                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> ){
04135                         <span class="keywordflow">if</span>( progressProc &amp;&amp; modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a> ){
04136                                 inLineCount /= 32;
04137                                 <span class="keywordflow">if</span>( inLineCount &lt; 1 ) inLineCount = 1;
04138                         }
04139                 }
04140                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04141                         inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04142                 }
04143                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( progressProc ){
04144                         inLineCount = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a> / calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04145                         <span class="keywordflow">if</span> (inLineCount &lt; 1)
04146                                 inLineCount = 1;
04147                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inLineCount &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>)
04148                                 inLineCount = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>;
04149                         <span class="keywordflow">if</span>( modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a> ){
04150                                 inLineCount /= 32;
04151                                 <span class="keywordflow">if</span>( inLineCount &lt; 1 ) inLineCount = 1;
04152                         }
04153                 }
04154                 <span class="keywordflow">while</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> &lt;  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04155                 {
04156                         <span class="keywordflow">if</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> + inLineCount &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04157                                 inLineCount = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>-info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04158 
04159                         <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 5 )                                                                                                                                                      <span class="comment">/* input is 5 bit */</span>
04160                                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a12">Convert5To8</a>  ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04161 <span class="preprocessor">#ifdef PI_Application_h</span>
04162 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 6 )                                                                                                                                                 <span class="comment">/* output is 5 bit */</span>
04163                                 Convert565To8 ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04164 <span class="preprocessor">#endif</span>
04165 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 10 ) 
04166                                         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a16">Convert10To16</a>  ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04167                         
04168                         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a18">NamedColorProfileAtBegin</a> ){
04169                                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a10">ConvertIndexToLabBitmap</a>(  modelingData, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, 
04170                                                                                                 (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, 
04171                                                                                                 inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, 
04172                                                                                                 bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>, 
04173                                                                                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>, 
04174                                                                                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>*8 );
04175                                 <span class="keywordflow">if</span> (err) 
04176                                         <span class="keywordflow">goto</span> CleanupAndExit;
04177                         }
04178                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = inLineCount;
04179                         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>( calcRoutine, &amp;calcParam, &amp;lutParam );
04180                         <span class="keywordflow">if</span> (err) 
04181                                 <span class="keywordflow">goto</span> CleanupAndExit;
04182 
04183                         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a> ){
04184                                 <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> )aBuffer = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>;
04185                                 <span class="keywordflow">else</span> aBuffer = bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>;
04186                                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a9">ConvertLabToIndexBitmap</a>(  modelingData, aBuffer, 
04187                                                                                                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, 
04188                                                                                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>,
04189                                                                                                 bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04190                                 <span class="keywordflow">if</span> (err) 
04191                                         <span class="keywordflow">goto</span> CleanupAndExit;
04192                         }
04193 
04194                         <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> == 5 )                                                                                                                                                     <span class="comment">/* output is 5 bit */</span>
04195                                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a13">Convert8To5</a> ( (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>);
04196 <span class="preprocessor">#ifdef PI_Application_h</span>
04197 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> == 6 )                                                                                                                                                        <span class="comment">/* output is 5 bit */</span>
04198                                 Convert8To565 ( (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>);
04199 <span class="preprocessor">#endif</span>
04200 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> == 10 )                                                                                                                                                                                               <span class="comment">/* output is 10 bit */</span>
04201                                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a15">Convert16To10</a> ( (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>);
04202 
04203                         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> += inLineCount;
04204                         <span class="comment">/* - - - - - handle CMBitmapCallBackProc - - - - - */</span>
04205                         <span class="keywordflow">if</span> ( progressProc &amp;&amp; ( progressTimer + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a0">kProgressTicks</a> &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>()) )  
04206                         {
04207                                 progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04208                                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, (<span class="keywordtype">void</span> *)refCon ))
04209                                 {
04210                                         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> =  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>; 
04211                                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a39">userCanceledErr</a>;
04212                                 } <span class="keywordflow">else</span>
04213                                         progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04214                                         progressProcCount = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04215                         }
04216                         <span class="keywordflow">if</span>( !info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> ){
04217                                 offset = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04218                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>; dimLoop++)
04219                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] + offset;
04220                         }
04221                         <span class="keywordflow">if</span>( !info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04222                                 offset = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a>;
04223                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>; dimLoop++)
04224                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop]  + offset;
04225                         }
04226                 }
04227                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04228                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>);
04229         }
04230         <span class="keywordflow">else</span>{
04231                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a33">CopyIndexData</a>( &amp;bitMapIn, &amp;bitMapOut, &amp;info );
04232                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04233         }
04234         <span class="keywordflow">if</span> (err) 
04235                 <span class="keywordflow">goto</span> CleanupAndExit;
04236         
04237         <span class="keywordflow">if</span>( progressProcWasCalled &amp;&amp; progressProcCount != bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04238                 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, (<span class="keywordtype">void</span> *)refCon );
04239 CleanupAndExit:
04240         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
04241         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
04242         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
04243 
04244         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHMatchBitMapPrivate"</span>)
04245         
04246         <span class="keywordflow">return</span> err;
04247 }
04248 
04249 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04250 <span class="comment">        LHCheckBitMapPrivate</span>
04251 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
04252 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> 
<a name="l04253"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a35">04253</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a1">LHCheckBitMapPrivate</a>    ( CMMModelPtr                   modelingData, 
04254                                                   <span class="keyword">const</span> <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                *inBitMap,
04255                                                   CMBitmapCallBackUPP   progressProc,
04256                                                   <span class="keywordtype">void</span> *                                refCon, 
04257                                                   <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                              *outBitMap )
04258 {
04259         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
04260         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
04261         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
04262         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
04263         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine     = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04264         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                bitMapIn                        = *inBitMap;
04265         <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                bitMapOut;
04266         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>                  inColorSpace    = modelingData-&gt;firstColorSpace;
04267         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04268         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  offset;
04269         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  progressTimer;
04270         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  dimLoop;
04271         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 matchInPlace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04272         <span class="keywordtype">long</span>                    progressProcCount = 0;
04273         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  inLineCount;
04274         
04275         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHCheckBitMapPrivate"</span>)
04276 
04277         <span class="keywordflow">if</span>( (modelingData)-&gt;gamutLutParam.colorLut == 0 )<span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
04278         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
04279         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
04280         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
04281 
04282         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
04283         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
04284 
04285         <span class="keywordflow">if</span> ( (outBitMap == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> ) || (modelingData-&gt;gamutLutParam.colorLut == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) )
04286         {
04287                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
04288                 <span class="keywordflow">goto</span> CleanupAndExit;
04289         }
04290         bitMapOut = *outBitMap;
04291         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a18">FillLutParamChk</a>(&amp;lutParam, modelingData);
04292         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a19">FillCalcParam</a>(&amp;calcParam, &amp;bitMapIn, &amp;bitMapOut);
04293         
04294         err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a21">CheckInputColorSpace</a>( &amp;bitMapIn, &amp;calcParam, &amp;info, inColorSpace, lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a> );
04295         inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04296         <span class="keywordflow">if</span> (err)
04297                 <span class="keywordflow">goto</span> CleanupAndExit;
04298                 
04299         err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a24">CheckOutputColorSpaceChk</a>( &amp;bitMapOut, &amp;calcParam, &amp;info );
04300         <span class="keywordflow">if</span> (err)
04301                 <span class="keywordflow">goto</span> CleanupAndExit;
04302         
04303         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> == bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04304         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup );
04305         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04306         {
04307                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
04308                 <span class="keywordflow">goto</span> CleanupAndExit;
04309         }
04310         
04311         <span class="comment">/* ------------------------------------------------- 8 or 16 bit data --------------------------------------------------------- */</span>
04312         <span class="keywordflow">if</span> ((info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a16">NoNamedColorProfile</a>)
04313         {
04314                 <span class="keywordflow">if</span> (progressProc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04315                         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);          <span class="comment">/* no callback proc - do it all in one step */</span>
04316                 <span class="keywordflow">else</span>
04317                 {
04318                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a> / calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04319                         <span class="keywordflow">if</span> (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &lt; 1)
04320                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = 1;
04321                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>)
04322                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>;
04323                                 
04324                         progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04325                         <span class="keywordflow">while</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> &lt;  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04326                         {
04327                                 err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);
04328                         
04329                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>; dimLoop++)
04330                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04331                                         
04332                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>; dimLoop++)
04333                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop]  + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a>;
04334         
04335                                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> += calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04336                                 <span class="keywordflow">if</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> + calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04337                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>-info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04338                                                 
04339                                 <span class="comment">/* - - - - - handle CMBitmapCallBackProc - - - - - */</span>
04340                                 <span class="keywordflow">if</span> ( progressProc &amp;&amp; ( progressTimer + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a0">kProgressTicks</a> &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>()) )  
04341                                 {
04342                                         progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04343                                         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, (<span class="keywordtype">void</span> *)refCon ))
04344                                         {
04345                                                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> =  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>; 
04346                                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a39">userCanceledErr</a>;
04347                                         } <span class="keywordflow">else</span>
04348                                                 progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04349                                                 progressProcCount = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04350                                 }
04351                         }
04352                 }
04353         }
04354         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf != <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a17">NamedColorProfileOnly</a> ){
04355                 info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> = 0;
04356                 progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04357                 <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04358                         <span class="keywordflow">if</span>( inLineCount &gt; calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> )inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04359                 }
04360                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> ){
04361                 }
04362                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04363                         inLineCount = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>;
04364                 }
04365                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( progressProc ){
04366                         inLineCount = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a1">kMaxTempBlock</a> / calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04367                         <span class="keywordflow">if</span> (inLineCount &lt; 1)
04368                                 inLineCount = 1;
04369                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inLineCount &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>)
04370                                 inLineCount = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>;
04371                 }
04372                 <span class="keywordflow">while</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> &lt;  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04373                 {
04374                         <span class="keywordflow">if</span> ( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> + inLineCount &gt; bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04375                                 inLineCount = bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>-info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04376 
04377                         <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 5 )                                                                                                                                                      <span class="comment">/* input is 5 bit */</span>
04378                                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a12">Convert5To8</a>  ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04379 <span class="preprocessor">#ifdef PI_Application_h</span>
04380 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 6 )                                                                                                                                                 <span class="comment">/* output is 5 bit */</span>
04381                                 Convert565To8 ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04382 <span class="preprocessor">#endif</span>
04383 <span class="preprocessor"></span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> == 10 ) 
04384                                         <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a16">Convert10To16</a>  ( bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a> );
04385                         
04386                         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a18">NamedColorProfileAtBegin</a> ){
04387                                 err = <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a10">ConvertIndexToLabBitmap</a>(  modelingData, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, 
04388                                                                                                 (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, 
04389                                                                                                 inLineCount, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, 
04390                                                                                                 bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>, 
04391                                                                                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>, 
04392                                                                                                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a>*8 );
04393                                 <span class="keywordflow">if</span> (err) 
04394                                         <span class="keywordflow">goto</span> CleanupAndExit;
04395                         }
04396                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> = inLineCount;
04397                         err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>( calcRoutine, &amp;calcParam, &amp;lutParam );
04398                         <span class="keywordflow">if</span> (err) 
04399                                 <span class="keywordflow">goto</span> CleanupAndExit;
04400 
04401                         <span class="keywordflow">if</span>( info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> == 1 )                                                                                                                                                     <span class="comment">/* output is 5 bit */</span>
04402                                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a14">Convert8To1</a> ( (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>, bitMapOut.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>);
04403 
04404                         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> += inLineCount;
04405                         <span class="comment">/* - - - - - handle CMBitmapCallBackProc - - - - - */</span>
04406                         <span class="keywordflow">if</span> ( progressProc &amp;&amp; ( progressTimer + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a0">kProgressTicks</a> &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>()) )  
04407                         {
04408                                 progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04409                                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>, (<span class="keywordtype">void</span> *)refCon ))
04410                                 {
04411                                         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a> =  bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>; 
04412                                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a39">userCanceledErr</a>;
04413                                 } <span class="keywordflow">else</span>
04414                                         progressTimer = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>();
04415                                         progressProcCount = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o6">processedLinesIn</a>;
04416                         }
04417                         <span class="keywordflow">if</span>( !info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> ){
04418                                 offset = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o4">cmInputBytesPerLine</a>;
04419                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a>; dimLoop++)
04420                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop] + offset;
04421                         }
04422                         <span class="keywordflow">if</span>( !info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> ){
04423                                 offset = calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o3">cmLineCount</a> * calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o5">cmOutputBytesPerLine</a>;
04424                                 <span class="keywordflow">for</span> (dimLoop = 0; dimLoop&lt; lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>; dimLoop++)
04425                                         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop] =  (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop]  + offset;
04426                         }
04427                 }
04428                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04429                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>);
04430         }
04431         <span class="keywordflow">else</span>{
04432                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04433                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
04434                 <span class="keywordflow">goto</span> CleanupAndExit;
04435         }
04436         <span class="keywordflow">if</span> (err) 
04437                 <span class="keywordflow">goto</span> CleanupAndExit;
04438         
04439         <span class="keywordflow">if</span>( progressProcWasCalled &amp;&amp; progressProcCount != bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a> )
04440                 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, bitMapIn.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>, (<span class="keywordtype">void</span> *)refCon );
04441 CleanupAndExit:
04442         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.inputLut);
04443         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.colorLut);
04444         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;gamutLutParam.outputLut);
04445 
04446         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHCheckBitMapPrivate"</span>)
04447         
04448         <span class="keywordflow">return</span> err;
04449 }
04450 
04451 <span class="preprocessor">#ifdef __MWERKS__</span>
04452 <span class="preprocessor"></span><span class="preprocessor">#pragma mark ================  Match/Check CMBitmaps Plane ================</span>
04453 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
04454 <span class="preprocessor"></span>
04455 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04456 <span class="comment">        CMError</span>
04457 <span class="comment">        LHMatchBitMapPlanePrivate        ( CMMModelPtr                          modelingData, </span>
04458 <span class="comment">                                                                   const LH_CMBitmapPlane *     bitMapLH, </span>
04459 <span class="comment">                                                                   CMBitmapCallBackUPP          progressProc, </span>
04460 <span class="comment">                                                                   void *                                       refCon, </span>
04461 <span class="comment">                                                                   LH_CMBitmapPlane *           matchedBitMapLH )</span>
04462 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
04463 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>
<a name="l04464"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a36">04464</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a5">LHMatchBitMapPlanePrivate</a>        ( CMMModelPtr                          modelingData, 
04465                                                            <span class="keyword">const</span> <a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html">LH_CMBitmapPlane</a> *     bitMapLH, 
04466                                                            CMBitmapCallBackUPP          progressProc, 
04467                                                            <span class="keywordtype">void</span> *                                       refCon, 
04468                                                            <a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html">LH_CMBitmapPlane</a> *           matchedBitMapLH )
04469 {
04470         <a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>     calcParam;
04471         <a class="code" href="../../d0/d4/structCMLutParam.html">CMLutParam</a>              lutParam;
04472         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = -1;
04473         <a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>  info;
04474         <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a8">CalcProcPtr</a>             calcRoutine             = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04475         <a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html">LH_CMBitmapPlane</a> *      secondBitmapLH  = matchedBitMapLH;
04476         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>                  inColorSpace            = (modelingData)-&gt;firstColorSpace;
04477         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>                  outColorSpace           = (modelingData)-&gt;lastColorSpace;
04478         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 progressProcWasCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04479         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a>                 matchInPlace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04480         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a14">SINT32</a>                  dimLoop;
04481         
04482         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"LHMatchBitMapPlanePrivate"</span>)
04483         
04484         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;info,           <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d4/structColorSpaceInfo.html">ColorSpaceInfo</a>), 0);
04485         <a class="code" href="../../d7/d7/w98_2lh__open_2pi__mem_8c.html#a6">SetMem</a>(&amp;calcParam,      <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d3/structCMCalcParam.html">CMCalcParam</a>),    0);
04486         
04487         <span class="keywordflow">if</span> (secondBitmapLH == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04488         {
04489                 secondBitmapLH = (<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html">LH_CMBitmapPlane</a> *)bitMapLH;
04490                 matchInPlace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04491         }
04492         
04493         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
04494         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
04495         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
04496         
04497         <span class="comment">/* create CMBitmap based on the LH_CMBitmapPlane - so we can use the 'standard' setup functions */</span>
04498         {
04499                 <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                bitMap;
04500                 <a class="code" href="../../d6/d3/structCMBitmap.html">CMBitmap</a>                secondBitmap;
04501         
04502                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>                    = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o0">image</a>[0];
04503                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>                    = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o1">width</a>;
04504                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>                   = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o2">height</a>;
04505                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>                 = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o3">rowBytes</a>;
04506                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>                = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o5">pixelSize</a>;
04507                 bitMap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>                    = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o6">space</a>;
04508         
04509                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o0">image</a>              = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o0">image</a>[0];
04510                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o1">width</a>              = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o1">width</a>;
04511                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o2">height</a>             = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o2">height</a>;
04512                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o3">rowBytes</a>   = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o3">rowBytes</a>;
04513                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o4">pixelSize</a>  = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o5">pixelSize</a>;
04514                 secondBitmap.<a class="code" href="../../d6/d3/structCMBitmap.html#o5">space</a>              = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o6">space</a>;
04515         
04516                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a17">FillLutParam</a>(&amp;lutParam, modelingData);
04517                 <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a19">FillCalcParam</a>(&amp;calcParam, &amp;bitMap, &amp;secondBitmap);
04518 
04519                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a21">CheckInputColorSpace</a>(&amp;bitMap,&amp;calcParam, &amp;info, inColorSpace, lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a> );
04520                 <span class="keywordflow">if</span> (err)
04521                         <span class="keywordflow">goto</span> CleanupAndExit;
04522                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a22">CheckOutputColorSpace</a>(&amp;secondBitmap,&amp;calcParam, &amp;info, outColorSpace, lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a> );
04523                 <span class="keywordflow">if</span> (err)
04524                         <span class="keywordflow">goto</span> CleanupAndExit;
04525         }
04526         
04527         <span class="comment">/* now update the input/output data pointers */</span>
04528         <span class="keywordflow">for</span> (dimLoop = 0; dimLoop &lt; 8; dimLoop++)
04529         {
04530                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o8">inputData</a>[dimLoop]    = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o0">image</a>[dimLoop];
04531                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o9">outputData</a>[dimLoop]   = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o0">image</a>[dimLoop];
04532         }
04533         
04534         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> = bitMapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o4">elementOffset</a>;
04535         calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a> = secondBitmapLH-&gt;<a class="code" href="../../d2/d8/structLH__CMBitmapPlane.html#o4">elementOffset</a>;
04536         <span class="keywordflow">if</span> (bitMapLH == secondBitmapLH)         <span class="comment">/* matching in place - check if pixeloffsets are ok */</span>
04537         {
04538                 <span class="keywordflow">if</span> (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o6">cmInputPixelOffset</a> &lt; calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o7">cmOutputPixelOffset</a>)
04539                 {
04540                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
04541                         <span class="keywordflow">goto</span> CleanupAndExit;
04542                 }
04543                 <span class="keywordflow">if</span> (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o0">origSizeIn</a> * lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o6">colorLutInDim</a> &lt; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o1">origSizeOut</a> * lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o7">colorLutOutDim</a>)
04544                 {
04545                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a36">cmInvalidDstMap</a>;
04546                         <span class="keywordflow">goto</span> CleanupAndExit;
04547                 }
04548         } <span class="keywordflow">else</span>
04549         {
04550                 calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o10">copyAlpha</a> = (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o0">cmInputColorSpace</a> &amp; <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a43">cmAlphaSpace</a>) &amp;&amp; (calcParam.<a class="code" href="../../d7/d3/structCMCalcParam.html#o1">cmOutputColorSpace</a> &amp; <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a150a43">cmAlphaSpace</a>);
04551         }
04552 
04553         info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o10">inPlace</a> = info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a> &amp;&amp; info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>;
04554         calcRoutine = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a27">FindCalcRoutine</a>( &amp;calcParam, &amp;lutParam, &amp;info, modelingData-&gt;lookup );
04555         <span class="keywordflow">if</span> (calcRoutine == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>)
04556         {
04557                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a32">cmMethodError</a>;
04558                 <span class="keywordflow">goto</span> CleanupAndExit;
04559         }
04560         
04561         <span class="comment">/* ------------------------------------------------- 8 or 16 bit data --------------------------------------------------------- */</span>
04562         <span class="keywordflow">if</span> ((info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>))
04563         {
04564                 err = <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a4">CallCalcProc</a>(calcRoutine,&amp;calcParam, &amp;lutParam);
04565         }
04566         <span class="comment">/* ----------------------------------------------- input is 5 or 10 bit ------------------------------------------------------- */</span>
04567         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>))
04568         {
04569                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04570         }
04571         <span class="comment">/* ----------------------------------------------- output is 5 or 10 bit ------------------------------------------------------- */</span>
04572         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>) &amp;&amp; (info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a2">nil</a>))
04573         {
04574                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>);
04575         }
04576         <span class="comment">/* ------------------------------------------ input and output are 5 or 10 bit ------------------------------------------------- */</span>
04577         <span class="keywordflow">else</span>
04578         {
04579                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o4">tempInBuffer</a>);
04580                 <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)info.<a class="code" href="../../d9/d4/structColorSpaceInfo.html#o5">tempOutBuffer</a>);
04581         }
04582         
04583         <span class="keywordflow">if</span> (progressProcWasCalled)
04584                 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a1">CallCMBitmapCallBackProc</a> ( progressProc, 0, 0, (<span class="keywordtype">void</span> *)refCon );
04585 CleanupAndExit:
04586         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o2">inputLut</a>);
04587         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o10">colorLut</a>);
04588         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>((modelingData)-&gt;lutParam.<a class="code" href="../../d0/d4/structCMLutParam.html#o5">outputLut</a>);
04589                 
04590         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"LHMatchBitMapPlanePrivate"</span>)
04591         <span class="keywordflow">return</span> err;
04592 }
04593 
04594 <span class="preprocessor">#ifdef __MWERKS__</span>
04595 <span class="preprocessor"></span><span class="preprocessor">#pragma mark ================  Utilities for NamedColor ================</span>
04596 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
04597 <span class="preprocessor"></span>
04598 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04599 <span class="comment">OSErr ConvertNamedIndexToColors(        CMMModelPtr     modelingData,</span>
04600 <span class="comment">                                                                        CMColor         *theData, </span>
04601 <span class="comment">                                                                        SINT32          pixCnt )</span>
04602 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
<a name="l04603"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a37">04603</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a7">ConvertNamedIndexToColors</a>(        CMMModelPtr     modelingData,
04604                                                                         <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>         *theData, 
04605                                                                         SINT32          pixCnt )
04606 {
04607         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04608         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04609         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
04610         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,index;
04611         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04612         <span class="keywordtype">int</span>                             elemSz,deviceChannelCount,count;
04613 
04614         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"ConvertNamedIndexToColors"</span>)
04615         
04616         <span class="keywordflow">if</span> ( modelingData-&gt;hasNamedColorProf!=<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a16">NoNamedColorProfile</a>) 
04617         {
04618                 <span class="comment">/* prepare the tag table */</span>
04619                 tagH = modelingData-&gt;theNamedColorTagData;
04620                 <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) 
04621                 {
04622                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04623                         <span class="keywordflow">goto</span> CleanUp;
04624                 }
04625                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
04626                 
04627                 <span class="comment">/* tagTbl should now point to beginning of first device data */</span>
04628                 <span class="comment">/* = CMNamedColor2Type_header(84) + firstName(32) + PCSSize(3*2) */</span>
04629                 tagTbl = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 61;
04630                 
04631                 <span class="comment">/* find out how many bytes to skip per element. div'ed 2 for indexing purpose */</span>
04632                 count = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.count;
04633                 deviceChannelCount = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.nDeviceCoords;
04634                 <span class="keywordflow">if</span> (deviceChannelCount==3) 
04635                 {
04636                         elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04637                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4) 
04638                 {
04639                         elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04640                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0) 
04641                 {
04642                         elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04643                 } <span class="keywordflow">else</span> 
04644                 {
04645                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04646                         <span class="keywordflow">goto</span> CleanUp;
04647                 }
04648                 elemSz/=2;
04649                 
04650                 <span class="comment">/* doing the actual */</span>
04651                 <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)pixCnt; i++) 
04652                 {
04653                         <span class="comment">/* go to the index'th element*/</span>
04654                         index = theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o7">namedColor</a>.<a class="code" href="../../d7/d4/structPI__NAMEDCOLOR.html#o0">namedColorIndex</a>;
04655                         <span class="keywordflow">if</span> (index &gt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count || index == 0 ) 
04656                         {
04657                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
04658                                 <span class="keywordflow">goto</span> CleanUp;
04659                         }
04660                         colorPtr = tagTbl + (index-1)*elemSz;
04661                         <span class="comment">/* put in all the info */</span>
04662                         <span class="keywordflow">if</span> (deviceChannelCount==3) 
04663                         {
04664                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o1">rgb</a>.<a class="code" href="../../d8/d4/structPI__RGBCOLOR.html#o0">red</a> = *colorPtr++;
04665                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o1">rgb</a>.<a class="code" href="../../d8/d4/structPI__RGBCOLOR.html#o1">green</a> = *colorPtr++;
04666                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o1">rgb</a>.<a class="code" href="../../d8/d4/structPI__RGBCOLOR.html#o2">blue</a> = *colorPtr++;
04667                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount==4) 
04668                         {
04669                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o2">cmyk</a>.<a class="code" href="../../d2/d4/structPI__CMYKCOLOR.html#o0">cyan</a> = *colorPtr++;
04670                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o2">cmyk</a>.<a class="code" href="../../d2/d4/structPI__CMYKCOLOR.html#o1">magenta</a> = *colorPtr++;
04671                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o2">cmyk</a>.<a class="code" href="../../d2/d4/structPI__CMYKCOLOR.html#o2">yellow</a> = *colorPtr++;
04672                                 theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o2">cmyk</a>.<a class="code" href="../../d2/d4/structPI__CMYKCOLOR.html#o3">black</a> = *colorPtr++;
04673                         }
04674                         theData++;
04675                 }
04676                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
04677         }
04678 CleanUp:
04679         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"ConvertNamedIndexToColors"</span>)
04680         <span class="keywordflow">return</span> err;
04681 }
04682 
04683 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04684 <span class="comment">OSErr ConvertNamedIndexToPCS(   CMMModelPtr             cw,</span>
04685 <span class="comment">                                                                CMColor                 *theData, </span>
04686 <span class="comment">                                                                SINT32                  pixCnt )</span>
04687 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
<a name="l04688"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a38">04688</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a6">ConvertNamedIndexToPCS</a>(   CMMModelPtr             cw,
04689                                                                 <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>                 *theData, 
04690                                                                 SINT32                  pixCnt )
04691 {
04692         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04693         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04694         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
04695         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,index;
04696         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04697         <span class="keywordtype">int</span>                             elemSz,deviceChannelCount,count;
04698         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>             modelingData = (<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)cw;
04699 
04700         
04701         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"ConvertNamedIndexToPCS"</span>)
04702         <span class="keywordflow">if</span>( cw == 0 )<span class="keywordflow">return</span> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04703         {
04704                 <span class="comment">/* prepare the tag table */</span>
04705                         tagH = modelingData-&gt;theNamedColorTagData;
04706                 <span class="keywordflow">if</span> (tagH == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) 
04707                 {
04708                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04709                         <span class="keywordflow">goto</span> CleanUp;
04710                 }
04711                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
04712                 
04713                 <span class="comment">/* tagTbl should now point to beginning of first PCS data */</span>
04714                 <span class="comment">/* = CMNamedColor2Type_header(84) + firstName(32) */</span>
04715                 tagTbl = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 58;
04716                 
04717                 <span class="comment">/* find out how many bytes to skip per element. div'ed 2 for indexing purpose */</span>
04718                 count = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.count;
04719                 deviceChannelCount = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.nDeviceCoords;
04720                 <span class="keywordflow">if</span> (deviceChannelCount == 3) 
04721                 {
04722                         elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04723                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4) 
04724                 {
04725                         elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04726                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0) 
04727                 {
04728                         elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04729                 } <span class="keywordflow">else</span> 
04730                 {
04731                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04732                         <span class="keywordflow">goto</span> CleanUp;
04733                 }
04734                 elemSz /= 2;
04735                 
04736                 <span class="comment">/* doing the actual */</span>
04737                 <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)pixCnt; i++) 
04738                 {
04739                         <span class="comment">/* go to the index'th element*/</span>
04740                         index = theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o7">namedColor</a>.<a class="code" href="../../d7/d4/structPI__NAMEDCOLOR.html#o0">namedColorIndex</a>;
04741                         <span class="keywordflow">if</span> (index &gt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count || index == 0 ) 
04742                         {
04743                                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
04744                                 <span class="keywordflow">goto</span> CleanUp;
04745                         }
04746                         colorPtr = tagTbl + (index-1)*elemSz;
04747                         <span class="comment">/* put in all the info */</span>
04748                         theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o0">L</a> = *colorPtr++;
04749                         theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o1">a</a> = *colorPtr++;
04750                         theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o2">b</a> = *colorPtr++;
04751                         theData++;
04752                 }
04753                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
04754         }
04755 CleanUp:
04756         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"ConvertNamedIndexToPCS"</span>)
04757         <span class="keywordflow">return</span> err;
04758 }
04759 
04760 
04761 
<a name="l04762"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a6">04762</a> <span class="preprocessor">#define POS(x)  ((x) &gt; (0) ? (UINT32)(x) : (UINT32)(-(x)))</span>
04763 <span class="preprocessor"></span><span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04764 <span class="comment">OSErr ConvertPCSToNamedIndex(   CMMModelPtr     modelingData,</span>
04765 <span class="comment">                                                                CMColor         *theData, </span>
04766 <span class="comment">                                                                SINT32          pixCnt )</span>
04767 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
<a name="l04768"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a39">04768</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a8">ConvertPCSToNamedIndex</a>(   CMMModelPtr     modelingData,
04769                                                                 <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a>         *theData, 
04770                                                                 SINT32          pixCnt )
04771 {
04772         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04773         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04774         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
04775         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,j,index,dE,dEnow;
04776         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04777         <span class="keywordtype">int</span>                             elemSz,deviceChannelCount,count;
04778         
04779         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"ConvertPCSToNamedIndex"</span>)
04780         <span class="keywordflow">if</span> (modelingData-&gt;hasNamedColorProf == <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a19">NamedColorProfileAtEnd</a>) 
04781         {
04782                 <span class="comment">/* prepare the tag table */</span>
04783                 tagH = modelingData-&gt;theNamedColorTagData;
04784                 <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) 
04785                 {
04786                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04787                         <span class="keywordflow">goto</span> CleanUp;
04788                 }
04789                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
04790                 
04791                 <span class="comment">/* tagTbl should now point to beginning of first PCS data */</span>
04792                 <span class="comment">/* = CMNamedColor2Type_header(84) + firstName(32) */</span>
04793                 tagTbl = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 58;
04794                 
04795                 <span class="comment">/* find out how many bytes to skip per element. div'ed 2 for indexing purpose */</span>
04796                 count = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.count;
04797                 deviceChannelCount = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.nDeviceCoords;
04798                 <span class="keywordflow">if</span> (deviceChannelCount == 3) 
04799                 {
04800                         elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04801                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4) 
04802                 {
04803                         elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04804                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0) 
04805                 {
04806                         elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04807                 } <span class="keywordflow">else</span> 
04808                 {
04809                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04810                         <span class="keywordflow">goto</span> CleanUp;
04811                 }
04812                 elemSz/=2;
04813                 
04814                 <span class="comment">/* doing the actual */</span>
04815                 <span class="keywordflow">for</span> (i=0; i &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)pixCnt; i++) 
04816                 {
04817                         <span class="comment">/* go through the whole table to find the closest one*/</span>
04818                         dEnow = 0x40000;        <span class="comment">/* just arbitrarily high = 256*256*4 */</span>
04819                         index = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)-1;
04820                         colorPtr = tagTbl;
04821                         <span class="keywordflow">for</span> (j=0; j &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count; j++) 
04822                         {
04823                                 dE =      <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o1">a</a> - *(colorPtr+1));
04824                                 dE = dE + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o2">b</a> - *(colorPtr+2));
04825                                 dE = 2*dE + (dE&gt;&gt;1) + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o5">Lab</a>.<a class="code" href="../../d6/d4/structPI__LabCOLOR.html#o0">L</a> - *(colorPtr));
04826                                 <span class="keywordflow">if</span> (dE &lt; dEnow) 
04827                                 {
04828                                         index = j;
04829                                         dEnow = dE;
04830                                 }
04831                                 colorPtr += elemSz;
04832                         }
04833                         theData-&gt;<a class="code" href="../../d8/d3/unionCMColor.html#o7">namedColor</a>.<a class="code" href="../../d7/d4/structPI__NAMEDCOLOR.html#o0">namedColorIndex</a> = index+1;
04834                         theData++;
04835                 }
04836                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
04837         }
04838 CleanUp:
04839         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"ConvertPCSToNamedIndex"</span>)
04840         <span class="keywordflow">return</span> err;
04841 }
04842 
04843 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04844 <span class="comment">CMError CMConvertNamedIndexToColors(    CMWorldRef              cw,</span>
04845 <span class="comment">                                                                                CMColor                 *theData, </span>
04846 <span class="comment">                                                                                unsigned long   pixCnt )</span>
04847 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
04848 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a40">CMConvertNamedIndexToColors</a>( CMWorldRef cw, <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *theData, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pixCnt );
04849 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a40">CMConvertNamedIndexToColors</a>( CMWorldRef cw, <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *theData, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pixCnt )
04850 {
04851         <span class="keywordflow">return</span> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a7">ConvertNamedIndexToColors</a>( (CMMModelPtr)cw, theData, (SINT32)pixCnt );
04852 }
04853 <span class="comment">/*--------------------------------------------------------------------------------------------------------------</span>
04854 <span class="comment">CMError CMConvertNamedIndexToPCS(       CMWorldRef              cw,</span>
04855 <span class="comment">                                                                        CMColor                 *theData, </span>
04856 <span class="comment">                                                                        unsigned long   pixCnt )</span>
04857 <span class="comment">  --------------------------------------------------------------------------------------------------------------*/</span>
04858 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a41">CMConvertNamedIndexToPCS</a>( CMWorldRef cw, <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *theData, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pixCnt );
04859 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a41">CMConvertNamedIndexToPCS</a>( CMWorldRef cw, <a class="code" href="../../d8/d3/unionCMColor.html">CMColor</a> *theData, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pixCnt )
04860 {
04861         <span class="keywordflow">return</span> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a6">ConvertNamedIndexToPCS</a>( (CMMModelPtr)cw, theData, (SINT32)pixCnt );
04862 }
<a name="l04863"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a42">04863</a> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a9">ConvertLabToIndexBitmap</a>(        CMMModelPtr     modelingData,
04864                                                                         Ptr             InBuffer,
04865                                                                         UINT32          processedLinesIn,
04866                                                                         UINT32          inLineCount,
04867                                                                         UINT32          width,
04868                                                                         UINT32          rowBytes )
04869 {
04870         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
04871         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04872         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,*colorPtr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04873         <span class="keywordtype">int</span>                             deviceChannelCount,elemSz,count;
04874         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,j,k,index,dE,dEnow;
04875         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  LL,aa,bb;
04876         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>                   *imgIn=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,*imgOut=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04877         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  *imgInPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04878         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>                   *imgInPtr8=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04879         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>                   *imgOutPtr8=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04880         
04881         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"ConvertLabToIndexBitmap"</span>)
04882         <span class="comment">/* prepare the tag table  */</span>
04883         tagH = modelingData-&gt;theNamedColorTagData;
04884         <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>){
04885                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04886                 <span class="keywordflow">goto</span> CleanUp;
04887         }
04888         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
04889         tagTbl = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 58;
04890         count = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.count;
04891         deviceChannelCount = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.nDeviceCoords;
04892         <span class="keywordflow">if</span> (deviceChannelCount == 3){
04893                 elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04894         }
04895         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4){
04896                 elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04897         }
04898         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0){
04899                 elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
04900         }
04901         <span class="keywordflow">else</span>{
04902                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04903                 <span class="keywordflow">goto</span> CleanUp;
04904         }
04905         elemSz /= 2;
04906         
04907         <span class="comment">/* search for index */</span>
04908         imgIn = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)InBuffer + processedLinesIn * rowBytes;
04909         imgInPtr8=((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a> *)imgIn);
04910         LL = *(imgInPtr8+0)+1;  <span class="comment">/* do not use cache for first pixel */</span>
04911         <span class="keywordflow">for</span> (i = 0; i &lt; inLineCount; i++){
04912                 <span class="keywordflow">for</span> (j = 0; j &lt; width; j++){
04913                         imgInPtr8=((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a> *)imgIn+j*4);
04914                         <span class="keywordflow">if</span>( LL == *(imgInPtr8+0) ){
04915                                 <span class="keywordflow">if</span>( aa == *(imgInPtr8+1) &amp;&amp; bb == *(imgInPtr8+2) ){
04916                                         *((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> *)imgIn+j) = index+1;
04917                                         <span class="keywordflow">continue</span>;
04918                                 }
04919                         }
04920                         LL = *(imgInPtr8+0);
04921                         aa = *(imgInPtr8+1);
04922                         bb = *(imgInPtr8+2);
04923                         <span class="comment">/* go through the whole table to find the closest one*/</span>
04924                         dEnow = 0x40000;        <span class="comment">/* just arbitrarily high = 256*256*4 */</span>
04925                         index =(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)-1;
04926                         colorPtr = tagTbl;
04927                         <span class="keywordflow">for</span> (k = 0; k &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count; k++){
04928                                 dE =      <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)aa - (*(colorPtr+1)&gt;&gt;8));
04929                                 dE = dE + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)bb - (*(colorPtr+2)&gt;&gt;8));
04930                                 dE = 2*dE + (dE&gt;&gt;1) + <a class="code" href="../../d1/d4/lh__core_2runtime_8c.html#a6">POS</a>((<span class="keywordtype">long</span>)LL - (*(colorPtr)&gt;&gt;8));                 <span class="comment">/* Quantization L = 2.55 * (a|b) */</span>
04931                                 <span class="keywordflow">if</span> (dE &lt; dEnow){
04932                                         index = k;
04933                                         dEnow = dE;
04934                                 }
04935                                 colorPtr += elemSz;
04936                         }
04937                         *((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> *)imgIn+j) = index+1;
04938                 }
04939                 imgIn+=rowBytes;
04940         }
04941 CleanUp:
04942         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
04943         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"ConvertLabToIndexBitmap"</span>)
04944         <span class="keywordflow">return</span> err;
04945 }
<a name="l04946"></a><a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a43">04946</a> <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d4/d4/w98_2lh__core_2runtime_8h.html#a10">ConvertIndexToLabBitmap</a>(        CMMModelPtr     modelingData,
04947                                                                         Ptr                     InBuffer,
04948                                                                         Ptr                     OutBuffer,
04949                                                                         UINT32          processedLinesIn,
04950                                                                         UINT32          lineCount,
04951                                                                         UINT32          inWidth,
04952                                                                         UINT32          inRowBytes,
04953                                                                         UINT32          outRowBytes,
04954                                                                         UINT32          outputSize )
04955 {
04956         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
04957         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04958         <a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>                  *tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,*ColorPtr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04959         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  *imgIn=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04960         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>                   *imgOut=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04961         <span class="keywordtype">int</span>                             deviceChannelCount,elemSz;
04962         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,j,index,countNamesInProfile;
04963         
04964         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"ConvertIndexToLabBitmap"</span>)
04965         <span class="comment">/* set up the table for indexing */</span>
04966         tagH = modelingData-&gt;theNamedColorTagData;
04967         <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04968                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04969                 <span class="keywordflow">goto</span> CleanUp;
04970         }
04971         
04972         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
04973         tagTbl = (<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 58;               <span class="comment">/* points to PCS */</span>
04974         deviceChannelCount = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.nDeviceCoords;
04975         countNamesInProfile = ((<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH))-&gt;ncolor.count;
04976         <span class="keywordflow">if</span> (deviceChannelCount==3) {
04977                 elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>);
04978         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount==4) {
04979                 elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>);
04980         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount==0) {
04981                 elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d7/udf_8h.html#a24">UINT16</a>);
04982         } <span class="keywordflow">else</span> {
04983                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
04984                 <span class="keywordflow">goto</span> CleanUp;
04985         }
04986         elemSz/=2;
04987         
04988         <span class="comment">/* ...and convert the data from index to PCS values */</span>
04989         <span class="keywordflow">for</span>( i=processedLinesIn; i&lt;processedLinesIn+lineCount; i++ ){
04990                 imgIn = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a> *)(InBuffer + i * inRowBytes);
04991                 imgOut = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a6">UINT8</a>*)OutBuffer + (i-processedLinesIn) * outRowBytes;
04992                 <span class="keywordflow">if</span>( outputSize == 24 ){
04993                         <span class="keywordflow">for</span> (j=0;j&lt;inWidth;j++) {
04994                                 index = *imgIn++;
04995                                 <span class="keywordflow">if</span>( index == 0 || index &gt; countNamesInProfile ){
04996                                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
04997                                         <span class="keywordflow">goto</span> CleanUp;
04998                                 }
04999 
05000                                 ColorPtr = tagTbl + (index-1)*elemSz;
05001                                 *imgOut++  = (*ColorPtr++)&gt;&gt;8;
05002                                 *imgOut++  = (*ColorPtr++)&gt;&gt;8;
05003                                 *imgOut++  = (*ColorPtr++)&gt;&gt;8;
05004                         }
05005                 }
05006                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( outputSize == 32 ){
05007                         <span class="keywordflow">for</span> (j=0;j&lt;inWidth;j++) {
05008                                 index = *imgIn++;
05009                                 <span class="keywordflow">if</span>( index == 0 || index &gt; countNamesInProfile ){
05010                                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
05011                                         <span class="keywordflow">goto</span> CleanUp;
05012                                 }
05013 
05014                                 ColorPtr = tagTbl + (index-1)*elemSz;
05015                                 *imgOut++  = (*ColorPtr++)&gt;&gt;8;
05016                                 *imgOut++  = (*ColorPtr++)&gt;&gt;8;
05017                                 *imgOut    = (*ColorPtr++)&gt;&gt;8;
05018                                 imgOut += 2;
05019                         }
05020                 }
05021         }
05022 CleanUp:
05023         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
05024         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"ConvertIndexToLabBitmap"</span>)
05025         <span class="keywordflow">return</span> err;
05026 }
05027 
05028 <span class="preprocessor">#include &lt;string.h&gt;</span>
05029 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a44">CMConvNameToIndex</a>( <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *Data, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count );
05030 <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a> <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a44">CMConvNameToIndex</a>( <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *Data, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count )
05031 {       
05032         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>           err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05033         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>          i,index,l,len;
05034         <span class="keywordtype">char</span>            *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05035         <span class="keywordtype">long</span>            elemSz,deviceChannelCount,countNamesInProfile;
05036         <span class="keyword">const</span> <span class="keywordtype">char</span>      *aPtr;
05037         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                     tagTbl;
05038 
05039         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvNameToIndex"</span>)
05040         
05041         if( Data == 0 || count == 0 )return cmparamErr;
05042                 
05043         tagTbl = &amp;Data-&gt;ncolor.data[0];
05044         <span class="comment">/* find out how many bytes to skip per element. div'ed 2 for indexing purpose */</span>
05045         countNamesInProfile = Data-&gt;ncolor.count;
05046         deviceChannelCount = Data-&gt;ncolor.nDeviceCoords;
05047         if (deviceChannelCount==3){
05048                 elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05049         }
05050         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4){
05051                 elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05052         }
05053         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0){
05054                 elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05055         }
05056         <span class="keywordflow">else</span>{
05057                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
05058                 <span class="keywordflow">goto</span> CleanUp;
05059         }
05060         
05061         <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count; i++){
05062                 colorPtr = tagTbl;
05063                 len = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( Ptr2Name[i] );
05064                 aPtr = Ptr2Name[i];
05065                 <span class="keywordflow">for</span>( index = 0; index &lt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)countNamesInProfile; index++ ){
05066                         <span class="keywordflow">for</span>( l = 0; l&lt;len; l++ ){
05067                                 <span class="keywordflow">if</span>( colorPtr[l] != aPtr[l] )<span class="keywordflow">break</span>;
05068                                 <span class="keywordflow">if</span>( colorPtr[l] == 0 )<span class="keywordflow">break</span>;
05069                         }
05070                         <span class="keywordflow">if</span>( l &gt;= len )<span class="keywordflow">break</span>;
05071                         colorPtr += elemSz;
05072                 }
05073                 <span class="keywordflow">if</span>( l &lt; len )index = 0; <span class="comment">/* not found */</span>
05074                 <span class="keywordflow">else</span> index++;                   <span class="comment">/* Indices are 1 based */</span>
05075 
05076                 <span class="comment">/* put in all the info */</span>
05077                 <span class="keywordflow">if</span>( index == 0 ){
05078                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
05079                         <span class="keywordflow">goto</span> CleanUp;
05080                 }
05081                 Arr2Indices[i] = index;
05082         }
05083 CleanUp:
05084         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvNameToIndex"</span>)
05085         return err;
05086 }
05087 
05088 CMError CMConvNameToIndexCW( CMWorldRef *Storage, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count);
05089 CMError CMConvNameToIndexCW( CMWorldRef *Storage, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count)
05090 {       
05091         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                                     tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05092         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>           tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05093         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                         err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05094         <span class="keywordtype">char</span>                            *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05095         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>             modelingData;
05096         <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a>       *namedData;
05097 
05098         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvNameToIndexCW"</span>)
05099         
05100         if( Storage == 0 )return cmparamErr;
05101         LOCK_DATA( Storage );
05102         modelingData = (CMMModelPtr)(DATA_2_PTR(        Storage ));
05103         if ( modelingData-&gt;hasNamedColorProf!=NoNamedColorProfile) 
05104         {
05105                 <span class="comment">/* prepare the tag table */</span>
05106                 tagH = modelingData-&gt;theNamedColorTagData;
05107                 <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>){
05108                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
05109                         <span class="keywordflow">goto</span> CleanUp;
05110                 }
05111                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
05112                 
05113                 namedData = (<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH);
05114                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a44">CMConvNameToIndex</a>( namedData, Ptr2Name, Arr2Indices, count );
05115                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
05116         }
05117 CleanUp:
05118         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( Storage );
05119         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvNameToIndexCW"</span>)
05120         return err;
05121 }
05122 CMError CMConvNameToIndexProfile( CMProfileRef aProf, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count);
05123 CMError CMConvNameToIndexProfile( CMProfileRef aProf, pcCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count)
05124 {
05125         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                         err;
05126         <span class="keywordtype">short</span>                           aOSerr;
05127         <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a>       *aName = 0;
05128         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           byteCount;
05129 
05130         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvNameToIndexProfile"</span>)
05131         
05132         if( aProf == 0 )return cmparamErr;
05133         err = CMGetPartialProfileElement(       aProf,
05134                                                                                 icSigNamedColor2Tag,
05135                                                                                 0,
05136                                                                                 &amp;byteCount,
05137                                                                                 0 );
05138         if (err)
05139                 goto CleanupAndExit;
05140     aName = (<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)SmartNewPtr( byteCount, &amp;aOSerr );
05141         err = aOSerr;
05142         if (err)
05143                 goto CleanupAndExit;
05144         err = CMGetPartialProfileElement(       aProf,
05145                                                                                 icSigNamedColor2Tag,
05146                                                                                 0,
05147                                                                                 &amp;byteCount,
05148                                                                                 (Ptr)aName );
05149         if (err){
05150                 <span class="keywordflow">goto</span> CleanupAndExit;
05151         }
05152 
05153 <span class="preprocessor">#ifdef IntelMode</span>
05154 <span class="preprocessor"></span>        SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o1">count</a>, 0, 4 );
05155         SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o2">nDeviceCoords</a>, 0, 4 );
05156 <span class="preprocessor">#endif</span>
05157 <span class="preprocessor"></span>        err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a44">CMConvNameToIndex</a>( aName, Ptr2Name, Arr2Indices, count );
05158 
05159 CleanupAndExit:
05160         <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr)aName );
05161         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvNameToIndexProfile"</span>)
05162         return err;
05163 }
05164 
05165 CMError CMConvIndexToName( <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *Data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count);
05166 CMError CMConvIndexToName( <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *Data, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count)
05167 {       
05168         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                             tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05169         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05170         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  i,index;
05171         <span class="keywordtype">char</span>                    *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05172         <span class="keywordtype">long</span>                    elemSz,deviceChannelCount,countNamesInProfile;
05173 
05174         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvIndexToName"</span>)
05175         
05176         if( Data == 0 || count == 0 )return cmparamErr;
05177         tagTbl = &amp;Data-&gt;ncolor.data[0];
05178                 
05179         <span class="comment">/* find out how many bytes to skip per element. div'ed 2 for indexing purpose */</span>
05180         countNamesInProfile = Data-&gt;ncolor.count;
05181         deviceChannelCount = Data-&gt;ncolor.nDeviceCoords;
05182         if (deviceChannelCount==3){
05183                 elemSz = 32+(3+3)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05184         }
05185         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 4){
05186                 elemSz = 32+(3+4)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05187         } 
05188         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deviceChannelCount == 0){
05189                 elemSz = 32+(3+0)*<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a13">SINT16</a>);
05190         }
05191         <span class="keywordflow">else</span>{
05192                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
05193                 <span class="keywordflow">goto</span> CleanUp;
05194         }
05195         
05196         <span class="comment">/* doing the actual */</span>
05197         <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)count; i++){
05198                 <span class="comment">/* go to the index'th element*/</span>
05199                 index = Arr2Indices[i];
05200                 <span class="keywordflow">if</span> (index &gt; (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>)countNamesInProfile || index == 0 ) 
05201                 {
05202                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a37">cmNamedColorNotFound</a>;
05203                         <span class="keywordflow">goto</span> CleanUp;
05204                 }
05205                 colorPtr = tagTbl + (index-1)*elemSz;
05206                 <span class="comment">/* put in all the info */</span>
05207                 strcpy( Ptr2Name[i], colorPtr );
05208         }
05209 
05210 CleanUp:
05211         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvIndexToName"</span>)
05212         return err;
05213 }
05214 
05215 CMError CMConvIndexToNameCW( CMWorldRef *Storage, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count);
05216 CMError CMConvIndexToNameCW( CMWorldRef *Storage, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count)
05217 {       
05218         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                                     tagTbl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05219         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>           tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05220         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                         err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05221         <span class="keywordtype">char</span>                            *colorPtr=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05222         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>             modelingData;
05223         <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a>       *namedData;
05224 
05225         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvIndexToNameCW"</span>)
05226         
05227         if( Storage == 0 )return cmparamErr;
05228         LOCK_DATA( Storage );
05229         modelingData = (CMMModelPtr)(DATA_2_PTR(        Storage ));
05230         if ( modelingData-&gt;hasNamedColorProf!=NoNamedColorProfile) 
05231         {
05232                 <span class="comment">/* prepare the tag table */</span>
05233                 tagH = modelingData-&gt;theNamedColorTagData ;
05234                 <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>){
05235                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
05236                         <span class="keywordflow">goto</span> CleanUp;
05237                 }
05238                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
05239                 
05240                 namedData = (<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH);
05241                 err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a47">CMConvIndexToName</a>( namedData, Arr2Indices, Ptr2Name, count );
05242                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
05243         }
05244 CleanUp:
05245         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( Storage );
05246         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvIndexToNameCW"</span>)
05247         return err;
05248 }
05249 CMError CMConvIndexToNameProfile( CMProfileRef aProf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count);
05250 CMError CMConvIndexToNameProfile( CMProfileRef aProf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *Arr2Indices, pCMColorName Ptr2Name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count)
05251 {
05252         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                         err;
05253         <span class="keywordtype">short</span>                           aOSerr;
05254         <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a>       *aName = 0;
05255         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           byteCount;
05256 
05257         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMConvIndexToNameProfile"</span>)
05258         
05259         if( aProf == 0 )return cmparamErr;
05260         err = CMGetPartialProfileElement(       aProf,
05261                                                                                 icSigNamedColor2Tag,
05262                                                                                 0,
05263                                                                                 &amp;byteCount,
05264                                                                                 0 );
05265         if (err)
05266                 goto CleanupAndExit;
05267     aName = (<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)SmartNewPtr( byteCount, &amp;aOSerr );
05268         err = aOSerr;
05269         if (err)
05270                 goto CleanupAndExit;
05271         err = CMGetPartialProfileElement(       aProf,
05272                                                                                 icSigNamedColor2Tag,
05273                                                                                 0,
05274                                                                                 &amp;byteCount,
05275                                                                                 (Ptr)aName );
05276         if (err){
05277                 <span class="keywordflow">goto</span> CleanupAndExit;
05278         }
05279 
05280 <span class="preprocessor">#ifdef IntelMode</span>
05281 <span class="preprocessor"></span>        SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o1">count</a>, 0, 4 );
05282         SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o2">nDeviceCoords</a>, 0, 4 );
05283 <span class="preprocessor">#endif</span>
05284 <span class="preprocessor"></span>        err = <a class="code" href="../../d2/d4/w98_2lh__core_2runtime_8c.html#a47">CMConvIndexToName</a>( aName, Arr2Indices, Ptr2Name, count );
05285 
05286 CleanupAndExit:
05287         <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr)aName );
05288         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMConvIndexToNameProfile"</span>)
05289         return err;
05290 }
05291 
05292 CMError CMGetNamedProfileInfoProfile( CMProfileRef aProf, <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">pCMNamedProfileInfo</a> Info );
05293 CMError CMGetNamedProfileInfoProfile( CMProfileRef aProf, <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">pCMNamedProfileInfo</a> Info )
05294 {       
05295         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                         err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05296         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                                     tagTbl;
05297         <span class="keywordtype">short</span>                           aOSerr;
05298         <a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a>       *aName = 0;
05299         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           byteCount;
05300 
05301         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMGetNamedProfileInfoProfile"</span>)
05302         
05303         if( aProf == 0 )return cmparamErr;
05304         err = CMGetPartialProfileElement(       aProf,
05305                                                                                 icSigNamedColor2Tag,
05306                                                                                 0,
05307                                                                                 &amp;byteCount,
05308                                                                                 0 );
05309         if (err)
05310                 goto CleanupAndExit;
05311     aName = (<a class="code" href="../../d4/d3/structicNamedColor2Type.html">icNamedColor2Type</a> *)SmartNewPtr( byteCount, &amp;aOSerr );
05312         err = aOSerr;
05313         if (err)
05314                 goto CleanupAndExit;
05315         err = CMGetPartialProfileElement(       aProf,
05316                                                                                 icSigNamedColor2Tag,
05317                                                                                 0,
05318                                                                                 &amp;byteCount,
05319                                                                                 (Ptr)aName );
05320         if (err){
05321                 <span class="keywordflow">goto</span> CleanupAndExit;
05322         }
05323 
05324         
05325         <span class="comment">/* = CMNamedColor2Type_header(84) + firstName(32) + PCSSize(3*2) */</span>
05326         tagTbl = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)aName + 8;
05327         
05328 <span class="preprocessor">#ifdef IntelMode</span>
05329 <span class="preprocessor"></span>        SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o1">count</a>, 0, 4 );
05330         SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o2">nDeviceCoords</a>, 0, 4 );
05331         SwapLongOffset( &amp;aName-&gt;<a class="code" href="../../d4/d3/structicNamedColor2Type.html#o1">ncolor</a>.<a class="code" href="../../d3/d3/structicNamedColor2.html#o0">vendorFlag</a>, 0, 4 );
05332 <span class="preprocessor">#endif</span>
05333 <span class="preprocessor"></span>        memcpy( Info, tagTbl, <span class="keyword">sizeof</span>( <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">CMNamedProfileInfo</a> ));
05334 CleanupAndExit:
05335         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMGetNamedProfileInfoProfile"</span>)
05336         return err;
05337 }
05338 CMError CMGetNamedProfileInfoCW( CMWorldRef *Storage, <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">pCMNamedProfileInfo</a> Info );
05339 CMError CMGetNamedProfileInfoCW( CMWorldRef *Storage, <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">pCMNamedProfileInfo</a> Info )
05340 {       
05341         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a1">LUT_DATA_TYPE</a>   tagH = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
05342         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
05343         <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>     modelingData;
05344         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                             tagTbl;
05345 
05346         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a1">LH_START_PROC</a>(<span class="stringliteral">"CMGetNamedProfileInfoCW"</span>)
05347         
05348         if( Storage == 0 )return cmparamErr;
05349         LOCK_DATA( Storage );
05350         modelingData = (CMMModelPtr)(DATA_2_PTR(        Storage ));
05351         if( modelingData-&gt;hasNamedColorProf != NoNamedColorProfile ){
05352                 <span class="comment">/* prepare the tag table */</span>
05353                 tagH = modelingData-&gt;theNamedColorTagData;
05354                 <span class="keywordflow">if</span> (tagH==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>){
05355                         err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a30">cmparamErr</a>;
05356                         <span class="keywordflow">goto</span> CleanUp;
05357                 }
05358                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a6">LOCK_DATA</a>(tagH);
05359                 
05360                 <span class="comment">/* tagTbl should now point to beginning of first device data */</span>
05361                 <span class="comment">/* = CMNamedColor2Type_header(84) + firstName(32) + PCSSize(3*2) */</span>
05362                 tagTbl = (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)<a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a3">DATA_2_PTR</a>(tagH) + 8;
05363                 
05364                 memcpy( Info, tagTbl, <span class="keyword">sizeof</span>( <a class="code" href="../../d9/d0/structtagCMNamedProfileInfo.html">CMNamedProfileInfo</a> ));
05365                 <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>(tagH);
05366         }
05367 CleanUp:
05368         <a class="code" href="../../d5/d6/lh__core_2defines_8h.html#a7">UNLOCK_DATA</a>( Storage );
05369         <a class="code" href="../../d6/d9/lh__open_2general_8h.html#a2">LH_END_PROC</a>(<span class="stringliteral">"CMGetNamedProfileInfoCW"</span>)
05370         return err;
05371 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:42 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
