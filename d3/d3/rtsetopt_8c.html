<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtsetopt.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>rtsetopt.c File Reference</h1><code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>

<p>
<a href="../../d4/d2/rtsetopt_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a0">WORK_SIZE</a>&nbsp;&nbsp;&nbsp;1024</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a11">main</a> (int, char **)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a12">processargs</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a13">processargs</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a1">failure</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a2">KeyPath</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a3">TestData</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a4">WorkName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a5">workbuffer</a> [2 *CM_MAX_STASH]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a> [] = { 0, 3, 4, 5, -1 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a7">testvector1</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a8">testvector2</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a9">testvector3</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/rtsetopt_8c.html#a10">supervector</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="rtsetopt.c::WORK_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORK_SIZE&nbsp;&nbsp;&nbsp;1024          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00041">41</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a11" doxytag="rtsetopt.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00073">73</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.
<p>
References <a class="el" href="../../d2/d1/cmp_8h-source.html#l00428">CM_MAX_STASH</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00056">failure</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00058">KeyPath</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00504">NtDeleteValueKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02187">NtQueryValueKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/rtbatcr_8c.html#a13">processargs()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00196">RtlCopyString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00068">supervector</a>, <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00050">TestData</a>, <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00056">testvector0</a>, <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00051">WORK_SIZE</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00068">workbuffer</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00067">WorkName</a>.
<p>
<pre class="fragment"><div>00077 {
00078     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00079     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00080     HANDLE          BaseHandle;
00081     UNICODE_STRING  <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>;
00082     ULONG   ResultLength;
00083     PKEY_VALUE_FULL_INFORMATION pvaluefull;
00084     PKEY_VALUE_PARTIAL_INFORMATION pvaluepart;
00085     ULONG   i;
00086     ULONG  index;
00087     LONG    testsize;
00088     PUCHAR  p;
00089     PLONG   activevector;
00090 
00091 
00092     <span class="keywordflow">for</span> (i = 0; i &lt; 2 * <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>; i++) {
00093         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[i] = <span class="charliteral">'e'</span>;
00094     }
00095 
00096     <span class="comment">//</span>
00097     <span class="comment">// Process args</span>
00098     <span class="comment">//</span>
00099     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a13">processargs</a>(argc, argv);
00100 
00101 
00102     <span class="comment">//</span>
00103     <span class="comment">// Open the specified keypath, punt on failure</span>
00104     <span class="comment">//</span>
00105     printf(<span class="stringliteral">"rtsetopt: starting\n"</span>);
00106 
00107     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.MaximumLength = <a class="code" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>;
00108     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Length = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00109     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Buffer = &amp;(<a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[0]);
00110 
00111     <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a>((PSTRING)&amp;WorkName, (PSTRING)&amp;KeyPath);
00112 
00113     InitializeObjectAttributes(
00114         &amp;ObjectAttributes,
00115         &amp;WorkName,
00116         0,
00117         (HANDLE)NULL,
00118         NULL
00119         );
00120     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00121 
00122     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a23">NtOpenKey</a>(
00123                 &amp;BaseHandle,
00124                 MAXIMUM_ALLOWED,
00125                 &amp;ObjectAttributes
00126                 );
00127     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00128         printf(<span class="stringliteral">"line_%4d: abort %08lx\n"</span>, __LINE__,  status);
00129         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00130         <span class="keywordflow">goto</span> punt;
00131     }
00132 
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">// Perform new value entry tests, with an empty list.</span>
00136     <span class="comment">//</span>
00137     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00138         &amp;ValueName,
00139         L<span class="stringliteral">"NewValueTest1"</span>
00140         );
00141 
00142     <span class="keywordflow">for</span> (index = 0; <a class="code" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[index] != -1; index++) {
00143 
00144         testsize = <a class="code" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[index];
00145 
00146         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00147 
00148         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00149                     BaseHandle,
00150                     &amp;ValueName,
00151                     1,
00152                     REG_BINARY,
00153                     &amp;(TestData[0]),
00154                     testsize
00155                     );
00156         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00157             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00158             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00159         }
00160 
00161         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00162         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>; i++) <a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[i] = <span class="charliteral">'?'</span>;
00163         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a25">NtQueryValueKey</a>(
00164                     BaseHandle,
00165                     &amp;ValueName,
00166                     KeyValueFullInformation,
00167                     &amp;(workbuffer[0]),
00168                     WORK_SIZE,
00169                     &amp;ResultLength
00170                     );
00171         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00172             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00173             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00174         }
00175 
00176         pvaluefull = (PKEY_VALUE_FULL_INFORMATION)(&amp;(<a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[0]));
00177         <span class="keywordflow">if</span> (pvaluefull-&gt;DataLength != testsize) {
00178             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  9999);
00179             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00180         }
00181 
00182 
00183         <span class="keywordflow">if</span> (testsize &gt; 0) {
00184             p = (PUCHAR)pvaluefull;
00185             p = p+pvaluefull-&gt;DataOffset;
00186             <span class="keywordflow">if</span> (p[2] != <span class="charliteral">'i'</span>) {
00187                 printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  9999);
00188                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00189             }
00190         }
00191 
00192         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00193         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[index+1] != -1) {
00194             status = <a class="code" href="../../d7/d7/ntapi_8c.html#a16">NtDeleteValueKey</a>(
00195                         BaseHandle,
00196                         &amp;ValueName
00197                         );
00198             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00199                 printf(<span class="stringliteral">"line_%4d: abort %08lx\n"</span>, __LINE__,  status);
00200                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00201                 <span class="keywordflow">goto</span> punt;
00202             }
00203         }
00204     }
00205 
00206     <span class="comment">//</span>
00207     <span class="comment">// Perform new value entry tests, with a non empty list.</span>
00208     <span class="comment">//</span>
00209     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00210         &amp;ValueName,
00211         L<span class="stringliteral">"NewValueTest2"</span>
00212         );
00213 
00214     <span class="keywordflow">for</span> (index = 0; <a class="code" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[index] != -1; index++) {
00215 
00216         testsize = <a class="code" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[index];
00217 
00218         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00219         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00220                     BaseHandle,
00221                     &amp;ValueName,
00222                     1,
00223                     REG_BINARY,
00224                     &amp;(TestData[0]),
00225                     testsize
00226                     );
00227         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00228             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00229             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00230         }
00231 
00232         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00233         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>; i++) <a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[i] = <span class="charliteral">'?'</span>;
00234         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a25">NtQueryValueKey</a>(
00235                     BaseHandle,
00236                     &amp;ValueName,
00237                     KeyValuePartialInformation,
00238                     &amp;(workbuffer[0]),
00239                     WORK_SIZE,
00240                     &amp;ResultLength
00241                     );
00242         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00243             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00244             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00245         }
00246 
00247         pvaluepart = (PKEY_VALUE_PARTIAL_INFORMATION)(&amp;(<a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[0]));
00248         <span class="keywordflow">if</span> (pvaluepart-&gt;DataLength != testsize) {
00249             printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  9999);
00250             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00251         }
00252 
00253 
00254         <span class="keywordflow">if</span> (testsize &gt; 0) {
00255             <span class="keywordflow">if</span> (pvaluepart-&gt;Data[2] != <span class="charliteral">'i'</span>) {
00256                 printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  9999);
00257                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00258             }
00259         }
00260 
00261         printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00262         status = <a class="code" href="../../d7/d7/ntapi_8c.html#a16">NtDeleteValueKey</a>(
00263                     BaseHandle,
00264                     &amp;ValueName
00265                     );
00266         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00267             printf(<span class="stringliteral">"line_%4d: abort %08lx\n"</span>, __LINE__,  status);
00268             <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00269             <span class="keywordflow">goto</span> punt;
00270         }
00271    }
00272 
00273 
00274     <span class="comment">//</span>
00275     <span class="comment">// Perform existing value entry tests, with all the relevent</span>
00276     <span class="comment">// size transitions.</span>
00277     <span class="comment">//</span>
00278     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
00279         &amp;ValueName,
00280         L<span class="stringliteral">"NewValueTest3"</span>
00281         );
00282 
00283     <span class="keywordflow">for</span> (i = 0; i &lt; 2 * <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>; i++) {
00284         <a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[i] = <span class="charliteral">'e'</span>;
00285     }
00286 
00287     <span class="keywordflow">for</span> (i = 0; <a class="code" href="../../d3/d3/rtsetopt_8c.html#a10">supervector</a>[i] != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; i++) {
00288 
00289         activevector = <a class="code" href="../../d3/d3/rtsetopt_8c.html#a10">supervector</a>[i];
00290 
00291         <span class="keywordflow">for</span> (index = 0; activevector[index] != -1; index++) {
00292 
00293             testsize = activevector[index];
00294 
00295             printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00296             status = <a class="code" href="../../d7/d7/ntapi_8c.html#a29">NtSetValueKey</a>(
00297                         BaseHandle,
00298                         &amp;ValueName,
00299                         1,
00300                         REG_BINARY,
00301                         &amp;(workbuffer[0]),
00302                         testsize
00303                         );
00304             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00305                 printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00306                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00307             }
00308 
00309             printf(<span class="stringliteral">"AT line_%4d: %d\n"</span>, __LINE__,  testsize);
00310             status = <a class="code" href="../../d7/d7/ntapi_8c.html#a25">NtQueryValueKey</a>(
00311                         BaseHandle,
00312                         &amp;ValueName,
00313                         KeyValuePartialInformation,
00314                         &amp;(workbuffer[0]),
00315                         2 * CM_MAX_STASH,
00316                         &amp;ResultLength
00317                         );
00318             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00319                 printf(<span class="stringliteral">"line_%4d: %08lx\n"</span>, __LINE__,  status);
00320                 <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>++;
00321             }
00322         }
00323     }
00324 
00325 
00326 punt:
00327     printf(<span class="stringliteral">"rtsetopt: %d failures\n"</span>, failure);
00328     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(failure);
00329 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="rtsetopt.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00333">333</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00058">KeyPath</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00337 {
00338     ANSI_STRING temp;
00339 
00340     <span class="keywordflow">if</span> (argc != 2)
00341     {
00342         printf(<span class="stringliteral">"Usage: %s &lt;KeyPath&gt;\n"</span>, argv[0]);
00343         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00344     }
00345 
00346     <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(
00347         &amp;temp,
00348         argv[1]
00349         );
00350 
00351     <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
00352         &amp;KeyPath,
00353         &amp;temp,
00354         TRUE
00355         );
00356 
00357     <span class="keywordflow">return</span>;
00358 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="rtsetopt.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a1" doxytag="rtsetopt.c::failure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a1">failure</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00046">46</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="rtsetopt.c::KeyPath" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a2">KeyPath</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00048">48</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="rtsetopt.c::supervector" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PLONG <a class="el" href="../../d3/d3/rtsetopt_8c.html#a10">supervector</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { &amp;(<a class="code" href="../../d3/d3/rtsetopt_8c.html#a7">testvector1</a>[0]), &amp;(<a class="code" href="../../d3/d3/rtsetopt_8c.html#a8">testvector2</a>[1]),
                          &amp;(<a class="code" href="../../d3/d3/rtsetopt_8c.html#a9">testvector3</a>[0]), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00068">68</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00073">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="rtsetopt.c::TestData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d3/d3/rtsetopt_8c.html#a3">TestData</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div>
<span class="stringliteral">"This is some test data, it is short. But long enough for most of our tests."</span>
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00050">50</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00073">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="rtsetopt.c::testvector0" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d3/d3/rtsetopt_8c.html#a6">testvector0</a>[] = { 0, 3, 4, 5, -1 }          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00056">56</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00073">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="rtsetopt.c::testvector1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d3/d3/rtsetopt_8c.html#a7">testvector1</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { 0, 0, 3, 0, 4, 0, 5, 0, 3, 3, 4, 3, 5, 3,
                          4, 4, 5, 4, 5, 5, -1 }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00058">58</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="rtsetopt.c::testvector2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d3/d3/rtsetopt_8c.html#a8">testvector2</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { 8, 6, 8, 32,
                          <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>-1, <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>+1,
                          -1 }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00061">61</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="rtsetopt.c::testvector3" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d3/d3/rtsetopt_8c.html#a9">testvector3</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>, <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>-1, <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>,
                          <a class="code" href="../../d1/d2/cmp_8h.html#a70">CM_MAX_STASH</a>+1, -1 }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00065">65</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="rtsetopt.c::workbuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a10">workbuffer</a>[2 *CM_MAX_STASH]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00054">54</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="rtsetopt.c::WorkName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a9">WorkName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/rtsetopt_8c-source.html#l00053">53</a> of file <a class="el" href="../../d4/d2/rtsetopt_8c-source.html">rtsetopt.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:30 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
