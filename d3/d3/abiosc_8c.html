<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: abiosc.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>abiosc.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>
<code>#include "<a class="el" href="../../d3/d2/abios_8h-source.html">abios.h</a>"</code><br>

<p>
<a href="../../d4/d2/abiosc_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a9">KiInitializeAbiosGdtEntry</a> (OUT PKGDTENTRY GdtEntry, IN ULONG Base, IN ULONG Limit, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Type)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a10">KiI386SelectorBase</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a11">KeI386GetLid</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> DeviceId, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> RelativeLid, IN BOOLEAN SharedLid, IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject, OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> LogicalId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a12">KeI386ReleaseLid</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> LogicalId, IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a13">KeI386AbiosCall</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> LogicalId, IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject, IN PUCHAR RequestBlock, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> EntryPoint)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a14">KeI386AllocateGdtSelectors</a> (OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> SelectorArray, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> NumberOfSelectors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a15">KeI386ReleaseGdtSelectors</a> (OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> SelectorArray, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> NumberOfSelectors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a16">KeI386FlatToGdtSelector</a> (IN ULONG SelectorBase, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Length, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a17">Ki386InitializeGdtFreeList</a> (<a class="el" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> EndOfGdt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a18">KiInitializeAbios</a> (IN UCHAR Processor)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d5/d5/struct__KCOMMON__DATA__AREA.html">PKCOMMON_DATA_AREA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = 0L</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html">PKLID_TABLE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a> [MAXIMUM_PROCESSORS]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a6">KiAbiosGdtLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a7">KiAbiosLidTableLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d3/abiosc_8c.html#a8">KiStack16GdtEntry</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a13" doxytag="abiosc.c::KeI386AbiosCall" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386AbiosCall           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>RequestBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>EntryPoint</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00367">367</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00048">_KFUNCTION_TRANSFER_TABLE::CommonRoutine</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00030">KiCommonDataArea</a>, <a class="el" href="../../d2/d3/abios_8h.html#a27">KiI386CallAbios()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00133">KiI386SelectorBase()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00056">KiLogicalIdTable</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00100">LID_NO_SPECIFIC_OWNER</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00066">_KCOMMON_DATA_AREA::NumberLids</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00037">_KABIOS_POINTER::Offset</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00096">_KLID_TABLE_ENTRY::Owner</a>, and <a class="el" href="../../d3/d2/abios_8h-source.html#l00038">_KABIOS_POINTER::Selector</a>.
<p>
<pre class="fragment"><div>00376                    :
00377 
00378     This function calls an ABIOS service routine on behave of device driver
00379     <span class="keyword">using</span> Operating System Transfer Convension.
00380 
00381 Arguments:
00382 
00383     LogicalId - Logical Id <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call.
00384 
00385     DriverObject - Supplies a 32-bit flat pointer of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requesting device
00386                 driver's driver object.  The DriverObject <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to verify
00387                 <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ownership of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired LID.
00388 
00389     RequestBlock - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> 16:16 (selector:offset) pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request block.
00390 
00391     EntryPoint - Specifies which ABIOS entry point:
00392 
00393                  0 - <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> Routine
00394                  1 - Interrupt Routine
00395                  2 - Timeout Routine
00396 
00397 Return Value:
00398 
00399     STATUS_SUCCESS - If no error.
00400 
00401     STATUS_ABIOS_NOT_PRESENT - If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no ABIOS support in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
00402 
00403     STATUS_ABIOS_INVALID_COMMAND - <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry point <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not supported.
00404 
00405     STATUS_ABIOS_INVALID_LID - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Lid specified <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invalid.
00406 
00407     STATUS_ABIOS_NOT_LID_OWNER - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller does not own <span class="keyword">this</span> Lid.
00408 
00409     (Note that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request specific ABIOS returned code <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in RequestBlock.)
00410 
00411 --*/
00412 
00413 {
00414 
00415     <a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html">KABIOS_POINTER</a> FuncTransferTable;
00416     <a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html">KABIOS_POINTER</a> DeviceBlock;
00417     <a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html">KABIOS_POINTER</a> AbiosFunction;
00418     <a class="code" href="../../d9/d6/struct__KFUNCTION__TRANSFER__TABLE.html">PKFUNCTION_TRANSFER_TABLE</a> FttPointer;
00419 
00420     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>) {
00421         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_PRESENT;
00422     }
00423 
00424     <span class="keywordflow">if</span> (LogicalId &gt;= <a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a>-&gt;<a class="code" href="../../d5/d5/struct__KCOMMON__DATA__AREA.html#o1">NumberLids</a>) {
00425         <span class="keywordflow">return</span> STATUS_ABIOS_INVALID_LID;
00426     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> != (ULONG)DriverObject &amp;&amp;
00427                <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> != <a class="code" href="../../d2/d3/abios_8h.html#a0">LID_NO_SPECIFIC_OWNER</a>) {
00428         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_LID_OWNER;
00429     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EntryPoint &gt; 2) {
00430         <span class="keywordflow">return</span> STATUS_ABIOS_INVALID_COMMAND;
00431     }
00432 
00433     FuncTransferTable = ((<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html">PKDB_FTT_SECTION</a>)<a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a> + LogicalId)-&gt;
00434                                                FunctionTransferTable;
00435     DeviceBlock = ((<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html">PKDB_FTT_SECTION</a>)<a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a> + LogicalId)-&gt;DeviceBlock;
00436     FttPointer = (<a class="code" href="../../d9/d6/struct__KFUNCTION__TRANSFER__TABLE.html">PKFUNCTION_TRANSFER_TABLE</a>)(<a class="code" href="../../d3/d3/abiosc_8c.html#a10">KiI386SelectorBase</a>(FuncTransferTable.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o1">Selector</a>) +
00437                                              (ULONG)FuncTransferTable.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o0">Offset</a>);
00438     AbiosFunction = FttPointer-&gt;<a class="code" href="../../d9/d6/struct__KFUNCTION__TRANSFER__TABLE.html#o0">CommonRoutine</a>[EntryPoint];
00439     <a class="code" href="../../d2/d3/abios_8h.html#a27">KiI386CallAbios</a>(AbiosFunction,
00440                     DeviceBlock,
00441                     FuncTransferTable,
00442                     *(<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html">PKABIOS_POINTER</a>)&amp;RequestBlock
00443                     );
00444 
00445     <span class="keywordflow">return</span> STATUS_SUCCESS;
00446 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="abiosc.c::KeI386AllocateGdtSelectors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386AllocateGdtSelectors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorArray</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfSelectors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">449</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00078">_KFREE_GDT_ENTRY::Flink</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">KiFreeGdtListHead</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">KiNumberFreeSelectors</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00456                    :
00457 
00458     This function allocates a set of GDT selectors <span class="keywordflow">for</span> a device driver to use.
00459     Usually <span class="keyword">this</span> allocation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed at device driver initialization time
00460     to reserve <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selectors <span class="keywordflow">for</span> later use.
00461 
00462 Arguments:
00463 
00464     SelectorArray - Supplies a pointer to an array of <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> to be filled
00465                     in with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> GDT selectors allocated.
00466 
00467     NumberOfSelectors - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of selectors to be allocated.
00468 
00469 Return Value:
00470 
00471     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested selectors are allocated.
00472 
00473     STATUS_ABIOS_SELECTOR_NOT_AVAILABLE - <span class="keywordflow">if</span> systen can not allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number
00474                                of selectors requested.
00475 
00476 --*/
00477 
00478 {
00479     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> GdtEntry;
00480     KIRQL OldIrql;
00481 
00482     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> &gt;= NumberOfSelectors) {
00483         ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00484 
00485         <span class="comment">//</span>
00486         <span class="comment">// The Free Gdt link list is maintained on Processor 0's GDT ONLY.</span>
00487         <span class="comment">// Because the 'selector' is an offset to the beginning of GDT and</span>
00488         <span class="comment">// it should be the same accross all the processors.</span>
00489         <span class="comment">//</span>
00490 
00491         <a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> -= NumberOfSelectors;
00492         GdtEntry = <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a>;
00493         <span class="keywordflow">while</span> (NumberOfSelectors != 0) {
00494             *SelectorArray++ = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)((ULONG)GdtEntry - <a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0]);
00495             GdtEntry = GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o0">Flink</a>;
00496             NumberOfSelectors--;
00497         }
00498         <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = GdtEntry;
00499         ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00500         <span class="keywordflow">return</span> STATUS_SUCCESS;
00501     } <span class="keywordflow">else</span> {
00502         <span class="keywordflow">return</span> STATUS_ABIOS_SELECTOR_NOT_AVAILABLE;
00503     }
00504 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="abiosc.c::KeI386FlatToGdtSelector" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386FlatToGdtSelector           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">558</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00107">HIGHBYTE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00113">LOWBYTE</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00129">RESERVED_GDT_ENTRIES</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00566                    :
00567 
00568     This function converts a 32-bit flat address to a GDT selector-offset
00569     pair.  The segment set up <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> always 16-bit ring 0 data segment.
00570 
00571 Arguments:
00572 
00573     SelectorBase - Supplies 32 bit flat address to be set as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address
00574                    of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired selector.
00575 
00576     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment.  The Length <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a 16 bit value
00577              and zero means 64KB.
00578 
00579     Selector - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector to be set up.
00580 
00581 Return Value:
00582 
00583     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released.
00584 
00585     STATUS_ABIOS_NOT_PRESENT - If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no ABIOS support in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
00586 
00587     STATUS_ABIOS_INVALID_SELECTOR - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector supplied <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invalid.
00588 
00589 
00590 --*/
00591 
00592 {
00593     PKGDTENTRY GdtEntry, GdtEntry1;
00594     KIRQL OldIrql;
00595     ULONG i;
00596 
00597     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>) {
00598         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_PRESENT;
00599     }
00600     <span class="keywordflow">if</span> (Selector &lt; <a class="code" href="../../d2/d3/abios_8h.html#a8">RESERVED_GDT_ENTRIES</a> * <span class="keyword">sizeof</span>(KGDTENTRY)) {
00601         <span class="keywordflow">return</span> STATUS_ABIOS_INVALID_SELECTOR;
00602     } <span class="keywordflow">else</span> {
00603         ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00604         GdtEntry = (PKGDTENTRY)(<a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0] + Selector);
00605         GdtEntry-&gt;LimitLow = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(Length - 1);
00606         GdtEntry-&gt;BaseLow = LOWWORD(SelectorBase);
00607         GdtEntry-&gt;HighWord.Bytes.BaseMid = <a class="code" href="../../d2/d3/abios_8h.html#a3">LOWBYTE</a>(HIGHWORD(SelectorBase));
00608         GdtEntry-&gt;HighWord.Bytes.BaseHi = <a class="code" href="../../d2/d3/abios_8h.html#a2">HIGHBYTE</a>(HIGHWORD(SelectorBase));
00609         GdtEntry-&gt;HighWord.Bits.Pres = 1;
00610         GdtEntry-&gt;HighWord.Bits.Type = TYPE_DATA;
00611         GdtEntry-&gt;HighWord.Bits.Dpl = DPL_SYSTEM;
00612         <span class="keywordflow">for</span> (i = 1; i &lt; (ULONG)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>; i++) {
00613             GdtEntry1 = (PKGDTENTRY)(<a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[i] + Selector);
00614             *GdtEntry1 = *GdtEntry;
00615         }
00616         ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00617         <span class="keywordflow">return</span> STATUS_SUCCESS;
00618     }
00619 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="abiosc.c::KeI386GetLid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386GetLid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RelativeLid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SharedLid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">170</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00060">_KDB_FTT_SECTION::DeviceBlock</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00030">_KDEVICE_BLOCK::DeviceId</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00061">_KDB_FTT_SECTION::FunctionTransferTable</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00074">KiAbiosLidTableLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00030">KiCommonDataArea</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00133">KiI386SelectorBase()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00056">KiLogicalIdTable</a>, <a class="el" href="../../d2/d3/abios_8h.html#a21">KLID_TABLE_ENTRY</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00100">LID_NO_SPECIFIC_OWNER</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00101">NUMBER_LID_TABLE_ENTRIES</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00066">_KCOMMON_DATA_AREA::NumberLids</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00037">_KABIOS_POINTER::Offset</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00096">_KLID_TABLE_ENTRY::Owner</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00097">_KLID_TABLE_ENTRY::OwnerCount</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00085">PUSHORT</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00038">_KABIOS_POINTER::Selector</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00180                    :
00181 
00182     This function searches Device Blocks and Common Data Area <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00183     Logical Id <a class="code" href="../../d7/d1/genuedef_8c.html#a7">matching</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified Device Id.
00184 
00185     N.B. (<a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a4">WARNING</a> shielint) To speed <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> search, <span class="keyword">this</span> routine ASSUMES that
00186     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> LIDs with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same Device <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> always appear consecutively in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00187     Common Data Area.  IBM ABIOS doc does not explicitly specify <span class="keyword">this</span>.
00188     But from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> way ABIOS initializes Device Block and Function Transfer
00189     Table, I think <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assumption <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keyword">true</span>.
00190 
00191 Arguments:
00192 
00193     DeviceId - Desired Device Id.
00194 
00195     RelativeLid - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Nth logical Id <span class="keywordflow">for</span> <span class="keyword">this</span> device Id.  <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value
00196                   of 0 indicates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first available Lid.
00197 
00198     SharedLid - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value indicates <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a shared or exclusively
00199                 owned logical Id.
00200 
00201     DriverObject - Supplies a 32-bit flat pointer of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requesting device
00202                 driver's driver object.  The DriverObject <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to establish
00203                 <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ownership of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired LID.
00204 
00205     LogicalId - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> pointer to a variable which will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Lid.
00206 
00207 Return Value:
00208 
00209     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available.
00210 
00211     STATUS_ABIOS_NOT_PRESENT - If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no ABIOS support in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
00212 
00213     STATUS_ABIOS_LID_NOT_EXIST - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified LID does not exist.
00214 
00215     STATUS_ABIOS_LID_ALREADY_OWNED - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller requests an exclusively
00216                                      owned LID.
00217 
00218 --*/
00219 
00220 {
00221     <a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html">PKDB_FTT_SECTION</a> CdaPointer;
00222     <a class="code" href="../../d8/d5/struct__KDEVICE__BLOCK.html">PKDEVICE_BLOCK</a> DeviceBlock;
00223     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Lid, RelativeLidCount = 1;
00224     ULONG <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>;
00225     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00226     KIRQL OldIrql;
00227     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00228 
00229     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>) {
00230         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_PRESENT;
00231     }
00232 
00233     <span class="keywordflow">if</span> (SharedLid) {
00234         <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> = <a class="code" href="../../d2/d3/abios_8h.html#a0">LID_NO_SPECIFIC_OWNER</a>;
00235         <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = 1;
00236     } <span class="keywordflow">else</span> {
00237         <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> = (ULONG)DriverObject;
00238         <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = 0;
00239     }
00240 
00241     <span class="comment">//</span>
00242     <span class="comment">// If the Logical Id Table hasn't been created yet, create it now.</span>
00243     <span class="comment">//</span>
00244     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00245         <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPool,
00246                                           NUMBER_LID_TABLE_ENTRIES *
00247                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html">KLID_TABLE_ENTRY</a>),
00248                                           '  eK');
00249         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00250             <span class="keywordflow">return</span>(STATUS_NO_MEMORY);
00251         }
00252         RtlZeroMemory(KiLogicalIdTable, NUMBER_LID_TABLE_ENTRIES*<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html">KLID_TABLE_ENTRY</a>));
00253     }
00254 
00255     <span class="comment">//</span>
00256     <span class="comment">// For each Lid defined in Common Data Area, we check if it has non</span>
00257     <span class="comment">// empty device block and function transfer table.  If yes, we proceed</span>
00258     <span class="comment">// to check the device id.  Otherwise, we skip the Lid.</span>
00259     <span class="comment">//</span>
00260 
00261     CdaPointer = (<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html">PKDB_FTT_SECTION</a>)<a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a> + 2;
00262     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_ABIOS_LID_NOT_EXIST;
00263 
00264     ExAcquireSpinLock(&amp;KiAbiosLidTableLock, &amp;OldIrql);
00265 
00266     <span class="keywordflow">for</span> (Lid = 2; Lid &lt; <a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a>-&gt;<a class="code" href="../../d5/d5/struct__KCOMMON__DATA__AREA.html#o1">NumberLids</a>; Lid++) {
00267         <span class="keywordflow">if</span> (CdaPointer-&gt;<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html#o0">DeviceBlock</a>.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o1">Selector</a> != 0 &amp;&amp;
00268             CdaPointer-&gt;<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html#o1">FunctionTransferTable</a>.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o1">Selector</a> != 0) {
00269 
00270             DeviceBlock = (<a class="code" href="../../d8/d5/struct__KDEVICE__BLOCK.html">PKDEVICE_BLOCK</a>)(<a class="code" href="../../d3/d3/abiosc_8c.html#a10">KiI386SelectorBase</a>(
00271                                                CdaPointer-&gt;<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html#o0">DeviceBlock</a>.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o1">Selector</a>)
00272                                            + (CdaPointer-&gt;<a class="code" href="../../d7/d5/struct__KDB__FTT__SECTION.html#o0">DeviceBlock</a>.<a class="code" href="../../d9/d4/struct__KABIOS__POINTER.html#o0">Offset</a>));
00273             <span class="keywordflow">if</span> (DeviceBlock-&gt;<a class="code" href="../../d8/d5/struct__KDEVICE__BLOCK.html#o4">DeviceId</a> == DeviceId) {
00274                 <span class="keywordflow">if</span> (RelativeLid == RelativeLidCount || RelativeLid == 0) {
00275                     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> == 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>) {
00276                         <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> = <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>;
00277                         <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o1">OwnerCount</a> += <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00278                         *LogicalId = Lid;
00279                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00280                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> == <a class="code" href="../../d2/d3/abios_8h.html#a0">LID_NO_SPECIFIC_OWNER</a>) {
00281                         <span class="keywordflow">if</span> (SharedLid) {
00282                             *LogicalId = Lid;
00283                             <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o1">OwnerCount</a> += <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00284                             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00285                         } <span class="keywordflow">else</span> {
00286                             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_ABIOS_LID_ALREADY_OWNED;
00287                         }
00288                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[Lid].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> == (ULONG)DriverObject) {
00289                         *LogicalId = Lid;
00290                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00291                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RelativeLid != 0) {
00292                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_ABIOS_LID_ALREADY_OWNED;
00293                     }
00294                     <span class="keywordflow">break</span>;
00295                 } <span class="keywordflow">else</span> {
00296                     RelativeLidCount++;
00297                 }
00298             }
00299         }
00300         CdaPointer++;
00301     }
00302 
00303     ExReleaseSpinLock(&amp;KiAbiosLidTableLock, OldIrql);
00304     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00305 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="abiosc.c::KeI386ReleaseGdtSelectors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386ReleaseGdtSelectors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorArray</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfSelectors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">507</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00078">_KFREE_GDT_ENTRY::Flink</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">KiFreeGdtListHead</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">KiNumberFreeSelectors</a>.
<p>
<pre class="fragment"><div>00514                    :
00515 
00516     This function releases a set of GDT selectors <span class="keywordflow">for</span> a device driver.
00517     Usually <span class="keyword">this</span> function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called at device driver termination or
00518     deinstallation time.
00519 
00520 Arguments:
00521 
00522     SelectorArray - Supplies a pointer to an array of <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> selectors
00523                     to be freed.
00524 
00525     NumberOfSelectors - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of selectors to be released.
00526 
00527 Return Value:
00528 
00529     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released.
00530 
00531 --*/
00532 {
00533     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> GdtEntry;
00534     KIRQL OldIrql;
00535     ULONG Gdt;
00536 
00537     ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00538 
00539     <span class="comment">//</span>
00540     <span class="comment">// The Free Gdt link list is maintained on Processor 0's GDT ONLY.</span>
00541     <span class="comment">// Because the 'selector' is an offset to the beginning of GDT and</span>
00542     <span class="comment">// it should be the same accross all the processors.</span>
00543     <span class="comment">//</span>
00544 
00545     <a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> += NumberOfSelectors;
00546     Gdt = <a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0];
00547     <span class="keywordflow">while</span> (NumberOfSelectors != 0) {
00548         GdtEntry = (<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>)(Gdt + *SelectorArray++);
00549         GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o0">Flink</a> = <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a>;
00550         <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = GdtEntry;
00551         NumberOfSelectors--;
00552     }
00553     ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00554     <span class="keywordflow">return</span> STATUS_SUCCESS;
00555 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="abiosc.c::KeI386ReleaseLid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386ReleaseLid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00308">308</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00074">KiAbiosLidTableLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00056">KiLogicalIdTable</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00100">LID_NO_SPECIFIC_OWNER</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00096">_KLID_TABLE_ENTRY::Owner</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00097">_KLID_TABLE_ENTRY::OwnerCount</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
<pre class="fragment"><div>00315                    :
00316 
00317     This function releases a logical Id.  This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called at ABIOS
00318     device driver destallation or termination.
00319 
00320 Arguments:
00321 
00322     LogicalId - Logical Id to be released.
00323 
00324     DriverObject - Supplies a 32-bit flat pointer of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requesting device
00325                 driver's driver object.  The DriverObject <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to check
00326                 <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ownership of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified LID.
00327 
00328 Return Value:
00329 
00330     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released.
00331 
00332     STATUS_ABIOS_NOT_PRESENT - If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no ABIOS support in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
00333 
00334     STATUS_ABIOS_NOT_LID_OWNER - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller does not own <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> LID.
00335 
00336 --*/
00337 
00338 {
00339     KIRQL OldIrql;
00340     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00341 
00342     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>) {
00343         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_PRESENT;
00344     }
00345 
00346     ExAcquireSpinLock(&amp;KiAbiosLidTableLock, &amp;OldIrql);
00347 
00348     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> == (ULONG)DriverObject) {
00349         <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00350         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00351     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> == <a class="code" href="../../d2/d3/abios_8h.html#a0">LID_NO_SPECIFIC_OWNER</a>) {
00352         <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o1">OwnerCount</a>--;
00353         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o1">OwnerCount</a> == 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>) {
00354             <a class="code" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>[LogicalId].<a class="code" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html#o0">Owner</a> = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00355         }
00356         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00357     } <span class="keywordflow">else</span> {
00358         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_ABIOS_NOT_LID_OWNER;
00359     }
00360 
00361     ExReleaseSpinLock(&amp;KiAbiosLidTableLock, OldIrql);
00362 
00363     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00364 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="abiosc.c::Ki386InitializeGdtFreeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ki386InitializeGdtFreeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>EndOfGdt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00622">622</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00078">_KFREE_GDT_ENTRY::Flink</a>, <a class="el" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">KiFreeGdtListHead</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">KiNumberFreeSelectors</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00082">_KFREE_GDT_ENTRY::Present</a>, and <a class="el" href="../../d3/d2/abios_8h-source.html#l00129">RESERVED_GDT_ENTRIES</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.
<p>
<pre class="fragment"><div>00628                    :
00629 
00630     This function initializes gdt free list by linking all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unused gdt
00631     entries to a free list.
00632 
00633 Arguments:
00634 
00635     EndOfGdt - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ending address of desired GDT.
00636 
00637 Return Value:
00638 
00639     None.
00640 
00641 --*/
00642 {
00643     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> GdtEntry;
00644 
00645     GdtEntry = EndOfGdt - 1;
00646     <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = (<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>)0;
00647     <span class="keywordflow">while</span> (GdtEntry != (<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>)<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() +
00648                         <a class="code" href="../../d2/d3/abios_8h.html#a8">RESERVED_GDT_ENTRIES</a> - 1) {
00649         <span class="keywordflow">if</span> (GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o4">Present</a> == 0) {
00650             GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o0">Flink</a> = <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a>;
00651             <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = GdtEntry;
00652             <a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a>++;
00653         }
00654         GdtEntry--;
00655     }
00656 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="abiosc.c::KiI386SelectorBase" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KiI386SelectorBase           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Selector</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00133">133</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt()</a>, and <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00367">KeI386AbiosCall()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>.
<p>
<pre class="fragment"><div>00139                    :
00140 
00141     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified GDT selector.
00142 
00143 Arguments:
00144 
00145     Selector - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired selector.
00146 
00147 Return Value:
00148 
00149     SelectorBase - Return <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified selector;
00150                    (<span class="keywordflow">return</span> -1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> <span class="keywordflow">if</span> invalid selector)
00151 
00152 
00153 --*/
00154 
00155 {
00156     PKGDTENTRY GdtEntry;
00157 
00158 
00159     GdtEntry = (PKGDTENTRY)(<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + Selector);
00160     <span class="keywordflow">if</span> (GdtEntry-&gt;HighWord.Bits.Pres) {
00161         <span class="keywordflow">return</span> ((ULONG)GdtEntry-&gt;BaseLow |
00162                 (ULONG)GdtEntry-&gt;HighWord.Bytes.BaseMid &lt;&lt; 16 |
00163                 (ULONG)GdtEntry-&gt;HighWord.Bytes.BaseHi &lt;&lt; 24);
00164     } <span class="keywordflow">else</span> {
00165         <span class="keywordflow">return</span> (ULONG)(-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00166     }
00167 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="abiosc.c::KiInitializeAbios" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiInitializeAbios           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN UCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Processor</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">659</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02773">KeLoaderBlock</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00122">KGDT_CDA16</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00121">KGDT_CODE16</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00123">KGDT_GDT_ALIAS</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00120">KGDT_STACK16</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00622">Ki386InitializeGdtFreeList()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00074">KiAbiosLidTableLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00030">KiCommonDataArea</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00137">KiEndOfCode16</a>, <a class="el" href="../../d2/d3/abios_8h.html#a27">KiI386CallAbios()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00083">KiInitializeAbiosGdtEntry()</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00138">KiStack16GdtEntry</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">_LOADER_PARAMETER_BLOCK::u</a>.
<p>
<pre class="fragment"><div>00665                    :
00666 
00667     This function initializes gdt free list and sets up selector <span class="keywordflow">for</span>
00668     KiI386AbiosCall (16-bit code).
00669 
00670 Arguments:
00671 
00672     Processor - <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor who performs <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initialization.
00673 
00674 Return Value:
00675 
00676     None.
00677 
00678 --*/
00679 
00680 {
00681 
00682     ULONG GdtLength;
00683     PKGDTENTRY AliasGdtSelectorEntry;
00684     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> EndOfGdt;
00685 
00686     <span class="comment">//</span>
00687     <span class="comment">// First check if abios is recognized by osloader.</span>
00688     <span class="comment">//</span>
00689 
00690     <a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a> = <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">u</a>.I386.CommonDataArea;
00691 
00692     <span class="comment">//</span>
00693     <span class="comment">// NOTE For now we want to disable ABIOS support on MP.</span>
00694     <span class="comment">//</span>
00695 
00696     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || Processor != 0) {
00697         <a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00698     } <span class="keywordflow">else</span> {
00699         <a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00700     }
00701 
00702     <span class="comment">//</span>
00703     <span class="comment">// Initialize the spinlocks for accessing GDTs and Lid Table.</span>
00704     <span class="comment">//</span>
00705 
00706     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>( &amp;KiAbiosGdtLock );
00707     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>( &amp;KiAbiosLidTableLock );
00708 
00709     <span class="comment">//</span>
00710     <span class="comment">// Determine the starting and ending addresses of GDT.</span>
00711     <span class="comment">//</span>
00712 
00713     <a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[Processor] = <a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>();
00714 
00715     AliasGdtSelectorEntry = (PKGDTENTRY)(<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + <a class="code" href="../../d2/d3/abios_8h.html#a7">KGDT_GDT_ALIAS</a>);
00716     GdtLength = 1 + (ULONG)(AliasGdtSelectorEntry-&gt;LimitLow) +
00717                 (ULONG)(AliasGdtSelectorEntry-&gt;HighWord.Bits.LimitHi &lt;&lt; 16);
00718     EndOfGdt = (<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>)(<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + GdtLength);
00719 
00720     <span class="comment">//</span>
00721     <span class="comment">// Prepare selector for 16 bit stack segment</span>
00722     <span class="comment">//</span>
00723 
00724     <a class="code" href="../../d2/d3/abios_8h.html#a26">KiStack16GdtEntry</a> = <a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + <a class="code" href="../../d2/d3/abios_8h.html#a4">KGDT_STACK16</a>;
00725 
00726     <a class="code" href="../../d3/d3/abiosc_8c.html#a9">KiInitializeAbiosGdtEntry</a>(
00727                 (PKGDTENTRY)KiStack16GdtEntry,
00728                 0L,
00729                 0xffff,
00730                 TYPE_DATA
00731                 );
00732 
00733     <span class="comment">//</span>
00734     <span class="comment">// Establish the addressability of Common Data Area selector.</span>
00735     <span class="comment">//</span>
00736 
00737     <a class="code" href="../../d3/d3/abiosc_8c.html#a9">KiInitializeAbiosGdtEntry</a>(
00738                 (PKGDTENTRY)(<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + KGDT_CDA16),
00739                 (ULONG)KiCommonDataArea,
00740                 0xffff,
00741                 TYPE_DATA
00742                 );
00743 
00744     <span class="comment">//</span>
00745     <span class="comment">// Set up 16-bit code selector for KiI386AbiosCall</span>
00746     <span class="comment">//</span>
00747 
00748     <a class="code" href="../../d3/d3/abiosc_8c.html#a9">KiInitializeAbiosGdtEntry</a>(
00749                 (PKGDTENTRY)(<a class="code" href="../../d2/d3/abios_8h.html#a29">KiAbiosGetGdt</a>() + KGDT_CODE16),
00750                 (ULONG)&amp;KiI386CallAbios,
00751                 (ULONG)&amp;KiEndOfCode16 - (ULONG)&amp;KiI386CallAbios - 1,
00752                 0x18                   <span class="comment">// TYPE_CODE</span>
00753                 );
00754 
00755     <span class="comment">//</span>
00756     <span class="comment">// Link all the unused GDT entries to our GDT free list.</span>
00757     <span class="comment">//</span>
00758 
00759     <span class="keywordflow">if</span> (Processor == 0) {
00760         <a class="code" href="../../d3/d3/abiosc_8c.html#a17">Ki386InitializeGdtFreeList</a>(EndOfGdt);
00761     }
00762 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="abiosc.c::KiInitializeAbiosGdtEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiInitializeAbiosGdtEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PKGDTENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>GdtEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Base</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00083">83</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.
<p>
<pre class="fragment"><div>00092                    :
00093 
00094     This function initializes a GDT entry <span class="keywordflow">for</span> abios specific code.  Base,
00095     Limit, and Type (code, data) are set according to parameters.  All other
00096     fields of the entry are set to match standard system values.
00097 
00098     N.B. The BIG and GRANULARITY are always set to 0.
00099 
00100 Arguments:
00101 
00102     GdtEntry - GDT descriptor to be filled in.
00103 
00104     Base - Linear address of the first byte mapped by the selector.
00105 
00106     Limit - Size of the selector in BYTE.
00107 
00108     Type - Code or Data.  All code selectors are marked readable,
00109             all data selectors are marked writeable.
00110 
00111 Return Value:
00112 
00113     Pointer to the GDT entry.
00114 
00115 --*/
00116 
00117 {
00118     GdtEntry-&gt;LimitLow = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(Limit &amp; 0xffff);
00119     GdtEntry-&gt;BaseLow = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(Base &amp; 0xffff);
00120     GdtEntry-&gt;HighWord.Bytes.BaseMid = (UCHAR)((Base &amp; 0xff0000) &gt;&gt; 16);
00121     GdtEntry-&gt;HighWord.Bits.Type = Type;
00122     GdtEntry-&gt;HighWord.Bits.Dpl = 0;
00123     GdtEntry-&gt;HighWord.Bits.Pres = 1;
00124     GdtEntry-&gt;HighWord.Bits.LimitHi = (Limit &amp; 0xf0000) &gt;&gt; 16;
00125     GdtEntry-&gt;HighWord.Bits.Sys = 0;
00126     GdtEntry-&gt;HighWord.Bits.Reserved_0 = 0;
00127     GdtEntry-&gt;HighWord.Bits.Default_Big = 0;
00128     GdtEntry-&gt;HighWord.Bits.Granularity = 0;
00129     GdtEntry-&gt;HighWord.Bytes.BaseHi = (UCHAR)((Base &amp; 0xff000000) &gt;&gt; 24);
00130 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a5" doxytag="abiosc.c::KiAbiosGdt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[MAXIMUM_PROCESSORS]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">62</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">KeI386AllocateGdtSelectors()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">KeI386FlatToGdtSelector()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">KeI386ReleaseGdtSelectors()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="abiosc.c::KiAbiosGdtLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d3/d3/abiosc_8c.html#a6">KiAbiosGdtLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">68</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">KeI386AllocateGdtSelectors()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">KeI386FlatToGdtSelector()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">KeI386ReleaseGdtSelectors()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="abiosc.c::KiAbiosLidTableLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d3/d3/abiosc_8c.html#a7">KiAbiosLidTableLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00074">74</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00308">KeI386ReleaseLid()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="abiosc.c::KiAbiosPresent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">31</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00367">KeI386AbiosCall()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">KeI386FlatToGdtSelector()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00308">KeI386ReleaseLid()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="abiosc.c::KiCommonDataArea" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d5/d5/struct__KCOMMON__DATA__AREA.html">PKCOMMON_DATA_AREA</a> <a class="el" href="../../d3/d3/abiosc_8c.html#a0">KiCommonDataArea</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00030">30</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00367">KeI386AbiosCall()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="abiosc.c::KiFreeGdtListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> <a class="el" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = 0L<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">50</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">KeI386AllocateGdtSelectors()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">KeI386ReleaseGdtSelectors()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00622">Ki386InitializeGdtFreeList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="abiosc.c::KiLogicalIdTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d7/struct__KLID__TABLE__ENTRY.html">PKLID_TABLE_ENTRY</a> <a class="el" href="../../d3/d3/abiosc_8c.html#a4">KiLogicalIdTable</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00056">56</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00367">KeI386AbiosCall()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00308">KeI386ReleaseLid()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="abiosc.c::KiNumberFreeSelectors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> <a class="el" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">44</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">KeI386AllocateGdtSelectors()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">KeI386ReleaseGdtSelectors()</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00622">Ki386InitializeGdtFreeList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="abiosc.c::KiStack16GdtEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d3/d3/abiosc_8c.html#a8">KiStack16GdtEntry</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00080">80</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
