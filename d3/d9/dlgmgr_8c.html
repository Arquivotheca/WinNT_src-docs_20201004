<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: dlgmgr.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>dlgmgr.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d4/d8/dlgmgr_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a0">UNICODE_MINUS_SIGN</a>&nbsp;&nbsp;&nbsp;0x2212</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a1">IsInForegroundQueue</a>(hwnd)&nbsp;&nbsp;&nbsp;(NtUserQueryWindow(hwnd, WindowIsForegroundThread) != NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a2">IsCurrentThreadForeground</a>()&nbsp;&nbsp;&nbsp;((BOOL)NtUserGetThreadState(UserThreadStateIsForeground))</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a4">ValidateCallback</a> (HANDLE h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a5">GetParentDialog</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndDialog)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a6">xxxSaveDlgFocus</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a7">xxxRestoreDlgFocus</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a8">DlgSetFocus</a> (HWND hwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a9">GetDlgCtrlID</a> (HWND hwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a10">ValidateDialogPwnd</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a11">CvtDec</a> (int u, LPWSTR *lplpch)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a12">SetDlgItemInt</a> (HWND hwnd, int item, UINT u, BOOL fSigned)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a13">CheckDlgButton</a> (HWND hwnd, int id, UINT cmdCheck)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a14">GetDlgItemInt</a> (HWND hwnd, int item, BOOL FAR *lpfValOK, BOOL fSigned)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a15">CheckRadioButton</a> (HWND hwnd, int idFirst, int idLast, int id)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a16">IsDlgButtonChecked</a> (HWND hwnd, int id)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a17">DefDlgProcWorker</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fAnsi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a18">DefDlgProcW</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a19">DefDlgProcA</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a20">DialogBox2</a> (HWND hwnd, HWND hwndOwner, BOOL fDisabled, BOOL fOwnerIsActiveWindow)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a21">InternalDialogBox</a> (HANDLE hModule, LPDLGTEMPLATE lpdt, HWND hwndOwner, DLGPROC pfnDialog, LPARAM lParam, UINT fSCDLGFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a22">RepositionRect</a> (<a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> pMonitor, LPRECT lprc, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwStyle, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwExStyle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a23">MapDialogRect</a> (HWND hwnd, LPRECT lprc)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d4/struct__LOOKASIDE.html">LOOKASIDE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d9/dlgmgr_8c.html#a3">DialogLookaside</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="dlgmgr.c::IsCurrentThreadForeground" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IsCurrentThreadForeground          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((BOOL)NtUserGetThreadState(UserThreadStateIsForeground))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00026">26</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01036">DialogBox2()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="dlgmgr.c::IsInForegroundQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IsInForegroundQueue          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hwnd&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(NtUserQueryWindow(hwnd, WindowIsForegroundThread) != NULL)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00024">24</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, and <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01036">DialogBox2()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="dlgmgr.c::UNICODE_MINUS_SIGN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_MINUS_SIGN&nbsp;&nbsp;&nbsp;0x2212          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00017">17</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00320">GetDlgItemInt()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a13" doxytag="dlgmgr.c::CheckDlgButton" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CheckDlgButton           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cmdCheck</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00300">300</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00304 {
00305     <span class="keywordflow">if</span> ((hwnd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, <span class="keywordtype">id</span>)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00306         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00307     }
00308 
00309     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, BM_SETCHECK, cmdCheck, 0);
00310 
00311     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00312 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="dlgmgr.c::CheckRadioButton" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CheckRadioButton           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>idFirst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>idLast</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00409">409</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01513">PtoHq</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00213">REBASE</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01764">tagWND::spmenu</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
<pre class="fragment"><div>00414 {
00415     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, pwndDialog;
00416     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fCheckOn;
00417 
00418     pwndDialog = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
00419     <span class="keywordflow">if</span> (pwndDialog == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00420         <span class="keywordflow">return</span> 0;
00421 
00422     <span class="keywordflow">for</span> (pwnd = <a class="code" href="../../d6/d0/usercli_8h.html#a26">REBASE</a>(pwndDialog, spwndChild); pwnd; pwnd = <a class="code" href="../../d6/d0/usercli_8h.html#a26">REBASE</a>(pwnd, spwndNext)) {
00423 
00424         <span class="keywordflow">if</span> ((PtrToLong(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>) &gt;= idFirst) &amp;&amp;
00425             (PtrToLong(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>) &lt;= idLast)) {
00426 
00427             fCheckOn = (PtrToLong(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>) == <span class="keywordtype">id</span>);
00428             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a449">PtoHq</a>(pwnd), BM_SETCHECK, fCheckOn, 0L);
00429         }
00430     }
00431 
00432     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00433 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="dlgmgr.c::CvtDec" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CvtDec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>u</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR *&nbsp;</td>
          <td class="mdname" nowrap> <em>lplpch</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00246">246</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d8/nt6_2dlgmgr_8c-source.html#l00252">CvtDec()</a>.
<p>
<pre class="fragment"><div>00249 {
00250     <span class="keywordflow">if</span> (u &gt;= 10) {
00251         <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a13">CvtDec</a>(u / 10, lplpch);
00252         u %= 10;
00253     }
00254 
00255     *(*lplpch)++ = (WCHAR)(u + <span class="charliteral">'0'</span>);
00256 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="dlgmgr.c::DefDlgProcA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT WINAPI DefDlgProcA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01014">1014</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>.
<p>
<pre class="fragment"><div>01019 {
01020     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01021 
01022     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01023         <span class="keywordflow">return</span> (0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01024     }
01025 
01026     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a618">DefDlgProcWorker</a>(pwnd, message, wParam, lParam, TRUE);
01027 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="dlgmgr.c::DefDlgProcW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT WINAPI DefDlgProcW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00999">999</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>, and <a class="el" href="../../d7/d7/clinit_8c-source.html#l00378">RW_RegisterControls()</a>.
<p>
<pre class="fragment"><div>01004 {
01005     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01006 
01007     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01008         <span class="keywordflow">return</span> (0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01009     }
01010 
01011     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a618">DefDlgProcWorker</a>(pwnd, message, wParam, lParam, FALSE);
01012 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="dlgmgr.c::DefDlgProcWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT DefDlgProcWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fAnsi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">460</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>.
<p>
<pre class="fragment"><div>00466 {
00467     HWND hwnd = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd);
00468     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndT1, tlpwndT2, tlpwndT3, tlpwndTop;
00469     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndT;
00470     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndT1, pwndT2, pwndT3, pwndTop;
00471     HWND hwndT1;
00472     LRESULT result;
00473     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSetBit;
00474     DLGPROC pfn;
00475 
00476     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00477 
00478     <span class="comment">/*</span>
00479 <span class="comment">     * use the Win 3.1 documented size</span>
00480 <span class="comment">     */</span>
00481     <a class="code" href="../../d6/d0/usercli_8h.html#a28">VALIDATECLASSANDSIZE</a>(pwnd, FNID_DIALOG);
00482 
00483     <span class="comment">/*</span>
00484 <span class="comment">     * Must do special validation here to make sure pwnd is a dialog window.</span>
00485 <span class="comment">     */</span>
00486     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a761">ValidateDialogPwnd</a>(pwnd))
00487         <span class="keywordflow">return</span> 0;
00488 
00489     <span class="keywordflow">if</span> (((<a class="code" href="../../d4/d5/struct__DIALOG.html">PDIALOG</a>)pwnd)-&gt;resultWP != 0)
00490         <a class="code" href="../../d0/d0/ntuser_8h.html#a3">NtUserSetWindowLongPtr</a>(hwnd, DWLP_MSGRESULT, 0, FALSE);
00491     result = 0;   <span class="comment">// no dialog proc</span>
00492 
00493     <span class="keywordflow">if</span> (message == WM_FINALDESTROY) {
00494         <span class="keywordflow">goto</span> DoCleanup;
00495     }
00496 
00497     <span class="keywordflow">if</span> ((pfn = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;lpfnDlg) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00498         <span class="comment">/* Bug 234292 - joejo</span>
00499 <span class="comment">         * Since the called window/dialog proc may have a different calling</span>
00500 <span class="comment">         * convention, we must wrap the call and, check esp and replace with</span>
00501 <span class="comment">         * a good esp when the call returns. This is what UserCallWinProc* does.</span>
00502 <span class="comment">        */</span>
00503         result =  <a class="code" href="../../d6/d0/usercli_8h.html#a18">CALLPROC_WOWCHECKPWW_DLG</a>(pfn, hwnd, message, wParam, lParam, &amp;(pwnd-&gt;state));
00504         
00505         <span class="comment">/*</span>
00506 <span class="comment">         * Get out if the window was destroyed in the dialog proc.</span>
00507 <span class="comment">         */</span>
00508         <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (pwnd-&gt;fnid &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a228">FNID_STATUS_BITS</a>))
00509             <span class="keywordflow">return</span> result;
00510     }
00511 
00512     <span class="comment">/*</span>
00513 <span class="comment">     * SPECIAL CASED ... and DOCUMENTED that way !!!</span>
00514 <span class="comment">     * These 6, and ONLY these 6, should be hacked in this fashion.</span>
00515 <span class="comment">     * Anybody who needs the REAL return value to a message should</span>
00516 <span class="comment">     * use SetDlgMsgResult in WINDOWSX.H</span>
00517 <span class="comment">     */</span>
00518 
00519     <span class="keywordflow">switch</span> (message)
00520     {
00521         <span class="keywordflow">case</span> WM_COMPAREITEM:
00522         <span class="keywordflow">case</span> WM_VKEYTOITEM:
00523         <span class="keywordflow">case</span> WM_CHARTOITEM:
00524         <span class="keywordflow">case</span> WM_INITDIALOG:
00525         <span class="keywordflow">case</span> WM_QUERYDRAGICON:
00526             <span class="keywordflow">return</span> ((LRESULT)(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)result);
00527 
00528         <span class="keywordflow">case</span> WM_CTLCOLOR:
00529         <span class="keywordflow">case</span> WM_CTLCOLORMSGBOX:
00530         <span class="keywordflow">case</span> WM_CTLCOLOREDIT:
00531         <span class="keywordflow">case</span> WM_CTLCOLORLISTBOX:
00532         <span class="keywordflow">case</span> WM_CTLCOLORBTN:
00533         <span class="keywordflow">case</span> WM_CTLCOLORDLG:
00534         <span class="keywordflow">case</span> WM_CTLCOLORSCROLLBAR:
00535         <span class="keywordflow">case</span> WM_CTLCOLORSTATIC:
00536             <span class="comment">// QuarkXPress doesn't like finding the WM_CTLCOLOR result in</span>
00537             <span class="comment">// resultWP -- we should never be setting resultWP -- that's meant</span>
00538             <span class="comment">// as a pass-thru return value -- so let's go back to doing it the</span>
00539             <span class="comment">// old way -- Win95B B#21269 -- 03/13/95 -- tracysh (cr: jeffbog)</span>
00540             <span class="keywordflow">if</span> (result)
00541                 <span class="keywordflow">return</span> result;
00542             <span class="keywordflow">break</span>;
00543     }
00544 
00545     <span class="keywordflow">if</span> (!result) {
00546 
00547         <span class="comment">/*</span>
00548 <span class="comment">         * Save the result value in case our private memory is freed</span>
00549 <span class="comment">         * before we return</span>
00550 <span class="comment">         */</span>
00551 <span class="comment">//        result = PDLG(pwnd)-&gt;resultWP;</span>
00552 
00553         <span class="keywordflow">switch</span> (message) {
00554         <span class="keywordflow">case</span> WM_CTLCOLOR:
00555         <span class="keywordflow">case</span> WM_CTLCOLORMSGBOX:
00556         <span class="keywordflow">case</span> WM_CTLCOLOREDIT:
00557         <span class="keywordflow">case</span> WM_CTLCOLORLISTBOX:
00558         <span class="keywordflow">case</span> WM_CTLCOLORBTN:
00559         <span class="keywordflow">case</span> WM_CTLCOLORDLG:
00560         <span class="keywordflow">case</span> WM_CTLCOLORSCROLLBAR:
00561         <span class="keywordflow">case</span> WM_CTLCOLORSTATIC:
00562         {
00563             <span class="comment">//</span>
00564             <span class="comment">// HACK OF DEATH:</span>
00565             <span class="comment">// To get 3D colors for non 4.0 apps who use 3DLOOK,</span>
00566             <span class="comment">// we temporarily add on the 4.0 compat bit, pass this</span>
00567             <span class="comment">// down to DWP, and clear it.</span>
00568             <span class="comment">//</span>
00569             <span class="comment">// Use "result" var for bool saying we have to add/clear 4.0</span>
00570             <span class="comment">// compat bit.</span>
00571 
00572             fSetBit = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, DF3DLOOK)!= 0) &amp;&amp;
00573                      (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFWIN40COMPAT) == 0);
00574 
00575             <span class="keywordflow">if</span> (fSetBit)
00576                 <a class="code" href="../../d4/d1/userk_8h.html#a1628">SetWindowState</a>(pwnd, WFWIN40COMPAT);
00577 
00578             result = <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message,
00579                     wParam, lParam, fAnsi);
00580 
00581             <span class="keywordflow">if</span> (fSetBit)
00582                 <a class="code" href="../../d4/d1/userk_8h.html#a1629">ClearWindowState</a>(pwnd, WFWIN40COMPAT);
00583             <span class="keywordflow">return</span> result;
00584         }
00585 
00586         <span class="keywordflow">case</span> WM_ERASEBKGND:
00587             <a class="code" href="../../d6/d0/usercli_8h.html#a234">FillWindow</a>(hwnd, hwnd, (HDC)wParam, (HBRUSH)CTLCOLOR_DLG);
00588             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00589 
00590         <span class="keywordflow">case</span> WM_SHOWWINDOW:
00591 
00592             <span class="comment">/*</span>
00593 <span class="comment">             * If hiding the window, save the focus.  If showing the window</span>
00594 <span class="comment">             * by means of a SW_* command and the fEnd bit is set, do not</span>
00595 <span class="comment">             * pass to DWP so it won't get shown.</span>
00596 <span class="comment">             */</span>
00597             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd) == pwnd) {
00598                 <span class="keywordflow">if</span> (!wParam) {
00599                     <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a8">xxxSaveDlgFocus</a>(pwnd);
00600                 } <span class="keywordflow">else</span> {
00601 
00602                     <span class="keywordflow">if</span> (LOWORD(lParam) != 0 &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd)
00603                         <span class="keywordflow">break</span>;
00604 
00605                     <span class="comment">/*</span>
00606 <span class="comment">                     * Snap the cursor to the center of the default button.</span>
00607 <span class="comment">                     * Only do this if the current thread is in the foreground.</span>
00608 <span class="comment">                     * The _ShowCursor() code is added to work around a</span>
00609 <span class="comment">                     * problem with hardware cursors.  If change is done</span>
00610 <span class="comment">                     * in the same refresh cycle, the display of the cursor</span>
00611 <span class="comment">                     * would not reflect the new position.</span>
00612 <span class="comment">                     */</span>
00613                     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a368">TEST_PUSIF</a>(PUSIF_SNAPTO) &amp;&amp;
00614                             <a class="code" href="../../d3/d9/dlgmgr_8c.html#a1">IsInForegroundQueue</a>(hwnd)) {
00615                         hwndT1 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, (<span class="keywordtype">int</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;result);
00616                         <span class="keywordflow">if</span> (hwndT1) {
00617                             RECT rc;
00618 
00619                             <a class="code" href="../../d6/d0/usercli_8h.html#a231">NtUserShowCursor</a>(FALSE);
00620 
00621                             <a class="code" href="../../d3/d9/client_2wow_8c.html#a26">GetWindowRect</a>(hwndT1, &amp;rc);
00622                             <a class="code" href="../../d6/d0/usercli_8h.html#a227">NtUserSetCursorPos</a>(rc.left + ((rc.right - rc.left)/2),
00623                                          rc.top + ((rc.bottom - rc.top)/2));
00624 
00625                             <a class="code" href="../../d6/d0/usercli_8h.html#a231">NtUserShowCursor</a>(TRUE);
00626                         }
00627                     }
00628                 }
00629             }
00630             <span class="keywordflow">goto</span> CallDWP;
00631 
00632         <span class="keywordflow">case</span> WM_SYSCOMMAND:
00633             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd) == pwnd) {
00634                 <span class="comment">/*</span>
00635 <span class="comment">                 * If hiding the window, save the focus.  If showing the window</span>
00636 <span class="comment">                 * by means of a SW_* command and the fEnd bit is set, do not</span>
00637 <span class="comment">                 * pass to DWP so it won't get shown.</span>
00638 <span class="comment">                 */</span>
00639                 <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)wParam == SC_MINIMIZE)
00640                     <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a8">xxxSaveDlgFocus</a>(pwnd);
00641             }
00642             <span class="keywordflow">goto</span> CallDWP;
00643 
00644         <span class="keywordflow">case</span> WM_ACTIVATE:
00645             pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd);
00646             <span class="keywordflow">if</span> ( pwndT1 != pwnd) {
00647 
00648                 <span class="comment">/*</span>
00649 <span class="comment">                 * This random bit is used during key processing - bit</span>
00650 <span class="comment">                 * 08000000 of WM_CHAR messages is set if a dialog is currently</span>
00651 <span class="comment">                 * active.</span>
00652 <span class="comment">                 */</span>
00653                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a286">NtUserSetThreadState</a>(wParam ? QF_DIALOGACTIVE : 0, QF_DIALOGACTIVE);
00654             }
00655 
00656             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT1, &amp;tlpwndT1);
00657             <span class="keywordflow">if</span> (wParam != 0)
00658                 <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a9">xxxRestoreDlgFocus</a>(pwndT1);
00659             <span class="keywordflow">else</span>
00660                 <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a8">xxxSaveDlgFocus</a>(pwndT1);
00661 
00662             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT1);
00663             <span class="keywordflow">break</span>;
00664 
00665         <span class="keywordflow">case</span> WM_SETFOCUS:
00666             pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd);
00667             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;fEnd &amp;&amp; !<a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a9">xxxRestoreDlgFocus</a>(pwndT1)) {
00668 
00669                 pwndT = <a class="code" href="../../d6/d0/usercli_8h.html#a642">_GetNextDlgTabItem</a>(pwndT1, NULL, FALSE);
00670                 <a class="code" href="../../d6/d0/usercli_8h.html#a759">DlgSetFocus</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT));
00671             }
00672             <span class="keywordflow">break</span>;
00673 
00674         <span class="keywordflow">case</span> WM_CLOSE:
00675             <span class="comment">/*</span>
00676 <span class="comment">             * Make sure cancel button is not disabled before sending the</span>
00677 <span class="comment">             * IDCANCEL.  Note that we need to do this as a message instead</span>
00678 <span class="comment">             * of directly calling the dlg proc so that any dialog box</span>
00679 <span class="comment">             * filters get this.</span>
00680 <span class="comment">             */</span>
00681             pwndT1 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a5">_GetDlgItem</a>(pwnd, IDCANCEL);
00682             <span class="keywordflow">if</span> (pwndT1 &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndT1, WFDISABLED))
00683                 <a class="code" href="../../d6/d0/usercli_8h.html#a219">NtUserMessageBeep</a>(0);
00684             <span class="keywordflow">else</span>
00685                 <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(hwnd, WM_COMMAND, MAKELONG(IDCANCEL, BN_CLICKED),
00686                         (LPARAM)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT1));
00687             <span class="keywordflow">break</span>;
00688 
00689         <span class="keywordflow">case</span> WM_NCDESTROY:
00690         <span class="keywordflow">case</span> WM_FINALDESTROY:
00691 DoCleanup:
00692             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a286">NtUserSetThreadState</a>(0, QF_DIALOGACTIVE);
00693             <span class="keywordflow">if</span> (!(pwnd-&gt;style &amp; DS_LOCALEDIT)) {
00694                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData) {
00695                     <a class="code" href="../../d6/d0/usercli_8h.html#a764">ReleaseEditDS</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData);
00696                     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00697                 }
00698             }
00699 
00700             <span class="comment">/*</span>
00701 <span class="comment">             * Delete the user defined font if any</span>
00702 <span class="comment">             */</span>
00703             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hUserFont) {
00704                 DeleteObject(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hUserFont);
00705                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hUserFont = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00706             }
00707 
00708             <span class="comment">/*</span>
00709 <span class="comment">             * Free the dialog memory and mark this as a non-dialog window</span>
00710 <span class="comment">             */</span>
00711             <a class="code" href="../../d6/d0/usercli_8h.html#a408">FreeLookasideEntry</a>(&amp;DialogLookaside, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd));
00712             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a178">NtUserCallHwndParam</a>(hwnd, 0, SFI_SETDIALOGPOINTER);
00713             <span class="keywordflow">break</span>;
00714 
00715         <span class="keywordflow">case</span> DM_REPOSITION:
00716             {
00717                 RECT        rc;
00718                 <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>    pMonitor;
00719 
00720                 <span class="comment">// DAT recorder APP sends it's own private message 0x402</span>
00721                 <span class="comment">// through and we mistake it to be DM_REPOSITION. To avoid</span>
00722                 <span class="comment">// this confusion, we do the following check.</span>
00723                 <span class="comment">// Fix for Bug#25747 -- 9/29/94 --</span>
00724                 <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WEFCONTROLPARENT) ||
00725                     (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a232">GETFNID</a>(pwnd) != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a196">FNID_DESKTOP</a> &amp;&amp;
00726                      <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a232">GETFNID</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwnd, spwndParent)) != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a196">FNID_DESKTOP</a>)) {
00727 
00728                     <span class="keywordflow">goto</span> CallDWP;
00729                 }
00730 
00731                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a33">CopyRect</a>(&amp;rc, &amp;pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o6">rcWindow</a>);
00732                 pMonitor = <a class="code" href="../../d9/d1/mmrtl_8c.html#a7">_MonitorFromRect</a>(&amp;rc, MONITOR_DEFAULTTOPRIMARY);
00733                 <a class="code" href="../../d6/d0/usercli_8h.html#a760">RepositionRect</a>(pMonitor, &amp;rc, pwnd-&gt;style, pwnd-&gt;ExStyle);
00734                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a115">NtUserSetWindowPos</a>(hwnd, HWND_TOP, rc.left, rc.top,
00735                              rc.right-rc.left, rc.bottom-rc.top,
00736                              SWP_NOZORDER | SWP_NOSIZE | SWP_NOACTIVATE);
00737             }
00738             <span class="keywordflow">break</span>;
00739 
00740         <span class="keywordflow">case</span> DM_SETDEFID:
00741             pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd);
00742             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT1, &amp;tlpwndT1);
00743 
00744             <span class="keywordflow">if</span> (!(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;fEnd)) {
00745 
00746                 pwndT2 = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00747                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;result != 0)
00748                     pwndT2 = <a class="code" href="../../d6/d0/usercli_8h.html#a752">_FindDlgItem</a>(pwndT1, (<span class="keywordtype">int</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;result);
00749 
00750                 pwndT3 = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00751                 <span class="keywordflow">if</span> (wParam != 0) {
00752                     pwndT3 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a5">_GetDlgItem</a>(pwnd, (UINT)wParam);
00753                 }
00754 
00755                 <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT2, &amp;tlpwndT2);
00756                 <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT3, &amp;tlpwndT3);
00757 
00758                 <a class="code" href="../../d6/d0/usercli_8h.html#a757">xxxCheckDefPushButton</a>(pwndT1, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT2), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT3));
00759 
00760                 <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT3);
00761                 <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT2);
00762 
00763                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;result = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)wParam;
00764 <span class="comment">//                if (PDLG(pwnd)-&gt;spwndFocusSave) {</span>
00765 <span class="comment">//                    Lock(&amp;(PDLG(pwnd)-&gt;spwndFocusSave), pwndT2);</span>
00766 <span class="comment">//                }</span>
00767 
00768                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>()) {
00769                     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_OBJECT_DEFACTIONCHANGE, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT1), OBJID_CLIENT, INDEXID_CONTAINER);
00770                 }
00771             }
00772             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT1);
00773             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00774 
00775         <span class="keywordflow">case</span> DM_GETDEFID:
00776             pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd);
00777 
00778             <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;fEnd &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;result)
00779                 <span class="keywordflow">return</span>(MAKELONG(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwndT1)-&gt;result, DC_HASDEFID));
00780             <span class="keywordflow">else</span>
00781                 <span class="keywordflow">return</span> 0;
00782             <span class="keywordflow">break</span>;
00783 
00784         <span class="comment">/*</span>
00785 <span class="comment">         * This message was added so that user defined controls that want</span>
00786 <span class="comment">         * tab keys can pass the tab off to the next/previous control in the</span>
00787 <span class="comment">         * dialog box.  Without this, all they could do was set the focus</span>
00788 <span class="comment">         * which didn't do the default button stuff.</span>
00789 <span class="comment">         */</span>
00790         <span class="keywordflow">case</span> WM_NEXTDLGCTL:
00791             pwndTop = <a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd);
00792             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndTop, &amp;tlpwndTop);
00793 
00794             hwndT1 = <a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>();
00795             pwndT2 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a1">ValidateHwndNoRip</a>(hwndT1);
00796             <span class="keywordflow">if</span> (LOWORD(lParam)) {
00797                 <span class="keywordflow">if</span> (pwndT2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00798                     pwndT2 = pwndTop;
00799 
00800                 <span class="comment">/*</span>
00801 <span class="comment">                 * wParam contains the pwnd of the ctl to set focus to.</span>
00802 <span class="comment">                 */</span>
00803                 <span class="keywordflow">if</span> ((pwndT1 = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>((HWND)wParam)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00804                     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndTop);
00805                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00806                 }
00807             } <span class="keywordflow">else</span> {
00808                 <span class="keywordflow">if</span> (pwndT2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00809 
00810                     <span class="comment">/*</span>
00811 <span class="comment">                     * Set focus to the first tab item.</span>
00812 <span class="comment">                     */</span>
00813                     pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a642">_GetNextDlgTabItem</a>(pwndTop, NULL, FALSE);
00814                     pwndT2 = pwndTop;
00815                 } <span class="keywordflow">else</span> {
00816 
00817                     <span class="comment">/*</span>
00818 <span class="comment">                     * If window with focus not a dlg ctl, ignore message.</span>
00819 <span class="comment">                     */</span>
00820                     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d9/rtl_2wow_8c.html#a16">_IsChild</a>(pwndTop, pwndT2)) {
00821                         <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndTop);
00822                         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00823                     }
00824                     <span class="comment">/*</span>
00825 <span class="comment">                     * wParam = TRUE for previous, FALSE for next</span>
00826 <span class="comment">                     */</span>
00827                     pwndT1 = <a class="code" href="../../d6/d0/usercli_8h.html#a642">_GetNextDlgTabItem</a>(pwndTop, pwndT2, (wParam != 0));
00828 
00829                     <span class="comment">/*</span>
00830 <span class="comment">                     * If there is no next item, ignore the message.</span>
00831 <span class="comment">                     */</span>
00832                     <span class="keywordflow">if</span> (pwndT1 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00833                         <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndTop);
00834                         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00835                     }
00836                 }
00837             }
00838 
00839             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT1, &amp;tlpwndT1);
00840             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT2, &amp;tlpwndT2);
00841 
00842             <a class="code" href="../../d6/d0/usercli_8h.html#a759">DlgSetFocus</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT1));
00843             <a class="code" href="../../d6/d0/usercli_8h.html#a757">xxxCheckDefPushButton</a>(pwndTop, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT2), <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwndT1));
00844 
00845             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT2);
00846             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT1);
00847             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndTop);
00848 
00849             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00850 
00851         <span class="keywordflow">case</span> WM_ENTERMENULOOP:
00852 
00853             <span class="comment">/*</span>
00854 <span class="comment">             * We need to pop up the combo box window if the user brings</span>
00855 <span class="comment">             * down a menu.</span>
00856 <span class="comment">             *</span>
00857 <span class="comment">             * ...  FALL THROUGH...</span>
00858 <span class="comment">             */</span>
00859 
00860         <span class="keywordflow">case</span> WM_LBUTTONDOWN:
00861         <span class="keywordflow">case</span> WM_NCLBUTTONDOWN:
00862             hwndT1 = <a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>();
00863             <span class="keywordflow">if</span> (hwndT1 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00864                 pwndT1 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a1">ValidateHwndNoRip</a>(hwndT1);
00865 
00866                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a232">GETFNID</a>(pwndT1) == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a201">FNID_COMBOBOX</a>) {
00867 
00868                     <span class="comment">/*</span>
00869 <span class="comment">                     * If user clicks anywhere in dialog box and a combo box (or</span>
00870 <span class="comment">                     * the editcontrol of a combo box) has the focus, then hide</span>
00871 <span class="comment">                     * it's listbox.</span>
00872 <span class="comment">                     */</span>
00873                     <a class="code" href="../../d6/d0/usercli_8h.html#a37">ThreadLockAlways</a>(pwndT1, &amp;tlpwndT1);
00874                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwndT1), CB_SHOWDROPDOWN, FALSE, 0);
00875                     <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT1);
00876 
00877                 } <span class="keywordflow">else</span> {
00878                     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndParent;
00879 
00880                     <span class="comment">/*</span>
00881 <span class="comment">                     * It's a subclassed combo box.  See if the listbox and edit</span>
00882 <span class="comment">                     * boxes exist (this is a very cheezy evaluation - what if</span>
00883 <span class="comment">                     * these controls are subclassed too? NOTE: Not checking</span>
00884 <span class="comment">                     * for EditWndProc: it's a client proc address.</span>
00885 <span class="comment">                     */</span>
00886                     pwndParent = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwndT1, spwndParent);
00887                     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a232">GETFNID</a>(pwndParent) == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a201">FNID_COMBOBOX</a>) {
00888                         pwndT1 = pwndParent;
00889                         <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndT1, &amp;tlpwndT1);
00890                         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwndT1), CB_SHOWDROPDOWN, FALSE, 0);
00891                         <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndT1);
00892                     }
00893                 }
00894             }
00895 
00896             <span class="comment">/*</span>
00897 <span class="comment">             * Always send the message off to DefWndProc</span>
00898 <span class="comment">             */</span>
00899             <span class="keywordflow">goto</span> CallDWP;
00900 
00901         <span class="keywordflow">case</span> WM_GETFONT:
00902             <span class="keywordflow">return</span> (LRESULT)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hUserFont;
00903 
00904         <span class="keywordflow">case</span> WM_VKEYTOITEM:
00905         <span class="keywordflow">case</span> WM_COMPAREITEM:
00906         <span class="keywordflow">case</span> WM_CHARTOITEM:
00907         <span class="keywordflow">case</span> WM_INITDIALOG:
00908 
00909             <span class="comment">/*</span>
00910 <span class="comment">             * We need to return the 0 the app may have returned for these</span>
00911 <span class="comment">             * items instead of calling defwindow proc.</span>
00912 <span class="comment">             */</span>
00913             <span class="keywordflow">return</span> result;
00914 
00915         <span class="keywordflow">case</span> WM_NOTIFYFORMAT:
00916             <span class="keywordflow">if</span> (lParam == NF_QUERY)
00917                 <span class="keywordflow">return</span>((<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;flags &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a794">DLGF_ANSI</a> ) ? NFR_ANSI : NFR_UNICODE);
00918             <span class="keywordflow">return</span> result;
00919 
00920         <span class="keywordflow">case</span> WM_INPUTLANGCHANGEREQUEST:
00921             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>() || <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a128">IS_MIDEAST_ENABLED</a>()) {
00922                 <span class="comment">/*</span>
00923 <span class="comment">                 * #115190</span>
00924 <span class="comment">                 * For dialogbox itself, buttons/static controls on top of</span>
00925 <span class="comment">                 * dialogbox, we'll simply discard this message. B#3843-win95c</span>
00926 <span class="comment">                 */</span>
00927                 <span class="keywordflow">break</span>;
00928             }
00929             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;lpfnDlg == <a class="code" href="../../d6/d4/msgbox_8c.html#a32">MB_DlgProcA</a> ||
00930                     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;lpfnDlg == <a class="code" href="../../d6/d4/msgbox_8c.html#a33">MB_DlgProcW</a>) {
00931                 <span class="keywordflow">break</span>;
00932             }
00933             <span class="keywordflow">goto</span> CallDWP;
00934 
00935         <span class="keywordflow">default</span>:
00936 CallDWP:
00937             <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a610">DefWindowProcWorker</a>(pwnd, message, wParam, lParam, fAnsi);
00938         }
00939     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((message == WM_SHOWWINDOW) &amp;&amp; result) {
00940 
00941         <span class="comment">/*</span>
00942 <span class="comment">         * For a visible-case we want to snap the cursor regardless of</span>
00943 <span class="comment">         * what was returned from the dialog-handler on the client.  If</span>
00944 <span class="comment">         * we're going visible, snap the cursor to the dialog-button.</span>
00945 <span class="comment">         */</span>
00946         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a755">GetParentDialog</a>(pwnd) == pwnd) {
00947 
00948             <span class="keywordflow">if</span> (wParam &amp;&amp; ((LOWORD(lParam) == 0) || !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd)) {
00949 
00950                 <span class="comment">/*</span>
00951 <span class="comment">                 * Snap the cursor to the center of the default button.</span>
00952 <span class="comment">                 * Only do this if the current thread is in the foreground.</span>
00953 <span class="comment">                 * The _ShowCursor() code is added to work around a</span>
00954 <span class="comment">                 * problem with hardware cursors.  If change is done</span>
00955 <span class="comment">                 * in the same refresh cycle, the display of the cursor</span>
00956 <span class="comment">                 * would not reflect the new position.</span>
00957 <span class="comment">                 */</span>
00958                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a368">TEST_PUSIF</a>(PUSIF_SNAPTO) &amp;&amp;
00959                         <a class="code" href="../../d3/d9/dlgmgr_8c.html#a1">IsInForegroundQueue</a>(hwnd)) {
00960                     hwndT1 = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, (<span class="keywordtype">int</span>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;result);
00961                     <span class="keywordflow">if</span> (hwndT1) {
00962                         RECT rc;
00963 
00964                         <a class="code" href="../../d6/d0/usercli_8h.html#a231">NtUserShowCursor</a>(FALSE);
00965 
00966                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a26">GetWindowRect</a>(hwndT1, &amp;rc);
00967                         <a class="code" href="../../d6/d0/usercli_8h.html#a227">NtUserSetCursorPos</a>(rc.left + ((rc.right - rc.left)/2),
00968                                      rc.top + ((rc.bottom - rc.top)/2));
00969 
00970                         <a class="code" href="../../d6/d0/usercli_8h.html#a231">NtUserShowCursor</a>(TRUE);
00971                     }
00972                 }
00973             }
00974         }
00975     }
00976 
00977 
00978     <span class="comment">/*</span>
00979 <span class="comment">     * If this is still marked as a dialog window then return the real</span>
00980 <span class="comment">     * result. Otherwise, we've already processed the WM_NCDESTROY message</span>
00981 <span class="comment">     * and freed our private memory so return the stored value.</span>
00982 <span class="comment">     */</span>
00983     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDIALOGWINDOW))
00984         <span class="keywordflow">return</span> KERNEL_LRESULT_TO_LRESULT(((<a class="code" href="../../d4/d5/struct__DIALOG.html">PDIALOG</a>)pwnd)-&gt;resultWP);
00985     <span class="keywordflow">else</span>
00986         <span class="keywordflow">return</span> result;
00987 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="dlgmgr.c::DialogBox2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR DialogBox2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fDisabled</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fOwnerIsActiveWindow</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01036">1036</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00874">DispatchMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00838">FNID_STATUS_BITS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01265">FWINABLE</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00096">GetCapture()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00506">GetKeyState()</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00026">IsCurrentThreadForeground</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00300">IsDialogMessage</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00024">IsInForegroundQueue</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00354">NotifyWinEvent()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01561">NtUserEnableWindow</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05902">NtUserSetFocus()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01573">NtUserSetForegroundWindow</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02180">NtUserSetWindowPos()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06274">NtUserShowWindow()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07059">NtUserWaitMessage()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02819">PDLG</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00483">PeekMessage()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03387">PostQuitMessage()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00194">RevalidateHwnd</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00885">TranslateMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03608">UpdateWindow()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02266">WFMSGBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02419">WFVISIBLE</a>, and <a class="el" href="../../d2/d0/bench_8c-source.html#l01433">WM_SYSTIMER</a>.
<p>
<pre class="fragment"><div>01041 {
01042     MSG <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
01043     INT_PTR result;
01044     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fShown;
01045     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fWantIdleMsgs;
01046     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSentIdleMessage = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01047     HWND hwndCapture;
01048     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01049 
01050     <span class="keywordflow">if</span> (hwnd) {
01051         pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
01052     } <span class="keywordflow">else</span> {
01053         pwnd = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01054     }
01055 
01056     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
01057 
01058     <span class="keywordflow">if</span> (pwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01059         <span class="keywordflow">if</span> ((hwndOwner != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; !fDisabled &amp;&amp; <a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwndOwner)) {
01060             <a class="code" href="../../d6/d0/usercli_8h.html#a216">NtUserEnableWindow</a>(hwndOwner, TRUE);
01061             <span class="keywordflow">if</span> (fOwnerIsActiveWindow) {
01062 
01063                 <span class="comment">/*</span>
01064 <span class="comment">                 * The dialog box failed but we disabled the owner in</span>
01065 <span class="comment">                 * xxxDialogBoxIndirectParam and if it had the focus, the</span>
01066 <span class="comment">                 * focus was set to NULL.  Now, when we enable the window, it</span>
01067 <span class="comment">                 * doesn't get the focus back if it had it previously so we</span>
01068 <span class="comment">                 * need to correct this.</span>
01069 <span class="comment">                 */</span>
01070                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a225">NtUserSetFocus</a>(hwndOwner);
01071             }
01072         }
01073         <span class="keywordflow">return</span> -1;
01074     }
01075 
01076     hwndCapture = <a class="code" href="../../d3/d8/winmgrc_8c.html#a12">GetCapture</a>();
01077     <span class="keywordflow">if</span> (hwndCapture != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01078         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndCapture, WM_CANCELMODE, 0, 0);
01079     }
01080 
01081     <span class="comment">/*</span>
01082 <span class="comment">     * Set the 'parent disabled' flag for EndDialog().</span>
01083 <span class="comment">     * convert BOOL to definite bit 0 or 1</span>
01084 <span class="comment">     */</span>
01085     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fDisabled = !!fDisabled;
01086 
01087     fShown = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFVISIBLE);
01088 
01089     <span class="comment">/*</span>
01090 <span class="comment">     * Should the WM_ENTERIDLE messages be sent?</span>
01091 <span class="comment">     */</span>
01092     fWantIdleMsgs = !(pwnd-&gt;style &amp; DS_NOIDLEMSG);
01093 
01094     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(SLOWMACHINE) &amp; 1) &amp;&amp; !fShown &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd)
01095         <span class="keywordflow">goto</span> ShowIt;
01096 
01097     <span class="keywordflow">while</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd) &amp;&amp; (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;fEnd)) {
01098         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d9/cltxt_8h.html#a14">PeekMessage</a>(&amp;msg, NULL, 0, 0, PM_REMOVE)) {
01099 ShowIt:
01100             <span class="keywordflow">if</span> (!fShown) {
01101                 fShown = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01102 
01103 <span class="preprocessor">#ifdef SYSMODALWINDOWS</span>
01104 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (pwnd == gspwndSysModal) {
01105                     <span class="comment">/*</span>
01106 <span class="comment">                     * Make this a topmost window</span>
01107 <span class="comment">                     */</span>
01108                     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a115">NtUserSetWindowPos</a>(hwnd, HWND_TOPMOST, 0, 0, 0, 0,
01109                                SWP_NOSIZE | SWP_NOMOVE |
01110                                SWP_NOREDRAW | SWP_NOACTIVATE);
01111                 }
01112 <span class="preprocessor">#endif</span>
01113 <span class="preprocessor"></span>
01114                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a237">NtUserShowWindow</a>(hwnd, SHOW_OPENWINDOW);
01115                 <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>(hwnd);
01116 
01117                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>()) {
01118                     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_SYSTEM_DIALOGSTART, hwnd, OBJID_WINDOW, INDEXID_CONTAINER);
01119                 }
01120             } <span class="keywordflow">else</span> {
01121                 <span class="comment">/*</span>
01122 <span class="comment">                 * Make sure window still exists</span>
01123 <span class="comment">                 */</span>
01124                 <span class="keywordflow">if</span> (hwndOwner &amp;&amp; !<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwndOwner))
01125                     hwndOwner = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01126 
01127                 <span class="keywordflow">if</span> (hwndOwner &amp;&amp; fWantIdleMsgs &amp;&amp; !fSentIdleMessage) {
01128                     fSentIdleMessage = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01129 
01130                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndOwner, WM_ENTERIDLE, MSGF_DIALOGBOX, (LPARAM)hwnd);
01131                 } <span class="keywordflow">else</span> {
01132                     <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (pwnd-&gt;fnid &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a228">FNID_STATUS_BITS</a>))
01133                         <span class="keywordflow">break</span>;
01134 
01135                     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a262">NtUserWaitMessage</a>();
01136                 }
01137             }
01138 
01139         } <span class="keywordflow">else</span> {
01140             <span class="comment">/*</span>
01141 <span class="comment">             * We got a real message.  Reset fSentIdleMessage so that we send</span>
01142 <span class="comment">             * one next time things are calm.</span>
01143 <span class="comment">             */</span>
01144             fSentIdleMessage = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01145 
01146             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_QUIT) {
01147                 <a class="code" href="../../d3/d8/client_8c.html#a122">PostQuitMessage</a>((<span class="keywordtype">int</span>)<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam);
01148                 <span class="keywordflow">break</span>;
01149             }
01150 
01151             <span class="comment">/*</span>
01152 <span class="comment">             * If pwnd is a message box, allow Ctrl-C and Ctrl-Ins</span>
01153 <span class="comment">             * to copy its content to the clipboard.</span>
01154 <span class="comment">             * Fall through in case hooking apps look for these keys.</span>
01155 <span class="comment">             */</span>
01156             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMSGBOX)) {
01157                 <span class="keywordflow">if</span> ( (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_CHAR &amp;&amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam) == 3) ||
01158                      (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_KEYDOWN &amp;&amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam) == VK_INSERT &amp;&amp; <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a16">GetKeyState</a>(VK_CONTROL) &lt; 0)) {
01159                         <span class="comment">/*</span>
01160 <span class="comment">                         * Send the WM_COPY message and let the original message fall through</span>
01161 <span class="comment">                         * as some apps might want it</span>
01162 <span class="comment">                         */</span>
01163                         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, WM_COPY, 0, 0);
01164                 }
01165             }
01166 
01167             <span class="comment">/*</span>
01168 <span class="comment">             * Moved the msg filter hook call to IsDialogMessage to allow</span>
01169 <span class="comment">             * messages to be hooked for both modal and modeless dialog</span>
01170 <span class="comment">             * boxes.</span>
01171 <span class="comment">             */</span>
01172             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d0/user32_8def.html#a39">IsDialogMessage</a>(hwnd, &amp;msg)) {
01173                 <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;msg);
01174                 <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;msg);
01175             }
01176 
01177             <span class="comment">/*</span>
01178 <span class="comment">             * If we get a timer message, go ahead and show the window.</span>
01179 <span class="comment">             * We may continuously get timer msgs if there are zillions of</span>
01180 <span class="comment">             * apps running.</span>
01181 <span class="comment">             *</span>
01182 <span class="comment">             * If we get a syskeydown message, show the dialog box because</span>
01183 <span class="comment">             * the user may be bringing down a menu and we want the dialog</span>
01184 <span class="comment">             * box to become visible.</span>
01185 <span class="comment">             */</span>
01186             <span class="keywordflow">if</span> (!fShown &amp;&amp; (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_TIMER ||
01187                     <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == <a class="code" href="../../d1/d1/bench_8c.html#a4">WM_SYSTIMER</a> || <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_SYSKEYDOWN))
01188                 <span class="keywordflow">goto</span> ShowIt;
01189         }
01190 
01191         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)) {
01192             <span class="comment">/*</span>
01193 <span class="comment">             * Bogus case - we've already been destroyed somehow (by app,</span>
01194 <span class="comment">             * GP, etc.)</span>
01195 <span class="comment">             */</span>
01196             RIPMSG0(RIP_WARNING,
01197                <span class="stringliteral">"Dialog should be dismissed with EndDialog, not DestroyWindow"</span>);
01198             <span class="keywordflow">break</span>;
01199         }
01200     }
01201 
01202     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a405">FWINABLE</a>()) {
01203         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a12">NotifyWinEvent</a>(EVENT_SYSTEM_DIALOGEND, hwnd, OBJID_WINDOW, INDEXID_CONTAINER);
01204     }
01205 
01206     <span class="comment">/*</span>
01207 <span class="comment">     * Make sure the window still exists</span>
01208 <span class="comment">     */</span>
01209     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(hwnd)) {
01210         <span class="keywordflow">return</span> 0;
01211     }
01212 
01213     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd))
01214         result = KERNEL_INT_PTR_TO_INT_PTR(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;result);
01215     <span class="keywordflow">else</span>
01216         result = 0;
01217 
01218     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(hwnd);
01219 
01220     <span class="comment">/*</span>
01221 <span class="comment">     * If the owner window belongs to another thread, the reactivation</span>
01222 <span class="comment">     * of the owner may have failed within DestroyWindow().  Therefore,</span>
01223 <span class="comment">     * if the current thread is in the foreground and the owner is not</span>
01224 <span class="comment">     * in the foreground we can safely set the foreground back</span>
01225 <span class="comment">     * to the owner.</span>
01226 <span class="comment">     */</span>
01227     <span class="keywordflow">if</span> (hwndOwner != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01228         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/dlgmgr_8c.html#a2">IsCurrentThreadForeground</a>() &amp;&amp;
01229             !<a class="code" href="../../d3/d9/dlgmgr_8c.html#a1">IsInForegroundQueue</a>(hwndOwner)) {
01230             <a class="code" href="../../d6/d0/usercli_8h.html#a228">NtUserSetForegroundWindow</a>(hwndOwner);
01231         }
01232     }
01233 
01234     <span class="keywordflow">return</span> result;
01235 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="dlgmgr.c::DlgSetFocus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DlgSetFocus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00152">152</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
<pre class="fragment"><div>00154 {
00155     <span class="keywordflow">if</span> (((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, WM_GETDLGCODE, 0, 0)) &amp; DLGC_HASSETSEL) {
00156         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, EM_SETSEL, 0, MAXLONG);
00157     }
00158 
00159     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a225">NtUserSetFocus</a>(hwnd);
00160 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="dlgmgr.c::GetDlgCtrlID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int GetDlgCtrlID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00163">163</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01764">tagWND::spmenu</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
<pre class="fragment"><div>00165 {
00166     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00167 
00168     pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
00169     <span class="keywordflow">if</span> (pwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00170         <span class="keywordflow">return</span> 0;
00171 
00172     <span class="keywordflow">return</span> PtrToLong(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o16">spmenu</a>);
00173 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="dlgmgr.c::GetDlgItemInt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT GetDlgItemInt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>item</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL FAR *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfValOK</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fSigned</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00320">320</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00017">UNICODE_MINUS_SIGN</a>.
<p>
<pre class="fragment"><div>00325 {
00326     <span class="keywordtype">int</span> i, digit, ch;
00327     <span class="keywordtype">int</span> maxTens, maxUnits;
00328     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fOk, fNeg;
00329     LPWSTR lpch;
00330     WCHAR rgch[48];
00331     WCHAR rgchDigits[48];
00332 
00333     fOk = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00334     <span class="keywordflow">if</span> (lpfValOK != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00335         *lpfValOK = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00336 
00337     <span class="keywordflow">if</span> (!GetDlgItemTextW(hwnd, item, rgch, <span class="keyword">sizeof</span>(rgch)/<span class="keyword">sizeof</span>(WCHAR) - 1))
00338         <span class="keywordflow">return</span> 0;
00339 
00340     lpch = rgch;
00341 
00342     <span class="comment">/*</span>
00343 <span class="comment">     * Skip leading white space.</span>
00344 <span class="comment">     */</span>
00345     <span class="keywordflow">while</span> (*lpch == TEXT(<span class="charliteral">' '</span>))
00346         lpch++;
00347 
00348     fNeg = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00349     <span class="keywordflow">while</span> (fSigned &amp;&amp; ((*lpch == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'-'</span>) || (*lpch == <a class="code" href="../../d3/d9/dlgmgr_8c.html#a0">UNICODE_MINUS_SIGN</a>))) {
00350         lpch++;
00351         fNeg ^= <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00352     }
00353 
00354     <span class="keywordflow">if</span> (fSigned) {
00355         maxTens = INT_MAX/10;
00356         maxUnits = INT_MAX%10;
00357     } <span class="keywordflow">else</span> {
00358         maxTens = UINT_MAX/10;
00359         maxUnits = UINT_MAX%10;
00360     }
00361     <span class="comment">/*</span>
00362 <span class="comment">     * Convert all decimal digits to ASCII Unicode digits 0x0030 - 0x0039</span>
00363 <span class="comment">     */</span>
00364     FoldStringW(MAP_FOLDDIGITS, lpch, -1, rgchDigits,
00365             <span class="keyword">sizeof</span>(rgchDigits)/<span class="keyword">sizeof</span>(rgchDigits[0]));
00366     lpch = rgchDigits;
00367 
00368     i = 0;
00369     <span class="keywordflow">while</span> (ch = *lpch++) {
00370         digit = ch - TEXT(<span class="charliteral">'0'</span>);
00371         <span class="keywordflow">if</span> (digit &lt; 0 || digit &gt; 9) {
00372             <span class="keywordflow">break</span>;
00373         }
00374         <span class="keywordflow">if</span> (i &gt;= maxTens) {
00375             <span class="comment">/*</span>
00376 <span class="comment">             * We need to special case INT_MIN as the i = -i</span>
00377 <span class="comment">             * would damage it</span>
00378 <span class="comment">             */</span>
00379             <span class="keywordflow">if</span> (i == maxTens) {
00380                 <span class="keywordflow">if</span> (digit == maxUnits+1 &amp;&amp; fNeg &amp;&amp; (*lpch) == 0) {
00381                     i = INT_MIN;
00382                     <span class="keywordflow">goto</span> HaveResult;
00383                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit &gt; maxUnits) {
00384                     <span class="keywordflow">return</span> 0;
00385                 }
00386             } <span class="keywordflow">else</span> {
00387                 <span class="keywordflow">return</span> 0;
00388             }
00389         }
00390         fOk = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00391         i = ((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)i * 10) + digit;
00392     }
00393 
00394     <span class="keywordflow">if</span> (fNeg)
00395         i = -i;
00396 HaveResult:
00397     <span class="keywordflow">if</span> (lpfValOK != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00398         *lpfValOK = ((ch == 0) &amp;&amp; fOk);
00399 
00400     <span class="keywordflow">return</span> (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)i;
00401 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="dlgmgr.c::GetParentDialog" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/structtagWND.html">PWND</a> GetParentDialog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwndDialog</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00043">43</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
<pre class="fragment"><div>00044 {
00045     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>    pwndParent;
00046 
00047     pwndParent = pwndDialog;
00048 
00049     <span class="comment">//</span>
00050     <span class="comment">// Walk up the parent chain.  We're looking for the top-most dialog</span>
00051     <span class="comment">// window.  Most cases, the window is a top level one.  But in case of</span>
00052     <span class="comment">// backup app, the window will be a child of some other window.</span>
00053     <span class="comment">//</span>
00054     <span class="keywordflow">for</span> (; pwndDialog; pwndDialog = <a class="code" href="../../d6/d0/usercli_8h.html#a27">REBASEPWND</a>(pwndDialog, spwndParent))
00055     {
00056         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndDialog, WFDIALOGWINDOW))
00057         {
00058             <span class="comment">//</span>
00059             <span class="comment">// For old guys:  If not DS_RECURSE, then stop here.</span>
00060             <span class="comment">// that way old apps which try to do the nested dialog</span>
00061             <span class="comment">// stuff in their old limited way don't die.</span>
00062             <span class="comment">//</span>
00063             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndDialog, WEFCONTROLPARENT))
00064                 pwndParent = pwndDialog;
00065             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndDialog, DFCONTROL))
00066                 <span class="keywordflow">break</span>;
00067         }
00068 
00069         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndDialog, WFCHILD))
00070             <span class="keywordflow">break</span>;
00071     }
00072 
00073     <span class="keywordflow">return</span>(pwndParent);
00074 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="dlgmgr.c::InternalDialogBox" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR InternalDialogBox           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDLGTEMPLATE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>pfnDialog</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>fSCDLGFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01246">1246</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
<pre class="fragment"><div>01253 {
01254     INT_PTR i;
01255     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fDisabled;
01256     HWND hwnd;
01257     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndOwner;
01258     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fOwnerIsActiveWindow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01259     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwndOwner;
01260     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fUnlockOwner;
01261 
01262     UserAssert(!(fSCDLGFlags &amp; ~(SCDLG_CLIENT|SCDLG_ANSI|SCDLG_16BIT)));    <span class="comment">// These are the only valid flags</span>
01263 
01264     <span class="comment">/*</span>
01265 <span class="comment">     * If hwndOwner == HWNDESKTOP, change it to NULL.  This way the desktop</span>
01266 <span class="comment">     * (and all its children) won't be disabled if the dialog is modal.</span>
01267 <span class="comment">     */</span>
01268     <span class="keywordflow">if</span> (hwndOwner &amp;&amp; <a class="code" href="../../d6/d0/usercli_8h.html#a15">SAMEWOWHANDLE</a>(hwndOwner, <a class="code" href="../../d3/d9/client_2wow_8c.html#a4">GetDesktopWindow</a>()))
01269         hwndOwner = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01270 
01271     <span class="comment">/*</span>
01272 <span class="comment">     * We return 0 if the ValidateHwnd fails in order to match Win 3.1</span>
01273 <span class="comment">     * validation layer which always returns 0 for invalid hwnds even</span>
01274 <span class="comment">     * if the function is spec'ed to return -1.  Autocad setup bug #3615</span>
01275 <span class="comment">     */</span>
01276     <span class="keywordflow">if</span> (hwndOwner) {
01277         <span class="keywordflow">if</span> ((pwndOwner = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwndOwner)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01278             <span class="keywordflow">return</span> (0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
01279         }
01280     } <span class="keywordflow">else</span> {
01281         pwndOwner = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01282     }
01283 
01284     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwndOwner);
01285 
01286     fUnlockOwner = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01287     <span class="keywordflow">if</span> (pwndOwner != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01288 
01289         <span class="comment">/* The following fixes an AV in Corel Photo-Paint 6.0.  It passes a</span>
01290 <span class="comment">         * 16-bit HWND in, and croaks at some point when it gets 16-bit hwnds</span>
01291 <span class="comment">         * back in send messages. FritzS -- fixing bug 12531</span>
01292 <span class="comment">         */</span>
01293         hwndOwner = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a449">PtoHq</a>(pwndOwner);
01294 
01295         <span class="comment">/*</span>
01296 <span class="comment">         * Make sure the owner is a top level window.</span>
01297 <span class="comment">         */</span>
01298         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a735">TestwndChild</a>(pwndOwner)) {
01299             pwndOwner = <a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a11">GetTopLevelWindow</a>(pwndOwner);
01300             hwndOwner = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwndOwner);
01301             <a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwndOwner, &amp;tlpwndOwner);
01302             fUnlockOwner = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01303         }
01304 
01305         <span class="comment">/*</span>
01306 <span class="comment">         * Remember if window was originally disabled (so we can set</span>
01307 <span class="comment">         * the correct state when the dialog goes away.</span>
01308 <span class="comment">         */</span>
01309         fDisabled = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwndOwner, WFDISABLED);
01310         fOwnerIsActiveWindow = (<a class="code" href="../../d6/d0/usercli_8h.html#a15">SAMEWOWHANDLE</a>(hwndOwner, <a class="code" href="../../d3/d8/winmgrc_8c.html#a22">GetActiveWindow</a>()));
01311 
01312         <span class="comment">/*</span>
01313 <span class="comment">         * Disable the window.</span>
01314 <span class="comment">         */</span>
01315         <a class="code" href="../../d6/d0/usercli_8h.html#a216">NtUserEnableWindow</a>(hwndOwner, FALSE);
01316     }
01317 
01318     <span class="comment">/*</span>
01319 <span class="comment">     * Don't show cursors on a mouseless system. Put up an hour glass while</span>
01320 <span class="comment">     * the dialog comes up.</span>
01321 <span class="comment">     */</span>
01322     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(MOUSEPRESENT)) {
01323         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a224">NtUserSetCursor</a>(LoadCursor(NULL, IDC_WAIT));
01324     }
01325 
01326     <span class="comment">/*</span>
01327 <span class="comment">     * Creates the dialog.  Frees the menu if this routine fails.</span>
01328 <span class="comment">     */</span>
01329     hwnd = <a class="code" href="../../d6/d0/usercli_8h.html#a750">InternalCreateDialog</a>(hModule, lpdt, 0, hwndOwner,
01330             pfnDialog, lParam, fSCDLGFlags);
01331 
01332     <span class="keywordflow">if</span> (hwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01333 
01334         <span class="comment">/*</span>
01335 <span class="comment">         * The dialog creation failed.  Re-enable the window, destroy the</span>
01336 <span class="comment">         * menu, ie., fail gracefully.</span>
01337 <span class="comment">         */</span>
01338         <span class="keywordflow">if</span> (!fDisabled &amp;&amp; hwndOwner != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01339             <a class="code" href="../../d6/d0/usercli_8h.html#a216">NtUserEnableWindow</a>(hwndOwner, TRUE);
01340 
01341         <span class="keywordflow">if</span> (fUnlockOwner)
01342             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndOwner);
01343         <span class="keywordflow">return</span> -1;
01344     }
01345 
01346     i = <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a22">DialogBox2</a>(hwnd, hwndOwner, fDisabled, fOwnerIsActiveWindow);
01347 
01348     <span class="keywordflow">if</span> (fUnlockOwner)
01349         <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwndOwner);
01350     <span class="keywordflow">return</span> i;
01351 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="dlgmgr.c::IsDlgButtonChecked" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT IsDlgButtonChecked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00442">442</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
<pre class="fragment"><div>00445 {
00446     <span class="keywordflow">if</span> ((hwnd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, <span class="keywordtype">id</span>)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00447         <span class="keywordflow">return</span> (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, BM_GETCHECK, 0, 0);
00448     }
00449 
00450     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00451 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="dlgmgr.c::MapDialogRect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL MapDialogRect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01418">1418</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00192">ValidateDialogPwnd()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02988">XPixFromXDU</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02989">YPixFromYDU</a>.
<p>
<pre class="fragment"><div>01421 {
01422     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
01423 
01424     <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01425         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01426     }
01427 
01428     <span class="comment">/*</span>
01429 <span class="comment">     * Must do special validation here to make sure pwnd is a dialog window.</span>
01430 <span class="comment">     */</span>
01431     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a761">ValidateDialogPwnd</a>(pwnd))
01432         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01433 
01434     lprc-&gt;left = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(lprc-&gt;left, <a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a>(pwnd)-&gt;cxChar);
01435     lprc-&gt;right = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a852">XPixFromXDU</a>(lprc-&gt;right, <a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a>(pwnd)-&gt;cxChar);
01436     lprc-&gt;top = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(lprc-&gt;top, <a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a>(pwnd)-&gt;cyChar);
01437     lprc-&gt;bottom = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a853">YPixFromYDU</a>(lprc-&gt;bottom, <a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a>(pwnd)-&gt;cyChar);
01438 
01439     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01440 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="dlgmgr.c::RepositionRect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RepositionRect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pMonitor</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwStyle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwExStyle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01363">1363</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
<pre class="fragment"><div>01368 {
01369     LPRECT      lprcClip;
01370     <span class="keywordtype">int</span>         y;
01371 
01372     UserAssert(lprc);
01373     UserAssert(pMonitor);
01374 
01375     <span class="keywordflow">if</span> (dwStyle &amp; WS_CHILD) {
01376         <span class="keywordflow">if</span> (dwExStyle &amp; WS_EX_CONTROLPARENT)
01377             <span class="keywordflow">return</span>;
01378 
01379         <span class="comment">/*</span>
01380 <span class="comment">         * Old style 3.1 child dialogs--do this nonsense anyway.  Keeps</span>
01381 <span class="comment">         * FedEx happy.</span>
01382 <span class="comment">         */</span>
01383         pMonitor = <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
01384         lprcClip = &amp;pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>;
01385     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dwExStyle &amp; WS_EX_TOOLWINDOW) {
01386         lprcClip = &amp;pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>;
01387     } <span class="keywordflow">else</span> {
01388         lprcClip = &amp;pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o4">rcWork</a>;
01389     }
01390 
01391     UserAssert(lprc);
01392 
01393     y = lprcClip-&gt;bottom - (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE) * 2 + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYKANJIWINDOW));
01394 
01395     <span class="keywordflow">if</span> (lprc-&gt;bottom &gt; y) {
01396         <a class="code" href="../../d3/d6/rect_8c.html#a6">OffsetRect</a>(lprc, 0, y - lprc-&gt;bottom);
01397     }
01398 
01399     <span class="keywordflow">if</span> (lprc-&gt;top &lt; lprcClip-&gt;top) {
01400         <a class="code" href="../../d3/d6/rect_8c.html#a6">OffsetRect</a>(lprc, 0, lprcClip-&gt;top - lprc-&gt;top);
01401     }
01402 
01403     <span class="keywordflow">if</span> (lprc-&gt;right &gt; lprcClip-&gt;right) {
01404         <a class="code" href="../../d3/d6/rect_8c.html#a6">OffsetRect</a>(lprc, lprcClip-&gt;right - lprc-&gt;right, 0);
01405     }
01406 
01407     <span class="keywordflow">if</span> (lprc-&gt;left &lt; lprcClip-&gt;left) {
01408         <a class="code" href="../../d3/d6/rect_8c.html#a6">OffsetRect</a>(lprc, lprcClip-&gt;left - lprc-&gt;left, 0);
01409     }
01410 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="dlgmgr.c::SetDlgItemInt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SetDlgItemInt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>item</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>u</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fSigned</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00265">265</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/nt6_2dlgmgr_8c-source.html#l00252">CvtDec()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
<pre class="fragment"><div>00270 {
00271     LPWSTR lpch;
00272     WCHAR rgch[16];
00273 
00274     lpch = rgch;
00275     <span class="keywordflow">if</span> (fSigned) {
00276         <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)u &lt; 0) {
00277             *lpch++ = TEXT(<span class="charliteral">'-'</span>);
00278             u = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(-(<span class="keywordtype">int</span>)u);
00279         }
00280     } <span class="keywordflow">else</span> {
00281         <span class="keywordflow">if</span> (u &amp; 0x80000000) {
00282             <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a13">CvtDec</a>(u / 10, (LPWSTR FAR *)&amp;lpch);
00283             u = u % 10;
00284         }
00285     }
00286 
00287     <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a13">CvtDec</a>(u, (LPWSTR FAR *)&amp;lpch);
00288     *lpch = 0;
00289 
00290     <span class="keywordflow">return</span> SetDlgItemTextW(hwnd, item, rgch);
00291 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="dlgmgr.c::ValidateCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>h</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="dlgmgr.c::ValidateDialogPwnd" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateDialogPwnd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00192">192</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
<pre class="fragment"><div>00194 {
00195     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> sfInit = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00196     <a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a> pdlg;
00197 
00198     <span class="comment">/*</span>
00199 <span class="comment">     * This bit is set if we've already run through this initialization and</span>
00200 <span class="comment">     * have identified this window as a dialog window (able to withstand</span>
00201 <span class="comment">     * peeks into window words at random moments in time).</span>
00202 <span class="comment">     */</span>
00203     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFDIALOGWINDOW))
00204         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00205 
00206     <span class="keywordflow">if</span> (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o10">cbwndExtra</a> &lt; DLGWINDOWEXTRA) {
00207         RIPERR0(ERROR_WINDOW_NOT_DIALOG, RIP_VERBOSE, <span class="stringliteral">""</span>);
00208         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00209     }
00210 
00211     <span class="comment">/*</span>
00212 <span class="comment">     * See if the pdlg was destroyed and this is a rogue message to be ignored</span>
00213 <span class="comment">     */</span>
00214     <span class="keywordflow">if</span> (pwnd-&gt;fnid &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a228">FNID_STATUS_BITS</a>) {
00215         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00216     }
00217 
00218     <span class="comment">/*</span>
00219 <span class="comment">     * If the lookaside buffer has not been initialized, do it now.</span>
00220 <span class="comment">     */</span>
00221     <span class="keywordflow">if</span> (sfInit) {
00222         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a406">InitLookaside</a>(&amp;DialogLookaside, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__DLG.html">DLG</a>), 2))) {
00223             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00224         }
00225         sfInit = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00226     }
00227 
00228     <span class="keywordflow">if</span> ((pdlg = (<a class="code" href="../../d2/d6/struct__DLG.html">PDLG</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a407">AllocLookasideEntry</a>(&amp;DialogLookaside)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00229         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00230     }
00231 
00232     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a178">NtUserCallHwndParam</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), (ULONG_PTR)pdlg, SFI_SETDIALOGPOINTER);
00233 
00234     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00235 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="dlgmgr.c::xxxRestoreDlgFocus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxRestoreDlgFocus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00110">110</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00090">GetFocus()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00591">IS_IME_ENABLED</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05902">NtUserSetFocus()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02819">PDLG</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02555">TestWF</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00192">ValidateDialogPwnd()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02420">WFMINIMIZED</a>, and <a class="el" href="../../d6/d8/dlgmgr2_8c-source.html#l00084">xxxCheckDefPushButton()</a>.
<p>
<pre class="fragment"><div>00112 {
00113     HWND hwndFocus;
00114     HWND hwndFocusSave;
00115     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRestored = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00116 
00117     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00118 
00119     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hwndFocusSave &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMINIMIZED)) {
00120 
00121         hwndFocus = <a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>();
00122         hwndFocusSave = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hwndFocusSave;
00123 
00124         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hwndFocusSave)) {
00125             <a class="code" href="../../d6/d0/usercli_8h.html#a757">xxxCheckDefPushButton</a>(pwnd, hwndFocus, hwndFocusSave);
00126             fRestored = (<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a225">NtUserSetFocus</a>(hwndFocusSave) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00127 <span class="preprocessor">#ifdef FE_IME</span>
00128 <span class="preprocessor"></span>            <span class="comment">//</span>
00129             <span class="comment">// after calling SetFocus(), we need to re-validate</span>
00130             <span class="comment">// the window. PDLG(pwnd) might be NULL. This can</span>
00131             <span class="comment">// be happened in FE environment where IME window</span>
00132             <span class="comment">// exist. (kkntbug #12613)</span>
00133             <span class="comment">//</span>
00134             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>() &amp;&amp; !<a class="code" href="../../d6/d0/usercli_8h.html#a761">ValidateDialogPwnd</a>(pwnd)) {
00135                 <span class="keywordflow">return</span> fRestored;
00136         }
00137 <span class="preprocessor">#endif</span>
00138 <span class="preprocessor"></span>        }
00139         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hwndFocusSave = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00140     }
00141 
00142     <span class="keywordflow">return</span> fRestored;
00143 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="dlgmgr.c::xxxSaveDlgFocus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxSaveDlgFocus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00083">83</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00090">GetFocus()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00508">IsChild()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02819">PDLG</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>, and <a class="el" href="../../d6/d8/dlgmgr2_8c-source.html#l00031">xxxRemoveDefaultButton()</a>.
<p>
<pre class="fragment"><div>00085 {
00086     HWND hwndFocus = <a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>();
00087 
00088     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00089 
00090     <span class="keywordflow">if</span> (hwndFocus != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; <a class="code" href="../../d3/d9/client_2wow_8c.html#a18">IsChild</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd), hwndFocus) &amp;&amp;
00091             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hwndFocusSave == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00092         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a793">PDLG</a>(pwnd)-&gt;hwndFocusSave = hwndFocus;
00093         <a class="code" href="../../d6/d0/usercli_8h.html#a756">xxxRemoveDefaultButton</a>(pwnd, <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwndFocus));
00094         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00095     }
00096     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00097 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a3" doxytag="dlgmgr.c::DialogLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d4/struct__LOOKASIDE.html">LOOKASIDE</a> <a class="el" href="../../d4/d9/nt6_2dlgmgr_8c.html#a3">DialogLookaside</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00020">20</a> of file <a class="el" href="../../d4/d8/dlgmgr_8c-source.html">dlgmgr.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, and <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00192">ValidateDialogPwnd()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:28 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
