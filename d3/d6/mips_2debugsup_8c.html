<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mips/debugsup.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>debugsup.c File Reference</h1><code>#include "<a class="el" href="../../d5/d7/mi_8h-source.html">mi.h</a>"</code><br>

<p>
<a href="../../d4/d5/mips_2debugsup_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/mips_2debugsup_8c.html#a0">MmDbgReadCheck</a> (IN PVOID VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/mips_2debugsup_8c.html#a1">MmDbgWriteCheck</a> (IN PVOID VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID64&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/mips_2debugsup_8c.html#a2">MmDbgReadCheck64</a> (IN PVOID64 VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID64&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/mips_2debugsup_8c.html#a3">MmDbgWriteCheck64</a> (IN PVOID64 VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/mips_2debugsup_8c.html#a4">MmDbgTranslatePhysicalAddress</a> (IN PHYSICAL_ADDRESS PhysicalAddress)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="mips/debugsup.c::MmDbgReadCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID MmDbgReadCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>VirtualAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html#l00025">25</a> of file <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html">mips/debugsup.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00591">KSEG0_BASE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00593">KSEG2_BASE</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03883">MmIsAddressValid()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00031                    :
00032 
00033     MIPS implementation specific:
00034 
00035     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">virtual</span> address which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid (mapped)
00036     for read access.
00037 
00038     If the address is valid and readable and not within KSEG0 or KSEG1
00039     the physical address within KSEG0 is returned.  If the adddress
00040     is within KSEG0 or KSEG1 then the called address is returned.
00041 
00042 Arguments:
00043 
00044     VirtualAddress - Supplies the virtual address to check.
00045 
00046 Return Value:
00047 
00048     Returns NULL if the address is not valid or readable, otherwise
00049     returns the physical address of the corresponding virtual address.
00050 
00051 Environment:
00052 
00053     Kernel mode IRQL at DISPATCH_LEVEL or greater.
00054 
00055 --*/
00056 
00057 {
00058     <span class="keywordflow">if</span> ((VirtualAddress &gt;= (PVOID)<a class="code" href="../../d6/d7/halmips_8h.html#a443">KSEG0_BASE</a>) &amp;&amp;
00059         (VirtualAddress &lt; (PVOID)<a class="code" href="../../d6/d7/halmips_8h.html#a445">KSEG2_BASE</a>)) {
00060         <span class="keywordflow">return</span> VirtualAddress;
00061     }
00062 
00063     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a> (VirtualAddress)) {
00064         <span class="keywordflow">if</span> (KiProbeEntryTb(VirtualAddress)) {
00065             <span class="keywordflow">return</span> VirtualAddress;
00066         }
00067         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00068     }
00069 
00070     <span class="keywordflow">return</span> VirtualAddress;
00071 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="mips/debugsup.c::MmDbgReadCheck64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID64 MmDbgReadCheck64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID64&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>VirtualAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html#l00141">141</a> of file <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html">mips/debugsup.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00147                    :
00148 
00149     MIPS implementation specific:
00150 
00151     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">virtual</span> address which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid (mapped)
00152     for read access.
00153 
00154     If the address is valid and readable and not within KSEG0 or KSEG1
00155     the physical address within KSEG0 is returned.  If the adddress
00156     is within KSEG0 or KSEG1 then the called address is returned.
00157 
00158 Arguments:
00159 
00160     VirtualAddress - Supplies the virtual address to check.
00161 
00162 Return Value:
00163 
00164     Returns NULL if the address is not valid or readable, otherwise
00165     returns the physical address of the corresponding virtual address.
00166 
00167 Environment:
00168 
00169     Kernel mode IRQL at DISPATCH_LEVEL or greater.
00170 
00171 --*/
00172 
00173 {
00174 
00175 <span class="preprocessor">#ifdef VLM_SUPPORT</span>
00176 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!MmIsAddressValid64 (VirtualAddress)) {
00177         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00178     }
00179 
00180     <span class="keywordflow">return</span> VirtualAddress;
00181 <span class="preprocessor">#else</span>
00182 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00183 <span class="preprocessor">#endif</span>
00184 <span class="preprocessor"></span>}

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mips/debugsup.c::MmDbgTranslatePhysicalAddress" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID MmDbgTranslatePhysicalAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PHYSICAL_ADDRESS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PhysicalAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html#l00245">245</a> of file <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html">mips/debugsup.c</a>.
<p>
References <a class="el" href="../../d3/d0/mm_8h-source.html#l00166">BYTE_OFFSET</a>, <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, <a class="el" href="../../d5/d7/mi_8h-source.html#l00769">MI_PFN_ELEMENT</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l01842">MiGetVirtualAddressMappedByPte</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l00315">MM_COLOR_MASK</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l00309">MM_NUMBER_OF_COLORS</a>, <a class="el" href="../../d5/d1/datalpha_8c-source.html#l00099">MmDebugPte</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00044">MmHighestPhysicalPage</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03883">MmIsAddressValid()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00043">MmLowestPhysicalPage</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00600">PAGE_SHIFT</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l00282">PTE_SHIFT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d4/struct__MMPTE.html#o8">_MMPTE::u</a>, <a class="el" href="../../d4/d3/struct__MMPFN.html#o15">_MMPFN::u3</a>, and <a class="el" href="../../d5/d1/datalpha_8c-source.html#l00038">ValidKernelPte</a>.
<p>
<pre class="fragment"><div>00251                    :
00252 
00253     MIPS implementation specific:
00254 
00255     This routine maps <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified physical address and returns
00256     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">virtual</span> address which maps <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> physical address.
00257 
00258     The next call to MmDbgTranslatePhyiscalAddress removes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00259     previous phyiscal address <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a>, hence on a single
00260     physical address can be examined at a time (can't cross page
00261     boundaries).
00262 
00263 Arguments:
00264 
00265     PhysicalAddress - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> phyiscal address to map and translate.
00266 
00267 Return Value:
00268 
00269     The <span class="keyword">virtual</span> address which corresponds to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> phyiscal address.
00270 
00271     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> physical address was bogus.
00272 
00273 Environment:
00274 
00275     Kernel mode IRQL at <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a> or greater.
00276 
00277 --*/
00278 
00279 {
00280     PVOID BaseAddress;
00281     <a class="code" href="../../d2/d4/struct__MMPTE.html">PMMPTE</a> BasePte;
00282     <a class="code" href="../../d4/d3/struct__MMPFN.html">PMMPFN</a> Pfn1;
00283     ULONG Page;
00284 
00285     BasePte = <a class="code" href="../../d4/d2/datalpha_8c.html#a18">MmDebugPte</a> + (<a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a56">MM_NUMBER_OF_COLORS</a> - 1);
00286     BasePte = (<a class="code" href="../../d2/d4/struct__MMPTE.html">PMMPTE</a>)((ULONG)BasePte &amp; ~(<a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a57">MM_COLOR_MASK</a> &lt;&lt; <a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a52">PTE_SHIFT</a>));
00287 
00288     Page = (ULONG)(PhysicalAddress.QuadPart &gt;&gt; <a class="code" href="../../d6/d7/halmips_8h.html#a447">PAGE_SHIFT</a>);
00289 
00290     <span class="keywordflow">if</span> ((Page &gt; (LONGLONG)<a class="code" href="../../d6/d8/sysinfo_8c.html#a7">MmHighestPhysicalPage</a>) ||
00291         (Page &lt; (LONGLONG)<a class="code" href="../../d6/d8/sysinfo_8c.html#a6">MmLowestPhysicalPage</a>)) {
00292         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00293     }
00294 
00295     Pfn1 = <a class="code" href="../../d4/d8/mi_8h.html#a111">MI_PFN_ELEMENT</a> (Page);
00296 
00297     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a> (Pfn1)) {
00298         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00299     }
00300 
00301     BasePte = BasePte + Pfn1-&gt;<a class="code" href="../../d4/d3/struct__MMPFN.html#o15">u3</a>.e1.PageColor;
00302 
00303     BaseAddress = <a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a161">MiGetVirtualAddressMappedByPte</a> (BasePte);
00304 
00305     <a class="code" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb</a> (TRUE, BaseAddress);
00306 
00307     *BasePte = <a class="code" href="../../d4/d2/datalpha_8c.html#a2">ValidKernelPte</a>;
00308     BasePte-&gt;<a class="code" href="../../d2/d4/struct__MMPTE.html#o8">u</a>.Hard.PageFrameNumber = Page;
00309     <span class="keywordflow">return</span> (PVOID)((ULONG)BaseAddress + <a class="code" href="../../d2/d1/mm_8h.html#a6">BYTE_OFFSET</a>(PhysicalAddress.LowPart));
00310 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="mips/debugsup.c::MmDbgWriteCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID MmDbgWriteCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>VirtualAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html#l00074">74</a> of file <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html">mips/debugsup.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00591">KSEG0_BASE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00593">KSEG2_BASE</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l01671">MiGetPteAddress</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03883">MmIsAddressValid()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d4/struct__MMPTE.html#o8">_MMPTE::u</a>.
<p>
<pre class="fragment"><div>00080                    :
00081 
00082     MIPS implementation specific:
00083 
00084     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> phyiscal address <span class="keywordflow">for</span> a <span class="keyword">virtual</span> address
00085     which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid (mapped) for write access.
00086 
00087     If the address is valid and writable and not within KSEG0 or KSEG1
00088     the physical address within KSEG0 is returned.  If the adddress
00089     is within KSEG0 or KSEG1 then the called address is returned.
00090 
00091     NOTE: The physical address is must only be used while the interrupt
00092     level on ALL processors is above DISPATCH_LEVEL, otherwise the
00093     binding between the virtual address and the physical address can
00094     change due to paging.
00095 
00096 Arguments:
00097 
00098     VirtualAddress - Supplies the virtual address to check.
00099 
00100 Return Value:
00101 
00102     Returns NULL if the address is not valid or readable, otherwise
00103     returns the physical address of the corresponding virtual address.
00104 
00105 Environment:
00106 
00107     Kernel mode IRQL at DISPATCH_LEVEL or greater.
00108 
00109 --*/
00110 
00111 {
00112     <a class="code" href="../../d2/d4/struct__MMPTE.html">PMMPTE</a> PointerPte;
00113 
00114     <span class="keywordflow">if</span> ((VirtualAddress &gt;= (PVOID)<a class="code" href="../../d6/d7/halmips_8h.html#a443">KSEG0_BASE</a>) &amp;&amp;
00115         (VirtualAddress &lt; (PVOID)<a class="code" href="../../d6/d7/halmips_8h.html#a445">KSEG2_BASE</a>)) {
00116         <span class="keywordflow">return</span> VirtualAddress;
00117     }
00118 
00119     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a> (VirtualAddress)) {
00120 
00121         <span class="comment">//</span>
00122         <span class="comment">// need to check write</span>
00123         <span class="comment">//</span>
00124 
00125         <span class="keywordflow">if</span> (KiProbeEntryTb(VirtualAddress)) {
00126             <span class="keywordflow">return</span> VirtualAddress;
00127         }
00128         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00129     }
00130 
00131     PointerPte = <a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a153">MiGetPteAddress</a> (VirtualAddress);
00132 
00133     <span class="keywordflow">if</span> ((ULONG) VirtualAddress &lt; <a class="code" href="../../d6/d7/halmips_8h.html#a443">KSEG0_BASE</a> &amp;&amp; PointerPte-&gt;<a class="code" href="../../d2/d4/struct__MMPTE.html#o8">u</a>.Hard.Dirty == 0) {
00134         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00135     }
00136 
00137     <span class="keywordflow">return</span> VirtualAddress;
00138 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="mips/debugsup.c::MmDbgWriteCheck64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID64 MmDbgWriteCheck64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID64&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>VirtualAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html#l00187">187</a> of file <a class="el" href="../../d4/d5/mips_2debugsup_8c-source.html">mips/debugsup.c</a>.
<p>
References <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l01674">MiGetPteAddress64</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d4/struct__MMPTE.html#o8">_MMPTE::u</a>.
<p>
<pre class="fragment"><div>00193                    :
00194 
00195     MIPS implementation specific:
00196 
00197     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> phyiscal address <span class="keywordflow">for</span> a <span class="keyword">virtual</span> address
00198     which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid (mapped) for write access.
00199 
00200     If the address is valid and writable and not within KSEG0 or KSEG1
00201     the physical address within KSEG0 is returned.  If the adddress
00202     is within KSEG0 or KSEG1 then the called address is returned.
00203 
00204     NOTE: The physical address is must only be used while the interrupt
00205     level on ALL processors is above DISPATCH_LEVEL, otherwise the
00206     binding between the virtual address and the physical address can
00207     change due to paging.
00208 
00209 Arguments:
00210 
00211     VirtualAddress - Supplies the virtual address to check.
00212 
00213 Return Value:
00214 
00215     Returns NULL if the address is not valid or readable, otherwise
00216     returns the physical address of the corresponding virtual address.
00217 
00218 Environment:
00219 
00220     Kernel mode IRQL at DISPATCH_LEVEL or greater.
00221 
00222 --*/
00223 
00224 {
00225 <span class="preprocessor">#ifdef VLM_SUPPORT</span>
00226 <span class="preprocessor"></span>    <a class="code" href="../../d2/d4/struct__MMPTE.html">PMMPTE</a> PointerPte;
00227 
00228     <span class="keywordflow">if</span> (!MmIsAddressValid64 (VirtualAddress)) {
00229         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00230     }
00231 
00232     PointerPte = <a class="code" href="../../d8/d8/alpha_2mialpha_8h.html#a154">MiGetPteAddress64</a> (VirtualAddress);
00233 
00234     <span class="keywordflow">if</span> (PointerPte-&gt;<a class="code" href="../../d2/d4/struct__MMPTE.html#o8">u</a>.Hard.Dirty == 0) {
00235         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00236     }
00237 
00238     <span class="keywordflow">return</span> VirtualAddress;
00239 <span class="preprocessor">#else</span>
00240 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00241 <span class="preprocessor">#endif</span>
00242 <span class="preprocessor"></span>}

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:25 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
