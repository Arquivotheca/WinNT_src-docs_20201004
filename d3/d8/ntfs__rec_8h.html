<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ntfs_rec.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ntfs_rec.h File Reference</h1>
<p>
<a href="../../d4/d7/ntfs__rec_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">_PACKED_BIOS_PARAMETER_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">_PACKED_BOOT_SECTOR</a></td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a0">LCN</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a0">LCN</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a1">PLCN</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a2">VCN</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a2">VCN</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a3">PVCN</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a4">LBO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a4">LBO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a5">PLBO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a6">VBO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a6">VBO</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a7">PVBO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">_PACKED_BIOS_PARAMETER_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a8">PACKED_BIOS_PARAMETER_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a9">PPACKED_BIOS_PARAMETER_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">_PACKED_BOOT_SECTOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a10">PACKED_BOOT_SECTOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PACKED_BOOT_SECTOR</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a11">PPACKED_BOOT_SECTOR</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/ntfs__rec_8h.html#a12">IsNtfsVolume</a> (IN <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PPACKED_BOOT_SECTOR</a> BootSector, IN ULONG BytesPerSector, IN PLARGE_INTEGER NumberOfSectors)</td></tr>

</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a4" doxytag="ntfs_rec.h::LBO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LARGE_INTEGER <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a4">LBO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00042">42</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ntfs_rec.h::LCN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LARGE_INTEGER <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a0">LCN</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00036">36</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ntfs_rec.h::PACKED_BIOS_PARAMETER_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">_PACKED_BIOS_PARAMETER_BLOCK</a>  <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ntfs_rec.h::PACKED_BOOT_SECTOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">_PACKED_BOOT_SECTOR</a>  <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PACKED_BOOT_SECTOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ntfs_rec.h::PLBO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a4">LBO</a>* <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a5">PLBO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00043">43</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ntfs_rec.h::PLCN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a0">LCN</a>* <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a1">PLCN</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00037">37</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ntfs_rec.h::PPACKED_BIOS_PARAMETER_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a>* <a class="el" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PPACKED_BIOS_PARAMETER_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00090">90</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ntfs_rec.h::PPACKED_BOOT_SECTOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PACKED_BOOT_SECTOR</a>* <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PPACKED_BOOT_SECTOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00123">123</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ntfs_rec.h::PVBO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a6">VBO</a>* <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a7">PVBO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00046">46</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ntfs_rec.h::PVCN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a2">VCN</a>* <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a3">PVCN</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00040">40</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ntfs_rec.h::VBO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LARGE_INTEGER <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a6">VBO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00045">45</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ntfs_rec.h::VCN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LARGE_INTEGER <a class="el" href="../../d3/d8/ntfs__rec_8h.html#a2">VCN</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html#l00039">39</a> of file <a class="el" href="../../d4/d7/ntfs__rec_8h-source.html">ntfs_rec.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a12" doxytag="ntfs_rec.h::IsNtfsVolume" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IsNtfsVolume           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PPACKED_BOOT_SECTOR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>BootSector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BytesPerSector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfSectors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/ntfs__rec_8c-source.html#l00190">190</a> of file <a class="el" href="../../d3/d7/ntfs__rec_8c-source.html">ntfs_rec.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/ntfs__rec_8c-source.html#l00042">NtfsRecFsControl()</a>.
<p>
<pre class="fragment"><div>00198                    :
00199 
00200     This routine looks at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer passed in which contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> NTFS boot
00201     sector and determines whether or not <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> represents an NTFS volume.
00202 
00203 Arguments:
00204 
00205     BootSector - Pointer to buffer containing a potential NTFS boot sector.
00206 
00207     BytesPerSector - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes per sector <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> drive.
00208 
00209     NumberOfSectors - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of sectors on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> partition.
00210 
00211 Return Value:
00212 
00213     The function returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer contains a recognizable NTFS boot
00214     sector, otherwise <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> returns <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.
00215 
00216 --*/
00217 
00218 {
00219     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00220 
00221     <span class="comment">//</span>
00222     <span class="comment">// Now perform all the checks, starting with the Name and Checksum.</span>
00223     <span class="comment">// The remaining checks should be obvious, including some fields which</span>
00224     <span class="comment">// must be 0 and other fields which must be a small power of 2.</span>
00225     <span class="comment">//</span>
00226 
00227     <span class="keywordflow">if</span> (BootSector-&gt;Oem[0] == <span class="charliteral">'N'</span> &amp;&amp;
00228         BootSector-&gt;Oem[1] == <span class="charliteral">'T'</span> &amp;&amp;
00229         BootSector-&gt;Oem[2] == <span class="charliteral">'F'</span> &amp;&amp;
00230         BootSector-&gt;Oem[3] == <span class="charliteral">'S'</span> &amp;&amp;
00231         BootSector-&gt;Oem[4] == <span class="charliteral">' '</span> &amp;&amp;
00232         BootSector-&gt;Oem[5] == <span class="charliteral">' '</span> &amp;&amp;
00233         BootSector-&gt;Oem[6] == <span class="charliteral">' '</span> &amp;&amp;
00234         BootSector-&gt;Oem[7] == <span class="charliteral">' '</span>
00235 
00236             &amp;&amp;
00237 
00238         <span class="comment">//</span>
00239         <span class="comment">// Check number of bytes per sector.  The low order byte of this</span>
00240         <span class="comment">// number must be zero (smallest sector size = 0x100) and the</span>
00241         <span class="comment">// high order byte shifted must equal the bytes per sector gotten</span>
00242         <span class="comment">// from the device and stored in the Vcb.  And just to be sure,</span>
00243         <span class="comment">// sector size must be less than page size.</span>
00244         <span class="comment">//</span>
00245 
00246         BootSector-&gt;PackedBpb.BytesPerSector[0] == 0
00247 
00248             &amp;&amp;
00249 
00250         ((ULONG) (BootSector-&gt;PackedBpb.BytesPerSector[1] &lt;&lt; 8) == BytesPerSector)
00251 
00252             &amp;&amp;
00253 
00254         BootSector-&gt;PackedBpb.BytesPerSector[1] &lt;&lt; 8 &lt;= <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>
00255 
00256             &amp;&amp;
00257 
00258         <span class="comment">//</span>
00259         <span class="comment">//  Sectors per cluster must be a power of 2.</span>
00260         <span class="comment">//</span>
00261 
00262         (BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x1 ||
00263          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x2 ||
00264          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x4 ||
00265          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x8 ||
00266          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x10 ||
00267          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x20 ||
00268          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x40 ||
00269          BootSector-&gt;PackedBpb.SectorsPerCluster[0] == 0x80)
00270 
00271             &amp;&amp;
00272 
00273         <span class="comment">//</span>
00274         <span class="comment">//  These fields must all be zero.  For both Fat and HPFS, some of</span>
00275         <span class="comment">//  these fields must be nonzero.</span>
00276         <span class="comment">//</span>
00277 
00278         BootSector-&gt;PackedBpb.ReservedSectors[0] == 0 &amp;&amp;
00279         BootSector-&gt;PackedBpb.ReservedSectors[1] == 0 &amp;&amp;
00280         BootSector-&gt;PackedBpb.Fats[0] == 0 &amp;&amp;
00281         BootSector-&gt;PackedBpb.RootEntries[0] == 0 &amp;&amp;
00282         BootSector-&gt;PackedBpb.RootEntries[1] == 0 &amp;&amp;
00283         BootSector-&gt;PackedBpb.Sectors[0] == 0 &amp;&amp;
00284         BootSector-&gt;PackedBpb.Sectors[1] == 0 &amp;&amp;
00285         BootSector-&gt;PackedBpb.SectorsPerFat[0] == 0 &amp;&amp;
00286         BootSector-&gt;PackedBpb.SectorsPerFat[1] == 0 &amp;&amp;
00287         BootSector-&gt;PackedBpb.LargeSectors[0] == 0 &amp;&amp;
00288         BootSector-&gt;PackedBpb.LargeSectors[1] == 0 &amp;&amp;
00289         BootSector-&gt;PackedBpb.LargeSectors[2] == 0 &amp;&amp;
00290         BootSector-&gt;PackedBpb.LargeSectors[3] == 0
00291 
00292             &amp;&amp;
00293 
00294         <span class="comment">//</span>
00295         <span class="comment">//  Number of Sectors cannot be greater than the number of sectors</span>
00296         <span class="comment">//  on the partition.</span>
00297         <span class="comment">//</span>
00298 
00299         !( BootSector-&gt;NumberSectors.QuadPart &gt; NumberOfSectors-&gt;QuadPart )
00300 
00301             &amp;&amp;
00302 
00303         <span class="comment">//</span>
00304         <span class="comment">//  Check that both Lcn values are for sectors within the partition.</span>
00305         <span class="comment">//</span>
00306 
00307         !( BootSector-&gt;MftStartLcn.QuadPart *
00308                     BootSector-&gt;PackedBpb.SectorsPerCluster[0] &gt;
00309                 NumberOfSectors-&gt;QuadPart )
00310 
00311             &amp;&amp;
00312 
00313         !( BootSector-&gt;Mft2StartLcn.QuadPart *
00314                     BootSector-&gt;PackedBpb.SectorsPerCluster[0] &gt;
00315                 NumberOfSectors-&gt;QuadPart )
00316 
00317             &amp;&amp;
00318 
00319         <span class="comment">//</span>
00320         <span class="comment">//  Clusters per file record segment and default clusters for Index</span>
00321         <span class="comment">//  Allocation Buffers must be a power of 2.  A negative number indicates</span>
00322         <span class="comment">//  a shift value to get the actual size of the structure.</span>
00323         <span class="comment">//</span>
00324 
00325         ((BootSector-&gt;ClustersPerFileRecordSegment &gt;= -31 &amp;&amp;
00326           BootSector-&gt;ClustersPerFileRecordSegment &lt;= -9) ||
00327          BootSector-&gt;ClustersPerFileRecordSegment == 0x1 ||
00328          BootSector-&gt;ClustersPerFileRecordSegment == 0x2 ||
00329          BootSector-&gt;ClustersPerFileRecordSegment == 0x4 ||
00330          BootSector-&gt;ClustersPerFileRecordSegment == 0x8 ||
00331          BootSector-&gt;ClustersPerFileRecordSegment == 0x10 ||
00332          BootSector-&gt;ClustersPerFileRecordSegment == 0x20 ||
00333          BootSector-&gt;ClustersPerFileRecordSegment == 0x40)
00334 
00335             &amp;&amp;
00336 
00337         ((BootSector-&gt;DefaultClustersPerIndexAllocationBuffer &gt;= -31 &amp;&amp;
00338           BootSector-&gt;DefaultClustersPerIndexAllocationBuffer &lt;= -9) ||
00339          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x1 ||
00340          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x2 ||
00341          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x4 ||
00342          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x8 ||
00343          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x10 ||
00344          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x20 ||
00345          BootSector-&gt;DefaultClustersPerIndexAllocationBuffer == 0x40)) {
00346 
00347         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00348 
00349     } <span class="keywordflow">else</span> {
00350 
00351         <span class="comment">//</span>
00352         <span class="comment">// This does not appear to be an NTFS volume.</span>
00353         <span class="comment">//</span>
00354 
00355         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00356     }
00357 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:52 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
