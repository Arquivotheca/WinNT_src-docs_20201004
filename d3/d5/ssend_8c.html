<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ssend.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ssend.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>
<code>#include "callback.h"</code><br>
<code>#include "<a class="el" href="../../d0/d7/ntcb_8h-source.html">ntcb.h</a>"</code><br>

<p>
<a href="../../d4/d4/ssend_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a0">CALLBACKPROC</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a1">SERVERSIDE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a2">SENDSIDE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a3">CBBUFSIZE</a>&nbsp;&nbsp;&nbsp;512</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>&nbsp;&nbsp;&nbsp;(sizeof(ULONG_PTR) - 1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a5">SMESSAGECALL</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a6">SETUP</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a7">SETUPDC</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a8">SETUPPWND</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a9">CALC_SIZE_IN</a>(cb, pstr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a10">CALC_SIZE_OUT</a>(cb, pstr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a11">BEGINSEND</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a12">BEGINSENDCAPTURE</a>(api, cCapturePointers, cCaptureBytes, fInput)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a13">BEGINSENDCAPTUREVOIDDC</a>(api, cCapturePointers, cCaptureBytes, fInput)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a14">BEGINSENDCAPTUREDC</a>(api, cCapturePointers, cCaptureBytes, fInput)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a15">LOCKPWND</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a16">UNLOCKPWND</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a17">MAKECALL</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a18">MAKECALLCAPTURE</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a19">MAKECALLCAPTUREDC</a>(api)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a20">CHECKRETURN</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a21">ENDSEND</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a22">CLEANUPSENDCAPTURECOMMONDC</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a23">BEGIN_ENDSENDCAPTURE</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)&nbsp;&nbsp;&nbsp;exit:</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a24">_ENDSENDCAPTURE</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a25">END_ENDSENDCAPTURE</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)&nbsp;&nbsp;&nbsp;return (<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>)error</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a26">ENDSENDCAPTUREDC</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a27">ENDSENDCAPTURE</a>(<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a28">BEGIN_ENDSENDCAPTUREVOID</a>()&nbsp;&nbsp;&nbsp;errorexit:</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a29">_ENDSENDCAPTUREVOID</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a30">END_ENDSENDCAPTUREVOID</a>()&nbsp;&nbsp;&nbsp;return</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a31">ENDSENDCAPTUREVOIDDC</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a32">ENDSENDCAPTUREVOID</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a33">ENDSENDVOID</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a34">MSGERROR</a>()&nbsp;&nbsp;&nbsp;goto errorexit</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a35">MSGDATA</a>()&nbsp;&nbsp;&nbsp;(mp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a36">COPYSTRUCTOPT</a>(x)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a37">COPYCONSTRECTSTRUCTOPT</a>(x)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a38">COPYBYTES</a>(p, cb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a39">COPYBYTESOPT</a>(p, cb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a40">LARGECOPYBYTES</a>(p, cb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a41">LARGECOPYBYTES2</a>(src, cb, dest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a42">COPYSTRING</a>(s)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a43">COPYSTRINGOPT</a>(s)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a44">COPYSTRINGID</a>(s)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a45">LARGECOPYSTRINGLPWSTR</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a46">LARGECOPYSTRINGLPSTR</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a47">LARGECOPYSTRINGLPWSTRA</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a48">LARGECOPYSTRINGLPSTRW</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a49">LARGECOPYSTRINGLPWSTROPT</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a50">LARGECOPYSTRINGLPSTROPT</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a51">LARGECOPYSTRINGLPWSTROPTA</a>(ps, psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a52">BEGINCOPYOUT</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a53">ENDCOPYOUT</a>()&nbsp;&nbsp;&nbsp;}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a54">OUTSTRUCT</a>(pstruct, <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a55">OUTBITMASK</a>(pstruct, <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, mask)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a56">COPYOUTLPWSTRLIMIT</a>(pstr, cch)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a57">RESERVEBYTES</a>(cb, dest, cbdest)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a58">AllocCallbackMessage</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbBaseMsg, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cPointers, SIZE_T cbCapture, <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pStackBuffer, BOOL fInput)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a> (<a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a> pcb, PVOID pData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbData, PVOID *ppDest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a60">AllocateCallbackData</a> (<a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a> pcb, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbData, PVOID *ppDest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a61">CaptureAnsiCallbackData</a> (<a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a> pcb, PVOID pData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbData, PVOID *ppDest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a62">CaptureUnicodeCallbackData</a> (<a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a> pcb, PVOID pData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbData, PVOID *ppDest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/ssend_8c.html#a63">CopyOutputString</a> (<a class="el" href="../../d1/d7/struct__CALLBACKSTATUS.html">PCALLBACKSTATUS</a> pcbs, <a class="el" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a> pstr, UINT cchLimit, BOOL fAnsi)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a24" doxytag="ssend.c::_ENDSENDCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define _ENDSENDCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (mp != &amp;m &amp;&amp; (PVOID)mp != (PVOID)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>) {           \
            <span class="keywordflow">if</span> (mp-&gt;CaptureBuf.pvVirtualAddress) {              \
                <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;                                \
                SIZE_T ulRegionSize = 0;                        \
                                                                \
                <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwFreeVirtualMemory(NtCurrentProcess(),\
                        &amp;mp-&gt;CaptureBuf.pvVirtualAddress,       \
                        &amp;ulRegionSize,                          \
                        MEM_RELEASE);                           \
                UserAssert(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));                 \
            }                                                   \
            <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(ptiCurrent, &amp;tlPool);       \
        }                                                       \
        <span class="keywordflow">return</span> (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>)retval;                                    \
        <span class="keywordflow">goto</span> errorexit;                                         \
    }                                                           \
errorexit:                                                      \
   retval = error;                                              \
   <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;                                                   \
errorexitnofreemp:
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00218">218</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ssend.c::_ENDSENDCAPTUREVOID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define _ENDSENDCAPTUREVOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (mp != &amp;m &amp;&amp; (PVOID)mp != (PVOID)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>) {           \
            <span class="keywordflow">if</span> (mp-&gt;CaptureBuf.pvVirtualAddress) {              \
                <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;                                \
                SIZE_T ulRegionSize = 0;                        \
                                                                \
                <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwFreeVirtualMemory(NtCurrentProcess(),\
                        &amp;mp-&gt;CaptureBuf.pvVirtualAddress,       \
                        &amp;ulRegionSize,                          \
                        MEM_RELEASE);                           \
                UserAssert(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));                 \
            }                                                   \
            <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(ptiCurrent, &amp;tlPool);       \
        }                                                       \
        <span class="keywordflow">return</span>;                                                 \
    }                                                           \
errorexitnofreemp:
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00288">288</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ssend.c::BEGIN_ENDSENDCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGIN_ENDSENDCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;exit:</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00216">216</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ssend.c::BEGIN_ENDSENDCAPTUREVOID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGIN_ENDSENDCAPTUREVOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;errorexit:</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00286">286</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ssend.c::BEGINCOPYOUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGINCOPYOUT          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> ((psms == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || ((psms-&gt;flags &amp; (<a class="code" href="../../d4/d1/userk_8h.html#a426">SMF_SENDERDIED</a> | <a class="code" href="../../d4/d1/userk_8h.html#a424">SMF_REPLY</a>)) == 0)) \
            &amp;&amp; !(dwSCMSFlags &amp; <a class="code" href="../../d4/d1/userk_8h.html#a241">SCMS_FLAGS_INONLY</a>)) {
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00484">484</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ssend.c::BEGINSEND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGINSEND          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>mp = &amp;m; \
    <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;  \
    {
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00098">98</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ssend.c::BEGINSENDCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGINSENDCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCapturePointers,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCaptureBytes,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fInput&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (cCapturePointers) {                             \
        mp = <a class="code" href="../../d3/d5/ssend_8c.html#a58">AllocCallbackMessage</a>(<span class="keyword">sizeof</span>(m),            \
                (cCapturePointers),                     \
                (cCaptureBytes),                        \
                Buffer,                                 \
                fInput);                                \
        <span class="keywordflow">if</span> (mp == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)                                 \
            <span class="keywordflow">goto</span> errorexitnofreemp;                     \
    } <span class="keywordflow">else</span> {                                            \
        m.CaptureBuf.cbCallback = <span class="keyword">sizeof</span>(m);            \
        m.CaptureBuf.cbCapture = 0;                     \
        m.CaptureBuf.cCapturedPointers = 0;             \
        mp = &amp;m;                                        \
    }                                                   \
    {                                                   \
        <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();          \
        <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlPool;                                      \
                                                        \
        <span class="keywordflow">if</span> (mp != &amp;m &amp;&amp; (PVOID)mp != (PVOID)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>)     \
            <a class="code" href="../../d4/d1/userk_8h.html#a137">ThreadLockPool</a>(ptiCurrent, mp, &amp;tlPool);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00103">103</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ssend.c::BEGINSENDCAPTUREDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGINSENDCAPTUREDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCapturePointers,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCaptureBytes,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fInput&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>hdcUse = <a class="code" href="../../d8/d2/mngray_8c.html#a3">CreateCompatiblePublicDC</a>(hdc,&amp;hbmDCGray);                    \
    <span class="keywordflow">if</span> (hdcUse == (HDC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {                                            \
        <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;                                                     \
    }                                                                     \
    <a class="code" href="../../d3/d5/ssend_8c.html#a12">BEGINSENDCAPTURE</a>(api, cCapturePointers, cCaptureBytes, fInput);       \
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00132">132</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ssend.c::BEGINSENDCAPTUREVOIDDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGINSENDCAPTUREVOIDDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCapturePointers,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cCaptureBytes,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>fInput&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>hdcUse = <a class="code" href="../../d8/d2/mngray_8c.html#a3">CreateCompatiblePublicDC</a>(hdc,&amp;hbmDCGray);                        \
    <span class="keywordflow">if</span> (hdcUse == (HDC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {                                                \
        <span class="keywordflow">return</span>;                                                               \
    }                                                                         \
    <a class="code" href="../../d3/d5/ssend_8c.html#a12">BEGINSENDCAPTURE</a>(api, cCapturePointers, cCaptureBytes, fInput);           \
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00125">125</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ssend.c::CALC_SIZE_IN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALC_SIZE_IN          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cb,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>pstr&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>cb = (pstr)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR);  \
    <span class="keywordflow">if</span> ((pstr)-&gt;bAnsi &amp;&amp; !fAnsiReceiver)  \
        cb *= <span class="keyword">sizeof</span>(WCHAR);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00069">69</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ssend.c::CALC_SIZE_OUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALC_SIZE_OUT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cb,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>pstr&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>cb = (pstr)-&gt;MaximumLength + <span class="keyword">sizeof</span>(WCHAR); \
    <span class="keywordflow">if</span> ((pstr)-&gt;bAnsi &amp;&amp; !fAnsiReceiver)        \
        cb *= <span class="keyword">sizeof</span>(WCHAR);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00074">74</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ssend.c::CALLBACKPROC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALLBACKPROC&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00014">14</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ssend.c::CBBUFSIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CBBUFSIZE&nbsp;&nbsp;&nbsp;512          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00021">21</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/ssend_8c-source.html#l00545">AllocCallbackMessage()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ssend.c::CHECKRETURN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CHECKRETURN          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) ||                              \
            cbCBStatus != <span class="keyword">sizeof</span>(*pcbs)) {                  \
        <span class="keywordflow">goto</span> errorexit;                                     \
    }                                                       \
    <span class="keywordflow">try</span> {                                                   \
        retval = <a class="code" href="../../d5/d8/ex_8h.html#a27">ProbeAndReadStructure</a>(&amp;<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;retval, ULONG_PTR); \
    } except (W32ExceptionHandler(FALSE, RIP_ERROR)) { \
        <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>(); \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00189">189</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ssend.c::CLEANUPSENDCAPTURECOMMONDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLEANUPSENDCAPTURECOMMONDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span>(iDC) {                                                    \
       GreRestoreDC(hdc, iDC);                                  \
   }                                                            \
   <span class="keywordflow">if</span> (hdcUse != hdc) {                                         \
       GreDeleteDC(hdcUse);                                     \
       GreDeleteObject(hbmDCGray);                              \
   }                                                            \
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00207">207</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ssend.c::COPYBYTES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYBYTES          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cb&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf, p, cb, &amp;mp-&gt;p))) \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00364">364</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ssend.c::COPYBYTESOPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYBYTESOPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cb&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (p) {                                                                    \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf, p, cb, &amp;mp-&gt;p)))   \
            <span class="keywordflow">goto</span> errorexit;                                                     \
    } <span class="keywordflow">else</span> {                                                                    \
        mp-&gt;p = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                                           \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00368">368</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ssend.c::COPYCONSTRECTSTRUCTOPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYCONSTRECTSTRUCTOPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a35">MSGDATA</a>()-&gt;p ## x = (LPRECT)(p ## x); \
        <span class="keywordflow">if</span> (p ## x) <a class="code" href="../../d3/d5/ssend_8c.html#a35">MSGDATA</a>()-&gt;x = *(p ## x);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00360">360</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ssend.c::COPYOUTLPWSTRLIMIT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYOUTLPWSTRLIMIT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pstr,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cch&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">try</span> {                                                                   \
        <a class="code" href="../../d3/d5/ssend_8c.html#a63">CopyOutputString</a>(pcbs, pstr, cch, fAnsiReceiver);                   \
    } except (W32ExceptionHandler(FALSE, RIP_ERROR)) { \
        <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>(); \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00522">522</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ssend.c::COPYSTRING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYSTRING          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>mp-&gt;s.Length = (p ## s)-&gt;Length;                                                \
    mp-&gt;s.MaximumLength = (p ## s)-&gt;MaximumLength;                                  \
    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                            \
                                        (p ## s)-&gt;Buffer,                           \
                                        (p ## s)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR),           \
                                        &amp;mp-&gt;s.Buffer)))                            \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00384">384</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ssend.c::COPYSTRINGID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYSTRINGID          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>mp-&gt;s.Length = (p ## s)-&gt;Length;                                                \
    mp-&gt;s.MaximumLength = (p ## s)-&gt;MaximumLength;                                  \
    <span class="keywordflow">if</span> (mp-&gt;s.MaximumLength) {                                                      \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                        \
                                            (p ## s)-&gt;Buffer,                       \
                                            (p ## s)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR),       \
                                            &amp;mp-&gt;s.Buffer)))                        \
            <span class="keywordflow">goto</span> errorexit;                                                         \
    } <span class="keywordflow">else</span> {                                                                        \
        mp-&gt;s.Buffer = (p ## s)-&gt;Buffer;                                            \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00407">407</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ssend.c::COPYSTRINGOPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYSTRINGOPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (p ## s) {                                                                   \
        mp-&gt;s.Length = (p ## s)-&gt;Length;                                            \
        mp-&gt;s.MaximumLength = (p ## s)-&gt;MaximumLength;                              \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                        \
                                            (p ## s)-&gt;Buffer,                       \
                                            (p ## s)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR),       \
                                            &amp;mp-&gt;s.Buffer)))                        \
            <span class="keywordflow">goto</span> errorexit;                                                         \
    } <span class="keywordflow">else</span> {                                                                        \
        mp-&gt;s.Length = 0;                                                           \
        mp-&gt;s.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                                        \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00393">393</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ssend.c::COPYSTRUCTOPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COPYSTRUCTOPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a35">MSGDATA</a>()-&gt;p ## x = (p ## x); \
        <span class="keywordflow">if</span> (p ## x) <a class="code" href="../../d3/d5/ssend_8c.html#a35">MSGDATA</a>()-&gt;x = *(p ## x);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00356">356</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ssend.c::END_ENDSENDCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define END_ENDSENDCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;return (<a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>)error</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00239">239</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ssend.c::END_ENDSENDCAPTUREVOID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define END_ENDSENDCAPTUREVOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;return</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00305">305</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ssend.c::ENDCOPYOUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDCOPYOUT          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;}</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00488">488</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ssend.c::ENDSEND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSEND          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">return</span> (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>)retval;               \
        <span class="keywordflow">goto</span> errorexit;                    \
    }                                      \
errorexit:                                 \
   <span class="keywordflow">return</span> (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>)error
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00200">200</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ssend.c::ENDSENDCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSENDCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a23">BEGIN_ENDSENDCAPTURE</a>(type, error); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a24">_ENDSENDCAPTURE</a>(type, error); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a25">END_ENDSENDCAPTURE</a>(type, error)
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00250">250</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ssend.c::ENDSENDCAPTUREDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSENDCAPTUREDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>error&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a23">BEGIN_ENDSENDCAPTURE</a>(type, error); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a22">CLEANUPSENDCAPTURECOMMONDC</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a24">_ENDSENDCAPTURE</a>(type, error); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a22">CLEANUPSENDCAPTURECOMMONDC</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a25">END_ENDSENDCAPTURE</a>(type, error)
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00243">243</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ssend.c::ENDSENDCAPTUREVOID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSENDCAPTUREVOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a28">BEGIN_ENDSENDCAPTUREVOID</a>(); \
        CLEANUPSENDCAPTURECOMMON(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a29">_ENDSENDCAPTUREVOID</a>(); \
        CLEANUPSENDCAPTURECOMMON(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a30">END_ENDSENDCAPTUREVOID</a>()
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00315">315</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ssend.c::ENDSENDCAPTUREVOIDDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSENDCAPTUREVOIDDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a28">BEGIN_ENDSENDCAPTUREVOID</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a22">CLEANUPSENDCAPTURECOMMONDC</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a29">_ENDSENDCAPTUREVOID</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a22">CLEANUPSENDCAPTURECOMMONDC</a>(); \
        <a class="code" href="../../d3/d5/ssend_8c.html#a30">END_ENDSENDCAPTUREVOID</a>()
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00308">308</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ssend.c::ENDSENDVOID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDSENDVOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>}                 \
    <span class="keywordflow">return</span>
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00323">323</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ssend.c::LARGECOPYBYTES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYBYTES          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cb&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf, p, cb, &amp;mp-&gt;p))) \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00376">376</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ssend.c::LARGECOPYBYTES2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYBYTES2          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">src,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cb,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>dest&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf, src, cb, &amp;mp-&gt;dest))) \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00380">380</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ssend.c::LARGECOPYSTRINGLPSTR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPSTR          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                            \
                                        (ps)-&gt;Buffer,                               \
                                        (ps)-&gt;Length + 1,                           \
                                        (PVOID *)&amp;mp-&gt;psz)))                        \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00427">427</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ssend.c::LARGECOPYSTRINGLPSTROPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPSTROPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (ps) {                                                                       \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                        \
                                            (ps)-&gt;Buffer,                           \
                                            (ps)-&gt;Length + <span class="keyword">sizeof</span>(UCHAR),           \
                                            (PVOID *)&amp;mp-&gt;psz)))                    \
            <span class="keywordflow">goto</span> errorexit;                                                         \
    } <span class="keywordflow">else</span> {                                                                        \
        mp-&gt;psz = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                                             \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00459">459</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ssend.c::LARGECOPYSTRINGLPSTRW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPSTRW          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a62">CaptureUnicodeCallbackData</a>(&amp;mp-&gt;CaptureBuf,                     \
                                        (ps)-&gt;Buffer,                               \
                                        ((ps)-&gt;Length + 1) * <span class="keyword">sizeof</span>(WCHAR),         \
                                        (PVOID *)&amp;mp-&gt;psz)))                        \
        <span class="keywordflow">goto</span> errorexit;                                                             \
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00441">441</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ssend.c::LARGECOPYSTRINGLPWSTR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPWSTR          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                            \
                                        (ps)-&gt;Buffer,                               \
                                        (ps)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR),               \
                                        (PVOID *)&amp;mp-&gt;psz)))                        \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00420">420</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ssend.c::LARGECOPYSTRINGLPWSTRA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPWSTRA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a61">CaptureAnsiCallbackData</a>(&amp;mp-&gt;CaptureBuf,                        \
                                        (ps)-&gt;Buffer,                               \
                                        ((ps)-&gt;Length / <span class="keyword">sizeof</span>(WCHAR)) + 1,         \
                                        (PVOID *)&amp;mp-&gt;psz)))                        \
        <span class="keywordflow">goto</span> errorexit;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00434">434</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ssend.c::LARGECOPYSTRINGLPWSTROPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPWSTROPT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (ps) {                                                                       \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a59">CaptureCallbackData</a>(&amp;mp-&gt;CaptureBuf,                        \
                                            (ps)-&gt;Buffer,                           \
                                            (ps)-&gt;Length + <span class="keyword">sizeof</span>(WCHAR),           \
                                            (PVOID *)&amp;mp-&gt;psz)))                    \
            <span class="keywordflow">goto</span> errorexit;                                                         \
    } <span class="keywordflow">else</span> {                                                                        \
        mp-&gt;psz = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                                             \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00448">448</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ssend.c::LARGECOPYSTRINGLPWSTROPTA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LARGECOPYSTRINGLPWSTROPTA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ps,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>psz&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (ps) {                                                                       \
        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a61">CaptureAnsiCallbackData</a>(&amp;mp-&gt;CaptureBuf,                    \
                                            (ps)-&gt;Buffer,                           \
                                            ((ps)-&gt;Length / <span class="keyword">sizeof</span>(WCHAR)) + 1,     \
                                            (PVOID *)&amp;mp-&gt;psz)))                    \
            <span class="keywordflow">goto</span> errorexit;                                                         \
    } <span class="keywordflow">else</span> {                                                                        \
        mp-&gt;psz = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                                             \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00470">470</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ssend.c::LOCKPWND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LOCKPWND          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d6/d0/usercli_8h.html#a36">ThreadLock</a>(pwnd, &amp;tlpwnd);          \
    cbwin = pci-&gt;CallbackWnd;           \
    pci-&gt;CallbackWnd.pwnd = pwndClient; \
    pci-&gt;CallbackWnd.hwnd = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a450">HW</a>(pwnd);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00139">139</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ssend.c::MAKECALL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAKECALL          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>UserAssert(!(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>()-&gt;TIF_flags &amp; TIF_INCLEANUP)); \
    <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();                                            \
    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d9/ke_8h.html#a394">KeUserModeCallback</a>(                            \
        FI_ ## api,                                         \
        mp,                                                 \
        <span class="keyword">sizeof</span>(*mp),                                        \
        &amp;pcbs,                                              \
        &amp;cbCBStatus);                                       \
    <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00149">149</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ssend.c::MAKECALLCAPTURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAKECALLCAPTURE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>UserAssert(!(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>()-&gt;TIF_flags &amp; TIF_INCLEANUP)); \
    <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();                                            \
    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d4/d9/ke_8h.html#a394">KeUserModeCallback</a>(                     \
        FI_ ## api,                                         \
        mp,                                                 \
        mp-&gt;CaptureBuf.cbCallback,                          \
        &amp;pcbs,                                              \
        &amp;cbCBStatus);                                       \
    <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00160">160</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ssend.c::MAKECALLCAPTUREDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAKECALLCAPTUREDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>iDC = GreSaveDC(hdc);                               \
        <a class="code" href="../../d3/d5/ssend_8c.html#a18">MAKECALLCAPTURE</a>(api)                                \
        GreRestoreDC(hdc, iDC);                             \
        iDC = 0;                                            \
        <span class="keywordflow">if</span> ((hdcUse != hdc) &amp;&amp; <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {        \
            GreBitBlt(hdc,                                  \
                      0,                                    \
                      0,                                    \
                      <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o7">cxGray</a>,                   \
                      <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o8">cyGray</a>,                   \
                      hdcUse,                               \
                      0,                                    \
                      0,                                    \
                      SRCCOPY,                              \
                      0);                                   \
        }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00171">171</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ssend.c::MSGDATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define <a class="el" href="../../d8/d9/struct__msgdata.html">MSGDATA</a>          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(mp)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00354">354</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ssend.c::MSGERROR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSGERROR          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;goto errorexit</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00327">327</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ssend.c::OUTBITMASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define OUTBITMASK          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pstruct,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>mask&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">try</span> {                                                                   \
        <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> flags = <a class="code" href="../../d5/d8/ex_8h.html#a27">ProbeAndReadStructure</a>(((type *)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput), type);  \
        <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a14">COPY_FLAG</a>(*(pstruct), flags, mask);                                 \
    } except (W32ExceptionHandler(FALSE, RIP_ERROR)) { \
        <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>(); \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00504">504</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ssend.c::OUTSTRUCT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define OUTSTRUCT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pstruct,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">try</span> {                                                                   \
        *(pstruct) = <a class="code" href="../../d5/d8/ex_8h.html#a27">ProbeAndReadStructure</a>(((type *)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput), type);  \
    } except (W32ExceptionHandler(FALSE, RIP_ERROR)) { \
        <a class="code" href="../../d5/d8/crecv_8c.html#a7">MSGERROR</a>(); \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00494">494</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ssend.c::PADSIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PADSIZE&nbsp;&nbsp;&nbsp;(sizeof(ULONG_PTR) - 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">23</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/ssend_8c-source.html#l00695">AllocateCallbackData()</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00545">AllocCallbackMessage()</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00736">CaptureAnsiCallbackData()</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00639">CaptureCallbackData()</a>, and <a class="el" href="../../d4/d4/ssend_8c-source.html#l00839">CaptureUnicodeCallbackData()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ssend.c::RESERVEBYTES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESERVEBYTES          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cb,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>dest,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>cbdest&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d3/d5/ssend_8c.html#a60">AllocateCallbackData</a>(&amp;mp-&gt;CaptureBuf,   \
            cb, (PVOID *)&amp;mp-&gt;dest)))                       \
        <span class="keywordflow">goto</span> errorexit;                                     \
    mp-&gt;cbdest = cb;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00530">530</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ssend.c::SENDSIDE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SENDSIDE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00019">19</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ssend.c::SERVERSIDE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SERVERSIDE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00015">15</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ssend.c::SETUP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SETUP          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>api ## MSG m;                                           \
    api ## MSG *mp = &amp;m;                                    \
    <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d3/d5/ssend_8c.html#a3">CBBUFSIZE</a>];                                 \
    <a class="code" href="../../d1/d7/struct__CALLBACKSTATUS.html">PCALLBACKSTATUS</a> <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>;                                   \
    ULONG cbCBStatus;                                       \
    ULONG_PTR retval;                                        \
    <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00039">39</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ssend.c::SETUPDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SETUPDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d3/d5/ssend_8c.html#a6">SETUP</a>(api)                         \
    <span class="keywordtype">int</span> iDC = 0;                       \
    HDC     hdcUse;                    \
    HBITMAP hbmDCGray = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00048">48</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ssend.c::SETUPPWND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SETUPPWND          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>api ## MSG m;                                               \
    api ## MSG *mp = &amp;m;                                        \
    <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d3/d5/ssend_8c.html#a3">CBBUFSIZE</a>];                                     \
    <a class="code" href="../../d1/d7/struct__CALLBACKSTATUS.html">PCALLBACKSTATUS</a> <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>;                                       \
    ULONG cbCBStatus;                                           \
    ULONG_PTR retval;                                           \
    <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;                                            \
    <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwnd;                                                  \
    <a class="code" href="../../d2/d7/struct__CALLBACKWND.html">CALLBACKWND</a> cbwin;                                          \
    <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pci = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>()-&gt;pClientInfo;                \
    <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndClient = pwnd ? (<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pwnd - pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o6">ulClientDelta</a>) : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; \
    UserAssert(pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o6">ulClientDelta</a> != 0);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00055">55</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ssend.c::SMESSAGECALL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SMESSAGECALL          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">api&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>LRESULT Sfn ## api(      \
    <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd,           \
    UINT msg,            \
    WPARAM wParam,       \
    LPARAM lParam,       \
    ULONG_PTR xParam,     \
    PROC xpfnProc,       \
    DWORD dwSCMSFlags,   \
    PSMS psms)
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00028">28</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ssend.c::UNLOCKPWND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNLOCKPWND          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>pci-&gt;CallbackWnd = cbwin;       \
    <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwnd);
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00145">145</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a60" doxytag="ssend.c::AllocateCallbackData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS AllocateCallbackData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppDest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00695">695</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00425">_CAPTUREBUF::cbCapture</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00426">_CAPTUREBUF::cCapturedPointers</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00428">_CAPTUREBUF::offPointers</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">PADSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00427">_CAPTUREBUF::pbFree</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00429">_CAPTUREBUF::pvVirtualAddress</a>.
<p>
<pre class="fragment"><div>00699 {
00700     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbBuffer;
00701 
00702     <span class="comment">/*</span>
00703 <span class="comment">     * Allocate space from the message buffer</span>
00704 <span class="comment">     */</span>
00705     <span class="keywordflow">if</span> (cbData &gt; pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a>) {
00706         <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00707     }
00708 
00709     pbBuffer = pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a>;
00710     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pbBuffer + ((cbData + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>);
00711 
00712     <span class="comment">/*</span>
00713 <span class="comment">     * Fix up offsets to data.  If the data is going into a section</span>
00714 <span class="comment">     * use the real pointer and don't compute offsets.</span>
00715 <span class="comment">     */</span>
00716     <span class="keywordflow">if</span> (pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>)
00717         *ppDest = pbBuffer;
00718     <span class="keywordflow">else</span> {
00719         *ppDest = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(pbBuffer - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00720         ((LPDWORD)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb + pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o4">offPointers</a>))[pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o2">cCapturedPointers</a>++] =
00721                 (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)ppDest - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00722     }
00723 
00724     <span class="keywordflow">return</span> STATUS_SUCCESS;
00725 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ssend.c::AllocCallbackMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID AllocCallbackMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbBaseMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cPointers</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>cbCapture</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pStackBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fInput</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00545">545</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00387">CALLBACKSTACKLIMIT</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00021">CBBUFSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00424">_CAPTUREBUF::cbCallback</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00425">_CAPTUREBUF::cbCapture</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00426">_CAPTUREBUF::cCapturedPointers</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00428">_CAPTUREBUF::offPointers</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">PADSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00427">_CAPTUREBUF::pbFree</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a965">PCAPTUREBUF</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00429">_CAPTUREBUF::pvVirtualAddress</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
<pre class="fragment"><div>00551 {
00552     <a class="code" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a> pcb;
00553 
00554     <span class="keywordflow">if</span> (cPointers == 0)
00555         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00556 
00557     <span class="comment">/*</span>
00558 <span class="comment">     * Compute allocation sizes</span>
00559 <span class="comment">     */</span>
00560     cbBaseMsg = (cbBaseMsg + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>;
00561     cbBaseMsg += (cPointers * <span class="keyword">sizeof</span>(PVOID));
00562     cbCapture = (cbCapture + (<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a> * cPointers)) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>;
00563 
00564     <span class="comment">/*</span>
00565 <span class="comment">     * If the captured data is greater than a page, place it</span>
00566 <span class="comment">     * in a section.  Otherwise, put the message and the</span>
00567 <span class="comment">     * data in a single block of pool</span>
00568 <span class="comment">     */</span>
00569     <span class="keywordflow">if</span> (cbCapture &gt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a97">CALLBACKSTACKLIMIT</a>) {
00570         <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00571 
00572         <span class="comment">/*</span>
00573 <span class="comment">         * Allocate the message buffer</span>
00574 <span class="comment">         */</span>
00575         pcb = UserAllocPoolWithQuota(cbBaseMsg, TAG_CALLBACK);
00576         <span class="keywordflow">if</span> (pcb == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00577             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00578 
00579         <span class="comment">/*</span>
00580 <span class="comment">         * Allocate the virtual memory</span>
00581 <span class="comment">         */</span>
00582         pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00583         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwAllocateVirtualMemory(NtCurrentProcess(),
00584                 &amp;pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>, 0, &amp;cbCapture,
00585                 MEM_COMMIT, PAGE_READWRITE);
00586         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00587             RIPMSG2(RIP_WARNING, <span class="stringliteral">"AllocCallbackMessage: ZwAllocateVirtualMemory failed. Status:%#lx. Size:%#lx"</span>,
00588                     Status, cbCapture);
00589             UserFreePool(pcb);
00590             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00591         }
00592         pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>;
00593         pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o0">cbCallback</a> = cbBaseMsg;
00594     } <span class="keywordflow">else</span> {
00595 
00596         <span class="comment">/*</span>
00597 <span class="comment">         * If the message is too big to save on the stack, allocate</span>
00598 <span class="comment">         * the buffer from pool.</span>
00599 <span class="comment">         */</span>
00600         <span class="keywordflow">if</span> (cbBaseMsg + cbCapture &gt; <a class="code" href="../../d3/d5/ssend_8c.html#a3">CBBUFSIZE</a>) {
00601             pcb = UserAllocPoolWithQuota((ULONG)(cbBaseMsg + cbCapture), TAG_CALLBACK);
00602             <span class="keywordflow">if</span> (pcb == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00603                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00604         } <span class="keywordflow">else</span> {
00605             pcb = (<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a>)pStackBuffer;
00606         }
00607         pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb + cbBaseMsg;
00608         pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00609 
00610         <span class="comment">/*</span>
00611 <span class="comment">         * If this callback is passing data to the client, include the</span>
00612 <span class="comment">         * captured data in the message.  Otherwise, only pass the message.</span>
00613 <span class="comment">         */</span>
00614         <span class="keywordflow">if</span> (fInput)
00615             pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o0">cbCallback</a> = cbBaseMsg + (ULONG)cbCapture;
00616         <span class="keywordflow">else</span>
00617             pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o0">cbCallback</a> = cbBaseMsg;
00618     }
00619 
00620     <span class="comment">/*</span>
00621 <span class="comment">     * Initialize the capture buffer</span>
00622 <span class="comment">     */</span>
00623     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a> = (ULONG)cbCapture;
00624     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o2">cCapturedPointers</a> = 0;
00625     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o4">offPointers</a> = cbBaseMsg - (cPointers * <span class="keyword">sizeof</span>(PVOID));
00626 
00627     <span class="keywordflow">return</span> (PVOID)pcb;
00628 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="ssend.c::CaptureAnsiCallbackData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS CaptureAnsiCallbackData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppDest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00736">736</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00425">_CAPTUREBUF::cbCapture</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00426">_CAPTUREBUF::cCapturedPointers</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00587">DBCS_CHARSIZE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00590">IS_DBCS_ENABLED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00428">_CAPTUREBUF::offPointers</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">PADSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00427">_CAPTUREBUF::pbFree</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00429">_CAPTUREBUF::pvVirtualAddress</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00905">RtlUnicodeToMultiByteN()</a>.
<p>
<pre class="fragment"><div>00741 {
00742     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbBuffer;
00743     ULONG nCharsInAnsiString;
00744 
00745     <span class="comment">/*</span>
00746 <span class="comment">     * If the data pointer is NULL, the out pointer will be</span>
00747 <span class="comment">     * NULL</span>
00748 <span class="comment">     */</span>
00749     <span class="keywordflow">if</span> (pData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00750         *ppDest = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00751         <span class="keywordflow">return</span> STATUS_SUCCESS;
00752     }
00753 
00754     <span class="comment">/*</span>
00755 <span class="comment">     * Allocate space from the message buffer</span>
00756 <span class="comment">     */</span>
00757 <span class="preprocessor">#ifdef FE_SB // CaptureAnsiCallbackData()</span>
00758 <span class="preprocessor"></span>    <span class="comment">/*</span>
00759 <span class="comment">     * Reserve enough space for DBCS.</span>
00760 <span class="comment">     */</span>
00761     <span class="keywordflow">if</span> ((cbData * <span class="keyword">sizeof</span>(WORD)) &gt; pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a>) {
00762 <span class="preprocessor">#else</span>
00763 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (cbData &gt; pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a>) {
00764 <span class="preprocessor">#endif // FE_SB</span>
00765 <span class="preprocessor"></span>        <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00766     }
00767 
00768     pbBuffer = pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a>;
00769 
00770     <span class="comment">/*</span>
00771 <span class="comment">     * Convert the unicode string to ANSI</span>
00772 <span class="comment">     */</span>
00773     <span class="keywordflow">try</span> {
00774 <span class="preprocessor">#ifdef FE_SB // CaptureAnsiCallbackData()</span>
00775 <span class="preprocessor"></span>        <span class="comment">/*</span>
00776 <span class="comment">         * Enough space for keep DBCS string.</span>
00777 <span class="comment">         */</span>
00778         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>(
00779                         (PCH)pbBuffer,
00780                         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a125">IS_DBCS_ENABLED</a>() ? cbData * DBCS_CHARSIZE : cbData,
00781                         &amp;nCharsInAnsiString,
00782                         (PWCH)pData,
00783                         cbData * <span class="keyword">sizeof</span>(WCHAR)
00784                         ))) {
00785 <span class="preprocessor">#else</span>
00786 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>(
00787                         (PCH)pbBuffer,
00788                         cbData,
00789                         &amp;nCharsInAnsiString,
00790                         (PWCH)pData,
00791                         cbData * <span class="keyword">sizeof</span>(WCHAR)
00792                         ))) {
00793 <span class="preprocessor">#endif // FE_SB</span>
00794 <span class="preprocessor"></span>            <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00795         }
00796     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00797         <span class="keywordflow">return</span> STATUS_ACCESS_VIOLATION;
00798     }
00799 
00800     <span class="comment">/*</span>
00801 <span class="comment">     * Translation succeeded.</span>
00802 <span class="comment">     */</span>
00803 <span class="preprocessor">#ifdef FE_SB // CaptureAnsiCallbackData()</span>
00804 <span class="preprocessor"></span>    <span class="comment">/*</span>
00805 <span class="comment">     * nCharsInAnsiString is actual bytes wriiten in message area.</span>
00806 <span class="comment">     */</span>
00807     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pbBuffer + ((nCharsInAnsiString + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>);
00808     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a> -= nCharsInAnsiString;
00809 <span class="preprocessor">#else</span>
00810 <span class="preprocessor"></span>    pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pbBuffer + ((cbData + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>);
00811     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a> -= cbData;
00812 <span class="preprocessor">#endif // FE_SB</span>
00813 <span class="preprocessor"></span>
00814     <span class="comment">/*</span>
00815 <span class="comment">     * Fix up offsets to data.  If the data is going into a section</span>
00816 <span class="comment">     * use the real pointer and don't compute offsets.</span>
00817 <span class="comment">     */</span>
00818     <span class="keywordflow">if</span> (pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>)
00819         *ppDest = pbBuffer;
00820     <span class="keywordflow">else</span> {
00821         *ppDest = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(pbBuffer - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00822         ((LPDWORD)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb + pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o4">offPointers</a>))[pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o2">cCapturedPointers</a>++] =
00823                 (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)ppDest - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00824     }
00825 
00826     <span class="keywordflow">return</span> STATUS_SUCCESS;
00827 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ssend.c::CaptureCallbackData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS CaptureCallbackData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppDest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00639">639</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00425">_CAPTUREBUF::cbCapture</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00426">_CAPTUREBUF::cCapturedPointers</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00428">_CAPTUREBUF::offPointers</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">PADSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00427">_CAPTUREBUF::pbFree</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00429">_CAPTUREBUF::pvVirtualAddress</a>.
<p>
<pre class="fragment"><div>00644 {
00645     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbBuffer;
00646 
00647     <span class="comment">/*</span>
00648 <span class="comment">     * If the data pointer is NULL, the out pointer will be</span>
00649 <span class="comment">     * NULL</span>
00650 <span class="comment">     */</span>
00651     <span class="keywordflow">if</span> (pData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00652         *ppDest = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00653         <span class="keywordflow">return</span> STATUS_SUCCESS;
00654     }
00655 
00656     <span class="comment">/*</span>
00657 <span class="comment">     * Allocate space from the message buffer</span>
00658 <span class="comment">     */</span>
00659     <span class="keywordflow">if</span> (cbData &gt; pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a>) {
00660         <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00661     }
00662 
00663     pbBuffer = pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a>;
00664     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pbBuffer + ((cbData + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>);
00665 
00666     <span class="keywordflow">try</span> {
00667         RtlCopyMemory(pbBuffer, pData, cbData);
00668     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00669         <span class="keywordflow">return</span> STATUS_ACCESS_VIOLATION;
00670     }
00671 
00672     <span class="comment">/*</span>
00673 <span class="comment">     * Fix up offsets to data.  If the data is going into a section</span>
00674 <span class="comment">     * use the real pointer and don't compute offsets.</span>
00675 <span class="comment">     */</span>
00676     <span class="keywordflow">if</span> (pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>)
00677         *ppDest = pbBuffer;
00678     <span class="keywordflow">else</span> {
00679         *ppDest = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(pbBuffer - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00680         ((LPDWORD)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb + pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o4">offPointers</a>))[pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o2">cCapturedPointers</a>++] =
00681                 (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)ppDest - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00682     }
00683 
00684     <span class="keywordflow">return</span> STATUS_SUCCESS;
00685 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ssend.c::CaptureUnicodeCallbackData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS CaptureUnicodeCallbackData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d7/struct__CAPTUREBUF.html">PCAPTUREBUF</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppDest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00839">839</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00425">_CAPTUREBUF::cbCapture</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00426">_CAPTUREBUF::cCapturedPointers</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00428">_CAPTUREBUF::offPointers</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00023">PADSIZE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00427">_CAPTUREBUF::pbFree</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00429">_CAPTUREBUF::pvVirtualAddress</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>.
<p>
<pre class="fragment"><div>00844 {
00845     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbBuffer;
00846     ULONG nCharsInUnicodeString;
00847 
00848     <span class="comment">/*</span>
00849 <span class="comment">     * If the data pointer is NULL, the out pointer will be</span>
00850 <span class="comment">     * NULL</span>
00851 <span class="comment">     */</span>
00852     <span class="keywordflow">if</span> (pData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00853         *ppDest = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00854         <span class="keywordflow">return</span> STATUS_SUCCESS;
00855     }
00856 
00857     <span class="comment">/*</span>
00858 <span class="comment">     * Allocate space from the message buffer</span>
00859 <span class="comment">     */</span>
00860     <span class="keywordflow">if</span> (cbData &gt; pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a>) {
00861         <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00862     }
00863 
00864     pbBuffer = pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a>;
00865 
00866     <span class="comment">/*</span>
00867 <span class="comment">     * Convert the ANSI string to unicode</span>
00868 <span class="comment">     */</span>
00869     <span class="keywordflow">try</span> {
00870         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>(
00871                             (PWCH)pbBuffer,
00872                             cbData,
00873                             &amp;nCharsInUnicodeString,
00874                             (PCH)pData,
00875                             cbData / <span class="keyword">sizeof</span>(WCHAR)
00876                             ))) {
00877             <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00878         }
00879     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00880         <span class="keywordflow">return</span> STATUS_ACCESS_VIOLATION;
00881     }
00882 
00883     <span class="comment">/*</span>
00884 <span class="comment">     * Translation succeeded.</span>
00885 <span class="comment">     */</span>
00886     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o3">pbFree</a> = pbBuffer + ((cbData + <a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>) &amp; ~<a class="code" href="../../d3/d5/ssend_8c.html#a4">PADSIZE</a>);
00887     pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o1">cbCapture</a> -= cbData;
00888 
00889     <span class="comment">/*</span>
00890 <span class="comment">     * Fix up offsets to data.  If the data is going into a section</span>
00891 <span class="comment">     * use the real pointer and don't compute offsets.</span>
00892 <span class="comment">     */</span>
00893     <span class="keywordflow">if</span> (pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o5">pvVirtualAddress</a>)
00894         *ppDest = pbBuffer;
00895     <span class="keywordflow">else</span> {
00896         *ppDest = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)(pbBuffer - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00897         ((LPDWORD)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb + pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o4">offPointers</a>))[pcb-&gt;<a class="code" href="../../d4/d7/struct__CAPTUREBUF.html#o2">cCapturedPointers</a>++] =
00898                 (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)ppDest - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pcb);
00899     }
00900 
00901     <span class="keywordflow">return</span> STATUS_SUCCESS;
00902 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="ssend.c::CopyOutputString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CopyOutputString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d7/struct__CALLBACKSTATUS.html">PCALLBACKSTATUS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcbs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pstr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cchLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fAnsi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/ssend_8c-source.html#l00922">922</a> of file <a class="el" href="../../d4/d4/ssend_8c-source.html">ssend.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00451">_LARGE_STRING::bAnsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00421">_LARGE_STRING::Buffer</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00449">_LARGE_STRING::Length</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a967">PCALLBACKSTATUS</a>, <a class="el" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01209">ProbeForRead</a>, <a class="el" href="../../d2/d4/w32_2ntuser_2rtl_2random_8c-source.html#l00184">strncpycch()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d2/d4/w32_2ntuser_2rtl_2random_8c-source.html#l00146">wcsncpycch()</a>.
<p>
<pre class="fragment"><div>00927 {
00928     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> cch;
00929 
00930     <a class="code" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>(<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput, <a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;cbOutput,
00931             fAnsi ? <span class="keyword">sizeof</span>(BYTE) : <span class="keyword">sizeof</span>(WORD));
00932     <span class="keywordflow">if</span> (!pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o2">bAnsi</a>) {
00933         <span class="keywordflow">if</span> (fAnsi) {
00934             cch = MBToWCS((LPSTR)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput, (UINT)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;retval,
00935                     (LPWSTR *)&amp;pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>, cchLimit, FALSE);
00936             <span class="keywordflow">if</span> (cch &lt; cchLimit) {
00937                 <span class="comment">/*</span>
00938 <span class="comment">                 * Add a null terminator and ensure an accurate pstr-&gt;Length</span>
00939 <span class="comment">                 */</span>
00940                 ((LPWSTR)pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>)[cch] = 0;
00941                 cchLimit = cch;
00942             }
00943         } <span class="keywordflow">else</span> {
00944             cchLimit = <a class="code" href="../../d1/d5/w32_2ntuser_2rtl_2random_8c.html#a3">wcsncpycch</a>(pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>, (LPWSTR)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput, cchLimit);
00945             <span class="comment">// wcsncpy(pstr-&gt;Buffer, (LPWSTR)pcbs-&gt;pOutput, cchLimit);</span>
00946         }
00947         pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o0">Length</a> = cchLimit * <span class="keyword">sizeof</span>(WCHAR);
00948     } <span class="keywordflow">else</span> {
00949         <span class="keywordflow">if</span> (fAnsi) {
00950             cchLimit = <a class="code" href="../../d1/d5/w32_2ntuser_2rtl_2random_8c.html#a4">strncpycch</a>((LPSTR)pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>,
00951             <span class="comment">// strncpy((LPSTR)pstr-&gt;Buffer,</span>
00952                     (LPSTR)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput, cchLimit);
00953         } <span class="keywordflow">else</span> {
00954             cch = WCSToMB((LPWSTR)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;pOutput, (UINT)<a class="code" href="../../d8/d4/w32_2ntuser_2client_2callback_8c.html#a0">pcbs</a>-&gt;retval,
00955                     (LPSTR *)&amp;pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>, cchLimit, FALSE);
00956             <span class="keywordflow">if</span> (cch &lt; cchLimit) {
00957                 <span class="comment">/*</span>
00958 <span class="comment">                 * Add a null terminator and ensure an accurate pstr-&gt;Length</span>
00959 <span class="comment">                 */</span>
00960                 ((LPSTR)pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o3">Buffer</a>)[cch] = 0;
00961                 cchLimit = cch;
00962             }
00963         }
00964         pstr-&gt;<a class="code" href="../../d1/d9/struct__LARGE__STRING.html#o0">Length</a> = cchLimit;
00965     }
00966 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:40 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
