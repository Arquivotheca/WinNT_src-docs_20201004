<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CMonitorProfileManagement class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CMonitorProfileManagement Class Reference</h1><code>#include &lt;<a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CMonitorProfileManagement:
<p><center><img src="d3/d4/classCMonitorProfileManagement.png" usemap="#CMonitorProfileManagement_map" border="0" alt=""></center>
<map name="CMonitorProfileManagement_map">
<area href="d2/d2/classCDeviceProfileManagement.html" alt="CDeviceProfileManagement" shape="rect" coords="0,112,173,136">
<area href="d9/d6/classCShellExtensionPage.html" alt="CShellExtensionPage" shape="rect" coords="0,56,173,80">
<area href="d2/d6/classCPropertyPage.html" alt="CPropertyPage" shape="rect" coords="0,0,173,24">
</map>
<a href="../../d4/d2/classCMonitorProfileManagement-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a0">CMonitorProfileManagement</a> (LPCTSTR lpstrName, LPCTSTR lpstrFriendlyName, HINSTANCE hiWhere)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a1">~CMonitorProfileManagement</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a2">OnInit</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a3">OnCommand</a> (WORD wNotifyCode, WORD wid, HWND hwndCtl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a4">OnNotify</a> (int idCtrl, LPNMHDR pnmh)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a5">OnHelp</a> (LPHELPINFO pHelp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a6">OnContextMenu</a> (HWND hwnd)</td></tr>

<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#b0">InitList</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#b1">FillList</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>=0)</td></tr>

<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#p1">m_csDeviceFriendlyName</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CMonitorProfileManagement::CMonitorProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CMonitorProfileManagement::CMonitorProfileManagement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrFriendlyName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hiWhere</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01379">1379</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01379">CMonitorProfileManagement()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00044">IsAdmin()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00178">m_csDeviceFriendlyName</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00088">MonitorUI</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01379">CMonitorProfileManagement()</a>.
<p>
<pre class="fragment"><div>01381                                                                         :
01382   <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a>(lpstrName, hiWhere, MonitorUI, CLASS_MONITOR) {
01383 
01384 
01385    <span class="comment">// if the user is not the administrator,</span>
01386    <span class="comment">// make this property sheet read only.</span>
01387 
01388    <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a> = !<a class="code" href="../../d5/d7/devprop_8cpp.html#a5">IsAdmin</a>();
01389 
01390    <span class="comment">// Keep friendly name in MonitorProfileManagement class.</span>
01391 
01392    <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p1">m_csDeviceFriendlyName</a> = lpstrFriendlyName;
01393 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CMonitorProfileManagement::~CMonitorProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CMonitorProfileManagement::~<a class="el" href="../../d3/d4/classCMonitorProfileManagement.html">CMonitorProfileManagement</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00186">186</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
<pre class="fragment"><div>00186 {}
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b1" doxytag="CMonitorProfileManagement::FillList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CMonitorProfileManagement::FillList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwFlags</em> = <code>0</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b1">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">1293</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00117">DefaultProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00067">DEVLIST_NOSELECT</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00065">DEVLIST_ONINIT</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">FillList()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00177">m_uDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00053">NoProfileString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00768">SetDlgItemText()</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01431">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">OnNotify()</a>.
<p>
<pre class="fragment"><div>01293                                                          {
01294 
01295     <span class="comment">//  If we are initializing list box, we want to put focus on</span>
01296     <span class="comment">//  "default" profile. here we won't below FillList set focus</span>
01297     <span class="comment">//  to first one.</span>
01298 
01299     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a1">DEVLIST_ONINIT</a>) {
01300         <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> |= <a class="code" href="../../d6/d7/devprop_8h.html#a3">DEVLIST_NOSELECT</a>;
01301     }
01302 
01303     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">CDeviceProfileManagement::FillList</a>(dwFlags);
01304 
01305     <span class="comment">//  There is either no default profile, an existing profile is the</span>
01306     <span class="comment">//  default, or a newly selected one is.  Some people just like the</span>
01307     <span class="comment">//  selection operator.</span>
01308 
01309     <span class="comment">//  if there is only 1 profile in list box, we treat it as default profile.</span>
01310         
01311     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList,LB_GETCOUNT,0,0) == 1) {
01312         <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 0, 0);
01313     }
01314 
01315     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == -1) {
01316 
01317         <span class="comment">// There is no profile associated for this device.</span>
01318 
01319         <a class="code" href="../../d1/d7/classCString.html">CString</a> csNoProfile;
01320         csNoProfile.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(NoProfileString);
01321         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, DefaultProfile, csNoProfile);            
01322 
01323     } <span class="keywordflow">else</span> {
01324 
01325         <span class="comment">// If the default has been deleted, set default as last in list.</span>
01326 
01327         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> &gt;= (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())) {
01328 
01329             <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()) - 1;
01330         }
01331 
01332         <span class="comment">// Put default profile name in UI.</span>
01333 
01334         <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> *pcpDefault = (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()) ? \
01335                                            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a>] : \
01336                                            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()];
01337 
01338         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, DefaultProfile, pcpDefault -&gt; GetName());
01339 
01340         <span class="comment">// If we are initialing list box, put focus on default profile.</span>
01341 
01342         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a1">DEVLIST_ONINIT</a>) {
01343 
01344             LRESULT idSelect = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_FINDSTRINGEXACT,
01345                                    (WPARAM) -1, (LPARAM) (LPCTSTR) pcpDefault -&gt; GetName());
01346 
01347             <span class="comment">// if could not find, just select first item.</span>
01348 
01349             <span class="keywordflow">if</span> (idSelect == LB_ERR) {
01350                 idSelect = 0;
01351             }
01352 
01353             <span class="comment">// Select it.</span>
01354 
01355             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETCURSEL, idSelect, 0);
01356         }
01357     }
01358 
01359     <span class="comment">//  03-08-1997  Bob_Kjelgaard@Prodigy.Net   Memphis RAID 18420</span>
01360     <span class="comment">//  Disable the Default button if there aren't any profiles</span>
01361 
01362     <span class="comment">// We do it here, because this gets called any time the list changes.       </span>
01363     <span class="comment">// only allow Default button to be enabled if</span>
01364     <span class="comment">// the dialog isn't read only.</span>
01365     <span class="comment">// the remove button should remain dissabled</span>
01366     <span class="comment">// under all conditions while the user is not</span>
01367     <span class="comment">// administrator.</span>
01368 
01369     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>) {
01370         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), FALSE);
01371     } <span class="keywordflow">else</span> {
01372         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultButton),
01373                      <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>());
01374     }
01375 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="CMonitorProfileManagement::InitList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CMonitorProfileManagement::InitList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b0">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01284">1284</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">CDeviceProfileManagement::InitList()</a>, and <a class="el" href="../../d7/d6/devprop_8h-source.html#l00177">m_uDefault</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">OnNotify()</a>.
<p>
<pre class="fragment"><div>01284                                             {
01285 
01286     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b0">CDeviceProfileManagement::InitList</a>();
01287 
01288     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() ? 0 : (<span class="keywordtype">unsigned</span>) -1;
01289 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CMonitorProfileManagement::OnCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CMonitorProfileManagement::OnCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wNotifyCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndCtl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a3">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01431">1431</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00077">AskRemoveDefault</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00066">DEVLIST_CHANGED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">FillList()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00177">m_uDefault</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01431">OnCommand()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01431">OnCommand()</a>.
<p>
<pre class="fragment"><div>01432                                                            {
01433 
01434     <span class="keywordflow">switch</span>  (wNotifyCode) {
01435 
01436         <span class="keywordflow">case</span>    LBN_DBLCLK: {
01437 
01438             <span class="comment">//  Retrieve the ID of the new default profile                      </span>
01439             <span class="comment">//  only accept dblclk changes if the dialog</span>
01440             <span class="comment">//  is not read only - i.e. user is admin</span>
01441 
01442             <span class="keywordflow">if</span>  (!<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>) {
01443 
01444                 <span class="keywordtype">int</span> <span class="keywordtype">id</span> = (<span class="keywordtype">int</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
01445                 <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, <span class="keywordtype">id</span>, 0);
01446 
01447                 <span class="comment">//  Change has been made, update the list</span>
01448 
01449                 <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
01450             }
01451 
01452             <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01453         }
01454 
01455         <span class="keywordflow">case</span>    BN_CLICKED:
01456 
01457             <span class="keywordflow">switch</span>  (wid) {
01458 
01459                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>: {
01460 
01461                     <span class="comment">//  Make sure we've tracked the default profile correctly</span>
01462                     <span class="comment">//  when a profile is removed.</span>
01463                     <span class="comment">//  All cases break, because we then want the base class to</span>
01464                     <span class="comment">//  process this message.</span>
01465 
01466                     LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
01467 
01468                     <span class="keywordtype">unsigned</span> uTarget = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA,
01469                         <span class="keywordtype">id</span>, 0);
01470 
01471                     <span class="keywordflow">if</span>  (uTarget &gt; <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> || <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1)
01472                         <span class="keywordflow">break</span>;  <span class="comment">//  Nothing here to worry about</span>
01473 
01474                     <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == uTarget) {
01475 
01476                         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(AskRemoveDefault, m_hwnd, FALSE,
01477                                                MB_YESNO|MB_ICONEXCLAMATION,0) == IDYES) {
01478 
01479                             <span class="comment">//  The default has been deleted- the profile</span>
01480                             <span class="comment">//  at the top of monitor profile list will be</span>
01481                             <span class="comment">//  made the default profile, if we have</span>
01482 
01483                             LRESULT itemCount = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCOUNT, 0, 0);
01484 
01485                             <span class="keywordflow">if</span> ((itemCount != LB_ERR) &amp;&amp; (itemCount &gt; 1)) {
01486                                 <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 0, 0);
01487                                 <span class="keywordflow">if</span> (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == uTarget) {
01488                                     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 1, 0);
01489                                 }
01490                             } <span class="keywordflow">else</span> {
01491                                 <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = -1;
01492                             }
01493 
01494                             <span class="keywordflow">break</span>;
01495                         } <span class="keywordflow">else</span> {
01496                             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; <span class="comment">// operation cancelled.</span>
01497                         }
01498                     }
01499 
01500                     <span class="keywordflow">if</span>  (uTarget &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01501                         <span class="keywordflow">break</span>;  <span class="comment">// We're fine</span>
01502 
01503                     <span class="comment">//  Must be an added profile below us in the list was</span>
01504                     <span class="comment">//  zapped- we need to decrement ourselves.</span>
01505 
01506                     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a>--;
01507                     <span class="keywordflow">break</span>;
01508                 }
01509 
01510                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a59">DefaultButton</a>: {
01511 
01512                     LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
01513 
01514                     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, <span class="keywordtype">id</span>, 0);
01515 
01516                     <span class="comment">//  Change has been made, update the list</span>
01517 
01518                     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
01519 
01520                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01521                 }
01522             }
01523 
01524         <span class="comment">//  Deliberate fall-through (use a break if you add a case here)</span>
01525     }
01526 
01527     <span class="comment">//  Use common command handling if not handled above</span>
01528     <span class="keywordflow">return</span>  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a3">CDeviceProfileManagement::OnCommand</a>(wNotifyCode, wid, hwndCtl);
01529 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="CMonitorProfileManagement::OnContextMenu" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CMonitorProfileManagement::OnContextMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a12">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01636">1636</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01267">MonitorUIHelpIds</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01636">OnContextMenu()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01636">OnContextMenu()</a>.
<p>
<pre class="fragment"><div>01636                                                           {
01637 
01638     WinHelp(hwnd, WINDOWS_HELP_FILE,
01639             HELP_CONTEXTMENU, (ULONG_PTR) (LPSTR) MonitorUIHelpIds);
01640 
01641     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01642 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="CMonitorProfileManagement::OnHelp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CMonitorProfileManagement::OnHelp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPHELPINFO&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pHelp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a11">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01626">1626</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01267">MonitorUIHelpIds</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01626">OnHelp()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01626">OnHelp()</a>.
<p>
<pre class="fragment"><div>01626                                                           {
01627 
01628     <span class="keywordflow">if</span> (pHelp-&gt;iContextType == HELPINFO_WINDOW) {
01629         WinHelp((HWND) pHelp-&gt;hItemHandle, WINDOWS_HELP_FILE,
01630             HELP_WM_HELP, (ULONG_PTR) (LPSTR) MonitorUIHelpIds);
01631     }
01632 
01633     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01634 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CMonitorProfileManagement::OnInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CMonitorProfileManagement::OnInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a2">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01397">1397</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00178">m_csDeviceFriendlyName</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00115">MonitorName</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">CDeviceProfileManagement::OnInit()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00768">SetDlgItemText()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01397                                           {
01398 
01399     <span class="comment">//  Do common initializations</span>
01400 
01401     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a2">CDeviceProfileManagement::OnInit</a>();
01402 
01403     <span class="comment">//  Mark the device name in the space provided</span>
01404 
01405     <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, MonitorName, m_csDeviceFriendlyName);
01406         
01407     <span class="comment">//  Now, see if we have sufficient authority to administer the monitor</span>
01408 
01409     <span class="keywordflow">if</span>(<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>) {
01410 
01411         <span class="comment">//  User is not Admin, Disable all of the controls</span>
01412 
01413         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, AddButton), FALSE);
01414         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), FALSE);
01415         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultButton), FALSE);
01416 
01417         <span class="comment">//  EnableWindow(m_hwndList, FALSE);</span>
01418 
01419         <span class="comment">//  Set the focus to the OK button</span>
01420 
01421         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwndSheet, IDOK));
01422         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;  <span class="comment">//  Because we moved the focus!</span>
01423     }
01424 
01425     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01426 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CMonitorProfileManagement::OnNotify" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CMonitorProfileManagement::OnNotify           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idCtrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPNMHDR&nbsp;</td>
          <td class="mdname" nowrap> <em>pnmh</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a4">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">1533</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01284">InitList()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00177">m_uDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00052">NoDefaultProfile</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">OnNotify()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">OnNotify()</a>.
<p>
<pre class="fragment"><div>01533                                                                     {
01534 
01535     <span class="keywordflow">switch</span>  (pnmh -&gt; code) {
01536 
01537         <span class="keywordflow">case</span>    PSN_APPLY: {
01538 
01539             <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
01540 
01541             <span class="comment">//  If nothing changed, nothing need to do.</span>
01542 
01543             <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>())
01544                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01545 
01546             <span class="comment">//  If the user hasn't selected a default, and we have</span>
01547             <span class="comment">//  associated profiles, then we can't allow this.</span>
01548 
01549             <span class="comment">//  03-08-1997  A-RobKj Fix for Memphis RAID 18416- if there's</span>
01550             <span class="comment">//  only one profile left, then it must be the default.</span>
01551 
01552             <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1 &amp;&amp; (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() +
01553                  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) &gt; 1) {
01554 
01555                 <a class="code" href="../../d0/d3/classCGlobals.html#e6">CGlobals::Report</a>(NoDefaultProfile, m_hwndSheet);
01556                 <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(m_hwnd, DWLP_MSGRESULT, PSNRET_INVALID_NOCHANGEPAGE);
01557                 <span class="keywordflow">break</span>;
01558             }
01559 
01560             <span class="comment">//  !!! This behavior is hardly depend on EnumColorProfiles() API !!!</span>
01561 
01562             <span class="comment">//  OK, if the default profile has changed, we have to delete default</span>
01563             <span class="comment">//  profile associations, and do the association for default profile</span>
01564             <span class="comment">//  in "last".</span>
01565 
01566             <span class="comment">//  Let the base class handle the cases where the default hasn't</span>
01567             <span class="comment">//  changed, or we started with no profiles and still have none.</span>
01568             <span class="comment">//</span>
01569             <span class="comment">//  03-08-1997  Sleazy code note.  The case where no default is</span>
01570             <span class="comment">//  selected but only one is assigned will now fall here.  Since the</span>
01571             <span class="comment">//  default happens to be the "last", and there only is one, letting</span>
01572             <span class="comment">//  the base class handle it is not a problem.  The list filling</span>
01573             <span class="comment">//  code will take care of the rest for us.</span>
01574 
01575             <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1) <span class="keywordflow">break</span>;
01576 
01577             <span class="comment">//  Remove default first (if default is associated), then associate later.</span>
01578 
01579             <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01580                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a>] -&gt; Dissociate(m_csDevice);
01581 
01582             <span class="comment">//  Now do the other removals (actually just dissociations)</span>
01583 
01584             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++) {
01585                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>[u]] -&gt; Dissociate(m_csDevice);
01586             }
01587 
01588             <span class="comment">//  Add in the new ones</span>
01589 
01590             <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u++) {
01591                 <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> &gt;= <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01592                     <span class="keywordflow">if</span>  (u == (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()))
01593                         <span class="keywordflow">continue</span>;   <span class="comment">// this is default, will be done later</span>
01594 
01595                 <span class="comment">//  OK, add it back in...</span>
01596                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[u] -&gt; Associate(m_csDevice);
01597             }
01598 
01599             <span class="comment">//  Finally, associate default profile.</span>
01600 
01601             <span class="keywordflow">if</span>  (<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01602                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a>] -&gt; Associate(m_csDevice);
01603             <span class="keywordflow">else</span>
01604                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[<a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()] -&gt; Associate(m_csDevice);
01605 
01606             <span class="comment">//  Update the various working structures...</span>
01607 
01608             <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b0">InitList</a>();
01609             <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b1">FillList</a>();
01610 
01611             <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(m_hwnd, DWLP_MSGRESULT, PSNRET_NOERROR);
01612 
01613             <span class="comment">//  Now, we have updated settings.</span>
01614 
01615             <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
01616         }
01617     }
01618 
01619     <span class="comment">//  Let the base class handle everything else</span>
01620 
01621     <span class="keywordflow">return</span>  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a4">CDeviceProfileManagement::OnNotify</a>(idCtrl, pnmh);
01622 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p1" doxytag="CMonitorProfileManagement::m_csDeviceFriendlyName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#p1">CMonitorProfileManagement::m_csDeviceFriendlyName</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00178">178</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01379">CMonitorProfileManagement()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01397">OnInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="CMonitorProfileManagement::m_uDefault" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#p0">CMonitorProfileManagement::m_uDefault</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00177">177</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01293">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01284">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01431">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01533">OnNotify()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a><li><a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
