<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mips/floatem.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>floatem.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>

<p>
<a href="../../d4/d3/mips_2floatem_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">_FP_CONTEXT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">_FP_DOUBLE_OPERAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">_FP_SINGLE_OPERAND</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a0">DOUBLE_SIGNAL_NAN_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (53 - 32))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a1">SINGLE_SIGNAL_NAN_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 24)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a2">DOUBLE_QUIET_NAN_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (51 - 32))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a3">SINGLE_QUIET_NAN_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 22)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a4">DOUBLE_QUIET_NAN_PREFIX</a>&nbsp;&nbsp;&nbsp;0x7ff00000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a5">SINGLE_QUIET_NAN_PREFIX</a>&nbsp;&nbsp;&nbsp;0x7f800000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a6">COMPARE_UNORDERED_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a7">COMPARE_EQUAL_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a8">COMPARE_LESS_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a9">COMPARE_ORDERED_MASK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">_FP_CONTEXT_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a10">FP_CONTEXT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">_FP_CONTEXT_BLOCK</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a11">PFP_CONTEXT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">_FP_DOUBLE_OPERAND</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a12">FP_DOUBLE_OPERAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">_FP_DOUBLE_OPERAND</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a13">PFP_DOUBLE_OPERAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">_FP_SINGLE_OPERAND</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a14">FP_SINGLE_OPERAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">_FP_SINGLE_OPERAND</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a15">PFP_SINGLE_OPERAND</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a16">KiDivideByZeroDouble</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand1, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a17">KiDivideByZeroSingle</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand1, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a18">KiInvalidCompareDouble</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN CheckForNan, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand1, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a19">KiInvalidCompareSingle</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN CheckForNan, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand1, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN CheckForNan, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand1, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a21">KiInvalidOperationLongword</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN Infinity, IN LONG Sign)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a22">KiInvalidOperationQuadword</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN Infinity, IN LONG Sign)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN BOOLEAN CheckForNan, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand1, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> ResultOperand, IN ULONG StickyBits)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a25">KiNormalizeLongword</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> ResultOperand)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a26">KiNormalizeQuadword</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> ResultOperand)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a> (IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> ResultOperand, IN ULONG StickyBits)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a28">KiSquareRootDouble</a> (IN PULARGE_INTEGER DoubleValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a29">KiSquareRootSingle</a> (IN PULONG SingleValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a30">KiUnpackDouble</a> (IN ULONG Source, IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, OUT <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a> DoubleOperand)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a31">KiUnpackSingle</a> (IN ULONG Source, IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a> ContextBlock, OUT <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a> SingleOperand)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/mips_2floatem_8c.html#a32">KiEmulateFloating</a> (IN OUT PEXCEPTION_RECORD ExceptionRecord, IN OUT PKEXCEPTION_FRAME ExceptionFrame, IN OUT PKTRAP_FRAME TrapFrame)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a7" doxytag="mips/floatem.c::COMPARE_EQUAL_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMPARE_EQUAL_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00091">91</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="mips/floatem.c::COMPARE_LESS_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMPARE_LESS_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00092">92</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="mips/floatem.c::COMPARE_ORDERED_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMPARE_ORDERED_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00093">93</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="mips/floatem.c::COMPARE_UNORDERED_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMPARE_UNORDERED_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00090">90</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="mips/floatem.c::DOUBLE_QUIET_NAN_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DOUBLE_QUIET_NAN_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (51 - 32))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00076">76</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mips/floatem.c::DOUBLE_QUIET_NAN_PREFIX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DOUBLE_QUIET_NAN_PREFIX&nbsp;&nbsp;&nbsp;0x7ff00000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00083">83</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="mips/floatem.c::DOUBLE_SIGNAL_NAN_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DOUBLE_SIGNAL_NAN_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (53 - 32))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00069">69</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="mips/floatem.c::SINGLE_QUIET_NAN_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SINGLE_QUIET_NAN_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 22)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00077">77</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="mips/floatem.c::SINGLE_QUIET_NAN_PREFIX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SINGLE_QUIET_NAN_PREFIX&nbsp;&nbsp;&nbsp;0x7f800000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00084">84</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l02688">KiInvalidOperationSingle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="mips/floatem.c::SINGLE_SIGNAL_NAN_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SINGLE_SIGNAL_NAN_MASK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 24)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00070">70</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02627">KiInvalidCompareSingle()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a10" doxytag="mips/floatem.c::FP_CONTEXT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">_FP_CONTEXT_BLOCK</a>  <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">FP_CONTEXT_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="mips/floatem.c::FP_DOUBLE_OPERAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">_FP_DOUBLE_OPERAND</a>  <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">FP_DOUBLE_OPERAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="mips/floatem.c::FP_SINGLE_OPERAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">_FP_SINGLE_OPERAND</a>  <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">FP_SINGLE_OPERAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="mips/floatem.c::PFP_CONTEXT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">_FP_CONTEXT_BLOCK</a> * <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="mips/floatem.c::PFP_DOUBLE_OPERAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">_FP_DOUBLE_OPERAND</a> * <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="mips/floatem.c::PFP_SINGLE_OPERAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">_FP_SINGLE_OPERAND</a> * <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a16" doxytag="mips/floatem.c::KiDivideByZeroDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiDivideByZeroDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="mips/floatem.c::KiDivideByZeroSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiDivideByZeroSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="mips/floatem.c::KiEmulateFloating" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiEmulateFloating           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">251</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00101">_FP_CONTEXT_BLOCK::BranchAddress</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00091">COMPARE_EQUAL_MASK</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00092">COMPARE_LESS_MASK</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00093">COMPARE_ORDERED_MASK</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00090">COMPARE_UNORDERED_MASK</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00103">_FP_CONTEXT_BLOCK::ExceptionFrame</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00102">_FP_CONTEXT_BLOCK::ExceptionRecord</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00122">_FP_DOUBLE_OPERAND::Exponent</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00130">_FP_SINGLE_OPERAND::Exponent</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00100">_FP_CONTEXT_BLOCK::Fd</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00124">_FP_DOUBLE_OPERAND::Infinity</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00132">_FP_SINGLE_OPERAND::Infinity</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d8/ppc_2exceptn_8c-source.html#l00886">KiCopyInformation()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a16">KiDivideByZeroDouble()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a17">KiDivideByZeroSingle()</a>, <a class="el" href="../../d8/d0/branchem_8c-source.html#l00030">KiEmulateBranch()</a>, <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00032">KiGetRegisterValue()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a18">KiInvalidCompareDouble()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02627">KiInvalidCompareSingle()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02820">KiInvalidOperationLongword()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02905">KiInvalidOperationQuadword()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l03105">KiNormalizeDouble()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l03574">KiNormalizeLongword()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a26">KiNormalizeQuadword()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a28">KiSquareRootDouble()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a29">KiSquareRootSingle()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a30">KiUnpackDouble()</a>, <a class="el" href="../../d3/d4/mips_2floatem_8c.html#a31">KiUnpackSingle()</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00119">_FP_DOUBLE_OPERAND::Mantissa</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00129">_FP_SINGLE_OPERAND::Mantissa</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00116">_FP_DOUBLE_OPERAND::MantissaHigh</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00115">_FP_DOUBLE_OPERAND::MantissaLow</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00125">_FP_DOUBLE_OPERAND::Nan</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00133">_FP_SINGLE_OPERAND::Nan</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00105">_FP_CONTEXT_BLOCK::Round</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00123">_FP_DOUBLE_OPERAND::Sign</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00131">_FP_SINGLE_OPERAND::Sign</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00104">_FP_CONTEXT_BLOCK::TrapFrame</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/mips_2exceptn_8c-source.html#l00313">KiDispatchException()</a>, and <a class="el" href="../../d9/d4/trigger_8c-source.html#l00079">KiFloatingException()</a>.
<p>
<pre class="fragment"><div>00259                    :
00260 
00261     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to emulate a floating operation and convert <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00262     exception status to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> proper value. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> an unimplemented
00263     operation, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> emulated. Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> status code <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00264     just converted to its proper value.
00265 
00266 Arguments:
00267 
00268     ExceptionRecord - Supplies a pointer to an exception record.
00269 
00270     ExceptionFrame - Supplies a pointer to an exception frame.
00271 
00272     TrapFrame - Supplies a pointer to a trap frame.
00273 
00274 Return Value:
00275 
00276     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> floating exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully
00277     emulated. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00278 
00279 --*/
00280 
00281 {
00282 
00283     ULARGE_INTEGER AhighBhigh;
00284     ULARGE_INTEGER AhighBlow;
00285     ULARGE_INTEGER AlowBhigh;
00286     ULARGE_INTEGER AlowBlow;
00287     ULONG Carry1;
00288     ULONG Carry2;
00289     BOOLEAN CompareEqual;
00290     ULONG CompareFunction;
00291     BOOLEAN CompareLess;
00292     <a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">FP_CONTEXT_BLOCK</a> ContextBlock;
00293     LARGE_INTEGER DoubleDividend;
00294     LARGE_INTEGER DoubleDivisor;
00295     ULARGE_INTEGER DoubleValue;
00296     ULONG DoubleMantissaLow;
00297     LONG DoubleMantissaHigh;
00298     <a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">FP_DOUBLE_OPERAND</a> DoubleOperand1;
00299     <a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">FP_DOUBLE_OPERAND</a> DoubleOperand2;
00300     <a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">FP_DOUBLE_OPERAND</a> DoubleOperand3;
00301     LARGE_INTEGER DoubleQuotient;
00302     PVOID ExceptionAddress;
00303     ULONG ExponentDifference;
00304     ULONG ExponentSum;
00305     ULONG Format;
00306     ULONG Fs;
00307     ULONG Ft;
00308     ULONG Function;
00309     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00310     MIPS_INSTRUCTION Instruction;
00311     ULARGE_INTEGER LargeResult;
00312     LONG Longword;
00313     LONG Negation;
00314     <span class="keyword">union </span>{
00315         LONGLONG Quadword;
00316         LARGE_INTEGER LargeValue;
00317     }u;
00318 
00319     LONG SingleMantissa;
00320     <a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">FP_SINGLE_OPERAND</a> SingleOperand1;
00321     <a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">FP_SINGLE_OPERAND</a> SingleOperand2;
00322     <a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">FP_SINGLE_OPERAND</a> SingleOperand3;
00323     ULONG SingleValue;
00324     ULONG StickyBits;
00325 
00326     <span class="comment">//</span>
00327     <span class="comment">// Save the original exception address in case another exception</span>
00328     <span class="comment">// occurs.</span>
00329     <span class="comment">//</span>
00330 
00331     ExceptionAddress = ExceptionRecord-&gt;ExceptionAddress;
00332 
00333     <span class="comment">//</span>
00334     <span class="comment">// Any exception that occurs during the attempted emulation of the</span>
00335     <span class="comment">// floating operation causes the emulation to be aborted. The new</span>
00336     <span class="comment">// exception code and information is copied to the original exception</span>
00337     <span class="comment">// record and a value of FALSE is returned.</span>
00338     <span class="comment">//</span>
00339 
00340     <span class="keywordflow">try</span> {
00341 
00342         <span class="comment">//</span>
00343         <span class="comment">// If the exception PC is equal to the fault instruction address</span>
00344         <span class="comment">// plus four, then the floating exception occurred in the delay</span>
00345         <span class="comment">// slot of a branch instruction and the continuation address must</span>
00346         <span class="comment">// be computed by emulating the branch instruction. Note that it</span>
00347         <span class="comment">// is possible for an exception to occur when the branch instruction</span>
00348         <span class="comment">// is read from user memory.</span>
00349         <span class="comment">//</span>
00350 
00351         <span class="keywordflow">if</span> ((TrapFrame-&gt;Fir + 4) == (ULONG)ExceptionRecord-&gt;ExceptionAddress) {
00352             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o9">BranchAddress</a> = <a class="code" href="../../d7/d1/branchem_8c.html#a0">KiEmulateBranch</a>(ExceptionFrame,
00353                                                          TrapFrame);
00354 
00355         } <span class="keywordflow">else</span> {
00356             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o9">BranchAddress</a> = TrapFrame-&gt;Fir + 4;
00357         }
00358 
00359         <span class="comment">//</span>
00360         <span class="comment">// Increment the floating emulation count.</span>
00361         <span class="comment">//</span>
00362 
00363         <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;KeFloatingEmulationCount += 1;
00364 
00365         <span class="comment">//</span>
00366         <span class="comment">// Initialize the address of the exception record, exception frame,</span>
00367         <span class="comment">// and trap frame in the context block used during the emulation of</span>
00368         <span class="comment">// the floating point operation.</span>
00369         <span class="comment">//</span>
00370 
00371         ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o1">ExceptionRecord</a> = ExceptionRecord;
00372         ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o2">ExceptionFrame</a> = ExceptionFrame;
00373         ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o3">TrapFrame</a> = TrapFrame;
00374         ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;RM;
00375 
00376         <span class="comment">//</span>
00377         <span class="comment">// Initialize the number of exception information parameters, set</span>
00378         <span class="comment">// the branch address, and clear the IEEE exception value.</span>
00379         <span class="comment">//</span>
00380 
00381         ExceptionRecord-&gt;NumberParameters = 6;
00382         ExceptionRecord-&gt;ExceptionInformation[0] = 0;
00383         ExceptionRecord-&gt;ExceptionInformation[1] = ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o9">BranchAddress</a>;
00384         ExceptionRecord-&gt;ExceptionInformation[2] = 0;
00385         ExceptionRecord-&gt;ExceptionInformation[3] = 0;
00386         ExceptionRecord-&gt;ExceptionInformation[4] = 0;
00387         ExceptionRecord-&gt;ExceptionInformation[5] = 0;
00388 
00389         <span class="comment">//</span>
00390         <span class="comment">// Clear all exception flags and emulate the floating point operation</span>
00391         <span class="comment">// The return value is dependent on the results of the emulation.</span>
00392         <span class="comment">//</span>
00393 
00394         TrapFrame-&gt;Fsr &amp;= ~(0x3f &lt;&lt; 12);
00395         Instruction = *((PMIPS_INSTRUCTION)ExceptionRecord-&gt;ExceptionAddress);
00396         Function = Instruction.c_format.Function;
00397         ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o8">Fd</a> = Instruction.c_format.Fd;
00398         Fs = Instruction.c_format.Fs;
00399         Ft = Instruction.c_format.Ft;
00400         Format = Instruction.c_format.Format;
00401         Negation = 0;
00402 
00403         <span class="comment">//</span>
00404         <span class="comment">// Check for illegal register specification or format code.</span>
00405         <span class="comment">//</span>
00406 
00407         <span class="keywordflow">if</span> (((ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o8">Fd</a> &amp; 0x1) != 0) || ((Fs &amp; 0x1) != 0) || ((Ft &amp; 0x1) != 0) ||
00408             ((Format != FORMAT_LONGWORD) &amp;&amp; (Format != FORMAT_QUADWORD) &amp;&amp; (Format &gt; FORMAT_DOUBLE))) {
00409             Function = FLOAT_ILLEGAL;
00410         }
00411 
00412         <span class="comment">//</span>
00413         <span class="comment">// Decode operand values and dispose with NaNs.</span>
00414         <span class="comment">//</span>
00415 
00416         <span class="keywordflow">if</span> ((Function &lt;= FLOAT_DIVIDE) || (Function &gt;= FLOAT_COMPARE)) {
00417 
00418             <span class="comment">//</span>
00419             <span class="comment">// The function has two operand values.</span>
00420             <span class="comment">//</span>
00421 
00422             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
00423                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a31">KiUnpackSingle</a>(Fs, &amp;ContextBlock, &amp;SingleOperand1);
00424                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a31">KiUnpackSingle</a>(Ft, &amp;ContextBlock, &amp;SingleOperand2);
00425 
00426                 <span class="comment">//</span>
00427                 <span class="comment">// If either operand is a NaN, then check to determine if a</span>
00428                 <span class="comment">// compare instruction or other dyadic operation is being</span>
00429                 <span class="comment">// performed.</span>
00430                 <span class="comment">//</span>
00431 
00432                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) || (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00433                     <span class="keywordflow">if</span> (Function &lt; FLOAT_COMPARE) {
00434 
00435                         <span class="comment">//</span>
00436                         <span class="comment">// Dyadic operation.</span>
00437                         <span class="comment">//</span>
00438                         <span class="comment">// Store a quite Nan if the invalid operation trap</span>
00439                         <span class="comment">// is disabled, or raise an exception if the invalid</span>
00440                         <span class="comment">// operation trap is enabled and either of the NaNs</span>
00441                         <span class="comment">// is a signally NaN.</span>
00442                         <span class="comment">//</span>
00443 
00444                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
00445                                                         TRUE,
00446                                                         &amp;SingleOperand1,
00447                                                         &amp;SingleOperand2);
00448 
00449                     } <span class="keywordflow">else</span> {
00450 
00451                         <span class="comment">//</span>
00452                         <span class="comment">// Compare operation.</span>
00453                         <span class="comment">//</span>
00454                         <span class="comment">// Set the condition based on the predicate of</span>
00455                         <span class="comment">// the floating comparison.</span>
00456                         <span class="comment">//</span>
00457                         <span class="comment">// If the compare is a signaling compare, then</span>
00458                         <span class="comment">// raise an exception if the invalid operation</span>
00459                         <span class="comment">// trap is enabled. Otherwise, raise an exception</span>
00460                         <span class="comment">// if one of the operands is a signaling NaN.</span>
00461                         <span class="comment">//</span>
00462 
00463                         <span class="keywordflow">if</span> ((Function &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a6">COMPARE_UNORDERED_MASK</a>) != 0) {
00464                             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 1;
00465 
00466                         } <span class="keywordflow">else</span> {
00467                             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 0;
00468                         }
00469 
00470                         <span class="keywordflow">if</span> ((Function &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a9">COMPARE_ORDERED_MASK</a>) != 0) {
00471                             <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a19">KiInvalidCompareSingle</a>(&amp;ContextBlock,
00472                                                           FALSE,
00473                                                           &amp;SingleOperand1,
00474                                                           &amp;SingleOperand2);
00475 
00476                         } <span class="keywordflow">else</span> {
00477                             <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a19">KiInvalidCompareSingle</a>(&amp;ContextBlock,
00478                                                           TRUE,
00479                                                           &amp;SingleOperand1,
00480                                                           &amp;SingleOperand2);
00481 
00482                         }
00483                     }
00484 
00485                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Function &gt;= FLOAT_COMPARE) {
00486                     CompareFunction = Function;
00487                     Function = FLOAT_COMPARE_SINGLE;
00488                 }
00489 
00490             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
00491                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a30">KiUnpackDouble</a>(Fs, &amp;ContextBlock, &amp;DoubleOperand1);
00492                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a30">KiUnpackDouble</a>(Ft, &amp;ContextBlock, &amp;DoubleOperand2);
00493 
00494                 <span class="comment">//</span>
00495                 <span class="comment">// If either operand is a NaN, then check to determine if a</span>
00496                 <span class="comment">// compare instruction or other dyadic operation is being</span>
00497                 <span class="comment">// performed.</span>
00498                 <span class="comment">//</span>
00499 
00500                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) || (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00501                     <span class="keywordflow">if</span> (Function &lt; FLOAT_COMPARE) {
00502 
00503                         <span class="comment">//</span>
00504                         <span class="comment">// Dyadic operation.</span>
00505                         <span class="comment">//</span>
00506                         <span class="comment">// Store a quite Nan if the invalid operation trap</span>
00507                         <span class="comment">// is disabled, or raise an exception if the invalid</span>
00508                         <span class="comment">// operation trap is enabled and either of the NaNs</span>
00509                         <span class="comment">// is a signally NaN.</span>
00510                         <span class="comment">//</span>
00511 
00512                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
00513                                                         TRUE,
00514                                                         &amp;DoubleOperand1,
00515                                                         &amp;DoubleOperand2);
00516 
00517                     } <span class="keywordflow">else</span> {
00518 
00519                         <span class="comment">//</span>
00520                         <span class="comment">// Compare operation.</span>
00521                         <span class="comment">//</span>
00522                         <span class="comment">// Set the condition based on the predicate of</span>
00523                         <span class="comment">// the floating comparison.</span>
00524                         <span class="comment">//</span>
00525                         <span class="comment">// If the compare is a signaling compare, then</span>
00526                         <span class="comment">// raise an exception if the invalid operation</span>
00527                         <span class="comment">// trap is enabled. Othersie, raise an exception</span>
00528                         <span class="comment">// if one of the operands is a signaling NaN.</span>
00529                         <span class="comment">//</span>
00530 
00531                         <span class="keywordflow">if</span> ((Function &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a6">COMPARE_UNORDERED_MASK</a>) != 0) {
00532                             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 1;
00533 
00534                         } <span class="keywordflow">else</span> {
00535                             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 0;
00536                         }
00537 
00538                         <span class="keywordflow">if</span> ((Function &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a9">COMPARE_ORDERED_MASK</a>) != 0) {
00539                             <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a18">KiInvalidCompareDouble</a>(&amp;ContextBlock,
00540                                                           FALSE,
00541                                                           &amp;DoubleOperand1,
00542                                                           &amp;DoubleOperand2);
00543 
00544                         } <span class="keywordflow">else</span> {
00545                             <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a18">KiInvalidCompareDouble</a>(&amp;ContextBlock,
00546                                                           TRUE,
00547                                                           &amp;DoubleOperand1,
00548                                                           &amp;DoubleOperand2);
00549 
00550                         }
00551                     }
00552 
00553                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Function &gt;= FLOAT_COMPARE) {
00554                     CompareFunction = Function;
00555                     Function = FLOAT_COMPARE_DOUBLE;
00556                 }
00557 
00558             } <span class="keywordflow">else</span> {
00559                 Function = FLOAT_ILLEGAL;
00560             }
00561 
00562         } <span class="keywordflow">else</span> {
00563 
00564             <span class="comment">//</span>
00565             <span class="comment">// The function has one operand value.</span>
00566             <span class="comment">//</span>
00567 
00568             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
00569                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a31">KiUnpackSingle</a>(Fs, &amp;ContextBlock, &amp;SingleOperand1);
00570 
00571                 <span class="comment">//</span>
00572                 <span class="comment">// If the operand is a NaN and the function is not a convert</span>
00573                 <span class="comment">// operation, then store a quiet NaN if the invalid operation</span>
00574                 <span class="comment">// trap is disabled, or raise an exception if the invalid</span>
00575                 <span class="comment">// operation trap is enabled and the operand is a signaling</span>
00576                 <span class="comment">// NaN.</span>
00577                 <span class="comment">//</span>
00578 
00579                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00580                     (Function &lt; FLOAT_ROUND_QUADWORD) ||
00581                     (Function &gt; FLOAT_CONVERT_QUADWORD) ||
00582                     ((Function &gt; FLOAT_FLOOR_LONGWORD) &amp;&amp;
00583                     (Function &lt; FLOAT_CONVERT_SINGLE))) {
00584                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
00585                                                     TRUE,
00586                                                     &amp;SingleOperand1,
00587                                                     &amp;SingleOperand1);
00588 
00589                 }
00590 
00591             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
00592                 <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a30">KiUnpackDouble</a>(Fs, &amp;ContextBlock, &amp;DoubleOperand1);
00593 
00594                 <span class="comment">//</span>
00595                 <span class="comment">// If the operand is a NaN and the function is not a convert</span>
00596                 <span class="comment">// operation, then store a quiet NaN if the invalid operation</span>
00597                 <span class="comment">// trap is disabled, or raise an exception if the invalid</span>
00598                 <span class="comment">// operation trap is enabled and the operand is a signaling</span>
00599                 <span class="comment">// NaN.</span>
00600                 <span class="comment">//</span>
00601 
00602                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00603                     (Function &lt; FLOAT_ROUND_QUADWORD) ||
00604                     (Function &gt; FLOAT_CONVERT_QUADWORD) ||
00605                     ((Function &gt; FLOAT_FLOOR_LONGWORD) &amp;&amp;
00606                     (Function &lt; FLOAT_CONVERT_SINGLE))) {
00607                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
00608                                                     TRUE,
00609                                                     &amp;DoubleOperand1,
00610                                                     &amp;DoubleOperand1);
00611                 }
00612 
00613             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Format == FORMAT_LONGWORD) &amp;&amp;
00614                        (Function &gt;= FLOAT_CONVERT_SINGLE)) {
00615                 Longword = <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a0">KiGetRegisterValue</a>(Fs + 32,
00616                                               ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o2">ExceptionFrame</a>,
00617                                               ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o3">TrapFrame</a>);
00618 
00619             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Format == FORMAT_QUADWORD) &amp;&amp;
00620                        (Function &gt;= FLOAT_CONVERT_SINGLE)) {
00621                 u.LargeValue.LowPart = <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a0">KiGetRegisterValue</a>(Fs + 32,
00622                                                           ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o2">ExceptionFrame</a>,
00623                                                           ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o3">TrapFrame</a>);
00624 
00625                 u.LargeValue.HighPart = <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a0">KiGetRegisterValue</a>(Fs + 33,
00626                                                            ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o2">ExceptionFrame</a>,
00627                                                            ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o3">TrapFrame</a>);
00628 
00629             } <span class="keywordflow">else</span> {
00630                 Function = FLOAT_ILLEGAL;
00631             }
00632         }
00633 
00634         <span class="comment">//</span>
00635         <span class="comment">// Case to the proper function routine to emulate the operation.</span>
00636         <span class="comment">//</span>
00637 
00638         <span class="keywordflow">switch</span> (Function) {
00639 
00640             <span class="comment">//</span>
00641             <span class="comment">// Floating subtract operation.</span>
00642             <span class="comment">//</span>
00643             <span class="comment">// Floating subtract is accomplished by complementing the sign</span>
00644             <span class="comment">// of the second operand and then performing an add operation.</span>
00645             <span class="comment">//</span>
00646 
00647         <span class="keywordflow">case</span> FLOAT_SUBTRACT:
00648             Negation = 0x1;
00649 
00650             <span class="comment">//</span>
00651             <span class="comment">// Floating add operation.</span>
00652             <span class="comment">//</span>
00653             <span class="comment">// Floating add is accomplished using signed magnitude addition.</span>
00654             <span class="comment">//</span>
00655             <span class="comment">// The exponent difference is calculated and the smaller number</span>
00656             <span class="comment">// is right shifted by the specified amount, but no more than</span>
00657             <span class="comment">// the width of the operand values (i.e., 26 for single and 55</span>
00658             <span class="comment">// for double). The shifted out value is saved for rounding.</span>
00659             <span class="comment">//</span>
00660             <span class="comment">// If the signs of the two operands are the same, then they</span>
00661             <span class="comment">// are added together after having performed the alignment</span>
00662             <span class="comment">// shift.</span>
00663             <span class="comment">//</span>
00664             <span class="comment">// If the signs of the two operands are different, then the</span>
00665             <span class="comment">// sign of the result is the sign of the larger operand and</span>
00666             <span class="comment">// the smaller operand is subtracted from the larger operand.</span>
00667             <span class="comment">// In order to avoid making a double level test (i.e., one on</span>
00668             <span class="comment">// the exponents, and one on the mantissas if the exponents</span>
00669             <span class="comment">// are equal), it is posible that the result of the subtract</span>
00670             <span class="comment">// could be negative (if the exponents are equal). If this</span>
00671             <span class="comment">// occurs, then the result sign and mantissa are complemented</span>
00672             <span class="comment">// to obtain the correct result.</span>
00673             <span class="comment">//</span>
00674 
00675         <span class="keywordflow">case</span> FLOAT_ADD:
00676             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
00677 
00678                 <span class="comment">//</span>
00679                 <span class="comment">// Complement the sign of the second operand if the operation</span>
00680                 <span class="comment">// is subtraction.</span>
00681                 <span class="comment">//</span>
00682 
00683                 SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= Negation;
00684 
00685                 <span class="comment">//</span>
00686                 <span class="comment">// Reorder then operands according to their exponent value.</span>
00687                 <span class="comment">//</span>
00688 
00689                 <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &gt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
00690                     SingleOperand3 = SingleOperand2;
00691                     SingleOperand2 = SingleOperand1;
00692                     SingleOperand1 = SingleOperand3;
00693                 }
00694 
00695                 <span class="comment">//</span>
00696                 <span class="comment">// Compute the exponent difference and shift the smaller</span>
00697                 <span class="comment">// mantissa right by the difference value or 26 which ever</span>
00698                 <span class="comment">// is smaller. The bits shifted out are termed the sticky</span>
00699                 <span class="comment">// bits and are used later in the rounding operation.</span>
00700                 <span class="comment">//</span>
00701 
00702                 ExponentDifference =
00703                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> - SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>;
00704 
00705                 <span class="keywordflow">if</span> (ExponentDifference &gt; 26) {
00706                     ExponentDifference = 26;
00707                 }
00708 
00709                 StickyBits =
00710                         SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &amp; ((1 &lt;&lt; ExponentDifference) - 1);
00711                 SingleMantissa = SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt;&gt; ExponentDifference;
00712 
00713                 <span class="comment">//</span>
00714                 <span class="comment">// If the operands both have the same sign, then perform the</span>
00715                 <span class="comment">// operation by adding the values together. Otherwise, perform</span>
00716                 <span class="comment">// the operation by subtracting the second operand from the</span>
00717                 <span class="comment">// first operand.</span>
00718                 <span class="comment">//</span>
00719 
00720                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^ SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>) == 0) {
00721                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> += SingleMantissa;
00722 
00723                 } <span class="keywordflow">else</span> {
00724                     <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00725                         (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00726                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
00727                                                         FALSE,
00728                                                         &amp;SingleOperand1,
00729                                                         &amp;SingleOperand2);
00730 
00731                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00732                         <span class="keywordflow">if</span> (StickyBits != 0) {
00733                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> -= 1;
00734                         }
00735 
00736                         SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> -= SingleMantissa;
00737                         <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt; 0) {
00738                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = -SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>;
00739                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= 0x1;
00740                         }
00741                     }
00742                 }
00743 
00744                 <span class="comment">//</span>
00745                 <span class="comment">// Normalize and store the result value.</span>
00746                 <span class="comment">//</span>
00747 
00748                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
00749                                          &amp;SingleOperand1,
00750                                          StickyBits);
00751 
00752             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
00753 
00754                 <span class="comment">//</span>
00755                 <span class="comment">// Complement the sign of the second operand if the operation</span>
00756                 <span class="comment">// is subtraction.</span>
00757                 <span class="comment">//</span>
00758 
00759                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= Negation;
00760 
00761                 <span class="comment">//</span>
00762                 <span class="comment">// Reorder then operands according to their exponent value.</span>
00763                 <span class="comment">//</span>
00764 
00765                 <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &gt; DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
00766                     DoubleOperand3 = DoubleOperand2;
00767                     DoubleOperand2 = DoubleOperand1;
00768                     DoubleOperand1 = DoubleOperand3;
00769                 }
00770 
00771                 <span class="comment">//</span>
00772                 <span class="comment">// Compute the exponent difference and shift the smaller</span>
00773                 <span class="comment">// mantissa right by the difference value or 55 which ever</span>
00774                 <span class="comment">// is smaller. The bits shifted out are termed the sticky</span>
00775                 <span class="comment">// bits and are used later in the rounding operation.</span>
00776                 <span class="comment">//</span>
00777 
00778                 ExponentDifference =
00779                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> - DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>;
00780 
00781                 <span class="keywordflow">if</span> (ExponentDifference &gt; 55) {
00782                     ExponentDifference = 55;
00783                 }
00784 
00785                 <span class="keywordflow">if</span> (ExponentDifference &gt;= 32) {
00786                     ExponentDifference -= 32;
00787                     StickyBits = (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>) |
00788                         (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &amp; ((1 &lt;&lt; ExponentDifference) - 1));
00789 
00790                     DoubleMantissaLow =
00791                         DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &gt;&gt; ExponentDifference;
00792 
00793                     DoubleMantissaHigh = 0;
00794 
00795                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ExponentDifference &gt; 0) {
00796                     StickyBits =
00797                         DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &amp; ((1 &lt;&lt; ExponentDifference) - 1);
00798 
00799                     DoubleMantissaLow =
00800                         (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; ExponentDifference) |
00801                         (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; (32 - ExponentDifference));
00802 
00803                     DoubleMantissaHigh =
00804                         DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &gt;&gt; ExponentDifference;
00805 
00806                 } <span class="keywordflow">else</span> {
00807                     StickyBits = 0;
00808                     DoubleMantissaLow = DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>;
00809                     DoubleMantissaHigh = DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>;
00810                 }
00811 
00812                 <span class="comment">//</span>
00813                 <span class="comment">// If the operands both have the same sign, then perform the</span>
00814                 <span class="comment">// operation by adding the values together. Otherwise, perform</span>
00815                 <span class="comment">// the operation by subtracting the second operand from the</span>
00816                 <span class="comment">// first operand.</span>
00817                 <span class="comment">//</span>
00818 
00819                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^ DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>) == 0) {
00820                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> += DoubleMantissaLow;
00821                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> += DoubleMantissaHigh;
00822                     <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; DoubleMantissaLow) {
00823                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> += 1;
00824                     }
00825 
00826                 } <span class="keywordflow">else</span> {
00827                     <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00828                         (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00829                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
00830                                                         FALSE,
00831                                                         &amp;DoubleOperand1,
00832                                                         &amp;DoubleOperand2);
00833 
00834                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00835                         <span class="keywordflow">if</span> (StickyBits != 0) {
00836                             <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; 1) {
00837                                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> -= 1;
00838                             }
00839 
00840                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> -= 1;
00841                         }
00842 
00843                         <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; DoubleMantissaLow) {
00844                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> -= 1;
00845                         }
00846 
00847                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> -= DoubleMantissaLow;
00848                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> -= DoubleMantissaHigh;
00849                         <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt; 0) {
00850                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = ~DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> + 1;
00851                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> = -DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>;
00852                             <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> != 0) {
00853                                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> -= 1;
00854                             }
00855 
00856                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= 0x1;
00857                         }
00858                     }
00859                 }
00860 
00861                 <span class="comment">//</span>
00862                 <span class="comment">// Normalize and store the result value.</span>
00863                 <span class="comment">//</span>
00864 
00865                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
00866                                          &amp;DoubleOperand1,
00867                                          StickyBits);
00868 
00869             } <span class="keywordflow">else</span> {
00870                 <span class="keywordflow">break</span>;
00871             }
00872 
00873             <span class="comment">//</span>
00874             <span class="comment">// Floating multiply operation.</span>
00875             <span class="comment">//</span>
00876             <span class="comment">// Floating multiply is accomplished using unsigned multiplies</span>
00877             <span class="comment">// of the mantissa values, and adding the parital results together</span>
00878             <span class="comment">// to form the total product.</span>
00879             <span class="comment">//</span>
00880             <span class="comment">// The two mantissa values are preshifted such that the final</span>
00881             <span class="comment">// result is properly aligned.</span>
00882             <span class="comment">//</span>
00883 
00884         <span class="keywordflow">case</span> FLOAT_MULTIPLY:
00885             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
00886 
00887                 <span class="comment">//</span>
00888                 <span class="comment">// Reorder the operands according to their exponent value.</span>
00889                 <span class="comment">//</span>
00890 
00891                 <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &gt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
00892                     SingleOperand3 = SingleOperand2;
00893                     SingleOperand2 = SingleOperand1;
00894                     SingleOperand1 = SingleOperand3;
00895                 }
00896 
00897                 <span class="comment">//</span>
00898                 <span class="comment">// If the first operand is infinite and the second operand is</span>
00899                 <span class="comment">// zero, then an invalid operation is specified.</span>
00900                 <span class="comment">//</span>
00901 
00902                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00903                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00904                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0)) {
00905                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
00906                                                     FALSE,
00907                                                     &amp;SingleOperand1,
00908                                                     &amp;SingleOperand2);
00909 
00910                 }
00911 
00912                 <span class="comment">//</span>
00913                 <span class="comment">// Preshift the operand mantissas so the result will be a</span>
00914                 <span class="comment">// properly aligned 64-bit value and then unsigned multiply</span>
00915                 <span class="comment">// the two mantissa values. The single result is the high part</span>
00916                 <span class="comment">// of the 64-bit product and the sticky bits are the low part</span>
00917                 <span class="comment">// of the 64-bit product.</span>
00918                 <span class="comment">//</span>
00919 
00920                 LargeResult.QuadPart = UInt32x32To64(SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; (32 - 26),
00921                                                      SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; 1);
00922 
00923                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = LargeResult.HighPart;
00924                 StickyBits = LargeResult.LowPart;
00925 
00926                 <span class="comment">//</span>
00927                 <span class="comment">// Compute the sign and exponent of the result.</span>
00928                 <span class="comment">//</span>
00929 
00930                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
00931                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> +=
00932                             SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> - SINGLE_EXPONENT_BIAS;
00933 
00934                 <span class="comment">//</span>
00935                 <span class="comment">// Normalize and store the result value.</span>
00936                 <span class="comment">//</span>
00937 
00938                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
00939                                          &amp;SingleOperand1,
00940                                          StickyBits);
00941 
00942             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
00943 
00944                 <span class="comment">//</span>
00945                 <span class="comment">// Reorder the operands according to their exponent value.</span>
00946                 <span class="comment">//</span>
00947 
00948                 <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &gt; DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
00949                     DoubleOperand3 = DoubleOperand2;
00950                     DoubleOperand2 = DoubleOperand1;
00951                     DoubleOperand1 = DoubleOperand3;
00952                 }
00953 
00954                 <span class="comment">//</span>
00955                 <span class="comment">// If the first operand is infinite and the second operand is</span>
00956                 <span class="comment">// zero, then an invalid operation is specified.</span>
00957                 <span class="comment">//</span>
00958 
00959                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00960                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00961                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0)) {
00962                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
00963                                                     FALSE,
00964                                                     &amp;DoubleOperand1,
00965                                                     &amp;DoubleOperand2);
00966 
00967                 }
00968 
00969                 <span class="comment">//</span>
00970                 <span class="comment">// Preshift the operand mantissas so the result will be a</span>
00971                 <span class="comment">// properly aligned 128-bit value and then unsigned multiply</span>
00972                 <span class="comment">// the two mantissa values. The double result is the high part</span>
00973                 <span class="comment">// of the 128-bit product and the sticky bits are the low part</span>
00974                 <span class="comment">// of the 128-bit product.</span>
00975                 <span class="comment">//</span>
00976 
00977                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> =
00978                         (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; 1) |
00979                                 (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; 31);
00980 
00981                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt;&lt;= 1;
00982                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> =
00983                         (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; (64 - 55)) |
00984                                 (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; (32 - (64 -55)));
00985 
00986                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt;&lt;= (64 - 55);
00987 
00988                 <span class="comment">//</span>
00989                 <span class="comment">// The 128-bit product is formed by mutiplying and adding</span>
00990                 <span class="comment">// all the cross product values.</span>
00991                 <span class="comment">//</span>
00992                 <span class="comment">// Consider the operands (A and B) as being composed of two</span>
00993                 <span class="comment">// parts Ahigh, Alow, Bhigh, and Blow. The cross product sum</span>
00994                 <span class="comment">// is then:</span>
00995                 <span class="comment">//</span>
00996                 <span class="comment">//       Ahigh * Bhigh * 2^64 +</span>
00997                 <span class="comment">//              Ahigh * Blow * 2^32 +</span>
00998                 <span class="comment">//              Alow * Bhigh * 2^32 +</span>
00999                 <span class="comment">//                              Alow * Blow</span>
01000                 <span class="comment">//</span>
01001 
01002                 AhighBhigh.QuadPart = UInt32x32To64(DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>,
01003                                                     DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>);
01004 
01005                 AhighBlow.QuadPart = UInt32x32To64(DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>,
01006                                                    DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>);
01007 
01008                 AlowBhigh.QuadPart = UInt32x32To64(DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>,
01009                                                    DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>);
01010 
01011                 AlowBlow.QuadPart = UInt32x32To64(DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>,
01012                                                   DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>);
01013 
01014                 AlowBlow.HighPart += AhighBlow.LowPart;
01015                 <span class="keywordflow">if</span> (AlowBlow.HighPart &lt; AhighBlow.LowPart) {
01016                     Carry1 = 1;
01017 
01018                 } <span class="keywordflow">else</span> {
01019                     Carry1 = 0;
01020                 }
01021 
01022                 AlowBlow.HighPart += AlowBhigh.LowPart;
01023                 <span class="keywordflow">if</span> (AlowBlow.HighPart &lt; AlowBhigh.LowPart) {
01024                     Carry1 += 1;
01025                 }
01026 
01027                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = AhighBlow.HighPart + Carry1;
01028                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; Carry1) {
01029                     Carry2 = 1;
01030 
01031                 } <span class="keywordflow">else</span> {
01032                     Carry2 = 0;
01033                 }
01034 
01035                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> += AlowBhigh.HighPart;
01036                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; AlowBhigh.HighPart) {
01037                     Carry2 += 1;
01038                 }
01039 
01040                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> += AhighBhigh.LowPart;
01041                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt; AhighBhigh.LowPart) {
01042                     Carry2 += 1;
01043                 }
01044 
01045                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> = AhighBhigh.HighPart + Carry2;
01046                 StickyBits = AlowBlow.HighPart | AlowBlow.LowPart;
01047 
01048                 <span class="comment">//</span>
01049                 <span class="comment">// Compute the sign and exponent of the result.</span>
01050                 <span class="comment">//</span>
01051 
01052                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01053                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> +=
01054                             DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> - DOUBLE_EXPONENT_BIAS;
01055 
01056                 <span class="comment">//</span>
01057                 <span class="comment">// Normalize and store the result value.</span>
01058                 <span class="comment">//</span>
01059 
01060                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01061                                          &amp;DoubleOperand1,
01062                                          StickyBits);
01063 
01064             } <span class="keywordflow">else</span> {
01065                 <span class="keywordflow">break</span>;
01066             }
01067 
01068             <span class="comment">//</span>
01069             <span class="comment">// Floating divide operation.</span>
01070             <span class="comment">//</span>
01071             <span class="comment">// Floating division is accomplished by repeated subtract using</span>
01072             <span class="comment">// a single one-bit-at-a-time algorithm. The number of division</span>
01073             <span class="comment">// steps performed is equal to the mantissa size plus one guard</span>
01074             <span class="comment">// bit.</span>
01075             <span class="comment">//</span>
01076             <span class="comment">// The sticky bits are the remainder after the specified number</span>
01077             <span class="comment">// of division steps.</span>
01078             <span class="comment">//</span>
01079 
01080         <span class="keywordflow">case</span> FLOAT_DIVIDE:
01081             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01082 
01083                 <span class="comment">//</span>
01084                 <span class="comment">// If the first operand is infinite and the second operand</span>
01085                 <span class="comment">// is infinite, or both operands are zero, then an invalid</span>
01086                 <span class="comment">// operation is specified.</span>
01087                 <span class="comment">//</span>
01088 
01089                 <span class="keywordflow">if</span> (((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01090                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) ||
01091                     ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01092                     (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0) &amp;&amp;
01093                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01094                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0))) {
01095                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
01096                                                     FALSE,
01097                                                     &amp;SingleOperand1,
01098                                                     &amp;SingleOperand2);
01099 
01100                 }
01101 
01102                 <span class="comment">//</span>
01103                 <span class="comment">// If the second operand is zero, then a divide by zero</span>
01104                 <span class="comment">// operation is specified.</span>
01105                 <span class="comment">//</span>
01106 
01107                 <span class="keywordflow">if</span> ((SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01108                     (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0)) {
01109                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a17">KiDivideByZeroSingle</a>(&amp;ContextBlock,
01110                                                 &amp;SingleOperand1,
01111                                                 &amp;SingleOperand2);
01112                 }
01113 
01114                 <span class="comment">//</span>
01115                 <span class="comment">// If the first operand is infinite, then the result is</span>
01116                 <span class="comment">// infinite. Otherwise, if the second operand is infinite,</span>
01117                 <span class="comment">// then the result is zero (note that both operands cannot</span>
01118                 <span class="comment">// be infinite).</span>
01119                 <span class="comment">//</span>
01120 
01121                 <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01122                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
01123                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01124                                              &amp;SingleOperand1,
01125                                              0);
01126 
01127                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01128                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
01129                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = 0;
01130                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = 0;
01131                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01132                                              &amp;SingleOperand1,
01133                                              0);
01134 
01135                 }
01136 
01137                 <span class="comment">//</span>
01138                 <span class="comment">// Perform divide operation by repeating a single bit</span>
01139                 <span class="comment">// divide step 26 iterations.</span>
01140                 <span class="comment">//</span>
01141 
01142                 SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = 0;
01143                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; 26; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
01144                     SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt;=1;
01145                     <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt;= SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>) {
01146                         SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> -= SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>;
01147                         SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> |= 1;
01148                     }
01149 
01150                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt;= 1;
01151                 }
01152 
01153                 <span class="comment">//</span>
01154                 <span class="comment">// Compute the sign and exponent of the result.</span>
01155                 <span class="comment">//</span>
01156 
01157                 SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^ SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
01158                 SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> -
01159                                 SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> + SINGLE_EXPONENT_BIAS;
01160 
01161                 <span class="comment">//</span>
01162                 <span class="comment">// Normalize and store the result value.</span>
01163                 <span class="comment">//</span>
01164 
01165                 SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01166                 SingleOperand3.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01167                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01168                                          &amp;SingleOperand3,
01169                                          SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>);
01170 
01171             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01172 
01173                 <span class="comment">//</span>
01174                 <span class="comment">// If the first operand is infinite and the second operand</span>
01175                 <span class="comment">// is infinite, or both operands are zero, then an invalid</span>
01176                 <span class="comment">// operation is specified.</span>
01177                 <span class="comment">//</span>
01178 
01179                 <span class="keywordflow">if</span> (((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01180                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) ||
01181                     ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01182                     (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0) &amp;&amp;
01183                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01184                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0))) {
01185                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
01186                                                     FALSE,
01187                                                     &amp;DoubleOperand1,
01188                                                     &amp;DoubleOperand2);
01189 
01190                 }
01191 
01192                 <span class="comment">//</span>
01193                 <span class="comment">// If the second operand is zero, then a divide by zero</span>
01194                 <span class="comment">// operation is specified.</span>
01195                 <span class="comment">//</span>
01196 
01197                 <span class="keywordflow">if</span> ((DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01198                     (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0)) {
01199                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a16">KiDivideByZeroDouble</a>(&amp;ContextBlock,
01200                                                 &amp;DoubleOperand1,
01201                                                 &amp;DoubleOperand2);
01202                 }
01203 
01204                 <span class="comment">//</span>
01205                 <span class="comment">// If the first operand is infinite, then the result is</span>
01206                 <span class="comment">// infinite. Otherwise, if the second operand is infinite,</span>
01207                 <span class="comment">// then the result is zero (note that both operands cannot</span>
01208                 <span class="comment">// be infinite).</span>
01209                 <span class="comment">//</span>
01210 
01211                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01212                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01213                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01214                                              &amp;DoubleOperand1,
01215                                              0);
01216 
01217                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01218                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01219                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = 0;
01220                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> = 0;
01221                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = 0;
01222                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01223                                              &amp;DoubleOperand1,
01224                                              0);
01225 
01226                 }
01227 
01228                 <span class="comment">//</span>
01229                 <span class="comment">// Perform divide operation by repeating a single bit</span>
01230                 <span class="comment">// divide step 55 iterations.</span>
01231                 <span class="comment">//</span>
01232 
01233                 DoubleDividend.LowPart = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>;
01234                 DoubleDividend.HighPart = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>;
01235                 DoubleDivisor.LowPart = DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>;
01236                 DoubleDivisor.HighPart = DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>;
01237                 DoubleQuotient.LowPart = 0;
01238                 DoubleQuotient.HighPart = 0;
01239                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; 55; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
01240                     DoubleQuotient.HighPart =
01241                                 (DoubleQuotient.HighPart &lt;&lt; 1) |
01242                                                 DoubleQuotient.LowPart &gt;&gt; 31;
01243 
01244                     DoubleQuotient.LowPart &lt;&lt;= 1;
01245                     <span class="keywordflow">if</span> (DoubleDividend.QuadPart &gt;= DoubleDivisor.QuadPart) {
01246                         DoubleDividend.QuadPart -= DoubleDivisor.QuadPart;
01247                         DoubleQuotient.LowPart |= 1;
01248                     }
01249 
01250                     DoubleDividend.HighPart =
01251                                 (DoubleDividend.HighPart &lt;&lt; 1) |
01252                                                 DoubleDividend.LowPart &gt;&gt; 31;
01253 
01254                     DoubleDividend.LowPart &lt;&lt;= 1;
01255                 }
01256 
01257                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = DoubleQuotient.LowPart;
01258                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> = DoubleQuotient.HighPart;
01259 
01260                 <span class="comment">//</span>
01261                 <span class="comment">// Compute the sign and exponent of the result.</span>
01262                 <span class="comment">//</span>
01263 
01264                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^ DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01265                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> -
01266                                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> + DOUBLE_EXPONENT_BIAS;
01267 
01268                 <span class="comment">//</span>
01269                 <span class="comment">// Normalize and store the result value.</span>
01270                 <span class="comment">//</span>
01271 
01272                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01273                 DoubleOperand3.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01274                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01275                                          &amp;DoubleOperand3,
01276                                          DoubleDividend.LowPart | DoubleDividend.HighPart);
01277 
01278             } <span class="keywordflow">else</span> {
01279                 <span class="keywordflow">break</span>;
01280             }
01281 
01282             <span class="comment">//</span>
01283             <span class="comment">// Floating square root.</span>
01284             <span class="comment">//</span>
01285 
01286         <span class="keywordflow">case</span> FLOAT_SQUARE_ROOT:
01287             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01288 
01289                 <span class="comment">//</span>
01290                 <span class="comment">// If the operand is plus infinity, then the result is</span>
01291                 <span class="comment">// plus infinity, or if the operand is plus or minus</span>
01292                 <span class="comment">// zero, then the result is plus or minus zero.</span>
01293                 <span class="comment">//</span>
01294 
01295                 <span class="keywordflow">if</span> (((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> == 0) &amp;&amp;
01296                    (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) ||
01297                    (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0)) {
01298                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01299                                              &amp;SingleOperand1,
01300                                              0);
01301                 }
01302 
01303                 <span class="comment">//</span>
01304                 <span class="comment">// If the operand is negative, then the operation is</span>
01305                 <span class="comment">// invalid.</span>
01306                 <span class="comment">//</span>
01307 
01308                 <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> != 0) {
01309                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
01310                                                     FALSE,
01311                                                     &amp;SingleOperand1,
01312                                                     &amp;SingleOperand1);
01313                 }
01314 
01315                 <span class="comment">//</span>
01316                 <span class="comment">// The only case remaining that could cause an exception</span>
01317                 <span class="comment">// is a denomalized source value. The square root of a</span>
01318                 <span class="comment">// denormalized value is computed by:</span>
01319                 <span class="comment">//</span>
01320                 <span class="comment">//   1. Converting the value to a normalized value with</span>
01321                 <span class="comment">//      an exponent equal to the denormalization shift count</span>
01322                 <span class="comment">//      plus the bias of the exponent plus one.</span>
01323                 <span class="comment">//</span>
01324                 <span class="comment">//   2. Computing the square root of the value and unpacking</span>
01325                 <span class="comment">//      the result.</span>
01326                 <span class="comment">//</span>
01327                 <span class="comment">//   3. Converting the shift count back to a normalization</span>
01328                 <span class="comment">//      shift count.</span>
01329                 <span class="comment">//</span>
01330                 <span class="comment">//   4. Rounding and packing the resultant value.</span>
01331                 <span class="comment">//</span>
01332                 <span class="comment">// N.B. The square root of all denormalized number is a</span>
01333                 <span class="comment">//      normalized number.</span>
01334                 <span class="comment">//</span>
01335 
01336                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = (SINGLE_EXPONENT_BIAS + 1 +
01337                                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) &lt;&lt; 23;
01338 
01339                 SingleValue = (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &amp; ~(1 &lt;&lt; 25)) &gt;&gt; 2;
01340                 SingleValue |= SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>;
01341                 StickyBits = <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a29">KiSquareRootSingle</a>(&amp;SingleValue);
01342                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> =  (SingleValue &gt;&gt; 23) -
01343                                             ((SINGLE_EXPONENT_BIAS + 1) / 2);
01344 
01345                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = ((SingleValue &amp;
01346                                             0x7fffff) | 0x800000) &lt;&lt; 2;
01347 
01348                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01349                                          &amp;SingleOperand1,
01350                                          StickyBits);
01351 
01352             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01353 
01354                 <span class="comment">//</span>
01355                 <span class="comment">// If the operand is plus infinity, then the result is</span>
01356                 <span class="comment">// plus infinity, or if the operand is plus or minus</span>
01357                 <span class="comment">// zero, then the result is plus or minus zero.</span>
01358                 <span class="comment">//</span>
01359 
01360                 <span class="keywordflow">if</span> (((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> == 0) &amp;&amp;
01361                    (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) ||
01362                    (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0)) {
01363                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01364                                              &amp;DoubleOperand1,
01365                                              0);
01366                 }
01367 
01368                 <span class="comment">//</span>
01369                 <span class="comment">// If the operand is negative, then the operation is</span>
01370                 <span class="comment">// invalid.</span>
01371                 <span class="comment">//</span>
01372 
01373                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> != 0) {
01374                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
01375                                                     FALSE,
01376                                                     &amp;DoubleOperand1,
01377                                                     &amp;DoubleOperand1);
01378                 }
01379 
01380                 <span class="comment">//</span>
01381                 <span class="comment">// The only case remaining that could cause an exception</span>
01382                 <span class="comment">// is a denomalized source value. The square root of a</span>
01383                 <span class="comment">// denormalized value is computed by:</span>
01384                 <span class="comment">//</span>
01385                 <span class="comment">//   1. Converting the value to a normalized value with</span>
01386                 <span class="comment">//      an exponent equal to the denormalization shift count</span>
01387                 <span class="comment">//      plus the bias of the exponent plus one.</span>
01388                 <span class="comment">//</span>
01389                 <span class="comment">//   2. Computing the square root of the value and unpacking</span>
01390                 <span class="comment">//      the result.</span>
01391                 <span class="comment">//</span>
01392                 <span class="comment">//   3. Converting the shift count back to a normalization</span>
01393                 <span class="comment">//      shift count.</span>
01394                 <span class="comment">//</span>
01395                 <span class="comment">//   4. Rounding and packing the resultant value.</span>
01396                 <span class="comment">//</span>
01397                 <span class="comment">// N.B. The square root of all denormalized numbers is a</span>
01398                 <span class="comment">//      normalized number.</span>
01399                 <span class="comment">//</span>
01400 
01401                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = (DOUBLE_EXPONENT_BIAS + 1 +
01402                                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) &lt;&lt; 20;
01403 
01404                 DoubleValue.HighPart = (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &amp; ~(1 &lt;&lt; 22)) &gt;&gt; 2;
01405                 DoubleValue.LowPart = (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; 30) |
01406                                             (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; 2);
01407 
01408                 DoubleValue.HighPart |= DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>;
01409                 StickyBits = <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a28">KiSquareRootDouble</a>(&amp;DoubleValue);
01410                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> =  (DoubleValue.HighPart &gt;&gt; 20) -
01411                                             ((DOUBLE_EXPONENT_BIAS + 1) / 2);
01412 
01413                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = DoubleValue.LowPart &lt;&lt; 2;
01414                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> = ((DoubleValue.HighPart &amp;
01415                                             0xfffff) | 0x100000) &lt;&lt; 2;
01416 
01417                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> |= (DoubleValue.LowPart &gt;&gt; 30);
01418                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01419                                          &amp;DoubleOperand1,
01420                                          StickyBits);
01421 
01422             } <span class="keywordflow">else</span> {
01423                 <span class="keywordflow">break</span>;
01424             }
01425 
01426             <span class="comment">//</span>
01427             <span class="comment">// Floating absolute operation.</span>
01428             <span class="comment">//</span>
01429             <span class="comment">// Floating absolute is accomplished by clearing the sign</span>
01430             <span class="comment">// of the floating value.</span>
01431             <span class="comment">//</span>
01432 
01433         <span class="keywordflow">case</span> FLOAT_ABSOLUTE:
01434             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01435 
01436                 <span class="comment">//</span>
01437                 <span class="comment">// Clear the sign, normalize the result, and store in the</span>
01438                 <span class="comment">// destination register.</span>
01439                 <span class="comment">//</span>
01440 
01441                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0;
01442                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01443                                          &amp;SingleOperand1,
01444                                          0);
01445 
01446             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01447 
01448                 <span class="comment">//</span>
01449                 <span class="comment">// Clear the sign, normalize the result, and store in the</span>
01450                 <span class="comment">// destination register.</span>
01451                 <span class="comment">//</span>
01452 
01453                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0;
01454                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01455                                          &amp;DoubleOperand1,
01456                                          0);
01457 
01458             } <span class="keywordflow">else</span> {
01459                 <span class="keywordflow">break</span>;
01460             }
01461 
01462             <span class="comment">//</span>
01463             <span class="comment">// Floating move operation.</span>
01464             <span class="comment">//</span>
01465             <span class="comment">// Floating move is accomplished by moving the source operand</span>
01466             <span class="comment">// to the destination register.</span>
01467             <span class="comment">//</span>
01468 
01469         <span class="keywordflow">case</span> FLOAT_MOVE:
01470             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01471 
01472                 <span class="comment">//</span>
01473                 <span class="comment">// Normalize the result and store in the destination</span>
01474                 <span class="comment">// register.</span>
01475                 <span class="comment">//</span>
01476 
01477                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01478                                          &amp;SingleOperand1,
01479                                          0);
01480 
01481             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01482 
01483                 <span class="comment">//</span>
01484                 <span class="comment">// Normalize the result and store in the destination</span>
01485                 <span class="comment">// register.</span>
01486                 <span class="comment">//</span>
01487 
01488                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01489                                          &amp;DoubleOperand1,
01490                                          0);
01491 
01492             } <span class="keywordflow">else</span> {
01493                 <span class="keywordflow">break</span>;
01494             }
01495 
01496             <span class="comment">//</span>
01497             <span class="comment">// Floating negate operation.</span>
01498             <span class="comment">//</span>
01499             <span class="comment">// Floating absolute is accomplished by complementing the sign</span>
01500             <span class="comment">// of the floating value.</span>
01501             <span class="comment">//</span>
01502 
01503         <span class="keywordflow">case</span> FLOAT_NEGATE:
01504             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01505 
01506                 <span class="comment">//</span>
01507                 <span class="comment">// Complement the sign, normalize the result, and store in the</span>
01508                 <span class="comment">// destination register.</span>
01509                 <span class="comment">//</span>
01510 
01511                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> ^= 0x1;
01512                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01513                                          &amp;SingleOperand1,
01514                                          0);
01515 
01516             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01517 
01518                 <span class="comment">//</span>
01519                 <span class="comment">// Complement the sign, normalize the result, and store in the</span>
01520                 <span class="comment">// destination register.</span>
01521                 <span class="comment">//</span>
01522 
01523                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> ^= 0x1;
01524                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
01525                                          &amp;DoubleOperand1,
01526                                          0);
01527 
01528             } <span class="keywordflow">else</span> {
01529                 <span class="keywordflow">break</span>;
01530             }
01531 
01532             <span class="comment">//</span>
01533             <span class="comment">// Floating compare single.</span>
01534             <span class="comment">//</span>
01535             <span class="comment">// This operation is performed after having separated out NaNs,</span>
01536             <span class="comment">// and therefore the only comparison predicates left are equal</span>
01537             <span class="comment">// and less.</span>
01538             <span class="comment">//</span>
01539             <span class="comment">// Floating compare single is accomplished by comparing signs,</span>
01540             <span class="comment">// then exponents, and finally the mantissa if necessary.</span>
01541             <span class="comment">//</span>
01542             <span class="comment">// N.B. The sign of zero is ignorned.</span>
01543             <span class="comment">//</span>
01544 
01545         <span class="keywordflow">case</span> FLOAT_COMPARE_SINGLE:
01546 
01547             <span class="comment">//</span>
01548             <span class="comment">// If either operand is zero, then set the sign of the operand</span>
01549             <span class="comment">// positive.</span>
01550             <span class="comment">//</span>
01551 
01552             <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01553                 (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0)) {
01554                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0;
01555                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = - 23;
01556             }
01557 
01558             <span class="keywordflow">if</span> ((SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)  &amp;&amp;
01559                 (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> == 0)) {
01560                 SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0;
01561                 SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = - 23;
01562             }
01563 
01564             <span class="comment">//</span>
01565             <span class="comment">// Compare signs first.</span>
01566             <span class="comment">//</span>
01567 
01568             <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> &lt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>) {
01569 
01570                 <span class="comment">//</span>
01571                 <span class="comment">// The first operand is greater than the second operand.</span>
01572                 <span class="comment">//</span>
01573 
01574                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01575                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01576 
01577             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> &gt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>) {
01578 
01579                 <span class="comment">//</span>
01580                 <span class="comment">// The first operand is less than the second operand.</span>
01581                 <span class="comment">//</span>
01582 
01583                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01584                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01585 
01586             } <span class="keywordflow">else</span> {
01587 
01588                 <span class="comment">//</span>
01589                 <span class="comment">// The operand signs are equal.</span>
01590                 <span class="comment">//</span>
01591                 <span class="comment">// If the sign of the operand is negative, then the sense of</span>
01592                 <span class="comment">// the comparison is reversed.</span>
01593                 <span class="comment">//</span>
01594 
01595                 <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> == 0) {
01596 
01597                     <span class="comment">//</span>
01598                     <span class="comment">// Compare positive operand with positive operand.</span>
01599                     <span class="comment">//</span>
01600 
01601                     <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &gt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
01602                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01603                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01604 
01605                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &lt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
01606                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01607                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01608 
01609                     } <span class="keywordflow">else</span> {
01610                         <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>) {
01611                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01612                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01613 
01614                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt; SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>) {
01615                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01616                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01617 
01618                         } <span class="keywordflow">else</span> {
01619                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01620                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01621                         }
01622                     }
01623 
01624                 } <span class="keywordflow">else</span> {
01625 
01626                     <span class="comment">//</span>
01627                     <span class="comment">// Compare negative operand with negative operand.</span>
01628                     <span class="comment">//</span>
01629 
01630                     <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &gt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
01631                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01632                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01633 
01634                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> &lt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a>) {
01635                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01636                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01637 
01638                     } <span class="keywordflow">else</span> {
01639                         <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>) {
01640                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01641                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01642 
01643                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SingleOperand2.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt; SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a>) {
01644                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01645                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01646 
01647                         } <span class="keywordflow">else</span> {
01648                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01649                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01650                         }
01651                     }
01652                 }
01653             }
01654 
01655             <span class="comment">//</span>
01656             <span class="comment">// Form the condition code using the comparison information</span>
01657             <span class="comment">// and the compare function predicate bits.</span>
01658             <span class="comment">//</span>
01659 
01660             <span class="keywordflow">if</span> (((CompareLess != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01661                 ((CompareFunction &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a8">COMPARE_LESS_MASK</a>) != 0)) ||
01662                 ((CompareEqual != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01663                 ((CompareFunction &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a7">COMPARE_EQUAL_MASK</a>) != 0))) {
01664                 ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 1;
01665 
01666             } <span class="keywordflow">else</span> {
01667                 ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 0;
01668             }
01669 
01670             TrapFrame-&gt;Fir = ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o9">BranchAddress</a>;
01671             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01672 
01673             <span class="comment">//</span>
01674             <span class="comment">// Floating compare double.</span>
01675             <span class="comment">//</span>
01676             <span class="comment">// This operation is performed after having separated out NaNs,</span>
01677             <span class="comment">// and therefore the only comparison predicates left are equal</span>
01678             <span class="comment">// and less.</span>
01679             <span class="comment">//</span>
01680             <span class="comment">// Floating compare double is accomplished by comparing signs,</span>
01681             <span class="comment">// then exponents, and finally the mantissa if necessary.</span>
01682             <span class="comment">//</span>
01683             <span class="comment">// N.B. The sign of zero is ignorned.</span>
01684             <span class="comment">//</span>
01685 
01686         <span class="keywordflow">case</span> FLOAT_COMPARE_DOUBLE:
01687 
01688             <span class="comment">//</span>
01689             <span class="comment">// If either operand is zero, then set the sign of the operand</span>
01690             <span class="comment">// positive.</span>
01691             <span class="comment">//</span>
01692 
01693             <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01694                 (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0)) {
01695                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0;
01696                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = - 52;
01697             }
01698 
01699             <span class="keywordflow">if</span> ((DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01700                 (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> == 0)) {
01701                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0;
01702                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = - 52;
01703             }
01704 
01705             <span class="comment">//</span>
01706             <span class="comment">// Compare signs first.</span>
01707             <span class="comment">//</span>
01708 
01709             <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> &lt; DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>) {
01710 
01711                 <span class="comment">//</span>
01712                 <span class="comment">// The first operand is greater than the second operand.</span>
01713                 <span class="comment">//</span>
01714 
01715                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01716                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01717 
01718             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> &gt; DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>) {
01719 
01720                 <span class="comment">//</span>
01721                 <span class="comment">// The first operand is less than the second operand.</span>
01722                 <span class="comment">//</span>
01723 
01724                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01725                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01726 
01727             } <span class="keywordflow">else</span> {
01728 
01729                 <span class="comment">//</span>
01730                 <span class="comment">// The operand signs are equal.</span>
01731                 <span class="comment">//</span>
01732                 <span class="comment">// If the sign of the operand is negative, then the sense of</span>
01733                 <span class="comment">// the comparison is reversed.</span>
01734                 <span class="comment">//</span>
01735 
01736                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> == 0) {
01737 
01738                     <span class="comment">//</span>
01739                     <span class="comment">// Compare positive operand with positive operand.</span>
01740                     <span class="comment">//</span>
01741 
01742                     <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &gt; DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
01743                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01744                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01745 
01746                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &lt; DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
01747                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01748                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01749 
01750                     } <span class="keywordflow">else</span> {
01751                         <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &gt;
01752                             DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>) {
01753                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01754                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01755 
01756                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;
01757                                    DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>) {
01758                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01759                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01760 
01761                         } <span class="keywordflow">else</span> {
01762                             <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;
01763                                 DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>) {
01764                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01765                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01766 
01767                             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt;
01768                                        DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>) {
01769                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01770                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01771 
01772                             } <span class="keywordflow">else</span> {
01773                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01774                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01775                             }
01776                         }
01777                     }
01778 
01779                 } <span class="keywordflow">else</span> {
01780 
01781                     <span class="comment">//</span>
01782                     <span class="comment">// Compare negative operand with negative operand.</span>
01783                     <span class="comment">//</span>
01784 
01785                     <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &gt; DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
01786                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01787                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01788 
01789                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> &lt; DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a>) {
01790                         CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01791                         CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01792 
01793                     } <span class="keywordflow">else</span> {
01794                         <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &gt;
01795                             DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>) {
01796                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01797                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01798 
01799                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;
01800                                    DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a>) {
01801                             CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01802                             CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01803 
01804                         } <span class="keywordflow">else</span> {
01805                             <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;
01806                                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>) {
01807                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01808                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01809 
01810                             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DoubleOperand2.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt;
01811                                        DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a>) {
01812                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01813                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01814 
01815                             } <span class="keywordflow">else</span> {
01816                                 CompareEqual = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01817                                 CompareLess = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01818                             }
01819                         }
01820                     }
01821                 }
01822             }
01823 
01824             <span class="comment">//</span>
01825             <span class="comment">// Form the condition code using the comparison information</span>
01826             <span class="comment">// and the compare function predicate bits.</span>
01827             <span class="comment">//</span>
01828 
01829             <span class="keywordflow">if</span> (((CompareLess != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01830                 ((CompareFunction &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a8">COMPARE_LESS_MASK</a>) != 0)) ||
01831                 ((CompareEqual != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
01832                 ((CompareFunction &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a7">COMPARE_EQUAL_MASK</a>) != 0))) {
01833                 ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 1;
01834 
01835             } <span class="keywordflow">else</span> {
01836                 ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;CC = 0;
01837             }
01838 
01839             TrapFrame-&gt;Fir = ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o9">BranchAddress</a>;
01840             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01841 
01842             <span class="comment">//</span>
01843             <span class="comment">// Floating convert to single.</span>
01844             <span class="comment">//</span>
01845             <span class="comment">// This operation is only legal for conversion from quadword,</span>
01846             <span class="comment">// longword, and double formats to single format. This operation</span>
01847             <span class="comment">// can not be used to convert from a single format to a single format.</span>
01848             <span class="comment">//</span>
01849             <span class="comment">// Floating conversion to single is accompished by forming a</span>
01850             <span class="comment">// single floating operand and then normalize and storing the</span>
01851             <span class="comment">// result value.</span>
01852             <span class="comment">//</span>
01853 
01854         <span class="keywordflow">case</span> FLOAT_CONVERT_SINGLE:
01855             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
01856                 <span class="keywordflow">break</span>;
01857 
01858             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
01859 
01860                 <span class="comment">//</span>
01861                 <span class="comment">// If the operand is a NaN, then store a quiet NaN if the</span>
01862                 <span class="comment">// invalid operation trap is disabled, or raise an exception</span>
01863                 <span class="comment">// if the invalid operation trap is enabled and the operand</span>
01864                 <span class="comment">// is a signaling NaN.</span>
01865                 <span class="comment">//</span>
01866 
01867                 <span class="keywordflow">if</span> (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01868                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> =
01869                         (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; (26 - (55 - 32))) |
01870                         (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; (32 - (26 - (55 - 32))));
01871                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = SINGLE_MAXIMUM_EXPONENT;
01872                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01873                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01874                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01875                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a23">KiInvalidOperationSingle</a>(&amp;ContextBlock,
01876                                                     TRUE,
01877                                                     &amp;SingleOperand1,
01878                                                     &amp;SingleOperand1);
01879 
01880                 }
01881 
01882                 <span class="comment">//</span>
01883                 <span class="comment">// Transform the double operand to single format.</span>
01884                 <span class="comment">//</span>
01885 
01886                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> =
01887                     (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> &lt;&lt; (26 - (55 - 32))) |
01888                     (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &gt;&gt; (32 - (26 - (55 - 32))));
01889                 StickyBits = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> &lt;&lt; (26 - (55 - 32));
01890                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> +
01891                                     SINGLE_EXPONENT_BIAS - DOUBLE_EXPONENT_BIAS;
01892                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>;
01893                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> = DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a>;
01894                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01895 
01896                 <span class="comment">//</span>
01897                 <span class="comment">// Normalize and store the result value.</span>
01898                 <span class="comment">//</span>
01899 
01900                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01901                                          &amp;SingleOperand1,
01902                                          StickyBits);
01903 
01904             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_LONGWORD) {
01905 
01906                 <span class="comment">//</span>
01907                 <span class="comment">// Compute the sign of the result.</span>
01908                 <span class="comment">//</span>
01909 
01910                 <span class="keywordflow">if</span> (Longword &lt; 0) {
01911                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0x1;
01912                     Longword = -Longword;
01913 
01914                 } <span class="keywordflow">else</span> {
01915                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0;
01916                 }
01917 
01918                 <span class="comment">//</span>
01919                 <span class="comment">// Initialize the infinity and NaN values.</span>
01920                 <span class="comment">//</span>
01921 
01922                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01923                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01924 
01925                 <span class="comment">//</span>
01926                 <span class="comment">// Compute the exponent value and normalize the longword</span>
01927                 <span class="comment">// value.</span>
01928                 <span class="comment">//</span>
01929 
01930                 <span class="keywordflow">if</span> (Longword != 0) {
01931                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = SINGLE_EXPONENT_BIAS + 31;
01932                     <span class="keywordflow">while</span> (Longword &gt; 0) {
01933                         Longword &lt;&lt;= 1;
01934                         SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> -= 1;
01935                     }
01936 
01937                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = (ULONG)Longword &gt;&gt; (32 - 26);
01938                     StickyBits = Longword &lt;&lt; 26;
01939 
01940                 } <span class="keywordflow">else</span> {
01941                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = 0;
01942                     StickyBits = 0;
01943                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = 0;
01944                 }
01945 
01946                 <span class="comment">//</span>
01947                 <span class="comment">// Normalize and store the result value.</span>
01948                 <span class="comment">//</span>
01949 
01950                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
01951                                          &amp;SingleOperand1,
01952                                          StickyBits);
01953 
01954             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_QUADWORD) {
01955 
01956                 <span class="comment">//</span>
01957                 <span class="comment">// Compute the sign of the result.</span>
01958                 <span class="comment">//</span>
01959 
01960                 <span class="keywordflow">if</span> (u.Quadword &lt; 0) {
01961                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0x1;
01962                     u.Quadword = -u.Quadword;
01963 
01964                 } <span class="keywordflow">else</span> {
01965                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a> = 0;
01966                 }
01967 
01968                 <span class="comment">//</span>
01969                 <span class="comment">// Initialize the infinity and NaN values.</span>
01970                 <span class="comment">//</span>
01971 
01972                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01973                 SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01974 
01975                 <span class="comment">//</span>
01976                 <span class="comment">// Compute the exponent value and normalize the quadword</span>
01977                 <span class="comment">// value.</span>
01978                 <span class="comment">//</span>
01979 
01980                 <span class="keywordflow">if</span> (u.Quadword != 0) {
01981                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = SINGLE_EXPONENT_BIAS + 63;
01982                     <span class="keywordflow">while</span> (u.Quadword &gt; 0) {
01983                         u.Quadword &lt;&lt;= 1;
01984                         SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> -= 1;
01985                     }
01986 
01987                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = (LONG)((ULONGLONG)u.Quadword &gt;&gt; (64 - 26));
01988                     StickyBits = (u.Quadword &lt;&lt; 26) ? 1 : 0;
01989 
01990                 } <span class="keywordflow">else</span> {
01991                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> = 0;
01992                     StickyBits = 0;
01993                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = 0;
01994                 }
01995 
01996                 <span class="comment">//</span>
01997                 <span class="comment">// Normalize and store the result value.</span>
01998                 <span class="comment">//</span>
01999 
02000                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a27">KiNormalizeSingle</a>(&amp;ContextBlock,
02001                                          &amp;SingleOperand1,
02002                                          StickyBits);
02003 
02004             } <span class="keywordflow">else</span> {
02005                 <span class="keywordflow">break</span>;
02006             }
02007 
02008             <span class="comment">//</span>
02009             <span class="comment">// Floating convert to double.</span>
02010             <span class="comment">//</span>
02011             <span class="comment">// This operation is only legal for conversion from quadword,</span>
02012             <span class="comment">// longword, and single formats to double format. This operation</span>
02013             <span class="comment">// cannot be used to convert from a double format to a double</span>
02014             <span class="comment">// format.</span>
02015             <span class="comment">//</span>
02016             <span class="comment">// Floating conversion to double is accomplished by forming</span>
02017             <span class="comment">// double floating operand and then normalizing and storing</span>
02018             <span class="comment">// the result value.</span>
02019             <span class="comment">//</span>
02020 
02021         <span class="keywordflow">case</span> FLOAT_CONVERT_DOUBLE:
02022             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
02023 
02024                 <span class="comment">//</span>
02025                 <span class="comment">// If the operand is a NaN, then store a quiet NaN if the</span>
02026                 <span class="comment">// invalid operation trap is disabled, or raise an exception</span>
02027                 <span class="comment">// if the invalid operation trap is enabled and the operand</span>
02028                 <span class="comment">// is a signaling NaN.</span>
02029                 <span class="comment">//</span>
02030 
02031                 <span class="keywordflow">if</span> (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02032                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> =
02033                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt;&gt; (26 - (55 - 32));
02034                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> = (0xffffffff &gt;&gt; (26 - 2 - (55 - 32))) |
02035                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; (32 - (26 - (55 - 32)));
02036                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = DOUBLE_MAXIMUM_EXPONENT;
02037                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
02038                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02039                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02040                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a20">KiInvalidOperationDouble</a>(&amp;ContextBlock,
02041                                                     TRUE,
02042                                                     &amp;DoubleOperand1,
02043                                                     &amp;DoubleOperand1);
02044 
02045                 }
02046 
02047                 <span class="comment">//</span>
02048                 <span class="comment">// Transform the single operand to double format.</span>
02049                 <span class="comment">//</span>
02050 
02051                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> =
02052                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt;&gt; (26 - (55 - 32));
02053                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> =
02054                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; (32 - (26 - (55 - 32)));
02055                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> +
02056                                     DOUBLE_EXPONENT_BIAS - SINGLE_EXPONENT_BIAS;
02057                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
02058                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a>;
02059                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02060 
02061                 <span class="comment">//</span>
02062                 <span class="comment">// Normalize and store the result value.</span>
02063                 <span class="comment">//</span>
02064 
02065                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
02066                                          &amp;DoubleOperand1,
02067                                          0);
02068 
02069             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
02070                 <span class="keywordflow">break</span>;
02071 
02072             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_LONGWORD) {
02073 
02074                 <span class="comment">//</span>
02075                 <span class="comment">// Compute the sign of the result.</span>
02076                 <span class="comment">//</span>
02077 
02078                 <span class="keywordflow">if</span> (Longword &lt; 0) {
02079                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0x1;
02080                     Longword = -Longword;
02081 
02082                 } <span class="keywordflow">else</span> {
02083                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0;
02084                 }
02085 
02086                 <span class="comment">//</span>
02087                 <span class="comment">// Initialize the infinity and NaN values.</span>
02088                 <span class="comment">//</span>
02089 
02090                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02091                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02092 
02093                 <span class="comment">//</span>
02094                 <span class="comment">// Compute the exponent value and normalize the longword</span>
02095                 <span class="comment">// value.</span>
02096                 <span class="comment">//</span>
02097 
02098                 <span class="keywordflow">if</span> (Longword != 0) {
02099                     SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> = DOUBLE_EXPONENT_BIAS + 31;
02100                     <span class="keywordflow">while</span> (Longword &gt; 0) {
02101                         Longword &lt;&lt;= 1;
02102                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> -= 1;
02103                     }
02104 
02105                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o2">Mantissa</a> = (ULONGLONG)Longword &gt;&gt; (64 - 55);
02106 
02107                 } <span class="keywordflow">else</span> {
02108                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o2">Mantissa</a> = 0;
02109                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = 0;
02110                 }
02111 
02112                 <span class="comment">//</span>
02113                 <span class="comment">// Normalize and store the result value.</span>
02114                 <span class="comment">//</span>
02115 
02116                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
02117                                          &amp;DoubleOperand1,
02118                                          0);
02119 
02120             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_QUADWORD) {
02121 
02122                 <span class="comment">//</span>
02123                 <span class="comment">// Compute the sign of the result.</span>
02124                 <span class="comment">//</span>
02125 
02126                 <span class="keywordflow">if</span> (u.Quadword &lt; 0) {
02127                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0x1;
02128                     u.Quadword = -u.Quadword;
02129 
02130                 } <span class="keywordflow">else</span> {
02131                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = 0;
02132                 }
02133 
02134                 <span class="comment">//</span>
02135                 <span class="comment">// Initialize the infinity and NaN values.</span>
02136                 <span class="comment">//</span>
02137 
02138                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02139                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02140 
02141                 <span class="comment">//</span>
02142                 <span class="comment">// Compute the exponent value and normalize the quadword</span>
02143                 <span class="comment">// value.</span>
02144                 <span class="comment">//</span>
02145 
02146                 <span class="keywordflow">if</span> (u.Quadword != 0) {
02147                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = DOUBLE_EXPONENT_BIAS + 63;
02148                     <span class="keywordflow">while</span> (u.Quadword &gt; 0) {
02149                         u.Quadword &lt;&lt;= 1;
02150                         DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> -= 1;
02151                     }
02152 
02153                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o2">Mantissa</a> = (ULONGLONG)u.Quadword &gt;&gt; (64 - 55);
02154                     StickyBits = (u.Quadword &lt;&lt; 55) ? 1 : 0;
02155 
02156                 } <span class="keywordflow">else</span> {
02157                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o2">Mantissa</a> = 0;
02158                     StickyBits = 0;
02159                     DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = 0;
02160                 }
02161 
02162                 <span class="comment">//</span>
02163                 <span class="comment">// Normalize and store the result value.</span>
02164                 <span class="comment">//</span>
02165 
02166                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a24">KiNormalizeDouble</a>(&amp;ContextBlock,
02167                                          &amp;DoubleOperand1,
02168                                          StickyBits);
02169 
02170             } <span class="keywordflow">else</span> {
02171                 <span class="keywordflow">break</span>;
02172             }
02173 
02174             <span class="comment">//</span>
02175             <span class="comment">// Floating convert to quadword.</span>
02176             <span class="comment">//</span>
02177             <span class="comment">// This operation is only legal for conversion from double</span>
02178             <span class="comment">// and single formats to quadword format. This operation</span>
02179             <span class="comment">// cannot be used to convert from a quadword format to a</span>
02180             <span class="comment">// longword or quadword format.</span>
02181             <span class="comment">//</span>
02182             <span class="comment">// Floating conversion to quadword is accomplished by forming</span>
02183             <span class="comment">// a quadword value from a single or double floating value.</span>
02184             <span class="comment">//</span>
02185             <span class="comment">// There is one general conversion operation and four directed</span>
02186             <span class="comment">// rounding operations.</span>
02187             <span class="comment">//</span>
02188 
02189         <span class="keywordflow">case</span> FLOAT_ROUND_QUADWORD:
02190             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_NEAREST;
02191             <span class="keywordflow">goto</span> ConvertQuadword;
02192 
02193         <span class="keywordflow">case</span> FLOAT_TRUNC_QUADWORD:
02194             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_ZERO;
02195             <span class="keywordflow">goto</span> ConvertQuadword;
02196 
02197         <span class="keywordflow">case</span> FLOAT_CEIL_QUADWORD:
02198             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_PLUS_INFINITY;
02199             <span class="keywordflow">goto</span> ConvertQuadword;
02200 
02201         <span class="keywordflow">case</span> FLOAT_FLOOR_QUADWORD:
02202             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_MINUS_INFINITY;
02203             <span class="keywordflow">goto</span> ConvertQuadword;
02204 
02205         <span class="keywordflow">case</span> FLOAT_CONVERT_QUADWORD:
02206         ConvertQuadword:
02207             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
02208 
02209                 <span class="comment">//</span>
02210                 <span class="comment">// If the operand is infinite or is a NaN, then store a</span>
02211                 <span class="comment">// quiet NaN or an appropriate infinity if the invalid</span>
02212                 <span class="comment">// operation trap is disabled, or raise an exception if</span>
02213                 <span class="comment">// the invalid trap is enabled.</span>
02214                 <span class="comment">//</span>
02215 
02216                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
02217                     (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
02218                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a22">KiInvalidOperationQuadword</a>(&amp;ContextBlock,
02219                                                       SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a>,
02220                                                       SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>);
02221                 }
02222 
02223                 <span class="comment">//</span>
02224                 <span class="comment">// Transform the single operand to double format.</span>
02225                 <span class="comment">//</span>
02226 
02227                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o2">Mantissa</a> = (LONGLONG)SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; (55 - 26);
02228                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> +
02229                                     DOUBLE_EXPONENT_BIAS - SINGLE_EXPONENT_BIAS;
02230 
02231                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
02232                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02233                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02234 
02235                 <span class="comment">//</span>
02236                 <span class="comment">// Convert double to quadword and store the result value.</span>
02237                 <span class="comment">//</span>
02238 
02239                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a26">KiNormalizeQuadword</a>(&amp;ContextBlock, &amp;DoubleOperand1);
02240 
02241             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
02242 
02243                 <span class="comment">//</span>
02244                 <span class="comment">// If the operand is infinite or is a NaN, then store a</span>
02245                 <span class="comment">// quiet NaN or an appropriate infinity if the invalid</span>
02246                 <span class="comment">// operation trap is disabled, or raise an exception if</span>
02247                 <span class="comment">// the invalid trap is enabled.</span>
02248                 <span class="comment">//</span>
02249 
02250                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
02251                     (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
02252                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a22">KiInvalidOperationQuadword</a>(&amp;ContextBlock,
02253                                                       DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a>,
02254                                                       DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>);
02255                 }
02256 
02257                 <span class="comment">//</span>
02258                 <span class="comment">// Convert double to quadword and store the result value.</span>
02259                 <span class="comment">//</span>
02260 
02261                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a26">KiNormalizeQuadword</a>(&amp;ContextBlock, &amp;DoubleOperand1);
02262 
02263             } <span class="keywordflow">else</span> {
02264                 <span class="keywordflow">break</span>;
02265             }
02266 
02267             <span class="comment">//</span>
02268             <span class="comment">// Floating convert to longword.</span>
02269             <span class="comment">//</span>
02270             <span class="comment">// This operation is only legal for conversion from double</span>
02271             <span class="comment">// and single formats to longword format. This operation</span>
02272             <span class="comment">// cannot be used to convert from a longword format to a</span>
02273             <span class="comment">// longword format.</span>
02274             <span class="comment">//</span>
02275             <span class="comment">// Floating conversion to longword is accomplished by forming</span>
02276             <span class="comment">// a longword value from a single or double floating value.</span>
02277             <span class="comment">//</span>
02278             <span class="comment">// There is one general conversion operation and four directed</span>
02279             <span class="comment">// rounding operations.</span>
02280             <span class="comment">//</span>
02281 
02282         <span class="keywordflow">case</span> FLOAT_ROUND_LONGWORD:
02283             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_NEAREST;
02284             <span class="keywordflow">goto</span> ConvertLongword;
02285 
02286         <span class="keywordflow">case</span> FLOAT_TRUNC_LONGWORD:
02287             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_ZERO;
02288             <span class="keywordflow">goto</span> ConvertLongword;
02289 
02290         <span class="keywordflow">case</span> FLOAT_CEIL_LONGWORD:
02291             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_PLUS_INFINITY;
02292             <span class="keywordflow">goto</span> ConvertLongword;
02293 
02294         <span class="keywordflow">case</span> FLOAT_FLOOR_LONGWORD:
02295             ContextBlock.<a class="code" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html#o5">Round</a> = ROUND_TO_MINUS_INFINITY;
02296             <span class="keywordflow">goto</span> ConvertLongword;
02297 
02298         <span class="keywordflow">case</span> FLOAT_CONVERT_LONGWORD:
02299         ConvertLongword:
02300             <span class="keywordflow">if</span> (Format == FORMAT_SINGLE) {
02301 
02302                 <span class="comment">//</span>
02303                 <span class="comment">// If the operand is infinite or is a NaN, then store a</span>
02304                 <span class="comment">// quiet NaN or an appropriate infinity if the invalid</span>
02305                 <span class="comment">// operation trap is disabled, or raise an exception if</span>
02306                 <span class="comment">// the invalid trap is enabled.</span>
02307                 <span class="comment">//</span>
02308 
02309                 <span class="keywordflow">if</span> ((SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
02310                     (SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o4">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
02311                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a21">KiInvalidOperationLongword</a>(&amp;ContextBlock,
02312                                                       SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o3">Infinity</a>,
02313                                                       SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>);
02314                 }
02315 
02316                 <span class="comment">//</span>
02317                 <span class="comment">// Transform the single operand to double format.</span>
02318                 <span class="comment">//</span>
02319 
02320                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o0">MantissaHigh</a> =
02321                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &gt;&gt; (26 - (55 - 32));
02322                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o1">MantissaLow</a> =
02323                             SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o0">Mantissa</a> &lt;&lt; (32 - (26 - (55 - 32)));
02324                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o3">Exponent</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o1">Exponent</a> +
02325                                     DOUBLE_EXPONENT_BIAS - SINGLE_EXPONENT_BIAS;
02326                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a> = SingleOperand1.<a class="code" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html#o2">Sign</a>;
02327                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02328                 DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02329 
02330                 <span class="comment">//</span>
02331                 <span class="comment">// Convert double to longword and store the result value.</span>
02332                 <span class="comment">//</span>
02333 
02334                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a25">KiNormalizeLongword</a>(&amp;ContextBlock, &amp;DoubleOperand1);
02335 
02336             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Format == FORMAT_DOUBLE) {
02337 
02338                 <span class="comment">//</span>
02339                 <span class="comment">// If the operand is infinite or is a NaN, then store a</span>
02340                 <span class="comment">// quiet NaN or an appropriate infinity if the invalid</span>
02341                 <span class="comment">// operation trap is disabled, or raise an exception if</span>
02342                 <span class="comment">// the invalid trap is enabled.</span>
02343                 <span class="comment">//</span>
02344 
02345                 <span class="keywordflow">if</span> ((DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
02346                     (DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o6">Nan</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
02347                     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a21">KiInvalidOperationLongword</a>(&amp;ContextBlock,
02348                                                       DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o5">Infinity</a>,
02349                                                       DoubleOperand1.<a class="code" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html#o4">Sign</a>);
02350                 }
02351 
02352                 <span class="comment">//</span>
02353                 <span class="comment">// Convert double to longword and store the result value.</span>
02354                 <span class="comment">//</span>
02355 
02356                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a25">KiNormalizeLongword</a>(&amp;ContextBlock, &amp;DoubleOperand1);
02357 
02358             } <span class="keywordflow">else</span> {
02359                 <span class="keywordflow">break</span>;
02360             }
02361 
02362             <span class="comment">//</span>
02363             <span class="comment">// An illegal function, format value, or field value.</span>
02364             <span class="comment">//</span>
02365 
02366         <span class="keywordflow">default</span> :
02367             <span class="keywordflow">break</span>;
02368         }
02369 
02370         <span class="comment">//</span>
02371         <span class="comment">// An illegal function, format value, or field value was encoutnered.</span>
02372         <span class="comment">// Generate and illegal instruction exception.</span>
02373         <span class="comment">//</span>
02374 
02375         ExceptionRecord-&gt;ExceptionCode = STATUS_ILLEGAL_INSTRUCTION;
02376         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02377 
02378     <span class="comment">//</span>
02379     <span class="comment">// If an exception occurs, then copy the new exception information to the</span>
02380     <span class="comment">// original exception record and handle the exception.</span>
02381     <span class="comment">//</span>
02382 
02383     } except (<a class="code" href="../../d2/d9/ppc_2exceptn_8c.html#a12">KiCopyInformation</a>(ExceptionRecord,
02384                                (GetExceptionInformation())-&gt;ExceptionRecord)) {
02385 
02386         <span class="comment">//</span>
02387         <span class="comment">// Preserve the original exception address and branch destination.</span>
02388         <span class="comment">//</span>
02389 
02390         ExceptionRecord-&gt;ExceptionAddress = ExceptionAddress;
02391         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02392     }
02393 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="mips/floatem.c::KiInvalidCompareDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidCompareDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CheckForNan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="mips/floatem.c::KiInvalidCompareSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidCompareSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CheckForNan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02627">2627</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00070">SINGLE_SIGNAL_NAN_MASK</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.
<p>
<pre class="fragment"><div>02636                    :
02637 
02638     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to determine whether an invalid operation
02639     exception should be raised <span class="keywordflow">for</span> a single compare operation.
02640 
02641 Arguments:
02642 
02643     ContextBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> emulation context block.
02644 
02645     CheckForNan - Supplies a <span class="keywordtype">boolean</span> value that detetermines whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02646         operand values should be checked <span class="keywordflow">for</span> a signaling NaN.
02647 
02648     SingleOperand1 - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first operand value.
02649 
02650     SingleOperand2 - Supplies a pointer ot <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second operand value.
02651 
02652 Return Value:
02653 
02654     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invalid operation trap <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> enabled and either <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02655     invalid or one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operands in a signaling NaN, then a value of
02656     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, no operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed and a value
02657     of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02658 
02659 --*/
02660 
02661 {
02662 
02663     PEXCEPTION_RECORD ExceptionRecord;
02664     PFP_IEEE_VALUE IeeeValue;
02665     PKTRAP_FRAME TrapFrame;
02666 
02667     <span class="comment">//</span>
02668     <span class="comment">// If an invalid operation is specified or one of the operands is a</span>
02669     <span class="comment">// signaling NaN and the invalid operation trap is enabled, then</span>
02670     <span class="comment">// store the proper exception code and exception flags and return</span>
02671     <span class="comment">// a value of FALSE. Otherwise, perform no operation and return a</span>
02672     <span class="comment">// value of TRUE.</span>
02673     <span class="comment">//</span>
02674 
02675     ExceptionRecord = ContextBlock-&gt;ExceptionRecord;
02676     TrapFrame = ContextBlock-&gt;TrapFrame;
02677     <span class="keywordflow">if</span> ((CheckForNan == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
02678         ((SingleOperand1-&gt;Nan != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
02679         ((SingleOperand1-&gt;Mantissa &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a1">SINGLE_SIGNAL_NAN_MASK</a>) != 0)) ||
02680         ((SingleOperand2-&gt;Nan != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
02681         ((SingleOperand2-&gt;Mantissa &amp; <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a1">SINGLE_SIGNAL_NAN_MASK</a>) != 0))) {
02682         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SV = 1;
02683         <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EV != 0) {
02684             ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INVALID_OPERATION;
02685             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XV = 1;
02686             IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
02687             IeeeValue-&gt;Value.CompareValue = FpCompareUnordered;
02688             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02689         }
02690     }
02691 
02692     TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
02693     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02694 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="mips/floatem.c::KiInvalidOperationDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidOperationDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CheckForNan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="mips/floatem.c::KiInvalidOperationLongword" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidOperationLongword           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Infinity</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Sign</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02820">2820</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00136">KiSetRegisterValue()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>, and <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l03574">KiNormalizeLongword()</a>.
<p>
<pre class="fragment"><div>02828                    :
02829 
02830     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to either raise and exception or store a
02831     quiet NaN <span class="keywordflow">for</span> an invalid conversion to longword.
02832 
02833 Arguments:
02834 
02835     ContextBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> emulation context block.
02836 
02837     Infinity - Suuplies a <span class="keywordtype">boolean</span> variable that specifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02838         invalid operand <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> infinite.
02839 
02840     Sign - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> infinity sign <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invalid operand <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> infinite.
02841 
02842 Return Value:
02843 
02844     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invalid operation trap <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> enabled, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02845     returned. Otherwise, an appropriate longword value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02846     destination result and a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02847 
02848 --*/
02849 
02850 {
02851 
02852     PEXCEPTION_RECORD ExceptionRecord;
02853     PFP_IEEE_VALUE IeeeValue;
02854     ULONG ResultValue;
02855     PKTRAP_FRAME TrapFrame;
02856 
02857     <span class="comment">//</span>
02858     <span class="comment">// If the value is infinite, then the result is a properly signed value</span>
02859     <span class="comment">// whose magnitude is the largest that will fit in 32-bits. Otherwise,</span>
02860     <span class="comment">// the result is an integer NaN.</span>
02861     <span class="comment">//</span>
02862 
02863     <span class="keywordflow">if</span> (Infinity != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02864         <span class="keywordflow">if</span> (Sign == 0) {
02865             ResultValue = 0x7fffffff;
02866 
02867         } <span class="keywordflow">else</span> {
02868             ResultValue = 0x80000000;
02869         }
02870 
02871     } <span class="keywordflow">else</span> {
02872         ResultValue = SINGLE_INTEGER_NAN;
02873     }
02874 
02875     <span class="comment">//</span>
02876     <span class="comment">// If the invalid operation trap is enabled then store the proper</span>
02877     <span class="comment">// exception code and exception flags and return a value of FALSE.</span>
02878     <span class="comment">// Otherwise, store a quiet NaN as the destination result and return</span>
02879     <span class="comment">// a value of TRUE.</span>
02880     <span class="comment">//</span>
02881 
02882     ExceptionRecord = ContextBlock-&gt;ExceptionRecord;
02883     TrapFrame = ContextBlock-&gt;TrapFrame;
02884     ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SV = 1;
02885     <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EV != 0) {
02886         ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INVALID_OPERATION;
02887         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XV = 1;
02888         IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
02889         IeeeValue-&gt;Value.U32Value = ResultValue;
02890         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02891 
02892     } <span class="keywordflow">else</span> {
02893 
02894         <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32,
02895                            ResultValue,
02896                            ContextBlock-&gt;ExceptionFrame,
02897                            ContextBlock-&gt;TrapFrame);
02898 
02899         TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
02900         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02901     }
02902 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="mips/floatem.c::KiInvalidOperationQuadword" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidOperationQuadword           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Infinity</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Sign</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02905">2905</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00136">KiSetRegisterValue()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>, and <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l03392">KiNormalizeQuadword()</a>.
<p>
<pre class="fragment"><div>02913                    :
02914 
02915     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to either raise and exception or store a
02916     quiet NaN <span class="keywordflow">for</span> an invalid conversion to quadword.
02917 
02918 Arguments:
02919 
02920     ContextBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> emulation context block.
02921 
02922     Infinity - Suuplies a <span class="keywordtype">boolean</span> variable that specifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02923         invalid operand <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> infinite.
02924 
02925     Sign - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> infinity sign <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invalid operand <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> infinite.
02926 
02927 Return Value:
02928 
02929     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invalid operation trap <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> enabled, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02930     returned. Otherwise, an appropriate longword value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02931     destination result and a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02932 
02933 --*/
02934 
02935 {
02936 
02937     PEXCEPTION_RECORD ExceptionRecord;
02938     PFP_IEEE_VALUE IeeeValue;
02939     <span class="keyword">union </span>{
02940         ULONGLONG ResultValue;
02941         ULARGE_INTEGER LargeValue;
02942     }u;
02943 
02944     PKTRAP_FRAME TrapFrame;
02945 
02946     <span class="comment">//</span>
02947     <span class="comment">// If the value is infinite, then the result is a properly signed value</span>
02948     <span class="comment">// whose magnitude is the largest that will fit in 64-bits. Otherwise,</span>
02949     <span class="comment">// the result is an integer NaN.</span>
02950     <span class="comment">//</span>
02951 
02952     <span class="keywordflow">if</span> (Infinity != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02953         <span class="keywordflow">if</span> (Sign == 0) {
02954             u.ResultValue = 0x7fffffffffffffff;
02955 
02956         } <span class="keywordflow">else</span> {
02957             u.ResultValue = 0x8000000000000000;
02958         }
02959 
02960     } <span class="keywordflow">else</span> {
02961         u.ResultValue = DOUBLE_INTEGER_NAN;
02962     }
02963 
02964     <span class="comment">//</span>
02965     <span class="comment">// If the invalid operation trap is enabled then store the proper</span>
02966     <span class="comment">// exception code and exception flags and return a value of FALSE.</span>
02967     <span class="comment">// Otherwise, store a quiet NaN as the destination result and return</span>
02968     <span class="comment">// a value of TRUE.</span>
02969     <span class="comment">//</span>
02970 
02971     ExceptionRecord = ContextBlock-&gt;ExceptionRecord;
02972     TrapFrame = ContextBlock-&gt;TrapFrame;
02973     ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SV = 1;
02974     <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EV != 0) {
02975         ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INVALID_OPERATION;
02976         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XV = 1;
02977         IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
02978         IeeeValue-&gt;Value.U64Value.QuadPart = u.ResultValue;
02979         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02980 
02981     } <span class="keywordflow">else</span> {
02982 
02983         <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32,
02984                            u.LargeValue.LowPart,
02985                            ContextBlock-&gt;ExceptionFrame,
02986                            ContextBlock-&gt;TrapFrame);
02987 
02988         <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 33,
02989                            u.LargeValue.HighPart,
02990                            ContextBlock-&gt;ExceptionFrame,
02991                            ContextBlock-&gt;TrapFrame);
02992 
02993         TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
02994         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02995     }
02996 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="mips/floatem.c::KiInvalidOperationSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiInvalidOperationSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CheckForNan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="mips/floatem.c::KiNormalizeDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiNormalizeDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultOperand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>StickyBits</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l03105">3105</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00136">KiSetRegisterValue()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.
<p>
<pre class="fragment"><div>03113                    :
03114 
03115     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to normalize a <span class="keywordtype">double</span> floating result.
03116 
03117     N.B. The result value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified with a guard bit on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> right,
03118         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hidden bit (<span class="keywordflow">if</span> appropriate), and a possible overflow bit.
03119         The result <a class="code" href="../../d8/d0/rtbatcr_8c.html#a8">format</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>:
03120 
03121         &lt;63:56&gt; - zero
03122         &lt;55&gt; - overflow bit
03123         &lt;54&gt; - hidden bit
03124         &lt;53:2&gt; - mantissa
03125         &lt;1&gt; - guard bit
03126         &lt;0&gt; - round bit
03127 
03128         The sticky bits specify bits that were lost during <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> computable.
03129 
03130 Arguments:
03131 
03132     ContextBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> emulation context block.
03133 
03134     ResultOperand - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> result operand value.
03135 
03136     StickyBits - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sticky bits.
03137 
03138 Return Value:
03139 
03140     If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not an exception, or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> handled, then a proper
03141     result <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination result, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> continuation address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
03142     set, and a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, no value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored and
03143     a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
03144 
03145 --*/
03146 
03147 {
03148 
03149     ULONG DenormalizeShift;
03150     PEXCEPTION_RECORD ExceptionRecord;
03151     ULONG ExceptionResultHigh;
03152     ULONG ExceptionResultLow;
03153     PFP_IEEE_VALUE IeeeValue;
03154     BOOLEAN Inexact;
03155     BOOLEAN Overflow;
03156     ULONG ResultValueHigh;
03157     ULONG ResultValueLow;
03158     ULONG RoundBit;
03159     PKTRAP_FRAME TrapFrame;
03160     BOOLEAN Underflow;
03161 
03162     <span class="comment">//</span>
03163     <span class="comment">// If the result is infinite, then store a properly signed infinity</span>
03164     <span class="comment">// in the destination register and return a value of TRUE. Otherwise,</span>
03165     <span class="comment">// round and normalize the result and check for overflow and underflow.</span>
03166     <span class="comment">//</span>
03167 
03168     ExceptionRecord = ContextBlock-&gt;ExceptionRecord;
03169     TrapFrame = ContextBlock-&gt;TrapFrame;
03170     <span class="keywordflow">if</span> (ResultOperand-&gt;Infinity != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03171         <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32,
03172                            DOUBLE_INFINITY_VALUE_LOW,
03173                            ContextBlock-&gt;ExceptionFrame,
03174                            ContextBlock-&gt;TrapFrame);
03175 
03176         <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32 + 1,
03177                            DOUBLE_INFINITY_VALUE_HIGH | (ResultOperand-&gt;Sign &lt;&lt; 31),
03178                            ContextBlock-&gt;ExceptionFrame,
03179                            ContextBlock-&gt;TrapFrame);
03180 
03181         TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
03182         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03183     }
03184 
03185     <span class="comment">//</span>
03186     <span class="comment">// If the overflow bit is set, then right shift the mantissa one bit,</span>
03187     <span class="comment">// accumlate the lost bit with the sticky bits, and adjust the exponent</span>
03188     <span class="comment">// value.</span>
03189     <span class="comment">//</span>
03190 
03191     <span class="keywordflow">if</span> ((ResultOperand-&gt;MantissaHigh &amp; (1 &lt;&lt; (55 - 32))) != 0) {
03192         StickyBits |= (ResultOperand-&gt;MantissaLow &amp; 0x1);
03193         ResultOperand-&gt;MantissaLow =
03194                         (ResultOperand-&gt;MantissaLow &gt;&gt; 1) |
03195                                             (ResultOperand-&gt;MantissaHigh &lt;&lt; 31);
03196 
03197         ResultOperand-&gt;MantissaHigh &gt;&gt;= 1;
03198         ResultOperand-&gt;Exponent += 1;
03199     }
03200 
03201     <span class="comment">//</span>
03202     <span class="comment">// If the mantissa is not zero, then normalize the mantissa by left</span>
03203     <span class="comment">// shifting one bit at a time until there is a one bit in bit 54.</span>
03204     <span class="comment">//</span>
03205 
03206     <span class="keywordflow">if</span> ((ResultOperand-&gt;MantissaLow != 0) || (ResultOperand-&gt;MantissaHigh != 0)) {
03207         <span class="keywordflow">while</span> ((ResultOperand-&gt;MantissaHigh &amp; (1 &lt;&lt; (54 - 32))) == 0) {
03208             ResultOperand-&gt;MantissaHigh =
03209                         (ResultOperand-&gt;MantissaHigh &lt;&lt; 1) |
03210                                             (ResultOperand-&gt;MantissaLow &gt;&gt; 31);
03211 
03212             ResultOperand-&gt;MantissaLow &lt;&lt;= 1;
03213             ResultOperand-&gt;Exponent -= 1;
03214         }
03215     }
03216 
03217     <span class="comment">//</span>
03218     <span class="comment">// Right shift the mantissa one bit and accumlate the lost bit with the</span>
03219     <span class="comment">// sticky bits.</span>
03220     <span class="comment">//</span>
03221 
03222     StickyBits |= (ResultOperand-&gt;MantissaLow &amp; 0x1);
03223     ResultOperand-&gt;MantissaLow =
03224                         (ResultOperand-&gt;MantissaLow &gt;&gt; 1) |
03225                                             (ResultOperand-&gt;MantissaHigh &lt;&lt; 31);
03226 
03227     ResultOperand-&gt;MantissaHigh &gt;&gt;= 1;
03228 
03229     <span class="comment">//</span>
03230     <span class="comment">// Round the result value using the mantissa and the sticky bits,</span>
03231     <span class="comment">//</span>
03232 
03233     RoundBit = ResultOperand-&gt;MantissaLow &amp; 0x1;
03234     <span class="keywordflow">switch</span> (ContextBlock-&gt;Round) {
03235 
03236         <span class="comment">//</span>
03237         <span class="comment">// Round to nearest representable number.</span>
03238         <span class="comment">//</span>
03239 
03240     <span class="keywordflow">case</span> ROUND_TO_NEAREST:
03241         <span class="keywordflow">if</span> (RoundBit != 0) {
03242             <span class="keywordflow">if</span> ((StickyBits != 0) || ((ResultOperand-&gt;MantissaLow &amp; 0x2) != 0)) {
03243                 ResultOperand-&gt;MantissaLow += 2;
03244                 <span class="keywordflow">if</span> (ResultOperand-&gt;MantissaLow &lt; 2) {
03245                     ResultOperand-&gt;MantissaHigh += 1;
03246                 }
03247             }
03248         }
03249 
03250         <span class="keywordflow">break</span>;
03251 
03252         <span class="comment">//</span>
03253         <span class="comment">// Round toward zero.</span>
03254         <span class="comment">//</span>
03255 
03256     <span class="keywordflow">case</span> ROUND_TO_ZERO:
03257         <span class="keywordflow">break</span>;
03258 
03259         <span class="comment">//</span>
03260         <span class="comment">// Round toward plus infinity.</span>
03261         <span class="comment">//</span>
03262 
03263     <span class="keywordflow">case</span> ROUND_TO_PLUS_INFINITY:
03264         <span class="keywordflow">if</span> ((ResultOperand-&gt;Sign == 0) &amp;&amp;
03265             ((StickyBits != 0) || (RoundBit != 0))) {
03266             ResultOperand-&gt;MantissaLow += 2;
03267             <span class="keywordflow">if</span> (ResultOperand-&gt;MantissaLow &lt; 2) {
03268                 ResultOperand-&gt;MantissaHigh += 1;
03269             }
03270         }
03271 
03272         <span class="keywordflow">break</span>;
03273 
03274         <span class="comment">//</span>
03275         <span class="comment">// Round toward minus infinity.</span>
03276         <span class="comment">//</span>
03277 
03278     <span class="keywordflow">case</span> ROUND_TO_MINUS_INFINITY:
03279         <span class="keywordflow">if</span> ((ResultOperand-&gt;Sign != 0) &amp;&amp;
03280             ((StickyBits != 0) || (RoundBit != 0))) {
03281             ResultOperand-&gt;MantissaLow += 2;
03282             <span class="keywordflow">if</span> (ResultOperand-&gt;MantissaLow &lt; 2) {
03283                 ResultOperand-&gt;MantissaHigh += 1;
03284             }
03285         }
03286 
03287         <span class="keywordflow">break</span>;
03288     }
03289 
03290     <span class="comment">//</span>
03291     <span class="comment">// If rounding resulted in a carry into bit 54, then right shift the</span>
03292     <span class="comment">// mantissa one bit and adjust the exponent.</span>
03293     <span class="comment">//</span>
03294 
03295     <span class="keywordflow">if</span> ((ResultOperand-&gt;MantissaHigh &amp; (1 &lt;&lt; (54 - 32))) != 0) {
03296         ResultOperand-&gt;MantissaLow =
03297                         (ResultOperand-&gt;MantissaLow &gt;&gt; 1) |
03298                                             (ResultOperand-&gt;MantissaHigh &lt;&lt; 31);
03299 
03300         ResultOperand-&gt;MantissaHigh &gt;&gt;= 1;
03301         ResultOperand-&gt;Exponent += 1;
03302     }
03303 
03304     <span class="comment">//</span>
03305     <span class="comment">// Right shift the mantissa one bit to normalize the final result.</span>
03306     <span class="comment">//</span>
03307 
03308     StickyBits |= ResultOperand-&gt;MantissaLow &amp; 0x1;
03309     ResultOperand-&gt;MantissaLow =
03310                         (ResultOperand-&gt;MantissaLow &gt;&gt; 1) |
03311                                             (ResultOperand-&gt;MantissaHigh &lt;&lt; 31);
03312 
03313     ResultOperand-&gt;MantissaHigh &gt;&gt;= 1;
03314 
03315     <span class="comment">//</span>
03316     <span class="comment">// If the exponent value is greater than or equal to the maximum</span>
03317     <span class="comment">// exponent value, then overflow has occurred. This results in both</span>
03318     <span class="comment">// the inexact and overflow sticky bits being set in FSR.</span>
03319     <span class="comment">//</span>
03320     <span class="comment">// If the exponent value is less than or equal to the minimum exponent</span>
03321     <span class="comment">// value, the mantissa is nonzero, and the result is inexact or the</span>
03322     <span class="comment">// denormalized result causes loss of accuracy, then underflow has</span>
03323     <span class="comment">// occurred. If denormals are being flushed to zero, then a result of</span>
03324     <span class="comment">// zero is returned. Otherwise, both the inexact and underflow sticky</span>
03325     <span class="comment">// bits are set in FSR.</span>
03326     <span class="comment">//</span>
03327     <span class="comment">// Otherwise, a normal result can be delivered, but it may be inexact.</span>
03328     <span class="comment">// If the result is inexact, then the inexact sticky bit is set in FSR.</span>
03329     <span class="comment">//</span>
03330 
03331     <span class="keywordflow">if</span> (ResultOperand-&gt;Exponent &gt;= DOUBLE_MAXIMUM_EXPONENT) {
03332         Inexact = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03333         Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03334         Underflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03335 
03336         <span class="comment">//</span>
03337         <span class="comment">// The overflow value is dependent on the rounding mode.</span>
03338         <span class="comment">//</span>
03339 
03340         <span class="keywordflow">switch</span> (ContextBlock-&gt;Round) {
03341 
03342             <span class="comment">//</span>
03343             <span class="comment">// Round to nearest representable number.</span>
03344             <span class="comment">//</span>
03345             <span class="comment">// The result value is infinity with the sign of the result.</span>
03346             <span class="comment">//</span>
03347 
03348         <span class="keywordflow">case</span> ROUND_TO_NEAREST:
03349             ResultValueLow = DOUBLE_INFINITY_VALUE_LOW;
03350             ResultValueHigh =
03351                         DOUBLE_INFINITY_VALUE_HIGH | (ResultOperand-&gt;Sign &lt;&lt; 31);
03352 
03353             <span class="keywordflow">break</span>;
03354 
03355             <span class="comment">//</span>
03356             <span class="comment">// Round toward zero.</span>
03357             <span class="comment">//</span>
03358             <span class="comment">// The result is the maximum number with the sign of the result.</span>
03359             <span class="comment">//</span>
03360 
03361         <span class="keywordflow">case</span> ROUND_TO_ZERO:
03362             ResultValueLow = DOUBLE_MAXIMUM_VALUE_LOW;
03363             ResultValueHigh =
03364                         DOUBLE_MAXIMUM_VALUE_HIGH | (ResultOperand-&gt;Sign &lt;&lt; 31);
03365             <span class="keywordflow">break</span>;
03366 
03367             <span class="comment">//</span>
03368             <span class="comment">// Round toward plus infinity.</span>
03369             <span class="comment">//</span>
03370             <span class="comment">// If the sign of the result is positive, then the result is</span>
03371             <span class="comment">// plus infinity. Otherwise, the result is the maximum negative</span>
03372             <span class="comment">// number.</span>
03373             <span class="comment">//</span>
03374 
03375         <span class="keywordflow">case</span> ROUND_TO_PLUS_INFINITY:
03376             <span class="keywordflow">if</span> (ResultOperand-&gt;Sign == 0) {
03377                 ResultValueLow = DOUBLE_INFINITY_VALUE_LOW;
03378                 ResultValueHigh = DOUBLE_INFINITY_VALUE_HIGH;
03379 
03380             } <span class="keywordflow">else</span> {
03381                 ResultValueLow = DOUBLE_MAXIMUM_VALUE_LOW;
03382                 ResultValueHigh = (ULONG)(DOUBLE_MAXIMUM_VALUE_HIGH | (1 &lt;&lt; 31));
03383             }
03384 
03385             <span class="keywordflow">break</span>;
03386 
03387             <span class="comment">//</span>
03388             <span class="comment">// Round toward minus infinity.</span>
03389             <span class="comment">//</span>
03390             <span class="comment">// If the sign of the result is negative, then the result is</span>
03391             <span class="comment">// negative infinity. Otherwise, the result is the maximum</span>
03392             <span class="comment">// positive number.</span>
03393             <span class="comment">//</span>
03394 
03395 
03396         <span class="keywordflow">case</span> ROUND_TO_MINUS_INFINITY:
03397             <span class="keywordflow">if</span> (ResultOperand-&gt;Sign != 0) {
03398                 ResultValueLow = DOUBLE_INFINITY_VALUE_LOW;
03399                 ResultValueHigh = (ULONG)(DOUBLE_INFINITY_VALUE_HIGH | (1 &lt;&lt; 31));
03400 
03401             } <span class="keywordflow">else</span> {
03402                 ResultValueLow = DOUBLE_MAXIMUM_VALUE_LOW;
03403                 ResultValueHigh = DOUBLE_MAXIMUM_VALUE_HIGH;
03404             }
03405 
03406             <span class="keywordflow">break</span>;
03407         }
03408 
03409         <span class="comment">//</span>
03410         <span class="comment">// Compute the overflow exception result value by subtracting 1536</span>
03411         <span class="comment">// from the exponent.</span>
03412         <span class="comment">//</span>
03413 
03414         ExceptionResultLow = ResultOperand-&gt;MantissaLow;
03415         ExceptionResultHigh = ResultOperand-&gt;MantissaHigh &amp; ((1 &lt;&lt; (52 - 32)) - 1);
03416         ExceptionResultHigh |= ((ResultOperand-&gt;Exponent - 1536) &lt;&lt; (52 - 32));
03417         ExceptionResultHigh |= (ResultOperand-&gt;Sign &lt;&lt; 31);
03418 
03419     } <span class="keywordflow">else</span> {
03420         <span class="keywordflow">if</span> ((ResultOperand-&gt;Exponent &lt;= DOUBLE_MINIMUM_EXPONENT) &amp;&amp;
03421             (ResultOperand-&gt;MantissaHigh != 0)) {
03422             <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;FS == 0) {
03423                 DenormalizeShift = 1 - ResultOperand-&gt;Exponent;
03424                 <span class="keywordflow">if</span> (DenormalizeShift &gt;= 53) {
03425                     DenormalizeShift = 53;
03426                 }
03427 
03428                 <span class="keywordflow">if</span> (DenormalizeShift &gt;= 32) {
03429                     DenormalizeShift -= 32;
03430                     StickyBits |= ResultOperand-&gt;MantissaLow |
03431                         (ResultOperand-&gt;MantissaHigh &amp; ((1 &lt;&lt; DenormalizeShift) - 1));
03432 
03433                     ResultValueLow = ResultOperand-&gt;MantissaHigh &gt;&gt; DenormalizeShift;
03434                     ResultValueHigh = 0;
03435 
03436                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DenormalizeShift &gt; 0) {
03437                     StickyBits |=
03438                         ResultOperand-&gt;MantissaLow &amp; ((1 &lt;&lt; DenormalizeShift) - 1);
03439 
03440                     ResultValueLow =
03441                         (ResultOperand-&gt;MantissaLow &gt;&gt; DenormalizeShift) |
03442                         (ResultOperand-&gt;MantissaHigh &lt;&lt; (32 - DenormalizeShift));
03443 
03444                     ResultValueHigh =
03445                             (ResultOperand-&gt;MantissaHigh &gt;&gt; DenormalizeShift);
03446 
03447                 } <span class="keywordflow">else</span> {
03448                     ResultValueLow = ResultOperand-&gt;MantissaLow;
03449                     ResultValueHigh = ResultOperand-&gt;MantissaHigh;
03450                 }
03451 
03452                 ResultValueHigh |= (ResultOperand-&gt;Sign &lt;&lt; 31);
03453                 <span class="keywordflow">if</span> (StickyBits != 0) {
03454                     Inexact = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03455                     Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03456                     Underflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03457 
03458                     <span class="comment">//</span>
03459                     <span class="comment">// Compute the underflow exception result value by adding</span>
03460                     <span class="comment">// 1536 to the exponent.</span>
03461                     <span class="comment">//</span>
03462 
03463                     ExceptionResultLow = ResultOperand-&gt;MantissaLow;
03464                     ExceptionResultHigh = ResultOperand-&gt;MantissaHigh &amp; ((1 &lt;&lt; (52 - 32)) - 1);
03465                     ExceptionResultHigh |= ((ResultOperand-&gt;Exponent + 1536) &lt;&lt; (52 - 32));
03466                     ExceptionResultHigh |= (ResultOperand-&gt;Sign &lt;&lt; 31);
03467 
03468                 } <span class="keywordflow">else</span> {
03469                     Inexact = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03470                     Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03471                     Underflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03472                 }
03473 
03474             } <span class="keywordflow">else</span> {
03475                 ResultValueLow = 0;
03476                 ResultValueHigh = 0;
03477                 Inexact = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03478                 Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03479                 Underflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03480             }
03481 
03482         } <span class="keywordflow">else</span> {
03483             <span class="keywordflow">if</span> (ResultOperand-&gt;MantissaHigh == 0) {
03484                 ResultOperand-&gt;Exponent = 0;
03485             }
03486 
03487             ResultValueLow = ResultOperand-&gt;MantissaLow;
03488             ResultValueHigh = ResultOperand-&gt;MantissaHigh &amp; ((1 &lt;&lt; (52 - 32)) - 1);
03489             ResultValueHigh |= (ResultOperand-&gt;Exponent &lt;&lt; (52 - 32));
03490             ResultValueHigh |= (ResultOperand-&gt;Sign &lt;&lt; 31);
03491             Inexact = StickyBits ? <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03492             Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03493             Underflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03494         }
03495     }
03496 
03497     <span class="comment">//</span>
03498     <span class="comment">// Check to determine if an exception should be delivered or the result</span>
03499     <span class="comment">// should be written to the destination register.</span>
03500     <span class="comment">//</span>
03501 
03502     <span class="keywordflow">if</span> (Overflow != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03503         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SI = 1;
03504         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SO = 1;
03505         <span class="keywordflow">if</span> ((((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EO != 0) ||
03506             (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EI != 0)) {
03507             <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EO != 0) {
03508                 ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_OVERFLOW;
03509 
03510             } <span class="keywordflow">else</span> {
03511                 ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INEXACT_RESULT;
03512             }
03513 
03514             IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
03515             IeeeValue-&gt;Value.Fp64Value.W[0] = ExceptionResultLow;
03516             IeeeValue-&gt;Value.Fp64Value.W[1] = ExceptionResultHigh;
03517             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XI = 1;
03518             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XO = 1;
03519             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03520         }
03521 
03522     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Underflow != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03523         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SI = 1;
03524         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SU = 1;
03525         <span class="keywordflow">if</span> ((((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EU != 0) ||
03526             (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EI != 0)) {
03527             <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EU != 0) {
03528                 ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_UNDERFLOW;
03529 
03530             } <span class="keywordflow">else</span> {
03531                 ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INEXACT_RESULT;
03532             }
03533 
03534             IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
03535             IeeeValue-&gt;Value.Fp64Value.W[0] = ExceptionResultLow;
03536             IeeeValue-&gt;Value.Fp64Value.W[1] = ExceptionResultHigh;
03537             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XI = 1;
03538             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XU = 1;
03539             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03540         }
03541 
03542     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Inexact != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03543         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SI = 1;
03544         <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EI != 0) {
03545             ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INEXACT_RESULT;
03546             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XI = 1;
03547             IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
03548             IeeeValue-&gt;Value.Fp64Value.W[0] = ResultValueLow;
03549             IeeeValue-&gt;Value.Fp64Value.W[1] = ResultValueHigh;
03550             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03551         }
03552     }
03553 
03554     <span class="comment">//</span>
03555     <span class="comment">// Set the destination register value, update the return address,</span>
03556     <span class="comment">// and return a value of TRUE.</span>
03557     <span class="comment">//</span>
03558 
03559     <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32,
03560                        ResultValueLow,
03561                        ContextBlock-&gt;ExceptionFrame,
03562                        ContextBlock-&gt;TrapFrame);
03563 
03564     <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32 + 1,
03565                        ResultValueHigh,
03566                        ContextBlock-&gt;ExceptionFrame,
03567                        ContextBlock-&gt;TrapFrame);
03568 
03569     TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
03570     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03571 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="mips/floatem.c::KiNormalizeLongword" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiNormalizeLongword           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultOperand</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l03574">3574</a> of file <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html">mips/floatem.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l02820">KiInvalidOperationLongword()</a>, <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00136">KiSetRegisterValue()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.
<p>
<pre class="fragment"><div>03581                    :
03582 
03583     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to convert a result value to a longword result.
03584 
03585     N.B. The result value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified with a guard bit on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> right,
03586         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hidden bit (<span class="keywordflow">if</span> appropriate), and an overlfow bit of zero.
03587         The result <a class="code" href="../../d8/d0/rtbatcr_8c.html#a8">format</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>:
03588 
03589         &lt;63:55&gt; - zero
03590         &lt;54 - hidden bit
03591         &lt;53:2&gt; - mantissa
03592         &lt;1&gt; - guard bit
03593         &lt;0&gt; - round bit
03594 
03595         There are no sticky bits.
03596 
03597 Arguments:
03598 
03599     ContextBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> emulation context block.
03600 
03601     ResultOperand - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> result operand value.
03602 
03603 Return Value:
03604 
03605     If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not an exception, or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> handled, then a proper
03606     result <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination result, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> continuation address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
03607     set, and a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, no value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stored and
03608     a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
03609 
03610 --*/
03611 
03612 {
03613 
03614     PEXCEPTION_RECORD ExceptionRecord;
03615     LONG ExponentShift;
03616     PFP_IEEE_VALUE IeeeValue;
03617     BOOLEAN Inexact;
03618     BOOLEAN Overflow;
03619     ULONG ResultValue;
03620     ULONG RoundBit;
03621     ULONG StickyBits;
03622     PKTRAP_FRAME TrapFrame;
03623 
03624     <span class="comment">//</span>
03625     <span class="comment">// Subtract out the exponent bias and divide the cases into right</span>
03626     <span class="comment">// and left shifts.</span>
03627     <span class="comment">//</span>
03628 
03629     ExceptionRecord = ContextBlock-&gt;ExceptionRecord;
03630     TrapFrame = ContextBlock-&gt;TrapFrame;
03631     ExponentShift = ResultOperand-&gt;Exponent - DOUBLE_EXPONENT_BIAS;
03632     <span class="keywordflow">if</span> (ExponentShift &lt; 23) {
03633 
03634         <span class="comment">//</span>
03635         <span class="comment">// The integer value is less than 2**23 and a right shift must</span>
03636         <span class="comment">// be performed.</span>
03637         <span class="comment">//</span>
03638 
03639         ExponentShift = 22 - ExponentShift;
03640         <span class="keywordflow">if</span> (ExponentShift &gt; 24) {
03641             ExponentShift = 24;
03642         }
03643 
03644         StickyBits =
03645                 (ResultOperand-&gt;MantissaLow &gt;&gt; 2) |
03646                 (ResultOperand-&gt;MantissaHigh &lt;&lt; (32 - ExponentShift));
03647 
03648         ResultValue = ResultOperand-&gt;MantissaHigh &gt;&gt; ExponentShift;
03649         Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03650 
03651     } <span class="keywordflow">else</span> {
03652 
03653         <span class="comment">//</span>
03654         <span class="comment">// The integer value is two or greater and a left shift must be</span>
03655         <span class="comment">// performed.</span>
03656         <span class="comment">//</span>
03657 
03658         ExponentShift -= 22;
03659         <span class="keywordflow">if</span> (ExponentShift &lt;= (31 - 22)) {
03660             StickyBits = ResultOperand-&gt;MantissaLow &lt;&lt; ExponentShift;
03661             ResultValue =
03662                 (ResultOperand-&gt;MantissaHigh &lt;&lt; ExponentShift) |
03663                 (ResultOperand-&gt;MantissaLow &gt;&gt; (32 - ExponentShift));
03664 
03665             Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03666 
03667         } <span class="keywordflow">else</span> {
03668             Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03669         }
03670     }
03671 
03672     <span class="comment">//</span>
03673     <span class="comment">// Round the result value using the mantissa and the sticky bits,</span>
03674     <span class="comment">//</span>
03675 
03676     RoundBit = StickyBits &gt;&gt; 31;
03677     StickyBits &lt;&lt;= 1;
03678     <span class="keywordflow">switch</span> (ContextBlock-&gt;Round) {
03679 
03680         <span class="comment">//</span>
03681         <span class="comment">// Round to nearest representable number.</span>
03682         <span class="comment">//</span>
03683 
03684     <span class="keywordflow">case</span> ROUND_TO_NEAREST:
03685         <span class="keywordflow">if</span> (RoundBit != 0) {
03686             <span class="keywordflow">if</span> ((StickyBits != 0) || ((ResultValue &amp; 0x1) != 0)) {
03687                 ResultValue += 1;
03688                 <span class="keywordflow">if</span> (ResultValue == 0) {
03689                     Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03690                 }
03691             }
03692         }
03693 
03694         <span class="keywordflow">break</span>;
03695 
03696         <span class="comment">//</span>
03697         <span class="comment">// Round toward zero.</span>
03698         <span class="comment">//</span>
03699 
03700     <span class="keywordflow">case</span> ROUND_TO_ZERO:
03701         <span class="keywordflow">break</span>;
03702 
03703         <span class="comment">//</span>
03704         <span class="comment">// Round toward plus infinity.</span>
03705         <span class="comment">//</span>
03706 
03707     <span class="keywordflow">case</span> ROUND_TO_PLUS_INFINITY:
03708         <span class="keywordflow">if</span> ((ResultOperand-&gt;Sign == 0) &amp;&amp; (StickyBits != 0)) {
03709             ResultValue += 1;
03710             <span class="keywordflow">if</span> (ResultValue == 0) {
03711                 Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03712             }
03713         }
03714 
03715         <span class="keywordflow">break</span>;
03716 
03717         <span class="comment">//</span>
03718         <span class="comment">// Round toward minus infinity.</span>
03719         <span class="comment">//</span>
03720 
03721     <span class="keywordflow">case</span> ROUND_TO_MINUS_INFINITY:
03722         <span class="keywordflow">if</span> ((ResultOperand-&gt;Sign != 0) &amp;&amp; (StickyBits != 0)) {
03723             ResultValue += 1;
03724             <span class="keywordflow">if</span> (ResultValue == 0) {
03725                 Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03726             }
03727         }
03728 
03729         <span class="keywordflow">break</span>;
03730     }
03731 
03732     <span class="comment">//</span>
03733     <span class="comment">// If the result value is positive and the result is negative, then</span>
03734     <span class="comment">// overflow has occurred. Otherwise, negate the result value and</span>
03735     <span class="comment">// check if the result is negative. If the result is positive, then</span>
03736     <span class="comment">// overflow has occurred.</span>
03737     <span class="comment">//</span>
03738 
03739     <span class="keywordflow">if</span> (ResultOperand-&gt;Sign == 0) {
03740         <span class="keywordflow">if</span> ((ResultValue &gt;&gt; 31) != 0) {
03741             Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03742         }
03743 
03744     } <span class="keywordflow">else</span> {
03745         ResultValue = ~ResultValue + 1;
03746         <span class="keywordflow">if</span> ((ResultValue &gt;&gt; 31) == 0) {
03747             Overflow = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03748         }
03749     }
03750 
03751     <span class="comment">//</span>
03752     <span class="comment">// Check to determine if an exception should be delivered or the result</span>
03753     <span class="comment">// should be written to the destination register.</span>
03754     <span class="comment">//</span>
03755 
03756     <span class="keywordflow">if</span> (Overflow != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03757         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/mips_2floatem_8c.html#a21">KiInvalidOperationLongword</a>(ContextBlock,
03758                                           FALSE,
03759                                           0);
03760 
03761     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((StickyBits | RoundBit) != 0) {
03762         ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;SI = 1;
03763         <span class="keywordflow">if</span> (((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;EI != 0) {
03764             ExceptionRecord-&gt;ExceptionCode = STATUS_FLOAT_INEXACT_RESULT;
03765             ((PFSR)&amp;TrapFrame-&gt;Fsr)-&gt;XI = 1;
03766             IeeeValue = (PFP_IEEE_VALUE)&amp;ExceptionRecord-&gt;ExceptionInformation[2];
03767             IeeeValue-&gt;Value.U32Value = ResultValue;
03768             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03769         }
03770 
03771     }
03772 
03773     <span class="comment">//</span>
03774     <span class="comment">// Set the destination register value, update the return address,</span>
03775     <span class="comment">// and return a value of TRUE.</span>
03776     <span class="comment">//</span>
03777 
03778     <a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a1">KiSetRegisterValue</a>(ContextBlock-&gt;Fd + 32,
03779                        ResultValue,
03780                        ContextBlock-&gt;ExceptionFrame,
03781                        ContextBlock-&gt;TrapFrame);
03782 
03783     TrapFrame-&gt;Fir = ContextBlock-&gt;BranchAddress;
03784     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03785 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="mips/floatem.c::KiNormalizeQuadword" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiNormalizeQuadword           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultOperand</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="mips/floatem.c::KiNormalizeSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KiNormalizeSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ResultOperand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>StickyBits</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="mips/floatem.c::KiSquareRootDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KiSquareRootDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULARGE_INTEGER&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DoubleValue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="mips/floatem.c::KiSquareRootSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KiSquareRootSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SingleValue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d3/mips_2floatem_8c-source.html#l00251">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="mips/floatem.c::KiUnpackDouble" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiUnpackDouble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d2/d0/struct__FP__DOUBLE__OPERAND.html">PFP_DOUBLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DoubleOperand</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="mips/floatem.c::KiUnpackSingle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiUnpackSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d0/struct__FP__CONTEXT__BLOCK.html">PFP_CONTEXT_BLOCK</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d5/d0/struct__FP__SINGLE__OPERAND.html">PFP_SINGLE_OPERAND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SingleOperand</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d3/alpha_2floatem_8c-source.html#l00296">KiEmulateFloating()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:41 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
