<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tpalette.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tpalette.c File Reference</h1><code>#include &lt;windows.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include "..\..\inc\conapi.h"</code><br>

<p>
<a href="../../d4/d3/tpalette_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/tpalette_8c.html#a0">FOREGROUND_WHITE</a>&nbsp;&nbsp;&nbsp;(FOREGROUND_BLUE | FOREGROUND_GREEN | FOREGROUND_RED)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/tpalette_8c.html#a2">main</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/tpalette_8c.html#a1">MyPalette</a> [64]</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="tpalette.c::FOREGROUND_WHITE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FOREGROUND_WHITE&nbsp;&nbsp;&nbsp;(FOREGROUND_BLUE | FOREGROUND_GREEN | FOREGROUND_RED)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/tpalette_8c-source.html#l00009">9</a> of file <a class="el" href="../../d4/d3/tpalette_8c-source.html">tpalette.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="tpalette.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/tpalette_8c-source.html#l00033">33</a> of file <a class="el" href="../../d4/d3/tpalette_8c-source.html">tpalette.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d8/d1/output_8h-source.html#l00149">CONSOLE_GRAPHICS_BUFFER</a>, <a class="el" href="../../d4/d5/iostubs_8c-source.html#l01666">CreateConsoleScreenBuffer()</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00021">LPSECURITY_ATTRIBUTES</a>, <a class="el" href="../../d4/d3/tpalette_8c-source.html#l00013">MyPalette</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d3/client_2private_8c-source.html#l00737">SetConsolePalette()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00037 {
00038     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> Success;
00039     <span class="keywordtype">int</span> i;
00040     HPALETTE hPalette;
00041     LOGPALETTE *Palette;
00042     HANDLE hgo;
00043     CONSOLE_GRAPHICS_BUFFER_INFO cgbi;
00044 
00045     Palette = LocalAlloc(LMEM_FIXED,
00046                     <span class="keyword">sizeof</span>(LOGPALETTE) + 256 * <span class="keyword">sizeof</span>(PALETTEENTRY));
00047 
00048     Palette-&gt;palNumEntries = (WORD) 256;
00049     Palette-&gt;palVersion    = 0x300;
00050 
00051     <span class="comment">/* Fill in the palette entries from the DIB color table and</span>
00052 <span class="comment">     * create a logical color palette.</span>
00053 <span class="comment">     */</span>
00054 
00055     <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++) {
00056         Palette-&gt;palPalEntry[i].peRed   = 255-i;
00057         Palette-&gt;palPalEntry[i].peGreen = 255-i;
00058         Palette-&gt;palPalEntry[i].peBlue  = 255-i;
00059         Palette-&gt;palPalEntry[i].peFlags = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0;
00060     }
00061 
00062     hPalette = CreatePalette(Palette);
00063     <span class="keywordflow">if</span> (hPalette==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00064         printf(<span class="stringliteral">"first CreatePalette failed\n"</span>);
00065         printf(<span class="stringliteral">"last error is %x\n"</span>,GetLastError());
00066     }
00067 
00068 <span class="preprocessor">#if 0</span>
00069 <span class="preprocessor"></span>call
00070 HANDLE
00071 <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a>
00072 <a class="code" href="../../d3/d6/iostubs_8c.html#a30">CreateConsoleScreenBuffer</a>(
00073     DWORD dwDesiredAccess,
00074     DWORD dwShareMode,
00075     <a class="code" href="../../d6/d1/userrtl_8h.html#a30">LPSECURITY_ATTRIBUTES</a> lpSecurityAttributes,
00076     DWORD dwFlags,  == CONSOLE_GRAPHICS_BUFFER
00077     PVOID lpScreenBufferData == pCONSOLE_GRAPHICS_BUFFER_INFO
00078     );
00079 <span class="keyword">typedef</span> <span class="keyword">struct </span>_CONSOLE_GRAPHICS_BUFFER_INFO {
00080     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwBitMapInfoLength;
00081     LPBITMAPINFO lpBitMapInfo;
00082     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwUsage;
00083     HANDLE hMutex;
00084     PVOID lpBitMap;
00085 } CONSOLE_GRAPHICS_BUFFER_INFO, *PCONSOLE_GRAPHICS_BUFFER_INFO;
00086 
00087 
00088 <span class="preprocessor">#define CONSOLE_GRAPHICS_BUFFER  2</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00090 <span class="preprocessor"></span>    hgo = <a class="code" href="../../d3/d6/iostubs_8c.html#a30">CreateConsoleScreenBuffer</a>(MAXIMUM_ALLOWED, 0, NULL,
00091             CONSOLE_GRAPHICS_BUFFER, &amp;cgbi);
00092     <span class="keywordflow">if</span> (hgo == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00093         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"CreateConsoleScreenBuffer failed\n"</span>);
00094         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00095     }
00096     Success = <a class="code" href="../../d6/d4/client_2private_8c.html#a13">SetConsolePalette</a>(hgo,
00097                                 hPalette,
00098                                 SYSPAL_NOSTATIC
00099                                );
00100     <span class="keywordflow">if</span> (!Success) {
00101         printf(<span class="stringliteral">"first SetConsolePalette failed\n"</span>);
00102     }
00103     printf(<span class="stringliteral">"palette should be different\n"</span>);
00104     Sleep(5000);
00105     DeleteObject(hPalette);
00106 
00107     <span class="comment">/* Fill in the palette entries from the DIB color table and</span>
00108 <span class="comment">     * create a logical color palette.</span>
00109 <span class="comment">     */</span>
00110 
00111     <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {
00112         memcpy(&amp;Palette-&gt;palPalEntry[i],
00113                MyPalette,
00114                64
00115               );
00116     }
00117 
00118     hPalette = CreatePalette(Palette);
00119     <span class="keywordflow">if</span> (hPalette==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00120         printf(<span class="stringliteral">"first CreatePalette failed\n"</span>);
00121     }
00122 
00123     Success = <a class="code" href="../../d6/d4/client_2private_8c.html#a13">SetConsolePalette</a>(hgo,
00124                                 hPalette,
00125                                 SYSPAL_STATIC
00126                                );
00127     <span class="keywordflow">if</span> (!Success) {
00128         printf(<span class="stringliteral">"second SetConsolePalette failed\n"</span>);
00129     }
00130     printf(<span class="stringliteral">"palette should be different\n"</span>);
00131     Sleep(5000);
00132     DeleteObject(hPalette);
00133 
00134     printf( <span class="stringliteral">"TCURSOR: Exiting Test Program\n"</span> );
00135     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00136 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a1" doxytag="tpalette.c::MyPalette" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d3/d4/tpalette_8c.html#a1">MyPalette</a>[64]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div>
       { 0,   0,   0x80,0 ,       
         0,   0x80,0,   0 ,       
         0,   0,   0,   0 ,       
         0,   0x80,0x80,0 ,       
         0x80,0,   0,   0 ,       
         0x80,0,   0x80,0 ,       
         0x80,0x80,0,   0 ,       
         0xC0,0xC0,0xC0,0 ,       
         0x80,0x80,0x80,0 ,       
         0,   0,   0xFF,0 ,       
         0,   0xFF,0,   0 ,       
         0,   0xFF,0xFF,0 ,       
         0xFF,0,   0,   0 ,       
         0xFF,0,   0xFF,0 ,       
         0xFF,0xFF,0,   0 ,       
         0xFF,0xFF,0xFF,0 }
</div></pre>
<p>
Definition at line <a class="el" href="../../d4/d3/tpalette_8c-source.html#l00013">13</a> of file <a class="el" href="../../d4/d3/tpalette_8c-source.html">tpalette.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/tpalette_8c-source.html#l00033">main()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
