<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CDeviceProfileManagement class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CDeviceProfileManagement Class Reference</h1><code>#include &lt;<a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CDeviceProfileManagement:
<p><center><img src="d2/d2/classCDeviceProfileManagement.png" usemap="#CDeviceProfileManagement_map" border="0" alt=""></center>
<map name="CDeviceProfileManagement_map">
<area href="d9/d6/classCShellExtensionPage.html" alt="CShellExtensionPage" shape="rect" coords="188,56,366,80">
<area href="d2/d6/classCPropertyPage.html" alt="CPropertyPage" shape="rect" coords="188,0,366,24">
<area href="d3/d4/classCMonitorProfileManagement.html" alt="CMonitorProfileManagement" shape="rect" coords="0,168,178,192">
<area href="d6/d5/classCPrinterProfileManagement.html" alt="CPrinterProfileManagement" shape="rect" coords="188,168,366,192">
<area href="d8/d6/classCScannerProfileManagement.html" alt="CScannerProfileManagement" shape="rect" coords="376,168,554,192">
</map>
<a href="../../d0/d2/classCDeviceProfileManagement-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a0">CDeviceProfileManagement</a> (LPCTSTR lpstrName, HINSTANCE hiWhere, int idPage, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a1">~CDeviceProfileManagement</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a2">OnInit</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a3">OnCommand</a> (WORD wNotifyCode, WORD wid, HWND hwndCtl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a4">OnNotify</a> (int idCtrl, LPNMHDR pnmh)</td></tr>

<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b0">InitList</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>=0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b2">GetDeviceTypeString</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwType, <a class="el" href="../../d1/d7/classCString.html">CString</a> &amp;csDeviceName)</td></tr>

<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p3">m_csDevice</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p4">m_hwndList</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a></td></tr>

<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#r0">m_dwType</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CDeviceProfileManagement::CDeviceProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CDeviceProfileManagement::CDeviceProfileManagement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hiWhere</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>idPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">288</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00080">m_bCMYK</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00081">m_bReadOnly</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00078">m_csDevice</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00071">m_dwType</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>.
<p>
<pre class="fragment"><div>00290                                                                              {
00291         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p3">m_csDevice</a> = lpstrDevice;
00292     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#r0">m_dwType</a> = dwType;
00293     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.hInstance = hiWhere;
00294     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.pszTemplate = MAKEINTRESOURCE(idPage);
00295 
00296     <span class="comment">//  Setting m_bReadOnly to false enables functionality</span>
00297 
00298     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;        <span class="comment">// default setting is false</span>
00299 
00300 <span class="preprocessor">#if defined(_WIN95_)</span>
00301 <span class="preprocessor"></span>
00302     <span class="comment">//</span>
00303     <span class="comment">// There is no way to detect printer supports CMYK or not on Win 9x.</span>
00304 
00305     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00306 
00307 <span class="preprocessor">#else</span>
00308 <span class="preprocessor"></span>
00309     <span class="comment">//  we need to check the device capabilities</span>
00310     <span class="comment">//  and determine if we're trying to associate</span>
00311     <span class="comment">//  a cmyk printer profile to a printer that</span>
00312     <span class="comment">//  doesn't support it.</span>
00313 
00314     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;            <span class="comment">// default setting - don't support cmyk</span>
00315 
00316     <span class="comment">//  if the device is a printer</span>
00317 
00318     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#r0">m_dwType</a> == CLASS_PRINTER) {
00319 
00320         HDC hdcThis = <a class="code" href="../../d0/d3/classCGlobals.html#e10">CGlobals::GetPrinterHDC</a>(m_csDevice);
00321 
00322         <span class="comment">//  if the printer supports CMYK</span>
00323 
00324         <span class="keywordflow">if</span> (hdcThis) {
00325             <span class="keywordflow">if</span> (GetDeviceCaps(hdcThis, COLORMGMTCAPS) &amp; CM_CMYK_COLOR) {
00326                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00327             }
00328             DeleteDC(hdcThis);
00329         }
00330     }
00331 
00332 <span class="preprocessor">#endif // defined(_WIN95_)</span>
00333 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CDeviceProfileManagement::~CDeviceProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CDeviceProfileManagement::~<a class="el" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00092">92</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
<pre class="fragment"><div>00092 {}
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b1" doxytag="CDeviceProfileManagement::FillList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CDeviceProfileManagement::FillList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwFlags</em> = <code>0</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented in <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#b1">CPrinterProfileManagement</a>, and <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#b1">CMonitorProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">121</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00066">DEVLIST_CHANGED</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00067">DEVLIST_NOSELECT</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00079">CString::Empty()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00061">CPropertyPage::EnableApplyButton()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00090">GetFocus()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00063">CString::IsEmpty()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00081">m_bReadOnly</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00076">m_cpaAdds</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00077">m_cpaProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00075">m_cuaRemovals</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00079">m_hwndList</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">OnInit()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.
<p>
<pre class="fragment"><div>00121                                                         {
00122 
00123     <span class="comment">//  Before reset list box, get current selection to restore later.</span>
00124 
00125     <a class="code" href="../../d1/d7/classCString.html">CString</a> csSelect;
00126 
00127     csSelect.<a class="code" href="../../d1/d7/classCString.html#a6">Empty</a>();
00128 
00129     LRESULT idSelect = LB_ERR;
00130 
00131     <span class="keywordflow">if</span> ( !(<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a3">DEVLIST_NOSELECT</a>)) {
00132 
00133         <span class="comment">//  Get current selected position.</span>
00134 
00135         idSelect = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
00136 
00137         <span class="comment">//  Get text length where currently selected, than allocate buffer for that.</span>
00138 
00139         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwLen = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETTEXTLEN, idSelect, 0);
00140         TCHAR  *pszSelect = <span class="keyword">new</span> TCHAR[dwLen + 1];
00141 
00142         <span class="comment">//  Get text itself.</span>
00143     
00144         <span class="keywordflow">if</span> (pszSelect != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00145 
00146             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETTEXT, idSelect, (LPARAM) pszSelect) != LB_ERR) {
00147                 csSelect = pszSelect;
00148             }
00149 
00150             <span class="keyword">delete</span> pszSelect;
00151         }
00152     }
00153 
00154     <span class="comment">//  reset list box</span>
00155 
00156     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_RESETCONTENT, 0, 0);
00157 
00158     <span class="comment">//  Fill the profile list box from the list of profiles</span>
00159 
00160     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u++) {
00161 
00162         <span class="comment">//  Don't list profiles tentatively disassociated...</span>
00163 
00164         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uOut = 0; uOut &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); uOut++)
00165             <span class="keywordflow">if</span>  (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>[uOut] == u)
00166                 <span class="keywordflow">break</span>;
00167 
00168         <span class="keywordflow">if</span>  (uOut &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>())
00169             <span class="keywordflow">continue</span>;   <span class="comment">//  Don't add this to list, it's been zapped!</span>
00170 
00171         LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_ADDSTRING, 0,
00172             (LPARAM) (LPCTSTR) m_cpaProfile[u] -&gt; GetName());
00173 
00174         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETITEMDATA, <span class="keywordtype">id</span>, u);
00175     }
00176 
00177     <span class="comment">//  Add the profiles that have been tentatively added...</span>
00178 
00179     <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u ++) {
00180         LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_ADDSTRING, 0,
00181             (LPARAM) (LPCTSTR) m_cpaAdds[u] -&gt; GetName());
00182         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETITEMDATA, <span class="keywordtype">id</span>, u + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>());
00183     }
00184 
00185     <span class="comment">//  If we have any profiles, select the first one</span>
00186     <span class="comment">//  Otherwise, disable the "Remove" button, as there's nothing to remove</span>
00187 
00188     <span class="keywordtype">unsigned</span> itemCount = (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>());
00189 
00190     <span class="keywordflow">if</span>  (itemCount) {
00191 
00192         <span class="comment">// The Remove button must remain disabled</span>
00193         <span class="comment">// unless the user is Administrator.</span>
00194         <span class="comment">// This code is specific to the Monitor Profile</span>
00195         <span class="comment">// Property sheet.</span>
00196 
00197         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>) {
00198             <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), TRUE);
00199         }
00200 
00201         <span class="keywordflow">if</span> ( !(<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a3">DEVLIST_NOSELECT</a>)) {
00202 
00203             <span class="comment">// Find out the string selected previously.</span>
00204 
00205             idSelect = LB_ERR;
00206 
00207             <span class="keywordflow">if</span> (!csSelect.<a class="code" href="../../d1/d7/classCString.html#a5">IsEmpty</a>()) {
00208                 idSelect = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_FINDSTRINGEXACT,
00209                                        (WPARAM) -1, (LPARAM) (LPCTSTR) csSelect);
00210             }
00211 
00212             <span class="comment">// if could not find, just select first item.</span>
00213 
00214             <span class="keywordflow">if</span> (idSelect == LB_ERR) {
00215                 idSelect = 0;
00216             }
00217 
00218             <span class="comment">// Select it.</span>
00219 
00220             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETCURSEL, idSelect, 0);
00221         }
00222 
00223     } <span class="keywordflow">else</span> {
00224 
00225         HWND hwndRemove = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton);
00226 
00227         <span class="comment">// If focus is on Remove, move it to Add button.</span>
00228 
00229         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>() == hwndRemove) {
00230 
00231             HWND hwndAdd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, AddButton);
00232 
00233             <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(hwndAdd);
00234             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndRemove, BM_SETSTYLE, BS_PUSHBUTTON, MAKELPARAM(TRUE, 0));
00235             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndAdd, BM_SETSTYLE, BS_DEFPUSHBUTTON, MAKELPARAM(TRUE, 0));
00236         }
00237 
00238         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(hwndRemove, FALSE);
00239     }
00240 
00241     <span class="comment">// Apply button needs to remain disabled unless the</span>
00242     <span class="comment">// user has permision to make changes - ie. user</span>
00243     <span class="comment">// is Administrator.</span>
00244 
00245     <span class="keywordflow">if</span>  ((<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a2">DEVLIST_CHANGED</a>) &amp;&amp; !(<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>)) {
00246         <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00247         <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(TRUE);
00248     }
00249 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="CDeviceProfileManagement::GetDeviceTypeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CDeviceProfileManagement::GetDeviceTypeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d7/classCString.html">CString</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>csDeviceName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00251">251</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00048">ClassAbstractString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00049">ClassColorSpaceString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00047">ClassLinkString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00044">ClassMonitorString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00050">ClassNamedString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00045">ClassPrinterString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00046">ClassScannerString</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00251">GetDeviceTypeString()</a>, and <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00251">GetDeviceTypeString()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>.
<p>
<pre class="fragment"><div>00251                                                                                      {
00252 
00253     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <span class="keywordtype">id</span>;
00254 
00255     <span class="keywordflow">switch</span> (dwType) {
00256 
00257     <span class="keywordflow">case</span> CLASS_MONITOR :
00258         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a16">ClassMonitorString</a>;
00259         <span class="keywordflow">break</span>;
00260     <span class="keywordflow">case</span> CLASS_PRINTER :
00261         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a17">ClassPrinterString</a>;
00262         <span class="keywordflow">break</span>;
00263     <span class="keywordflow">case</span> CLASS_SCANNER :
00264         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a18">ClassScannerString</a>;
00265         <span class="keywordflow">break</span>;
00266     <span class="keywordflow">case</span> CLASS_LINK :
00267         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a19">ClassLinkString</a>;
00268         <span class="keywordflow">break</span>;
00269     <span class="keywordflow">case</span> CLASS_ABSTRACT :
00270         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a20">ClassAbstractString</a>;
00271         <span class="keywordflow">break</span>;
00272     <span class="keywordflow">case</span> CLASS_NAMED :
00273         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a22">ClassNamedString</a>;
00274         <span class="keywordflow">break</span>;
00275     <span class="keywordflow">case</span> CLASS_COLORSPACE :
00276     <span class="keywordflow">default</span> :
00277         <span class="keywordtype">id</span> = <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a21">ClassColorSpaceString</a>;
00278         <span class="keywordflow">break</span>;
00279     }
00280 
00281     <span class="comment">// Load string.</span>
00282 
00283     csDeviceName.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(<span class="keywordtype">id</span>);
00284 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="CDeviceProfileManagement::InitList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CDeviceProfileManagement::InitList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented in <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#b0">CPrinterProfileManagement</a>, and <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#b0">CMonitorProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">105</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00827">CProfileArray::Empty()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00412">CUintArray::Empty()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00076">m_cpaAdds</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00077">m_cpaProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00078">m_csDevice</a>, and <a class="el" href="../../d7/d6/devprop_8h-source.html#l00075">m_cuaRemovals</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01284">CMonitorProfileManagement::InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00732">CPrinterProfileManagement::InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">OnInit()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.
<p>
<pre class="fragment"><div>00105                                            {
00106 
00107     <span class="comment">//  Make sure the lists are empty.</span>
00108 
00109     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>();
00110     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a6">Empty</a>();
00111 
00112     <span class="comment">//  Determine the associations for the target device.</span>
00113 
00114     ENUMTYPE    et = {<span class="keyword">sizeof</span> et, ENUM_TYPE_VERSION, ET_DEVICENAME, <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p3">m_csDevice</a>};
00115 
00116     <a class="code" href="../../d7/d5/classCProfile.html#e0">CProfile::Enumerate</a>(et, m_cpaProfile);
00117 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CDeviceProfileManagement::OnCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CDeviceProfileManagement::OnCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wNotifyCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndCtl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a7">CPropertyPage</a>.
<p>
Reimplemented in <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a3">CPrinterProfileManagement</a>, and <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a3">CMonitorProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">360</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00424">CUintArray::Add()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00844">CProfileArray::Add()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00066">DEVLIST_CHANGED</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00187">CProfile::GetColorSpace()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00251">GetDeviceTypeString()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00182">CProfile::GetName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00183">CProfile::GetType()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00060">InstFailedWithName</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00194">CProfile::IsValid()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00080">m_bCMYK</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00081">m_bReadOnly</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00076">m_cpaAdds</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00077">m_cpaProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00078">m_csDevice</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00075">m_cuaRemovals</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00071">m_dwType</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00079">m_hwndList</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00059">MismatchDeviceType</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00115">CAddProfileDialog::ProfileCount()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00116">CAddProfileDialog::ProfileName()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00117">CAddProfileDialog::ProfileNameAndExtension()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00868">CProfileArray::Remove()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00449">CUintArray::Remove()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00069">UnsupportedProfile</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>.
<p>
<pre class="fragment"><div>00361                                                            {
00362 
00363     <span class="keywordflow">switch</span>  (wNotifyCode) {
00364 
00365         <span class="keywordflow">case</span>    BN_CLICKED:
00366 
00367             <span class="keywordflow">switch</span>  (wid) {
00368 
00369                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a>: {
00370 
00371                     <span class="keywordtype">unsigned</span> i = 0, u = 0;
00372 
00373                     <span class="comment">//  Time to do the old OpenFile dialog stuff...</span>
00374 
00375                     <a class="code" href="../../d5/d1/classCAddProfileDialog.html">CAddProfileDialog</a> capd(m_hwnd, <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.hInstance);
00376 
00377                     <span class="comment">//  See if a profile was selected</span>
00378 
00379                     <span class="keywordflow">while</span>(i &lt; capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a2">ProfileCount</a>()) {
00380 
00381                         <span class="comment">//  Check profile validity and device type</span>
00382 
00383                         <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> cpTemp(capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a3">ProfileName</a>(i));
00384 
00385                         <span class="comment">//  CLASS_COLORSPACE and CLASS_MONITOR can be associated to</span>
00386                         <span class="comment">//  any device. Other (CLASS_SCANNER, CLASS_PRINTER) only</span>
00387                         <span class="comment">//  can be associated to much device.</span>
00388 
00389                         <span class="keywordflow">if</span> (    !cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a7">IsValid</a>() <span class="comment">// Wrong profile type or invalid?</span>
00390                              || (   cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a3">GetType</a>() != <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#r0">m_dwType</a>
00391                                  &amp;&amp; cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a3">GetType</a>() != CLASS_COLORSPACE
00392 <span class="preprocessor">                        #if 1 // ALLOW_MONITOR_PROFILE_TO_ANY_DEVICE</span>
00393 <span class="preprocessor"></span>                                 &amp;&amp; cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a3">GetType</a>() != CLASS_MONITOR
00394 <span class="preprocessor">                        #endif</span>
00395 <span class="preprocessor"></span>                                )
00396                            ) {
00397 
00398                             <span class="comment">//  Throw up a message box to inform the user of this</span>
00399 
00400                             <span class="keywordflow">if</span> (cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a7">IsValid</a>())
00401                             {
00402                                 <a class="code" href="../../d1/d7/classCString.html">CString</a> csDeviceType;  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b2">GetDeviceTypeString</a>(m_dwType,csDeviceType);
00403                                 <a class="code" href="../../d1/d7/classCString.html">CString</a> csProfileType; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b2">GetDeviceTypeString</a>(cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a3">GetType</a>(),csProfileType);
00404 
00405                                 <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(MismatchDeviceType, m_hwnd, FALSE,
00406                                                MB_OK|MB_ICONEXCLAMATION, 3,
00407                                                (LPTSTR)capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a4">ProfileNameAndExtension</a>(i),
00408                                                (LPTSTR)csProfileType,
00409                                                (LPTSTR)csDeviceType);
00410                             }
00411                             <span class="keywordflow">else</span>
00412                             {
00413                                 <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(InstFailedWithName, m_hwnd, FALSE,
00414                                                MB_OK|MB_ICONEXCLAMATION, 1,
00415                                                (LPTSTR)capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a4">ProfileNameAndExtension</a>(i));
00416                             }
00417 
00418                             <span class="keywordflow">goto</span> SkipToNext;
00419                         }
00420 
00421                         <span class="comment">//  See if the profile has already been listed for addition</span>
00422 
00423                         <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u++) {
00424                             <span class="keywordflow">if</span>  (!lstrcmpi(m_cpaAdds[u] -&gt; GetName(), cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>())) {
00425                                 <span class="keywordflow">goto</span> SkipToNext; <span class="comment">//  This profile is already added</span>
00426                             }
00427                         }
00428 
00429                         <span class="comment">//  If this profile is on the existing list, either ignore</span>
00430                         <span class="comment">//  or zap it from the removal list, as the case may be</span>
00431 
00432                         <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u++) {
00433                             <span class="keywordflow">if</span>  (!lstrcmpi(m_cpaProfile[u] -&gt; GetName(),
00434                                     cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>())) {
00435                                 <span class="comment">//  Is this one on the removal list?</span>
00436                                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uOut = 0;
00437                                      uOut &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00438                                      uOut++) {
00439                                     <span class="keywordflow">if</span>  (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>[uOut] == u) {
00440                                         <span class="comment">//  Was to be removed- undo that...</span>
00441                                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(uOut);
00442                                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
00443                                         <span class="keywordflow">break</span>;
00444                                     }
00445                                 }
00446                                 <span class="keywordflow">goto</span> SkipToNext;
00447                             }   <span class="comment">//  End of name in existing list</span>
00448                         }
00449 
00450                         <span class="comment">//  We need to check the device capabilities</span>
00451                         <span class="comment">//  and determine if we're trying to associate</span>
00452                         <span class="comment">//  a cmyk printer profile to a printer that</span>
00453                         <span class="comment">//  doesn't support it.</span>
00454 
00455                         <span class="keywordflow">if</span>  ((!<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a>) &amp;&amp; (cpTemp.<a class="code" href="../../d7/d5/classCProfile.html#a5">GetColorSpace</a>() == SPACE_CMYK)) {
00456                             <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(UnsupportedProfile, m_hwnd, FALSE,
00457                                                 MB_OK|MB_ICONEXCLAMATION, 2,
00458                                                 (LPTSTR)m_csDevice,
00459                                                 (LPTSTR)capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a4">ProfileNameAndExtension</a>(i));
00460                             <span class="keywordflow">goto</span> SkipToNext;
00461                         }
00462 
00463                         <span class="comment">//  Add this profile to the list, item (max orig + index)</span>
00464 
00465                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a3">Add</a>(capd.<a class="code" href="../../d5/d1/classCAddProfileDialog.html#a3">ProfileName</a>(i));
00466 
00467                         <span class="comment">//  Change has been made, update the list</span>
00468 
00469                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
00470 SkipToNext:
00471                         i++;
00472                     }
00473 
00474                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00475                 }
00476 
00477                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>: {
00478 
00479                     <span class="comment">//  Remove the selected profile</span>
00480 
00481                     LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
00482                     <span class="keywordtype">unsigned</span> u = (<span class="keywordtype">unsigned</span>) <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList,
00483                         LB_GETITEMDATA, <span class="keywordtype">id</span>, 0);
00484 
00485                     <span class="comment">//  If this is a tentative add, just drop it, otherwise</span>
00486                     <span class="comment">//  note that it's been removed...</span>
00487 
00488                     <span class="keywordflow">if</span>  (u &gt;= <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
00489                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a5">Remove</a>(u - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>());
00490                     <span class="keywordflow">else</span>
00491                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(u);
00492 
00493                     <span class="comment">//  That's it- just update the display, now...</span>
00494 
00495                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
00496 
00497                     <span class="comment">// explicitly set the position of the current selection</span>
00498                     <span class="comment">// after the list has been recomputed.</span>
00499 
00500                     <span class="keywordtype">int</span> listsize = <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()+<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()-<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00501                     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &gt;= listsize) <span class="keywordtype">id</span> = listsize-1;
00502                     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; 0)         <span class="keywordtype">id</span> = 0;
00503                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETCURSEL, <span class="keywordtype">id</span>, 0);
00504 
00505                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00506                 }
00507             }
00508             <span class="keywordflow">break</span>;
00509 
00510         <span class="keywordflow">case</span>    LBN_SELCHANGE: {
00511 
00512             LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
00513                         
00514             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {
00515                 <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), FALSE);
00516             } <span class="keywordflow">else</span> {
00517 
00518                 <span class="comment">// The Remove button must remain disabled on a monitor</span>
00519                 <span class="comment">// profile property page if the user isn't the</span>
00520                 <span class="comment">// Administrator, otherwise enable remove button.</span>
00521 
00522                 <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), !m_bReadOnly);
00523             }
00524 
00525             <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00526         }
00527     }
00528 
00529     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00530 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CDeviceProfileManagement::OnInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CDeviceProfileManagement::OnInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a9">CPropertyPage</a>.
<p>
Reimplemented in <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a2">CPrinterProfileManagement</a>, <a class="el" href="../../d8/d6/classCScannerProfileManagement.html#a2">CScannerProfileManagement</a>, and <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a2">CMonitorProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">337</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00065">DEVLIST_ONINIT</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00079">m_hwndList</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00108">ProfileListControl</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01397">CMonitorProfileManagement::OnInit()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01220">CScannerProfileManagement::OnInit()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00822">CPrinterProfileManagement::OnInit()</a>.
<p>
<pre class="fragment"><div>00337                                          {
00338 
00339     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b0">InitList</a>();
00340 
00341     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p4">m_hwndList</a> = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, ProfileListControl);
00342 
00343     <span class="comment">//  Fill the profile list box</span>
00344 
00345     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>(DEVLIST_ONINIT);
00346 
00347     <span class="comment">//  Disable apply button as default.</span>
00348 
00349     <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00350 
00351     <span class="comment">//  Nothing changed, yet.</span>
00352 
00353     <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
00354 
00355     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00356 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CDeviceProfileManagement::OnNotify" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CDeviceProfileManagement::OnNotify           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idCtrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPNMHDR&nbsp;</td>
          <td class="mdname" nowrap> <em>pnmh</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a8">CPropertyPage</a>.
<p>
Reimplemented in <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a4">CPrinterProfileManagement</a>, and <a class="el" href="../../d3/d4/classCMonitorProfileManagement.html#a4">CMonitorProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">534</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00076">m_cpaAdds</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00077">m_cpaProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00078">m_csDevice</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00075">m_cuaRemovals</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00868">CProfileArray::Remove()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.
<p>
<pre class="fragment"><div>00534                                                                    {
00535 
00536     <span class="keywordflow">switch</span>  (pnmh -&gt; code) {
00537 
00538         <span class="keywordflow">case</span>    PSN_APPLY:
00539 
00540             <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00541 
00542             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>()) {
00543 
00544                 <span class="comment">//  Apply the changes the user has made...</span>
00545 
00546                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
00547 
00548                 <span class="keywordflow">while</span>   (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()) {
00549                     <span class="keywordflow">if</span>  (!<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[0] -&gt; IsInstalled()) {
00550                         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[0] -&gt; Install();
00551                     }
00552                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[0] -&gt; Associate(m_csDevice);
00553                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a5">Remove</a>(0);
00554                 }
00555 
00556                 <span class="comment">//  Now do the removals (actually just dissociations)</span>
00557 
00558                 <span class="keywordflow">while</span>   (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) {
00559                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>[0]] -&gt; Dissociate(m_csDevice);
00560                     m_cuaRemovals.Remove(0);
00561                 }
00562 
00563                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b0">InitList</a>();
00564                 <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>();
00565 
00566                 <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(m_hwnd, DWLP_MSGRESULT, PSNRET_NOERROR);
00567             }
00568 
00569             <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00570     }
00571 
00572     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00573 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p5" doxytag="CDeviceProfileManagement::m_bCMYK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p5">CDeviceProfileManagement::m_bCMYK</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00080">80</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="CDeviceProfileManagement::m_bReadOnly" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p6">CDeviceProfileManagement::m_bReadOnly</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00081">81</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="CDeviceProfileManagement::m_cpaAdds" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a> <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p1">CDeviceProfileManagement::m_cpaAdds</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00076">76</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="CDeviceProfileManagement::m_cpaProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a> <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p2">CDeviceProfileManagement::m_cpaProfile</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00077">77</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="CDeviceProfileManagement::m_csDevice" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p3">CDeviceProfileManagement::m_csDevice</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00078">78</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="CDeviceProfileManagement::m_cuaRemovals" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a> <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p0">CDeviceProfileManagement::m_cuaRemovals</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00075">75</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00534">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="CDeviceProfileManagement::m_dwType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#r0">CDeviceProfileManagement::m_dwType</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00071">71</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00288">CDeviceProfileManagement()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="CDeviceProfileManagement::m_hwndList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#p4">CDeviceProfileManagement::m_hwndList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00079">79</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00121">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">OnInit()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a><li><a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
