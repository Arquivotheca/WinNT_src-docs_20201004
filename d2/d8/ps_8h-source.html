<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ps.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ps.h</h1><a href="../../d1/d9/ps_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++ BUILD Version: 0009    // Increment this if a change has global effects</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    ps.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the process structure public data structures and</span>
00012 <span class="comment">    procedure prototypes to be used within the NT system.</span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment"></span>
00016 <span class="comment">    Mark Lucovsky       16-Feb-1989</span>
00017 <span class="comment"></span>
00018 <span class="comment">Revision History:</span>
00019 <span class="comment"></span>
00020 <span class="comment">--*/</span>
00021 
00022 <span class="preprocessor">#ifndef _PS_</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define _PS_</span>
00024 <span class="preprocessor"></span>
00025 <span class="comment">//</span>
00026 <span class="comment">// Invalid handle table value.</span>
00027 <span class="comment">//</span>
00028 
<a name="l00029"></a><a class="code" href="../../d1/d9/ps_8h.html#a0">00029</a> <span class="preprocessor">#define PSP_INVALID_ID ((ULONG_PTR)(0x82)&lt;&lt;((sizeof(ULONG_PTR)-1)*8))</span>
00030 <span class="preprocessor"></span>
00031 <span class="comment">//</span>
00032 <span class="comment">// Process Object</span>
00033 <span class="comment">//</span>
00034 
00035 <span class="comment">//</span>
00036 <span class="comment">// Process object body.  A pointer to this structure is returned when a handle</span>
00037 <span class="comment">// to a process object is referenced.  This structure contains a process control</span>
00038 <span class="comment">// block (PCB) which is the kernel's representation of a process.</span>
00039 <span class="comment">//</span>
00040 
<a name="l00041"></a><a class="code" href="../../d1/d9/ps_8h.html#a1">00041</a> <span class="preprocessor">#define MEMORY_PRIORITY_BACKGROUND 0</span>
<a name="l00042"></a><a class="code" href="../../d1/d9/ps_8h.html#a2">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define MEMORY_PRIORITY_WASFOREGROUND 1</span>
<a name="l00043"></a><a class="code" href="../../d1/d9/ps_8h.html#a3">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define MEMORY_PRIORITY_FOREGROUND 2</span>
00044 <span class="preprocessor"></span>
<a name="l00045"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html">00045</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html">_MMSUPPORT_FLAGS</a> {
<a name="l00046"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o0">00046</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o0">SessionSpace</a> : 1;
<a name="l00047"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o1">00047</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o1">BeingTrimmed</a> : 1;
<a name="l00048"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o2">00048</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o2">ProcessInSession</a> : 1;
<a name="l00049"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o3">00049</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o3">SessionLeader</a> : 1;
<a name="l00050"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o4">00050</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o4">TrimHard</a> : 1;
<a name="l00051"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o5">00051</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o5">WorkingSetHard</a> : 1;
<a name="l00052"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o6">00052</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o6">WriteWatch</a> : 1;
<a name="l00053"></a><a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o7">00053</a>     <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html#o7">Filler</a> : 25;
00054 } <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html">MMSUPPORT_FLAGS</a>;
00055 
<a name="l00056"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html">00056</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d6/struct__MMSUPPORT.html">_MMSUPPORT</a> {
<a name="l00057"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o0">00057</a>     LARGE_INTEGER <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o0">LastTrimTime</a>;
<a name="l00058"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o1">00058</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o1">LastTrimFaultCount</a>;
<a name="l00059"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o2">00059</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o2">PageFaultCount</a>;
<a name="l00060"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o3">00060</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o3">PeakWorkingSetSize</a>;
<a name="l00061"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o4">00061</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o4">WorkingSetSize</a>;
<a name="l00062"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o5">00062</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o5">MinimumWorkingSetSize</a>;
<a name="l00063"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o6">00063</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o6">MaximumWorkingSetSize</a>;
<a name="l00064"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o7">00064</a>     <span class="keyword">struct </span><a class="code" href="../../d0/d8/struct__MMWSL.html">_MMWSL</a> *<a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o7">VmWorkingSetList</a>;
<a name="l00065"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o8">00065</a>     LIST_ENTRY <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o8">WorkingSetExpansionLinks</a>;
<a name="l00066"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o9">00066</a>     UCHAR <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o9">AllowWorkingSetAdjustment</a>;
<a name="l00067"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o10">00067</a>     BOOLEAN <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o10">AddressSpaceBeingDeleted</a>;
<a name="l00068"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o11">00068</a>     UCHAR <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o11">ForegroundSwitchCount</a>;
<a name="l00069"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o12">00069</a>     UCHAR <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o12">MemoryPriority</a>;
00070 
00071     <span class="keyword">union </span>{
<a name="l00072"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o13">00072</a>         ULONG LongFlags;
<a name="l00073"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o14">00073</a>         <a class="code" href="../../d5/d6/struct__MMSUPPORT__FLAGS.html">MMSUPPORT_FLAGS</a> Flags;
00074     } u;
00075 
<a name="l00076"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o16">00076</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o16">Claim</a>;
<a name="l00077"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o17">00077</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o17">NextEstimationSlot</a>;
<a name="l00078"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o18">00078</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o18">NextAgingSlot</a>;
<a name="l00079"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o19">00079</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o19">EstimatedAvailable</a>;
00080 
<a name="l00081"></a><a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o20">00081</a>     ULONG <a class="code" href="../../d3/d6/struct__MMSUPPORT.html#o20">GrowthSinceLastEstimate</a>;
00082 
00083 } <a class="code" href="../../d3/d6/struct__MMSUPPORT.html">MMSUPPORT</a>;
00084 
<a name="l00085"></a><a class="code" href="../../d1/d9/ps_8h.html#a30">00085</a> <span class="keyword">typedef</span> <a class="code" href="../../d3/d6/struct__MMSUPPORT.html">MMSUPPORT</a> *<a class="code" href="../../d3/d6/struct__MMSUPPORT.html">PMMSUPPORT</a>;
00086 
00087 <span class="comment">//</span>
00088 <span class="comment">// Client impersonation information</span>
00089 <span class="comment">//</span>
00090 
<a name="l00091"></a><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html">00091</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html">_PS_IMPERSONATION_INFORMATION</a> {
<a name="l00092"></a><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o0">00092</a>     PACCESS_TOKEN <a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o0">Token</a>;
<a name="l00093"></a><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o1">00093</a>     BOOLEAN <a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o1">CopyOnOpen</a>;
<a name="l00094"></a><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o2">00094</a>     BOOLEAN <a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o2">EffectiveOnly</a>;
<a name="l00095"></a><a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o3">00095</a>     SECURITY_IMPERSONATION_LEVEL <a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html#o3">ImpersonationLevel</a>;
00096 } <a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html">PS_IMPERSONATION_INFORMATION</a>, *<a class="code" href="../../d5/d1/struct__PS__IMPERSONATION__INFORMATION.html">PPS_IMPERSONATION_INFORMATION</a>;
00097 
00098 
00099 <span class="comment">//</span>
00100 <span class="comment">// Changes to the EPROCESS structure require that you re-run genoff for x86.</span>
00101 <span class="comment">// This change is needed because Old debugger references the processes</span>
00102 <span class="comment">// debug port. If this is not done then the user-debugger will not work.</span>
00103 <span class="comment">// After running genoff, you must re-build ntsd !</span>
00104 <span class="comment">//</span>
00105 
<a name="l00106"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">00106</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">_EPROCESS_QUOTA_BLOCK</a> {
<a name="l00107"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o0">00107</a>     KSPIN_LOCK <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o0">QuotaLock</a>;
<a name="l00108"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o1">00108</a>     ULONG <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o1">ReferenceCount</a>;
<a name="l00109"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o2">00109</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o2">QuotaPeakPoolUsage</a>[2];
<a name="l00110"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o3">00110</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o3">QuotaPoolUsage</a>[2];
<a name="l00111"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o4">00111</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o4">QuotaPoolLimit</a>[2];
<a name="l00112"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o5">00112</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o5">PeakPagefileUsage</a>;
<a name="l00113"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o6">00113</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o6">PagefileUsage</a>;
<a name="l00114"></a><a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o7">00114</a>     SIZE_T <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html#o7">PagefileLimit</a>;
00115 } <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">EPROCESS_QUOTA_BLOCK</a>, *<a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">PEPROCESS_QUOTA_BLOCK</a>;
00116 
00117 <span class="preprocessor">#if DEVL</span>
00118 <span class="preprocessor"></span>
00119 <span class="comment">//</span>
00120 <span class="comment">// Pagefault monitoring</span>
00121 <span class="comment">//</span>
00122 
00123 <span class="keyword">typedef</span> <span class="keyword">struct </span>_PAGEFAULT_HISTORY {
00124     ULONG CurrentIndex;
00125     ULONG MaxIndex;
00126     KSPIN_LOCK SpinLock;
00127     PVOID Reserved;
00128     PROCESS_WS_WATCH_INFORMATION WatchInfo[1];
00129 } PAGEFAULT_HISTORY, *PPAGEFAULT_HISTORY;
00130 <span class="preprocessor">#endif // DEVL</span>
00131 <span class="preprocessor"></span>
<a name="l00132"></a><a class="code" href="../../d1/d9/ps_8h.html#a4">00132</a> <span class="preprocessor">#define PS_WS_TRIM_FROM_EXE_HEADER        1</span>
<a name="l00133"></a><a class="code" href="../../d1/d9/ps_8h.html#a5">00133</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_WS_TRIM_BACKGROUND_ONLY_APP    2</span>
00134 <span class="preprocessor"></span>
00135 <span class="comment">//</span>
00136 <span class="comment">// Wow64 process stucture</span>
00137 <span class="comment">//</span>
00138 
<a name="l00139"></a><a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html">00139</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html">_WOW64_PROCESS</a> {
<a name="l00140"></a><a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html#o0">00140</a>     PVOID <a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html#o0">Wow64</a>;
00141 <span class="preprocessor">#if defined(_IA64_)</span>
00142 <span class="preprocessor"></span>    <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> AlternateTableLock;
00143     PULONG AltPermBitmap;
00144     ULONG AltFlags;
00145 <span class="preprocessor">#endif</span>
00146 <span class="preprocessor"></span>} <a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html">WOW64_PROCESS</a>, *<a class="code" href="../../d8/d9/struct__WOW64__PROCESS.html">PWOW64_PROCESS</a>;
00147 
<a name="l00148"></a><a class="code" href="../../d1/d9/ps_8h.html#a6">00148</a> <span class="preprocessor">#define PS_SET_BITS(Flags, Flag) \</span>
00149 <span class="preprocessor">    ExInterlockedSetBits (Flags, Flag)</span>
00150 <span class="preprocessor"></span>
<a name="l00151"></a><a class="code" href="../../d1/d9/ps_8h.html#a7">00151</a> <span class="preprocessor">#define PS_CLEAR_BITS(Flags, Flag) \</span>
00152 <span class="preprocessor">    ExInterlockedClearBits (Flags, Flag)</span>
00153 <span class="preprocessor"></span>
<a name="l00154"></a><a class="code" href="../../d1/d9/ps_8h.html#a8">00154</a> <span class="preprocessor">#define PS_SET_CLEAR_BITS(Flags, sFlag, cFlag) \</span>
00155 <span class="preprocessor">    ExInterlockedSetClearBits (Flags, sFlag, cFlag)</span>
00156 <span class="preprocessor"></span>
00157 <span class="comment">//</span>
00158 <span class="comment">// Process structure.</span>
00159 <span class="comment">//</span>
00160 <span class="comment">// If you remove a field from this structure, please also</span>
00161 <span class="comment">// remove the reference to it from within the kernel debugger</span>
00162 <span class="comment">// (nt\private\sdktools\ntsd\ntkext.c)</span>
00163 <span class="comment">//</span>
00164 
<a name="l00165"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html">00165</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> {
<a name="l00166"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">00166</a>     <a class="code" href="../../d5/d7/struct__KPROCESS.html">KPROCESS</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>;
<a name="l00167"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o1">00167</a>     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o1">ExitStatus</a>;
<a name="l00168"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o2">00168</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o2">LockEvent</a>;
<a name="l00169"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o3">00169</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o3">LockCount</a>;
<a name="l00170"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o4">00170</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o4">CreateTime</a>;
<a name="l00171"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o5">00171</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o5">ExitTime</a>;
<a name="l00172"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o6">00172</a>     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o6">LockOwner</a>;
00173 
<a name="l00174"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o7">00174</a>     HANDLE <a class="code" href="../../d0/d4/struct__EPROCESS.html#o7">UniqueProcessId</a>;
00175 
<a name="l00176"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o8">00176</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o8">ActiveProcessLinks</a>;
00177 
00178     <span class="comment">//</span>
00179     <span class="comment">// Quota Fields</span>
00180     <span class="comment">//</span>
00181 
<a name="l00182"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o9">00182</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o9">QuotaPeakPoolUsage</a>[2];
<a name="l00183"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o10">00183</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o10">QuotaPoolUsage</a>[2];
00184 
<a name="l00185"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o11">00185</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o11">PagefileUsage</a>;
<a name="l00186"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o12">00186</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o12">CommitCharge</a>;
<a name="l00187"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o13">00187</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o13">PeakPagefileUsage</a>;
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// VmCounters</span>
00191     <span class="comment">//</span>
00192 
<a name="l00193"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o14">00193</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o14">PeakVirtualSize</a>;
<a name="l00194"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o15">00194</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o15">VirtualSize</a>;
00195 
<a name="l00196"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o16">00196</a>     <a class="code" href="../../d3/d6/struct__MMSUPPORT.html">MMSUPPORT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o16">Vm</a>;
<a name="l00197"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o17">00197</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o17">SessionProcessLinks</a>;
00198 
<a name="l00199"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o18">00199</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o18">DebugPort</a>;
<a name="l00200"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o19">00200</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o19">ExceptionPort</a>;
<a name="l00201"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o20">00201</a>     <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o20">ObjectTable</a>;
00202 
00203     <span class="comment">//</span>
00204     <span class="comment">// Security</span>
00205     <span class="comment">//</span>
00206 
<a name="l00207"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o21">00207</a>     PACCESS_TOKEN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o21">Token</a>;         <span class="comment">// This field must never be null</span>
00208 
00209     <span class="comment">//</span>
00210 
<a name="l00211"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o22">00211</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o22">WorkingSetLock</a>;
<a name="l00212"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o23">00212</a>     PFN_NUMBER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o23">WorkingSetPage</a>;
<a name="l00213"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o24">00213</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o24">ProcessOutswapEnabled</a>;
<a name="l00214"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o25">00214</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o25">ProcessOutswapped</a>;
<a name="l00215"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o26">00215</a>     UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o26">AddressSpaceInitialized</a>;
<a name="l00216"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o27">00216</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o27">AddressSpaceDeleted</a>;
<a name="l00217"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o28">00217</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o28">AddressCreationLock</a>;
<a name="l00218"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o29">00218</a>     KSPIN_LOCK <a class="code" href="../../d0/d4/struct__EPROCESS.html#o29">HyperSpaceLock</a>;
<a name="l00219"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o30">00219</a>     <span class="keyword">struct </span><a class="code" href="../../d5/d6/struct__ETHREAD.html">_ETHREAD</a> *<a class="code" href="../../d0/d4/struct__EPROCESS.html#o30">ForkInProgress</a>;
<a name="l00220"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o31">00220</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o31">VmOperation</a>;
<a name="l00221"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o32">00221</a>     UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o32">ForkWasSuccessful</a>;
<a name="l00222"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o33">00222</a>     UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o33">MmAgressiveWsTrimMask</a>;
<a name="l00223"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o34">00223</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o34">VmOperationEvent</a>;
<a name="l00224"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o35">00224</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o35">PaeTop</a>;
<a name="l00225"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o36">00225</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o36">LastFaultCount</a>;
<a name="l00226"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o37">00226</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o37">ModifiedPageCount</a>;
<a name="l00227"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o38">00227</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o38">VadRoot</a>;
<a name="l00228"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o39">00228</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o39">VadHint</a>;
<a name="l00229"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o40">00229</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o40">CloneRoot</a>;
<a name="l00230"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o41">00230</a>     PFN_NUMBER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o41">NumberOfPrivatePages</a>;
<a name="l00231"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o42">00231</a>     PFN_NUMBER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o42">NumberOfLockedPages</a>;
<a name="l00232"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o43">00232</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o43">NextPageColor</a>;
<a name="l00233"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o44">00233</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o44">ExitProcessCalled</a>;
00234 
00235     <span class="comment">//</span>
00236     <span class="comment">// Used by Debug Subsystem</span>
00237     <span class="comment">//</span>
00238 
<a name="l00239"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o45">00239</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o45">CreateProcessReported</a>;
<a name="l00240"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o46">00240</a>     HANDLE <a class="code" href="../../d0/d4/struct__EPROCESS.html#o46">SectionHandle</a>;
00241 
00242     <span class="comment">//</span>
00243     <span class="comment">// Peb</span>
00244     <span class="comment">//</span>
00245 
<a name="l00246"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o47">00246</a>     PPEB <a class="code" href="../../d0/d4/struct__EPROCESS.html#o47">Peb</a>;
<a name="l00247"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o48">00247</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o48">SectionBaseAddress</a>;
00248 
<a name="l00249"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o49">00249</a>     <a class="code" href="../../d1/d9/ps_8h.html#a34">PEPROCESS_QUOTA_BLOCK</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o49">QuotaBlock</a>;
<a name="l00250"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o50">00250</a>     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o50">LastThreadExitStatus</a>;
<a name="l00251"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o51">00251</a>     PPAGEFAULT_HISTORY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o51">WorkingSetWatch</a>;
<a name="l00252"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o52">00252</a>     HANDLE <a class="code" href="../../d0/d4/struct__EPROCESS.html#o52">Win32WindowStation</a>;
<a name="l00253"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o53">00253</a>     HANDLE <a class="code" href="../../d0/d4/struct__EPROCESS.html#o53">InheritedFromUniqueProcessId</a>;
<a name="l00254"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o54">00254</a>     ACCESS_MASK <a class="code" href="../../d0/d4/struct__EPROCESS.html#o54">GrantedAccess</a>;
<a name="l00255"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o55">00255</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o55">DefaultHardErrorProcessing</a>;
<a name="l00256"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o56">00256</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o56">LdtInformation</a>;
<a name="l00257"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o57">00257</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o57">VadFreeHint</a>;
<a name="l00258"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o58">00258</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o58">VdmObjects</a>;
<a name="l00259"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o59">00259</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o59">DeviceMap</a>;
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">// Id of the Hydra session in which this process is running</span>
00263     <span class="comment">//</span>
00264 
<a name="l00265"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o60">00265</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o60">SessionId</a>;
00266 
<a name="l00267"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o61">00267</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o61">PhysicalVadList</a>;
00268     <span class="keyword">union </span>{
<a name="l00269"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o62">00269</a>         HARDWARE_PTE PageDirectoryPte;
<a name="l00270"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o63">00270</a>         ULONGLONG Filler;
00271     };
<a name="l00272"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o64">00272</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o64">PaePageDirectoryPage</a>;
<a name="l00273"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o65">00273</a>     UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o65">ImageFileName</a>[ 16 ];
<a name="l00274"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o66">00274</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o66">VmTrimFaultValue</a>;
<a name="l00275"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o67">00275</a>     BOOLEAN <a class="code" href="../../d0/d4/struct__EPROCESS.html#o67">SetTimerResolution</a>;
<a name="l00276"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o68">00276</a>     UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o68">PriorityClass</a>;
00277     <span class="keyword">union </span>{
00278         <span class="keyword">struct </span>{
<a name="l00279"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o69">00279</a>             UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o69">SubSystemMinorVersion</a>;
<a name="l00280"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o70">00280</a>             UCHAR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o70">SubSystemMajorVersion</a>;
00281         };
<a name="l00282"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o71">00282</a>         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o71">SubSystemVersion</a>;
00283     };
<a name="l00284"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">00284</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a>;
<a name="l00285"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o73">00285</a>     <span class="keyword">struct </span><a class="code" href="../../d0/d3/struct__EJOB.html">_EJOB</a> *<a class="code" href="../../d0/d4/struct__EPROCESS.html#o73">Job</a>;
<a name="l00286"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o74">00286</a>     ULONG <a class="code" href="../../d0/d4/struct__EPROCESS.html#o74">JobStatus</a>;
<a name="l00287"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o75">00287</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o75">JobLinks</a>;
<a name="l00288"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o76">00288</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o76">LockedPagesList</a>;
00289 
00290     <span class="comment">//</span>
00291     <span class="comment">// Used by rdr/security for authentication</span>
00292     <span class="comment">//</span>
00293 
<a name="l00294"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o77">00294</a>     PVOID <a class="code" href="../../d0/d4/struct__EPROCESS.html#o77">SecurityPort</a> ;              
<a name="l00295"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o78">00295</a>     <a class="code" href="../../d1/d9/ps_8h.html#a36">PWOW64_PROCESS</a> <a class="code" href="../../d0/d4/struct__EPROCESS.html#o78">Wow64Process</a>;
00296 
<a name="l00297"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o79">00297</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o79">ReadOperationCount</a>;
<a name="l00298"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o80">00298</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o80">WriteOperationCount</a>;
<a name="l00299"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o81">00299</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o81">OtherOperationCount</a>;
<a name="l00300"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o82">00300</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o82">ReadTransferCount</a>;
<a name="l00301"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o83">00301</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o83">WriteTransferCount</a>;
<a name="l00302"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o84">00302</a>     LARGE_INTEGER <a class="code" href="../../d0/d4/struct__EPROCESS.html#o84">OtherTransferCount</a>;
00303 
<a name="l00304"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o85">00304</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o85">CommitChargeLimit</a>;
<a name="l00305"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o86">00305</a>     SIZE_T <a class="code" href="../../d0/d4/struct__EPROCESS.html#o86">CommitChargePeak</a>;
00306 
<a name="l00307"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o87">00307</a>     LIST_ENTRY <a class="code" href="../../d0/d4/struct__EPROCESS.html#o87">ThreadListHead</a>;
00308 
<a name="l00309"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o88">00309</a>     PRTL_BITMAP <a class="code" href="../../d0/d4/struct__EPROCESS.html#o88">VadPhysicalPagesBitMap</a>;
<a name="l00310"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o89">00310</a>     ULONG_PTR <a class="code" href="../../d0/d4/struct__EPROCESS.html#o89">VadPhysicalPages</a>;
<a name="l00311"></a><a class="code" href="../../d0/d4/struct__EPROCESS.html#o90">00311</a>     KSPIN_LOCK <a class="code" href="../../d0/d4/struct__EPROCESS.html#o90">AweLock</a>;
00312 } <a class="code" href="../../d0/d4/struct__EPROCESS.html">EPROCESS</a>;
00313 
<a name="l00314"></a><a class="code" href="../../d1/d9/ps_8h.html#a9">00314</a> <span class="preprocessor">#define PS_JOB_STATUS_NOT_REALLY_ACTIVE      0x00000001</span>
<a name="l00315"></a><a class="code" href="../../d1/d9/ps_8h.html#a10">00315</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_JOB_STATUS_ACCOUNTING_FOLDED      0x00000002</span>
<a name="l00316"></a><a class="code" href="../../d1/d9/ps_8h.html#a11">00316</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_JOB_STATUS_NEW_PROCESS_REPORTED   0x00000004</span>
<a name="l00317"></a><a class="code" href="../../d1/d9/ps_8h.html#a12">00317</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_JOB_STATUS_EXIT_PROCESS_REPORTED  0x00000008</span>
<a name="l00318"></a><a class="code" href="../../d1/d9/ps_8h.html#a13">00318</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_JOB_STATUS_REPORT_COMMIT_CHANGES  0x00000010</span>
<a name="l00319"></a><a class="code" href="../../d1/d9/ps_8h.html#a14">00319</a> <span class="preprocessor"></span><span class="preprocessor">#define PS_JOB_STATUS_LAST_REPORT_MEMORY     0x00000020</span>
00320 <span class="preprocessor"></span>
<a name="l00321"></a><a class="code" href="../../d1/d9/ps_8h.html#a38">00321</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d4/struct__EPROCESS.html">EPROCESS</a> *<a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>;
00322 
00323 
00324 <span class="comment">//</span>
00325 <span class="comment">// Thread Object</span>
00326 <span class="comment">//</span>
00327 <span class="comment">// Thread object body.  A pointer to this structure is returned when a handle</span>
00328 <span class="comment">// to a thread object is referenced.  This structure contains a thread control</span>
00329 <span class="comment">// block (TCB) which is the kernel's representation of a thread.</span>
00330 <span class="comment">//</span>
00331 <span class="comment">// If you remove a field from this structure, please also</span>
00332 <span class="comment">// remove the reference to it from within the kernel debugger</span>
00333 <span class="comment">// (nt\private\sdktools\ntsd\ntkext.c)</span>
00334 <span class="comment">//</span>
00335 
00336 <span class="comment">//</span>
00337 <span class="comment">// The upper 4 bits of the CreateTime should be zero on initialization so</span>
00338 <span class="comment">// that the shift doesn't destroy anything.</span>
00339 <span class="comment">//</span>
00340 
<a name="l00341"></a><a class="code" href="../../d1/d9/ps_8h.html#a15">00341</a> <span class="preprocessor">#define PS_GET_THREAD_CREATE_TIME(Thread) ((Thread)-&gt;CreateTime.QuadPart &gt;&gt; 3)</span>
00342 <span class="preprocessor"></span>
<a name="l00343"></a><a class="code" href="../../d1/d9/ps_8h.html#a16">00343</a> <span class="preprocessor">#define PS_SET_THREAD_CREATE_TIME(Thread, InputCreateTime) \</span>
00344 <span class="preprocessor">            ((Thread)-&gt;CreateTime.QuadPart = (InputCreateTime.QuadPart &lt;&lt; 3))</span>
00345 <span class="preprocessor"></span>
<a name="l00346"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html">00346</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d6/struct__ETHREAD.html">_ETHREAD</a> {
<a name="l00347"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o0">00347</a>     <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o0">Tcb</a>;
00348     <span class="keyword">union </span>{
00349 
00350         <span class="comment">//</span>
00351         <span class="comment">// The fact that this is a union means that all accesses to CreateTime</span>
00352         <span class="comment">// must be sanitized using the two macros above.</span>
00353         <span class="comment">//</span>
00354 
<a name="l00355"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o1">00355</a>         LARGE_INTEGER <a class="code" href="../../d5/d6/struct__ETHREAD.html#o1">CreateTime</a>;
00356     
00357         <span class="comment">//</span>
00358         <span class="comment">// These fields are accessed only by the owning thread, but can be</span>
00359         <span class="comment">// accessed from within a special kernel APC so IRQL protection must</span>
00360         <span class="comment">// be applied.</span>
00361         <span class="comment">//</span>
00362     
00363         <span class="keyword">struct </span>{
<a name="l00364"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o2">00364</a>             <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o2">NestedFaultCount</a> : 2;
<a name="l00365"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o3">00365</a>             <span class="keywordtype">unsigned</span> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o3">ApcNeeded</a> : 1;
00366         };
00367     };
00368 
00369     <span class="keyword">union </span>{
<a name="l00370"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o4">00370</a>         LARGE_INTEGER <a class="code" href="../../d5/d6/struct__ETHREAD.html#o4">ExitTime</a>;
<a name="l00371"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o5">00371</a>         LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o5">LpcReplyChain</a>;
00372     };
00373     <span class="keyword">union </span>{
<a name="l00374"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o6">00374</a>         <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o6">ExitStatus</a>;
<a name="l00375"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o7">00375</a>         PVOID <a class="code" href="../../d5/d6/struct__ETHREAD.html#o7">OfsChain</a>;
00376     };
00377 
00378     <span class="comment">//</span>
00379     <span class="comment">// Registry</span>
00380     <span class="comment">//</span>
00381 
<a name="l00382"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o8">00382</a>     LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o8">PostBlockList</a>;
<a name="l00383"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o9">00383</a>     LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o9">TerminationPortList</a>;     <span class="comment">// also used as reaper links</span>
00384 
<a name="l00385"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o10">00385</a>     KSPIN_LOCK <a class="code" href="../../d5/d6/struct__ETHREAD.html#o10">ActiveTimerListLock</a>;
<a name="l00386"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o11">00386</a>     LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o11">ActiveTimerListHead</a>;
00387 
<a name="l00388"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o12">00388</a>     CLIENT_ID <a class="code" href="../../d5/d6/struct__ETHREAD.html#o12">Cid</a>;
00389 
00390     <span class="comment">//</span>
00391     <span class="comment">// Lpc</span>
00392     <span class="comment">//</span>
00393 
<a name="l00394"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o13">00394</a>     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o13">LpcReplySemaphore</a>;
<a name="l00395"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o14">00395</a>     PVOID <a class="code" href="../../d5/d6/struct__ETHREAD.html#o14">LpcReplyMessage</a>;          <span class="comment">// -&gt; Message that contains the reply</span>
<a name="l00396"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o15">00396</a>     ULONG <a class="code" href="../../d5/d6/struct__ETHREAD.html#o15">LpcReplyMessageId</a>;        <span class="comment">// MessageId this thread is waiting for reply to</span>
00397 
00398     <span class="comment">//</span>
00399     <span class="comment">// Security</span>
00400     <span class="comment">//</span>
00401     <span class="comment">//</span>
00402     <span class="comment">//    Client - If non null, indicates the thread is impersonating</span>
00403     <span class="comment">//        a client.</span>
00404     <span class="comment">//</span>
00405 
<a name="l00406"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o16">00406</a>     ULONG <a class="code" href="../../d5/d6/struct__ETHREAD.html#o16">PerformanceCountLow</a>;
<a name="l00407"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o17">00407</a>     <a class="code" href="../../d1/d9/ps_8h.html#a32">PPS_IMPERSONATION_INFORMATION</a> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o17">ImpersonationInfo</a>;
00408 
00409 
00410     <span class="comment">//</span>
00411     <span class="comment">// Io</span>
00412     <span class="comment">//</span>
00413 
<a name="l00414"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o18">00414</a>     LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o18">IrpList</a>;
00415 
00416     <span class="comment">//</span>
00417     <span class="comment">//  File Systems</span>
00418     <span class="comment">//</span>
00419 
<a name="l00420"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o19">00420</a>     ULONG_PTR <a class="code" href="../../d5/d6/struct__ETHREAD.html#o19">TopLevelIrp</a>;  <span class="comment">// either NULL, an Irp or a flag defined in FsRtl.h</span>
<a name="l00421"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o20">00421</a>     <span class="keyword">struct </span><a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">_DEVICE_OBJECT</a> *<a class="code" href="../../d5/d6/struct__ETHREAD.html#o20">DeviceToVerify</a>;
00422 
00423     <span class="comment">//</span>
00424     <span class="comment">// Mm</span>
00425     <span class="comment">//</span>
00426 
<a name="l00427"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o21">00427</a>     ULONG <a class="code" href="../../d5/d6/struct__ETHREAD.html#o21">ReadClusterSize</a>;
<a name="l00428"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o22">00428</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o22">ForwardClusterOnly</a>;
<a name="l00429"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o23">00429</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o23">DisablePageFaultClustering</a>;
00430 
<a name="l00431"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o24">00431</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o24">DeadThread</a>;
<a name="l00432"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o25">00432</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o25">HideFromDebugger</a>;
00433 
<a name="l00434"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o26">00434</a>     ULONG <a class="code" href="../../d5/d6/struct__ETHREAD.html#o26">HasTerminated</a>;
00435 
00436     <span class="comment">//</span>
00437     <span class="comment">// Client/server</span>
00438     <span class="comment">//</span>
00439 
<a name="l00440"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o27">00440</a>     ACCESS_MASK <a class="code" href="../../d5/d6/struct__ETHREAD.html#o27">GrantedAccess</a>;
<a name="l00441"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o28">00441</a>     <a class="code" href="../../d1/d9/ps_8h.html#a38">PEPROCESS</a> <a class="code" href="../../d5/d6/struct__ETHREAD.html#o28">ThreadsProcess</a>;
<a name="l00442"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o29">00442</a>     PVOID <a class="code" href="../../d5/d6/struct__ETHREAD.html#o29">StartAddress</a>;
00443     <span class="keyword">union </span>{
<a name="l00444"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o30">00444</a>         PVOID Win32StartAddress;
<a name="l00445"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o31">00445</a>         ULONG LpcReceivedMessageId;
00446     };
<a name="l00447"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o32">00447</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o32">LpcExitThreadCalled</a>;
<a name="l00448"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o33">00448</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o33">HardErrorsAreDisabled</a>;
<a name="l00449"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o34">00449</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o34">LpcReceivedMsgIdValid</a>;
<a name="l00450"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o35">00450</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__ETHREAD.html#o35">ActiveImpersonationInfo</a>;
<a name="l00451"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o36">00451</a>     LONG <a class="code" href="../../d5/d6/struct__ETHREAD.html#o36">PerformanceCountHigh</a>;
00452 
<a name="l00453"></a><a class="code" href="../../d5/d6/struct__ETHREAD.html#o37">00453</a>     LIST_ENTRY <a class="code" href="../../d5/d6/struct__ETHREAD.html#o37">ThreadListEntry</a>;
00454 
00455 } <a class="code" href="../../d5/d6/struct__ETHREAD.html">ETHREAD</a>;
<a name="l00456"></a><a class="code" href="../../d1/d9/ps_8h.html#a40">00456</a> <span class="keyword">typedef</span> <a class="code" href="../../d5/d6/struct__ETHREAD.html">ETHREAD</a> *<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>;
00457 
00458 <span class="comment">//</span>
00459 <span class="comment">// Initial PEB</span>
00460 <span class="comment">//</span>
00461 
<a name="l00462"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html">00462</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html">_INITIAL_PEB</a> {
<a name="l00463"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o0">00463</a>     BOOLEAN <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o0">InheritedAddressSpace</a>;      <span class="comment">// These four fields cannot change unless the</span>
<a name="l00464"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o1">00464</a>     BOOLEAN <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o1">ReadImageFileExecOptions</a>;   <span class="comment">//</span>
<a name="l00465"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o2">00465</a>     BOOLEAN <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o2">BeingDebugged</a>;              <span class="comment">//</span>
<a name="l00466"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o3">00466</a>     BOOLEAN <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o3">SpareBool</a>;                  <span class="comment">//</span>
<a name="l00467"></a><a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o4">00467</a>     HANDLE <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html#o4">Mutant</a>;                      <span class="comment">// PEB structure is also updated.</span>
00468 } <a class="code" href="../../d2/d2/struct__INITIAL__PEB.html">INITIAL_PEB</a>, *<a class="code" href="../../d2/d2/struct__INITIAL__PEB.html">PINITIAL_PEB</a>;
00469 
<a name="l00470"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html">00470</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html">_PS_JOB_TOKEN_FILTER</a> {
<a name="l00471"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o0">00471</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o0">CapturedSidCount</a> ;
<a name="l00472"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o1">00472</a>     PSID_AND_ATTRIBUTES <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o1">CapturedSids</a> ;
<a name="l00473"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o2">00473</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o2">CapturedSidsLength</a> ;
00474 
<a name="l00475"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o3">00475</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o3">CapturedGroupCount</a> ;
<a name="l00476"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o4">00476</a>     PSID_AND_ATTRIBUTES <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o4">CapturedGroups</a> ;
<a name="l00477"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o5">00477</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o5">CapturedGroupsLength</a> ;
00478 
<a name="l00479"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o6">00479</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o6">CapturedPrivilegeCount</a> ;
<a name="l00480"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o7">00480</a>     PLUID_AND_ATTRIBUTES <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o7">CapturedPrivileges</a> ;
<a name="l00481"></a><a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o8">00481</a>     ULONG <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html#o8">CapturedPrivilegesLength</a> ;
00482 } <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html">PS_JOB_TOKEN_FILTER</a>, * <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html">PPS_JOB_TOKEN_FILTER</a> ;
00483 
00484 <span class="comment">//</span>
00485 <span class="comment">// Job Object</span>
00486 <span class="comment">//</span>
<a name="l00487"></a><a class="code" href="../../d0/d3/struct__EJOB.html">00487</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d3/struct__EJOB.html">_EJOB</a> {
<a name="l00488"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o0">00488</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d0/d3/struct__EJOB.html#o0">Event</a>;
<a name="l00489"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o1">00489</a>     LIST_ENTRY <a class="code" href="../../d0/d3/struct__EJOB.html#o1">JobLinks</a>;
<a name="l00490"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o2">00490</a>     LIST_ENTRY <a class="code" href="../../d0/d3/struct__EJOB.html#o2">ProcessListHead</a>;
<a name="l00491"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o3">00491</a>     <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a> <a class="code" href="../../d0/d3/struct__EJOB.html#o3">JobLock</a>;
00492 
00493     <span class="comment">//</span>
00494     <span class="comment">// Accounting Info</span>
00495     <span class="comment">//</span>
00496 
<a name="l00497"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o4">00497</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o4">TotalUserTime</a>;
<a name="l00498"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o5">00498</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o5">TotalKernelTime</a>;
<a name="l00499"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o6">00499</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o6">ThisPeriodTotalUserTime</a>;
<a name="l00500"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o7">00500</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o7">ThisPeriodTotalKernelTime</a>;
<a name="l00501"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o8">00501</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o8">TotalPageFaultCount</a>;
<a name="l00502"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o9">00502</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o9">TotalProcesses</a>;
<a name="l00503"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o10">00503</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o10">ActiveProcesses</a>;
<a name="l00504"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o11">00504</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o11">TotalTerminatedProcesses</a>;
00505 
00506     <span class="comment">//</span>
00507     <span class="comment">// Limitable Attributes</span>
00508     <span class="comment">//</span>
00509 
<a name="l00510"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o12">00510</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o12">PerProcessUserTimeLimit</a>;
<a name="l00511"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o13">00511</a>     LARGE_INTEGER <a class="code" href="../../d0/d3/struct__EJOB.html#o13">PerJobUserTimeLimit</a>;
<a name="l00512"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o14">00512</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o14">LimitFlags</a>;
<a name="l00513"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o15">00513</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o15">MinimumWorkingSetSize</a>;
<a name="l00514"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o16">00514</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o16">MaximumWorkingSetSize</a>;
<a name="l00515"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o17">00515</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o17">ActiveProcessLimit</a>;
<a name="l00516"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o18">00516</a>     KAFFINITY <a class="code" href="../../d0/d3/struct__EJOB.html#o18">Affinity</a>;
<a name="l00517"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o19">00517</a>     UCHAR <a class="code" href="../../d0/d3/struct__EJOB.html#o19">PriorityClass</a>;
00518 
00519     <span class="comment">//</span>
00520     <span class="comment">// UI restrictions</span>
00521     <span class="comment">//</span>
00522 
<a name="l00523"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o20">00523</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o20">UIRestrictionsClass</a>;
00524 
00525     <span class="comment">//</span>
00526     <span class="comment">// Security Limitations:  write once, read always</span>
00527     <span class="comment">//</span>
00528 
<a name="l00529"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o21">00529</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o21">SecurityLimitFlags</a> ;
<a name="l00530"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o22">00530</a>     PACCESS_TOKEN <a class="code" href="../../d0/d3/struct__EJOB.html#o22">Token</a> ;
<a name="l00531"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o23">00531</a>     <a class="code" href="../../d1/d9/ps_8h.html#a44">PPS_JOB_TOKEN_FILTER</a> <a class="code" href="../../d0/d3/struct__EJOB.html#o23">Filter</a> ;
00532 
00533     <span class="comment">//</span>
00534     <span class="comment">// End Of Job Time Limit</span>
00535     <span class="comment">//</span>
00536 
<a name="l00537"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o24">00537</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o24">EndOfJobTimeAction</a>;
<a name="l00538"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o25">00538</a>     PVOID <a class="code" href="../../d0/d3/struct__EJOB.html#o25">CompletionPort</a>;
<a name="l00539"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o26">00539</a>     PVOID <a class="code" href="../../d0/d3/struct__EJOB.html#o26">CompletionKey</a>;
00540 
<a name="l00541"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o27">00541</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o27">SessionId</a>;
00542 
<a name="l00543"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o28">00543</a>     ULONG <a class="code" href="../../d0/d3/struct__EJOB.html#o28">SchedulingClass</a>;
00544 
<a name="l00545"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o29">00545</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o29">ReadOperationCount</a>;
<a name="l00546"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o30">00546</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o30">WriteOperationCount</a>;
<a name="l00547"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o31">00547</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o31">OtherOperationCount</a>;
<a name="l00548"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o32">00548</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o32">ReadTransferCount</a>;
<a name="l00549"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o33">00549</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o33">WriteTransferCount</a>;
<a name="l00550"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o34">00550</a>     ULONGLONG <a class="code" href="../../d0/d3/struct__EJOB.html#o34">OtherTransferCount</a>;
00551 
00552     <span class="comment">//</span>
00553     <span class="comment">// Extended Limits</span>
00554     <span class="comment">//</span>
00555 
<a name="l00556"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o35">00556</a>     IO_COUNTERS <a class="code" href="../../d0/d3/struct__EJOB.html#o35">IoInfo</a>;         <span class="comment">// not used yet</span>
<a name="l00557"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o36">00557</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o36">ProcessMemoryLimit</a>;
<a name="l00558"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o37">00558</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o37">JobMemoryLimit</a>;
<a name="l00559"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o38">00559</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o38">PeakProcessMemoryUsed</a>;
<a name="l00560"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o39">00560</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o39">PeakJobMemoryUsed</a>;
<a name="l00561"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o40">00561</a>     SIZE_T <a class="code" href="../../d0/d3/struct__EJOB.html#o40">CurrentJobMemoryUsed</a>;
00562 
<a name="l00563"></a><a class="code" href="../../d0/d3/struct__EJOB.html#o41">00563</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d0/d3/struct__EJOB.html#o41">MemoryLimitsLock</a>;
00564 
00565 } <a class="code" href="../../d0/d3/struct__EJOB.html">EJOB</a>;
<a name="l00566"></a><a class="code" href="../../d1/d9/ps_8h.html#a46">00566</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d3/struct__EJOB.html">EJOB</a> *<a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a>;
00567 
00568 
00569 <span class="comment">//</span>
00570 <span class="comment">// Global Variables</span>
00571 <span class="comment">//</span>
00572 
<a name="l00573"></a><a class="code" href="../../d1/d9/ps_8h.html#a47">00573</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d1/d9/ps_8h.html#a47">PsPrioritySeperation</a>;
<a name="l00574"></a><a class="code" href="../../d1/d9/ps_8h.html#a48">00574</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d1/d9/ps_8h.html#a48">PsRawPrioritySeparation</a>;
<a name="l00575"></a><a class="code" href="../../d1/d9/ps_8h.html#a49">00575</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d1/d9/ps_8h.html#a49">PsActiveProcessHead</a>;
<a name="l00576"></a><a class="code" href="../../d1/d9/ps_8h.html#a50">00576</a> <span class="keyword">extern</span> UNICODE_STRING <a class="code" href="../../d1/d9/ps_8h.html#a50">PsNtDllPathName</a>;
<a name="l00577"></a><a class="code" href="../../d1/d9/ps_8h.html#a51">00577</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d1/d9/ps_8h.html#a51">PsSystemDllBase</a>;
<a name="l00578"></a><a class="code" href="../../d1/d9/ps_8h.html#a52">00578</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d1/d9/ps_8h.html#a52">PsProcessSecurityLock</a>;
<a name="l00579"></a><a class="code" href="../../d1/d9/ps_8h.html#a53">00579</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d9/ps_8h.html#a38">PEPROCESS</a> <a class="code" href="../../d1/d9/ps_8h.html#a53">PsInitialSystemProcess</a>;
<a name="l00580"></a><a class="code" href="../../d1/d9/ps_8h.html#a54">00580</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d1/d9/ps_8h.html#a54">PsNtosImageBase</a>;
<a name="l00581"></a><a class="code" href="../../d1/d9/ps_8h.html#a55">00581</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d1/d9/ps_8h.html#a55">PsHalImageBase</a>;
<a name="l00582"></a><a class="code" href="../../d1/d9/ps_8h.html#a56">00582</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d1/d9/ps_8h.html#a56">PsLoadedModuleList</a>;
<a name="l00583"></a><a class="code" href="../../d1/d9/ps_8h.html#a57">00583</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a> <a class="code" href="../../d1/d9/ps_8h.html#a57">PsLoadedModuleResource</a>;
<a name="l00584"></a><a class="code" href="../../d1/d9/ps_8h.html#a58">00584</a> <span class="keyword">extern</span> LCID <a class="code" href="../../d1/d9/ps_8h.html#a58">PsDefaultSystemLocaleId</a>;
<a name="l00585"></a><a class="code" href="../../d1/d9/ps_8h.html#a59">00585</a> <span class="keyword">extern</span> LCID <a class="code" href="../../d1/d9/ps_8h.html#a59">PsDefaultThreadLocaleId</a>;
<a name="l00586"></a><a class="code" href="../../d1/d9/ps_8h.html#a60">00586</a> <span class="keyword">extern</span> LANGID <a class="code" href="../../d1/d9/ps_8h.html#a60">PsDefaultUILanguageId</a>;
<a name="l00587"></a><a class="code" href="../../d1/d9/ps_8h.html#a61">00587</a> <span class="keyword">extern</span> LANGID <a class="code" href="../../d1/d9/ps_8h.html#a61">PsInstallUILanguageId</a>;
<a name="l00588"></a><a class="code" href="../../d1/d9/ps_8h.html#a62">00588</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d9/ps_8h.html#a38">PEPROCESS</a> <a class="code" href="../../d1/d9/ps_8h.html#a62">PsIdleProcess</a>;
<a name="l00589"></a><a class="code" href="../../d1/d9/ps_8h.html#a63">00589</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d9/ps_8h.html#a63">PsReaperActive</a>;
<a name="l00590"></a><a class="code" href="../../d1/d9/ps_8h.html#a64">00590</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d1/d9/ps_8h.html#a64">PsReaperListHead</a>;
<a name="l00591"></a><a class="code" href="../../d1/d9/ps_8h.html#a65">00591</a> <span class="keyword">extern</span> <a class="code" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="code" href="../../d1/d9/ps_8h.html#a65">PsReaperWorkItem</a>;
00592 
00593 BOOLEAN
00594 <a class="code" href="../../d1/d1/psjob_8c.html#a20">PsChangeJobMemoryUsage</a>(
00595     SSIZE_T Amount
00596     );
00597 
00598 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00599 <a class="code" href="../../d1/d1/psjob_8c.html#a21">PsReportProcessMemoryLimitViolation</a>(
00600     VOID
00601     );
00602 
00603 <span class="preprocessor">#if DEVL</span>
00604 <span class="preprocessor"></span><span class="preprocessor">#define THREAD_HIT_SLOTS 750</span>
00605 <span class="preprocessor"></span><span class="keyword">extern</span> ULONG PsThreadHits[THREAD_HIT_SLOTS];
00606 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00607 PsThreadHit(
00608     IN PETHREAD Thread
00609     );
00610 <span class="preprocessor">#endif // DEVL</span>
00611 <span class="preprocessor"></span>
00612 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00613 <a class="code" href="../../d1/d1/psjob_8c.html#a16">PsEnforceExecutionTimeLimits</a>(
00614     VOID
00615     );
00616 
00617 BOOLEAN
00618 <a class="code" href="../../d0/d1/psinit_8c.html#a41">PsInitSystem</a> (
00619     IN ULONG Phase,
00620     IN <a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock
00621     );
00622 
00623 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00624 <a class="code" href="../../d0/d1/psinit_8c.html#a44">PsLocateSystemDll</a> (
00625     VOID
00626     );
00627 
00628 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00629 <a class="code" href="../../d0/d1/psinit_8c.html#a48">PsChangeQuantumTable</a>(
00630     BOOLEAN ModifyActiveProcesses,
00631     ULONG PrioritySeparation
00632     );
00633 
00634 <span class="comment">//</span>
00635 <span class="comment">// Get Gurrent Prototypes</span>
00636 <span class="comment">//</span>
00637 
<a name="l00638"></a><a class="code" href="../../d1/d9/ps_8h.html#a17">00638</a> <span class="preprocessor">#define THREAD_TO_PROCESS(thread) ((thread)-&gt;ThreadsProcess)</span>
<a name="l00639"></a><a class="code" href="../../d1/d9/ps_8h.html#a18">00639</a> <span class="preprocessor"></span><span class="preprocessor">#define IS_SYSTEM_THREAD(thread)                                    \</span>
00640 <span class="preprocessor">            (((thread)-&gt;Tcb.Teb == NULL) ||                         \</span>
00641 <span class="preprocessor">            (IS_SYSTEM_ADDRESS((thread)-&gt;Tcb.Teb)))</span>
00642 <span class="preprocessor"></span>
<a name="l00643"></a><a class="code" href="../../d1/d9/ps_8h.html#a19">00643</a> <span class="preprocessor">#define PsGetCurrentProcess() (CONTAINING_RECORD(((KeGetCurrentThread())-&gt;ApcState.Process),EPROCESS,Pcb))</span>
00644 <span class="preprocessor"></span>
<a name="l00645"></a><a class="code" href="../../d1/d9/ps_8h.html#a20">00645</a> <span class="preprocessor">#define PsGetCurrentThread() (CONTAINING_RECORD((KeGetCurrentThread()),ETHREAD,Tcb))</span>
00646 <span class="preprocessor"></span>
00647 
00648 
00649 <span class="comment">//</span>
00650 <span class="comment">// VOID</span>
00651 <span class="comment">// PsLockProcessSecurityFields(VOID)</span>
00652 <span class="comment">//</span>
00653 
<a name="l00654"></a><a class="code" href="../../d1/d9/ps_8h.html#a21">00654</a> <span class="preprocessor">#define PsLockProcessSecurityFields( ) ExAcquireFastMutex( &amp;PsProcessSecurityLock )</span>
00655 <span class="preprocessor"></span>
00656 <span class="comment">//</span>
00657 <span class="comment">// VOID</span>
00658 <span class="comment">// PsFreeProcessSecurityFields(VOID);</span>
00659 <span class="comment">//</span>
00660 
<a name="l00661"></a><a class="code" href="../../d1/d9/ps_8h.html#a22">00661</a> <span class="preprocessor">#define PsFreeProcessSecurityFields( ) ExReleaseFastMutex( &amp;PsProcessSecurityLock )</span>
00662 <span class="preprocessor"></span>
00663 <span class="comment">//</span>
00664 <span class="comment">// Exit special kernel mode APC routine.</span>
00665 <span class="comment">//</span>
00666 
00667 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00668 <a class="code" href="../../d8/d0/psdelete_8c.html#a9">PsExitSpecialApc</a>(
00669     IN <a class="code" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc,
00670     IN PKNORMAL_ROUTINE *NormalRoutine,
00671     IN PVOID *NormalContext,
00672     IN PVOID *SystemArgument1,
00673     IN PVOID *SystemArgument2
00674     );
00675 
00676 <span class="comment">// begin_ntddk begin_wdm begin_nthal begin_ntifs</span>
00677 <span class="comment">//</span>
00678 <span class="comment">// System Thread and Process Creation and Termination</span>
00679 <span class="comment">//</span>
00680 
00681 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00682 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00683 <a class="code" href="../../d2/d8/ps_2create_8c.html#a11">PsCreateSystemThread</a>(
00684     OUT PHANDLE ThreadHandle,
00685     IN ULONG DesiredAccess,
00686     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL,
00687     IN HANDLE ProcessHandle OPTIONAL,
00688     OUT PCLIENT_ID ClientId OPTIONAL,
00689     IN PKSTART_ROUTINE StartRoutine,
00690     IN PVOID StartContext
00691     );
00692 
00693 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00694 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00695 <a class="code" href="../../d8/d0/psdelete_8c.html#a7">PsTerminateSystemThread</a>(
00696     IN NTSTATUS ExitStatus
00697     );
00698 
00699 <span class="comment">// end_ntddk end_wdm end_nthal end_ntifs</span>
00700 
00701 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00702 <a class="code" href="../../d2/d8/ps_2create_8c.html#a15">PsCreateSystemProcess</a>(
00703     OUT PHANDLE ProcessHandle,
00704     IN ULONG DesiredAccess,
00705     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL
00706     );
00707 
00708 <span class="keyword">typedef</span>
<a name="l00709"></a><a class="code" href="../../d1/d9/ps_8h.html#a66">00709</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d1/d9/ps_8h.html#a66">PLEGO_NOTIFY_ROUTINE</a>)(
00710     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread
00711     );
00712 
00713 ULONG
00714 <a class="code" href="../../d8/d0/psdelete_8c.html#a1">PsSetLegoNotifyRoutine</a>(
00715     PLEGO_NOTIFY_ROUTINE LegoNotifyRoutine
00716     );
00717 
00718 
00719 
00720 <span class="comment">// begin_ntifs begin_ntddk</span>
00721 
00722 <span class="keyword">typedef</span>
00723 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00724"></a><a class="code" href="../../d1/d9/ps_8h.html#a67">00724</a> (*PCREATE_PROCESS_NOTIFY_ROUTINE)(
00725     IN HANDLE ParentId,
00726     IN HANDLE ProcessId,
00727     IN BOOLEAN <a class="code" href="../../d4/d5/conimep_8h.html#a111">Create</a>
00728     );
00729 
00730 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00731 <a class="code" href="../../d2/d8/ps_2create_8c.html#a17">PsSetCreateProcessNotifyRoutine</a>(
00732     IN <a class="code" href="../../d1/d9/ps_8h.html#a67">PCREATE_PROCESS_NOTIFY_ROUTINE</a> NotifyRoutine,
00733     IN BOOLEAN Remove
00734     );
00735 
00736 <span class="keyword">typedef</span>
00737 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00738"></a><a class="code" href="../../d1/d9/ps_8h.html#a68">00738</a> (*PCREATE_THREAD_NOTIFY_ROUTINE)(
00739     IN HANDLE ProcessId,
00740     IN HANDLE ThreadId,
00741     IN BOOLEAN <a class="code" href="../../d4/d5/conimep_8h.html#a111">Create</a>
00742     );
00743 
00744 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00745 <a class="code" href="../../d2/d8/ps_2create_8c.html#a18">PsSetCreateThreadNotifyRoutine</a>(
00746     IN <a class="code" href="../../d1/d9/ps_8h.html#a68">PCREATE_THREAD_NOTIFY_ROUTINE</a> NotifyRoutine
00747     );
00748 
00749 <span class="comment">//</span>
00750 <span class="comment">// Structures for Load Image Notify</span>
00751 <span class="comment">//</span>
00752 
<a name="l00753"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html">00753</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html">_IMAGE_INFO</a> {
00754     <span class="keyword">union </span>{
<a name="l00755"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o0">00755</a>         ULONG <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o0">Properties</a>;
00756         <span class="keyword">struct </span>{
<a name="l00757"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o1">00757</a>             ULONG <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o1">ImageAddressingMode</a>  : 8;  <span class="comment">// code addressing mode</span>
<a name="l00758"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o2">00758</a>             ULONG <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o2">SystemModeImage</a>      : 1;  <span class="comment">// system mode image</span>
<a name="l00759"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o3">00759</a>             ULONG <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o3">ImageMappedToAllPids</a> : 1;  <span class="comment">// image mapped into all processes</span>
<a name="l00760"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o4">00760</a>             ULONG <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o4">Reserved</a>             : 22;
00761         };
00762     };
<a name="l00763"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o5">00763</a>     PVOID       <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o5">ImageBase</a>;
<a name="l00764"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o6">00764</a>     ULONG       <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o6">ImageSelector</a>;
<a name="l00765"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o7">00765</a>     SIZE_T      <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o7">ImageSize</a>;
<a name="l00766"></a><a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o8">00766</a>     ULONG       <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html#o8">ImageSectionNumber</a>;
00767 } <a class="code" href="../../d2/d1/struct__IMAGE__INFO.html">IMAGE_INFO</a>, *<a class="code" href="../../d2/d1/struct__IMAGE__INFO.html">PIMAGE_INFO</a>;
00768 
<a name="l00769"></a><a class="code" href="../../d1/d9/ps_8h.html#a23">00769</a> <span class="preprocessor">#define IMAGE_ADDRESSING_MODE_32BIT     3</span>
00770 <span class="preprocessor"></span>
00771 <span class="keyword">typedef</span>
00772 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00773"></a><a class="code" href="../../d1/d9/ps_8h.html#a71">00773</a> (*PLOAD_IMAGE_NOTIFY_ROUTINE)(
00774     IN PUNICODE_STRING FullImageName,
00775     IN HANDLE ProcessId,                <span class="comment">// pid into which image is being mapped</span>
00776     IN <a class="code" href="../../d1/d9/ps_8h.html#a70">PIMAGE_INFO</a> ImageInfo
00777     );
00778 
00779 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00780 <a class="code" href="../../d2/d8/ps_2create_8c.html#a27">PsSetLoadImageNotifyRoutine</a>(
00781     IN <a class="code" href="../../d1/d9/ps_8h.html#a71">PLOAD_IMAGE_NOTIFY_ROUTINE</a> NotifyRoutine
00782     );
00783 <span class="comment">// end_ntddk end_ntifs</span>
00784 
00785 <span class="comment">// begin_ntsrv</span>
00786 <span class="comment">//</span>
00787 <span class="comment">// Security Support</span>
00788 <span class="comment">//</span>
00789 
00790 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00791 <a class="code" href="../../d6/d5/ps_2security_8c.html#a15">PsAssignImpersonationToken</a>(
00792     IN PETHREAD Thread,
00793     IN HANDLE Token
00794     );
00795 
00796 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00797 PACCESS_TOKEN
00798 <a class="code" href="../../d6/d5/ps_2security_8c.html#a0">PsReferencePrimaryToken</a>(
00799     IN PEPROCESS Process
00800     );
00801 
00802 <span class="comment">// end_ntsrv</span>
00803 <span class="comment">// begin_ntifs</span>
00804 <span class="comment">//</span>
00805 <span class="comment">// VOID</span>
00806 <span class="comment">// PsDereferencePrimaryToken(</span>
00807 <span class="comment">//    IN PACCESS_TOKEN PrimaryToken</span>
00808 <span class="comment">//    );</span>
00809 <span class="comment">//</span>
<a name="l00810"></a><a class="code" href="../../d1/d9/ps_8h.html#a24">00810</a> <span class="preprocessor">#define PsDereferencePrimaryToken(T) (ObDereferenceObject((T)))</span>
00811 <span class="preprocessor"></span>
00812 <span class="comment">// end_ntifs</span>
00813 
<a name="l00814"></a><a class="code" href="../../d1/d9/ps_8h.html#a25">00814</a> <span class="preprocessor">#define PsProcessAuditId(Process)    ((Process)-&gt;UniqueProcessId)</span>
00815 <span class="preprocessor"></span>
00816 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00817 PACCESS_TOKEN
00818 <a class="code" href="../../d6/d5/ps_2security_8c.html#a1">PsReferenceImpersonationToken</a>(
00819     IN PETHREAD Thread,
00820     OUT PBOOLEAN CopyOnOpen,
00821     OUT PBOOLEAN EffectiveOnly,
00822     OUT PSECURITY_IMPERSONATION_LEVEL ImpersonationLevel
00823     );
00824 
00825 PACCESS_TOKEN
00826 <a class="code" href="../../d6/d5/ps_2security_8c.html#a2">PsReferenceEffectiveToken</a>(
00827     IN PETHREAD Thread,
00828     OUT PTOKEN_TYPE TokenType,
00829     OUT PBOOLEAN EffectiveOnly,
00830     OUT PSECURITY_IMPERSONATION_LEVEL ImpersonationLevel
00831     );
00832 
00833 <span class="comment">// begin_ntifs</span>
00834 <span class="comment">//</span>
00835 <span class="comment">// VOID</span>
00836 <span class="comment">// PsDereferenceImpersonationToken(</span>
00837 <span class="comment">//    In PACCESS_TOKEN ImpersonationToken</span>
00838 <span class="comment">//    );</span>
00839 <span class="comment">//</span>
<a name="l00840"></a><a class="code" href="../../d1/d9/ps_8h.html#a26">00840</a> <span class="preprocessor">#define PsDereferenceImpersonationToken(T)                                          \</span>
00841 <span class="preprocessor">            {if (ARGUMENT_PRESENT(T)) {                                       \</span>
00842 <span class="preprocessor">                (ObDereferenceObject((T)));                                   \</span>
00843 <span class="preprocessor">             } else {                                                         \</span>
00844 <span class="preprocessor">                ;                                                             \</span>
00845 <span class="preprocessor">             }                                                                \</span>
00846 <span class="preprocessor">            }</span>
00847 <span class="preprocessor"></span>
00848 LARGE_INTEGER
00849 <a class="code" href="../../d8/d0/psdelete_8c.html#a17">PsGetProcessExitTime</a>(
00850     VOID
00851     );
00852 
00853 <span class="comment">// end_ntifs</span>
00854 <span class="preprocessor">#if defined(_NTDDK_) || defined(_NTIFS_)</span>
00855 <span class="preprocessor"></span>
00856 <span class="comment">// begin_ntifs</span>
00857 BOOLEAN
00858 <a class="code" href="../../d1/d9/ps_8h.html#a27">PsIsThreadTerminating</a>(
00859     IN PETHREAD Thread
00860     );
00861 
00862 <span class="comment">// end_ntifs</span>
00863 
00864 <span class="preprocessor">#else</span>
00865 <span class="preprocessor"></span>
00866 <span class="comment">//</span>
00867 <span class="comment">// BOOLEAN</span>
00868 <span class="comment">// PsIsThreadTerminating(</span>
00869 <span class="comment">//   IN PETHREAD Thread</span>
00870 <span class="comment">//   )</span>
00871 <span class="comment">//</span>
00872 <span class="comment">//  Returns TRUE if thread is in the process of terminating.</span>
00873 <span class="comment">//</span>
00874 
<a name="l00875"></a><a class="code" href="../../d1/d9/ps_8h.html#a27">00875</a> <span class="preprocessor">#define PsIsThreadTerminating(T)                                            \</span>
00876 <span class="preprocessor">    (T)-&gt;HasTerminated</span>
00877 <span class="preprocessor"></span>
00878 <span class="preprocessor">#endif</span>
00879 <span class="preprocessor"></span>
<a name="l00880"></a><a class="code" href="../../d1/d9/ps_8h.html#a72">00880</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d1/d9/ps_8h.html#a72">PsImageNotifyEnabled</a>;
00881 
00882 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00883 <a class="code" href="../../d2/d8/ps_2create_8c.html#a28">PsCallImageNotifyRoutines</a>(
00884     IN PUNICODE_STRING FullImageName,
00885     IN HANDLE ProcessId,                <span class="comment">// pid into which image is being mapped</span>
00886     IN PIMAGE_INFO ImageInfo
00887     );
00888 
00889 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00890 <a class="code" href="../../d6/d5/ps_2security_8c.html#a6">PsImpersonateClient</a>(
00891     IN PETHREAD Thread,
00892     IN PACCESS_TOKEN Token,
00893     IN BOOLEAN CopyOnOpen,
00894     IN BOOLEAN EffectiveOnly,
00895     IN SECURITY_IMPERSONATION_LEVEL ImpersonationLevel
00896     );
00897 
00898 <span class="comment">// begin_ntsrv</span>
00899 
00900 BOOLEAN
00901 <a class="code" href="../../d6/d5/ps_2security_8c.html#a7">PsDisableImpersonation</a>(
00902     IN PETHREAD Thread,
00903     IN PSE_IMPERSONATION_STATE ImpersonationState
00904     );
00905 
00906 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00907 <a class="code" href="../../d6/d5/ps_2security_8c.html#a8">PsRestoreImpersonation</a>(
00908     IN PETHREAD Thread,
00909     IN PSE_IMPERSONATION_STATE ImpersonationState
00910     );
00911 
00912 <span class="comment">// end_ntsrv</span>
00913 
00914 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00915 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00916 <a class="code" href="../../d6/d5/ps_2security_8c.html#a9">PsRevertToSelf</a>(
00917     VOID
00918     );
00919 
00920 
00921 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00922 <a class="code" href="../../d6/d5/ps_2security_8c.html#a3">PsOpenTokenOfThread</a>(
00923     IN HANDLE ThreadHandle,
00924     IN BOOLEAN OpenAsSelf,
00925     OUT PACCESS_TOKEN *Token,
00926     OUT PBOOLEAN CopyOnOpen,
00927     OUT PBOOLEAN EffectiveOnly,
00928     OUT PSECURITY_IMPERSONATION_LEVEL ImpersonationLevel
00929     );
00930 
00931 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00932 <a class="code" href="../../d6/d5/ps_2security_8c.html#a4">PsOpenTokenOfProcess</a>(
00933     IN HANDLE ProcessHandle,
00934     OUT PACCESS_TOKEN *Token
00935     );
00936 
00937 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00938 <a class="code" href="../../d1/d9/ps_8h.html#a137">PsOpenTokenOfJob</a>(
00939     IN HANDLE JobHandle,
00940     OUT PACCESS_TOKEN * Token
00941     );
00942 
00943 <span class="comment">//</span>
00944 <span class="comment">// Cid</span>
00945 <span class="comment">//</span>
00946 
00947 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00948 <a class="code" href="../../d1/d0/pscid_8c.html#a0">PsLookupProcessThreadByCid</a>(
00949     IN PCLIENT_ID Cid,
00950     OUT PEPROCESS *Process OPTIONAL,
00951     OUT PETHREAD *Thread
00952     );
00953 
00954 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00955 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00956 <a class="code" href="../../d1/d0/pscid_8c.html#a1">PsLookupProcessByProcessId</a>(
00957     IN HANDLE ProcessId,
00958     OUT PEPROCESS *Process
00959     );
00960 
00961 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00962 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00963 <a class="code" href="../../d1/d0/pscid_8c.html#a2">PsLookupThreadByThreadId</a>(
00964     IN HANDLE ThreadId,
00965     OUT PETHREAD *Thread
00966     );
00967 
00968 <span class="comment">// begin_ntifs</span>
00969 <span class="comment">//</span>
00970 <span class="comment">// Quota Operations</span>
00971 <span class="comment">//</span>
00972 
00973 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00974 <a class="code" href="../../d0/d2/psquota_8c.html#a2">PsChargePoolQuota</a>(
00975     IN PEPROCESS Process,
00976     IN POOL_TYPE PoolType,
00977     IN ULONG_PTR Amount
00978     );
00979 
00980 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00981 <a class="code" href="../../d0/d2/psquota_8c.html#a3">PsReturnPoolQuota</a>(
00982     IN PEPROCESS Process,
00983     IN POOL_TYPE PoolType,
00984     IN ULONG_PTR Amount
00985     );
00986 <span class="comment">// end_ntifs</span>
00987 
00988 <span class="comment">//</span>
00989 <span class="comment">// Context Management</span>
00990 <span class="comment">//</span>
00991 
00992 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00993 <a class="code" href="../../d1/d9/ps_8h.html#a143">PspContextToKframes</a>(
00994     OUT PKTRAP_FRAME TrapFrame,
00995     OUT PKEXCEPTION_FRAME ExceptionFrame,
00996     IN PCONTEXT Context
00997     );
00998 
00999 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01000 <a class="code" href="../../d1/d9/ps_8h.html#a144">PspContextFromKframes</a>(
01001     OUT PKTRAP_FRAME TrapFrame,
01002     OUT PKEXCEPTION_FRAME ExceptionFrame,
01003     IN PCONTEXT Context
01004     );
01005 
01006 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01007 <a class="code" href="../../d0/d2/psquota_8c.html#a1">PsReturnSharedPoolQuota</a>(
01008     IN PEPROCESS_QUOTA_BLOCK QuotaBlock,
01009     IN ULONG_PTR PagedAmount,
01010     IN ULONG_PTR NonPagedAmount
01011     );
01012 
01013 <a class="code" href="../../d1/d9/ps_8h.html#a34">PEPROCESS_QUOTA_BLOCK</a>
01014 <a class="code" href="../../d0/d2/psquota_8c.html#a0">PsChargeSharedPoolQuota</a>(
01015     IN PEPROCESS Process,
01016     IN ULONG_PTR PagedAmount,
01017     IN ULONG_PTR NonPagedAmount
01018     );
01019 
01020 
<a name="l01021"></a><a class="code" href="../../d1/d9/ps_8h.html#a155">01021</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d9/ps_8h.html#a155">_PSLOCKPROCESSMODE</a> {
01022     <a class="code" href="../../d1/d9/ps_8h.html#a155a89">PsLockPollOnTimeout</a>,
01023     <a class="code" href="../../d1/d9/ps_8h.html#a155a90">PsLockReturnTimeout</a>,
01024     <a class="code" href="../../d1/d9/ps_8h.html#a155a91">PsLockWaitForever</a>,
01025     <a class="code" href="../../d1/d9/ps_8h.html#a155a92">PsLockIAmExiting</a>
01026 } <a class="code" href="../../d1/d9/ps_8h.html#a73">PSLOCKPROCESSMODE</a>;
01027 
01028 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01029 <a class="code" href="../../d2/d8/ps_2create_8c.html#a22">PsLockProcess</a>(
01030     IN PEPROCESS Process,
01031     IN KPROCESSOR_MODE WaitMode,
01032     IN PSLOCKPROCESSMODE LockMode
01033     );
01034 
01035 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01036 <a class="code" href="../../d2/d8/ps_2create_8c.html#a23">PsUnlockProcess</a>(
01037     IN PEPROCESS Process
01038     );
01039 
01040 
01041 <span class="comment">//</span>
01042 <span class="comment">// Exception Handling</span>
01043 <span class="comment">//</span>
01044 
01045 BOOLEAN
01046 <a class="code" href="../../d1/d9/ps_8h.html#a149">PsForwardException</a> (
01047     IN PEXCEPTION_RECORD ExceptionRecord,
01048     IN BOOLEAN DebugException,
01049     IN BOOLEAN SecondChance
01050     );
01051 
01052 <span class="keyword">typedef</span>
01053 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01054"></a><a class="code" href="../../d1/d9/ps_8h.html#a74">01054</a> (*PKWIN32_PROCESS_CALLOUT) (
01055     IN <a class="code" href="../../d1/d9/ps_8h.html#a38">PEPROCESS</a> Process,
01056     IN BOOLEAN Initialize
01057     );
01058 
01059 
<a name="l01060"></a><a class="code" href="../../d1/d9/ps_8h.html#a156">01060</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d9/ps_8h.html#a156">_PSW32JOBCALLOUTTYPE</a> {
01061     <a class="code" href="../../d1/d9/ps_8h.html#a156a93">PsW32JobCalloutSetInformation</a>,
01062     <a class="code" href="../../d1/d9/ps_8h.html#a156a94">PsW32JobCalloutAddProcess</a>,
01063     <a class="code" href="../../d1/d9/ps_8h.html#a156a95">PsW32JobCalloutTerminate</a>
01064 } <a class="code" href="../../d1/d9/ps_8h.html#a75">PSW32JOBCALLOUTTYPE</a>;
01065 
<a name="l01066"></a><a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html">01066</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html">_WIN32_JOBCALLOUT_PARAMETERS</a> {
<a name="l01067"></a><a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o0">01067</a>     PVOID <a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o0">Job</a>;
<a name="l01068"></a><a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o1">01068</a>     <a class="code" href="../../d1/d9/ps_8h.html#a75">PSW32JOBCALLOUTTYPE</a> <a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o1">CalloutType</a>;
<a name="l01069"></a><a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o2">01069</a>     IN PVOID <a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o2">Data</a>;
01070 } <a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html">WIN32_JOBCALLOUT_PARAMETERS</a>, *<a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html">PKWIN32_JOBCALLOUT_PARAMETERS</a>;
01071 
01072 
01073 <span class="keyword">typedef</span>
01074 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01075"></a><a class="code" href="../../d1/d9/ps_8h.html#a78">01075</a> (*PKWIN32_JOB_CALLOUT) (
01076     IN <a class="code" href="../../d1/d9/ps_8h.html#a77">PKWIN32_JOBCALLOUT_PARAMETERS</a> Parm
01077      );
01078 
01079 
<a name="l01080"></a><a class="code" href="../../d1/d9/ps_8h.html#a157">01080</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d9/ps_8h.html#a157">_PSW32THREADCALLOUTTYPE</a> {
01081     <a class="code" href="../../d1/d9/ps_8h.html#a157a96">PsW32ThreadCalloutInitialize</a>,
01082     <a class="code" href="../../d1/d9/ps_8h.html#a157a97">PsW32ThreadCalloutExit</a>
01083 } <a class="code" href="../../d1/d9/ps_8h.html#a79">PSW32THREADCALLOUTTYPE</a>;
01084 
01085 <span class="keyword">typedef</span>
01086 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01087"></a><a class="code" href="../../d1/d9/ps_8h.html#a80">01087</a> (*PKWIN32_THREAD_CALLOUT) (
01088     IN <a class="code" href="../../d1/d9/ps_8h.html#a40">PETHREAD</a> Thread,
01089     IN <a class="code" href="../../d1/d9/ps_8h.html#a79">PSW32THREADCALLOUTTYPE</a> CalloutType
01090     );
01091 
<a name="l01092"></a><a class="code" href="../../d1/d9/ps_8h.html#a158">01092</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d9/ps_8h.html#a158">_PSPOWEREVENTTYPE</a> {
01093     <a class="code" href="../../d1/d9/ps_8h.html#a158a98">PsW32FullWake</a>,
01094     <a class="code" href="../../d1/d9/ps_8h.html#a158a99">PsW32EventCode</a>,
01095     <a class="code" href="../../d1/d9/ps_8h.html#a158a100">PsW32PowerPolicyChanged</a>,
01096     <a class="code" href="../../d1/d9/ps_8h.html#a158a101">PsW32SystemPowerState</a>,
01097     <a class="code" href="../../d1/d9/ps_8h.html#a158a102">PsW32SystemTime</a>,
01098     <a class="code" href="../../d1/d9/ps_8h.html#a158a103">PsW32DisplayState</a>,
01099     <a class="code" href="../../d1/d9/ps_8h.html#a158a104">PsW32CapabilitiesChanged</a>,
01100     <a class="code" href="../../d1/d9/ps_8h.html#a158a105">PsW32SetStateFailed</a>,
01101     <a class="code" href="../../d1/d9/ps_8h.html#a158a106">PsW32GdiOff</a>,
01102     <a class="code" href="../../d1/d9/ps_8h.html#a158a107">PsW32GdiOn</a>
01103 } <a class="code" href="../../d1/d9/ps_8h.html#a81">PSPOWEREVENTTYPE</a>;
01104 
<a name="l01105"></a><a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html">01105</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html">_WIN32_POWEREVENT_PARAMETERS</a> {
<a name="l01106"></a><a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html#o0">01106</a>     <a class="code" href="../../d1/d9/ps_8h.html#a81">PSPOWEREVENTTYPE</a> <a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html#o0">EventNumber</a>;
<a name="l01107"></a><a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html#o1">01107</a>     ULONG_PTR <a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html#o1">Code</a>;
01108 } <a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html">WIN32_POWEREVENT_PARAMETERS</a>, *<a class="code" href="../../d5/d8/struct__WIN32__POWEREVENT__PARAMETERS.html">PKWIN32_POWEREVENT_PARAMETERS</a>;
01109 
<a name="l01110"></a><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html">01110</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html">_WIN32_POWERSTATE_PARAMETERS</a> {
<a name="l01111"></a><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o0">01111</a>     BOOLEAN <a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o0">Promotion</a>;
<a name="l01112"></a><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o1">01112</a>     POWER_ACTION <a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o1">SystemAction</a>;
<a name="l01113"></a><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o2">01113</a>     SYSTEM_POWER_STATE <a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o2">MinSystemState</a>;
<a name="l01114"></a><a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o3">01114</a>     ULONG <a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html#o3">Flags</a>;
01115 } <a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html">WIN32_POWERSTATE_PARAMETERS</a>, *<a class="code" href="../../d6/d8/struct__WIN32__POWERSTATE__PARAMETERS.html">PKWIN32_POWERSTATE_PARAMETERS</a>;
01116 
01117 <span class="keyword">typedef</span>
01118 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01119"></a><a class="code" href="../../d1/d9/ps_8h.html#a86">01119</a> (*PKWIN32_POWEREVENT_CALLOUT) (
01120     IN <a class="code" href="../../d1/d9/ps_8h.html#a83">PKWIN32_POWEREVENT_PARAMETERS</a> Parm
01121     );
01122 
01123 <span class="keyword">typedef</span>
01124 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l01125"></a><a class="code" href="../../d1/d9/ps_8h.html#a87">01125</a> (*PKWIN32_POWERSTATE_CALLOUT) (
01126     IN <a class="code" href="../../d1/d9/ps_8h.html#a85">PKWIN32_POWERSTATE_PARAMETERS</a> Parm
01127     );
01128 
01129 
01130 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01131 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01132 <a class="code" href="../../d9/d1/psquery_8c.html#a23">PsEstablishWin32Callouts</a>(
01133     IN <a class="code" href="../../d1/d9/ps_8h.html#a74">PKWIN32_PROCESS_CALLOUT</a> ProcessCallout,
01134     IN <a class="code" href="../../d1/d9/ps_8h.html#a80">PKWIN32_THREAD_CALLOUT</a> ThreadCallout,
01135     IN <a class="code" href="../../d5/d8/ex_8h.html#a170">PKWIN32_GLOBALATOMTABLE_CALLOUT</a> GlobalAtomTableCallout,
01136     IN <a class="code" href="../../d1/d9/ps_8h.html#a86">PKWIN32_POWEREVENT_CALLOUT</a> PowerEventCallout,
01137     IN <a class="code" href="../../d1/d9/ps_8h.html#a87">PKWIN32_POWERSTATE_CALLOUT</a> PowerStateCallout,
01138     IN <a class="code" href="../../d1/d9/ps_8h.html#a78">PKWIN32_JOB_CALLOUT</a> JobCallout,
01139     IN PVOID BatchFlushRoutine
01140     );
01141 
<a name="l01142"></a><a class="code" href="../../d1/d9/ps_8h.html#a159">01142</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d1/d9/ps_8h.html#a159">_PSPROCESSPRIORITYMODE</a> {
01143     <a class="code" href="../../d1/d9/ps_8h.html#a159a108">PsProcessPriorityBackground</a>,
01144     <a class="code" href="../../d1/d9/ps_8h.html#a159a109">PsProcessPriorityForeground</a>,
01145     <a class="code" href="../../d1/d9/ps_8h.html#a159a110">PsProcessPrioritySpinning</a>
01146 } <a class="code" href="../../d1/d9/ps_8h.html#a88">PSPROCESSPRIORITYMODE</a>;
01147 
01148 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01149 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01150 <a class="code" href="../../d9/d1/psquery_8c.html#a24">PsSetProcessPriorityByClass</a>(
01151     IN PEPROCESS Process,
01152     IN PSPROCESSPRIORITYMODE PriorityMode
01153     );
01154 
01155 <span class="preprocessor">#if DEVL</span>
01156 <span class="preprocessor"></span><a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01157 <a class="code" href="../../d9/d1/psquery_8c.html#a22">PsWatchWorkingSet</a>(
01158     IN NTSTATUS Status,
01159     IN PVOID PcValue,
01160     IN PVOID Va
01161     );
01162 
01163 <span class="preprocessor">#endif // DEVL</span>
01164 <span class="preprocessor"></span>
01165 <span class="comment">// begin_ntddk begin_nthal begin_ntifs</span>
01166 
01167 HANDLE
01168 <a class="code" href="../../d2/d8/ps_2create_8c.html#a24">PsGetCurrentProcessId</a>( VOID );
01169 
01170 HANDLE
01171 <a class="code" href="../../d2/d8/ps_2create_8c.html#a25">PsGetCurrentThreadId</a>( VOID );
01172 
01173 BOOLEAN
01174 <a class="code" href="../../d2/d8/ps_2create_8c.html#a26">PsGetVersion</a>(
01175     PULONG MajorVersion OPTIONAL,
01176     PULONG MinorVersion OPTIONAL,
01177     PULONG BuildNumber OPTIONAL,
01178     PUNICODE_STRING CSDVersion OPTIONAL
01179     );
01180 
01181 <span class="comment">// end_ntddk end_nthal end_ntifs</span>
01182 
01183 <span class="preprocessor">#endif // _PS_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:30 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
