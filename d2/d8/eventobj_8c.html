<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: eventobj.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>eventobj.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>

<p>
<a href="../../d3/d7/eventobj_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(E)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a1">ASSERT_EVENT_PAIR</a>(E)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a2">KeInitializeEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN EVENT_TYPE Type, IN BOOLEAN State)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a3">KeInitializeEventPair</a> (IN <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PKEVENT_PAIR</a> EventPair)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a4">KeClearEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a5">KePulseEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN KPRIORITY Increment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a6">KeReadStateEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a7">KeResetEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a8">KeSetEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN KPRIORITY Increment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/eventobj_8c.html#a9">KeSetEventBoostPriority</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *Thread OPTIONAL)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="eventobj.c::ASSERT_EVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ASSERT_EVENT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">E&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                             \
    <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((E)-&gt;<a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>.Type == NotificationEvent ||   \
           (E)-&gt;Header.Type == SynchronizationEvent); \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">34</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00134">KeClearEvent()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00167">KePulseEvent()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00253">KeReadStateEvent()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00285">KeResetEvent()</a>, and <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="eventobj.c::ASSERT_EVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ASSERT_EVENT_PAIR          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">E&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                        \
    <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((E)-&gt;Type == EventPairObject);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00045">45</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="eventobj.c::KeClearEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeClearEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Event</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00134">134</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, and <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>.
<p>
<pre class="fragment"><div>00140                    :
00141 
00142     This function clears <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object.
00143 
00144 Arguments:
00145 
00146     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00147 
00148 Return Value:
00149 
00150     None.
00151 
00152 --*/
00153 
00154 {
00155 
00156     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00157 
00158     <span class="comment">//</span>
00159     <span class="comment">// Clear signal state of event object.</span>
00160     <span class="comment">//</span>
00161 
00162     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 0;
00163     <span class="keywordflow">return</span>;
00164 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="eventobj.c::KeInitializeEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN EVENT_TYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>State</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00053">53</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a76">PRKEVENT</a>.
<p>
<pre class="fragment"><div>00061                    :
00062 
00063     This function initializes a kernel event object. The initial signal
00064     state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified value.
00065 
00066 Arguments:
00067 
00068     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00069 
00070     Type - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of event; NotificationEvent or
00071         SynchronizationEvent.
00072 
00073     State - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00074 
00075 Return Value:
00076 
00077     None.
00078 
00079 --*/
00080 
00081 {
00082 
00083     <span class="comment">//</span>
00084     <span class="comment">// Initialize standard dispatcher object header, set initial signal</span>
00085     <span class="comment">// state of event object, and set the type of event object.</span>
00086     <span class="comment">//</span>
00087 
00088     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Type = (UCHAR)Type;
00089     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>) / <span class="keyword">sizeof</span>(LONG);
00090     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = State;
00091     InitializeListHead(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead);
00092     <span class="keywordflow">return</span>;
00093 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="eventobj.c::KeInitializeEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeEventPair           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PKEVENT_PAIR</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>EventPair</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00096">96</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01066">KeInitializeEvent</a>, <a class="el" href="../../d4/d9/ke_8h.html#a77">KEVENT_PAIR</a>, <a class="el" href="../../d4/d9/ke_8h.html#a78">PKEVENT_PAIR</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>.
<p>
<pre class="fragment"><div>00102                    :
00103 
00104     This function initializes a kernel event pair object. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> kernel event
00105     pair object contains two separate synchronization event objects that
00106     are used to provide a fast interprocess synchronization capability.
00107 
00108 Arguments:
00109 
00110     EventPair - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event pair.
00111 
00112 Return Value:
00113 
00114     None.
00115 
00116 --*/
00117 
00118 {
00119 
00120     <span class="comment">//</span>
00121     <span class="comment">// Initialize the type and size of the event pair object and initialize</span>
00122     <span class="comment">// the two event object as synchronization events with an initial state</span>
00123     <span class="comment">// of FALSE.</span>
00124     <span class="comment">//</span>
00125 
00126     EventPair-&gt;Type = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>;
00127     EventPair-&gt;Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d6/struct__KEVENT__PAIR.html">KEVENT_PAIR</a>);
00128     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(&amp;EventPair-&gt;EventLow, SynchronizationEvent, FALSE);
00129     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(&amp;EventPair-&gt;EventHigh, SynchronizationEvent, FALSE);
00130     <span class="keywordflow">return</span>;
00131 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="eventobj.c::KePulseEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KePulseEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00167">167</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00243">MiUnmapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02234">MiWriteComplete()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06284">MmLockPagableSectionByHandle()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07065">MmUnlockPagableImageSection()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00412">NtPulseEvent()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l03358">xxxSwitchDesktop()</a>.
<p>
<pre class="fragment"><div>00175                    :
00176 
00177     This function atomically sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to
00178     Signaled, attempts to satisfy as many Waits as possible, and then resets
00179     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object to Not-Signaled. The previous signal
00180     state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00181 
00182 Arguments:
00183 
00184     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00185 
00186     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00187        <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event causes a Wait to be satisfied.
00188 
00189     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00190        <a class="code" href="../../d4/d9/ke_8h.html#a279">KePulseEvent</a> will be immediately followed by a call to one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00191        kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00192 
00193 Return Value:
00194 
00195     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00196 
00197 --*/
00198 
00199 {
00200 
00201     KIRQL OldIrql;
00202     LONG OldState;
00203     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00204 
00205     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00206     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00207 
00208     <span class="comment">//</span>
00209     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00210     <span class="comment">//</span>
00211 
00212     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00213 
00214     <span class="comment">//</span>
00215     <span class="comment">// If the current state of the event object is Not-Signaled and</span>
00216     <span class="comment">// the wait queue is not empty, then set the state of the event</span>
00217     <span class="comment">// to Signaled, satisfy as many Waits as possible, and then reset</span>
00218     <span class="comment">// the state of the event to Not-Signaled.</span>
00219     <span class="comment">//</span>
00220 
00221     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00222     <span class="keywordflow">if</span> ((OldState == 0) &amp;&amp; (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00223         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00224         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Event, Increment);
00225     }
00226 
00227     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 0;
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00231     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00232     <span class="comment">// release the dispatcher database lock and lower IRQL to the</span>
00233     <span class="comment">// previous value.</span>
00234     <span class="comment">//</span>
00235 
00236     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00237         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00238         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00239         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00240 
00241     } <span class="keywordflow">else</span> {
00242        <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00243     }
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">// Return previous signal state of event object.</span>
00247     <span class="comment">//</span>
00248 
00249     <span class="keywordflow">return</span> OldState;
00250 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="eventobj.c::KeReadStateEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeReadStateEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Event</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00253">253</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, and <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/internal_8c-source.html#l00417">IopCancelAlertedRequest()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01506">IopConnectLinkTrackingPort()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, and <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>.
<p>
<pre class="fragment"><div>00259                    :
00260 
00261     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of an event object.
00262 
00263 Arguments:
00264 
00265     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00266 
00267 Return Value:
00268 
00269     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00270 
00271 --*/
00272 
00273 {
00274 
00275     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00276 
00277     <span class="comment">//</span>
00278     <span class="comment">// Return current signal state of event object.</span>
00279     <span class="comment">//</span>
00280 
00281     <span class="keywordflow">return</span> <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00282 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="eventobj.c::KeResetEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeResetEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Event</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00285">285</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00648">NtResetEvent()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02425">SmbTraceToClient()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>.
<p>
<pre class="fragment"><div>00291                    :
00292 
00293     This function resets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to
00294     Not-Signaled. The previous state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00295     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00296 
00297 Arguments:
00298 
00299     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00300 
00301 Return Value:
00302 
00303     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00304 
00305 --*/
00306 
00307 {
00308 
00309     KIRQL OldIrql;
00310     LONG OldState;
00311 
00312     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00313     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00314 
00315     <span class="comment">//</span>
00316     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00317     <span class="comment">//</span>
00318 
00319     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00320 
00321     <span class="comment">//</span>
00322     <span class="comment">// Capture the current signal state of event object and then reset</span>
00323     <span class="comment">// the state of the event object to Not-Signaled.</span>
00324     <span class="comment">//</span>
00325 
00326     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00327     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 0;
00328 
00329     <span class="comment">//</span>
00330     <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00331     <span class="comment">// value.</span>
00332 
00333     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00334 
00335     <span class="comment">//</span>
00336     <span class="comment">// Return previous signal state of event object.</span>
00337     <span class="comment">//</span>
00338 
00339     <span class="keywordflow">return</span> OldState;
00340 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="eventobj.c::KeSetEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeSetEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">343</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01138">KiSetEventCallData</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00054">RECORD_CALL_DATA</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00281">_KWAIT_BLOCK::Thread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/power_8c-source.html#l00058">CancelPowerRequest()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01517">CcDeleteSharedCacheMap()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00862">CcFreeVirtualAddress()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00401">CcGetVacbMiss()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l02099">CcPostDeferredWrites()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01164">CcUninitializeCacheMap()</a>, <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00738">CcWorkerThread()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01028">CmNotifyRunDown()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00804">CmpPostApc()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00922">CmpPostApcRunDown()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02478">DestroyDesktop()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00129">DestroyTask()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00248">DeviceCDROMNotify()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00563">ExNotifyCallback()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">ExQueueWorkItem()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00313">FreeDeviceInfo()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00745">FreeWindowStation()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00579">FsRecLoadFileSystem()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03241">FsRtlCompletionRoutinePriv()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00114">IoAcquireRemoveLockEx()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00181">IopAcquireFileObjectLock()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01019">IopCompleteRequest()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01506">IopConnectLinkTrackingPort()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01250">IopInvalidateRelationsInList()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04169">IopLoadUnloadDriver()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00725">IopLockDeviceRemovalRelations()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01080">IopLockMountedDeviceForRemove()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00821">IopProcessStartDevices()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00912">IopProcessStartDevicesWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l04667">IopQueryRebalanceWorker()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l07272">IopTrackLink()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01233">IopUnlockMountedDeviceForRemove()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00422">IopWarmEjectDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00244">IoReleaseRemoveLockEx()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11389">IoVerifyVolume()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01126">KiSetServerWaitClientEvent()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00551">LfsFlushLfcb()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00642">LpcpFreeToPortZone()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01181">LpcRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00250">MemPrint()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00492">MemPrintFlush()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00807">MiAllocatePoolPages()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00996">MiCheckAndSetSystemTrimCriteria()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01823">MiCheckControlArea()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01338">MiCrashDumpWorker()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00068">MiDispatchFault()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02715">MiEmptyAllWorkingSets()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02788">MiEmptyAllWorkingSetsWorker()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04870">MiFlushAllPages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03198">MiGatherMappedPages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03701">MiGatherPagefilePages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04607">MiInsertPageFileInList()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00059">MiInsertPageInList()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00388">MiInsertStandbyListAtFront()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02782">MiModifiedPageWriterTimerDispatch()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00336">MiObtainFreePages()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00191">MiSegmentDelete()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l01098">MiUpdateModifiedWriterMdls()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02234">MiWriteComplete()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01274">MmCopyToCachedPage()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00362">MmCopyVirtualMemory()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00589">MmResourcesAvailable()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00035">NtLockFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01191">ProcessDeviceChanges()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d8/d9/psctxppc_8c-source.html#l00386">PspGetSetContextApc()</a>, <a class="el" href="../../d4/d9/psctx386_8c-source.html#l00131">PspGetSetContextSpecialApc()</a>, <a class="el" href="../../d5/d9/psctxalp_8c-source.html#l00349">PspGetSetContextSpecialApcMain()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l02250">PsUnlockProcess()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00925">QueueMouseEvent()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00076">QueuePowerRequest()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01535">RequestDeviceChange()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00091">RtlAcquireRemoveLockEx()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00204">RtlReleaseRemoveLock()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04578">SetWakeBit()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01949">SmbTraceEmptyQueue()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01779">UdfMultiSyncCompletionRoutine()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00710">UdfPnpCompletionRoutine()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01980">UdfSingleSyncCompletionRoutine()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00608">UserPowerStateCallout()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00408">VdmpQueueIntNormalRoutine()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02160">VerifierSetEvent()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00030">WakeWowTask()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00472">xxxButtonEvent()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01797">xxxCreateDesktop()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00114">xxxDesktopThread()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05238">xxxGetInputEvent()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00252">xxxSleepTask()</a>, and <a class="el" href="../../d8/d1/power_8c-source.html#l00684">xxxUserPowerCalloutWorker()</a>.
<p>
<pre class="fragment"><div>00351                    :
00352 
00353     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to Signaled
00354     and attempts to satisfy as many Waits as possible. The previous
00355     signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00356 
00357 Arguments:
00358 
00359     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00360 
00361     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00362        <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event causes a Wait to be satisfied.
00363 
00364     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00365        <a class="code" href="../../d4/d9/ke_8h.html#a279">KePulseEvent</a> will be immediately followed by a call to one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00366        kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00367 
00368 Return Value:
00369 
00370     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00371 
00372 --*/
00373 
00374 {
00375 
00376     KIRQL OldIrql;
00377     LONG OldState;
00378     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00379     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PRKWAIT_BLOCK</a> WaitBlock;
00380 
00381     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00382     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00383 
00384     <span class="comment">//</span>
00385     <span class="comment">// Collect call data.</span>
00386     <span class="comment">//</span>
00387 
00388 <span class="preprocessor">#if defined(_COLLECT_SET_EVENT_CALLDATA_)</span>
00389 <span class="preprocessor"></span>
00390     <a class="code" href="../../d5/d8/ex_8h.html#a1">RECORD_CALL_DATA</a>(&amp;KiSetEventCallData);
00391 
00392 <span class="preprocessor">#endif</span>
00393 <span class="preprocessor"></span>
00394     <span class="comment">//</span>
00395     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00396     <span class="comment">//</span>
00397 
00398     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00399 
00400     <span class="comment">//</span>
00401     <span class="comment">// If the wait list is empty, then set the state of the event to signaled.</span>
00402     <span class="comment">// Otherwise, check if the wait can be satisfied immediately.</span>
00403     <span class="comment">//</span>
00404 
00405     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00406     <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00407         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00408 
00409     } <span class="keywordflow">else</span> {
00410 
00411         <span class="comment">//</span>
00412         <span class="comment">// If the event is a notification event or the wait is not a wait any,</span>
00413         <span class="comment">// then set the state of the event to signaled and attempt to satisfy</span>
00414         <span class="comment">// as many waits as possible. Otherwise, the wait can be satisfied by</span>
00415         <span class="comment">// directly unwaiting the thread.</span>
00416         <span class="comment">//</span>
00417 
00418         WaitBlock = CONTAINING_RECORD(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead.Flink,
00419                                       <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a>,
00420                                       WaitListEntry);
00421 
00422         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Type == NotificationEvent) ||
00423             (WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> != WaitAny)) {
00424             <span class="keywordflow">if</span> (OldState == 0) {
00425                 <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00426                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Event, Increment);
00427             }
00428 
00429         } <span class="keywordflow">else</span> {
00430             <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o1">Thread</a>, (NTSTATUS)WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a>, Increment);
00431         }
00432     }
00433 
00434     <span class="comment">//</span>
00435     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00436     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00437     <span class="comment">// release the dispatcher database lock and lower IRQL to its</span>
00438     <span class="comment">// previous value.</span>
00439     <span class="comment">//</span>
00440 
00441     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00442        Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00443        Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00444        Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00445 
00446     } <span class="keywordflow">else</span> {
00447        <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00448     }
00449 
00450     <span class="comment">//</span>
00451     <span class="comment">// Return previous signal state of event object.</span>
00452     <span class="comment">//</span>
00453 
00454     <span class="keywordflow">return</span> OldState;
00455 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="eventobj.c::KeSetEventBoostPriority" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetEventBoostPriority           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *Thread&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00458">458</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00034">EVENT_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d9/d9/cmdat3_8c-source.html#l00108">MmProductType</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00593">_KTHREAD::Quantum</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01607">ExReleaseResourceForThreadLite()</a>, and <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>.
<p>
<pre class="fragment"><div>00465                    :
00466 
00467     This function conditionally sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object
00468     to Signaled, and attempts to unwait <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first waiter, and optionally
00469     returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unwatied thread.
00470 
00471     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called with synchronization events
00472          and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> primarily <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> purpose of implementing fast mutexes.
00473          It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> waiter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> NEVER waiting on multiple
00474          objects.
00475 
00476 Arguments:
00477 
00478     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00479 
00480     Thread - Supplies an optional pointer to a variable that receives
00481         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> awakened.
00482 
00483 Return Value:
00484 
00485     None.
00486 
00487 --*/
00488 
00489 {
00490 
00491     KPRIORITY <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00492     KIRQL OldIrql;
00493     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> WaitThread;
00494 
00495     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Type == SynchronizationEvent);
00496     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00497 
00498     <span class="comment">//</span>
00499     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00500     <span class="comment">//</span>
00501 
00502     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00503 
00504     <span class="comment">//</span>
00505     <span class="comment">// If the the wait list is not empty, then satisfy the wait of the</span>
00506     <span class="comment">// first thread in the wait list. Otherwise, set the signal state</span>
00507     <span class="comment">// of the event object.</span>
00508     <span class="comment">//</span>
00509     <span class="comment">// N.B. This function is only called for fast mutexes and exclusive</span>
00510     <span class="comment">//      access to resources. All waits MUST be wait for single object.</span>
00511     <span class="comment">//</span>
00512 
00513     <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00514         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00515 
00516     } <span class="keywordflow">else</span> {
00517 
00518         <span class="comment">//</span>
00519         <span class="comment">// Get the address of the waiting thread.</span>
00520         <span class="comment">//</span>
00521 
00522         WaitThread = CONTAINING_RECORD(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead.Flink,
00523                                        <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a>,
00524                                        WaitListEntry)-&gt;Thread;
00525 
00526         <span class="comment">//</span>
00527         <span class="comment">// If specified, return the address of the thread that is awakened.</span>
00528         <span class="comment">//</span>
00529 
00530         <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Thread)) {
00531             *Thread = WaitThread;
00532         }
00533 
00534         <span class="comment">//</span>
00535         <span class="comment">// Give the new owner of the resource/fast mutex (the only callers) a</span>
00536         <span class="comment">// full quantum, and unwait the thread with a standard event increment</span>
00537         <span class="comment">// unless the system is a server system, in which case no boost if given.</span>
00538         <span class="comment">//</span>
00539 
00540         WaitThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = WaitThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a>;
00541         <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = 0;
00542         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/cmdat3_8c.html#a52">MmProductType</a> == 0) {
00543             <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = <a class="code" href="../../d7/d8/exboosts_8h.html#a0">EVENT_INCREMENT</a>;
00544         }
00545 
00546         <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(WaitThread, STATUS_SUCCESS, Increment);
00547     }
00548 
00549     <span class="comment">//</span>
00550     <span class="comment">// Unlock dispatcher database lock and lower IRQL to its previous</span>
00551     <span class="comment">// value.</span>
00552     <span class="comment">//</span>
00553 
00554     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00555     <span class="keywordflow">return</span>;
00556 }
}
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:33 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
