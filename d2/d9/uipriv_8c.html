<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: uipriv.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>uipriv.c File Reference</h1><code>#include &lt;nt.h&gt;</code><br>
<code>#include &lt;ntrtl.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>

<p>
<a href="../../d3/d8/uipriv_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a0">SHIFT</a>(<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>, v)&nbsp;&nbsp;&nbsp;{<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>--; v++;}</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a5">Usage</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a6">OpenAppropriateToken</a> (OUT PHANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a28">Token</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a7">EnableAllPrivileges</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a8">ResetAllPrivileges</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a9">DisableAllPrivileges</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a10">PrivMain</a> (IN int <a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>, IN PCHAR v[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a1">SwitchEnable</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a2">SwitchDisable</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a3">SwitchReset</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d9/uipriv_8c.html#a4">SwitchAll</a> = FALSE</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="uipriv.c::SHIFT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SHIFT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>v&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;{<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>--; v++;}</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00053">53</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00041">GetMouseKeyState()</a>, <a class="el" href="../../d7/d7/sftkbdt1_8c-source.html#l00096">InitSKT1ButtonPos()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>, and <a class="el" href="../../d6/d7/sftkbdc1_8c-source.html#l00679">SKC1MousePosition()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a9" doxytag="uipriv.c::DisableAllPrivileges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisableAllPrivileges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00432">432</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00036">NT_INFORMATION</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00148">OpenAppropriateToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00123">Token</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>, and <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00819">SepAdjustPrivileges()</a>.
<p>
<pre class="fragment"><div>00438                    :
00439 
00440     This routine disables all privileges in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token.
00441 
00442 Arguments:
00443 
00444     None.
00445 
00446 Return Value:
00447 
00448     None.
00449 
00450 --*/
00451 {
00452     ULONG IgnoredReturnLength;
00453     HANDLE <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
00454     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00455 
00456     <span class="keywordflow">if</span> ( !<a class="code" href="../../d2/d9/uipriv_8c.html#a6">OpenAppropriateToken</a>(&amp;Token) ) {
00457         printf( <span class="stringliteral">"\n"</span>);
00458         printf( <span class="stringliteral">"\n"</span>);
00459         printf( <span class="stringliteral">"You are not allowed to change your own privilege settings.\n"</span>);
00460         printf( <span class="stringliteral">"Operation failed.\n"</span>);
00461         <span class="keywordflow">return</span>;
00462     }
00463 
00464     <span class="comment">//</span>
00465     <span class="comment">// Disable all the privileges.</span>
00466     <span class="comment">//</span>
00467 
00468 
00469     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d3/tokenadj_8c.html#a0">NtAdjustPrivilegesToken</a>(
00470                  Token,                            <span class="comment">// TokenHandle</span>
00471                  TRUE,                             <span class="comment">// DisableAllPrivileges</span>
00472                  NULL,                             <span class="comment">// NewState (OPTIONAL)</span>
00473                  0,                                <span class="comment">// BufferLength</span>
00474                  NULL,                             <span class="comment">// PreviousState (OPTIONAL)</span>
00475                  &amp;IgnoredReturnLength              <span class="comment">// ReturnLength</span>
00476                  );
00477     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || <a class="code" href="../../d5/d6/stierr_8h.html#a1">NT_INFORMATION</a>(Status) );
00478 
00479     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( Token );
00480     <span class="keywordflow">return</span>;
00481 
00482 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="uipriv.c::EnableAllPrivileges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID EnableAllPrivileges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00225">225</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00036">NT_INFORMATION</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00148">OpenAppropriateToken()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00022">RtlAllocateHeap</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00023">RtlFreeHeap</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00123">Token</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.
<p>
<pre class="fragment"><div>00231                    :
00232 
00233     This routine enables all privileges in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token.
00234 
00235 Arguments:
00236 
00237     None.
00238 
00239 Return Value:
00240 
00241     None.
00242 
00243 --*/
00244 {
00245     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00246     HANDLE <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
00247     ULONG ReturnLength, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00248     PTOKEN_PRIVILEGES  NewState;
00249 
00250 
00251     <span class="keywordflow">if</span> ( !<a class="code" href="../../d2/d9/uipriv_8c.html#a6">OpenAppropriateToken</a>(&amp;Token) ) {
00252         <span class="keywordflow">return</span>;
00253     }
00254 
00255     <span class="comment">//</span>
00256     <span class="comment">// Get the size needed to query current privilege settings...</span>
00257     <span class="comment">//</span>
00258 
00259     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00260                  Token,                      <span class="comment">// TokenHandle</span>
00261                  TokenPrivileges,            <span class="comment">// TokenInformationClass</span>
00262                  NewState,                   <span class="comment">// TokenInformation</span>
00263                  0,                          <span class="comment">// TokenInformationLength</span>
00264                  &amp;ReturnLength               <span class="comment">// ReturnLength</span>
00265                  );
00266     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( Status == STATUS_BUFFER_TOO_SMALL );
00267 
00268     NewState = <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a0">RtlAllocateHeap</a>( RtlProcessHeap(), 0, ReturnLength );
00269     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( NewState != NULL );
00270 
00271 
00272     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00273                  Token,                      <span class="comment">// TokenHandle</span>
00274                  TokenPrivileges,            <span class="comment">// TokenInformationClass</span>
00275                  NewState,                   <span class="comment">// TokenInformation</span>
00276                  ReturnLength,               <span class="comment">// TokenInformationLength</span>
00277                  &amp;ReturnLength               <span class="comment">// ReturnLength</span>
00278                  );
00279     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || <a class="code" href="../../d5/d6/stierr_8h.html#a1">NT_INFORMATION</a>(Status) );
00280 
00281 
00282     <span class="comment">//</span>
00283     <span class="comment">// Set the state settings so that all privileges are enabled...</span>
00284     <span class="comment">//</span>
00285 
00286     <span class="keywordflow">if</span> (NewState-&gt;PrivilegeCount &gt; 0) {
00287         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = NewState-&gt;PrivilegeCount;
00288 
00289         <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; NewState-&gt;PrivilegeCount) {
00290             NewState-&gt;Privileges[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Attributes = SE_PRIVILEGE_ENABLED;
00291             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1;
00292         }
00293     }
00294 
00295 
00296     <span class="comment">//</span>
00297     <span class="comment">// Change the settings in the token...</span>
00298     <span class="comment">//</span>
00299 
00300     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d3/tokenadj_8c.html#a0">NtAdjustPrivilegesToken</a>(
00301                  Token,                            <span class="comment">// TokenHandle</span>
00302                  FALSE,                            <span class="comment">// DisableAllPrivileges</span>
00303                  NewState,                         <span class="comment">// NewState (OPTIONAL)</span>
00304                  ReturnLength,                     <span class="comment">// BufferLength</span>
00305                  NULL,                             <span class="comment">// PreviousState (OPTIONAL)</span>
00306                  &amp;ReturnLength                     <span class="comment">// ReturnLength</span>
00307                  );
00308     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || <a class="code" href="../../d5/d6/stierr_8h.html#a1">NT_INFORMATION</a>(Status) );
00309 
00310 
00311 
00312     <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a1">RtlFreeHeap</a>( RtlProcessHeap(), 0, NewState );
00313     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( Token );
00314 
00315     <span class="keywordflow">return</span>;
00316 
00317 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="uipriv.c::OpenAppropriateToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN OpenAppropriateToken           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PHANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Token</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00148">148</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00178">NtOpenProcessToken()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00123">Token</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00432">DisableAllPrivileges()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00225">EnableAllPrivileges()</a>, and <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00322">ResetAllPrivileges()</a>.
<p>
<pre class="fragment"><div>00154                    :
00155 
00156     This routine opens <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate <a class="code" href="../../d8/d1/struct__TOKEN.html">TOKEN</a> object.  For an internal
00157     command, <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process's token.  If <span class="keyword">this</span> command <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00158     ever <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> external, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> will be <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parent process's token.
00159 
00160     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token can'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> be openned, then a messages <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> printed indicating
00161     a problem has been encountered.
00162 
00163     The caller <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> expected to close <span class="keyword">this</span> token when no longer needed.
00164 
00165 
00166 Arguments:
00167 
00168     <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a> - Receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> openned token.
00169 
00170 
00171 Return Value:
00172 
00173     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - Indicates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token was successfully openned.
00174 
00175     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - Indicates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token was NOT successfully openned.
00176 
00177 --*/
00178 
00179 {
00180     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>, IgnoreStatus;
00181     OBJECT_ATTRIBUTES ProcessAttributes;
00182     HANDLE Process;
00183     PTEB CurrentTeb;
00184 
00185     CurrentTeb = NtCurrentTeb();
00186     InitializeObjectAttributes(&amp;ProcessAttributes, NULL, 0, NULL, NULL);
00187     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d1/psopen_8c.html#a0">NtOpenProcess</a>(
00188                  &amp;Process,                   <span class="comment">// TargetHandle</span>
00189                  PROCESS_QUERY_INFORMATION,  <span class="comment">// DesiredAccess</span>
00190                  &amp;ProcessAttributes,         <span class="comment">// ObjectAttributes</span>
00191                  &amp;CurrentTeb-&gt;ClientId       <span class="comment">// ClientId</span>
00192                  );
00193 
00194     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00195 
00196         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d3/tokenopn_8c.html#a1">NtOpenProcessToken</a>(
00197                      Process,
00198                      TOKEN_ADJUST_PRIVILEGES |
00199                      TOKEN_QUERY,
00200                      Token
00201                      );
00202 
00203          IgnoreStatus = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( Process );
00204 
00205          <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) ) {
00206 
00207              <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00208 
00209          }
00210 
00211     }
00212 
00213     printf( <span class="stringliteral">"\n"</span>);
00214     printf( <span class="stringliteral">"\n"</span>);
00215     printf( <span class="stringliteral">"You are not allowed to change your own privilege settings.\n"</span>);
00216     printf( <span class="stringliteral">"Operation failed.\n"</span>);
00217 
00218     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00219 
00220 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="uipriv.c::PrivMain" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int PrivMain           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN int&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>v</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">486</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
References <a class="el" href="../../d4/d9/user32_8def-source.html#l00799">c</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00432">DisableAllPrivileges()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00225">EnableAllPrivileges()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00322">ResetAllPrivileges()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00053">SHIFT</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00050">SwitchAll</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00048">SwitchDisable</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00047">SwitchEnable</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00049">SwitchReset</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00066">Usage()</a>.
<p>
<pre class="fragment"><div>00493                    :
00494 
00495     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d9/arcinst_8c.html#a19">main</a> entry routine <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"priv"</span> command.
00496 
00497 Arguments:
00498 
00499     TBS
00500 
00501 Return Value:
00502 
00503     TBS
00504 
00505 --*/
00506 {
00507     PCHAR p;
00508     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> ch;
00509     ULONG DispositionDirectives;
00510 
00511 
00512     <span class="keywordflow">try</span> {
00513         DispositionDirectives = 0;
00514         <a class="code" href="../../d2/d9/uipriv_8c.html#a0">SHIFT</a> (c,v);
00515         <span class="keywordflow">while</span> ((<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt; 0) &amp;&amp; ((ch = *v[0]))) {
00516             p = *v;
00517             <span class="keywordflow">if</span> (ch == <span class="charliteral">'/'</span>) {
00518                 <span class="keywordflow">while</span> (*++p != <span class="charliteral">'\0'</span>) {
00519                     <span class="keywordflow">if</span> (*p == <span class="charliteral">'E'</span>) {
00520                         <a class="code" href="../../d2/d9/uipriv_8c.html#a1">SwitchEnable</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00521                         DispositionDirectives += 1;
00522                     }
00523                     <span class="keywordflow">if</span> (*p == <span class="charliteral">'D'</span>) {
00524                         <a class="code" href="../../d2/d9/uipriv_8c.html#a2">SwitchDisable</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00525                         DispositionDirectives += 1;
00526                     }
00527                     <span class="keywordflow">if</span> (*p == <span class="charliteral">'R'</span>) {
00528                         <a class="code" href="../../d2/d9/uipriv_8c.html#a3">SwitchReset</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00529                         DispositionDirectives += 1;
00530                     }
00531                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">'A'</span>) {
00532                         <a class="code" href="../../d2/d9/uipriv_8c.html#a4">SwitchAll</a>  = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00533                     }
00534                     <span class="keywordflow">else</span> {
00535                         <a class="code" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a>();
00536                     }
00537                 }
00538             <a class="code" href="../../d2/d9/uipriv_8c.html#a0">SHIFT</a>(c,v);
00539             }
00540         }
00541 
00542         <span class="comment">//</span>
00543         <span class="comment">// Make sure we don't have conflicting parameters</span>
00544         <span class="comment">//</span>
00545         <span class="comment">// Rules:</span>
00546         <span class="comment">//</span>
00547         <span class="comment">//      If /A isn't specified, then a privilege name must be.</span>
00548         <span class="comment">//      Exactly one of /E, /D, and /R must be specified.</span>
00549         <span class="comment">//</span>
00550         <span class="comment">//</span>
00551 
00552 
00553         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/uipriv_8c.html#a4">SwitchAll</a> &amp;&amp; (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == 0)) {
00554             printf( <span class="stringliteral">"\n"</span>);
00555             printf( <span class="stringliteral">"\n"</span>);
00556             printf( <span class="stringliteral">"You must provide privilege name or use the /A switch.\n"</span>);
00557             <a class="code" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a>();
00558             <span class="keywordflow">return</span> ( 0 );
00559         }
00560 
00561         <span class="keywordflow">if</span> (DispositionDirectives != 1) {
00562             printf( <span class="stringliteral">"\n"</span>);
00563             printf( <span class="stringliteral">"\n"</span>);
00564             printf( <span class="stringliteral">"You must provide one and only one of the following"</span>);
00565             printf( <span class="stringliteral">"switches: /E, /D, /R\n"</span>);
00566             <a class="code" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a>();
00567             <span class="keywordflow">return</span> ( 0 );
00568 
00569         }
00570 
00571 
00572         <span class="comment">//</span>
00573         <span class="comment">// Everything appears legitimate</span>
00574         <span class="comment">//</span>
00575 
00576         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/uipriv_8c.html#a4">SwitchAll</a>) {
00577 
00578             <span class="comment">//</span>
00579             <span class="comment">// /A switch specified</span>
00580             <span class="comment">//</span>
00581 
00582             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/uipriv_8c.html#a1">SwitchEnable</a>) {
00583                 <a class="code" href="../../d2/d9/uipriv_8c.html#a7">EnableAllPrivileges</a>();
00584             }
00585             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/uipriv_8c.html#a2">SwitchDisable</a>) {
00586                 <a class="code" href="../../d2/d9/uipriv_8c.html#a9">DisableAllPrivileges</a>();
00587             }
00588             <span class="keywordflow">else</span> {
00589                 <a class="code" href="../../d2/d9/uipriv_8c.html#a8">ResetAllPrivileges</a>();
00590             }
00591         }
00592 
00593         <span class="comment">//</span>
00594         <span class="comment">// privilege name specified...</span>
00595         <span class="comment">//</span>
00596 
00597         <span class="keywordflow">else</span> {
00598             printf( <span class="stringliteral">"\n"</span>);
00599             printf( <span class="stringliteral">"I'm sorry, but due to the lack of time and interest,\n"</span>);
00600             printf( <span class="stringliteral">"individual privilege selection is not yet supported.\n"</span>);
00601             printf( <span class="stringliteral">"Please use the /A qualifier for the time being.\n"</span>);
00602             printf( <span class="stringliteral">"\n"</span>);
00603         }
00604 
00605     } finally {
00606         <span class="keywordflow">return</span> ( 0 );
00607     }
00608 
00609     <span class="keywordflow">return</span>( 0 );
00610 
00611 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="uipriv.c::ResetAllPrivileges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ResetAllPrivileges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00322">322</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00036">NT_INFORMATION</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00148">OpenAppropriateToken()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00022">RtlAllocateHeap</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00023">RtlFreeHeap</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00123">Token</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.
<p>
<pre class="fragment"><div>00328                    :
00329 
00330     This routine resets all privileges in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> token to their <span class="keywordflow">default</span> state.
00331 
00332 Arguments:
00333 
00334     None.
00335 
00336 Return Value:
00337 
00338     None.
00339 
00340 --*/
00341 {
00342     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00343     HANDLE <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
00344     ULONG ReturnLength, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00345     PTOKEN_PRIVILEGES  NewState;
00346 
00347 
00348     <span class="keywordflow">if</span> ( !<a class="code" href="../../d2/d9/uipriv_8c.html#a6">OpenAppropriateToken</a>(&amp;Token) ) {
00349         printf( <span class="stringliteral">"\n"</span>);
00350         printf( <span class="stringliteral">"\n"</span>);
00351         printf( <span class="stringliteral">"You are not allowed to change your own privilege settings.\n"</span>);
00352         printf( <span class="stringliteral">"Operation failed.\n"</span>);
00353         <span class="keywordflow">return</span>;
00354     }
00355 
00356     <span class="comment">//</span>
00357     <span class="comment">// Get the size needed to query current privilege settings...</span>
00358     <span class="comment">//</span>
00359 
00360     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00361                  Token,                      <span class="comment">// TokenHandle</span>
00362                  TokenPrivileges,            <span class="comment">// TokenInformationClass</span>
00363                  NewState,                   <span class="comment">// TokenInformation</span>
00364                  0,                          <span class="comment">// TokenInformationLength</span>
00365                  &amp;ReturnLength               <span class="comment">// ReturnLength</span>
00366                  );
00367     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( STATUS_BUFFER_TOO_SMALL );
00368 
00369     NewState = <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a0">RtlAllocateHeap</a>( RtlProcessHeap(), 0, ReturnLength );
00370     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( NewState != NULL );
00371 
00372 
00373     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00374                  Token,                      <span class="comment">// TokenHandle</span>
00375                  TokenPrivileges,            <span class="comment">// TokenInformationClass</span>
00376                  NewState,                   <span class="comment">// TokenInformation</span>
00377                  ReturnLength,               <span class="comment">// TokenInformationLength</span>
00378                  &amp;ReturnLength               <span class="comment">// ReturnLength</span>
00379                  );
00380     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || <a class="code" href="../../d5/d6/stierr_8h.html#a1">NT_INFORMATION</a>(Status) );
00381 
00382 
00383     <span class="comment">//</span>
00384     <span class="comment">// Set the state settings so that all privileges are reset to</span>
00385     <span class="comment">// their default settings...</span>
00386     <span class="comment">//</span>
00387 
00388     <span class="keywordflow">if</span> (NewState-&gt;PrivilegeCount &gt; 0) {
00389         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = NewState-&gt;PrivilegeCount;
00390 
00391         <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; NewState-&gt;PrivilegeCount) {
00392             <span class="keywordflow">if</span> (NewState-&gt;Privileges[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Attributes ==
00393                 SE_PRIVILEGE_ENABLED_BY_DEFAULT) {
00394                 NewState-&gt;Privileges[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Attributes = SE_PRIVILEGE_ENABLED;
00395             }
00396             <span class="keywordflow">else</span> {
00397                 NewState-&gt;Privileges[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Attributes = 0;
00398             }
00399 
00400             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1;
00401         }
00402     }
00403 
00404 
00405     <span class="comment">//</span>
00406     <span class="comment">// Change the settings in the token...</span>
00407     <span class="comment">//</span>
00408 
00409     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d3/tokenadj_8c.html#a0">NtAdjustPrivilegesToken</a>(
00410                  Token,                            <span class="comment">// TokenHandle</span>
00411                  FALSE,                            <span class="comment">// DisableAllPrivileges</span>
00412                  NewState,                         <span class="comment">// NewState (OPTIONAL)</span>
00413                  ReturnLength,                     <span class="comment">// BufferLength</span>
00414                  NULL,                             <span class="comment">// PreviousState (OPTIONAL)</span>
00415                  &amp;ReturnLength                     <span class="comment">// ReturnLength</span>
00416                  );
00417     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || <a class="code" href="../../d5/d6/stierr_8h.html#a1">NT_INFORMATION</a>(Status) );
00418 
00419 
00420 
00421     <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a1">RtlFreeHeap</a>( RtlProcessHeap(), 0, NewState );
00422     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( Token );
00423 
00424     <span class="keywordflow">return</span>;
00425 
00426 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="uipriv.c::Usage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Usage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/uclient_8c-source.html#l00090">90</a> of file <a class="el" href="../../d8/d6/uclient_8c-source.html">uclient.c</a>.
<p>
<pre class="fragment"><div>00091 {
00092     fprintf( stderr, <span class="stringliteral">"usage: UCLIENT ClientNumber [#threads]\n"</span> );
00093     ExitProcess( 1 );
00094 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="uipriv.c::SwitchAll" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d2/d9/uipriv_8c.html#a4">SwitchAll</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00050">50</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="uipriv.c::SwitchDisable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d2/d9/uipriv_8c.html#a2">SwitchDisable</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00048">48</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="uipriv.c::SwitchEnable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d2/d9/uipriv_8c.html#a1">SwitchEnable</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00047">47</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="uipriv.c::SwitchReset" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d2/d9/uipriv_8c.html#a3">SwitchReset</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00049">49</a> of file <a class="el" href="../../d3/d8/uipriv_8c-source.html">uipriv.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:52 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
