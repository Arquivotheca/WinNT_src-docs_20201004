<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kdp.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>kdp.h</h1><a href="../../d1/d7/4_2kdp_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1990  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    kdp.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Private include file for the Kernel Debugger subcomponent</span>
00012 <span class="comment">    of the NTOS project</span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment"></span>
00016 <span class="comment">    Mike O'Leary (mikeol) 29-June-1989</span>
00017 <span class="comment"></span>
00018 <span class="comment">Revision History:</span>
00019 <span class="comment"></span>
00020 <span class="comment">--*/</span>
00021 
00022 <span class="preprocessor">#include "<a class="code" href="../../d9/d8/ntos_8h.html">ntos.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="../../d0/d0/ki_8h.html">ki.h</a>"</span>
<a name="l00024"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a0">00024</a> <span class="preprocessor">#define NOEXTAPI</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#include "wdbgexts.h"</span>
00026 <span class="preprocessor">#include "ntdbg.h"</span>
00027 <span class="preprocessor">#include "string.h"</span>
00028 <span class="preprocessor">#include "stdlib.h"</span>
00029 
00030 
00031 <span class="preprocessor">#if defined(_ALPHA_)</span>
00032 <span class="preprocessor"></span>
00033 <span class="preprocessor">#include "alphaops.h"</span>
00034 
00035 <span class="comment">//</span>
00036 <span class="comment">// Define KD private PCR routines.</span>
00037 <span class="comment">//</span>
00038 <span class="comment">// Using the following private KD routines allows the kernel debugger to</span>
00039 <span class="comment">// step over breakpoints in modules that call the standard PCR routines.</span>
00040 <span class="comment">//</span>
00041 
00042 PKPCR <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a7">KdpGetPcr</a>();
00043 
00044 ULONG <a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a8">KdpReadInternalProcessorState</a>(PVOID, ULONG);
00045 ULONG <a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a9">KdpReadInternalProcessorCounters</a>(PVOID, ULONG);
00046 
00047 <span class="keyword">struct </span>_KPRCB *
00048 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a12">KdpGetCurrentPrcb</a>();
00049 
00050 <span class="keyword">struct </span><a class="code" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *
00051 <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a13">KdpGetCurrentThread</a>();
00052 
00053 <span class="comment">//</span>
00054 <span class="comment">// Redefine the standard PCR routines</span>
00055 <span class="comment">//</span>
00056 <span class="preprocessor">#undef KiPcr</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define KiPcr KdpGetPcr()</span>
00058 <span class="preprocessor"></span>
00059 <span class="preprocessor">#undef KeGetPcr</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#undef KeGetCurrentPrcb</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#undef KeGetCurrentThread</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#undef KeIsExecutingDpc</span>
00063 <span class="preprocessor"></span><span class="preprocessor">#define KeGetPcr() KdpGetPcr()</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define KeGetCurrentPrcb() KdpGetCurrentPrcb()</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define KeGetCurrentThread() KdpGetCurrentThread()</span>
00066 <span class="preprocessor"></span>
00067 <span class="comment">//</span>
00068 <span class="comment">// Define TYPES</span>
00069 <span class="comment">//</span>
00070 
00071 <span class="preprocessor">#define KDP_BREAKPOINT_TYPE  ULONG</span>
00072 <span class="preprocessor"></span>
00073 <span class="comment">// longword aligned</span>
00074 <span class="preprocessor">#define KDP_BREAKPOINT_ALIGN 3</span>
00075 <span class="preprocessor"></span>
00076 <span class="comment">// actual instruction is "call_pal kbpt"</span>
00077 <span class="preprocessor">#define KDP_BREAKPOINT_VALUE KBPT_FUNC</span>
00078 <span class="preprocessor"></span>
00079 
00080 <span class="preprocessor">#elif defined(_IA64_)</span>
00081 <span class="preprocessor"></span>
00082 <span class="comment">// IA64 instruction is in a 128-bit bundle. Each bundle consists of 3 instruction slots.</span>
00083 <span class="comment">// Each instruction slot is 41-bit long.</span>
00084 <span class="comment">//</span>
00085 <span class="comment">//</span>
00086 <span class="comment">//            127           87 86           46 45            5 4      1 0</span>
00087 <span class="comment">//            ------------------------------------------------------------</span>
00088 <span class="comment">//            |    slot 2     |    slot 1     |    slot 0     |template|S|</span>
00089 <span class="comment">//            ------------------------------------------------------------</span>
00090 <span class="comment">//</span>
00091 <span class="comment">//            127        96 95         64 63          32 31             0</span>
00092 <span class="comment">//            ------------------------------------------------------------</span>
00093 <span class="comment">//            |  byte 3    |  byte 2     |  byte 1      |   byte 0       |</span>
00094 <span class="comment">//            ------------------------------------------------------------</span>
00095 <span class="comment">//</span>
00096 <span class="comment">// This presents two incompatibilities with conventional processors:</span>
00097 <span class="comment">//              1. The IA64 IP address is at the bundle bundary. The instruction slot number is</span>
00098 <span class="comment">//                 stored in ISR.ei at the time of exception.</span>
00099 <span class="comment">//              2. The 41-bit instruction format is not byte-aligned.</span>
00100 <span class="comment">//</span>
00101 <span class="comment">// Break instruction insertion must be done with proper bit-shifting to align with the selected</span>
00102 <span class="comment">// instruction slot. Further, to insert break instruction insertion at a specific slot, we must</span>
00103 <span class="comment">// be able to specify instruction slot as part of the address. We therefore define an EM address as</span>
00104 <span class="comment">// bundle address + slot number with the least significant two bit always zero:</span>
00105 <span class="comment">//</span>
00106 <span class="comment">//                      31                 4 3  2  1  0</span>
00107 <span class="comment">//                      --------------------------------</span>
00108 <span class="comment">//                      |  bundle address    |slot#|0 0|</span>
00109 <span class="comment">//                      --------------------------------</span>
00110 <span class="comment">//</span>
00111 <span class="comment">// The EM address as defined is the byte-aligned address that is closest to the actual instruction slot.</span>
00112 <span class="comment">// i.e., The EM instruction address of slot #0 is equal to bundle address.</span>
00113 <span class="comment">//                                     slot #1 is equal to bundle address + 4.</span>
00114 <span class="comment">//                                     slot #2 is equal to bundle address + 8.</span>
00115 
00116 <span class="comment">//</span>
00117 <span class="comment">//  Upon exception, the bundle address is kept in IIP, and the instruction slot which caused</span>
00118 <span class="comment">//  the exception is in ISR.ei. Kernel exception handler will construct the flat address and</span>
00119 <span class="comment">//  export it in ExceptionRecord.ExceptionAddress.</span>
00120 
00121 
00122 <span class="preprocessor">#define KDP_BREAKPOINT_TYPE  ULONGLONG          // 64-bit ULONGLONG type is needed to cover 41-bit EM break instruction.</span>
00123 <span class="preprocessor"></span><span class="preprocessor">#define KDP_BREAKPOINT_ALIGN 0x3                // An EM address consists of bundle and slot number and is 32-bit aligned.</span>
00124 <span class="preprocessor"></span><span class="preprocessor">#define KDP_BREAKPOINT_VALUE (BREAK_INSTR | (DEBUG_STOP_BREAKPOINT &lt;&lt; 6))       </span>
00125 <span class="preprocessor"></span>
00126 <span class="preprocessor">#elif defined(_X86_)</span>
00127 <span class="preprocessor"></span>
00128 <span class="preprocessor">#define KDP_BREAKPOINT_TYPE  UCHAR</span>
00129 <span class="preprocessor"></span><span class="preprocessor">#define KDP_BREAKPOINT_ALIGN 0</span>
00130 <span class="preprocessor"></span><span class="preprocessor">#define KDP_BREAKPOINT_VALUE 0xcc</span>
00131 <span class="preprocessor"></span>
00132 <span class="preprocessor">#endif</span>
00133 <span class="preprocessor"></span>
00134 
00135 
00136 <span class="comment">//</span>
00137 <span class="comment">// Define constants.</span>
00138 <span class="comment">//</span>
00139 
00140 <span class="comment">//</span>
00141 <span class="comment">// Addresses above GLOBAL_BREAKPOINT_LIMIT are either in system space</span>
00142 <span class="comment">// or part of dynlink, so we treat them as global.</span>
00143 <span class="comment">//</span>
00144 
<a name="l00145"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a1">00145</a> <span class="preprocessor">#define GLOBAL_BREAKPOINT_LIMIT 1610612736L // 1.5gigabytes</span>
00146 <span class="preprocessor"></span>
00147 <span class="comment">//</span>
00148 <span class="comment">// Define breakpoint table entry structure.</span>
00149 <span class="comment">//</span>
00150 
<a name="l00151"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a2">00151</a> <span class="preprocessor">#define KD_BREAKPOINT_IN_USE        0x00000001</span>
<a name="l00152"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a3">00152</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_NEEDS_WRITE   0x00000002</span>
<a name="l00153"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a4">00153</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_SUSPENDED     0x00000004</span>
<a name="l00154"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a5">00154</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_NEEDS_REPLACE 0x00000008</span>
00155 <span class="preprocessor"></span><span class="comment">// IA64 specific defines</span>
<a name="l00156"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a6">00156</a> <span class="preprocessor">#define KD_BREAKPOINT_STATE_MASK    0x0000000f</span>
<a name="l00157"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a7">00157</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_IA64_MASK     0x000f0000</span>
<a name="l00158"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a8">00158</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_IA64_MODE     0x00010000   // IA64 mode</span>
<a name="l00159"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a9">00159</a> <span class="preprocessor"></span><span class="preprocessor">#define KD_BREAKPOINT_IA64_MOVL     0x00020000   // MOVL instruction displaced</span>
00160 <span class="preprocessor"></span>
00161 <span class="comment">//</span>
00162 <span class="comment">// status Constants for Packet waiting</span>
00163 <span class="comment">//</span>
00164 
<a name="l00165"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a10">00165</a> <span class="preprocessor">#define KDP_PACKET_RECEIVED 0</span>
<a name="l00166"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a11">00166</a> <span class="preprocessor"></span><span class="preprocessor">#define KDP_PACKET_TIMEOUT 1</span>
<a name="l00167"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a12">00167</a> <span class="preprocessor"></span><span class="preprocessor">#define KDP_PACKET_RESEND 2</span>
00168 <span class="preprocessor"></span>
00169 
00170 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">_BREAKPOINT_ENTRY</a> {
<a name="l00171"></a><a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">00171</a>     ULONG <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a>;
<a name="l00172"></a><a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">00172</a>     ULONG_PTR <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a>;
<a name="l00173"></a><a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">00173</a>     PVOID <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a>;
<a name="l00174"></a><a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o3">00174</a>     <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a> <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o3">Content</a>;
00175 } <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">BREAKPOINT_ENTRY</a>, *<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">PBREAKPOINT_ENTRY</a>;
00176 
00177 
00178 <span class="comment">//</span>
00179 <span class="comment">// Misc defines</span>
00180 <span class="comment">//</span>
00181 
<a name="l00182"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a13">00182</a> <span class="preprocessor">#define MAXIMUM_RETRIES 20</span>
00183 <span class="preprocessor"></span>
<a name="l00184"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a14">00184</a> <span class="preprocessor">#define DBGKD_MAX_SPECIAL_CALLS 10</span>
00185 <span class="preprocessor"></span>
00186 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html">_TRACE_DATA_SYM</a> {
<a name="l00187"></a><a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html#o0">00187</a>     ULONG <a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html#o0">SymMin</a>;
<a name="l00188"></a><a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html#o1">00188</a>     ULONG <a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html#o1">SymMax</a>;
00189 } <a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html">TRACE_DATA_SYM</a>, *<a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html">PTRACE_DATA_SYM</a>;
00190 
00191 <span class="comment">//</span>
00192 <span class="comment">// Define function prototypes.</span>
00193 <span class="comment">//</span>
00194 
00195 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00196 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a101">KdpReboot</a> (
00197     VOID
00198     );
00199 
00200 BOOLEAN
00201 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a102">KdpPrintString</a> (
00202     IN PSTRING Output
00203     );
00204 
00205 BOOLEAN
00206 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a103">KdpPromptString</a> (
00207     IN PSTRING Output,
00208     IN OUT PSTRING Input
00209     );
00210 
00211 ULONG
00212 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a104">KdpAddBreakpoint</a> (
00213     IN PVOID Address
00214     );
00215 
00216 BOOLEAN
00217 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a105">KdpDeleteBreakpoint</a> (
00218     IN ULONG Handle
00219     );
00220 
00221 BOOLEAN
00222 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a106">KdpDeleteBreakpointRange</a> (
00223     IN PVOID Lower,
00224     IN PVOID Upper
00225     );
00226 
00227 <span class="preprocessor">#if defined(_IA64_)</span>
00228 <span class="preprocessor"></span>
00229 BOOLEAN
00230 KdpSuspendBreakpointRange (
00231     IN PVOID Lower,
00232     IN PVOID Upper
00233     );
00234 
00235 BOOLEAN
00236 KdpRestoreBreakpointRange (
00237     IN PVOID Lower,
00238     IN PVOID Upper
00239     );
00240 <span class="preprocessor">#endif</span>
00241 <span class="preprocessor"></span>
00242 <span class="preprocessor">#if i386</span>
00243 <span class="preprocessor"></span>
00244 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00245 KdGetTraceInformation (
00246     OUT PVOID TraceInformation,
00247     IN ULONG TraceInformationLength,
00248     OUT PULONG RequiredLength
00249     );
00250 
00251 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00252 KdSetInternalBreakpoint (
00253     IN PDBGKD_MANIPULATE_STATE64 m
00254     );
00255 
00256 <span class="preprocessor">#endif</span>
00257 <span class="preprocessor"></span>
00258 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00259 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a107">KdQuerySpecialCalls</a> (
00260     IN PDBGKD_MANIPULATE_STATE64 m,
00261     IN ULONG Length,
00262     OUT PULONG RequiredLength
00263     );
00264 
00265 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00266 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a108">KdSetSpecialCall</a> (
00267     IN PDBGKD_MANIPULATE_STATE64 m,
00268     IN PCONTEXT ContextRecord
00269     );
00270 
00271 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00272 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a109">KdClearSpecialCalls</a> (
00273     VOID
00274     );
00275 
00276 ULONG
00277 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a> (
00278     IN PCHAR Destination,
00279     IN PCHAR Source,
00280     IN ULONG Length
00281     );
00282 
00283 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00284 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a111">KdpQuickMoveMemory</a> (
00285     IN PCHAR Destination,
00286     IN PCHAR Source,
00287     IN ULONG Length
00288     );
00289 
00290 ULONG
00291 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a112">KdpReceivePacket</a> (
00292     IN ULONG ExpectedPacketType,
00293     OUT PSTRING MessageHeader,
00294     OUT PSTRING MessageData,
00295     OUT PULONG DataLength
00296     );
00297 
00298 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00299 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a113">KdpSetLoadState</a>(
00300     IN PDBGKD_WAIT_STATE_CHANGE64 WaitStateChange,
00301     IN PCONTEXT ContextRecord
00302     );
00303 
00304 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00305 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a114">KdpSetStateChange</a>(
00306     IN PDBGKD_WAIT_STATE_CHANGE64 WaitStateChange,
00307     IN PEXCEPTION_RECORD ExceptionRecord,
00308     IN PCONTEXT ContextRecord,
00309     IN BOOLEAN SecondChance
00310     );
00311 
00312 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00313 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a115">KdpGetStateChange</a>(
00314     IN PDBGKD_MANIPULATE_STATE64 ManipulateState,
00315     IN PCONTEXT ContextRecord
00316     );
00317 
00318 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00319 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a116">KdpSendPacket</a> (
00320     IN ULONG PacketType,
00321     IN PSTRING MessageHeader,
00322     IN PSTRING MessageData OPTIONAL
00323     );
00324 
00325 BOOLEAN
00326 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a117">KdpStub</a> (
00327     IN PKTRAP_FRAME TrapFrame,
00328     IN PKEXCEPTION_FRAME ExceptionFrame,
00329     IN PEXCEPTION_RECORD ExceptionRecord,
00330     IN PCONTEXT ContextRecord,
00331     IN KPROCESSOR_MODE PreviousMode,
00332     IN BOOLEAN SecondChance
00333     );
00334 
00335 BOOLEAN
00336 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a118">KdpTrap</a> (
00337     IN PKTRAP_FRAME TrapFrame,
00338     IN PKEXCEPTION_FRAME ExceptionFrame,
00339     IN PEXCEPTION_RECORD ExceptionRecord64,
00340     IN PCONTEXT ContextRecord,
00341     IN KPROCESSOR_MODE PreviousMode,
00342     IN BOOLEAN SecondChance
00343     );
00344 
00345 BOOLEAN
00346 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a119">KdpSwitchProcessor</a> (
00347     IN PEXCEPTION_RECORD ExceptionRecord,
00348     IN OUT PCONTEXT ContextRecord,
00349     IN BOOLEAN SecondChance
00350     );
00351 
00352 BOOLEAN
00353 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a120">KdpReportExceptionStateChange</a> (
00354     IN PEXCEPTION_RECORD ExceptionRecord,
00355     IN OUT PCONTEXT ContextRecord,
00356     IN BOOLEAN SecondChance
00357     );
00358 
00359 BOOLEAN
00360 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a121">KdpReportLoadSymbolsStateChange</a> (
00361     IN PSTRING PathName,
00362     IN <a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a> SymbolInfo,
00363     IN BOOLEAN UnloadSymbols,
00364     IN OUT PCONTEXT ContextRecord
00365     );
00366 
00367 <a class="code" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a>
00368 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a122">KdpSendWaitContinue</a>(
00369     IN ULONG PacketType,
00370     IN PSTRING MessageHeader,
00371     IN PSTRING MessageData OPTIONAL,
00372     IN OUT PCONTEXT ContextRecord
00373     );
00374 
00375 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00376 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a123">KdpReadVirtualMemory</a>(
00377     IN PDBGKD_MANIPULATE_STATE64 m,
00378     IN PSTRING AdditionalData,
00379     IN PCONTEXT Context
00380     );
00381 
00382 <span class="preprocessor">#if 0</span>
00383 <span class="preprocessor"></span><a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00384 <a class="code" href="../../d0/d7/kdp_8h.html#a110">KdpReadVirtualMemory64</a>(
00385     IN PDBGKD_MANIPULATE_STATE64 m,
00386     IN PSTRING AdditionalData,
00387     IN PCONTEXT Context
00388     );
00389 <span class="preprocessor">#endif</span>
00390 <span class="preprocessor"></span>
00391 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00392 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a124">KdpWriteVirtualMemory</a>(
00393     IN PDBGKD_MANIPULATE_STATE64 m,
00394     IN PSTRING AdditionalData,
00395     IN PCONTEXT Context
00396     );
00397 
00398 <span class="preprocessor">#if 0</span>
00399 <span class="preprocessor"></span><a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00400 <a class="code" href="../../d0/d7/kdp_8h.html#a112">KdpWriteVirtualMemory64</a>(
00401     IN PDBGKD_MANIPULATE_STATE64 m,
00402     IN PSTRING AdditionalData,
00403     IN PCONTEXT Context
00404     );
00405 <span class="preprocessor">#endif</span>
00406 <span class="preprocessor"></span>
00407 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00408 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a125">KdpReadPhysicalMemory</a>(
00409     IN PDBGKD_MANIPULATE_STATE64 m,
00410     IN PSTRING AdditionalData,
00411     IN PCONTEXT Context
00412     );
00413 
00414 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00415 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a126">KdpWritePhysicalMemory</a>(
00416     IN PDBGKD_MANIPULATE_STATE64 m,
00417     IN PSTRING AdditionalData,
00418     IN PCONTEXT Context
00419     );
00420 
00421 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00422 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a127">KdpCheckLowMemory</a>(
00423     IN PDBGKD_MANIPULATE_STATE64 m
00424     );
00425 
00426 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00427 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a128">KdpGetContext</a>(
00428     IN PDBGKD_MANIPULATE_STATE64 m,
00429     IN PSTRING AdditionalData,
00430     IN PCONTEXT Context
00431     );
00432 
00433 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00434 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a129">KdpSetContext</a>(
00435     IN PDBGKD_MANIPULATE_STATE64 m,
00436     IN PSTRING AdditionalData,
00437     IN PCONTEXT Context
00438     );
00439 
00440 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00441 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a130">KdpWriteBreakpoint</a>(
00442     IN PDBGKD_MANIPULATE_STATE64 m,
00443     IN PSTRING AdditionalData,
00444     IN PCONTEXT Context
00445     );
00446 
00447 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00448 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a131">KdpRestoreBreakpoint</a>(
00449     IN PDBGKD_MANIPULATE_STATE64 m,
00450     IN PSTRING AdditionalData,
00451     IN PCONTEXT Context
00452     );
00453 
00454 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00455 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a132">KdpReadControlSpace</a>(
00456     IN PDBGKD_MANIPULATE_STATE64 m,
00457     IN PSTRING AdditionalData,
00458     IN PCONTEXT Context
00459     );
00460 
00461 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00462 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a133">KdpWriteControlSpace</a>(
00463     IN PDBGKD_MANIPULATE_STATE64 m,
00464     IN PSTRING AdditionalData,
00465     IN PCONTEXT Context
00466     );
00467 
00468 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00469 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a134">KdpReadIoSpace</a>(
00470     IN PDBGKD_MANIPULATE_STATE64 m,
00471     IN PSTRING AdditionalData,
00472     IN PCONTEXT Context
00473     );
00474 
00475 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00476 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a135">KdpReadMachineSpecificRegister</a>(
00477     IN PDBGKD_MANIPULATE_STATE64 m,
00478     IN PSTRING AdditionalData,
00479     IN PCONTEXT Context
00480     );
00481 
00482 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00483 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a136">KdpWriteIoSpace</a>(
00484     IN PDBGKD_MANIPULATE_STATE64 m,
00485     IN PSTRING AdditionalData,
00486     IN PCONTEXT Context
00487     );
00488 
00489 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00490 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a137">KdpWriteMachineSpecificRegister</a>(
00491     IN PDBGKD_MANIPULATE_STATE64 m,
00492     IN PSTRING AdditionalData,
00493     IN PCONTEXT Context
00494     );
00495 
00496 <span class="preprocessor">#ifdef _ALPHA_</span>
00497 <span class="preprocessor"></span>
00498 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00499 <a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a10">KdpReadIoSpaceExtended</a> (
00500     IN PDBGKD_MANIPULATE_STATE64 m,
00501     IN PSTRING AdditionalData,
00502     IN PCONTEXT Context
00503     );
00504 
00505 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00506 <a class="code" href="../../d7/d7/4_2axp64_2kdpcpu_8h.html#a11">KdpWriteIoSpaceExtended</a> (
00507     IN PDBGKD_MANIPULATE_STATE64 m,
00508     IN PSTRING AdditionalData,
00509     IN PCONTEXT Context
00510     );
00511 
00512 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00513 <a class="code" href="../../d5/d5/4_2alpha_2kdcpuapi_8c.html#a10">KdpGetBusData</a> (
00514     IN PDBGKD_MANIPULATE_STATE64 m,
00515     IN PSTRING AdditionalData,
00516     IN PCONTEXT Context
00517     );
00518 
00519 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00520 <a class="code" href="../../d5/d5/4_2alpha_2kdcpuapi_8c.html#a11">KdpSetBusData</a> (
00521     IN PDBGKD_MANIPULATE_STATE64 m,
00522     IN PSTRING AdditionalData,
00523     IN PCONTEXT Context
00524     );
00525 
00526 <span class="preprocessor">#endif</span>
00527 <span class="preprocessor"></span>
00528 
00529 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00530 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a138">KdpSuspendBreakpoint</a> (
00531     ULONG Handle
00532     );
00533 
00534 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00535 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a139">KdpSuspendAllBreakpoints</a> (
00536     VOID
00537     );
00538 
00539 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00540 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a140">KdpRestoreAllBreakpoints</a> (
00541     VOID
00542     );
00543 
00544 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00545 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a141">KdpTimeSlipDpcRoutine</a> (
00546     <a class="code" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc,
00547     PVOID DeferredContext,
00548     PVOID SystemArgument1,
00549     PVOID SystemArgument2
00550     );
00551 
00552 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00553 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a142">KdpTimeSlipWork</a> (
00554     IN PVOID Context
00555     );
00556 
00557 <span class="comment">//</span>
00558 <span class="comment">// Define dummy prototype so the address of the standard breakpoint instruction</span>
00559 <span class="comment">// can be captured.</span>
00560 <span class="comment">//</span>
00561 <span class="comment">// N.B. This function is NEVER called.</span>
00562 <span class="comment">//</span>
00563 
00564 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00565 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a143">RtlpBreakWithStatusInstruction</a> (
00566     VOID
00567     );
00568 
00569 <span class="comment">//</span>
00570 <span class="comment">// Define external references.</span>
00571 <span class="comment">//</span>
00572 
<a name="l00573"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a15">00573</a> <span class="preprocessor">#define KDP_MESSAGE_BUFFER_SIZE 4096</span>
00574 <span class="preprocessor"></span>
<a name="l00575"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a25">00575</a> <span class="keyword">extern</span> <a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html">BREAKPOINT_ENTRY</a> <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[BREAKPOINT_TABLE_SIZE];
<a name="l00576"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a26">00576</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a>;
<a name="l00577"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a27">00577</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d4/d4/alpha_2splocks_8c.html#a9">KdpDebuggerLock</a>;
<a name="l00578"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a28">00578</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d9/ke_8h.html#a64">PKDEBUG_ROUTINE</a> <a class="code" href="../../d0/d7/kdp_8h.html#a24">KiDebugRoutine</a>;
<a name="l00579"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a29">00579</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d9/ke_8h.html#a65">PKDEBUG_SWITCH_ROUTINE</a> <a class="code" href="../../d0/d7/kdp_8h.html#a25">KiDebugSwitchRoutine</a>;
<a name="l00580"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a30">00580</a> <span class="keyword">extern</span> <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a> <a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a>;
<a name="l00581"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a31">00581</a> <span class="keyword">extern</span> UCHAR <a class="code" href="../../d8/d5/kddata_8c.html#a52">KdpMessageBuffer</a>[<a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>];
<a name="l00582"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a32">00582</a> <span class="keyword">extern</span> UCHAR <a class="code" href="../../d8/d5/kddata_8c.html#a53">KdpPathBuffer</a>[<a class="code" href="../../d0/d7/kdp_8h.html#a14">KDP_MESSAGE_BUFFER_SIZE</a>];
<a name="l00583"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a33">00583</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a108">KdpOweBreakpoint</a>;
<a name="l00584"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a34">00584</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a>;
<a name="l00585"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a35">00585</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a>;
00586 
<a name="l00587"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a36">00587</a> <span class="keyword">extern</span> LARGE_INTEGER <a class="code" href="../../d8/d5/kddata_8c.html#a55">KdPerformanceCounterRate</a>;
<a name="l00588"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a37">00588</a> <span class="keyword">extern</span> LARGE_INTEGER <a class="code" href="../../d8/d5/kddata_8c.html#a56">KdTimerStart</a>;
<a name="l00589"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a38">00589</a> <span class="keyword">extern</span> LARGE_INTEGER <a class="code" href="../../d8/d5/kddata_8c.html#a57">KdTimerStop</a>;
<a name="l00590"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a39">00590</a> <span class="keyword">extern</span> LARGE_INTEGER <a class="code" href="../../d8/d5/kddata_8c.html#a58">KdTimerDifference</a>;
00591 
<a name="l00592"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a40">00592</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a86">BreakpointsSuspended</a>;
<a name="l00593"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a41">00593</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d8/d5/kddata_8c.html#a94">KdpNtosImageBase</a>;
<a name="l00594"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a42">00594</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>;
00595 
00596 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00597"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o11">00597</a>     ULONG64 Addr;                 <span class="comment">// pc address of breakpoint</span>
<a name="l00598"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o1">00598</a>     ULONG Flags;                <span class="comment">// Flags bits</span>
<a name="l00599"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o2">00599</a>     ULONG Calls;                <span class="comment">// # of times traced routine called</span>
<a name="l00600"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o3">00600</a>     ULONG CallsLastCheck;       <span class="comment">// # of calls at last periodic (1s) check</span>
<a name="l00601"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o4">00601</a>     ULONG MaxCallsPerPeriod;
<a name="l00602"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o5">00602</a>     ULONG MinInstructions;      <span class="comment">// largest number of instructions for 1 call</span>
<a name="l00603"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o6">00603</a>     ULONG MaxInstructions;      <span class="comment">// smallest # of instructions for 1 call</span>
<a name="l00604"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o7">00604</a>     ULONG TotalInstructions;    <span class="comment">// total instructions for all calls</span>
<a name="l00605"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o8">00605</a>     ULONG <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;               <span class="comment">// handle in (regular) bpt table</span>
<a name="l00606"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o9">00606</a>     PVOID Thread;               <span class="comment">// Thread that's skipping this BP</span>
<a name="l00607"></a><a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html#o12">00607</a>     ULONG64 ReturnAddress;        <span class="comment">// return address (if not COUNTONLY)</span>
00608 } <a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html">DBGKD_INTERNAL_BREAKPOINT</a>, *<a class="code" href="../../d0/d7/kdp_8h.html#a39">PDBGKD_INTERNAL_BREAKPOINT</a>;
00609 
00610 
<a name="l00611"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a16">00611</a> <span class="preprocessor">#define DBGKD_MAX_INTERNAL_BREAKPOINTS 20</span>
<a name="l00612"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a44">00612</a> <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="../../d6/d7/structDBGKD__INTERNAL__BREAKPOINT.html">DBGKD_INTERNAL_BREAKPOINT</a> <a class="code" href="../../d8/d5/kddata_8c.html#a54">KdpInternalBPs</a>[<a class="code" href="../../d0/d7/kdp_8h.html#a15">DBGKD_MAX_INTERNAL_BREAKPOINTS</a>];
00613 
<a name="l00614"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a45">00614</a> <span class="keyword">extern</span> ULONG_PTR   <a class="code" href="../../d2/d5/i386_2kdcpuapi_8c.html#a1">KdpCurrentSymbolStart</a>;
<a name="l00615"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a46">00615</a> <span class="keyword">extern</span> ULONG_PTR   <a class="code" href="../../d2/d5/i386_2kdcpuapi_8c.html#a2">KdpCurrentSymbolEnd</a>;
<a name="l00616"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a47">00616</a> <span class="keyword">extern</span> LONG    <a class="code" href="../../d8/d5/kddata_8c.html#a61">KdpNextCallLevelChange</a>;
<a name="l00617"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a48">00617</a> <span class="keyword">extern</span> ULONG_PTR   <a class="code" href="../../d2/d5/i386_2kdcpuapi_8c.html#a3">KdSpecialCalls</a>[];
<a name="l00618"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a49">00618</a> <span class="keyword">extern</span> ULONG   <a class="code" href="../../d2/d5/i386_2kdcpuapi_8c.html#a4">KdNumberOfSpecialCalls</a>;
<a name="l00619"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a50">00619</a> <span class="keyword">extern</span> ULONG_PTR   <a class="code" href="../../d8/d5/kddata_8c.html#a64">InitialSP</a>;
<a name="l00620"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a51">00620</a> <span class="keyword">extern</span> ULONG   <a class="code" href="../../d8/d5/kddata_8c.html#a65">KdpNumInternalBreakpoints</a>;
<a name="l00621"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a52">00621</a> <span class="keyword">extern</span> <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>  <a class="code" href="../../d8/d5/kddata_8c.html#a66">InternalBreakpointTimer</a>;
<a name="l00622"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a53">00622</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d6/struct__KDPC.html">KDPC</a>    <a class="code" href="../../d8/d5/kddata_8c.html#a67">InternalBreakpointCheckDpc</a>;
<a name="l00623"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a54">00623</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a68">KdpPortLocked</a>;
<a name="l00624"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a55">00624</a> <span class="keyword">extern</span> LARGE_INTEGER   <a class="code" href="../../d0/d7/kdp_8h.html#a51">KdpTimeEntered</a>;
00625 
<a name="l00626"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a56">00626</a> <span class="keyword">extern</span> DBGKD_TRACE_DATA <a class="code" href="../../d8/d5/kddata_8c.html#a69">TraceDataBuffer</a>[];
<a name="l00627"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a57">00627</a> <span class="keyword">extern</span> ULONG            <a class="code" href="../../d8/d5/kddata_8c.html#a70">TraceDataBufferPosition</a>;
<a name="l00628"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a58">00628</a> <span class="keyword">extern</span> <a class="code" href="../../d9/d1/struct__TRACE__DATA__SYM.html">TRACE_DATA_SYM</a>   <a class="code" href="../../d8/d5/kddata_8c.html#a71">TraceDataSyms</a>[];
<a name="l00629"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a59">00629</a> <span class="keyword">extern</span> UCHAR <a class="code" href="../../d8/d5/kddata_8c.html#a72">NextTraceDataSym</a>;
<a name="l00630"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a60">00630</a> <span class="keyword">extern</span> UCHAR <a class="code" href="../../d8/d5/kddata_8c.html#a73">NumTraceDataSyms</a>;
<a name="l00631"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a61">00631</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a74">IntBPsSkipping</a>;
<a name="l00632"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a62">00632</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a75">WatchStepOver</a>;
<a name="l00633"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a63">00633</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d8/d5/kddata_8c.html#a76">WSOThread</a>;
<a name="l00634"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a64">00634</a> <span class="keyword">extern</span> ULONG_PTR <a class="code" href="../../d8/d5/kddata_8c.html#a77">WSOEsp</a>;
<a name="l00635"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a65">00635</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a78">WatchStepOverHandle</a>;
<a name="l00636"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a66">00636</a> <span class="keyword">extern</span> ULONG_PTR <a class="code" href="../../d8/d5/kddata_8c.html#a79">WatchStepOverBreakAddr</a>;
<a name="l00637"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a67">00637</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a80">WatchStepOverSuspended</a>;
<a name="l00638"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a68">00638</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a81">InstructionsTraced</a>;
<a name="l00639"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a69">00639</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a82">SymbolRecorded</a>;
<a name="l00640"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a70">00640</a> <span class="keyword">extern</span> LONG <a class="code" href="../../d8/d5/kddata_8c.html#a83">CallLevelChange</a>;
<a name="l00641"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a71">00641</a> <span class="keyword">extern</span> LONG_PTR <a class="code" href="../../d8/d5/kddata_8c.html#a84">oldpc</a>;
<a name="l00642"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a72">00642</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a85">InstrCountInternal</a>;
00643 <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a86">BreakpointsSuspended</a>;
00644 <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a89">KdpControlCPending</a>;
<a name="l00645"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a73">00645</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a90">KdpControlCPressed</a>;
<a name="l00646"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a74">00646</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a87">KdpRetryCount</a>;
<a name="l00647"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a75">00647</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a88">KdpNumberRetries</a>;
<a name="l00648"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a76">00648</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d0/cmdat3_8c.html#a70">KdpDefaultRetries</a>;
00649 
00650 <span class="keyword">extern</span> <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a4">KDP_BREAKPOINT_TYPE</a> <a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a>;
00651 <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a108">KdpOweBreakpoint</a>;
00652 <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a>;
00653 <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a>;
00654 <span class="keyword">extern</span> PVOID <a class="code" href="../../d8/d5/kddata_8c.html#a94">KdpNtosImageBase</a>;
<a name="l00655"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a77">00655</a> <span class="keyword">extern</span> UCHAR  <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>[<a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>];
<a name="l00656"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a78">00656</a> <span class="keyword">extern</span> PUCHAR <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a>;
<a name="l00657"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a79">00657</a> <span class="keyword">extern</span> ULONG  <a class="code" href="../../d8/d5/kddata_8c.html#a48">KdPrintRolloverCount</a>;
<a name="l00658"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a80">00658</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d8/d5/kddata_8c.html#a49">KdpPrintSpinLock</a>;
<a name="l00659"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a81">00659</a> <span class="keyword">extern</span> <a class="code" href="../../d0/d2/struct__DEBUG__PARAMETERS.html">DEBUG_PARAMETERS</a> <a class="code" href="../../d7/d3/kd_8h.html#a14">KdDebugParameters</a>;
<a name="l00660"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a82">00660</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d8/d5/kddata_8c.html#a96">KdpDataSpinLock</a>;
00661 <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>;
<a name="l00662"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a83">00662</a> <span class="keyword">extern</span> KDDEBUGGER_DATA64 <a class="code" href="../../d8/d5/kddata_8c.html#a50">KdDebuggerDataBlock</a>;
<a name="l00663"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a84">00663</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d6/struct__KDPC.html">KDPC</a> <a class="code" href="../../d8/d5/kddata_8c.html#a100">KdpTimeSlipDpc</a>;
<a name="l00664"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a85">00664</a> <span class="keyword">extern</span> <a class="code" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="code" href="../../d8/d5/kddata_8c.html#a101">KdpTimeSlipWorkItem</a>;
<a name="l00665"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a86">00665</a> <span class="keyword">extern</span> <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a> <a class="code" href="../../d8/d5/kddata_8c.html#a102">KdpTimeSlipTimer</a>;
<a name="l00666"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a87">00666</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a103">KdpTimeSlipPending</a>;
<a name="l00667"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a88">00667</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d8/d5/kddata_8c.html#a98">KdpTimeSlipEventLock</a>;
<a name="l00668"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a89">00668</a> <span class="keyword">extern</span> PVOID <a class="code" href="../../d8/d5/kddata_8c.html#a99">KdpTimeSlipEvent</a>;
<a name="l00669"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a90">00669</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d8/d5/kddata_8c.html#a107">KdpDebuggerStructuresInitialized</a>;
<a name="l00670"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a91">00670</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d5/kddata_8c.html#a109">KdEnteredDebugger</a>;
00671 
00672 <span class="comment">//</span>
00673 <span class="comment">// !search support (page hit database)</span>
00674 <span class="comment">//</span>
00675 
00676 <span class="comment">//</span>
00677 <span class="comment">// Hit database where search results are stored (kddata.c). </span>
00678 <span class="comment">// The debugger extensions know how to extract the information </span>
00679 <span class="comment">// from here.</span>
00680 <span class="comment">//</span>
00681 <span class="comment">// Note that the size of the hit database is large enough to</span>
00682 <span class="comment">// accomodate any searches because the !search extension works</span>
00683 <span class="comment">// in batches of pages &lt; PAGE_SIZE and for every page we register only </span>
00684 <span class="comment">// one hit.</span>
00685 <span class="comment">//</span>
00686 
<a name="l00687"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a17">00687</a> <span class="preprocessor">#define SEARCH_PAGE_HIT_DATABASE_SIZE PAGE_SIZE</span>
00688 <span class="preprocessor"></span>
<a name="l00689"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a92">00689</a> <span class="keyword">extern</span> PFN_NUMBER <a class="code" href="../../d9/d5/4_2kddata_8c.html#a108">KdpSearchPageHits</a>[<a class="code" href="../../d1/d7/4_2kdp_8h.html#a17">SEARCH_PAGE_HIT_DATABASE_SIZE</a>];
<a name="l00690"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a93">00690</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d9/d5/4_2kddata_8c.html#a109">KdpSearchPageHitOffsets</a>[<a class="code" href="../../d1/d7/4_2kdp_8h.html#a17">SEARCH_PAGE_HIT_DATABASE_SIZE</a>];
00691 
<a name="l00692"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a94">00692</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d9/d5/4_2kddata_8c.html#a110">KdpSearchPageHitIndex</a>;
00693 
00694 <span class="comment">//</span>
00695 <span class="comment">// Set to true while a physical memory search is in progress.</span>
00696 <span class="comment">// Reset at the end of the search. This is done in the debugger</span>
00697 <span class="comment">// extension and it is a flag used by KdpCheckLowMemory to get</span>
00698 <span class="comment">// onto a different code path.</span>
00699 <span class="comment">//</span>
00700 
<a name="l00701"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a95">00701</a> <span class="keyword">extern</span> LOGICAL <a class="code" href="../../d9/d5/4_2kddata_8c.html#a111">KdpSearchInProgress</a>;
00702 
00703 <span class="comment">//</span>
00704 <span class="comment">// These variables store the current state of the search operation.</span>
00705 <span class="comment">// They can be used to restore an interrupted search.</span>
00706 <span class="comment">//</span>
00707 
<a name="l00708"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a96">00708</a> <span class="keyword">extern</span> PFN_NUMBER <a class="code" href="../../d9/d5/4_2kddata_8c.html#a112">KdpSearchStartPageFrame</a>;
<a name="l00709"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a97">00709</a> <span class="keyword">extern</span> PFN_NUMBER <a class="code" href="../../d9/d5/4_2kddata_8c.html#a113">KdpSearchEndPageFrame</a>;
00710 
<a name="l00711"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a98">00711</a> <span class="keyword">extern</span> ULONG_PTR <a class="code" href="../../d9/d5/4_2kddata_8c.html#a114">KdpSearchAddressRangeStart</a>;
<a name="l00712"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a99">00712</a> <span class="keyword">extern</span> ULONG_PTR <a class="code" href="../../d9/d5/4_2kddata_8c.html#a115">KdpSearchAddressRangeEnd</a>;
00713 
00714 <span class="comment">//</span>
00715 <span class="comment">// Checkpoint variable used to test if we have the right</span>
00716 <span class="comment">// debugging symbols.</span>
00717 <span class="comment">//</span>
00718 
<a name="l00719"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a18">00719</a> <span class="preprocessor">#define KDP_SEARCH_SYMBOL_CHECK 0xABCDDCBA</span>
00720 <span class="preprocessor"></span>
<a name="l00721"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a100">00721</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d9/d5/4_2kddata_8c.html#a116">KdpSearchCheckPoint</a>;
00722 
00723 <span class="comment">//</span>
00724 <span class="comment">// Page search flags</span>
00725 <span class="comment">//</span>
00726 
<a name="l00727"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a19">00727</a> <span class="preprocessor">#define KDP_SEARCH_ALL_OFFSETS_IN_PAGE 0x0001</span>
00728 <span class="preprocessor"></span>
00729 
00730 
00731 <span class="comment">//</span>
00732 <span class="comment">// Private procedure prototypes</span>
00733 <span class="comment">//</span>
00734 
00735 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00736 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a144">KdpInitCom</a>(
00737     VOID
00738     );
00739 
00740 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00741 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a145">KdpPortLock</a>(
00742     VOID
00743     );
00744 
00745 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00746 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a146">KdpPortUnlock</a>(
00747     VOID
00748     );
00749 
00750 BOOLEAN
00751 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a147">KdpPollBreakInWithPortLock</a>(
00752     VOID
00753     );
00754 
00755 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>
00756 <a class="code" href="../../d1/d7/4_2kdp_8h.html#a148">KdpReceivePacketLeader</a> (
00757     IN ULONG PacketType,
00758     OUT PULONG PacketLeader
00759     );
00760 
00761 <span class="preprocessor">#if DBG</span>
00762 <span class="preprocessor"></span>
00763 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00764 <span class="preprocessor">#define DPRINT(s) KdpDprintf s</span>
00765 <span class="preprocessor"></span>
00766 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00767 KdpDprintf(
00768     IN PCHAR f,
00769     ...
00770     );
00771 
00772 <span class="preprocessor">#else</span>
00773 <span class="preprocessor"></span>
<a name="l00774"></a><a class="code" href="../../d1/d7/4_2kdp_8h.html#a20">00774</a> <span class="preprocessor">#define DPRINT(s)</span>
00775 <span class="preprocessor"></span>
00776 <span class="preprocessor">#endif</span>
00777 <span class="preprocessor"></span>
00778 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:34 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
