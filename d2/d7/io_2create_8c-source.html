<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: create.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>create.c</h1><a href="../../d1/d8/io_2create_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    create.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the code to implement the NtCreateFile,</span>
00012 <span class="comment">    the NtCreateNamedPipeFile and the NtCreateMailslotFile system</span>
00013 <span class="comment">    services.</span>
00014 <span class="comment"></span>
00015 <span class="comment">Author:</span>
00016 <span class="comment"></span>
00017 <span class="comment">    Darryl E. Havens (darrylh) 14-Apr-1989</span>
00018 <span class="comment"></span>
00019 <span class="comment">Environment:</span>
00020 <span class="comment"></span>
00021 <span class="comment">    Kernel mode</span>
00022 <span class="comment"></span>
00023 <span class="comment">Revision History:</span>
00024 <span class="comment"></span>
00025 <span class="comment"></span>
00026 <span class="comment">--*/</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="../../d0/d6/iop_8h.html">iop.h</a>"</span>
00029 
00030 <span class="preprocessor">#ifdef ALLOC_PRAGMA</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(PAGE, NtCreateFile)</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(PAGE, NtCreateNamedPipeFile)</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(PAGE, NtCreateMailslotFile)</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00035 <span class="preprocessor"></span>
00036 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00037"></a><a class="code" href="../../d1/d8/io_2create_8c.html#a0">00037</a> <a class="code" href="../../d1/d8/io_2create_8c.html#a0">NtCreateFile</a>(
00038     OUT PHANDLE FileHandle,
00039     IN ACCESS_MASK DesiredAccess,
00040     IN POBJECT_ATTRIBUTES ObjectAttributes,
00041     OUT PIO_STATUS_BLOCK IoStatusBlock,
00042     IN PLARGE_INTEGER AllocationSize OPTIONAL,
00043     IN ULONG FileAttributes,
00044     IN ULONG ShareAccess,
00045     IN ULONG CreateDisposition,
00046     IN ULONG CreateOptions,
00047     IN PVOID EaBuffer OPTIONAL,
00048     IN ULONG EaLength
00049     )
00050 
00051 <span class="comment">/*++</span>
00052 <span class="comment"></span>
00053 <span class="comment">Routine Description:</span>
00054 <span class="comment"></span>
00055 <span class="comment">    This service opens or creates a file, or opens a device.  It is used to</span>
00056 <span class="comment">    establish a file handle to the open device/file that can then be used</span>
00057 <span class="comment">    in subsequent operations to perform I/O operations on.  For purposes of</span>
00058 <span class="comment">    readability, files and devices are treated as "files" throughout the</span>
00059 <span class="comment">    majority of this module and the system service portion of the I/O system.</span>
00060 <span class="comment">    The only time a distinction is made is when it is important to determine</span>
00061 <span class="comment">    which is really being accessed.  Then a distinction is also made in the</span>
00062 <span class="comment">    comments.</span>
00063 <span class="comment"></span>
00064 <span class="comment">Arguments:</span>
00065 <span class="comment"></span>
00066 <span class="comment">    FileHandle - A pointer to a variable to receive the handle to the open file.</span>
00067 <span class="comment"></span>
00068 <span class="comment">    DesiredAccess - Supplies the types of access that the caller would like to</span>
00069 <span class="comment">        the file.</span>
00070 <span class="comment"></span>
00071 <span class="comment">    ObjectAttributes - Supplies the attributes to be used for file object (name,</span>
00072 <span class="comment">        SECURITY_DESCRIPTOR, etc.)</span>
00073 <span class="comment"></span>
00074 <span class="comment">    IoStatusBlock - Specifies the address of the caller's I/O status block.</span>
00075 <span class="comment"></span>
00076 <span class="comment">    AllocationSize - Initial size that should be allocated to the file.  This</span>
00077 <span class="comment">        parameter only has an affect if the file is created.  Further, if</span>
00078 <span class="comment">        not specified, then it is taken to mean zero.</span>
00079 <span class="comment"></span>
00080 <span class="comment">    FileAttributes - Specifies the attributes that should be set on the file,</span>
00081 <span class="comment">        if it is created.</span>
00082 <span class="comment"></span>
00083 <span class="comment">    ShareAccess - Supplies the types of share access that the caller would like</span>
00084 <span class="comment">        to the file.</span>
00085 <span class="comment"></span>
00086 <span class="comment">    CreateDisposition - Supplies the method for handling the create/open.</span>
00087 <span class="comment"></span>
00088 <span class="comment">    CreateOptions - Caller options for how to perform the create/open.</span>
00089 <span class="comment"></span>
00090 <span class="comment">    EaBuffer - Optionally specifies a set of EAs to be applied to the file if</span>
00091 <span class="comment">        it is created.</span>
00092 <span class="comment"></span>
00093 <span class="comment">    EaLength - Supplies the length of the EaBuffer.</span>
00094 <span class="comment"></span>
00095 <span class="comment">Return Value:</span>
00096 <span class="comment"></span>
00097 <span class="comment">    The function value is the final status of the create/open operation.</span>
00098 <span class="comment"></span>
00099 <span class="comment">--*/</span>
00100 
00101 {
00102     <span class="comment">//</span>
00103     <span class="comment">// Simply invoke the common I/O file creation routine to do the work.</span>
00104     <span class="comment">//</span>
00105 
00106     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00107 
00108     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/iosubs_8c.html#a46">IoCreateFile</a>( FileHandle,
00109                          DesiredAccess,
00110                          <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>,
00111                          IoStatusBlock,
00112                          AllocationSize,
00113                          <a class="code" href="../../d2/d2/rtload_8c.html#a5">FileAttributes</a>,
00114                          ShareAccess,
00115                          CreateDisposition,
00116                          CreateOptions,
00117                          EaBuffer,
00118                          EaLength,
00119                          <a class="code" href="../../d0/d5/io_8h.html#a600a406">CreateFileTypeNone</a>,
00120                          (PVOID)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00121                          0 );
00122 }
00123 
00124 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00125"></a><a class="code" href="../../d1/d8/io_2create_8c.html#a1">00125</a> <a class="code" href="../../d1/d8/io_2create_8c.html#a1">NtCreateNamedPipeFile</a>(
00126      OUT PHANDLE FileHandle,
00127      IN ULONG DesiredAccess,
00128      IN POBJECT_ATTRIBUTES ObjectAttributes,
00129      OUT PIO_STATUS_BLOCK IoStatusBlock,
00130      IN ULONG ShareAccess,
00131      IN ULONG CreateDisposition,
00132      IN ULONG CreateOptions,
00133      IN ULONG NamedPipeType,
00134      IN ULONG ReadMode,
00135      IN ULONG CompletionMode,
00136      IN ULONG MaximumInstances,
00137      IN ULONG InboundQuota,
00138      IN ULONG OutboundQuota,
00139      IN PLARGE_INTEGER DefaultTimeout OPTIONAL
00140      )
00141 
00142 <span class="comment">/*++</span>
00143 <span class="comment"></span>
00144 <span class="comment">Routine Description:</span>
00145 <span class="comment"></span>
00146 <span class="comment">    Creates and opens the server end handle of the first instance of a</span>
00147 <span class="comment">    specific named pipe or another instance of an existing named pipe.</span>
00148 <span class="comment"></span>
00149 <span class="comment">Arguments:</span>
00150 <span class="comment"></span>
00151 <span class="comment">    FileHandle - Supplies a handle to the file on which the service is being</span>
00152 <span class="comment">        performed.</span>
00153 <span class="comment"></span>
00154 <span class="comment">    DesiredAccess - Supplies the types of access that the caller would like to</span>
00155 <span class="comment">        the file.</span>
00156 <span class="comment"></span>
00157 <span class="comment">    ObjectAttributes - Supplies the attributes to be used for file object</span>
00158 <span class="comment">        (name, SECURITY_DESCRIPTOR, etc.)</span>
00159 <span class="comment"></span>
00160 <span class="comment">    IoStatusBlock - Address of the caller's I/O status block.</span>
00161 <span class="comment"></span>
00162 <span class="comment">    ShareAccess - Supplies the types of share access that the caller would</span>
00163 <span class="comment">        like to the file.</span>
00164 <span class="comment"></span>
00165 <span class="comment">    CreateDisposition - Supplies the method for handling the create/open.</span>
00166 <span class="comment"></span>
00167 <span class="comment">    CreateOptions - Caller options for how to perform the create/open.</span>
00168 <span class="comment"></span>
00169 <span class="comment">    NamedPipeType - Type of named pipe to create (Bitstream or message).</span>
00170 <span class="comment"></span>
00171 <span class="comment">    ReadMode - Mode in which to read the pipe (Bitstream or message).</span>
00172 <span class="comment"></span>
00173 <span class="comment">    CompletionMode - Specifies how the operation is to be completed.</span>
00174 <span class="comment"></span>
00175 <span class="comment">    MaximumInstances - Maximum number of simultaneous instances of the named</span>
00176 <span class="comment">        pipe.</span>
00177 <span class="comment"></span>
00178 <span class="comment">    InboundQuota - Specifies the pool quota that is reserved for writes to the</span>
00179 <span class="comment">        inbound side of the named pipe.</span>
00180 <span class="comment"></span>
00181 <span class="comment">    OutboundQuota - Specifies the pool quota that is reserved for writes to</span>
00182 <span class="comment">        the inbound side of the named pipe.</span>
00183 <span class="comment"></span>
00184 <span class="comment">    DefaultTimeout - Optional pointer to a timeout value that is used if a</span>
00185 <span class="comment">        timeout value is not specified when waiting for an instance of a named</span>
00186 <span class="comment">        pipe.</span>
00187 <span class="comment"></span>
00188 <span class="comment">Return Value:</span>
00189 <span class="comment"></span>
00190 <span class="comment">    The function value is the final status of the create/open operation.</span>
00191 <span class="comment"></span>
00192 <span class="comment">--*/</span>
00193 
00194 {
00195     <a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html">NAMED_PIPE_CREATE_PARAMETERS</a> namedPipeCreateParameters;
00196 
00197     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00198 
00199     <span class="comment">//</span>
00200     <span class="comment">// Check whether or not the DefaultTimeout parameter was specified.  If</span>
00201     <span class="comment">// so, then capture it in the named pipe create parameter structure.</span>
00202     <span class="comment">//</span>
00203 
00204     <span class="keywordflow">if</span> (ARGUMENT_PRESENT( DefaultTimeout )) {
00205 
00206         <span class="comment">//</span>
00207         <span class="comment">// Indicate that a default timeout period was specified.</span>
00208         <span class="comment">//</span>
00209 
00210         namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o7">TimeoutSpecified</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00211 
00212         <span class="comment">//</span>
00213         <span class="comment">// A default timeout parameter was specified.  Check to see whether</span>
00214         <span class="comment">// the caller's mode is kernel and if not capture the parameter inside</span>
00215         <span class="comment">// of a try...except clause.</span>
00216         <span class="comment">//</span>
00217 
00218         <span class="keywordflow">if</span> (KeGetPreviousMode() != <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>) {
00219             <span class="keywordflow">try</span> {
00220                 <a class="code" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>( DefaultTimeout,
00221                               <span class="keyword">sizeof</span>( LARGE_INTEGER ),
00222                               <span class="keyword">sizeof</span>( ULONG ) );
00223                 namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o6">DefaultTimeout</a> = *DefaultTimeout;
00224             } except(<a class="code" href="../../d6/d7/halmips_8h.html#a33">EXCEPTION_EXECUTE_HANDLER</a>) {
00225 
00226                 <span class="comment">//</span>
00227                 <span class="comment">// Something went awry attempting to access the parameter.</span>
00228                 <span class="comment">// Get the reason for the error and return it as the status</span>
00229                 <span class="comment">// value from this service.</span>
00230                 <span class="comment">//</span>
00231 
00232                 <span class="keywordflow">return</span> GetExceptionCode();
00233             }
00234         } <span class="keywordflow">else</span> {
00235 
00236             <span class="comment">//</span>
00237             <span class="comment">// The caller's mode was kernel so simply store the parameter.</span>
00238             <span class="comment">//</span>
00239 
00240             namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o6">DefaultTimeout</a> = *DefaultTimeout;
00241         }
00242     } <span class="keywordflow">else</span> {
00243 
00244         <span class="comment">//</span>
00245         <span class="comment">// Indicate that no default timeout period was specified.</span>
00246         <span class="comment">//</span>
00247 
00248         namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o7">TimeoutSpecified</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00249     }
00250 
00251     <span class="comment">//</span>
00252     <span class="comment">// Store the remainder of the named pipe-specific parameters in the</span>
00253     <span class="comment">// structure for use in the call to the common create file routine.</span>
00254     <span class="comment">//</span>
00255 
00256     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o0">NamedPipeType</a> = NamedPipeType;
00257     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o1">ReadMode</a> = ReadMode;
00258     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o2">CompletionMode</a> = CompletionMode;
00259     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o3">MaximumInstances</a> = MaximumInstances;
00260     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o4">InboundQuota</a> = InboundQuota;
00261     namedPipeCreateParameters.<a class="code" href="../../d3/d1/struct__NAMED__PIPE__CREATE__PARAMETERS.html#o5">OutboundQuota</a> = OutboundQuota;
00262 
00263     <span class="comment">//</span>
00264     <span class="comment">// Simply perform the remainder of the service by allowing the common</span>
00265     <span class="comment">// file creation code to do the work.</span>
00266     <span class="comment">//</span>
00267 
00268     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/iosubs_8c.html#a46">IoCreateFile</a>( FileHandle,
00269                          DesiredAccess,
00270                          <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>,
00271                          IoStatusBlock,
00272                          (PLARGE_INTEGER) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00273                          0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00274                          ShareAccess,
00275                          CreateDisposition,
00276                          CreateOptions,
00277                          (PVOID) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00278                          0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00279                          <a class="code" href="../../d0/d5/io_8h.html#a600a407">CreateFileTypeNamedPipe</a>,
00280                          &amp;namedPipeCreateParameters,
00281                          0 );
00282 }
00283 
00284 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00285"></a><a class="code" href="../../d1/d8/io_2create_8c.html#a2">00285</a> <a class="code" href="../../d1/d8/io_2create_8c.html#a2">NtCreateMailslotFile</a>(
00286      OUT PHANDLE FileHandle,
00287      IN ULONG DesiredAccess,
00288      IN POBJECT_ATTRIBUTES ObjectAttributes,
00289      OUT PIO_STATUS_BLOCK IoStatusBlock,
00290      ULONG CreateOptions,
00291      IN ULONG MailslotQuota,
00292      IN ULONG MaximumMessageSize,
00293      IN PLARGE_INTEGER ReadTimeout
00294      )
00295 
00296 <span class="comment">/*++</span>
00297 <span class="comment"></span>
00298 <span class="comment">Routine Description:</span>
00299 <span class="comment"></span>
00300 <span class="comment">    Creates and opens the server end handle of a mailslot file.</span>
00301 <span class="comment"></span>
00302 <span class="comment">Arguments:</span>
00303 <span class="comment"></span>
00304 <span class="comment">    FileHandle - Supplies a handle to the file on which the service is being</span>
00305 <span class="comment">        performed.</span>
00306 <span class="comment"></span>
00307 <span class="comment">    DesiredAccess - Supplies the types of access that the caller would like to</span>
00308 <span class="comment">        the file.</span>
00309 <span class="comment"></span>
00310 <span class="comment">    ObjectAttributes - Supplies the attributes to be used for file object</span>
00311 <span class="comment">        (name, SECURITY_DESCRIPTOR, etc.)</span>
00312 <span class="comment"></span>
00313 <span class="comment">    IoStatusBlock - Address of the caller's I/O status block.</span>
00314 <span class="comment"></span>
00315 <span class="comment">    CreateOptions - Caller options for how to perform the create/open.</span>
00316 <span class="comment"></span>
00317 <span class="comment">    MailslotQuota - Specifies the pool quota that is reserved for writes</span>
00318 <span class="comment">        to this mailslot.</span>
00319 <span class="comment"></span>
00320 <span class="comment">    MaximumMessageSize - Specifies the size of the largest message that</span>
00321 <span class="comment">        can be written to this mailslot.</span>
00322 <span class="comment"></span>
00323 <span class="comment">    ReadTimeout - The timeout period for a read operation.  This must</span>
00324 <span class="comment">        be specified as a relative time.</span>
00325 <span class="comment"></span>
00326 <span class="comment">Return Value:</span>
00327 <span class="comment"></span>
00328 <span class="comment">    The function value is the final status of the create operation.</span>
00329 <span class="comment"></span>
00330 <span class="comment">--*/</span>
00331 
00332 {
00333     <a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html">MAILSLOT_CREATE_PARAMETERS</a> mailslotCreateParameters;
00334 
00335     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00336 
00337     <span class="comment">//</span>
00338     <span class="comment">// Check whether or not the DefaultTimeout parameter was specified.  If</span>
00339     <span class="comment">// so, then capture it in the mailslot create parameter structure.</span>
00340     <span class="comment">//</span>
00341 
00342     <span class="keywordflow">if</span> (ARGUMENT_PRESENT( ReadTimeout )) {
00343 
00344         <span class="comment">//</span>
00345         <span class="comment">// Indicate that a read timeout period was specified.</span>
00346         <span class="comment">//</span>
00347 
00348         mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o3">TimeoutSpecified</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00349 
00350         <span class="comment">//</span>
00351         <span class="comment">// A read timeout parameter was specified.  Check to see whether</span>
00352         <span class="comment">// the caller's mode is kernel and if not capture the parameter inside</span>
00353         <span class="comment">// of a try...except clause.</span>
00354         <span class="comment">//</span>
00355 
00356         <span class="keywordflow">if</span> (KeGetPreviousMode() != <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>) {
00357             <span class="keywordflow">try</span> {
00358                 <a class="code" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>( ReadTimeout,
00359                               <span class="keyword">sizeof</span>( LARGE_INTEGER ),
00360                               <span class="keyword">sizeof</span>( ULONG ) );
00361                 mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o2">ReadTimeout</a> = *ReadTimeout;
00362             } except(<a class="code" href="../../d6/d7/halmips_8h.html#a33">EXCEPTION_EXECUTE_HANDLER</a>) {
00363 
00364                 <span class="comment">//</span>
00365                 <span class="comment">// Something went awry attempting to access the parameter.</span>
00366                 <span class="comment">// Get the reason for the error and return it as the status</span>
00367                 <span class="comment">// value from this service.</span>
00368                 <span class="comment">//</span>
00369 
00370                 <span class="keywordflow">return</span> GetExceptionCode();
00371             }
00372         } <span class="keywordflow">else</span> {
00373 
00374             <span class="comment">//</span>
00375             <span class="comment">// The caller's mode was kernel so simply store the parameter.</span>
00376             <span class="comment">//</span>
00377 
00378             mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o2">ReadTimeout</a> = *ReadTimeout;
00379         }
00380     } <span class="keywordflow">else</span> {
00381 
00382         <span class="comment">//</span>
00383         <span class="comment">// Indicate that no default timeout period was specified.</span>
00384         <span class="comment">//</span>
00385 
00386         mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o3">TimeoutSpecified</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00387     }
00388 
00389     <span class="comment">//</span>
00390     <span class="comment">// Store the mailslot-specific parameters in the structure for use</span>
00391     <span class="comment">// in the call to the common create file routine.</span>
00392     <span class="comment">//</span>
00393 
00394     mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o0">MailslotQuota</a> = MailslotQuota;
00395     mailslotCreateParameters.<a class="code" href="../../d2/d6/struct__MAILSLOT__CREATE__PARAMETERS.html#o1">MaximumMessageSize</a> = MaximumMessageSize;
00396 
00397     <span class="comment">//</span>
00398     <span class="comment">// Simply perform the remainder of the service by allowing the common</span>
00399     <span class="comment">// file creation code to do the work.</span>
00400     <span class="comment">//</span>
00401 
00402     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/iosubs_8c.html#a46">IoCreateFile</a>( FileHandle,
00403                          DesiredAccess,
00404                          <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>,
00405                          IoStatusBlock,
00406                          (PLARGE_INTEGER) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00407                          0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00408                          FILE_SHARE_READ | FILE_SHARE_WRITE,
00409                          FILE_CREATE,
00410                          CreateOptions,
00411                          (PVOID) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00412                          0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00413                          <a class="code" href="../../d0/d5/io_8h.html#a600a408">CreateFileTypeMailslot</a>,
00414                          &amp;mailslotCreateParameters,
00415                          0 );
00416 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:35 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
