<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ddemlsvr.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ddemlsvr.h File Reference</h1>
<p>
<a href="../../d3/d3/ddemlsvr_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a0">MF_INTERNAL</a>&nbsp;&nbsp;&nbsp;0x80000000L</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a3">xxxChangeMonitorFlags</a> (<a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmdNew)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a4">xxxCsEvent</a> (<a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> pep, WORD cbEventData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a5">xxxEventWndProc</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a6">xxxProcessDDEMLEvent</a> (<a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii, <a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> pep)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a7">xxxMessageEvent</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndTo, UINT message, WPARAM wParam, LPARAM lParam, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> flag, PDDEML_MSG_HOOK_DATA pdmhd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a8">xxxCsDdeInitialize</a> (PHANDLE phInst, HWND *phwndEvent, LPDWORD pMonitorFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmd, PVOID pcii)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a9">_CsUpdateInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, LPDWORD pMonitorFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a10">_CsDdeUninitialize</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a11">xxxDestroyThreadDDEObject</a> (<a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti, <a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a12">_CsValidateInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a13">ClientEventCallback</a> (PVOID pcii, <a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> pep)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a14">ClientGetDDEHookData</a> (UINT message, LPARAM lParam, PDDEML_MSG_HOOK_DATA pdmhd)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a1">psiiList</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="ddemlsvr.h::MF_INTERNAL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MF_INTERNAL&nbsp;&nbsp;&nbsp;0x80000000L          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00014">14</a> of file <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html">ddemlsvr.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a10" doxytag="ddemlsvr.h::_CsDdeUninitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _CsDdeUninitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00110">110</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, and <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">xxxDestroyThreadDDEObject()</a>.
<p>
<pre class="fragment"><div>00112 {
00113     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00114 
00115     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00116 
00117     psii = <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>(hInst, TYPE_DDEACCESS);
00118     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00119         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00120     }
00121 
00122     <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a11">xxxDestroyThreadDDEObject</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), psii);
00123     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00124 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ddemlsvr.h::_CsUpdateInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> _CsUpdateInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pMonitorFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00088">88</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">MonitorFlags</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02929">NtUserUpdateInstance()</a>.
<p>
<pre class="fragment"><div>00092 {
00093     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00094 
00095     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00096 
00097     psii = (<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>)<a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>(hInst, TYPE_DDEACCESS);
00098     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00099         <span class="keywordflow">return</span> DMLERR_INVALIDPARAMETER;
00100     }
00101     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a8">xxxChangeMonitorFlags</a>(psii, afCmd);
00102     *pMonitorFlags = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00103     <span class="keywordflow">return</span> DMLERR_NO_ERROR;
00104 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ddemlsvr.h::_CsValidateInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID _CsValidateInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ddemlsvr.h::ClientEventCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ClientEventCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pep</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00224">xxxEventWndProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ddemlsvr.h::ClientGetDDEHookData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ClientGetDDEHookData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PDDEML_MSG_HOOK_DATA&nbsp;</td>
          <td class="mdname" nowrap> <em>pdmhd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00320">xxxDDETrackPostHook()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ddemlsvr.h::xxxChangeMonitorFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxChangeMonitorFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmdNew</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">64</a> of file <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html">w32/ntuser/kernel/event.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02950">tagSVR_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00028">aMonitorCount</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00026">C_MONITOR_COUNT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00713">tagEVENT_PACKET::cbEventData</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00714">tagEVENT_PACKET::Data</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00711">tagEVENT_PACKET::EventType</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00023">tagMONITOR_COUNT::flag</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00712">tagEVENT_PACKET::fSense</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00022">tagMONITOR_COUNT::iCount</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00041">MONITORED_FLAGS</a>, <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">MonitorFlags</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00120">xxxCsEvent()</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00088">_CsUpdateInstance()</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">xxxCsDdeInitialize()</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00224">xxxEventWndProc()</a>.
<p>
<pre class="fragment"><div>00067 {
00068     <span class="keywordtype">int</span> i;
00069     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwChangedFlags;
00070     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> OldMonitorFlags;
00071 
00072     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00073 
00074     dwChangedFlags = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> ^ afCmdNew;
00075     <span class="keywordflow">if</span> (!(dwChangedFlags &amp; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a1">MONITORED_FLAGS</a>)) {
00076         <span class="keywordflow">return</span>;
00077     }
00078     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> = afCmdNew;
00079 
00080     OldMonitorFlags = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00081     <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a> = 0;
00082     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a0">C_MONITOR_COUNT</a>; i++) {
00083         <span class="keywordflow">if</span> (dwChangedFlags &amp; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o1">flag</a>) {
00084             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o1">flag</a> &amp; afCmdNew) {
00085                 <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o0">iCount</a>++;
00086             } <span class="keywordflow">else</span> {
00087                 <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o0">iCount</a>--;
00088             }
00089         }
00090         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o0">iCount</a>) {
00091             <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a> |= <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a7">aMonitorCount</a>[i].<a class="code" href="../../d1/d2/structtagMONITOR__COUNT.html#o1">flag</a>;
00092         }
00093     }
00094     <span class="keywordflow">if</span> (OldMonitorFlags != <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>) {
00095         <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a> ep;
00096 
00097         ep.<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o0">EventType</a> = 0;
00098         ep.<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o1">fSense</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00099         ep.<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o2">cbEventData</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>);
00100         ep.<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o3">Data</a> = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00101         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a9">xxxCsEvent</a>(&amp;ep, <span class="keyword">sizeof</span>(DWORD));
00102     }
00103 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ddemlsvr.h::xxxCsDdeInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> xxxCsDdeInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PHANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>phInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND *&nbsp;</td>
          <td class="mdname" nowrap> <em>phwndEvent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pMonitorFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">19</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02744">CW_FLAGS_DIFFHMOD</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00689">GWLP_PSII</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00828">HMAllocObject()</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00734">hModuleWin</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00355">ICLS_DDEMLEVENT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">MonitorFlags</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02949">tagSVR_INSTANCE_INFO::nextInThisThread</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03356">tagTHREADINFO::psiiList</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02951">tagSVR_INSTANCE_INFO::spwndEvent</a>, <a class="el" href="../../d4/d1/userk_8h.html#a850">SVR_INSTANCE_INFO</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00476">VER31</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l00033">xxxCreateWindowEx()</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l05787">xxxSetWindowLongPtr</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>.
<p>
<pre class="fragment"><div>00025 {
00026     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00027     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>        ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00028 
00029     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00030 
00031     psii = (<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>)<a class="code" href="../../d4/d1/userk_8h.html#a969">HMAllocObject</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), NULL,
00032             TYPE_DDEACCESS, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">SVR_INSTANCE_INFO</a>));
00033     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00034         <span class="keywordflow">return</span> DMLERR_SYS_ERROR;
00035     }
00036 
00037     <span class="comment">/*</span>
00038 <span class="comment">     * We have to tell CreateWindow that window is not created for the same</span>
00039 <span class="comment">     * module has the app, (CW_FLAGS_DIFFHMOD), so CreateWindow doesn't</span>
00040 <span class="comment">     * assign a hotkey to this window.  Other window are done in the</span>
00041 <span class="comment">     * client-server thunk</span>
00042 <span class="comment">     */</span>
00043     <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>(&amp;(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>), <a class="code" href="../../d4/d8/createw_8c.html#a1">xxxCreateWindowEx</a>(
00044             0,
00045             (<a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLEVENT],
00046             NULL,
00047             WS_POPUP | WS_CHILD,
00048             0, 0, 0, 0,
00049             (<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>)NULL,
00050             (<a class="code" href="../../d1/d1/structtagMENU.html">PMENU</a>)NULL,
00051             hModuleWin,
00052             NULL,
00053             CW_FLAGS_DIFFHMOD | VER31));
00054 
00055     <span class="keywordflow">if</span> (psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00056         <a class="code" href="../../d4/d1/userk_8h.html#a970">HMFreeObject</a>((PVOID)psii);
00057         <span class="keywordflow">return</span> DMLERR_SYS_ERROR;
00058     }
00059     <span class="comment">/*</span>
00060 <span class="comment">     * This GWL offset does NOT leave the critical section!</span>
00061 <span class="comment">     */</span>
00062     <a class="code" href="../../d4/d1/userk_8h.html#a586">xxxSetWindowLongPtr</a>(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>, GWLP_PSII, (LONG_PTR)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii), FALSE);
00063     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> = 0;
00064     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o5">pcii</a> = pcii;
00065     <span class="comment">//</span>
00066     <span class="comment">// Link into global list</span>
00067     <span class="comment">//</span>
00068     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> = <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>;
00069     <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a> = psii;
00070 
00071     <span class="comment">//</span>
00072     <span class="comment">// Link into per-process list</span>
00073     <span class="comment">//</span>
00074     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> = ptiCurrent-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>;
00075     ptiCurrent-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a> = psii;
00076 
00077     *phInst = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii);
00078     *phwndEvent = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii-&gt;spwndEvent);
00079     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a8">xxxChangeMonitorFlags</a>(psii, afCmd);        <span class="comment">// sets psii-&gt;afCmd;</span>
00080     *pMonitorFlags = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00081     <span class="keywordflow">return</span> DMLERR_NO_ERROR;
00082 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ddemlsvr.h::xxxCsEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> xxxCsEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pep</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>cbEventData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00120">120</a> of file <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html">w32/ntuser/kernel/event.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02950">tagSVR_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00713">tagEVENT_PACKET::cbEventData</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00711">tagEVENT_PACKET::EventType</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00712">tagEVENT_PACKET::fSense</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02948">tagSVR_INSTANCE_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02951">tagSVR_INSTANCE_INFO::spwndEvent</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00365">ThreadLockAlwaysWithPti</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01704">ThreadLockPool</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01710">ThreadUnlockAndFreePool</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00688">xxxSendMessage()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02956">NtUserEvent()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00275">xxxMessageEvent()</a>.
<p>
<pre class="fragment"><div>00122 {
00123     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psiiT;
00124     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> pep2;
00125     HWND *ahwndEvent = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00126     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00127     <span class="keywordtype">int</span> cHwndAllocated, i, cTargets;
00128     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwnd;
00129     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpep2;
00130     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlahwndEvent;
00131     ULONG cbEventPacket;
00132     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00133 
00134     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00135 
00136     <span class="comment">/*</span>
00137 <span class="comment">     * Copy pep info to a server side stable area</span>
00138 <span class="comment">     */</span>
00139     cbEventPacket = cbEventData + <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>);
00140     pep2 = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)UserAllocPoolWithQuota(cbEventPacket, TAG_DDE5);
00141     <span class="keywordflow">if</span> (pep2 == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00142         <span class="keywordflow">return</span> DMLERR_MEMORY_ERROR;
00143     }
00144     <span class="keywordflow">try</span> {
00145         RtlCopyMemory((LPSTR)pep2, (LPSTR)pep, cbEventPacket);
00146     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00147         UserFreePool(pep2);
00148         <span class="keywordflow">return</span> DMLERR_INVALIDPARAMETER;
00149     }
00150 
00151     pep2-&gt;<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o2">cbEventData</a> = cbEventData;
00152     cTargets = 0;
00153     cHwndAllocated = 0;
00154 
00155     <span class="keywordflow">for</span> (psiiT = <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>; psiiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; psiiT =  psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>) {
00156         <span class="comment">//</span>
00157         <span class="comment">// Don't bother with event windows for instances who's flags</span>
00158         <span class="comment">// indicate they're not interrested in the event.</span>
00159         <span class="comment">//</span>
00160         <span class="keywordflow">if</span> (((psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> &amp; pep2-&gt;<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o0">EventType</a>) &amp;&amp; !pep2-&gt;<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o1">fSense</a>) ||
00161                 (!(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> &amp; pep2-&gt;<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o0">EventType</a>) &amp;&amp; pep2-&gt;<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html#o1">fSense</a>)) {
00162             <span class="keywordflow">continue</span>;
00163         }
00164 
00165         <span class="keywordflow">if</span> (cTargets &gt;= cHwndAllocated) {
00166             <span class="keywordflow">if</span> (ahwndEvent == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00167                 cHwndAllocated = 8;
00168                 ahwndEvent = (HWND *)UserAllocPoolWithQuota(
00169                         <span class="keyword">sizeof</span>(HWND) * cHwndAllocated,
00170                         TAG_DDE6);
00171             } <span class="keywordflow">else</span> {
00172                 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwSize = cHwndAllocated * <span class="keyword">sizeof</span>(HWND);
00173                 HWND *ahwndEventT = ahwndEvent;
00174 
00175                 cHwndAllocated += 8;
00176                 ahwndEvent = (HWND *)UserReAllocPoolWithQuota(ahwndEvent, dwSize,
00177                         <span class="keyword">sizeof</span>(HWND) * cHwndAllocated, TAG_DDE7);
00178                 <span class="keywordflow">if</span> (ahwndEvent == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00179                     UserFreePool(ahwndEventT);
00180                 }
00181             }
00182             <span class="keywordflow">if</span> (ahwndEvent == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00183                 UserFreePool(pep2);
00184                 <span class="keywordflow">return</span> DMLERR_MEMORY_ERROR;
00185             }
00186         }
00187         ahwndEvent[cTargets++] = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>);
00188     }
00189 
00190     <a class="code" href="../../d4/d1/userk_8h.html#a137">ThreadLockPool</a>(pti, pep2, &amp;tlpep2);
00191     <span class="keywordflow">if</span> (ahwndEvent != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00192         <a class="code" href="../../d4/d1/userk_8h.html#a137">ThreadLockPool</a>(pti, ahwndEvent, &amp;tlahwndEvent);
00193         <span class="keywordflow">for</span> (i = 0; i &lt; cTargets; i++) {
00194             <span class="comment">/*</span>
00195 <span class="comment">             * We need to change contexts for the callback</span>
00196 <span class="comment">             */</span>
00197             pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(ahwndEvent[i]);
00198             <span class="keywordflow">if</span> (pwnd != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00199                 <a class="code" href="../../d6/d0/usercli_8h.html#a39">ThreadLockAlwaysWithPti</a>(pti, pwnd, &amp;tlpwnd);
00200                 <a class="code" href="../../d4/d1/userk_8h.html#a1579">xxxSendMessage</a>(pwnd, WM_DDEMLEVENT, 0, (LPARAM)pep2);
00201                 <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwnd);
00202             }
00203         }
00204         <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(pti, &amp;tlahwndEvent);
00205     }
00206     <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(pti, &amp;tlpep2);
00207 
00208     <span class="keywordflow">return</span> DMLERR_NO_ERROR;
00209 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ddemlsvr.h::xxxDestroyThreadDDEObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxDestroyThreadDDEObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pti</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psii</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">127</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01477">HMIsMarkDestroy</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01237">HMMarkObjectDestroy()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02948">tagSVR_INSTANCE_INFO::next</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02949">tagSVR_INSTANCE_INFO::nextInThisThread</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03356">tagTHREADINFO::psiiList</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02951">tagSVR_INSTANCE_INFO::spwndEvent</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00368">Unlock</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d5/d7/createw_8c-source.html#l01591">xxxDestroyWindow()</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00110">_CsDdeUninitialize()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l02552">xxxDestroyThreadInfo()</a>.
<p>
<pre class="fragment"><div>00130 {
00131     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psiiT;
00132 
00133     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00134 
00135     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a438">HMIsMarkDestroy</a>(psii)) {
00136         <span class="keywordflow">return</span>;
00137     }
00138 
00139     <span class="comment">//</span>
00140     <span class="comment">// Unlink psii from the global list.</span>
00141     <span class="comment">//</span>
00142     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>) {
00143         <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>;
00144     } <span class="keywordflow">else</span> {
00145         <span class="keywordflow">for</span> (psiiT = <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>; psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> != psii; psiiT = psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>) {
00146             UserAssert(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> != NULL);
00147         }
00148         psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>;
00149     }
00150     <span class="comment">// psii-&gt;next = NULL;</span>
00151 
00152     <span class="comment">//</span>
00153     <span class="comment">// Unlink psii from the per-process list.</span>
00154     <span class="comment">//</span>
00155     <span class="keywordflow">if</span> (psii == pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>) {
00156         pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>;
00157     } <span class="keywordflow">else</span> {
00158         <span class="keywordflow">for</span> (psiiT = pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>; psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> != psii; psiiT = psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>) {
00159             UserAssert(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> != NULL);
00160         }
00161         psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>;
00162     }
00163     <span class="comment">// psii-&gt;nextInThisThread = NULL;</span>
00164 
00165     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a971">HMMarkObjectDestroy</a>(psii)) {
00166         <a class="code" href="../../d4/d1/userk_8h.html#a1575">xxxDestroyWindow</a>(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>);
00167         <a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>));
00168 
00169         <a class="code" href="../../d4/d1/userk_8h.html#a970">HMFreeObject</a>(psii);
00170     }
00171 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ddemlsvr.h::xxxEventWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT xxxEventWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00224">224</a> of file <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html">w32/ntuser/kernel/event.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l01191">_GetWindowLongPtr</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02950">tagSVR_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d2/d4/ddemlsvr_8h.html#a13">ClientEventCallback()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00689">GWLP_PSII</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02952">tagSVR_INSTANCE_INFO::pcii</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>, and <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01863">LW_RegisterWindows()</a>.
<p>
<pre class="fragment"><div>00229 {
00230     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00231 
00232     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00233     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwnd);
00234 
00235     psii = <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>((HANDLE)<a class="code" href="../../d6/d0/usercli_8h.html#a165">_GetWindowLongPtr</a>(pwnd, GWLP_PSII),
00236                                  TYPE_DDEACCESS);
00237     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00238         <span class="keywordflow">goto</span> CallDWP;
00239     }
00240 
00241     <span class="keywordflow">switch</span> (message) {
00242     <span class="keywordflow">case</span> WM_DDEMLEVENT:
00243 <span class="preprocessor">#define pep ((PEVENT_PACKET)lParam)</span>
00244 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (((psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> &amp; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType) &amp;&amp; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense) ||
00245                 (!(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> &amp; <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType) &amp;&amp; !<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense)) {
00246             <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a13">ClientEventCallback</a>(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o5">pcii</a>, pep);
00247         }
00248 <span class="preprocessor">#undef pep</span>
00249 <span class="preprocessor"></span>        <span class="keywordflow">break</span>;
00250 
00251     <span class="keywordflow">case</span> WM_DESTROY:
00252         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a8">xxxChangeMonitorFlags</a>(psii, 0);
00253         <span class="keywordflow">break</span>;
00254 
00255     <span class="keywordflow">default</span>:
00256 CallDWP:
00257         <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a1632">xxxDefWindowProc</a>(pwnd, message, wParam, lParam);
00258     }
00259     <span class="keywordflow">return</span> 0;
00260 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ddemlsvr.h::xxxMessageEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxMessageEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndTo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PDDEML_MSG_HOOK_DATA&nbsp;</td>
          <td class="mdname" nowrap> <em>pdmhd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00275">275</a> of file <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html">w32/ntuser/kernel/event.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01547">GETPTI</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00194">RevalidateHwnd</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01704">ThreadLockPool</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01710">ThreadUnlockAndFreePool</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00120">xxxCsEvent()</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00320">xxxDDETrackPostHook()</a>, and <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00147">xxxDDETrackSendHook()</a>.
<p>
<pre class="fragment"><div>00282 {
00283     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00284     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwndFrom;
00285     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpep;
00286     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti;
00287 
00288     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00289 
00290     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)UserAllocPoolWithQuota(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) -
00291             <span class="keyword">sizeof</span>(DWORD) + <span class="keyword">sizeof</span>(MONMSGSTRUCT), TAG_DDE8);
00292     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00293         <span class="keywordflow">return</span>;
00294     }
00295     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType = flag;
00296     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00297     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData = <span class="keyword">sizeof</span>(MONMSGSTRUCT);
00298 <span class="preprocessor">#define pmsgs ((MONMSGSTRUCT *)&amp;pep-&gt;Data)</span>
00299 <span class="preprocessor"></span>    <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;cb = <span class="keyword">sizeof</span>(MONMSGSTRUCT);
00300     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;hwndTo = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(pwndTo);
00301     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;dwTime = <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00302 
00303     pwndFrom = <a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>((HWND)wParam);
00304     <span class="keywordflow">if</span> (pwndFrom != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00305         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;hTask = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a455">GETPTI</a>(pwndFrom)-&gt;pEThread-&gt;Cid.UniqueThread;
00306     } <span class="keywordflow">else</span> {
00307         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;hTask = 0;
00308     }
00309 
00310     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;wMsg = message;
00311     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;wParam = wParam;
00312     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;lParam = lParam;
00313     <span class="keywordflow">if</span> (pdmhd != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00314         <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a3">pmsgs</a>-&gt;dmhd = *pdmhd;
00315     }
00316 <span class="preprocessor">#undef pmsgs</span>
00317 <span class="preprocessor"></span>    pti = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00318     <a class="code" href="../../d4/d1/userk_8h.html#a137">ThreadLockPool</a>(pti, pep, &amp;tlpep);
00319     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a9">xxxCsEvent</a>(pep, <span class="keyword">sizeof</span>(MONMSGSTRUCT));
00320     <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(pti, &amp;tlpep);
00321 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ddemlsvr.h::xxxProcessDDEMLEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxProcessDDEMLEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pep</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="ddemlsvr.h::MonitorFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a4">MonitorFlags</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">19</a> of file <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html">ddemlsvr.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00088">_CsUpdateInstance()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">xxxCsDdeInitialize()</a>, <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00320">xxxDDETrackPostHook()</a>, and <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00147">xxxDDETrackSendHook()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ddemlsvr.h::psiiList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> <a class="el" href="../../d2/d4/ddemlsvr_8h.html#a1">psiiList</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00018">18</a> of file <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html">ddemlsvr.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">xxxCsDdeInitialize()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00120">xxxCsEvent()</a>, and <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">xxxDestroyThreadDDEObject()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:24 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
