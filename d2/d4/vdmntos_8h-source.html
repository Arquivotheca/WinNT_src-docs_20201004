<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: vdmntos.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>vdmntos.h</h1><a href="../../d1/d5/vdmntos_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1991  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    vdmntos.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This is the include file for the vdm component.  It describes the kernel</span>
00012 <span class="comment">    mode visible portions of the vdm component.  The \nt\private\inc\vdm.h</span>
00013 <span class="comment">    file describes the portions that are usermode visible.</span>
00014 <span class="comment"></span>
00015 <span class="comment">Author:</span>
00016 <span class="comment"></span>
00017 <span class="comment">    Dave Hastings (daveh) 02-Feb-1992</span>
00018 <span class="comment"></span>
00019 <span class="comment">Revision History:</span>
00020 <span class="comment"></span>
00021 <span class="comment">--*/</span>
00022 
00023 <span class="preprocessor">#ifndef _VDMNTOS_</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#define _VDMNTOS_</span>
00025 <span class="preprocessor"></span>
00026 <span class="comment">//</span>
00027 <span class="comment">// Need this #include here because non-x86 ntos\vdm\vdm.c</span>
00028 <span class="comment">// references structures defined there.</span>
00029 <span class="comment">//</span>
00030 
00031 <span class="preprocessor">#include "..\..\inc\vdm.h"</span>
00032 
00033 <span class="preprocessor">#if defined(i386)</span>
00034 <span class="preprocessor"></span>
00035 <span class="keyword">typedef</span> <span class="keyword">struct </span>_VDM_IO_LISTHEAD {
00036     PVDM_IO_HANDLER VdmIoHandlerList;
00037     <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>       VdmIoResource;
00038     ULONG           Context;
00039 } VDM_IO_LISTHEAD, *PVDM_IO_LISTHEAD;
00040 
00041 
00042 <span class="keyword">typedef</span> <span class="keyword">struct </span>_VDM_PROCESS_OBJECTS {
00043     PVDM_IO_LISTHEAD VdmIoListHead;
00044     <a class="code" href="../../d1/d5/struct__KAPC.html">KAPC</a>             QueuedIntApc;
00045     <a class="code" href="../../d1/d5/struct__KAPC.html">KAPC</a>             QueuedIntUserApc;
00046     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>       DelayIntFastMutex;
00047     KSPIN_LOCK       DelayIntSpinLock;
00048     LIST_ENTRY       DelayIntListHead;
00049     PVDMICAUSERDATA  pIcaUserData;
00050     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>         MainThread;
00051     <a class="code" href="../../d0/d6/struct__Vdm__Tib.html">PVDM_TIB</a>         VdmTib;
00052     PUCHAR           PrinterState;
00053     PUCHAR           PrinterControl;
00054     PUCHAR           PrinterStatus;
00055     PUCHAR           PrinterHostState;
00056 } VDM_PROCESS_OBJECTS, *PVDM_PROCESS_OBJECTS;
00057 
00058 
00059 <span class="keyword">typedef</span> <span class="keyword">struct </span>_DelayInterruptsIrq {
00060     LIST_ENTRY  DelayIntListEntry;
00061     ULONG       IrqLine;
00062     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>    Thread;
00063     <a class="code" href="../../d1/d6/struct__KDPC.html">KDPC</a>        Dpc;
00064     <a class="code" href="../../d1/d5/struct__KAPC.html">KAPC</a>        Apc;
00065     <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>      Timer;
00066     BOOLEAN     InUse;
00067     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>    MainThread;
00068 } DELAYINTIRQ, *PDELAYINTIRQ;
00069 
00070 <span class="preprocessor">#define VDMDELAY_NOTINUSE 0</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#define VDMDELAY_KTIMER   1</span>
00072 <span class="preprocessor"></span><span class="preprocessor">#define VDMDELAY_PTIMER   2</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define VDMDELAY_KAPC     3</span>
00074 <span class="preprocessor"></span>
00075 
00076 BOOLEAN
00077 <a class="code" href="../../d3/d2/i386_2psvdm_8c.html#a10">Ps386GetVdmIoHandler</a>(
00078     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00079     IN ULONG PortNumber,
00080     OUT PVDM_IO_HANDLER VdmIoHandler,
00081     OUT PULONG Context
00082     );
00083 
00084 <span class="preprocessor">#define SEL_TYPE_READ       0x00000001</span>
00085 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_WRITE      0x00000002</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_EXECUTE    0x00000004</span>
00087 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_BIG        0x00000008</span>
00088 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_ED         0x00000010</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_2GIG       0x00000020</span>
00090 <span class="preprocessor"></span><span class="preprocessor">#define SEL_TYPE_NP         0x00000040</span>
00091 <span class="preprocessor"></span>
00092 <span class="comment">// NPX error exception dispatcher</span>
00093 BOOLEAN
00094 <a class="code" href="../../d0/d5/vdmnpx_8c.html#a4">VdmDispatchIRQ13</a>(
00095     PKTRAP_FRAME TrapFrame
00096     );
00097 
00098 BOOLEAN
00099 <a class="code" href="../../d0/d5/vdmnpx_8c.html#a5">VdmSkipNpxInstruction</a>(
00100     PKTRAP_FRAME TrapFrame,
00101     ULONG        Address32Bits,
00102     PUCHAR       istream,
00103     ULONG        InstructionSize
00104     );
00105 
00106 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00107 <a class="code" href="../../d7/d7/strtexec_8c.html#a1">VdmEndExecution</a>(
00108     PKTRAP_FRAME TrapFrame,
00109     <a class="code" href="../../d0/d6/struct__Vdm__Tib.html">PVDM_TIB</a> VdmTib
00110     );
00111 
00112 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00113 <a class="code" href="../../d9/d4/vdmints_8c.html#a16">VdmDispatchInterrupts</a>(
00114     PKTRAP_FRAME TrapFrame,
00115     <a class="code" href="../../d0/d6/struct__Vdm__Tib.html">PVDM_TIB</a>     VdmTib
00116     );
00117 
00118 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00119 VdmDispatchException(
00120      PKTRAP_FRAME TrapFrame,
00121      NTSTATUS     ExcepCode,
00122      PVOID        ExcepAddress,
00123      ULONG        NumParms,
00124      ULONG        Parm1,
00125      ULONG        Parm2,
00126      ULONG        Parm3
00127      );
00128 
00129 <span class="preprocessor">#define VdmGetTrapFrame(pKThread) \</span>
00130 <span class="preprocessor">        ((PKTRAP_FRAME)( (PUCHAR)(pKThread)-&gt;InitialStack -              \</span>
00131 <span class="preprocessor">                         sizeof(FX_SAVE_AREA) -                          \</span>
00132 <span class="preprocessor">                         ((ULONG)(sizeof(KTRAP_FRAME)+KTRAP_FRAME_ROUND) \</span>
00133 <span class="preprocessor">                           &amp; ~(KTRAP_FRAME_ROUND))                       \</span>
00134 <span class="preprocessor">                        )                                                \</span>
00135 <span class="preprocessor">         )</span>
00136 <span class="preprocessor"></span>
00137 <span class="comment">//</span>
00138 <span class="comment">// These values are defined here to describe the structure of an array</span>
00139 <span class="comment">// containing running counts of v86 opcode emulation. The array lives in</span>
00140 <span class="comment">// ke\i386, but is referenced in ex.</span>
00141 <span class="comment">//</span>
00142 <span class="preprocessor">#define VDM_INDEX_Invalid             0</span>
00143 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_0F                  1</span>
00144 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_ESPrefix            2</span>
00145 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_CSPrefix            3</span>
00146 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_SSPrefix            4</span>
00147 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_DSPrefix            5</span>
00148 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_FSPrefix            6</span>
00149 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_GSPrefix            7</span>
00150 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OPER32Prefix        8</span>
00151 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_ADDR32Prefix        9</span>
00152 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INSB               10</span>
00153 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INSW               11</span>
00154 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTSB              12</span>
00155 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTSW              13</span>
00156 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_PUSHF              14</span>
00157 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_POPF               15</span>
00158 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INTnn              16</span>
00159 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INTO               17</span>
00160 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_IRET               18</span>
00161 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_NPX                19</span>
00162 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INBimm             20</span>
00163 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INWimm             21</span>
00164 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTBimm            22</span>
00165 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTWimm            23</span>
00166 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INB                24</span>
00167 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_INW                25</span>
00168 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTB               26</span>
00169 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_OUTW               27</span>
00170 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_LOCKPrefix         28</span>
00171 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_REPNEPrefix        29</span>
00172 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_REPPrefix          30</span>
00173 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_CLI                31</span>
00174 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_STI                32</span>
00175 <span class="preprocessor"></span><span class="preprocessor">#define VDM_INDEX_HLT                33</span>
00176 <span class="preprocessor"></span>
00177 <span class="comment">// The following value must be 1 more than the last defined index value</span>
00178 <span class="preprocessor">#define MAX_VDM_INDEX                34</span>
00179 <span class="preprocessor"></span>
00180 <span class="comment">//</span>
00181 <span class="comment">// This is the address of the Vdm communication area.  It's in ke\i386\vdm.c</span>
00182 <span class="comment">//</span>
00183 
00184 <span class="keyword">extern</span> ULONG <a class="code" href="../../d9/d3/ke_2i386_2vdm_8c.html#a3">VdmFixedStateLinear</a>;
00185 
00186 <span class="preprocessor">#define FIXED_NTVDMSTATE_LINEAR_PC_AT   0x714</span>
00187 <span class="preprocessor"></span><span class="preprocessor">#define FIXED_NTVDMSTATE_LINEAR_PC_98   0x614</span>
00188 <span class="preprocessor"></span>
00189 <span class="preprocessor">#endif // i386</span>
00190 <span class="preprocessor"></span><span class="preprocessor">#endif // _VDMNTOS_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:22 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
