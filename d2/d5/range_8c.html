<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: range.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>range.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>
<code>#include "<a class="el" href="../../d4/d4/range_8h-source.html">range.h</a>"</code><br>

<p>
<a href="../../d3/d4/range_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a0">RtlpDumpRangeListEntry</a>(Level, Entry, Indent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a1">RtlpDumpRangeList</a>(Level, RangeList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a2">RtlpAllocateRangeListEntry</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(Entry)&nbsp;&nbsp;&nbsp;RtlFreeHeap( RtlProcessHeap(), 0, (Entry) )</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a4">RtlpRangeListAllocatePool</a>(<a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)&nbsp;&nbsp;&nbsp;RtlAllocateHeap(RtlProcessHeap(), RTL_RANGE_LIST_MISC_TAG, (<a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a5">RtlpRangeListFreePool</a>(Free)&nbsp;&nbsp;&nbsp;RtlFreeHeap( RtlProcessHeap(), 0, (Free) )</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a6">RtlpAddRange</a> (IN OUT PLIST_ENTRY ListHead, IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry, IN ULONG AddRangeFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a> (IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Merged, IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry, IN ULONG AddRangeFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a8">RtlpConvertToMergedRange</a> (IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a9">RtlpCreateRangeListEntry</a> (IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a15">End</a>, IN UCHAR Attributes, IN PVOID UserData, IN PVOID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a10">RtlpAddIntersectingRanges</a> (IN PLIST_ENTRY ListHead, IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> First, IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry, IN ULONG AddRangeFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a11">RtlpDeleteFromMergedRange</a> (IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Delete, IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Merged)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a12">RtlpCopyRangeListEntry</a> (<a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a13">RtlpDeleteRangeListEntry</a> (IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a14">RtlpIsRangeAvailable</a> (IN PRTL_RANGE_LIST_ITERATOR Iterator, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a15">End</a>, IN UCHAR AttributeAvailableMask, IN BOOLEAN SharedOK, IN BOOLEAN NullConflictOK, IN BOOLEAN Forward, IN PVOID Context OPTIONAL, IN PRTL_CONFLICT_RANGE_CALLBACK Callback OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a15">RtlInitializeRangeList</a> (IN OUT PRTL_RANGE_LIST RangeList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a> (IN OUT PRTL_RANGE_LIST RangeList, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a15">End</a>, IN UCHAR Attributes, IN ULONG Flags, IN PVOID UserData, OPTIONAL IN PVOID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a> OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a17">RtlDeleteRange</a> (IN OUT PRTL_RANGE_LIST RangeList, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a15">End</a>, IN PVOID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a18">RtlDeleteOwnersRanges</a> (IN OUT PRTL_RANGE_LIST RangeList, IN PVOID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a19">RtlCopyRangeList</a> (OUT PRTL_RANGE_LIST CopyRangeList, IN PRTL_RANGE_LIST RangeList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a20">RtlFreeRangeList</a> (IN PRTL_RANGE_LIST RangeList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a21">RtlIsRangeAvailable</a> (IN PRTL_RANGE_LIST RangeList, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>, IN ULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a15">End</a>, IN ULONG Flags, IN UCHAR AttributeAvailableMask, IN PVOID Context OPTIONAL, IN PRTL_CONFLICT_RANGE_CALLBACK Callback OPTIONAL, OUT PBOOLEAN Available)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a22">RtlFindRange</a> (IN PRTL_RANGE_LIST RangeList, IN ULONGLONG Minimum, IN ULONGLONG Maximum, IN ULONG Length, IN ULONG Alignment, IN ULONG Flags, IN UCHAR AttributeAvailableMask, IN PVOID Context OPTIONAL, IN PRTL_CONFLICT_RANGE_CALLBACK Callback OPTIONAL, OUT PULONGLONG <a class="el" href="../../d5/d2/config_2ia64_2initia64_8c.html#a14">Start</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a23">RtlGetFirstRange</a> (IN PRTL_RANGE_LIST RangeList, OUT PRTL_RANGE_LIST_ITERATOR Iterator, OUT PRTL_RANGE *Range)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a24">RtlGetLastRange</a> (IN PRTL_RANGE_LIST RangeList, OUT PRTL_RANGE_LIST_ITERATOR Iterator, OUT PRTL_RANGE *Range)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a> (IN OUT PRTL_RANGE_LIST_ITERATOR Iterator, OUT PRTL_RANGE *Range, IN BOOLEAN MoveForwards)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a26">RtlMergeRangeLists</a> (OUT PRTL_RANGE_LIST MergedRangeList, IN PRTL_RANGE_LIST RangeList1, IN PRTL_RANGE_LIST RangeList2, IN ULONG Flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d5/range_8c.html#a27">RtlInvertRangeList</a> (OUT PRTL_RANGE_LIST InvertedRangeList, IN PRTL_RANGE_LIST RangeList)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="range.c::RtlpAllocateRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpAllocateRangeListEntry          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>) <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a0">RtlAllocateHeap</a>(                           \
        RtlProcessHeap(),                                               \
        RTL_RANGE_LIST_ENTRY_TAG,                                       \
        <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>)                                   \
        )
</div></pre>
<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00267">267</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01467">RtlpCopyRangeListEntry()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l00771">RtlpCreateRangeListEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="range.c::RtlpDumpRangeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpDumpRangeList          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Level,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>RangeList&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00121">121</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="range.c::RtlpDumpRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpDumpRangeListEntry          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Level,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Entry,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Indent&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00120">120</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="range.c::RtlpFreeRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpFreeRangeListEntry          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Entry&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlFreeHeap( RtlProcessHeap(), 0, (Entry) )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00280">280</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00340">RtlAddRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01197">RtlDeleteOwnersRanges()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01071">RtlDeleteRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00843">RtlpAddIntersectingRanges()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01311">RtlpDeleteFromMergedRange()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01647">RtlpDeleteRangeListEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="range.c::RtlpRangeListAllocatePool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpRangeListAllocatePool          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlAllocateHeap(RtlProcessHeap(), RTL_RANGE_LIST_MISC_TAG, (<a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00289">289</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="range.c::RtlpRangeListFreePool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RtlpRangeListFreePool          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Free&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlFreeHeap( RtlProcessHeap(), 0, (Free) )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00298">298</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a16" doxytag="range.c::RtlAddRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlAddRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>End</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>UserData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OPTIONAL IN PVOID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00340">340</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00100">_RTLP_RANGE_LIST_ENTRY::PublicFlags</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00461">RtlpAddRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00771">RtlpCreateRangeListEntry()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>, and <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02189">ArbAddAllocation()</a>, <a class="el" href="../../d9/d8/pnpbusno_8c-source.html#l00089">IopBusNumberInitialize()</a>, <a class="el" href="../../d4/d0/pnpmemio_8c-source.html#l00396">IopMemInitialize()</a>, <a class="el" href="../../d4/d0/pnpmemio_8c-source.html#l01146">IopPortAddAllocation()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l02599">RtlInvertRangeList()</a>.
<p>
<pre class="fragment"><div>00351                    :
00352 
00353     This routine adds a <span class="keyword">new</span> range with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified properties to a range list.
00354 
00355 Arguments:
00356 
00357     RangeList - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list to which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be added.
00358         It must have been previously initialized <span class="keyword">using</span> <a class="code" href="../../d2/d5/range_8c.html#a15">RtlInitializeRangeList</a>.
00359 
00360     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range.
00361 
00362     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range.
00363 
00364     Flags - These determine <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range's properties and how <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> added:
00365 
00366         RTL_RANGE_LIST_ADD_IF_CONFLICT - The range should be added even <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>
00367             overlaps another range.  In <span class="keyword">this</span> <span class="keywordflow">case</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> RTL_RANGE_CONFLICT flag
00368             <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set.
00369 
00370         RTL_RANGE_LIST_ADD_SHARED - The range <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> marked as an RTL_RANGE_SHARED
00371             and will successfully be added <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> overlaps another shared range.
00372             It can be speficied in conjunction with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> above ADD_IF_CONFLICT
00373             flag in which <span class="keywordflow">case</span> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range overlaps a non-shared range <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> will
00374             be marked as both RTL_RANGE_SHARED and RTL_RANGE_CONFLICT.
00375 
00376     UserData - Extra data to be stored with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range.  The system will not
00377         attempt to interpret <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00378 
00379     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> cookie that represents <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entity that owns <span class="keyword">this</span> range.  (<a class="code" href="../../d2/d1/bench_8h.html#a5">A</a>
00380         pointer to some object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> most likley).  The system will not
00381         attempt to interpret <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>, just use <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> to distinguish <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range from
00382         another with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same start and end.
00383 
00384 Return Value:
00385 
00386     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
00387 
00388     STATUS_INVALID_PARAMETER
00389     STATUS_RANGE_LIST_CONFLICT
00390     STATUS_INSUFFICIENT_RESOURCES
00391 
00392 --*/
00393 {
00394 
00395     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00396     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> newEntry = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00397 
00398     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00399 
00400     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
00401         (<span class="stringliteral">"RtlAddRange(0x%08x, 0x%I64x, 0x%I64x, 0x%08x, 0x%08x, 0x%08x)\n"</span>,
00402         RangeList,
00403         Start,
00404         End,
00405         Flags,
00406         UserData,
00407         Owner
00408         ));
00409 
00410     <span class="comment">//</span>
00411     <span class="comment">// Validate parameters</span>
00412     <span class="comment">//</span>
00413 
00414     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> &lt; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>) {
00415         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
00416     }
00417 
00418     <span class="comment">//</span>
00419     <span class="comment">// Create a new entry</span>
00420     <span class="comment">//</span>
00421 
00422     <span class="keywordflow">if</span> (!(newEntry = <a class="code" href="../../d2/d5/range_8c.html#a9">RtlpCreateRangeListEntry</a>(Start, End, Attributes, UserData, Owner))) {
00423         <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;
00424     }
00425 
00426     <span class="comment">//</span>
00427     <span class="comment">// Mark the new entry as shared if appropriate</span>
00428     <span class="comment">//</span>
00429 
00430     <span class="keywordflow">if</span> (Flags &amp; RTL_RANGE_LIST_ADD_SHARED) {
00431         newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o8">PublicFlags</a> |= RTL_RANGE_SHARED;
00432     }
00433 
00434     status = <a class="code" href="../../d2/d5/range_8c.html#a6">RtlpAddRange</a>(&amp;RangeList-&gt;ListHead,
00435                         newEntry,
00436                         Flags
00437                         );
00438 
00439     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00440 
00441         <span class="comment">//</span>
00442         <span class="comment">// We added a range so bump the count</span>
00443         <span class="comment">//</span>
00444         RangeList-&gt;Count++;
00445         RangeList-&gt;Stamp++;
00446 
00447     } <span class="keywordflow">else</span> {
00448 
00449         <span class="comment">//</span>
00450         <span class="comment">// We didn't add a range so free up the entry</span>
00451         <span class="comment">//</span>
00452 
00453         <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(newEntry);
00454     }
00455 
00456     <span class="keywordflow">return</span> status;
00457 
00458 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="range.c::RtlCopyRangeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlCopyRangeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>CopyRangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01552">1552</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01693">RtlFreeRangeList()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01467">RtlpCopyRangeListEntry()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01252">ArbBootAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01105">ArbRetestAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00506">ArbTestAllocation()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l02450">RtlMergeRangeLists()</a>.
<p>
<pre class="fragment"><div>01558                    :
01559 
01560     This routine copies a range list.
01561 
01562 Arguments:
01563 
01564     CopyRangeList - An initialized but empty range list where RangeList should
01565         be copied to.
01566 
01567     RangeList - The range list that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be copied.
01568 
01569 Return Value:
01570 
01571     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01572 
01573     STATUS_INSUFFICIENT_RESOURCES
01574     STATUS_INVALID_PARAMETER
01575 
01576 --*/
01577 {
01578 
01579     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
01580     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, newEntry, currentMerged, newMerged;
01581 
01582     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01583     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
01584     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(CopyRangeList);
01585 
01586 
01587     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
01588                 (<span class="stringliteral">"RtlCopyRangeList(0x%08x, 0x%08x)\n"</span>,
01589                 CopyRangeList,
01590                 RangeList
01591                 ));
01592 
01593     <span class="comment">//</span>
01594     <span class="comment">// Sanity checks...</span>
01595     <span class="comment">//</span>
01596 
01597     <span class="keywordflow">if</span> (CopyRangeList-&gt;Count != 0) {
01598         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
01599     }
01600 
01601     <span class="comment">//</span>
01602     <span class="comment">// Copy the header information</span>
01603     <span class="comment">//</span>
01604 
01605     CopyRangeList-&gt;Flags = RangeList-&gt;Flags;
01606     CopyRangeList-&gt;Count = RangeList-&gt;Count;
01607     CopyRangeList-&gt;Stamp = RangeList-&gt;Stamp;
01608 
01609     <span class="comment">//</span>
01610     <span class="comment">// Perform the copy</span>
01611     <span class="comment">//</span>
01612 
01613     <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, &amp;RangeList-&gt;ListHead, current) {
01614 
01615         <span class="comment">//</span>
01616         <span class="comment">// Copy the current entry</span>
01617         <span class="comment">//</span>
01618 
01619         newEntry = <a class="code" href="../../d2/d5/range_8c.html#a12">RtlpCopyRangeListEntry</a>(current);
01620 
01621         <span class="keywordflow">if</span> (!newEntry) {
01622             status = STATUS_INSUFFICIENT_RESOURCES;
01623             <span class="keywordflow">goto</span> cleanup;
01624         }
01625 
01626         <span class="comment">//</span>
01627         <span class="comment">// Add it into the list</span>
01628         <span class="comment">//</span>
01629 
01630         InsertTailList(&amp;CopyRangeList-&gt;ListHead, &amp;newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01631     }
01632 
01633     <span class="keywordflow">return</span> status;
01634 
01635 cleanup:
01636 
01637     <span class="comment">//</span>
01638     <span class="comment">// Free up the partially complete range list</span>
01639     <span class="comment">//</span>
01640 
01641     <a class="code" href="../../d2/d5/range_8c.html#a20">RtlFreeRangeList</a>(CopyRangeList);
01642     <span class="keywordflow">return</span> status;
01643 
01644 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="range.c::RtlDeleteOwnersRanges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlDeleteOwnersRanges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Owner</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01197">1197</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">_RTLP_RANGE_LIST_ENTRY::Allocated</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00057">_RTLP_RANGE_LIST_ENTRY::End</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01311">RtlpDeleteFromMergedRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>, and <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01105">ArbRetestAllocation()</a>, and <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00506">ArbTestAllocation()</a>.
<p>
<pre class="fragment"><div>01203                    :
01204 
01205     This routine deletes all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ranges owned by a specific owner from a range
01206     list.
01207 
01208 Arguments:
01209 
01210     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> -  The owner of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ranges to be deleted.
01211 
01212 Return Value:
01213 
01214     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01215 
01216     STATUS_INSUFFICIENT_RESOURCES
01217 
01218 --*/
01219 {
01220     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
01221     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next, currentMerged, nextMerged;
01222 
01223     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01224     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
01225 
01226     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
01227                 (<span class="stringliteral">"RtlDeleteOwnersRanges(0x%08x, 0x%08x)\n"</span>,
01228                 RangeList,
01229                 Owner
01230                 ));
01231 
01232 findNext:
01233 
01234     <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01235                          &amp;RangeList-&gt;ListHead,
01236                          current,
01237                          next) {
01238 
01239         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(current)) {
01240 
01241             <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01242                                  &amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
01243                                  currentMerged,
01244                                  nextMerged) {
01245 
01246                 <span class="keywordflow">if</span> (currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.Owner == <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>) {
01247 
01248                     <span class="comment">//</span>
01249                     <span class="comment">// This is the range - delete it and rebuild the merged</span>
01250                     <span class="comment">// range appropriately</span>
01251                     <span class="comment">//</span>
01252 
01253                     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
01254                         (<span class="stringliteral">"RtlDeleteOwnersRanges: Deleting merged range \</span>
01255 <span class="stringliteral">                            (Start=%I64x, End=%I64x)\n"</span>,
01256                         currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>,
01257                         currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a>
01258                         ));
01259 
01260                     status = <a class="code" href="../../d2/d5/range_8c.html#a11">RtlpDeleteFromMergedRange</a>(currentMerged,
01261                                                      current
01262                                                      );
01263                     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
01264                         <span class="keywordflow">goto</span> cleanup;
01265                     }
01266 
01267                     RangeList-&gt;Count--;
01268                     RangeList-&gt;Stamp++;
01269 
01270                     <span class="comment">//</span>
01271                     <span class="comment">// Can't keep scanning the list as it might have changed</span>
01272                     <span class="comment">// underneath us - start from the beginning again...</span>
01273                     <span class="comment">//</span>
01274                     <span class="comment">// BUGBUG - could keep a last safe position to go from...</span>
01275                     <span class="comment">//</span>
01276                     <span class="keywordflow">goto</span> findNext;
01277 
01278                 }
01279             }
01280 
01281         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.Owner == <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>) {
01282 
01283             <span class="comment">//</span>
01284             <span class="comment">// This is the range - delete it!</span>
01285             <span class="comment">//</span>
01286 
01287             RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01288             <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(current);
01289 
01290             <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
01291                 (<span class="stringliteral">"RtlDeleteOwnersRanges: Deleting range (Start=%I64x,End=%I64x)\n"</span>,
01292                 current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>,
01293                 current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a>
01294                 ));
01295 
01296             RangeList-&gt;Count--;
01297             RangeList-&gt;Stamp++;
01298 
01299             status = STATUS_SUCCESS;
01300 
01301         }
01302     }
01303 
01304 cleanup:
01305 
01306     <span class="keywordflow">return</span> status;
01307 
01308 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="range.c::RtlDeleteRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlDeleteRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>End</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Owner</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01071">1071</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">_RTLP_RANGE_LIST_ENTRY::Allocated</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00057">_RTLP_RANGE_LIST_ENTRY::End</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01311">RtlpDeleteFromMergedRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>, and <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02238">ArbBacktrackAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, and <a class="el" href="../../d4/d0/pnpmemio_8c-source.html#l00890">IopPortBacktrackAllocation()</a>.
<p>
<pre class="fragment"><div>01079                    :
01080 
01081     This routine deletes a range from a range list.
01082 
01083 Arguments:
01084 
01085     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted.
01086 
01087     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted.
01088 
01089     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> -  The owner of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted, used to distinguish <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01090     range from another with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same start and end.
01091 
01092 Return Value:
01093 
01094     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01095 
01096     STATUS_INSUFFICIENT_RESOURCES
01097     STATUS_RANGE_LIST_CONFLICT
01098 
01099 --*/
01100 {
01101     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_RANGE_NOT_FOUND;
01102     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next, currentMerged, nextMerged;
01103 
01104     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01105     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
01106 
01107     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
01108         (<span class="stringliteral">"RtlDeleteRange(0x%08x, 0x%I64x, 0x%I64x, 0x%08x)\n"</span>,
01109         RangeList,
01110         Start,
01111         End,
01112         Owner
01113         ));
01114 
01115 
01116     <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01117                          &amp;RangeList-&gt;ListHead,
01118                          current,
01119                          next) {
01120 
01121         <span class="comment">//</span>
01122         <span class="comment">// We're passed all possible intersections</span>
01123         <span class="comment">//</span>
01124 
01125         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> &lt; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>) {
01126 
01127             <span class="comment">//</span>
01128             <span class="comment">// We didn't find a match</span>
01129             <span class="comment">//</span>
01130 
01131             <span class="keywordflow">break</span>;
01132         }
01133 
01134         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(current)) {
01135 
01136             <span class="comment">//</span>
01137             <span class="comment">// COuld our range exist in this merged range?</span>
01138             <span class="comment">//</span>
01139 
01140             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> &gt;= current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> &amp;&amp; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> &lt;= current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a>) {
01141 
01142                 <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01143                                      &amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
01144                                      currentMerged,
01145                                      nextMerged) {
01146 
01147                     <span class="keywordflow">if</span> (currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> == <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>
01148                     &amp;&amp; currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a> == <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>
01149                     &amp;&amp; currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.Owner == <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>) {
01150 
01151                         <span class="comment">//</span>
01152                         <span class="comment">// This is the range - delete it and rebuild the merged</span>
01153                         <span class="comment">// range appropriately</span>
01154                         <span class="comment">//</span>
01155 
01156                         status = <a class="code" href="../../d2/d5/range_8c.html#a11">RtlpDeleteFromMergedRange</a>(currentMerged,
01157                                                          current
01158                                                          );
01159                         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
01160                     }
01161 
01162                 }
01163             }
01164 
01165         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> == <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>
01166                &amp;&amp; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a> == <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>
01167                &amp;&amp; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.Owner == <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>) {
01168 
01169             <span class="comment">//</span>
01170             <span class="comment">// This is the range - delete it!</span>
01171             <span class="comment">//</span>
01172 
01173             RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01174             <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(current);
01175             status = STATUS_SUCCESS;
01176             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
01177         }
01178     }
01179 
01180 <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>:
01181 
01182     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
01183 
01184         <span class="comment">//</span>
01185         <span class="comment">// We have removed a range so decrement the count in the header</span>
01186         <span class="comment">//</span>
01187 
01188         RangeList-&gt;Count--;
01189         RangeList-&gt;Stamp++;
01190 
01191     }
01192 
01193     <span class="keywordflow">return</span> status;
01194 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="range.c::RtlFindRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlFindRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Minimum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Maximum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>AttributeAvailableMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID Context&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_CONFLICT_RANGE_CALLBACK Callback&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01954">1954</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d1/d1/config_2test_2init386_8c-source.html#l00027">dummy()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l02205">RtlGetLastRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01839">RtlpIsRangeAvailable()</a>, and <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02065">ArbFindSuitableRange()</a>, and <a class="el" href="../../d4/d0/pnpmemio_8c-source.html#l00959">IopPortFindSuitableRange()</a>.
<p>
<pre class="fragment"><div>01968                    :
01969 
01970     This routine finds <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first available range that meets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> criterion specified.
01971 
01972 Arguments:
01973 
01974     RangeList - The range list to find a range in.
01975 
01976     Minimum - The <a class="code" href="../../d0/d4/mrcf_8c.html#a3">minimum</a> acceptable value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range.
01977 
01978     Maximum - The maximum acceptable value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range.
01979 
01980     Length - The length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range required.
01981 
01982     Alignmnent - The alignment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range.
01983 
01984     Flags - Modify <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> behaviour of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine.
01985 
01986         RTL_RANGE_LIST_SHARED_OK - indicates that shared ranges should be
01987             considered to be available.
01988 
01989     AttributeAvailableMask - Any range encountered with any of these bits set will be
01990         considered to be available.
01991 
01992     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - Pointer to a ULONGLONG where <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start value will be returned on
01993         success.
01994 
01995 Return Value:
01996 
01997     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01998 
01999     STATUS_UNSUCCESSFUL
02000     STATUS_INVALID_PARAMETER
02001 
02002 --*/
02003 {
02004 
02005     ULONGLONG start, end;
02006     RTL_RANGE_LIST_ITERATOR iterator;
02007     PRTL_RANGE <a class="code" href="../../d0/d2/config_2test_2init386_8c.html#a0">dummy</a>;
02008     BOOLEAN sharedOK, nullConflictOK;
02009 
02010     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02011 
02012     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
02013     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Start);
02014     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Alignment &gt; 0);
02015     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Length &gt; 0);
02016 
02017     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
02018         (<span class="stringliteral">"RtlFindRange(0x%08x, 0x%I64x, 0x%I64x, 0x%08x, 0x%08x, 0x%08x, 0x%08x)\n"</span>,
02019         RangeList,
02020         Minimum,
02021         Maximum,
02022         Length,
02023         Alignment,
02024         Flags,
02025         Start
02026         ));
02027 
02028     <span class="comment">//</span>
02029     <span class="comment">// Search from high to low, Align start if necessary</span>
02030     <span class="comment">//</span>
02031 
02032     start = Maximum - (Length - 1);
02033     start -= start % Alignment;
02034 
02035     <span class="comment">//</span>
02036     <span class="comment">// Valiate parameters</span>
02037     <span class="comment">//</span>
02038 
02039     <span class="keywordflow">if</span> ((Minimum &gt; Maximum)
02040     || (Maximum - Minimum &lt; Length - 1)
02041     || (Minimum + Alignment &lt; Minimum)
02042     || (start &lt; Minimum)
02043     || (Length == 0)
02044     || (Alignment == 0)) {
02045 
02046         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
02047     }
02048 
02049     sharedOK = (BOOLEAN) Flags &amp; RTL_RANGE_LIST_SHARED_OK;
02050     nullConflictOK = (BOOLEAN) Flags &amp; RTL_RANGE_LIST_NULL_CONFLICT_OK;
02051     <span class="comment">//</span>
02052     <span class="comment">// Calculate the end</span>
02053     <span class="comment">//</span>
02054 
02055     end = start + Length - 1;
02056 
02057     <span class="comment">//</span>
02058     <span class="comment">// Initialze the iterator to the end of the list</span>
02059     <span class="comment">//</span>
02060 
02061     <a class="code" href="../../d2/d5/range_8c.html#a24">RtlGetLastRange</a>(RangeList, &amp;iterator, &amp;dummy);
02062 
02063     <span class="comment">//</span>
02064     <span class="comment">// Keep trying to find ranges until we run out of room or we</span>
02065     <span class="comment">// wrap around</span>
02066     <span class="comment">//</span>
02067 
02068     <span class="keywordflow">do</span> {
02069 
02070         <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
02071             (<span class="stringliteral">"RtlFindRange: Testing range %I64x-%I64x\n"</span>,
02072             start,
02073             end
02074             ));
02075 
02076         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d5/range_8c.html#a14">RtlpIsRangeAvailable</a>(&amp;iterator,
02077                                  start,
02078                                  end,
02079                                  AttributeAvailableMask,
02080                                  sharedOK,
02081                                  nullConflictOK,
02082                                  FALSE,
02083                                  Context,
02084                                  Callback)) {
02085 
02086             *<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> = start;
02087 
02088             <span class="comment">//</span>
02089             <span class="comment">// Assert our result, if we produced one, is in the in</span>
02090             <span class="comment">// the range specified</span>
02091             <span class="comment">//</span>
02092 
02093             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(*Start &gt;= Minimum &amp;&amp; *Start + Length - 1 &lt;= Maximum);
02094 
02095             <span class="keywordflow">return</span> STATUS_SUCCESS;
02096         }
02097 
02098         <span class="comment">//</span>
02099         <span class="comment">// Find a suitable range starting from the one we conflicted with,</span>
02100         <span class="comment">// that is the current range in the iterator - this breaks the</span>
02101         <span class="comment">// abstraction of the iterator in the name of efficiency.</span>
02102         <span class="comment">//</span>
02103 
02104         start = ((<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>)(iterator.Current))-&gt;Start;
02105         <span class="keywordflow">if</span> ((start - Length) &gt; start) {
02106 
02107             <span class="comment">//</span>
02108             <span class="comment">// Wrapped, fail.</span>
02109             <span class="comment">//</span>
02110 
02111             <span class="keywordflow">break</span>;
02112         }
02113 
02114         start -= Length;
02115         start -= start % Alignment;
02116         end = start + Length - 1;
02117 
02118     } <span class="keywordflow">while</span> ( start &gt;= Minimum );
02119 
02120     <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02121 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="range.c::RtlFreeRangeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlFreeRangeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>RangeList</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01693">1693</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01647">RtlpDeleteRangeListEntry()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01252">ArbBootAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01026">ArbCommitAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00469">ArbDeleteArbiterInstance()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01105">ArbRetestAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01070">ArbRollbackAllocation()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00506">ArbTestAllocation()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01552">RtlCopyRangeList()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l02450">RtlMergeRangeLists()</a>.
<p>
<pre class="fragment"><div>01698                    :
01699 
01700     This routine deletes all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ranges in a range list.
01701 
01702 Arguments:
01703 
01704     RangeList - <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list to operate on.
01705 
01706 Return Value:
01707 
01708     None
01709 
01710 --*/
01711 {
01712 
01713     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next;
01714 
01715     <span class="comment">//</span>
01716     <span class="comment">// Sanity checks...</span>
01717     <span class="comment">//</span>
01718 
01719     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01720     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
01721 
01722     <span class="comment">//</span>
01723     <span class="comment">// Clean up the header information</span>
01724     <span class="comment">//</span>
01725 
01726     RangeList-&gt;Flags = 0;
01727     RangeList-&gt;Count = 0;
01728 
01729     <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01730                          &amp;RangeList-&gt;ListHead,
01731                          current,
01732                          next) {
01733 
01734         <span class="comment">//</span>
01735         <span class="comment">// Delete the current entry</span>
01736         <span class="comment">//</span>
01737 
01738         RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01739         <a class="code" href="../../d2/d5/range_8c.html#a13">RtlpDeleteRangeListEntry</a>(current);
01740     }
01741 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="range.c::RtlGetFirstRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlGetFirstRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_RANGE_LIST_ITERATOR&nbsp;</td>
          <td class="mdname" nowrap> <em>Iterator</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_RANGE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Range</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l02124">2124</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00228">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01744">RtlIsRangeAvailable()</a>.
<p>
<pre class="fragment"><div>02131                    :
02132 
02133     This routine extracts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first range in a range list.  If there are no
02134     ranges then STATUS_NO_MORE_ENTRIES <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02135 
02136 Arguments:
02137 
02138     RangeList - The range list to operate on.
02139 
02140     Iterator - On success <span class="keyword">this</span> contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> iteration and can be
02141         passed to <a class="code" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a>.
02142 
02143     Range - On success <span class="keyword">this</span> contains a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first range
02144 
02145 Return Value:
02146 
02147     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
02148 
02149     STATUS_NO_MORE_ENTRIES
02150 
02151 --*/
02152 {
02153     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
02154     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> first;
02155 
02156     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02157 
02158     <span class="comment">//</span>
02159     <span class="comment">// Fill in the first part of the iterator</span>
02160     <span class="comment">//</span>
02161 
02162     Iterator-&gt;RangeListHead = &amp;RangeList-&gt;ListHead;
02163     Iterator-&gt;Stamp = RangeList-&gt;Stamp;
02164 
02165     <span class="keywordflow">if</span> (!IsListEmpty(&amp;RangeList-&gt;ListHead)) {
02166 
02167         first = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(RangeList-&gt;ListHead.Flink);
02168 
02169         <span class="comment">//</span>
02170         <span class="comment">// Fill in the iterator and update to point to the first merged</span>
02171         <span class="comment">// range if we are merged</span>
02172         <span class="comment">//</span>
02173 
02174         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(first)) {
02175 
02176             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!IsListEmpty(&amp;first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead));
02177 
02178             Iterator-&gt;MergedHead = &amp;first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead;
02179             Iterator-&gt;Current = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02180                                     first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead.Flink
02181                                     );
02182 
02183         } <span class="keywordflow">else</span> {
02184 
02185             Iterator-&gt;MergedHead = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02186             Iterator-&gt;Current = first;
02187         }
02188 
02189         *Range = (PRTL_RANGE) Iterator-&gt;Current;
02190 
02191     } <span class="keywordflow">else</span> {
02192 
02193         Iterator-&gt;Current = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02194         Iterator-&gt;MergedHead = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02195 
02196         *Range = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02197 
02198         status = STATUS_NO_MORE_ENTRIES;
02199     }
02200 
02201     <span class="keywordflow">return</span> status;
02202 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="range.c::RtlGetLastRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlGetLastRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_RANGE_LIST_ITERATOR&nbsp;</td>
          <td class="mdname" nowrap> <em>Iterator</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_RANGE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Range</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l02205">2205</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00228">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01954">RtlFindRange()</a>.
<p>
<pre class="fragment"><div>02212                    :
02213 
02214     This routine extracts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first range in a range list.  If there are no
02215     ranges then STATUS_NO_MORE_ENTRIES <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02216 
02217 Arguments:
02218 
02219     RangeList - The range list to operate on.
02220 
02221     Iterator - On success <span class="keyword">this</span> contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> iteration and can be
02222         passed to <a class="code" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a>.
02223 
02224     Range - On success <span class="keyword">this</span> contains a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first range
02225 
02226 Return Value:
02227 
02228     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
02229 
02230     STATUS_NO_MORE_ENTRIES
02231 
02232 --*/
02233 {
02234     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
02235     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> first;
02236 
02237     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02238 
02239     <span class="comment">//</span>
02240     <span class="comment">// Fill in the first part of the iterator</span>
02241     <span class="comment">//</span>
02242 
02243     Iterator-&gt;RangeListHead = &amp;RangeList-&gt;ListHead;
02244     Iterator-&gt;Stamp = RangeList-&gt;Stamp;
02245 
02246     <span class="keywordflow">if</span> (!IsListEmpty(&amp;RangeList-&gt;ListHead)) {
02247 
02248         first = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(RangeList-&gt;ListHead.Blink);
02249 
02250         <span class="comment">//</span>
02251         <span class="comment">// Fill in the iterator and update to point to the first merged</span>
02252         <span class="comment">// range if we are merged</span>
02253         <span class="comment">//</span>
02254 
02255         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(first)) {
02256 
02257             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!IsListEmpty(&amp;first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead));
02258 
02259             Iterator-&gt;MergedHead = &amp;first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead;
02260             Iterator-&gt;Current = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02261                                     first-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead.Blink
02262                                     );
02263 
02264         } <span class="keywordflow">else</span> {
02265 
02266             Iterator-&gt;MergedHead = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02267             Iterator-&gt;Current = first;
02268         }
02269 
02270         *Range = (PRTL_RANGE) Iterator-&gt;Current;
02271 
02272     } <span class="keywordflow">else</span> {
02273 
02274         Iterator-&gt;Current = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02275         Iterator-&gt;MergedHead = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02276 
02277         *Range = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02278 
02279         status = STATUS_NO_MORE_ENTRIES;
02280     }
02281 
02282     <span class="keywordflow">return</span> status;
02283 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="range.c::RtlGetNextRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlGetNextRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PRTL_RANGE_LIST_ITERATOR&nbsp;</td>
          <td class="mdname" nowrap> <em>Iterator</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_RANGE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Range</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>MoveForwards</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l02286">2286</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00147">ASSERTMSG</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00228">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00231">RANGE_LIST_FROM_LIST_HEAD</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>.
<p>
<pre class="fragment"><div>02293                    :
02294 
02295     This routine extracts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next range in a range list.  If there are no
02296     more ranges then STATUS_NO_MORE_ENTRIES <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02297 
02298 Arguments:
02299 
02300     Iterator     - The iterator filled in by RtlGet{First|Next}Range which will
02301                    be update on success.
02302     Range        - On success <span class="keyword">this</span> contains a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next range
02303     MoveForwards - If <span class="keyword">true</span>, go forwards thru <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list, otherwise,
02304                    go backwards.
02305 
02306 Return Value:
02307 
02308     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
02309 
02310     STATUS_NO_MORE_ENTRIES
02311     STATUS_INVALID_PARAMETER
02312 
02313 Note:
02314 
02315     Add/<a class="code" href="../../d9/d0/rtdelkey_8c.html#a5">Delete</a> operations can not be performed on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list between calls to
02316     <a class="code" href="../../d2/d5/range_8c.html#a23">RtlGetFirstRange</a> / <a class="code" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a> and <a class="code" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a> / <a class="code" href="../../d2/d5/range_8c.html#a25">RtlGetNextRange</a>.
02317     If such calls are <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine will detect and fail <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call.
02318 
02319 --*/
02320 {
02321     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> mergedEntry, next;
02322     PLIST_ENTRY entry;
02323 
02324     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02325 
02326     <span class="comment">//</span>
02327     <span class="comment">// Make sure that we haven't changed the list between calls</span>
02328     <span class="comment">//</span>
02329 
02330     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a23">RANGE_LIST_FROM_LIST_HEAD</a>(Iterator-&gt;RangeListHead)-&gt;Stamp !=
02331             Iterator-&gt;Stamp) {
02332 
02333         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>(
02334             <span class="stringliteral">"RtlGetNextRange: Add/Delete operations have been performed while \</span>
02335 <span class="stringliteral">            iterating through a list\n"</span>, FALSE);
02336 
02337         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
02338     }
02339 
02340     <span class="comment">//</span>
02341     <span class="comment">// If we have already reached the end of the list then return</span>
02342     <span class="comment">//</span>
02343 
02344     <span class="keywordflow">if</span> (!Iterator-&gt;Current) {
02345         *Range = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02346         <span class="keywordflow">return</span> STATUS_NO_MORE_ENTRIES;
02347     }
02348 
02349     entry = &amp;((<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>)(Iterator-&gt;Current))-&gt;ListEntry;
02350     next = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02351                MoveForwards ? entry-&gt;Flink : entry-&gt;Blink);
02352 
02353     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(next);
02354 
02355     <span class="comment">//</span>
02356     <span class="comment">// Are we in a merged range?</span>
02357     <span class="comment">//</span>
02358     <span class="keywordflow">if</span> (Iterator-&gt;MergedHead) {
02359 
02360         <span class="comment">//</span>
02361         <span class="comment">// Have we reached the end of the merged range?</span>
02362         <span class="comment">//</span>
02363         <span class="keywordflow">if</span> (&amp;next-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a> == Iterator-&gt;MergedHead) {
02364 
02365             <span class="comment">//</span>
02366             <span class="comment">// Get back to the merged entry</span>
02367             <span class="comment">//</span>
02368             mergedEntry = CONTAINING_RECORD(
02369                               Iterator-&gt;MergedHead,
02370                               <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
02371                               Merged.ListHead
02372                               );
02373 
02374             <span class="comment">//</span>
02375             <span class="comment">// Move on to the next entry in the main list</span>
02376             <span class="comment">//</span>
02377 
02378             next = MoveForwards ?
02379                        <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02380                            mergedEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Flink
02381                            )
02382                    :   <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02383                            mergedEntry-&gt;ListEntry.Blink
02384                            );
02385             Iterator-&gt;MergedHead = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02386 
02387         } <span class="keywordflow">else</span> {
02388 
02389             <span class="comment">//</span>
02390             <span class="comment">// There are merged ranges left - return the next one</span>
02391             <span class="comment">//</span>
02392             Iterator-&gt;Current = next;
02393             *Range = (PRTL_RANGE) next;
02394 
02395             <span class="keywordflow">return</span> STATUS_SUCCESS;
02396         }
02397     }
02398 
02399     <span class="comment">//</span>
02400     <span class="comment">// Have we reached the end of the main list?</span>
02401     <span class="comment">//</span>
02402     <span class="keywordflow">if</span> (&amp;next-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a> == Iterator-&gt;RangeListHead) {
02403 
02404         <span class="comment">//</span>
02405         <span class="comment">// Tell the caller there are no more ranges</span>
02406         <span class="comment">//</span>
02407         Iterator-&gt;Current = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02408         *Range = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02409         <span class="keywordflow">return</span> STATUS_NO_MORE_ENTRIES;
02410 
02411     } <span class="keywordflow">else</span> {
02412 
02413         <span class="comment">//</span>
02414         <span class="comment">// Is the next range merged?</span>
02415         <span class="comment">//</span>
02416 
02417         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(next)) {
02418 
02419             <span class="comment">//</span>
02420             <span class="comment">// Goto the first merged entry</span>
02421             <span class="comment">//</span>
02422             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!Iterator-&gt;MergedHead);
02423 
02424             Iterator-&gt;MergedHead = &amp;next-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead;
02425             Iterator-&gt;Current = MoveForwards ?
02426                                     <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02427                                         next-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead.Flink
02428                                         )
02429                                 :   <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02430                                         next-&gt;Merged.ListHead.Blink
02431                                         );
02432         } <span class="keywordflow">else</span> {
02433 
02434             <span class="comment">//</span>
02435             <span class="comment">// Go to the next entry in the main list</span>
02436             <span class="comment">//</span>
02437 
02438             Iterator-&gt;Current = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(
02439                                     &amp;next-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>
02440                                     );
02441         }
02442 
02443         *Range = (PRTL_RANGE) Iterator-&gt;Current;
02444     }
02445 
02446     <span class="keywordflow">return</span> STATUS_SUCCESS;
02447 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="range.c::RtlInitializeRangeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlInitializeRangeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>RangeList</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00305">305</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00192">ArbInitializeArbiterInstance()</a>, and <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>.
<p>
<pre class="fragment"><div>00310                    :
00311 
00312     This routine initializes a range list.  It must be called before <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range
00313     list <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> passed to any of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other range list <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.  Initially <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00314     range list contains no ranges
00315 
00316 Arguments:
00317 
00318     RangeList - Pointer to a user allocated RTL_RANGE_LIST structre to be
00319         initialized.
00320 
00321 Return Value:
00322 
00323     None.
00324 
00325 --*/
00326 {
00327     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00328 
00329     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
00330 
00331     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1, (<span class="stringliteral">"RtlInitializeRangeList(0x%08x)\n"</span>, RangeList));
00332 
00333     InitializeListHead(&amp;RangeList-&gt;ListHead);
00334     RangeList-&gt;Flags = 0;
00335     RangeList-&gt;Count = 0;
00336     RangeList-&gt;Stamp = 0;
00337 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="range.c::RtlInvertRangeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlInvertRangeList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>InvertedRangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l02599">2599</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00057">_RTLP_RANGE_LIST_ENTRY::End</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d9/d8/pnpbusno_8c-source.html#l00030">MAX_ULONGLONG</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00340">RtlAddRange()</a>, and <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>.
<p>
<pre class="fragment"><div>02605                    :
02606 
02607     This inverts a range list so that all areas which are allocated
02608     in InvertedRangeList will not be in RangeList, and vice
02609     versa. The ranges in InvertedRangeList will all be owned by <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.
02610 
02611 Arguments:
02612 
02613     InvertedRangeList - a pointer to an empty Range <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> to be filled
02614         with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> inverted list
02615 
02616     RangeList - a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Range <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> to be inverted
02617 
02618 Return Value:
02619 
02620     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> of operation.
02621 
02622 */
02623 
02624 {
02625 
02626     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> currentRange;
02627     ULONGLONG currentStart = 0;
02628     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
02629 
02630     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02631 
02632     <span class="comment">//</span>
02633     <span class="comment">// if Inverted List does not start out empty, the inverted list</span>
02634     <span class="comment">// is meaningless</span>
02635     <span class="comment">//</span>
02636 
02637     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(InvertedRangeList-&gt;Count == 0);
02638 
02639     <span class="comment">//</span>
02640     <span class="comment">// iterate through all elements of the ReverseAllocation</span>
02641     <span class="comment">// adding the unallocated part before the current element</span>
02642     <span class="comment">// to the RealAllocation</span>
02643     <span class="comment">//</span>
02644 
02645     <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
02646                     &amp;RangeList-&gt;ListHead,
02647                     currentRange) {
02648 
02649         <span class="keywordflow">if</span> (currentRange-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> &gt; currentStart) {
02650 
02651             <span class="comment">//</span>
02652             <span class="comment">// we want a NULL range owner to show that the</span>
02653             <span class="comment">// range is unavailable</span>
02654             <span class="comment">//</span>
02655             status = <a class="code" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a>(InvertedRangeList,
02656                                  currentStart,
02657                                  currentRange-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>-1,
02658                                  0,            <span class="comment">// Attributes</span>
02659                                  0,            <span class="comment">// Flags</span>
02660                                  0,            <span class="comment">// UserData</span>
02661                                  NULL);        <span class="comment">// Owner</span>
02662 
02663             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
02664                 <span class="keywordflow">return</span> status;
02665             }
02666         }
02667 
02668         currentStart = currentRange-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a> + 1;
02669     }
02670 
02671     <span class="comment">//</span>
02672     <span class="comment">// add the portion of the address space above the last</span>
02673     <span class="comment">// element in the ReverseAllocation to the RealAllocation</span>
02674     <span class="comment">//</span>
02675     <span class="comment">// unless we've wrapped, in which case we've already added</span>
02676     <span class="comment">// the last element</span>
02677     <span class="comment">//</span>
02678 
02679     <span class="keywordflow">if</span> (currentStart &gt; (currentStart - 1)) {
02680 
02681         status = <a class="code" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a>(InvertedRangeList,
02682                              currentStart,
02683                              MAX_ULONGLONG,
02684                              0,
02685                              0,
02686                              0,
02687                              NULL);
02688 
02689         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
02690             <span class="keywordflow">return</span> status;
02691         }
02692     }
02693 
02694     <span class="keywordflow">return</span> STATUS_SUCCESS;
02695 
02696 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="range.c::RtlIsRangeAvailable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlIsRangeAvailable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>End</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>AttributeAvailableMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID Context&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_CONFLICT_RANGE_CALLBACK Callback&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Available</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01744">1744</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d1/d1/config_2test_2init386_8c-source.html#l00027">dummy()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l02124">RtlGetFirstRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01839">RtlpIsRangeAvailable()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/pnpmemio_8c-source.html#l01227">IopPortIsAliasedRangeAvailable()</a>.
<p>
<pre class="fragment"><div>01756                    :
01757 
01758     This routine determines <span class="keywordflow">if</span> a given range <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available.
01759 
01760 Arguments:
01761 
01762     RangeList - The range list to test availability on.
01763 
01764     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to test <span class="keywordflow">for</span> availability.
01765 
01766     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to test <span class="keywordflow">for</span> availability.
01767 
01768     Flags - Modify <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> behaviour of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine.
01769 
01770         RTL_RANGE_LIST_SHARED_OK - indicates that shared ranges should be
01771             considered to be available.
01772 
01773     AttributeAvailableMask - Any range encountered with any of these bits set will be
01774         consideredto be available.
01775 
01776     Available -  Pointer to a <span class="keywordtype">boolean</span> which will be set to <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range
01777         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available, otherwise <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01778 
01779 Return Value:
01780 
01781     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01782 
01783 --*/
01784 {
01785     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
01786     RTL_RANGE_LIST_ITERATOR iterator;
01787     PRTL_RANGE <a class="code" href="../../d0/d2/config_2test_2init386_8c.html#a0">dummy</a>;
01788 
01789     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01790 
01791     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(RangeList);
01792     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Available);
01793 
01794     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
01795         (<span class="stringliteral">"RtlIsRangeAvailable(0x%08x, 0x%I64x, 0x%I64x, 0x%08x, 0x%08x)\n"</span>,
01796         RangeList,
01797         Start,
01798         End,
01799         Flags,
01800         Available
01801         ));
01802 
01803     <span class="comment">//</span>
01804     <span class="comment">// Initialize iterator to the start of the list</span>
01805     <span class="comment">//</span>
01806     status = <a class="code" href="../../d2/d5/range_8c.html#a23">RtlGetFirstRange</a>(RangeList, &amp;iterator, &amp;dummy);
01807 
01808 
01809     <span class="keywordflow">if</span> (status == STATUS_NO_MORE_ENTRIES) {
01810         <span class="comment">//</span>
01811         <span class="comment">// The range list is empty therefore the range is available</span>
01812         <span class="comment">//</span>
01813 
01814         *Available = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01815         <span class="keywordflow">return</span> STATUS_SUCCESS;
01816 
01817     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
01818 
01819         <span class="keywordflow">return</span> status;
01820 
01821     }
01822 
01823     *Available = <a class="code" href="../../d2/d5/range_8c.html#a14">RtlpIsRangeAvailable</a>(&amp;iterator,
01824                                       Start,
01825                                       End,
01826                                       AttributeAvailableMask,
01827                                       (BOOLEAN)(Flags &amp; RTL_RANGE_LIST_SHARED_OK),
01828                                       (BOOLEAN)(Flags &amp; RTL_RANGE_LIST_NULL_CONFLICT_OK),
01829                                       TRUE,
01830                                       Context,
01831                                       Callback
01832                                       );
01833 
01834     <span class="keywordflow">return</span> STATUS_SUCCESS;
01835 
01836 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="range.c::RtlMergeRangeLists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlMergeRangeLists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>MergedRangeList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_RANGE_LIST&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeList2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l02450">2450</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d4/d4/range_8h-source.html#l00121">CONFLICT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01552">RtlCopyRangeList()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01693">RtlFreeRangeList()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00461">RtlpAddRange()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01467">RtlpCopyRangeListEntry()</a>.
<p>
<pre class="fragment"><div>02458                    :
02459 
02460     This routine merges two range lists into one.
02461 
02462 Arguments:
02463 
02464     MergedRangeList - An empty range list where on success <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> result of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02465         merge will be placed.
02466 
02467     RangeList1 - One of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range lists to be merged.
02468 
02469     RangeList2 - The other <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list to merged.
02470 
02471     Flags - Modifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> behaviour of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine:
02472 
02473         RTL_RANGE_LIST_MERGE_IF_CONFLICT - Merged ranges even <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> conflict.
02474 
02475 Return Value:
02476 
02477     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
02478 
02479     STATUS_INSUFFICIENT_RESOURCES
02480     STATUS_RANGE_LIST_CONFLICT
02481 
02482 --*/
02483 {
02484     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
02485     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, currentMerged, newEntry;
02486     ULONG addFlags;
02487 
02488     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02489 
02490     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(1,
02491             (<span class="stringliteral">"RtlMergeRangeList(0x%08x, 0x%08x, 0x%08x, 0x%08x)\n"</span>,
02492             MergedRangeList,
02493             RangeList1,
02494             RangeList2,
02495             Flags
02496             ));
02497 
02498     <span class="comment">//</span>
02499     <span class="comment">// Copy the first range list</span>
02500     <span class="comment">//</span>
02501 
02502     status = <a class="code" href="../../d2/d5/range_8c.html#a19">RtlCopyRangeList</a>(MergedRangeList, RangeList1);
02503 
02504     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
02505         <span class="keywordflow">goto</span> cleanup;
02506     }
02507 
02508     <span class="comment">//</span>
02509     <span class="comment">// Add all ranges from 2nd list</span>
02510     <span class="comment">//</span>
02511 
02512     <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, &amp;RangeList2-&gt;ListHead, current) {
02513 
02514         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(current)) {
02515 
02516             <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
02517                             &amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
02518                             currentMerged) {
02519 
02520                 <span class="keywordflow">if</span> (!(newEntry = <a class="code" href="../../d2/d5/range_8c.html#a12">RtlpCopyRangeListEntry</a>(currentMerged))) {
02521                         status = STATUS_INSUFFICIENT_RESOURCES;
02522                         <span class="keywordflow">goto</span> cleanup;
02523                 }
02524 
02525                 <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a7">CONFLICT</a>(currentMerged)) {
02526 
02527                     <span class="comment">//</span>
02528                     <span class="comment">// If a range was already conflicting in then it will conflict in</span>
02529                     <span class="comment">// the merged range list - allow this.</span>
02530                     <span class="comment">//</span>
02531 
02532                     addFlags = Flags | RTL_RANGE_LIST_ADD_IF_CONFLICT;
02533                 } <span class="keywordflow">else</span> {
02534 
02535                     addFlags = Flags;
02536                 }
02537 
02538                 status = <a class="code" href="../../d2/d5/range_8c.html#a6">RtlpAddRange</a>(&amp;MergedRangeList-&gt;ListHead,
02539                                       newEntry,
02540                                       addFlags
02541                                       );
02542 
02543             }
02544 
02545         } <span class="keywordflow">else</span> {
02546 
02547 
02548             <span class="keywordflow">if</span> (!(newEntry = <a class="code" href="../../d2/d5/range_8c.html#a12">RtlpCopyRangeListEntry</a>(current))){
02549                 status = STATUS_INSUFFICIENT_RESOURCES;
02550                 <span class="keywordflow">goto</span> cleanup;
02551             }
02552 
02553             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a7">CONFLICT</a>(current)) {
02554 
02555                 <span class="comment">//</span>
02556                 <span class="comment">// If a range was already conflicting in then it will conflict in</span>
02557                 <span class="comment">// the merged range list - allow this.</span>
02558                 <span class="comment">//</span>
02559 
02560                 addFlags = Flags | RTL_RANGE_LIST_ADD_IF_CONFLICT;
02561             } <span class="keywordflow">else</span> {
02562                 addFlags = Flags;
02563             }
02564 
02565             status = <a class="code" href="../../d2/d5/range_8c.html#a6">RtlpAddRange</a>(&amp;MergedRangeList-&gt;ListHead,
02566                                   newEntry,
02567                                   addFlags
02568                                   );
02569 
02570             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
02571                 <span class="keywordflow">goto</span> cleanup;
02572             }
02573         }
02574 
02575     }
02576     <span class="comment">//</span>
02577     <span class="comment">// Correct the count</span>
02578     <span class="comment">//</span>
02579 
02580     MergedRangeList-&gt;Count += RangeList2-&gt;Count;
02581     MergedRangeList-&gt;Stamp += RangeList2-&gt;Count;
02582 
02583     <span class="keywordflow">return</span> status;
02584 
02585 cleanup:
02586 
02587     <span class="comment">//</span>
02588     <span class="comment">// Something went wrong... Free up what we have built of the</span>
02589     <span class="comment">// new list and return the error</span>
02590     <span class="comment">//</span>
02591 
02592     <a class="code" href="../../d2/d5/range_8c.html#a20">RtlFreeRangeList</a>(MergedRangeList);
02593 
02594     <span class="keywordflow">return</span> status;
02595 
02596 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="range.c::RtlpAddIntersectingRanges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlpAddIntersectingRanges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>First</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>AddRangeFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00843">843</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00146">FOR_REST_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00154">FOR_REST_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00218">RANGE_INTERSECT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00228">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00565">RtlpAddToMergedRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00711">RtlpConvertToMergedRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00120">SHARED</a>, and <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00461">RtlpAddRange()</a>.
<p>
<pre class="fragment"><div>00851                    :
00852 
00853     This routine adds a range to a range list when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range overlaps
00854     an existing range.  Ranges are converted to mergedranges and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00855     RTL_RANGE_CONFLICT flag <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set as necessary.
00856 
00857 Arguments:
00858 
00859     ListHead - The list of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list to which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range should be added.
00860 
00861     First - The first range that intersects
00862 
00863     Entry - The <span class="keyword">new</span> range to be added
00864 
00865     AddRangeFlags - The Flags argument to <a class="code" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a>, see above.
00866 
00867 Return Value:
00868 
00869     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
00870 
00871     STATUS_INSUFFICIENT_RESOURCES
00872     STATUS_RANGE_LIST_CONFLICT
00873 
00874 --*/
00875 {
00876     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00877     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next, currentMerged, nextMerged;
00878     BOOLEAN entryShared;
00879 
00880     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00881     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(First);
00882     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry);
00883 
00884     entryShared = <a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(Entry);
00885 
00886     <span class="comment">//</span>
00887     <span class="comment">// If we care about conflicts see if we conflict with anyone</span>
00888     <span class="comment">//</span>
00889 
00890     <span class="keywordflow">if</span> (!(AddRangeFlags &amp; RTL_RANGE_LIST_ADD_IF_CONFLICT)) {
00891 
00892         <span class="comment">//</span>
00893         <span class="comment">// Examine all ranges after the first intersecting one</span>
00894         <span class="comment">//</span>
00895 
00896         current = First;
00897         <a class="code" href="../../d3/d5/range_8h.html#a10">FOR_REST_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, ListHead, current) {
00898 
00899             <span class="keywordflow">if</span> (Entry-&gt;End &lt; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>) {
00900 
00901                 <span class="comment">//</span>
00902                 <span class="comment">// We don't intersect anymore so there arn't any more</span>
00903                 <span class="comment">// conflicts</span>
00904                 <span class="comment">//</span>
00905 
00906                 <span class="keywordflow">break</span>;
00907 
00908             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(current)) {
00909 
00910                 <span class="comment">//</span>
00911                 <span class="comment">// Check if any of the merged ranges conflict</span>
00912                 <span class="comment">//</span>
00913 
00914                 <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
00915                                 &amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
00916                                 currentMerged) {
00917 
00918                     <span class="comment">//</span>
00919                     <span class="comment">// Do we conflict?</span>
00920                     <span class="comment">//</span>
00921 
00922                     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a19">RANGE_INTERSECT</a>(currentMerged, Entry)
00923                     &amp;&amp; !(entryShared &amp;&amp; <a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(currentMerged))) {
00924 
00925                         <span class="comment">//</span>
00926                         <span class="comment">// We conflict with one of the merged ranges</span>
00927                         <span class="comment">//</span>
00928 
00929                         <span class="keywordflow">return</span> STATUS_RANGE_LIST_CONFLICT;
00930 
00931                     }
00932                 }
00933 
00934             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(entryShared &amp;&amp; <a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(current))) {
00935 
00936                 <span class="comment">//</span>
00937                 <span class="comment">// We conflict with a non shared region in the  main list.</span>
00938                 <span class="comment">//</span>
00939 
00940                 <span class="keywordflow">return</span> STATUS_RANGE_LIST_CONFLICT;
00941             }
00942         }
00943     }
00944 
00945     <span class="comment">//</span>
00946     <span class="comment">// Ok - either we didn't find any conflicts or we don't care about</span>
00947     <span class="comment">// them.  Now its safe to perform the merge.   Make the first</span>
00948     <span class="comment">// overlapping range into a header if it is not already one and then</span>
00949     <span class="comment">// add the rest of the ranges</span>
00950     <span class="comment">//</span>
00951 
00952     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(First)) {
00953 
00954         status = <a class="code" href="../../d2/d5/range_8c.html#a8">RtlpConvertToMergedRange</a>(First);
00955 
00956         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00957             <span class="keywordflow">goto</span> cleanup;
00958         }
00959 
00960     }
00961 
00962     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(First));
00963 
00964     current = <a class="code" href="../../d3/d5/range_8h.html#a22">RANGE_LIST_ENTRY_FROM_LIST_ENTRY</a>(First-&gt;ListEntry.Flink);
00965 
00966     <span class="comment">//</span>
00967     <span class="comment">// Consider the entries between the one following first and the last</span>
00968     <span class="comment">// intersecting one.</span>
00969     <span class="comment">//</span>
00970 
00971     <a class="code" href="../../d3/d5/range_8h.html#a11">FOR_REST_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, ListHead, current, next) {
00972 
00973          <span class="keywordflow">if</span> (Entry-&gt;End &lt; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>) {
00974 
00975             <span class="comment">//</span>
00976             <span class="comment">// We don't intersect any more</span>
00977             <span class="comment">//</span>
00978 
00979             <span class="keywordflow">break</span>;
00980          }
00981 
00982         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(current)) {
00983 
00984             <span class="comment">//</span>
00985             <span class="comment">// Add all the merged ranges to the new entry</span>
00986             <span class="comment">//</span>
00987 
00988             <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
00989                                  &amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
00990                                  currentMerged,
00991                                  nextMerged) {
00992 
00993                 <span class="comment">//</span>
00994                 <span class="comment">// Remove the entry from the current list</span>
00995                 <span class="comment">//</span>
00996 
00997                 RemoveEntryList(&amp;currentMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
00998 
00999                 <span class="comment">//</span>
01000                 <span class="comment">// Add the entry to the new merged range</span>
01001                 <span class="comment">//</span>
01002 
01003                 status = <a class="code" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a>(First,
01004                                             currentMerged,
01005                                             AddRangeFlags
01006                                             );
01007 
01008                 <span class="comment">//</span>
01009                 <span class="comment">// We should not be able to fail the add but just to be</span>
01010                 <span class="comment">// on the safe side...</span>
01011                 <span class="comment">//</span>
01012 
01013                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status));
01014 
01015             }
01016 
01017             <span class="comment">//</span>
01018             <span class="comment">// Remove and free the now empty header</span>
01019             <span class="comment">//</span>
01020 
01021             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(IsListEmpty(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead));
01022 
01023             RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01024             <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(current);
01025 
01026         } <span class="keywordflow">else</span> {
01027 
01028             <span class="comment">//</span>
01029             <span class="comment">// Remove the entry from the main list</span>
01030             <span class="comment">//</span>
01031 
01032             RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01033 
01034             <span class="comment">//</span>
01035             <span class="comment">// Add the entry to the new merged range</span>
01036             <span class="comment">//</span>
01037 
01038             status = <a class="code" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a>(First,
01039                                         current,
01040                                         AddRangeFlags
01041                                         );
01042 
01043             <span class="comment">//</span>
01044             <span class="comment">// We should not be able to fail the add but just to be</span>
01045             <span class="comment">// on the safe side...</span>
01046             <span class="comment">//</span>
01047 
01048             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status));
01049 
01050         }
01051     }
01052 
01053     <span class="comment">//</span>
01054     <span class="comment">// Finally add the entry that did the overlapping</span>
01055     <span class="comment">//</span>
01056 
01057     status = <a class="code" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a>(First,
01058                                 Entry,
01059                                 AddRangeFlags
01060                                 );
01061 
01062     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status));
01063 
01064 cleanup:
01065 
01066     <span class="keywordflow">return</span> status;
01067 
01068 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="range.c::RtlpAddRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlpAddRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>AddRangeFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00461">461</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00248">InsertEntryList</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00218">RANGE_INTERSECT</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00843">RtlpAddIntersectingRanges()</a>, and <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00340">RtlAddRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l02450">RtlMergeRangeLists()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01311">RtlpDeleteFromMergedRange()</a>.
<p>
<pre class="fragment"><div>00468                    :
00469 
00470     This routine implement <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> AddRange operation adding <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00471     appropriate place in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sorted range list, converting ranges to merged
00472     ranges and setting RTL_RANGE_CONFLICT flags as necessary.
00473 
00474 Arguments:
00475 
00476     ListHead - The list of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list to which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range should be added.
00477 
00478     Entry - The <span class="keyword">new</span> entry to be added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list
00479 
00480     AddRangeFlags - The Flags argument to <a class="code" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a>, see above.
00481 
00482 Return Value:
00483 
00484     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
00485 
00486     STATUS_RANGE_LIST_CONFLICT
00487     STATUS_INSUFFICIENT_RESOURCES
00488 
00489 --*/
00490 {
00491     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
00492     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> previous, current;
00493     ULONGLONG start, end;
00494 
00495     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
00496                 (<span class="stringliteral">"RtlpAddRange(0x%08x, 0x%08x{0x%I64x-0x%I64x}, 0x%08x)\n"</span>,
00497                 ListHead,
00498                 Entry,
00499                 Entry-&gt;Start,
00500                 Entry-&gt;End,
00501                 AddRangeFlags
00502                 ));
00503 
00504     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00505     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry);
00506 
00507     start = Entry-&gt;Start;
00508     end = Entry-&gt;End;
00509 
00510     <span class="comment">//</span>
00511     <span class="comment">// Clear the conflict flag if it was left around</span>
00512     <span class="comment">//</span>
00513 
00514     Entry-&gt;PublicFlags &amp;= ~RTL_RANGE_CONFLICT;
00515 
00516     <span class="comment">//</span>
00517     <span class="comment">// Iterate through the list and find where to insert the entry</span>
00518     <span class="comment">//</span>
00519 
00520     <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, ListHead, current) {
00521 
00522         <span class="keywordflow">if</span> (end &lt; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a>) {
00523 
00524             <span class="comment">//</span>
00525             <span class="comment">// The new range is completely before this one</span>
00526             <span class="comment">//</span>
00527 
00528             <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2, (<span class="stringliteral">"Completely before\n"</span>));
00529 
00530             <a class="code" href="../../d3/d5/range_8h.html#a25">InsertEntryList</a>(current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Blink,
00531                             &amp;Entry-&gt;ListEntry
00532                             );
00533 
00534             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00535 
00536         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a19">RANGE_INTERSECT</a>(Entry, current)) {
00537 
00538             status = <a class="code" href="../../d2/d5/range_8c.html#a10">RtlpAddIntersectingRanges</a>(ListHead,
00539                        current,
00540                        Entry,
00541                        AddRangeFlags);
00542 
00543             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00544 
00545         }
00546     }
00547 
00548     <span class="comment">//</span>
00549     <span class="comment">// New range is after all existing ranges</span>
00550     <span class="comment">//</span>
00551 
00552     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2, (<span class="stringliteral">"After all existing ranges\n"</span>));
00553 
00554     InsertTailList(ListHead,
00555                    &amp;Entry-&gt;ListEntry
00556                   );
00557 
00558 <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>:
00559 
00560     <span class="keywordflow">return</span> status;
00561 
00562 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="range.c::RtlpAddToMergedRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlpAddToMergedRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Merged</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>AddRangeFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00565">565</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00248">InsertEntryList</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00100">_RTLP_RANGE_LIST_ENTRY::PublicFlags</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00218">RANGE_INTERSECT</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00120">SHARED</a>, and <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00843">RtlpAddIntersectingRanges()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01311">RtlpDeleteFromMergedRange()</a>.
<p>
<pre class="fragment"><div>00572                    :
00573 
00574     This routine adds a <span class="keyword">new</span> range to a merged range, setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00575     RTL_RANGE_CONFLICT flags <span class="keywordflow">if</span> necessary.
00576 
00577 Arguments:
00578 
00579     Merged - The merged range to which Entry should be added.
00580 
00581     Entry - The <span class="keyword">new</span> entry to be added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list
00582 
00583     AddRangeFlags - The Flags argument to <a class="code" href="../../d2/d5/range_8c.html#a16">RtlAddRange</a>, see above.
00584 
00585 Return Value:
00586 
00587     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
00588 
00589     STATUS_RANGE_LIST_CONFLICT - indictates that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range was not added because
00590         <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> conflicted with another range and conflicts are not allowed
00591 
00592 --*/
00593 {
00594     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current;
00595     PLIST_ENTRY insert = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00596     BOOLEAN entryShared;
00597 
00598     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00599     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Merged);
00600     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry);
00601     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(Merged));
00602 
00603     entryShared = <a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(Entry);
00604 
00605     <span class="comment">//</span>
00606     <span class="comment">// Insert it into the merged list, this is sorted in order of start</span>
00607     <span class="comment">//</span>
00608 
00609     <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, &amp;Merged-&gt;Merged.ListHead, current) {
00610 
00611         <span class="comment">//</span>
00612         <span class="comment">// Do we conflict?</span>
00613         <span class="comment">//</span>
00614 
00615         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a19">RANGE_INTERSECT</a>(current, Entry)
00616         &amp;&amp; !(entryShared &amp;&amp; <a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(current))) {
00617 
00618             <span class="comment">//</span>
00619             <span class="comment">// Are conflicts ok?</span>
00620             <span class="comment">//</span>
00621 
00622             <span class="keywordflow">if</span> (AddRangeFlags &amp; RTL_RANGE_LIST_ADD_IF_CONFLICT) {
00623 
00624                 <span class="comment">//</span>
00625                 <span class="comment">// Yes - Mark both entries as conflicting</span>
00626                 <span class="comment">//</span>
00627 
00628                 current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o8">PublicFlags</a> |= RTL_RANGE_CONFLICT;
00629                 Entry-&gt;PublicFlags |= RTL_RANGE_CONFLICT;
00630 
00631             } <span class="keywordflow">else</span> {
00632 
00633                 <span class="comment">//</span>
00634                 <span class="comment">// No - Fail</span>
00635                 <span class="comment">//</span>
00636 
00637                 <span class="keywordflow">return</span> STATUS_RANGE_LIST_CONFLICT;
00638 
00639             }
00640         }
00641 
00642         <span class="comment">//</span>
00643         <span class="comment">// Have we not yet found the insertion point and just passed it?</span>
00644         <span class="comment">//</span>
00645 
00646         <span class="keywordflow">if</span> (!insert &amp;&amp; current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> &gt; Entry-&gt;Start) {
00647 
00648             <span class="comment">//</span>
00649             <span class="comment">// Insert is before current</span>
00650             <span class="comment">//</span>
00651 
00652             insert = current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Blink;
00653         }
00654     }
00655 
00656     <span class="comment">//</span>
00657     <span class="comment">// Did we find where to insert the new range?</span>
00658     <span class="comment">//</span>
00659 
00660     <span class="keywordflow">if</span> (!insert) {
00661 
00662         <span class="comment">//</span>
00663         <span class="comment">// New range is after all existing ranges</span>
00664         <span class="comment">//</span>
00665 
00666         InsertTailList(&amp;Merged-&gt;Merged.ListHead,
00667                        &amp;Entry-&gt;ListEntry
00668                       );
00669 
00670     } <span class="keywordflow">else</span> {
00671 
00672         <span class="comment">//</span>
00673         <span class="comment">// Insert in the list</span>
00674         <span class="comment">//</span>
00675 
00676         <a class="code" href="../../d3/d5/range_8h.html#a25">InsertEntryList</a>(insert,
00677                         &amp;Entry-&gt;ListEntry
00678                         );
00679     }
00680 
00681 
00682     <span class="comment">//</span>
00683     <span class="comment">// Expand the merged range if necessary</span>
00684     <span class="comment">//</span>
00685 
00686     <span class="keywordflow">if</span> (Entry-&gt;Start &lt; Merged-&gt;Start) {
00687         Merged-&gt;Start = Entry-&gt;Start;
00688     }
00689 
00690     <span class="keywordflow">if</span> (Entry-&gt;End &gt; Merged-&gt;End) {
00691         Merged-&gt;End = Entry-&gt;End;
00692     }
00693 
00694     <span class="comment">//</span>
00695     <span class="comment">// If we just added a shared range to a completely shared merged</span>
00696     <span class="comment">// range then the shared flag can stay otherwise it must go</span>
00697     <span class="comment">//</span>
00698 
00699     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a6">SHARED</a>(Merged) &amp;&amp; !entryShared) {
00700 
00701         <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
00702             (<span class="stringliteral">"RtlpAddToMergedRange: Merged range no longer completely shared\n"</span>));
00703 
00704         Merged-&gt;PublicFlags &amp;= ~RTL_RANGE_SHARED;
00705     }
00706 
00707     <span class="keywordflow">return</span> STATUS_SUCCESS;
00708 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="range.c::RtlpConvertToMergedRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlpConvertToMergedRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Entry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00711">711</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00121">CONFLICT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00049">RTLP_RANGE_LIST_ENTRY_MERGED</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01467">RtlpCopyRangeListEntry()</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00843">RtlpAddIntersectingRanges()</a>.
<p>
<pre class="fragment"><div>00716                    :
00717 
00718     This converts a non-merged range into a merged range with one member, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00719     range that was just converted.
00720 
00721 Arguments:
00722 
00723     Entry - The entry to be converted into a merged range.
00724 
00725 Return Value:
00726 
00727     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
00728 
00729     STATUS_INSUFFICIENT_RESOURCES
00730 
00731 --*/
00732 {
00733     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> newEntry;
00734 
00735     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00736     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry);
00737     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(Entry));
00738     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!<a class="code" href="../../d3/d5/range_8h.html#a7">CONFLICT</a>(Entry));
00739 
00740     <span class="comment">//</span>
00741     <span class="comment">// Create a new entry</span>
00742     <span class="comment">//</span>
00743 
00744     <span class="keywordflow">if</span> (!(newEntry = <a class="code" href="../../d2/d5/range_8c.html#a12">RtlpCopyRangeListEntry</a>(Entry))) {
00745         <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;
00746     }
00747 
00748     <span class="comment">//</span>
00749     <span class="comment">// Convert the current entry into a merged one NB. Throw away all the</span>
00750     <span class="comment">// private flags but leave the public ones as they can only be shared.</span>
00751     <span class="comment">//</span>
00752 
00753     InitializeListHead(&amp;Entry-&gt;Merged.ListHead);
00754     Entry-&gt;PrivateFlags = <a class="code" href="../../d3/d5/range_8h.html#a4">RTLP_RANGE_LIST_ENTRY_MERGED</a>;
00755 
00756     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry-&gt;PublicFlags == RTL_RANGE_SHARED || Entry-&gt;PublicFlags == 0);
00757 
00758     <span class="comment">//</span>
00759     <span class="comment">// Add the range</span>
00760     <span class="comment">//</span>
00761 
00762     InsertHeadList(&amp;Entry-&gt;Merged.ListHead,
00763                    &amp;newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>
00764                    );
00765 
00766 
00767     <span class="keywordflow">return</span> STATUS_SUCCESS;
00768 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="range.c::RtlpCopyRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> RtlpCopyRangeListEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Entry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01467">1467</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00046">FOR_ALL_IN_LIST</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">_RTLP_RANGE_LIST_ENTRY::Merged</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d5/range_8h.html#a26">RTLP_RANGE_LIST_ENTRY</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00267">RtlpAllocateRangeListEntry</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01647">RtlpDeleteRangeListEntry()</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01552">RtlCopyRangeList()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l02450">RtlMergeRangeLists()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l00711">RtlpConvertToMergedRange()</a>.
<p>
<pre class="fragment"><div>01472                    :
01473 
01474     This routine copies a range list entry.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> merged all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01475     member ranges are copied too.
01476 
01477 Arguments:
01478 
01479     Entry - <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list entry to be copied.
01480 
01481 Return Value:
01482 
01483     Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range list entry or <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <span class="keywordflow">if</span> a <span class="keyword">new</span> entry could not be
01484     allocated.
01485 
01486 --*/
01487 {
01488     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> newEntry;
01489 
01490     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01491     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry);
01492 
01493     <span class="keywordflow">if</span> (newEntry = <a class="code" href="../../d2/d5/range_8c.html#a2">RtlpAllocateRangeListEntry</a>()) {
01494 
01495         RtlCopyMemory(newEntry, Entry, <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>));
01496 
01497 <span class="preprocessor">#if DBG</span>
01498 <span class="preprocessor"></span>        newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01499         newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Blink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01500 <span class="preprocessor">#endif</span>
01501 <span class="preprocessor"></span>
01502         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(Entry)) {
01503 
01504             <span class="comment">//</span>
01505             <span class="comment">// Copy the merged list</span>
01506             <span class="comment">//</span>
01507 
01508             <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, newMerged;
01509 
01510             InitializeListHead(&amp;newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead);
01511 
01512             <a class="code" href="../../d1/d5/translate_8c.html#a0">FOR_ALL_IN_LIST</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01513                             &amp;Entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead,
01514                             current) {
01515 
01516                 <span class="comment">//</span>
01517                 <span class="comment">// Allocate a new entry and copy the contents</span>
01518                 <span class="comment">//</span>
01519 
01520                 newMerged = <a class="code" href="../../d2/d5/range_8c.html#a2">RtlpAllocateRangeListEntry</a>();
01521 
01522                 <span class="keywordflow">if</span> (!newMerged) {
01523                     <span class="keywordflow">goto</span> cleanup;
01524                 }
01525 
01526                 RtlCopyMemory(newMerged, current, <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>));
01527 
01528                 <span class="comment">//</span>
01529                 <span class="comment">// Insert the new entry</span>
01530                 <span class="comment">//</span>
01531 
01532                 InsertTailList(&amp;newEntry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o6">Merged</a>.ListHead, &amp;newMerged-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01533             }
01534         }
01535     }
01536 
01537     <span class="keywordflow">return</span> newEntry;
01538 
01539 cleanup:
01540 
01541     <span class="comment">//</span>
01542     <span class="comment">// Free the partially build copy</span>
01543     <span class="comment">//</span>
01544 
01545     <a class="code" href="../../d2/d5/range_8c.html#a13">RtlpDeleteRangeListEntry</a>(newEntry);
01546 
01547     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01548 
01549 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="range.c::RtlpCreateRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> RtlpCreateRangeListEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>End</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>UserData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Owner</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l00771">771</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">_RTLP_RANGE_LIST_ENTRY::Allocated</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00095">_RTLP_RANGE_LIST_ENTRY::Attributes</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00057">_RTLP_RANGE_LIST_ENTRY::End</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00105">_RTLP_RANGE_LIST_ENTRY::PrivateFlags</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00100">_RTLP_RANGE_LIST_ENTRY::PublicFlags</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00267">RtlpAllocateRangeListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00056">_RTLP_RANGE_LIST_ENTRY::Start</a>, and <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l00340">RtlAddRange()</a>.
<p>
<pre class="fragment"><div>00780                    :
00781 
00782     This routine allocates a <span class="keyword">new</span> range list entry and fills <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data
00783     provided.
00784 
00785 Arguments:
00786 
00787     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range.
00788 
00789     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range.
00790 
00791     Attributes - Extra data (normally flags) to be stored with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range. The
00792         system will not attempt to interpret <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00793 
00794     UserData - Extra data to be stored with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range.  The system will not
00795         attempt to interpret <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>.
00796 
00797     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> cookie that represents <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entity that owns <span class="keyword">this</span> range.  (<a class="code" href="../../d2/d1/bench_8h.html#a5">A</a>
00798         pointer to some object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> most likley).  The system will not
00799         attempt to interpret <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>, just use <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> to distinguish <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range from
00800         another with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same start and end.
00801 
00802 Return Value:
00803 
00804     Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> range list entry or <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <span class="keywordflow">if</span> a <span class="keyword">new</span> entry could not be
00805     allocated.
00806 
00807 --*/
00808 {
00809     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> entry;
00810 
00811     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00812     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Start &lt;= End);
00813 
00814     <span class="comment">//</span>
00815     <span class="comment">// Allocate a new entry</span>
00816     <span class="comment">//</span>
00817 
00818     <span class="keywordflow">if</span> (entry = <a class="code" href="../../d2/d5/range_8c.html#a2">RtlpAllocateRangeListEntry</a>()) {
00819 
00820         <span class="comment">//</span>
00821         <span class="comment">// Fill in the details</span>
00822         <span class="comment">//</span>
00823 
00824 <span class="preprocessor">#if DBG</span>
00825 <span class="preprocessor"></span>        entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00826         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>.Blink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00827 <span class="preprocessor">#endif</span>
00828 <span class="preprocessor"></span>
00829         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o8">PublicFlags</a> = 0;
00830         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o9">PrivateFlags</a> = 0;
00831         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o0">Start</a> = <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>;
00832         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o1">End</a> = <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
00833         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.UserData = UserData;
00834         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o4">Allocated</a>.Owner = <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>;
00835         entry-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o7">Attributes</a> = Attributes;
00836     }
00837 
00838     <span class="keywordflow">return</span> entry;
00839 
00840 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="range.c::RtlpDeleteFromMergedRange" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlpDeleteFromMergedRange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Delete</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Merged</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01311">1311</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d0/rtdeltre_8c-source.html#l00103">Delete()</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00110">_RTLP_RANGE_LIST_ENTRY::ListEntry</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00100">_RTLP_RANGE_LIST_ENTRY::PublicFlags</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00461">RtlpAddRange()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00565">RtlpAddToMergedRange()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01197">RtlDeleteOwnersRanges()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01071">RtlDeleteRange()</a>.
<p>
<pre class="fragment"><div>01317                    :
01318 
01319     This routine deletes a range from a merged range and rebuilds <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> merged
01320     range as appropriate.  This includes adding <span class="keyword">new</span> merged and unmerged ranges.
01321     If no ranges are left in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> merged range <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> will be deleted.
01322 
01323 Arguments:
01324 
01325     BUGBUG these comments are not <span class="keywordflow">for</span> <span class="keyword">this</span> routine.
01326 
01327     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted.
01328 
01329     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The location of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted.
01330 
01331     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> -  The owner of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to be deleted, used to distinguish <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01332     range from another with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same start and end.
01333 
01334 Return Value:
01335 
01336     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> code that indicates whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function was successful:
01337 
01338     STATUS_INSUFFICIENT_RESOURCES
01339 
01340 --*/
01341 {
01342     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
01343     <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next;
01344     LIST_ENTRY keepList;
01345     PLIST_ENTRY previousInsert, nextInsert;
01346 
01347     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01348     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(Merged));
01349 
01350     <span class="comment">//</span>
01351     <span class="comment">// Remove the entry</span>
01352     <span class="comment">//</span>
01353 
01354     RemoveEntryList(&amp;<a class="code" href="../../d9/d0/rtdelkey_8c.html#a5">Delete</a>-&gt;ListEntry);
01355 
01356     <span class="comment">//</span>
01357     <span class="comment">// Initialize the temporary list where the new list will be build</span>
01358     <span class="comment">//</span>
01359 
01360     InitializeListHead(&amp;keepList);
01361 
01362     <span class="comment">//</span>
01363     <span class="comment">// Add the previously merged ranges into the keep list and put</span>
01364     <span class="comment">// any duplicates of the delete range into the delete list</span>
01365     <span class="comment">//</span>
01366 
01367     <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01368                          &amp;Merged-&gt;Merged.ListHead,
01369                          current,
01370                          next) {
01371 
01372         <span class="comment">//</span>
01373         <span class="comment">// Add it to the keepList.  Explicitly remove the entries from the</span>
01374         <span class="comment">// list so it is still valid if we need to rebuild it.</span>
01375         <span class="comment">//</span>
01376 
01377         RemoveEntryList(&amp;current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o10">ListEntry</a>);
01378 
01379         <span class="comment">//</span>
01380         <span class="comment">// Clear the conflict flag - if there is still a conflict RtlpAddRange</span>
01381         <span class="comment">// should set it again.</span>
01382         <span class="comment">//</span>
01383 
01384         current-&gt;<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html#o8">PublicFlags</a> &amp;= ~RTL_RANGE_CONFLICT;
01385 
01386         status = <a class="code" href="../../d2/d5/range_8c.html#a6">RtlpAddRange</a>(&amp;keepList,
01387                               current,
01388                               RTL_RANGE_LIST_ADD_IF_CONFLICT
01389                              );
01390 
01391         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
01392             <span class="comment">//</span>
01393             <span class="comment">// This should only happen if we run out of pool</span>
01394             <span class="comment">//</span>
01395             <span class="keywordflow">goto</span> cleanup;
01396         }
01397     }
01398 
01399     <span class="keywordflow">if</span> (!IsListEmpty(&amp;keepList)) {
01400 
01401         <span class="comment">//</span>
01402         <span class="comment">// Everything went well so splice this temporary list into the</span>
01403         <span class="comment">// main list where Merged used to be</span>
01404         <span class="comment">//</span>
01405 
01406         previousInsert = Merged-&gt;ListEntry.Blink;
01407         nextInsert = Merged-&gt;ListEntry.Flink;
01408 
01409         previousInsert-&gt;Flink = keepList.Flink;
01410         keepList.Flink-&gt;Blink = previousInsert;
01411 
01412         nextInsert-&gt;Blink = keepList.Blink;
01413         keepList.Blink-&gt;Flink = nextInsert;
01414 
01415     } <span class="keywordflow">else</span> {
01416 
01417         RemoveEntryList(&amp;Merged-&gt;ListEntry);
01418 
01419     }
01420 
01421     <span class="comment">//</span>
01422     <span class="comment">// Finally free the range we deleted and the merged range we have orphaned</span>
01423     <span class="comment">//</span>
01424 
01425     <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(Delete);
01426     <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(Merged);
01427 
01428     <span class="keywordflow">return</span> status;
01429 
01430 cleanup:
01431 
01432     <span class="comment">//</span>
01433     <span class="comment">// Things went wrong - should only be a STATUS_INSUFFICIENT_RESOURCES</span>
01434     <span class="comment">// Reconstruct the list as it was before the call using the keepList and</span>
01435     <span class="comment">// deleteList.</span>
01436     <span class="comment">//</span>
01437 
01438     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(status == STATUS_INSUFFICIENT_RESOURCES);
01439 
01440     <span class="comment">//</span>
01441     <span class="comment">// Add all the ranges we moved to the keepList back into Merged</span>
01442     <span class="comment">//</span>
01443 
01444     <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>, &amp;keepList, current, next) {
01445 
01446         status = <a class="code" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a>(Merged,
01447                                     current,
01448                                     RTL_RANGE_LIST_ADD_IF_CONFLICT
01449                                     );
01450 
01451         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status));
01452     }
01453 
01454     <span class="comment">//</span>
01455     <span class="comment">// And the one were meant to delete</span>
01456     <span class="comment">//</span>
01457 
01458     status = <a class="code" href="../../d2/d5/range_8c.html#a7">RtlpAddToMergedRange</a>(Merged,
01459                                   Delete,
01460                                   RTL_RANGE_LIST_ADD_IF_CONFLICT
01461                                  );
01462 
01463     <span class="keywordflow">return</span> status;
01464 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="range.c::RtlpDeleteRangeListEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlpDeleteRangeListEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Entry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01647">1647</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d4/d4/range_8h-source.html#l00135">FOR_ALL_IN_LIST_SAFE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00119">MERGED</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l00280">RtlpFreeRangeListEntry</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01693">RtlFreeRangeList()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01467">RtlpCopyRangeListEntry()</a>.
<p>
<pre class="fragment"><div>01652                    :
01653 
01654     This routine deletes a range list entry - <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> merged then all
01655     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> member ranges will be deleted as well.  The entry will not be removed
01656     from any list before deletion - <span class="keyword">this</span> should be done before calling <span class="keyword">this</span>
01657     routine.
01658 
01659 Arguments:
01660 
01661     Entry - The entry to be deleted.
01662 
01663 Return Value:
01664 
01665     None
01666 
01667 --*/
01668 
01669 {
01670     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01671 
01672     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a5">MERGED</a>(Entry)) {
01673 
01674         <a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">PRTLP_RANGE_LIST_ENTRY</a> current, next;
01675 
01676         <span class="comment">//</span>
01677         <span class="comment">// Free all member ranges first</span>
01678         <span class="comment">//</span>
01679 
01680         <a class="code" href="../../d3/d5/range_8h.html#a9">FOR_ALL_IN_LIST_SAFE</a>(<a class="code" href="../../d7/d6/struct__RTLP__RANGE__LIST__ENTRY.html">RTLP_RANGE_LIST_ENTRY</a>,
01681                              &amp;Entry-&gt;Merged.ListHead,
01682                              current,
01683                              next) {
01684 
01685             <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(current);
01686         }
01687     }
01688 
01689     <a class="code" href="../../d2/d5/range_8c.html#a3">RtlpFreeRangeListEntry</a>(Entry);
01690 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="range.c::RtlpIsRangeAvailable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlpIsRangeAvailable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_RANGE_LIST_ITERATOR&nbsp;</td>
          <td class="mdname" nowrap> <em>Iterator</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>End</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>AttributeAvailableMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SharedOK</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>NullConflictOK</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Forward</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID Context&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_CONFLICT_RANGE_CALLBACK Callback&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d4/range_8c-source.html#l01839">1839</a> of file <a class="el" href="../../d3/d4/range_8c-source.html">range.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d8/pnparb_8c-source.html#l00049">DEBUG_PRINT</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00234">FOR_REST_OF_RANGES</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/range_8h-source.html#l00225">RANGE_LIMITS_INTERSECT</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/range_8c-source.html#l01954">RtlFindRange()</a>, and <a class="el" href="../../d3/d4/range_8c-source.html#l01744">RtlIsRangeAvailable()</a>.
<p>
<pre class="fragment"><div>01852                    :
01853 
01854     This routine determines <span class="keywordflow">if</span> a given range <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available.
01855 
01856 Arguments:
01857 
01858     Iterator - An iterator set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first range to test in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range list.
01859 
01860     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - The start of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to test <span class="keywordflow">for</span> availability.
01861 
01862     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> - The end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range to test <span class="keywordflow">for</span> availability.
01863 
01864     AttributeAvailableMask - Any range encountered with any of these bits set will be
01865         considered to be available.
01866 
01867     SharedOK - Indicated whether or not shared ranges are considered to be
01868         available.
01869 
01870 Return Value:
01871 
01872     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> range <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
01873 
01874 --*/
01875 {
01876     PRTL_RANGE current;
01877 
01878     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01879 
01880     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Iterator);
01881 
01882     <a class="code" href="../../d3/d5/range_8h.html#a24">FOR_REST_OF_RANGES</a>(Iterator, current, Forward) {
01883 
01884         <span class="comment">//</span>
01885         <span class="comment">// If we have passed all possible intersections then break out.  This</span>
01886         <span class="comment">// can't be done in a merged region because of possible overlaps.</span>
01887         <span class="comment">//</span>
01888 
01889         <span class="keywordflow">if</span> (Forward) {
01890             <span class="keywordflow">if</span> (!Iterator-&gt;MergedHead &amp;&amp; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> &lt; current-&gt;Start) {
01891                 <span class="keywordflow">break</span>;
01892             }
01893         } <span class="keywordflow">else</span> {
01894             <span class="keywordflow">if</span> (!Iterator-&gt;MergedHead &amp;&amp; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> &gt; current-&gt;End) {
01895                 <span class="keywordflow">break</span>;
01896             }
01897         }
01898 
01899         <span class="comment">//</span>
01900         <span class="comment">// Do we intersect?</span>
01901         <span class="comment">//</span>
01902         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/range_8h.html#a21">RANGE_LIMITS_INTERSECT</a>(Start, End, current-&gt;Start, current-&gt;End)) {
01903 
01904             <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
01905                 (<span class="stringliteral">"Intersection 0x%I64x-0x%I64x and 0x%I64x-0x%I64x\n"</span>,
01906                 Start,
01907                 End,
01908                 current-&gt;Start,
01909                 current-&gt;End
01910                 ));
01911 
01912             <span class="comment">//</span>
01913             <span class="comment">// Is the intersection not Ok because it is with a non-shared</span>
01914             <span class="comment">// region or we don't want a shared region? Or the user said that</span>
01915             <span class="comment">// it should be considered available because of the user flags set.</span>
01916             <span class="comment">//</span>
01917 
01918             <span class="keywordflow">if</span> (!((SharedOK &amp;&amp; (current-&gt;Flags &amp; RTL_RANGE_SHARED))
01919                   || (current-&gt;Attributes &amp; AttributeAvailableMask)
01920                   || (NullConflictOK &amp;&amp; (current-&gt;Owner == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>))
01921                   )
01922                 )  {
01923 
01924                 <span class="comment">//</span>
01925                 <span class="comment">// If the caller provided a callback to support extra conflict</span>
01926                 <span class="comment">// semantics call it</span>
01927                 <span class="comment">//</span>
01928 
01929                 <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Callback)) {
01930                     <span class="keywordflow">if</span> ((*Callback)(Context, (PRTL_RANGE)current)) {
01931 
01932                     <a class="code" href="../../d7/d9/pnparb_8c.html#a1">DEBUG_PRINT</a>(2,
01933                         (<span class="stringliteral">"User provided callback overrode conflict\n"</span>,
01934                         Start,
01935                         End,
01936                         current-&gt;Start,
01937                         current-&gt;End
01938                         ));
01939 
01940                         <span class="keywordflow">continue</span>;
01941                     }
01942                 }
01943 
01944                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01945             }
01946         }
01947     }
01948 
01949 
01950     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01951 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:26 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
