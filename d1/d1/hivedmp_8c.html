<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: hivedmp.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>hivedmp.c File Reference</h1><code>#include "<a class="el" href="../../d6/d6/regutil_8h-source.html">regutil.h</a>"</code><br>
<code>#include "<a class="el" href="../../d1/d4/edithive_8h-source.html">edithive.h</a>"</code><br>

<p>
<a href="../../d2/d0/hivedmp_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a3">DumpValues</a> (HANDLE HiveHandle, HANDLE KeyHandle, ULONG IndentLevel)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a4">DumpKeys</a> (HANDLE HiveHandle, HANDLE KeyHandle, PUNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a3">KeyName</a>, ULONG IndentLevel)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a5">RegDumpKeyValueR</a> (FILE *fh, PKEY_VALUE_FULL_INFORMATION KeyValueInformation, ULONG IndentLevel)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a7">main</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a0">ValueBuffer</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a1">ValueBufferSize</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d1/hivedmp_8c.html#a2">RawOutput</a> = FALSE</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="hivedmp.c::DumpKeys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DumpKeys           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>IndentLevel</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">163</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
References <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00320">EhEnumerateKey()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00585">EhOpenChildByName()</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>.
<p>
<pre class="fragment"><div>00169 {
00170     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00171     HANDLE SubKeyHandle;
00172     WCHAR KeyBuffer[ 512 ];
00173     PKEY_BASIC_INFORMATION KeyInformation;
00174     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00175     ULONG SubKeyIndex;
00176     UNICODE_STRING SubKeyName;
00177     ULONG ResultLength;
00178 
00179 
00180     <span class="comment">//</span>
00181     <span class="comment">// Print name of node we are about to dump out</span>
00182     <span class="comment">//</span>
00183     printf( <span class="stringliteral">"%.*s%wZ\n"</span>,
00184             IndentLevel,
00185             <span class="stringliteral">"                                                                                  "</span>,
00186             KeyName
00187           );
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// Print out node's values</span>
00191     <span class="comment">//</span>
00192     <a class="code" href="../../d1/d1/hivedmp_8c.html#a3">DumpValues</a>( HiveHandle, KeyHandle, IndentLevel+4 );
00193 
00194     <span class="comment">//</span>
00195     <span class="comment">// Enumerate node's children and apply ourselves to each one</span>
00196     <span class="comment">//</span>
00197 
00198     KeyInformation = (PKEY_BASIC_INFORMATION)KeyBuffer;
00199     <span class="keywordflow">for</span> (SubKeyIndex = 0; <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; SubKeyIndex++) {
00200         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d5/edithive_8h.html#a6">EhEnumerateKey</a>( HiveHandle,
00201                                  KeyHandle,
00202                                  SubKeyIndex,
00203                                  KeyBasicInformation,
00204                                  KeyInformation,
00205                                  <span class="keyword">sizeof</span>( KeyBuffer ),
00206                                  &amp;ResultLength
00207                                );
00208 
00209         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_NO_MORE_ENTRIES) {
00210             <span class="keywordflow">return</span>;
00211             }
00212         <span class="keywordflow">else</span>
00213         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status )) {
00214             fprintf( stderr,
00215                      <span class="stringliteral">"REGDMP: NtEnumerateKey failed - Status ==%08lx\n"</span>,
00216                      Status
00217                    );
00218             <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 1 );
00219             }
00220 
00221         SubKeyName.Buffer = (PWSTR)&amp;(KeyInformation-&gt;Name[0]);
00222         SubKeyName.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)KeyInformation-&gt;NameLength;
00223         SubKeyName.MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)KeyInformation-&gt;NameLength;
00224 
00225         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d5/edithive_8h.html#a7">EhOpenChildByName</a>( HiveHandle,
00226                                     KeyHandle,
00227                                     &amp;SubKeyName,
00228                                     &amp;SubKeyHandle );
00229         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00230             <a class="code" href="../../d1/d1/hivedmp_8c.html#a4">DumpKeys</a>( HiveHandle, SubKeyHandle, &amp;SubKeyName, IndentLevel+4 );
00231         }
00232     }
00233 
00234 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="hivedmp.c::DumpValues" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DumpValues           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>HiveHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>IndentLevel</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">238</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
References <a class="el" href="../../d0/d4/edithive_8c-source.html#l00396">EhEnumerateValueKey()</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00063">RawOutput</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00555">RegDumpKeyValue()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00279">RegDumpKeyValueR()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00060">ValueBuffer</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00061">ValueBufferSize</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>.
<p>
<pre class="fragment"><div>00243 {
00244     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00245     PKEY_VALUE_FULL_INFORMATION KeyValueInformation;
00246     ULONG ValueIndex;
00247     ULONG ResultLength;
00248 
00249     KeyValueInformation = (PKEY_VALUE_FULL_INFORMATION)<a class="code" href="../../d1/d1/hivedmp_8c.html#a0">ValueBuffer</a>;
00250     <span class="keywordflow">for</span> (ValueIndex = 0; <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; ValueIndex++) {
00251         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d5/edithive_8h.html#a5">EhEnumerateValueKey</a>( HiveHandle,
00252                                       KeyHandle,
00253                                       ValueIndex,
00254                                       KeyValueFullInformation,
00255                                       KeyValueInformation,
00256                                       ValueBufferSize,
00257                                       &amp;ResultLength
00258                                     );
00259         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_NO_MORE_ENTRIES) {
00260             <span class="keywordflow">return</span>;
00261         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status )) {
00262             fprintf( stderr,
00263                      <span class="stringliteral">"REGDMP: NtEnumerateValueKey failed - Status == %08lx\n"</span>,
00264                      Status
00265                    );
00266             <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 1 );
00267         }
00268 
00269         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/hivedmp_8c.html#a2">RawOutput</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00270             <a class="code" href="../../d1/d1/hivedmp_8c.html#a5">RegDumpKeyValueR</a>( stdout, KeyValueInformation, IndentLevel );
00271         } <span class="keywordflow">else</span> {
00272             <a class="code" href="../../d5/d7/regutil_8h.html#a11">RegDumpKeyValue</a>( stdout, KeyValueInformation, IndentLevel );
00273         }
00274     }
00275 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="hivedmp.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">74</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
References <a class="el" href="../../d6/d6/regutil_8h-source.html#l00066">DebugOutput</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>, <a class="el" href="../../d0/d5/edithive_8h.html#a3">EhOpenHive()</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/rtload_8c-source.html#l00047">FileName</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00063">RawOutput</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d6/d0/curdir_8c-source.html#l01717">RtlDosPathNameToNtPathName_U()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d6/d6/regutil_8h-source.html#l00067">SummaryOutput</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d4/edithive_8h-source.html#l00026">TYPE_SIMPLE</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00066">Usage()</a>, <a class="el" href="../../d6/d6/regutil_8h-source.html#l00039">VALUE_BUFFER_SIZE</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00060">ValueBuffer</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00061">ValueBufferSize</a>.
<p>
<pre class="fragment"><div>00078 {
00079     <span class="keywordtype">char</span> *s;
00080     ANSI_STRING AnsiString;
00081     UNICODE_STRING <a class="code" href="../../d8/d0/rtbatcr_8c.html#a3">KeyName</a>;
00082     UNICODE_STRING DosName;
00083     UNICODE_STRING <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>;
00084     UNICODE_STRING RootName;
00085     HANDLE HiveHandle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00086     HANDLE RootKey = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00087     BOOLEAN ArgumentSeen;
00088     LPSTR HiveFile=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00089 
00090     <a class="code" href="../../d1/d1/hivedmp_8c.html#a1">ValueBufferSize</a> = <a class="code" href="../../d5/d7/regutil_8h.html#a0">VALUE_BUFFER_SIZE</a>;
00091     <a class="code" href="../../d1/d1/hivedmp_8c.html#a0">ValueBuffer</a> = VirtualAlloc( NULL, ValueBufferSize, MEM_COMMIT, PAGE_READWRITE );
00092     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/hivedmp_8c.html#a0">ValueBuffer</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00093         fprintf( stderr, <span class="stringliteral">"REGDMP: Unable to allocate value buffer.\n"</span> );
00094         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 1 );
00095         }
00096 
00097     ArgumentSeen = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00098     <span class="keywordflow">while</span> (--argc) {
00099         s = *++argv;
00100         <span class="keywordflow">if</span> (*s == <span class="charliteral">'-'</span> || *s == <span class="charliteral">'/'</span>) {
00101             <span class="keywordflow">while</span> (*++s) {
00102                 <span class="keywordflow">switch</span>( tolower( *s ) ) {
00103                     <span class="keywordflow">case</span> <span class="charliteral">'d'</span>:
00104                         <a class="code" href="../../d5/d7/regutil_8h.html#a3">DebugOutput</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00105                         <span class="keywordflow">break</span>;
00106 
00107                     <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
00108                         <a class="code" href="../../d5/d7/regutil_8h.html#a4">SummaryOutput</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00109                         <span class="keywordflow">break</span>;
00110 
00111                     <span class="keywordflow">case</span> <span class="charliteral">'r'</span>:
00112                         <a class="code" href="../../d1/d1/hivedmp_8c.html#a2">RawOutput</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00113                         <span class="keywordflow">break</span>;
00114 
00115                     <span class="keywordflow">case</span> <span class="charliteral">'f'</span>:
00116                         <span class="keywordflow">if</span> (argc--) {
00117                             <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;AnsiString, *++argv );
00118                             <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>( &amp;DosName,
00119                                                           &amp;AnsiString,
00120                                                           TRUE );
00121                             <a class="code" href="../../d5/d1/curdir_8c.html#a29">RtlDosPathNameToNtPathName_U</a>( DosName.Buffer,
00122                                                           &amp;FileName,
00123                                                           NULL,
00124                                                           NULL );
00125                             HiveHandle = <a class="code" href="../../d0/d5/edithive_8h.html#a3">EhOpenHive</a>( &amp;FileName,
00126                                                      &amp;RootKey,
00127                                                      &amp;RootName,
00128                                                      TYPE_SIMPLE );
00129                             ArgumentSeen = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00130                             <span class="keywordflow">break</span>;
00131                         }
00132 
00133                     <span class="keywordflow">default</span>:    <a class="code" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a>();
00134                     }
00135                 }
00136             }
00137 <span class="preprocessor">#if 0</span>
00138 <span class="preprocessor"></span>        <span class="keywordflow">else</span> {
00139             <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;AnsiString, s );
00140             <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>( &amp;KeyName, &amp;AnsiString, TRUE );
00141             <a class="code" href="../../d1/d1/hivedmp_8c.html#a4">DumpKeys</a>( HiveHandle, RootKey, &amp;KeyName, 0 );
00142             ArgumentSeen = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00143             }
00144 <span class="preprocessor">#endif</span>
00145 <span class="preprocessor"></span>        }
00146 
00147     <span class="keywordflow">if</span> (ArgumentSeen) {
00148         <span class="keywordflow">if</span> (HiveHandle != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00149             <a class="code" href="../../d1/d1/hivedmp_8c.html#a4">DumpKeys</a>( HiveHandle, RootKey, &amp;RootName, 0 );
00150         } <span class="keywordflow">else</span> {
00151             fprintf(stderr, <span class="stringliteral">"Couldn't open hive file %wZ\n"</span>,&amp;DosName);
00152         }
00153     } <span class="keywordflow">else</span> {
00154         <a class="code" href="../../d1/d1/hivedmp_8c.html#a6">Usage</a>();
00155     }
00156 
00157 
00158     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 0 );
00159 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="hivedmp.c::RegDumpKeyValueR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RegDumpKeyValueR           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>fh</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PKEY_VALUE_FULL_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyValueInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>IndentLevel</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00279">279</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, and <a class="el" href="../../d2/d0/rtdelval_8c-source.html#l00047">ValueName</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>.
<p>
<pre class="fragment"><div>00284 {
00285     PULONG p;
00286     PWSTR pw, pw1;
00287     ULONG i, j, k, m, cbPrefix;
00288     UNICODE_STRING <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>;
00289     PUCHAR pbyte;
00290 
00291     cbPrefix = fprintf( fh, <span class="stringliteral">"%.*s"</span>,
00292                         IndentLevel,
00293                         <span class="stringliteral">"                                                                                  "</span>
00294                       );
00295     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Buffer = (PWSTR)&amp;(KeyValueInformation-&gt;Name[0]);
00296     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)KeyValueInformation-&gt;NameLength;
00297     <a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)KeyValueInformation-&gt;NameLength;
00298 
00299     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/rtdelval_8c.html#a3">ValueName</a>.Length) {
00300         cbPrefix += fprintf( fh, <span class="stringliteral">"%wS "</span>, &amp;ValueName );
00301         }
00302     cbPrefix += fprintf( fh, <span class="stringliteral">"= "</span> );
00303 
00304     <span class="keywordflow">if</span> (KeyValueInformation-&gt;DataLength == 0) {
00305         fprintf( fh, <span class="stringliteral">" [no data] \n"</span>);
00306         <span class="keywordflow">return</span>;
00307     }
00308 
00309     fprintf( fh, <span class="stringliteral">"REG_BINARY 0x%08lx"</span>, KeyValueInformation-&gt;DataLength );
00310     p = (PULONG)((PCHAR)KeyValueInformation + KeyValueInformation-&gt;DataOffset);
00311     i = (KeyValueInformation-&gt;DataLength + 3) / <span class="keyword">sizeof</span>( ULONG );
00312     <span class="keywordflow">for</span> (j=0; j&lt;i; j++) {
00313         <span class="keywordflow">if</span> ((j % 8) == 0) {
00314             fprintf( fh, <span class="stringliteral">"\n%.*s"</span>,
00315                      IndentLevel+4,
00316                      <span class="stringliteral">"                                                                                  "</span>
00317                    );
00318             }
00319 
00320         fprintf( fh, <span class="stringliteral">"0x%08lx  "</span>, *p++ );
00321         }
00322     fprintf( fh, <span class="stringliteral">"\n"</span> );
00323 
00324     fprintf( fh, <span class="stringliteral">"\n"</span> );
00325     <span class="keywordflow">return</span>;
00326 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="hivedmp.c::Usage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Usage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00066">66</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00486">PrivMain()</a>, <a class="el" href="../../d6/d1/rtnotify_8c-source.html#l00230">processargs()</a>, <a class="el" href="../../d5/d8/heapdbg_8c-source.html#l01572">RtlDebugUsageHeap()</a>, <a class="el" href="../../d7/d8/heappage_8c-source.html#l03846">RtlpDebugPageHeapUsage()</a>, and <a class="el" href="../../d6/d8/heapdll_8c-source.html#l02976">RtlUsageHeap()</a>.
<p>
<pre class="fragment"><div>00067 {
00068     fprintf( stderr, <span class="stringliteral">"usage: HIVEDMP [-f hivefile]\n"</span> );
00069     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>( 1 );
00070 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="hivedmp.c::RawOutput" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d1/d1/hivedmp_8c.html#a2">RawOutput</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00063">63</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="hivedmp.c::ValueBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d2/d7/regtest_8c.html#a1">ValueBuffer</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00060">60</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/immhotky_8c-source.html#l00324">CliReadRegistryValue()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02786">CmpCreateControlSet()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01545">CmpSetVersionData()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00940">CmQueryMultipleValueKey()</a>, <a class="el" href="../../d3/d6/regtest_8c-source.html#l00045">DoTest()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>, <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00028">KeUserModeCallback()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03461">NtQueryMultipleValueKey()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00143">NtW32Call()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l01096">RegGetKeyValue()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00158">RegReadBinaryFile()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00068">RegReadMultiSzFile()</a>, and <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="hivedmp.c::ValueBufferSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d1/hivedmp_8c.html#a1">ValueBufferSize</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00061">61</a> of file <a class="el" href="../../d2/d0/hivedmp_8c-source.html">hivedmp.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00238">DumpValues()</a>, and <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00074">main()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:05 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
