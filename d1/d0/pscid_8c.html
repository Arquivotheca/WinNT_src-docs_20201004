<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: pscid.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>pscid.c File Reference</h1><code>#include "<a class="el" href="../../d9/d0/psp_8h-source.html">psp.h</a>"</code><br>

<p>
<a href="../../d2/d9/pscid_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/pscid_8c.html#a0">PsLookupProcessThreadByCid</a> (IN PCLIENT_ID Cid, OUT <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> *Process OPTIONAL, OUT <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> *Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/pscid_8c.html#a1">PsLookupProcessByProcessId</a> (IN HANDLE ProcessId, OUT <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> *Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/pscid_8c.html#a2">PsLookupThreadByThreadId</a> (IN HANDLE ThreadId, OUT <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> *Thread)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a1" doxytag="pscid.c::PsLookupProcessByProcessId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PsLookupProcessByProcessId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d9/pscid_8c-source.html#l00094">94</a> of file <a class="el" href="../../d2/d9/pscid_8c-source.html">pscid.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01403">ExMapHandleToPointer()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00254">_EPROCESS::GrantedAccess</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00698">_KPROCESS::Header</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00514">ObReferenceObject</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00166">_EPROCESS::Pcb</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00029">PSP_INVALID_ID</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00037">PspCidTable</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00258">_DISPATCHER_HEADER::Type</a>.
<p>
Referenced by <a class="el" href="../../d8/d5/lpcinit_8c-source.html#l00193">LpcpGetCreatorName()</a>, and <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>.
<p>
<pre class="fragment"><div>00101                    :
00102 
00103     This function accepts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process <span class="keywordtype">id</span> of a process and returns a
00104     referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00105 
00106 Arguments:
00107 
00108     ProcessId - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Process <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00109 
00110     Process - Returns a referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00111         process <span class="keywordtype">id</span>.
00112 
00113 Return Value:
00114 
00115     STATUS_SUCCESS - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> process was located based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> contents of
00116         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process <span class="keywordtype">id</span>.
00117 
00118     STATUS_INVALID_PARAMETER - The process was not found.
00119 
00120 --*/
00121 
00122 {
00123 
00124     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> CidEntry;
00125     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> lProcess;
00126     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00127 
00128     CidEntry = <a class="code" href="../../d5/d8/ex_8h.html#a299">ExMapHandleToPointer</a>(PspCidTable, ProcessId);
00129     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_INVALID_PARAMETER;
00130     <span class="keywordflow">if</span> (CidEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00131         lProcess = (<a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>)CidEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>;
00132         <span class="keywordflow">if</span> (lProcess != (<a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>)<a class="code" href="../../d1/d9/ps_8h.html#a0">PSP_INVALID_ID</a> &amp;&amp; lProcess-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o0">Pcb</a>.<a class="code" href="../../d5/d7/struct__KPROCESS.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> == <a class="code" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a> &amp;&amp; lProcess-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o54">GrantedAccess</a> ) {
00133             <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a>(lProcess);
00134             *Process = lProcess;
00135             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00136         }
00137 
00138         <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>(PspCidTable, CidEntry);
00139     }
00140 
00141     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00142 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="pscid.c::PsLookupProcessThreadByCid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PsLookupProcessThreadByCid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCLIENT_ID&nbsp;</td>
          <td class="mdname" nowrap> <em>Cid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> *Process&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d9/pscid_8c-source.html#l00027">27</a> of file <a class="el" href="../../d2/d9/pscid_8c-source.html">pscid.c</a>.
<p>
References <a class="el" href="../../d2/d8/ps_8h-source.html#l00388">_ETHREAD::Cid</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01403">ExMapHandleToPointer()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00440">_ETHREAD::GrantedAccess</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00545">_KTHREAD::Header</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00514">ObReferenceObject</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00029">PSP_INVALID_ID</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00037">PspCidTable</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00347">_ETHREAD::Tcb</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00638">THREAD_TO_PROCESS</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00258">_DISPATCHER_HEADER::Type</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00915">LpcpCopyRequestData()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d2/d6/lpcpriv_8c-source.html#l00032">NtImpersonateClientOfPort()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00044">NtReplyPort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00375">NtReplyWaitReplyPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01922">VdmpIsThreadTerminating()</a>.
<p>
<pre class="fragment"><div>00035                    :
00036 
00037     This function accepts The Client <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> of a thread, and returns a
00038     referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread, and possibly a referenced pointer
00039     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00040 
00041 Arguments:
00042 
00043     Cid - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Client <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread.
00044 
00045     Process - If specified, returns a referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process
00046         specified in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Cid.
00047 
00048     Thread - Returns a referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread specified in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00049         Cid.
00050 
00051 Return Value:
00052 
00053     STATUS_SUCCESS - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> process and thread were located based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> contents
00054         of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Cid.
00055 
00056     STATUS_INVALID_CID - The specified Cid <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invalid.
00057 
00058 --*/
00059 
00060 {
00061 
00062     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> CidEntry;
00063     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> lThread;
00064     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00065 
00066     CidEntry = <a class="code" href="../../d5/d8/ex_8h.html#a299">ExMapHandleToPointer</a>(PspCidTable, Cid-&gt;UniqueThread);
00067     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_INVALID_CID;
00068     <span class="keywordflow">if</span> (CidEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00069         lThread = (<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>)CidEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>;
00070         <span class="keywordflow">if</span> ((lThread != (<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a0">PSP_INVALID_ID</a>) &amp;&amp;
00071             (
00072              lThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o0">Tcb</a>.<a class="code" href="../../d1/d8/struct__KTHREAD.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> == <a class="code" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a> &amp;&amp;
00073              lThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o12">Cid</a>.UniqueProcess == Cid-&gt;UniqueProcess &amp;&amp;
00074              lThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o27">GrantedAccess</a>
00075             ) ) {
00076             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Process)) {
00077                 *Process = <a class="code" href="../../d1/d9/ps_8h.html#a17">THREAD_TO_PROCESS</a>(lThread);
00078                 <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a>(*Process);
00079             }
00080 
00081             <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a>(lThread);
00082             *Thread = lThread;
00083             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00084         }
00085 
00086         <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>(PspCidTable, CidEntry);
00087     }
00088 
00089     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00090 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="pscid.c::PsLookupThreadByThreadId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS PsLookupThreadByThreadId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>ThreadId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d9/pscid_8c-source.html#l00146">146</a> of file <a class="el" href="../../d2/d9/pscid_8c-source.html">pscid.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01403">ExMapHandleToPointer()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00440">_ETHREAD::GrantedAccess</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00545">_KTHREAD::Header</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00514">ObReferenceObject</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00029">PSP_INVALID_ID</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00037">PspCidTable</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00347">_ETHREAD::Tcb</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00258">_DISPATCHER_HEADER::Type</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>.
<p>
<pre class="fragment"><div>00153                    :
00154 
00155     This function accepts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <span class="keywordtype">id</span> of a thread and returns a
00156     referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread.
00157 
00158 Arguments:
00159 
00160     ThreadId - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Thread <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread.
00161 
00162     Thread - Returns a referenced pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00163         thread <span class="keywordtype">id</span>.
00164 
00165 Return Value:
00166 
00167     STATUS_SUCCESS - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> thread was located based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> contents of
00168         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <span class="keywordtype">id</span>.
00169 
00170     STATUS_INVALID_PARAMETER - The thread was not found.
00171 
00172 --*/
00173 
00174 {
00175 
00176     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> CidEntry;
00177     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> lThread;
00178     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00179 
00180     CidEntry = <a class="code" href="../../d5/d8/ex_8h.html#a299">ExMapHandleToPointer</a>(PspCidTable, ThreadId);
00181     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_INVALID_PARAMETER;
00182     <span class="keywordflow">if</span> (CidEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00183         lThread = (<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>)CidEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>;
00184         <span class="keywordflow">if</span> (lThread != (<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a0">PSP_INVALID_ID</a> &amp;&amp; lThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o0">Tcb</a>.<a class="code" href="../../d1/d8/struct__KTHREAD.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> == <a class="code" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a> &amp;&amp; lThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o27">GrantedAccess</a> ) {
00185 
00186             <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a>(lThread);
00187             *Thread = lThread;
00188             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00189         }
00190 
00191         <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>(PspCidTable, CidEntry);
00192     }
00193 
00194     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00195 }
}
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:22 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
