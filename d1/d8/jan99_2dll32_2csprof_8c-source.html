<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: csprof.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>csprof.c</h1><a href="../../d0/d9/jan99_2dll32_2csprof_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include "<a class="code" href="../../d2/d0/jan99_2dll32_2generic_8h.html">generic.h</a>"</span>
00002 
00003 <span class="preprocessor">#pragma code_seg(_ICM2SEG)</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#pragma optimize("",off)</span>
00005 <span class="preprocessor"></span>
<a name="l00006"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a1">00006</a> <span class="preprocessor">#define TempBfSize 128</span>
<a name="l00007"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a2">00007</a> <span class="preprocessor"></span><span class="preprocessor">#define LINELENG   128</span>
00008 <span class="preprocessor"></span><span class="preprocessor">#ifdef ICMDLL</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#define ICM2SEG</span>
00010 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00011 <span class="preprocessor"></span>
<a name="l00012"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a3">00012</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>[]       = <span class="stringliteral">"\n"</span> ;
<a name="l00013"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a4">00013</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>[] = <span class="stringliteral">"&lt;~"</span>;
<a name="l00014"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a5">00014</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>[] = <span class="stringliteral">"~&gt; cvx exec "</span>;
00015 
00016 <span class="comment">//******************************************************************</span>
00017 <span class="comment">//   Local functions to deal with output to the memory buffer</span>
00018 
<a name="l00019"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a6">00019</a> <span class="keyword">static</span>  <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a6">CPLastError</a>;
00020 
<a name="l00021"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a7">00021</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>     <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(SINT LastError)
00022 {
00023     <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a6">CPLastError</a> = LastError;
00024     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00025 }
00026 
<a name="l00027"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a8">00027</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>     <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a8">GetCPLastError</a>()
00028 {
00029     <span class="keywordflow">return</span>(<a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a6">CPLastError</a>);
00030 }
00031 
<a name="l00032"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a9">00032</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(SINT Size, HGLOBAL FAR *hMemory, LPMEMPTR lpMH)
00033 {
00034     HGLOBAL hMem;
00035     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>  lpMem;
00036 
00037     *hMemory = 0;
00038     <span class="keywordflow">if</span>(lpMH == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00039     {
00040         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00041         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00042     }
00043 
00044     hMem = GlobalAlloc(GHND, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ;
00045     <span class="keywordflow">if</span>(hMem == 0 )
00046     {
00047         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a40">CP_MEMORY_ALLOC_ERR</a>);
00048         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00049     }
00050 
00051     lpMem = GlobalLock(hMem);
00052     <span class="keywordflow">if</span>(lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00053     {
00054         GlobalFree(hMem);
00055         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a40">CP_MEMORY_ALLOC_ERR</a>);
00056         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00057     }
00058     *lpMH = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)lpMem ;
00059     *hMemory = hMem;
00060     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00061 }
00062 
<a name="l00063"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a10">00063</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(HGLOBAL hMem)
00064 {
00065     <span class="keywordflow">if</span>(hMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00066     {
00067         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00068         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00069     }
00070 
00071     GlobalUnlock(hMem);
00072     GlobalFree(hMem) ;
00073     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00074 }
00075 
00076 <span class="comment">//******************************************************************</span>
00077 <span class="comment">//      Low-level Profile functions - used for individual tag access</span>
00078 <span class="comment">//******************************************************************</span>
00079 <span class="preprocessor">#ifndef ICMDLL</span>
<a name="l00080"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a11">00080</a> <span class="preprocessor"></span><a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a7">LoadCP</a>(LPCSTR filename, HGLOBAL FAR *phMem, LPCHANDLE lpCP)
00081 {
00082     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
00083     HFILE       hFile;
00084     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res, CPSize;
00085     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      mpCP;
00086     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>;
00087 
00088     *phMem = 0;
00089     <span class="keywordflow">if</span> (lpCP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00090     {
00091         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00092         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00093     }
00094 
00095     hFile = _lopen(filename, READ );
00096     <span class="keywordflow">if</span>( hFile == HFILE_ERROR )
00097     {
00098         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a41">CP_FILE_OPEN_ERR</a>);
00099         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00100     }
00101 
00102     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = _lseek(hFile, 0, SEEK_END);
00103     _lseek(hFile, 0, SEEK_SET);
00104 
00105     Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader));
00106     <span class="keywordflow">if</span>( (Res == HFILE_ERROR) ||
00107         (Res != <span class="keyword">sizeof</span>(CPHeader)) )
00108     {
00109         _lclose(hFile);
00110         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a42">CP_FILE_READ_ERR</a>);
00111         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00112     }
00113     
00114     <span class="comment">// Make the initial check for validity of the profile</span>
00115     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
00116     {
00117         _lclose(hFile);
00118         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a43">CP_FORMAT_ERR</a>);
00119         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00120     }
00121 
00122     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> == 0xFFFFFFFF)
00123         CPSize = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(CPHeader.size);
00124     <span class="keywordflow">else</span>
00125         CPSize = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>;
00126     
00127     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(CPSize, phMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;mpCP) )
00128     {
00129 
00130         *lpCP = (<a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a5">CHANDLE</a>) mpCP;  <span class="comment">// Put the memory pointer as  handle</span>
00131         <span class="comment">// Read profile into  memory</span>
00132          _lseek(hFile, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>, SEEK_SET);
00133 
00134         <span class="keywordflow">while</span>(CPSize)
00135         {
00136             Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) mpCP, 4096);
00137             <span class="keywordflow">if</span> (Res == HFILE_ERROR) 
00138             {
00139                 _lclose(hFile);
00140                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a42">CP_FILE_READ_ERR</a>);
00141                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00142             }
00143             mpCP    += Res;
00144             CPSize  -= Res;
00145         }
00146     }<span class="keywordflow">else</span>
00147     {
00148         *phMem = 0;
00149         _lclose(hFile);
00150         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00151     }
00152     _lclose(hFile);
00153     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00154 }
00155 
00156 <span class="preprocessor">#else</span>
00157 <span class="preprocessor"></span><span class="comment">//******************************************************************</span>
00158 <span class="comment">//      Low-level Profile functions - used for individual tag access</span>
00159 <span class="comment">//******************************************************************</span>
00160 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a8">LoadCP32</a>(LPCSTR filename, HGLOBAL *phMem, LPCHANDLE lpCP)
00161 {
00162     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
00163     HANDLE      hFile;
00164     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res, CPSize;
00165     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      mpCP;
00166     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        Success;
00167     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>;
00168 
00169     <span class="keywordflow">if</span> (lpCP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00170     {
00171         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_NULL_POINTER_ERR);
00172         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00173     }
00174     hFile = CreateFile(filename, GENERIC_READ, 0, NULL, OPEN_EXISTING, 0, NULL);
00175     <span class="keywordflow">if</span>( hFile == <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a> )
00176     {
00177         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_OPEN_ERR);
00178         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00179     }
00180     
00181     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = GetFileSize(hFile, NULL);
00182 
00183     Success = ReadFile(hFile, (LPVOID) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader), &amp;Res, NULL);
00184     <span class="keywordflow">if</span>( ( !Success ) || (Res != <span class="keyword">sizeof</span>(CPHeader)) )
00185     {
00186         CloseHandle(hFile);
00187         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_READ_ERR);
00188         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00189     }
00190 
00191     <span class="comment">// Make the initial check for validity of the profile</span>
00192     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
00193     {
00194         CloseHandle(hFile);
00195         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FORMAT_ERR);
00196         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00197     }
00198 
00199     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> == 0xFFFFFFFF)
00200         CPSize = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(CPHeader.size);
00201     <span class="keywordflow">else</span>
00202         CPSize = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>;
00203 
00204     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(CPSize, phMem, (LPMEMPTR) &amp;mpCP) )
00205     {
00206 
00207         *lpCP = (<a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a5">CHANDLE</a>) mpCP;  <span class="comment">// Put the memory pointer as  handle</span>
00208         <span class="comment">// Read profile into  memory</span>
00209         SetFilePointer(hFile, 0L, NULL, FILE_BEGIN);
00210         Success = ReadFile(hFile, (LPVOID) (LPVOID)mpCP, CPSize, &amp;Res, NULL);
00211         <span class="keywordflow">if</span> (!Success) 
00212         {
00213             CloseHandle(hFile);
00214             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_READ_ERR);
00215             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00216         }
00217     }<span class="keywordflow">else</span>
00218     {
00219         CloseHandle(hFile);
00220         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00221     }
00222     CloseHandle(hFile);
00223     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00224 }
00225 <span class="preprocessor">#endif</span>
00226 <span class="preprocessor"></span>
<a name="l00227"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a12">00227</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a9">FreeCP</a>(HGLOBAL hMem)
00228 {
00229     <span class="keywordflow">return</span>( <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hMem) );
00230 }
00231 
00232 
<a name="l00233"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a13">00233</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a13">GetCPElementCount</a>(CHANDLE CP, LPSINT lpCount)
00234 {
00235     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00236     <span class="keywordflow">if</span> (lpCount == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00237     {
00238         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00239         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00240     }
00241     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00242     *lpCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00243     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00244 }
00245 
00246 
<a name="l00247"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a14">00247</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CHANDLE CP, SINT Index,
00248                                 LPMEMPTR lpTagData, LPMEMPTR lpElemData)
00249 {
00250     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00251     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00252 
00253     <span class="keywordflow">if</span> ( (lpTagData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (lpElemData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) )
00254     {
00255         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00256         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00257     }
00258 
00259     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00260     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00261     <span class="keywordflow">if</span> ( <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> &lt;= <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> )
00262     {
00263         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a44">CP_OUT_OF_RANGE_ERR</a>);
00264         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00265     }
00266     *lpTagData      = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp;(lpTL-&gt;tags[0])) + (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>)) ;
00267     *lpElemData     = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) CP) +
00268                                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)*lpTagData)-&gt;offset);
00269     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00270 }
00271 
00272 
00273 <span class="comment">/* Checks if the profile has all required fields  for</span>
00274 <span class="comment">    this specific type of the color profile             */</span>
<a name="l00275"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a15">00275</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a10">ValidateCP</a>(CHANDLE CP)
00276 {
00277     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    Result;
00278     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>    ProfileClass;
00279 
00280     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a25">GetCPClass</a>(CP, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;ProfileClass) )
00281     {
00282         <span class="comment">// All profiles must have a ProfileDescription and</span>
00283         <span class="comment">//  a Copyright  tags.</span>
00284 
00285         <span class="keywordflow">if</span>( !<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a44">icSigProfileDescriptionTag</a>) || 
00286             !<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a29">icSigCopyrightTag</a> ) )
00287         {
00288             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00289             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00290         }
00291 
00292         <span class="comment">// All profiles, except Device-link, must have a mediaWhitePoint Tag</span>
00293         <span class="keywordflow">switch</span>( ProfileClass )
00294         {
00295             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a125">icSigLinkClass</a> :        <span class="comment">/* 'link' */</span>
00296                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00297                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>)
00298                   )
00299                 {
00300                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00301                 }<span class="keywordflow">else</span>
00302                 {
00303                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00304                 }
00305                 <span class="keywordflow">break</span>;
00306 
00307             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a122">icSigInputClass</a>:       <span class="comment">/* 'scnr' */</span>
00308                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) ||
00309                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>)      )
00310                 {
00311                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00312                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) )
00313                 {
00314                     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00315                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00316                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>) &amp;&amp;
00317                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>) &amp;&amp;
00318                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>)
00319                       )
00320                     {
00321                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00322                     }<span class="keywordflow">else</span>
00323                     {
00324                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00325                     }
00326                 }<span class="keywordflow">else</span>
00327                 {
00328                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00329                 }
00330                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00331                 <span class="keywordflow">break</span>;
00332 
00333             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a123">icSigDisplayClass</a>:     <span class="comment">/* 'mntr' */</span>
00334                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) )
00335                 {
00336                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00337                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) )
00338                 {
00339                     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00340                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00341                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>) &amp;&amp;
00342                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>) &amp;&amp;
00343                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>)
00344                       )
00345                     {
00346                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00347                     }<span class="keywordflow">else</span>
00348                     {
00349                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00350                     }
00351                 }<span class="keywordflow">else</span>
00352                 {
00353                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00354                 }
00355                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00356                 <span class="keywordflow">break</span>;
00357 
00358             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a124">icSigOutputClass</a>:      <span class="comment">/* 'prtr' */</span>
00359                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) )
00360                 {
00361                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00362                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00363                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a18">icSigAToB1Tag</a>) &amp;&amp;
00364                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a19">icSigAToB2Tag</a>) &amp;&amp;
00365                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>) &amp;&amp;
00366                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>) &amp;&amp;
00367                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>) &amp;&amp;
00368                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a32">icSigGamutTag</a>) 
00369                         )
00370                 {
00371                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00372                 }<span class="keywordflow">else</span>
00373                 {
00374                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00375                 }
00376                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00377                 <span class="keywordflow">break</span>;
00378 
00379             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a126">icSigAbstractClass</a>:    <span class="comment">/* 'abst' */</span>
00380                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) )
00381                 {
00382                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00383                 }<span class="keywordflow">else</span>
00384                 {
00385                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00386                 }
00387                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00388                 <span class="keywordflow">break</span>;
00389 
00390             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a127">icSigColorSpaceClass</a>:  <span class="comment">/* 'spac' */</span>
00391                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00392                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>)
00393                   )
00394                 {
00395                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00396                 }<span class="keywordflow">else</span>
00397                 {
00398                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00399                 }
00400                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00401                 <span class="keywordflow">break</span>;
00402 
00403             <span class="keywordflow">default</span>:
00404                 Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00405                 <span class="keywordflow">break</span>;
00406         }
00407     }<span class="keywordflow">else</span>
00408     {
00409         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00410     }
00411     <span class="keywordflow">if</span>( Result == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> )
00412     {
00413         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00414     }
00415     <span class="keywordflow">return</span>(Result);
00416 }
00417 
<a name="l00418"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a16">00418</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CHANDLE CP, CSIG CPTag)
00419 {
00420     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00421     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   Data;
00422     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00423 
00424     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00425     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00426     Data    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)  &amp;(lpTL-&gt;tags[0]) ; 
00427     <span class="keywordflow">while</span> ( <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>-- )
00428     {
00429         <span class="keywordflow">if</span>(  <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)Data)-&gt;sig) == CPTag )
00430         {
00431             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00432         }<span class="keywordflow">else</span>
00433         {
00434             Data    += <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>);   <span class="comment">// Bump pointer to the next tag</span>
00435         }
00436     }
00437     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00438 }
00439 
00440 
<a name="l00441"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a17">00441</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(CHANDLE CP, CSIG CPTag, LPSINT lpIndex)
00442 {
00443     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00444     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   Data;
00445     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
00446     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00447 
00448     <span class="keywordflow">if</span> (lpIndex == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00449     {
00450         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00451         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00452     }
00453 
00454     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00455     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00456     Data    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)  &amp;(lpTL-&gt;tags[0]) ;
00457 
00458     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>; i++ )
00459     {
00460         <span class="keywordflow">if</span>(  <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)Data)-&gt;sig) == CPTag )
00461         {
00462             *lpIndex = i;
00463             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00464         }<span class="keywordflow">else</span>
00465         {
00466             Data    += <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>);   <span class="comment">// Bump pointer to the next tag</span>
00467         }
00468     }
00469 
00470     <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00471     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00472 }
00473 
00474 
00475 
<a name="l00476"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a18">00476</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a>(CHANDLE CP, SINT Index, LPCSIG lpCPTag)
00477 {
00478     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00479     <span class="keywordflow">if</span> (lpCPTag == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00480     {
00481         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00482         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00483     }
00484     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00485             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00486     {
00487         *lpCPTag    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;sig ) ;
00488     }<span class="keywordflow">else</span>
00489     {
00490         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00491     }
00492     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00493 }
00494 
00495 <span class="comment">//***************************************************************</span>
00496 <span class="comment">//      Function applicable to the elements</span>
00497 <span class="comment">//</span>
00498 <span class="comment">//***************************************************************</span>
00499 
<a name="l00500"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a19">00500</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a>(CHANDLE CP, SINT Index, LPCSIG lpCSig)
00501 {
00502     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00503     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00504             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00505     {
00506         *lpCSig    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a34">lpcpTagBase</a>)ElemData)-&gt;sig ) ;
00507     }<span class="keywordflow">else</span>
00508     {
00509         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00510     }
00511     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00512 }
00513 
00514 
00515 
<a name="l00516"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a20">00516</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a>(CHANDLE CP, SINT Index, LPSINT lpSize)
00517 {
00518     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00519     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00520     {
00521         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00522         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00523     }
00524 
00525     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00526             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00527     {
00528         *lpSize     = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size );
00529     }<span class="keywordflow">else</span>
00530     {
00531         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00532     }
00533 
00534     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00535 }
00536 
<a name="l00537"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a21">00537</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(CHANDLE CP, SINT Index, LPSINT lpSize)
00538 {
00539     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>  TagData, ElemData;
00540     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00541     {
00542         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00543         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00544     }
00545 
00546     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00547             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00548     {
00549 <span class="comment">//  Changed by jjia 8/24/95</span>
00550 <span class="comment">//        *lpSize     = ui32toSINT( ((lpcpTag)TagData)-&gt;size ) -</span>
00551 <span class="comment">//                                             sizeof(lpcpTagBase);</span>
00552     *lpSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size) - 
00553                     <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00554     }<span class="keywordflow">else</span>
00555     {
00556         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00557     }
00558 
00559     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00560 }
00561 
00562 <span class="comment">//***************************************************************</span>
00563 <span class="comment">//  The difference between GetCPElement and GetCPElementData</span>
00564 <span class="comment">//  is that GetCPElement reads all fields of the element,</span>
00565 <span class="comment">//  including the data tag, reserved fields and element data,</span>
00566 <span class="comment">//  while GetCPElementData only reads the actual data.</span>
00567 <span class="comment">//  Number of bytes that are required to hold the whole data element can be</span>
00568 <span class="comment">//  obtained by calling the function GetCPElementSize().</span>
00569 <span class="comment">//  The actulal number of data bytes is determined by</span>
00570 <span class="comment">//  the call to GetCPElementDataSize().</span>
00571 <span class="comment">//***************************************************************</span>
<a name="l00572"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a22">00572</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a>(CHANDLE CP, SINT Index,
00573                                MEMPTR lpData, SINT Size)
00574 {
00575     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        ElemSize;
00576     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      TagData, ElemData;
00577     <span class="keywordflow">if</span> (lpData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00578     {
00579         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00580         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00581     }
00582 
00583     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00584             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00585     {
00586         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00587     }
00588     ElemSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size);
00589     <span class="keywordflow">if</span>(ElemSize &gt; <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> )
00590     {
00591         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a45">CP_NO_MEMORY_ERR</a>);
00592         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00593     }
00594     MemCopy(lpData, ElemData, ElemSize);
00595     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00596 
00597 }
00598 
00599 
<a name="l00600"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a23">00600</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(CHANDLE CP, SINT Index,
00601                                 MEMPTR lpData, SINT Size)
00602 {
00603     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     ElemSize;
00604     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00605     <span class="keywordflow">if</span> (lpData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00606     {
00607         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00608         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00609     }
00610 
00611     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00612             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00613     {
00614         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00615     }
00616 <span class="comment">//  Changed by jjia 8/24/95</span>
00617 <span class="comment">//    ElemData    +=  sizeof(lpcpTagBase);</span>
00618 <span class="comment">//    ElemSize    = ui32toSINT( ((lpcpTag)TagData)-&gt;size) - </span>
00619 <span class="comment">//                     sizeof(lpcpTagBase);</span>
00620     ElemData    +=  <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) + <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00621     ElemSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size) - 
00622                     <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00623 
00624     <span class="keywordflow">if</span>(ElemSize &gt; <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> )
00625     {
00626         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a45">CP_NO_MEMORY_ERR</a>);
00627         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00628     }
00629 
00630     MemCopy(lpData, ElemData, ElemSize);
00631     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00632 }
00633 
00634 <span class="comment">// Check the data format is binary or ascii    8/22/95  jjia</span>
00635 
<a name="l00636"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a24">00636</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a195">GetCPElementDataType</a>(CHANDLE CP, SINT Index, <span class="keywordtype">long</span> far *lpDataType)
00637 {
00638     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00639 
00640     <span class="keywordflow">if</span> (lpDataType == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00641     {
00642         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00643         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00644     }
00645 
00646     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00647             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00648     {
00649         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00650     }
00651     ElemData    +=  <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>);
00652     *lpDataType = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d6/d1/structicData.html">icData</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a0">__huge</a> *)ElemData)-&gt;dataFlag);
00653     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00654 }
00655 
<a name="l00656"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a25">00656</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a14">ValidateCPElement</a>(CHANDLE CP, SINT Index)
00657 {
00658     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>    TagSig, DataSig;
00659     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    Result;
00660     <span class="keywordflow">if</span>( <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;TagSig) &amp;&amp;
00661         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;DataSig) )
00662     {
00663         <span class="keywordflow">switch</span>(TagSig)
00664         {
00665             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>:
00666             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a18">icSigAToB1Tag</a>:
00667             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a19">icSigAToB2Tag</a>:
00668             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>:
00669             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>:
00670             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>:
00671             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a32">icSigGamutTag</a>:
00672             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a41">icSigPreview0Tag</a>:
00673             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a42">icSigPreview1Tag</a>:
00674             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a43">icSigPreview2Tag</a>:
00675                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a90">icSigLut16Type</a>) ||
00676                          (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>) ;
00677                 <span class="keywordflow">break</span>;
00678 
00679             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>: 
00680             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>:
00681             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>:
00682             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a36">icSigLuminanceTag</a>:
00683             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a38">icSigMediaBlackPointTag</a>:
00684             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>:
00685                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a107">icSigXYZType</a>);
00686                 <span class="keywordflow">break</span>;
00687 
00688             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>:
00689             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>:
00690             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>:
00691             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>:
00692                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>);
00693                 <span class="keywordflow">break</span>;
00694 
00695             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a46">icSigPs2CRD0Tag</a>:
00696             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a47">icSigPs2CRD1Tag</a>:
00697             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a48">icSigPs2CRD2Tag</a>:
00698             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a49">icSigPs2CRD3Tag</a>:
00699             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a50">icSigPs2CSATag</a>:
00700             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>:
00701             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>:
00702             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>:
00703             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>:
00704                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a88">icSigDataType</a>);
00705                 <span class="keywordflow">break</span>;
00706 
00707             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a28">icSigCharTargetTag</a>:
00708             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a29">icSigCopyrightTag</a>:
00709                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a98">icSigTextType</a>);
00710                 <span class="keywordflow">break</span>;
00711 
00712             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a27">icSigCalibrationDateTimeTag</a>:
00713                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a89">icSigDateTimeType</a>);
00714                 <span class="keywordflow">break</span>;
00715 
00716             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a30">icSigDeviceMfgDescTag</a>:
00717             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a31">icSigDeviceModelDescTag</a>:
00718             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a44">icSigProfileDescriptionTag</a>:
00719             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a57">icSigScreeningDescTag</a>:
00720             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a61">icSigViewingCondDescTag</a>:
00721                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a99">icSigTextDescriptionType</a>);
00722                 <span class="keywordflow">break</span>;
00723 
00724             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a37">icSigMeasurementTag</a>:
00725                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a37">icSigMeasurementTag</a>);
00726                 <span class="keywordflow">break</span>;
00727 
00728             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a40">icSigNamedColorTag</a>:
00729                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a40">icSigNamedColorTag</a>);
00730                 <span class="keywordflow">break</span>;
00731         
00732             <span class="keywordflow">case</span>      <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>:
00733                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>);
00734                 <span class="keywordflow">break</span>;
00735 
00736             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a58">icSigScreeningTag</a>:
00737                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a58">icSigScreeningTag</a>);
00738                 <span class="keywordflow">break</span>;
00739 
00740             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a59">icSigTechnologyTag</a>:
00741                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a97">icSigSignatureType</a>);
00742                 <span class="keywordflow">break</span>;
00743 
00744             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a60">icSigUcrBgTag</a>:
00745                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a60">icSigUcrBgTag</a>);
00746                 <span class="keywordflow">break</span>;
00747 
00748             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a62">icSigViewingConditionsTag</a>:
00749                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a62">icSigViewingConditionsTag</a>);
00750                 <span class="keywordflow">break</span>;
00751 
00752             <span class="keywordflow">default</span>:
00753                 Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00754                 <span class="keywordflow">break</span>;
00755         }
00756     }<span class="keywordflow">else</span>
00757     {
00758         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00759     }
00760     <span class="keywordflow">return</span>(Result);
00761 }
00762 
00763 <span class="comment">//******************************************************************</span>
00764 <span class="comment">// Functions that get all information from the Color Profile Header</span>
00765 <span class="comment">//******************************************************************</span>
<a name="l00766"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a26">00766</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a22">GetCPSize</a>(CHANDLE CP, LPSINT lpSize)
00767 {
00768     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00769     {
00770         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00771         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00772     }
00773     *lpSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;size);
00774     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00775 }
00776 
<a name="l00777"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a27">00777</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a23">GetCPCMMType</a>(CHANDLE CP, LPCSIG lpType)
00778 {
00779     <span class="keywordflow">if</span> (lpType == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00780     {
00781         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00782         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00783     }
00784     *lpType    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;cmmId);
00785     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00786 }
00787 
<a name="l00788"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a28">00788</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a24">GetCPVersion</a>(CHANDLE CP, LPSINT lpVers)
00789 {
00790     <span class="keywordflow">if</span> (lpVers == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00791     {
00792         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00793         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00794     }
00795     *lpVers    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;version);
00796     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00797 }
00798 
<a name="l00799"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a29">00799</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a25">GetCPClass</a>(CHANDLE CP, LPCSIG lpClass)
00800 {
00801     <span class="keywordflow">if</span> (lpClass == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00802     {
00803         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00804         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00805     }
00806     *lpClass    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;deviceClass);
00807     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00808 }
00809 
<a name="l00810"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a30">00810</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a41">GetCPDevSpace</a>(CHANDLE CP, LPCSIG lpInSpace)
00811 {
00812     <span class="keywordflow">if</span> (lpInSpace == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00813     {
00814         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00815         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00816     }
00817     *lpInSpace    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;colorSpace);
00818     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00819 }
00820 
<a name="l00821"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a31">00821</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a>(CHANDLE CP, LPCSIG lpOutSpace)
00822 {
00823     <span class="keywordflow">if</span> (lpOutSpace == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00824     {
00825         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00826         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00827     }
00828     *lpOutSpace    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>);
00829     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00830 }
00831 
<a name="l00832"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a32">00832</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a28">GetCPTarget</a>(CHANDLE CP, LPCSIG lpTarget)
00833 {
00834     <span class="keywordflow">if</span> (lpTarget == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00835     {
00836         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00837         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00838     }
00839     *lpTarget    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;platform);
00840     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00841 }
00842 
<a name="l00843"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a33">00843</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a29">GetCPManufacturer</a>(CHANDLE CP, LPCSIG lpManuf)
00844 {
00845     <span class="keywordflow">if</span> (lpManuf == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00846     {
00847         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00848         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00849     }
00850     *lpManuf    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;manufacturer);
00851     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00852 }
00853 
<a name="l00854"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a34">00854</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a30">GetCPModel</a>(CHANDLE CP, LPCSIG lpModel)
00855 {
00856     <span class="keywordflow">if</span> (lpModel == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00857     {
00858         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00859         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00860     }
00861     *lpModel    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;model);
00862     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00863 }
00864 
<a name="l00865"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a35">00865</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a31">GetCPFlags</a>(CHANDLE CP, LPSINT lpFlags)
00866 {
00867     <span class="keywordflow">if</span> (lpFlags == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00868     {
00869         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00870         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00871     }
00872     *lpFlags    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;flags);
00873     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00874 }
00875 
<a name="l00876"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a36">00876</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a42">GetCPRenderIntent</a>(CHANDLE CP, LPSINT lpIntent)
00877 {
00878     <span class="keywordflow">if</span> (lpIntent == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00879     {
00880         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00881         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00882     }
00883     *lpIntent    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;renderingIntent);
00884     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00885 }
00886 
<a name="l00887"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a37">00887</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a>(CHANDLE CP,  LPSFLOAT lpWP)
00888 {
00889     <span class="keywordflow">if</span> (lpWP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00890     {
00891         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00892         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00893     }
00894     lpWP[0]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.X);
00895     lpWP[1]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.Y);
00896     lpWP[2]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.Z);
00897     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00898 }
00899 
<a name="l00900"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a38">00900</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a32">GetCPAttributes</a>(CHANDLE CP, LPATTRIB lpAttributes)
00901 {
00902     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00903 }
00904 
<a name="l00905"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a39">00905</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a>(CHANDLE cp,  LPSFLOAT lpMediaWP)
00906 {
00907     HGLOBAL   hTempMem;
00908     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      TempSize;
00909     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    TempBuff;
00910     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    lpTable;
00911     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      i, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00912 
00913     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>) &amp;&amp;
00914         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00915         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; TempSize) &amp;&amp;
00916         <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (TempSize, (HGLOBAL *) &amp; hTempMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; TempBuff) &amp;&amp;
00917         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, TempBuff, TempSize))
00918     {
00919         lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp; (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a38">lpcpXYZType</a>) TempBuff)-&gt;data);
00920         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
00921         {
00922             lpMediaWP[i] = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a> (lpTable);
00923             lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a192">icS15Fixed16Number</a>);
00924         }
00925         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hTempMem);
00926         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00927     }
00928     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00929 }
00930 
00931 <span class="comment">/***************************************************************************</span>
00932 <span class="comment">*                               GetPS2ColorRenderingIntent</span>
00933 <span class="comment">*  function:</span>
00934 <span class="comment">*    this is the function which creates the Intent string </span>
00935 <span class="comment">*    from the data supplied in the Profile that can be used</span>
00936 <span class="comment">*    in --findcolorrendering-- operator.</span>
00937 <span class="comment">*  prototype:</span>
00938 <span class="comment">*       BOOL EXTERN GetPS2ColorRenderingIntent(</span>
00939 <span class="comment">*                          char         *FileName,</span>
00940 <span class="comment">*                          DWORD        Intent, </span>
00941 <span class="comment">*                          MEMPTR       lpMem,</span>
00942 <span class="comment">*                          LPDWORD      lpcbSize )</span>
00943 <span class="comment">*  parameters:</span>
00944 <span class="comment">*       FileName    --  Color Profile Filename</span>
00945 <span class="comment">*       Intent      --  Intent </span>
00946 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00947 <span class="comment">*       lpcbSize        --  Size of the memory block</span>
00948 <span class="comment">*                       Returns number of bytes required/transferred</span>
00949 <span class="comment">*  returns:</span>
00950 <span class="comment">*       BOOL        --  TRUE   if the function was successful,</span>
00951 <span class="comment">*                       FALSE  otherwise.</span>
00952 <span class="comment">***************************************************************************/</span>
<a name="l00953"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a40">00953</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a28">GetPS2ColorRenderingIntent</a>(CHANDLE cp, DWORD Intent,
00954                                        MEMPTR lpMem, LPDWORD lpcbSize)
00955 {
00956     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>       <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00957     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>       <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00958         
00959     <span class="keywordflow">if</span> (!cp)
00960         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00961 
00962     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) *lpcbSize;
00963     <span class="keywordflow">if</span>( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) || ( <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> == 0 ) )
00964     {
00965         lpMem = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00966         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = 0;
00967         *lpcbSize = 0;
00968     }
00969         
00970     <span class="keywordflow">switch</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>)
00971     {
00972         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00973         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>) &amp;&amp;
00974             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00975             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00976             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00977                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
00978         {
00979         }
00980         <span class="keywordflow">break</span>;
00981         
00982         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00983         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>) &amp;&amp;
00984             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00985             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00986             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00987                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
00988         {
00989         }
00990         <span class="keywordflow">break</span>;
00991     
00992         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00993         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>) &amp;&amp;
00994             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00995             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00996             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00997                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> ) )
00998           )
00999         {
01000         }
01001         <span class="keywordflow">break</span>;
01002         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
01003         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>) &amp;&amp;
01004             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
01005             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
01006             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
01007                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
01008         {
01009         }
01010         <span class="keywordflow">break</span>;
01011         <span class="keywordflow">default</span>:
01012             <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = 0 ;
01013         <span class="keywordflow">break</span>;
01014     }
01015         
01016     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> != 0)
01017     {
01018         <span class="keywordflow">if</span> (lpMem)
01019         {
01020             lpMem[<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>] = <span class="charliteral">'\0'</span>;
01021         }
01022         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> ++;
01023         *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
01024         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01025     }
01026     <span class="keywordflow">else</span>
01027     {
01028         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01029     }
01030 }
01031 
01032 <span class="comment">/***************************************************************************</span>
01033 <span class="comment">*</span>
01034 <span class="comment">*  Function to check if color matching mathod and icc profile type is </span>
01035 <span class="comment">*       supported by driver.</span>
01036 <span class="comment">*  parameters:</span>
01037 <span class="comment">*</span>
01038 <span class="comment">*  returns:</span>
01039 <span class="comment">*       BOOL:   TRUE or FALSE.</span>
01040 <span class="comment">*</span>
01041 <span class="comment">***************************************************************************/</span>
01042 
01043 <span class="preprocessor">#ifndef ICMDLL</span>
<a name="l01044"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a41">01044</a> <span class="preprocessor"></span><a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a40">ValidColorSpace</a>(LPPDEVICE lppd, <a class="code" href="../../d0/d7/structtagICMINFO.html">LPICMINFO</a> lpICMI, LPCSIG lpDevCS )
01045 {
01046     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
01047     HFILE       hFile;
01048     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res;
01049     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>        CPColorSpaceTag;
01050 
01051     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpICMI)
01052     {
01053         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01054     }
01055     hFile = _lopen(lpICMI-&gt;<a class="code" href="../../d0/d7/structtagICMINFO.html#o2">lcsDestFilename</a>, READ);
01056     <span class="keywordflow">if</span>( hFile == HFILE_ERROR )
01057     {
01058         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01059     }
01060 
01061     Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader));
01062     _lclose(hFile);
01063     <span class="keywordflow">if</span>( (Res == HFILE_ERROR) || (Res != <span class="keyword">sizeof</span>(CPHeader)) )
01064     {
01065         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01066     }
01067 
01068     <span class="comment">// Make the initial check for validity of the profile</span>
01069     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
01070     {
01071         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01072     }
01073     <span class="comment">// Make sure the profile is 'prtr'</span>
01074     <span class="comment">// SRGB98</span>
01075     <span class="comment">// if( SigtoCSIG(CPHeader.deviceClass) != icSigOutputClass )</span>
01076     <span class="comment">// {</span>
01077     <span class="comment">//     return(FALSE);</span>
01078     <span class="comment">// }</span>
01079     CPColorSpaceTag = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.colorSpace);
01080     *lpDevCS = CPColorSpaceTag;             <span class="comment">// 247974</span>
01081 
01082     <span class="keywordflow">switch</span> ( lppd-&gt;lpPSExtDevmode-&gt;dm.iColorMatchingMethod )
01083     {
01084         <span class="keywordflow">case</span> COLOR_MATCHING_ON_HOST:
01085             <span class="keywordflow">if</span> ((CPColorSpaceTag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>))
01086 <span class="comment">//                (CPColorSpaceTag == icSigRgbData))</span>
01087 <span class="comment">//                (CPColorSpaceTag == icSigGrayData))</span>
01088             {
01089                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01090             }
01091             <span class="keywordflow">break</span>;
01092             <span class="keywordflow">case</span> COLOR_MATCHING_ON_PRINTER:
01093             <span class="keywordflow">if</span> ((CPColorSpaceTag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>))
01094 <span class="comment">//                (CPColorSpaceTag == icSigGrayData))</span>
01095             {
01096                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01097             }
01098             <span class="keywordflow">break</span>;
01099         <span class="keywordflow">case</span> COLOR_MATCHING_PRINTER_CALIBRATION:
01100         <span class="keywordflow">default</span>:
01101             <span class="keywordflow">break</span>;
01102     }
01103     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01104 }
01105 <span class="preprocessor">#endif</span>
01106 <span class="preprocessor"></span>
01107 <span class="comment">//***************************************************************************</span>
01108 <span class="comment">//</span>
01109 <span class="comment">//      Set of functions to output data into memory buffer</span>
01110 <span class="comment">//</span>
01111 <span class="comment">//***************************************************************************</span>
01112 
01113 
01114 <span class="comment">/***************************************************************************</span>
01115 <span class="comment">*</span>
01116 <span class="comment">*   Function to put the chunk of memory as string of Hex</span>
01117 <span class="comment">*</span>
01118 <span class="comment">***************************************************************************/</span>
<a name="l01119"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a42">01119</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a227">WriteHexBuffer</a>(MEMPTR lpMem, MEMPTR lpBuff, MEMPTR lpLineStart, DWORD dwBytes)
01120 {
01121     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01122     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01123     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>  lpOldPtr = lpMem;
01124 
01125     <span class="keywordflow">for</span> ( ; dwBytes ; dwBytes-- )
01126     {
01127         Res = wsprintf( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)TempArray, (LPSTR) <span class="stringliteral">"%2.2x"</span>, *lpBuff );
01128         *lpMem++ = TempArray[0];
01129         *lpMem++ = TempArray[1];
01130         lpBuff++;
01131         <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
01132         {
01133             lpLineStart = lpMem;
01134             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(lpMem,  <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01135         }
01136     }
01137     <span class="keywordflow">return</span>( (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(lpMem - lpOldPtr)); 
01138 }
01139 
01140 <span class="comment">/***************************************************************************</span>
01141 <span class="comment">*</span>
01142 <span class="comment">*   Function to put the string into the buffer</span>
01143 <span class="comment">*</span>
01144 <span class="comment">***************************************************************************/</span>
<a name="l01145"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a43">01145</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a>(MEMPTR lpMem, MEMPTR Obj)
01146 {
01147     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res1, Res2;
01148 
01149     Res1 = lstrlen(<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01150     MemCopy(lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>, Res1);
01151 
01152     lpMem += Res1;
01153     Res2 = lstrlen(Obj);
01154     MemCopy(lpMem, Obj, Res2);
01155     <span class="keywordflow">return</span>( Res1 + Res2 );
01156 }
01157 
<a name="l01158"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a44">01158</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(MEMPTR lpMem, MEMPTR Obj)
01159 {
01160     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01161 
01162     Res = lstrlen(Obj);
01163     MemCopy(lpMem, Obj, Res);
01164     <span class="keywordflow">return</span>( Res );
01165 }
01166 
<a name="l01167"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a45">01167</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a44">WriteObjectN</a>(MEMPTR lpMem, MEMPTR Obj, SINT n)
01168 {
01169     MemCopy(lpMem, Obj, <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>);
01170     <span class="keywordflow">return</span>( <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> );
01171 }
01172 <span class="comment">/***************************************************************************</span>
01173 <span class="comment">*</span>
01174 <span class="comment">*   Function to write the integer into the buffer</span>
01175 <span class="comment">*</span>
01176 <span class="comment">***************************************************************************/</span>
<a name="l01177"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a46">01177</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a>(MEMPTR lpMem, SINT Number)
01178 {
01179     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01180     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01181     
01182     Res = wsprintf( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)TempArray, <span class="stringliteral">"%lu "</span>, Number );
01183     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01184     <span class="keywordflow">return</span>( Res );
01185 }
01186 
01187 <span class="comment">/***************************************************************************</span>
01188 <span class="comment">*</span>
01189 <span class="comment">*   Function to write the integer into the buffer as hex</span>
01190 <span class="comment">*</span>
01191 <span class="comment">***************************************************************************/</span>
<a name="l01192"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a47">01192</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d2/d9/ps2_8c.html#a45">WriteHex</a>(MEMPTR lpMem, SINT Number)
01193 {
01194     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01195     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01196 
01197     Res = wsprintf( TempArray, <span class="stringliteral">"%2.2x"</span>, (<span class="keywordtype">int</span>)(Number &amp; 0x00FF) );
01198     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01199     <span class="keywordflow">return</span>( Res );
01200 }
01201 
01202 <span class="comment">/***************************************************************************</span>
01203 <span class="comment">*</span>
01204 <span class="comment">*   Function to write the float into the buffer</span>
01205 <span class="comment">*</span>
01206 <span class="comment">***************************************************************************/</span>
01207 
<a name="l01208"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a48">01208</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a46">WriteFloat</a>(MEMPTR lpMem, <span class="keywordtype">double</span> dFloat)
01209 {
01210     <span class="keywordtype">char</span>    cSign;
01211     <span class="keywordtype">double</span>  dInt ;
01212     <span class="keywordtype">double</span>  dFract ;
01213     LONG    lFloat ;
01214     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01215     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01216 
01217     lFloat = (LONG) floor( dFloat * 10000.0 + 0.5);
01218 
01219     dFloat = lFloat  / 10000.0 ;
01220 
01221     dInt = floor(fabs(dFloat));
01222     dFract =  fabs(dFloat) - dInt ;
01223 
01224     cSign   = <span class="charliteral">' '</span> ;
01225     <span class="keywordflow">if</span> ( dFloat &lt; 0 )
01226     {
01227         cSign   = <span class="charliteral">'-'</span> ;
01228     }
01229 
01230     Res = wsprintf( (LPSTR) TempArray, (LPSTR) <span class="stringliteral">"%c%d.%0.4lu "</span>,
01231        cSign, (WORD) dInt , (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) (dFract *10000.0)  );
01232     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01233     <span class="keywordflow">return</span> ( Res );
01234 }
01235 
01236 <span class="comment">/***************************************************************************</span>
01237 <span class="comment">*</span>
01238 <span class="comment">*   Function to write the string token into the buffer</span>
01239 <span class="comment">*</span>
01240 <span class="comment">***************************************************************************/</span>
01241 
<a name="l01242"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a49">01242</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a228">WriteStringToken</a>(MEMPTR lpMem, BYTE Token, SINT sNum)
01243 {
01244     *lpMem++ = <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
01245     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((sNum &amp; 0xFF00) &gt;&gt; 8);
01246     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(sNum &amp; 0x00FF);
01247     <span class="keywordflow">return</span> (3);
01248 }
01249 
01250 <span class="comment">/***************************************************************************</span>
01251 <span class="comment">*</span>
01252 <span class="comment">*   Function to write the Homogeneous Number Array token into the buffer</span>
01253 <span class="comment">*</span>
01254 <span class="comment">***************************************************************************/</span>
01255 
<a name="l01256"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a50">01256</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a224">WriteHNAToken</a>(MEMPTR lpMem, BYTE Token, SINT sNum)
01257 {
01258     *lpMem++ = <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
01259     *lpMem++ = 32;       <span class="comment">// 16-bit fixed integer, high-order byte first</span>
01260     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((sNum &amp; 0xFF00) &gt;&gt; 8);
01261     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(sNum &amp; 0x00FF);
01262     <span class="keywordflow">return</span> (4);
01263 }
01264 
01265 <span class="comment">/***************************************************************************</span>
01266 <span class="comment">*</span>
01267 <span class="comment">*   Function to convert 2-bytes unsigned integer to 2-bytes signed </span>
01268 <span class="comment">*   integer(-32768) and write them to the buffer. High byte first.</span>
01269 <span class="comment">*</span>
01270 <span class="comment">***************************************************************************/</span>
01271 
<a name="l01272"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a51">01272</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a225">WriteIntStringU2S</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sNum)
01273 {
01274     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01275     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Temp;
01276 
01277     <span class="keywordflow">for</span> (i = 0; i &lt; sNum; i ++)
01278     {
01279         Temp = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a>( lpBuff) - 32768;
01280         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((Temp &amp; 0xFF00) &gt;&gt; 8);
01281         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(Temp &amp; 0x00FF);
01282         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01283     }
01284     <span class="keywordflow">return</span>(sNum * 2); 
01285 }
01286 
01287 <span class="comment">/***************************************************************************</span>
01288 <span class="comment">*</span>
01289 <span class="comment">*   Function to convert 2-bytes unsigned integer to 2-bytes signed </span>
01290 <span class="comment">*   integer(-32768) and write them to the buffer. Low-order byte first.</span>
01291 <span class="comment">*</span>
01292 <span class="comment">***************************************************************************/</span>
01293 
<a name="l01294"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a52">01294</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a226">WriteIntStringU2S_L</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sNum)
01295 {
01296     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01297     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Temp;
01298 
01299     <span class="keywordflow">for</span> (i = 0; i &lt; sNum; i ++)
01300     {
01301         Temp = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>)lpBuff) - 32768;
01302         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((Temp &amp; 0xFF00) &gt;&gt; 8);
01303         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(Temp &amp; 0x00FF);
01304         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01305     }
01306     <span class="keywordflow">return</span>(sNum * 2); 
01307 }
01308 
01309 <span class="comment">/***************************************************************************</span>
01310 <span class="comment">*</span>
01311 <span class="comment">*   Function to put the chunk of memory into buffer</span>
01312 <span class="comment">*</span>
01313 <span class="comment">***************************************************************************/</span>
<a name="l01314"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a53">01314</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a229">WriteByteString</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sBytes)
01315 {
01316     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01317 
01318     <span class="keywordflow">for</span> (i = 0; i &lt; sBytes; i ++)
01319         *lpMem++ = *lpBuff++;
01320     
01321     <span class="keywordflow">return</span>(sBytes); 
01322 }
01323 
01324 <span class="comment">/***************************************************************************</span>
01325 <span class="comment">*</span>
01326 <span class="comment">*   Function to put the chunk of memory into buffer</span>
01327 <span class="comment">*</span>
01328 <span class="comment">***************************************************************************/</span>
<a name="l01329"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a54">01329</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a230">WriteInt2ByteString</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sBytes)
01330 {
01331     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01332 
01333        <span class="keywordflow">for</span>( i = 0; i &lt; sBytes ; i++)
01334     {
01335         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a>( lpBuff)/256) ;
01336         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01337     }
01338     <span class="keywordflow">return</span>(sBytes); 
01339 }
01340 
01341 <span class="comment">/***************************************************************************</span>
01342 <span class="comment">*</span>
01343 <span class="comment">*  Function to control ascii85 encoding.</span>
01344 <span class="comment">*  parameters:</span>
01345 <span class="comment">*       lpDest      --  Pointer to the encording result buffer.</span>
01346 <span class="comment">*       BufSize     --  Size of encording result buffer. </span>
01347 <span class="comment">*       lpSource    --  Pointer to the input buffer</span>
01348 <span class="comment">*       DataSize    --  Size of the input buffer</span>
01349 <span class="comment">*  returns:</span>
01350 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01351 <span class="comment">*</span>
01352 <span class="comment">****************************************************************************/</span>
01353 
<a name="l01354"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a55">01354</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a55">WriteASCII85Cont</a>(MEMPTR lpDest, SINT BufSize, MEMPTR lpSource, SINT DataSize)
01355 {
01356    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     incount;
01357    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   lpPtr, lpSave;
01358    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     rem;
01359    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     bcount;
01360    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     dex;
01361    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> word;
01362    
01363    <span class="comment">/* encode the initial 4-tuples */</span>
01364    lpSave = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01365    lpPtr  = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>;
01366    word   = 0UL;
01367    bcount = 0;
01368 
01369    <span class="keywordflow">for</span> (incount = 0; incount &lt; DataSize; incount ++)
01370    {
01371       <span class="keywordflow">if</span> ( incount  &amp;&amp; ((incount % <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a2">LINELENG</a>) == 0) )
01372       <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>,  <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01373       word = (word&lt;&lt;8);
01374       word |= (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)*lpPtr++;
01375       <span class="keywordflow">if</span> (bcount == 3)
01376       {
01377          <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>, word, 5);
01378          word = 0UL;
01379          bcount = 0;
01380       }
01381       <span class="keywordflow">else</span>
01382       {
01383          bcount ++;
01384       }
01385    }
01386    
01387    <span class="comment">/* now do the last partial 4-tuple -- if there is one */</span>
01388    <span class="comment">/* see the Red Book spec for the rules on how this is done */</span>
01389    <span class="keywordflow">if</span> (bcount &gt; 0)
01390    {
01391       rem = 4 - bcount;  <span class="comment">/* count the remaining bytes */</span>
01392       <span class="keywordflow">for</span> (dex = 0; dex &lt; rem; dex ++) <span class="comment">/* shift left for each of them */</span>
01393       {
01394          word = (word&lt;&lt;8);      <span class="comment">/* (equivalent to adding in ZERO's)*/</span>
01395          word |= (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)32;
01396       }
01397 <span class="comment">//      lpDest += WriteAscii85(lpDest, word, (bcount + 1));  /* output only meaningful</span>
01398       <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>, word, 5);               <span class="comment">/* output only meaningful bytes + 1 */</span>
01399    }
01400    <span class="keywordflow">return</span> (<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> - lpSave);
01401 }
01402 
01403 <span class="comment">/************************************************************************</span>
01404 <span class="comment">*</span>
01405 <span class="comment">*  Function to convert 4 bytes binary data to 5 bytes ascii85 encorded data.</span>
01406 <span class="comment">*  parameters:</span>
01407 <span class="comment">*       lpDest      --  Pointer to the encording result buffer.</span>
01408 <span class="comment">*       inWord      --  Input word (4-bytes) </span>
01409 <span class="comment">*       nBytes      --  Number of bytes should be outputed.</span>
01410 <span class="comment">*  returns:</span>
01411 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01412 <span class="comment">* </span>
01413 <span class="comment">*************************************************************************/</span>
01414 
<a name="l01415"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a56">01415</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(MEMPTR lpDest, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> inWord, SINT nBytes)
01416 {
01417     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> divisor;
01418     <span class="keywordtype">int</span>      bcount;
01419     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>     outchar;
01420     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   lpSave = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01421 
01422     <span class="keywordflow">if</span> ((inWord == 0UL) &amp;&amp; (nBytes == 5))
01423         *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = <span class="charliteral">'z'</span>;
01424     <span class="keywordflow">else</span>
01425     {
01426         divisor = 52200625UL;
01427         <span class="keywordflow">for</span> (bcount = 0; bcount &lt; nBytes; bcount ++)
01428         { 
01429             outchar = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((<span class="keywordtype">int</span>)(inWord/divisor) + (<span class="keywordtype">int</span>)<span class="charliteral">'!'</span>);
01430             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = outchar;
01431             <span class="keywordflow">if</span> (bcount &lt; 4)
01432             {
01433                 inWord = (inWord % divisor);
01434                 divisor =(divisor / 85);
01435             }
01436         }
01437     }
01438     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> - lpSave);
01439 }
01440 
01441 <span class="comment">/***************************************************************************</span>
01442 <span class="comment">*</span>
01443 <span class="comment">*  Function to convert binary data to ascii by performing ASCII85 encording</span>
01444 <span class="comment">*  parameters:</span>
01445 <span class="comment">*       lpMem       --  A pointer to the buffer. </span>
01446 <span class="comment">*                       as input: contains binary data; </span>
01447 <span class="comment">*                       as output: contains ascii data. </span>
01448 <span class="comment">*       DataSize    --  The size of input binary data. </span>
01449 <span class="comment">*       BufSize     --  The size of buffer pointed by lpMem.</span>
01450 <span class="comment">*  returns:</span>
01451 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01452 <span class="comment">*</span>
01453 <span class="comment">***************************************************************************/</span>
01454 
<a name="l01455"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a57">01455</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a54">ConvertBinaryData2Ascii</a>(MEMPTR lpMem, SINT DataSize, SINT BufSize)
01456 {
01457     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      intrbuf, Temp;
01458     HANDLE      intrhandle;
01459     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        AsciiDataSize = 0;
01460 
01461     <span class="keywordflow">if</span> (BufSize &gt;= (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(DataSize/4*5 + <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>)+<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>) + 2048))
01462     {
01463         <span class="keywordflow">if</span> ((intrhandle = GlobalAlloc(GHND, BufSize)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01464         {
01465             <span class="keywordflow">if</span> ((intrbuf = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) GlobalLock(intrhandle)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01466             {
01467                 Temp = intrbuf;
01468                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01469                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>);
01470                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01471                 Temp += <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a55">WriteASCII85Cont</a>(Temp, BufSize, lpMem, DataSize);
01472                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>);
01473                 AsciiDataSize = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(Temp - intrbuf);
01474                 lstrcpyn(lpMem, intrbuf, (WORD)AsciiDataSize); 
01475                 GlobalUnlock(intrhandle);
01476             }
01477         }
01478         GlobalFree(intrhandle);
01479    }
01480    <span class="keywordflow">return</span> (AsciiDataSize);
01481 }
01482 
01483 <span class="comment">/***************************************************************************</span>
01484 <span class="comment">*</span>
01485 <span class="comment">*  Function to check if it is need to convert a CRD from binary to ascii</span>
01486 <span class="comment">*  parameters:</span>
01487 <span class="comment">*       CP          --  Handle of memory block which contains icm profile.</span>
01488 <span class="comment">*       Index       --  Index of the element data of the profile.</span>
01489 <span class="comment">*       lpData      --  A pointer to the buffer. </span>
01490 <span class="comment">*                       as input: contains binary data; </span>
01491 <span class="comment">*                       as output: contains ascii data. </span>
01492 <span class="comment">*       BufSize     --  The size of the buffer pointed by lpData.</span>
01493 <span class="comment">*       DataSize    --  The size of input binary data.</span>
01494 <span class="comment">*       AllowBinary --  Allow binary or not(1/0).</span>
01495 <span class="comment">*  returns:</span>
01496 <span class="comment">*       SINT        --  Number of bytes required/actually outputed.</span>
01497 <span class="comment">*</span>
01498 <span class="comment">***************************************************************************/</span>
01499 
<a name="l01500"></a><a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a58">01500</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a55">Convert2Ascii</a>(CHANDLE CP, SINT Index,
01501                       MEMPTR lpData, SINT BufSize, 
01502                       SINT DataSize, BOOL AllowBinary)
01503 {
01504     <span class="keywordtype">long</span>    DataType;
01505 
01506     <a class="code" href="../../d2/d9/ps2_8c.html#a195">GetCPElementDataType</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, &amp;DataType);
01507     <span class="keywordflow">if</span> (BufSize == 0)
01508     {
01509         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)
01510             <span class="keywordflow">return</span> (DataSize);
01511         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DataType == 0)    <span class="comment">// Ascii data in Profile </span>
01512             <span class="keywordflow">return</span> (DataSize);
01513         <span class="keywordflow">else</span>                       <span class="comment">// Keep space for ascii85 encoding.</span>
01514             <span class="keywordflow">return</span> (DataSize / 4 * 5 + <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>)+<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d9/jan99_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>) + 2048);
01515     }
01516     <span class="keywordflow">else</span>
01517     {
01518         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)
01519             <span class="keywordflow">return</span> (DataSize);
01520         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(DataType == 0) 
01521             <span class="keywordflow">return</span> (DataSize);
01522         <span class="keywordflow">else</span> 
01523             <span class="keywordflow">return</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a54">ConvertBinaryData2Ascii</a>(lpData, DataSize, BufSize) );
01524     }
01525 }
01526 
01527 <span class="preprocessor">#ifdef ICMDLL</span>
01528 <span class="preprocessor"></span><a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    MemCopy(MEMPTR Dest, MEMPTR Source, SINT Length)
01529 {
01530     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01531 
01532     <span class="keywordflow">for</span> (i = 0; i &lt; Length; i++)
01533     {
01534         Dest[i] = Source[i];
01535     }
01536     <span class="keywordflow">return</span>( Length );
01537 }
01538 
01539 <span class="comment">// SRGB98</span>
01540 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a56">InvertMatrix</a> (<span class="keywordtype">double</span> FAR * lpInMatrix,
01541                    <span class="keywordtype">double</span> FAR * lpOutMatrix)
01542 {
01543     <span class="keywordtype">double</span> det;
01544 
01545     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *a;
01546     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *b;
01547     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>;
01548     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpInMatrix) ||
01549         (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpOutMatrix))
01550     {
01551         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01552     }
01553     a = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[0]);
01554     b = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[3]);
01555     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[6]);
01556 
01557     det = a[0] * b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] + a[1] * b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0] + a[2] * b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] -
01558         (a[2] * b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0] + a[1] * b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] + a[0] * b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]);
01559 
01560     <span class="keywordflow">if</span> (det == 0.0)                     <span class="comment">// What to do?</span>
01561     {
01562         lpOutMatrix[0] = 1.0;
01563         lpOutMatrix[1] = 0.0;
01564         lpOutMatrix[2] = 0.0;
01565 
01566         lpOutMatrix[3] = 0.0;
01567         lpOutMatrix[4] = 1.0;
01568         lpOutMatrix[5] = 0.0;
01569 
01570         lpOutMatrix[6] = 0.0;
01571         lpOutMatrix[7] = 0.0;
01572         lpOutMatrix[8] = 1.0;
01573         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01574     } <span class="keywordflow">else</span>
01575     {
01576         lpOutMatrix[0] = (b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]) / det;
01577         lpOutMatrix[3] = -(b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01578         lpOutMatrix[6] = (b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] - b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01579 
01580         lpOutMatrix[1] = -(a[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - a[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]) / det;
01581         lpOutMatrix[4] = (a[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - a[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01582         lpOutMatrix[7] = -(a[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] - a[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01583 
01584         lpOutMatrix[2] = (a[1] * b[2] - a[2] * b[1]) / det;
01585         lpOutMatrix[5] = -(a[0] * b[2] - a[2] * b[0]) / det;
01586         lpOutMatrix[8] = (a[0] * b[1] - a[1] * b[0]) / det;
01587         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01588     }
01589 }
01590 
01591 <span class="comment">/*</span>
01592 <span class="comment"> *  Crc - 32 BIT ANSI X3.66 CRC checksum files</span>
01593 <span class="comment"> *</span>
01594 <span class="comment"> *</span>
01595 <span class="comment"> * Copyright (C) 1986 Gary S. Brown.  You may use this program, or</span>
01596 <span class="comment"> * code or tables extracted from it, as desired without restriction.</span>
01597 <span class="comment"> */</span>
01598 
01599 <span class="keyword">static</span> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  crc_32_tab[] = { <span class="comment">/* CRC polynomial 0xedb88320 */</span>
01600 0x00000000, 0x77073096, 0xee0e612c, 0x990951ba, 0x076dc419, 0x706af48f, 0xe963a535, 0x9e6495a3,
01601 0x0edb8832, 0x79dcb8a4, 0xe0d5e91e, 0x97d2d988, 0x09b64c2b, 0x7eb17cbd, 0xe7b82d07, 0x90bf1d91,
01602 0x1db71064, 0x6ab020f2, 0xf3b97148, 0x84be41de, 0x1adad47d, 0x6ddde4eb, 0xf4d4b551, 0x83d385c7,
01603 0x136c9856, 0x646ba8c0, 0xfd62f97a, 0x8a65c9ec, 0x14015c4f, 0x63066cd9, 0xfa0f3d63, 0x8d080df5,
01604 0x3b6e20c8, 0x4c69105e, 0xd56041e4, 0xa2677172, 0x3c03e4d1, 0x4b04d447, 0xd20d85fd, 0xa50ab56b,
01605 0x35b5a8fa, 0x42b2986c, 0xdbbbc9d6, 0xacbcf940, 0x32d86ce3, 0x45df5c75, 0xdcd60dcf, 0xabd13d59,
01606 0x26d930ac, 0x51de003a, 0xc8d75180, 0xbfd06116, 0x21b4f4b5, 0x56b3c423, 0xcfba9599, 0xb8bda50f,
01607 0x2802b89e, 0x5f058808, 0xc60cd9b2, 0xb10be924, 0x2f6f7c87, 0x58684c11, 0xc1611dab, 0xb6662d3d,
01608 0x76dc4190, 0x01db7106, 0x98d220bc, 0xefd5102a, 0x71b18589, 0x06b6b51f, 0x9fbfe4a5, 0xe8b8d433,
01609 0x7807c9a2, 0x0f00f934, 0x9609a88e, 0xe10e9818, 0x7f6a0dbb, 0x086d3d2d, 0x91646c97, 0xe6635c01,
01610 0x6b6b51f4, 0x1c6c6162, 0x856530d8, 0xf262004e, 0x6c0695ed, 0x1b01a57b, 0x8208f4c1, 0xf50fc457,
01611 0x65b0d9c6, 0x12b7e950, 0x8bbeb8ea, 0xfcb9887c, 0x62dd1ddf, 0x15da2d49, 0x8cd37cf3, 0xfbd44c65,
01612 0x4db26158, 0x3ab551ce, 0xa3bc0074, 0xd4bb30e2, 0x4adfa541, 0x3dd895d7, 0xa4d1c46d, 0xd3d6f4fb,
01613 0x4369e96a, 0x346ed9fc, 0xad678846, 0xda60b8d0, 0x44042d73, 0x33031de5, 0xaa0a4c5f, 0xdd0d7cc9,
01614 0x5005713c, 0x270241aa, 0xbe0b1010, 0xc90c2086, 0x5768b525, 0x206f85b3, 0xb966d409, 0xce61e49f,
01615 0x5edef90e, 0x29d9c998, 0xb0d09822, 0xc7d7a8b4, 0x59b33d17, 0x2eb40d81, 0xb7bd5c3b, 0xc0ba6cad,
01616 0xedb88320, 0x9abfb3b6, 0x03b6e20c, 0x74b1d29a, 0xead54739, 0x9dd277af, 0x04db2615, 0x73dc1683,
01617 0xe3630b12, 0x94643b84, 0x0d6d6a3e, 0x7a6a5aa8, 0xe40ecf0b, 0x9309ff9d, 0x0a00ae27, 0x7d079eb1,
01618 0xf00f9344, 0x8708a3d2, 0x1e01f268, 0x6906c2fe, 0xf762575d, 0x806567cb, 0x196c3671, 0x6e6b06e7,
01619 0xfed41b76, 0x89d32be0, 0x10da7a5a, 0x67dd4acc, 0xf9b9df6f, 0x8ebeeff9, 0x17b7be43, 0x60b08ed5,
01620 0xd6d6a3e8, 0xa1d1937e, 0x38d8c2c4, 0x4fdff252, 0xd1bb67f1, 0xa6bc5767, 0x3fb506dd, 0x48b2364b,
01621 0xd80d2bda, 0xaf0a1b4c, 0x36034af6, 0x41047a60, 0xdf60efc3, 0xa867df55, 0x316e8eef, 0x4669be79,
01622 0xcb61b38c, 0xbc66831a, 0x256fd2a0, 0x5268e236, 0xcc0c7795, 0xbb0b4703, 0x220216b9, 0x5505262f,
01623 0xc5ba3bbe, 0xb2bd0b28, 0x2bb45a92, 0x5cb36a04, 0xc2d7ffa7, 0xb5d0cf31, 0x2cd99e8b, 0x5bdeae1d,
01624 0x9b64c2b0, 0xec63f226, 0x756aa39c, 0x026d930a, 0x9c0906a9, 0xeb0e363f, 0x72076785, 0x05005713,
01625 0x95bf4a82, 0xe2b87a14, 0x7bb12bae, 0x0cb61b38, 0x92d28e9b, 0xe5d5be0d, 0x7cdcefb7, 0x0bdbdf21,
01626 0x86d3d2d4, 0xf1d4e242, 0x68ddb3f8, 0x1fda836e, 0x81be16cd, 0xf6b9265b, 0x6fb077e1, 0x18b74777,
01627 0x88085ae6, 0xff0f6a70, 0x66063bca, 0x11010b5c, 0x8f659eff, 0xf862ae69, 0x616bffd3, 0x166ccf45,
01628 0xa00ae278, 0xd70dd2ee, 0x4e048354, 0x3903b3c2, 0xa7672661, 0xd06016f7, 0x4969474d, 0x3e6e77db,
01629 0xaed16a4a, 0xd9d65adc, 0x40df0b66, 0x37d83bf0, 0xa9bcae53, 0xdebb9ec5, 0x47b2cf7f, 0x30b5ffe9,
01630 0xbdbdf21c, 0xcabac28a, 0x53b39330, 0x24b4a3a6, 0xbad03605, 0xcdd70693, 0x54de5729, 0x23d967bf,
01631 0xb3667a2e, 0xc4614ab8, 0x5d681b02, 0x2a6f2b94, 0xb40bbe37, 0xc30c8ea1, 0x5a05df1b, 0x2d02ef8d
01632 };
01633 
01634 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a>  PASCAL  <a class="code" href="../../d2/d9/ps2_8c.html#a253">crc32</a>(MEMPTR buff, DWORD  length)
01635 {
01636   <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  crc, charcnt;
01637   <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>;
01638 
01639 
01640   crc = 0xFFFFFFFF;
01641   charcnt = 0;
01642 
01643   <span class="keywordflow">for</span> (charcnt = 0 ; charcnt &lt; length ; charcnt++)
01644   {
01645     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = buff[charcnt] ;
01646     crc = crc_32_tab[(crc ^ <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>) &amp; 0xff] ^ (crc &gt;&gt; 8);
01647   }
01648 
01649   <span class="keywordflow">return</span> crc;
01650 }
01651 <span class="preprocessor">#endif</span>
01652 <span class="preprocessor"></span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:36 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
