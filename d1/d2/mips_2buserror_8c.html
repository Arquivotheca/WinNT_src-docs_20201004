<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mips/buserror.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>buserror.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>

<p>
<a href="../../d2/d1/mips_2buserror_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d2/mips_2buserror_8c.html#a0">KeBusError</a> (IN PEXCEPTION_RECORD ExceptionRecord, IN PKEXCEPTION_FRAME ExceptionFrame, IN PKTRAP_FRAME TrapFrame, IN PVOID VirtualAddress, IN PHYSICAL_ADDRESS PhysicalAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PHYSICAL_ADDRESS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d2/mips_2buserror_8c.html#a1">KiGetPhysicalAddress</a> (IN PVOID VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d2/mips_2buserror_8c.html#a2">KiDataBusError</a> (IN PEXCEPTION_RECORD ExceptionRecord, IN PKEXCEPTION_FRAME ExceptionFrame, IN PKTRAP_FRAME TrapFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d2/mips_2buserror_8c.html#a3">KiInstructionBusError</a> (IN PEXCEPTION_RECORD ExceptionRecord, IN PKEXCEPTION_FRAME ExceptionFrame, IN PKTRAP_FRAME TrapFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d2/mips_2buserror_8c.html#a4">KeSetCacheErrorRoutine</a> (IN PKCACHE_ERROR_ROUTINE Routine)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="mips/buserror.c::KeBusError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeBusError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>VirtualAddress</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHYSICAL_ADDRESS&nbsp;</td>
          <td class="mdname" nowrap> <em>PhysicalAddress</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00029">29</a> of file <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html">mips/buserror.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>.
<p>
Referenced by <a class="el" href="../../d0/d2/mips_2initkr_8c-source.html#l00041">KiInitializeKernel()</a>.
<p>
<pre class="fragment"><div>00039                    :
00040 
00041     This function provides <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">default</span> bus error handling routine <span class="keywordflow">for</span> NT.
00042 
00043     N.B. There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no <span class="keywordflow">return</span> from <span class="keyword">this</span> routine.
00044 
00045 Arguments:
00046 
00047     ExceptionRecord - Supplies a pointer to an exception record.
00048 
00049     ExceptionFrame - Supplies a pointer to an exception frame.
00050 
00051     TrapFrame - Supplies a pointer to a trap frame.
00052 
00053     VirtualAddress - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">virtual</span> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bus error.
00054 
00055     PhysicalAddress - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> physical address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bus error.
00056 
00057 Return Value:
00058 
00059     None.
00060 
00061 --*/
00062 
00063 {
00064 
00065     <span class="comment">//</span>
00066     <span class="comment">// Bug check specifying the exception code, the virtual address, the</span>
00067     <span class="comment">// low part of the physical address, the current processor state, and</span>
00068     <span class="comment">// the exception PC.</span>
00069     <span class="comment">//</span>
00070 
00071     <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(ExceptionRecord-&gt;ExceptionCode &amp; 0xffff,
00072                  (ULONG)VirtualAddress,
00073                  PhysicalAddress.LowPart,
00074                  TrapFrame-&gt;Psr,
00075                  TrapFrame-&gt;Fir);
00076 
00077     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00078 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mips/buserror.c::KeSetCacheErrorRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetCacheErrorRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKCACHE_ERROR_ROUTINE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Routine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00280">280</a> of file <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html">mips/buserror.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00592">KSEG1_BASE</a>.
<p>
<pre class="fragment"><div>00286                    :
00287 
00288     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cache error routine.
00289     The cache error routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called whenever a cache error occurs.
00290 
00291 Arguments:
00292 
00293     Routine - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cache error routine.
00294 
00295 Return Value:
00296 
00297     None.
00298 
00299 --*/
00300 
00301 {
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">// Set the address of the cache error routine.</span>
00305     <span class="comment">//</span>
00306 
00307     *((PULONG)CACHE_ERROR_VECTOR) = (ULONG)Routine | <a class="code" href="../../d6/d7/halmips_8h.html#a444">KSEG1_BASE</a>;
00308     <span class="keywordflow">return</span>;
00309 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="mips/buserror.c::KiDataBusError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiDataBusError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00124">124</a> of file <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html">mips/buserror.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00014">DATA_BUS_ERROR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00081">KiGetPhysicalAddress()</a>, and <a class="el" href="../../d9/d4/ppc_2getsetrg_8c-source.html#l00032">KiGetRegisterValue()</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/mips_2exceptn_8c-source.html#l00313">KiDispatchException()</a>.
<p>
<pre class="fragment"><div>00132                    :
00133 
00134     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to process a data bus error. The <span class="keyword">virtual</span> and
00135     physical address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error are computed and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data bus error
00136     processing routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called indirectly through <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> PCR. NT provides
00137     a standard routine to process <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error and shutdown <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a>
00138     vendor, however, can replace <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> standard NT routine and <span class="keywordflow">do</span> additional
00139     processing <span class="keywordflow">if</span> necessary via <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d2/genxx_8h.html#a21">HAL</a>.
00140 
00141     N.B. There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no <span class="keywordflow">return</span> from <span class="keyword">this</span> routine.
00142 
00143 Arguments:
00144 
00145     ExceptionRecord - Supplies a pointer to an exception record.
00146 
00147     ExceptionFrame - Supplies a pointer to an exception frame.
00148 
00149     TrapFrame - Supplies a pointer to a trap frame.
00150 
00151 Return Value:
00152 
00153     None.
00154 
00155 --*/
00156 
00157 {
00158 
00159     PVOID VirtualAddress;
00160     PHYSICAL_ADDRESS PhysicalAddress;
00161     MIPS_INSTRUCTION FaultInstruction;
00162 
00163     <span class="comment">//</span>
00164     <span class="comment">// Any exception that occurs during the attempted calculation of the</span>
00165     <span class="comment">// virtual address causes the virtual address calculation to be</span>
00166     <span class="comment">// aborted and the virtual address of the instruction itself is used</span>
00167     <span class="comment">// instead.</span>
00168     <span class="comment">//</span>
00169 
00170     <span class="keywordflow">try</span> {
00171 
00172         <span class="comment">//</span>
00173         <span class="comment">// Compute the effective address of the reference.</span>
00174         <span class="comment">//</span>
00175 
00176         FaultInstruction.Long = *((PULONG)ExceptionRecord-&gt;ExceptionAddress);
00177         VirtualAddress = (PVOID)(<a class="code" href="../../d8/d5/ppc_2getsetrg_8c.html#a0">KiGetRegisterValue</a>(FaultInstruction.i_format.Rs,
00178                                                     ExceptionFrame,
00179                                                     TrapFrame) +
00180                                                FaultInstruction.i_format.Simmediate);
00181 
00182     <span class="comment">//</span>
00183     <span class="comment">// If an exception occurs, then abort the calculation of the virtual</span>
00184     <span class="comment">// address and set the virtual address equal to the instruction address.</span>
00185     <span class="comment">//</span>
00186 
00187     } except (EXCEPTION_EXECUTE_HANDLER) {
00188         VirtualAddress = ExceptionRecord-&gt;ExceptionAddress;
00189     }
00190 
00191     <span class="comment">//</span>
00192     <span class="comment">// Compute the physical address that corresponds to the data address.</span>
00193     <span class="comment">//</span>
00194 
00195     PhysicalAddress = <a class="code" href="../../d2/d9/miia64_8h.html#a300">KiGetPhysicalAddress</a>(VirtualAddress);
00196 
00197     <span class="comment">//</span>
00198     <span class="comment">// If a value of FALSE is returned by the data bus error handling routine,</span>
00199     <span class="comment">// then bug check. Otherwise, assume that the error has been handled and</span>
00200     <span class="comment">// return.</span>
00201     <span class="comment">//</span>
00202 
00203     <span class="keywordflow">if</span> ((PCR-&gt;DataBusError)(ExceptionRecord,
00204                         ExceptionFrame,
00205                         TrapFrame,
00206                         VirtualAddress,
00207                         PhysicalAddress) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00208 
00209         <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(DATA_BUS_ERROR);
00210     }
00211 
00212     <span class="keywordflow">return</span>;
00213 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="mips/buserror.c::KiGetPhysicalAddress" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PHYSICAL_ADDRESS KiGetPhysicalAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>VirtualAddress</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00081">81</a> of file <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html">mips/buserror.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00591">KSEG0_BASE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00592">KSEG1_BASE</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l05490">MmGetPhysicalAddress()</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00124">KiDataBusError()</a>, and <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00216">KiInstructionBusError()</a>.
<p>
<pre class="fragment"><div>00087                    :
00088 
00089     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> physical address <span class="keywordflow">for</span> a given <span class="keyword">virtual</span> address.
00090 
00091 Arguments:
00092 
00093     VirtualAddress - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">virtual</span> address whose physical address <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00094         to be computed.
00095 
00096 Return Value:
00097 
00098     The physical address that correcponds to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <span class="keyword">virtual</span> address.
00099 
00100 --*/
00101 
00102 {
00103     PHYSICAL_ADDRESS PhysicalAddress;
00104 
00105     <span class="comment">//</span>
00106     <span class="comment">// If the address is a KSEG0 or KSEG1 address, then mask off the high</span>
00107     <span class="comment">// three address bits and return the result as the physical address.</span>
00108     <span class="comment">// Otherwise, call memory management to convert the virtual address to</span>
00109     <span class="comment">// a physical address.</span>
00110     <span class="comment">//</span>
00111 
00112     <span class="keywordflow">if</span> (((ULONG)VirtualAddress &gt;= <a class="code" href="../../d6/d7/halmips_8h.html#a443">KSEG0_BASE</a>) &amp;&amp;
00113         ((ULONG)VirtualAddress &lt; (<a class="code" href="../../d6/d7/halmips_8h.html#a444">KSEG1_BASE</a> + 0x20000000))) {
00114         PhysicalAddress.LowPart = (ULONG)VirtualAddress &amp; 0x1fffffff;
00115         PhysicalAddress.HighPart = 0;
00116         <span class="keywordflow">return</span> PhysicalAddress;
00117 
00118     } <span class="keywordflow">else</span> {
00119         <span class="keywordflow">return</span> <a class="code" href="../../d5/d6/iosup_8c.html#a68">MmGetPhysicalAddress</a>(VirtualAddress);
00120     }
00121 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="mips/buserror.c::KiInstructionBusError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiInstructionBusError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00216">216</a> of file <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html">mips/buserror.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00017">INSTRUCTION_BUS_ERROR</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, and <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00081">KiGetPhysicalAddress()</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/mips_2exceptn_8c-source.html#l00313">KiDispatchException()</a>.
<p>
<pre class="fragment"><div>00224                    :
00225 
00226     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to process an instruction bus error. The <span class="keyword">virtual</span>
00227     and physical address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error are computed and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> instruction bus
00228     error processing routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called indirectly through <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> PCR. NT provides
00229     a standard routine to process <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error and shutdown <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> vendor,
00230     however, can replace <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> standard NT routine and <span class="keywordflow">do</span> additional processing
00231     <span class="keywordflow">if</span> necessary via <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d2/genxx_8h.html#a21">HAL</a>.
00232 
00233     N.B. There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no <span class="keywordflow">return</span> from <span class="keyword">this</span> routine.
00234 
00235 Arguments:
00236 
00237     ExceptionRecord - Supplies a pointer to an exception record.
00238 
00239     ExceptionFrame - Supplies a pointer to an exception frame.
00240 
00241     TrapFrame - Supplies a pointer to a trap frame.
00242 
00243 Return Value:
00244 
00245     None.
00246 
00247 --*/
00248 
00249 {
00250 
00251     PVOID VirtualAddress;
00252     PHYSICAL_ADDRESS PhysicalAddress;
00253 
00254     <span class="comment">//</span>
00255     <span class="comment">// Compute the physical address that corresponds to the data address.</span>
00256     <span class="comment">//</span>
00257 
00258     VirtualAddress = ExceptionRecord-&gt;ExceptionAddress;
00259     PhysicalAddress = <a class="code" href="../../d2/d9/miia64_8h.html#a300">KiGetPhysicalAddress</a>(VirtualAddress);
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">// If a value of FALSE is returned by the instructiona bus error handling</span>
00263     <span class="comment">// routine, then bug check. Otherwise, assume that the error has been</span>
00264     <span class="comment">// handled and return.</span>
00265     <span class="comment">//</span>
00266 
00267     <span class="keywordflow">if</span> ((PCR-&gt;InstructionBusError)(ExceptionRecord,
00268                                ExceptionFrame,
00269                                TrapFrame,
00270                                VirtualAddress,
00271                                PhysicalAddress) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00272 
00273         <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(INSTRUCTION_BUS_ERROR);
00274     }
00275 
00276     <span class="keywordflow">return</span>;
00277 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:58 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
