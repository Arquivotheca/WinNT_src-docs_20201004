<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tacl.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tacl.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include "nt.h"</code><br>
<code>#include "ntrtl.h"</code><br>

<p>
<a href="../../d2/d8/tacl_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a9">RtlDumpAcl</a> (IN PACL Acl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a10">main</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a0">FredAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a1">WilmaAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a2">PebbleAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a3">DinoAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a4">BarneyAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a5">BettyAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a6">BambamAclBuffer</a> [128]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a7">GuidMaskBuffer</a> [512]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a> [2]</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a10" doxytag="tacl.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">55</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
References <a class="el" href="../../d2/d8/tacl_8c-source.html#l00052">AceListBuffer</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00049">BambamAclBuffer</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00047">BarneyAclBuffer</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00048">BettyAclBuffer</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00046">DinoAclBuffer</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00043">FredAclBuffer</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00051">GuidMaskBuffer</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01130">_STANDARD_ACE::Header</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01131">_STANDARD_ACE::Mask</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d2/d8/tacl_8c-source.html#l00045">PebbleAclBuffer</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01134">PSTANDARD_ACE</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00718">RtlAddAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00099">RtlCreateAcl()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00895">RtlDeleteAce()</a>, <a class="el" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00996">RtlGetAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00460">RtlQueryInformationAcl()</a>, <a class="el" href="../../d6/d0/ctaccess_8c.html#a59">STANDARD_ACE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d8/tacl_8c-source.html#l00044">WilmaAclBuffer</a>.
<p>
<pre class="fragment"><div>00059 {
00060     PACL FredAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a0">FredAclBuffer</a>;
00061     PACL WilmaAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a1">WilmaAclBuffer</a>;
00062     PACL PebbleAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a2">PebbleAclBuffer</a>;
00063     PACL DinoAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a3">DinoAclBuffer</a>;
00064     PACL BarneyAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a4">BarneyAclBuffer</a>;
00065     PACL BettyAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a5">BettyAclBuffer</a>;
00066     PACL BambamAcl = (PACL)<a class="code" href="../../d1/d9/tacl_8c.html#a6">BambamAclBuffer</a>;
00067 
00068     PMASK_GUID_PAIRS GuidMasks = (PMASK_GUID_PAIRS)<a class="code" href="../../d1/d9/tacl_8c.html#a7">GuidMaskBuffer</a>;
00069 
00070     ACL_REVISION_INFORMATION AclRevisionInfo;
00071     ACL_SIZE_INFORMATION AclSizeInfo;
00072 
00073     <span class="comment">//</span>
00074     <span class="comment">//  We're starting the test</span>
00075     <span class="comment">//</span>
00076 
00077     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Start Acl Test\n"</span>);
00078 
00079     <span class="comment">//</span>
00080     <span class="comment">//  test create acl</span>
00081     <span class="comment">//</span>
00082 
00083     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a6">RtlCreateAcl</a>(FredAcl, 128, 1))) {
00084         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlCreateAcl Error\n"</span>);
00085     }
00086 
00087     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00088     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00089 
00090     <span class="comment">//</span>
00091     <span class="comment">//  test add ace to add two aces to an empty acl</span>
00092     <span class="comment">//</span>
00093 
00094     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType = ACCESS_ALLOWED_ACE_TYPE;
00095     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>);
00096     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceFlags = 0;
00097     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> = 0x22222222;
00098     CopyGuid(&amp;AceListBuffer[0].Guid, &amp;FredGuid);
00099 
00100     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[1].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType = ACCESS_ALLOWED_ACE_TYPE;
00101     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[1].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>);
00102     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[1].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceFlags = 0;
00103     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[1].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> = 0x44444444;
00104     CopyGuid(&amp;AceListBuffer[1].Guid, &amp;WilmaGuid);
00105 
00106     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a>(FredAcl, 1, 0, AceListBuffer, 2*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>)))) {
00107         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAddAce Error\n"</span>);
00108     }
00109 
00110     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00111     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00112 
00113     <span class="comment">//</span>
00114     <span class="comment">//  test add ace to add one to the beginning of an acl</span>
00115     <span class="comment">//</span>
00116 
00117     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType = SYSTEM_AUDIT_ACE_TYPE;
00118     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>);
00119     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceFlags = 0;
00120     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> = 0x11111111;
00121     CopyGuid(&amp;AceListBuffer[0].Guid, &amp;PebbleGuid);
00122 
00123     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a>(FredAcl, 1, 0, AceListBuffer, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>)))) {
00124         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAddAce Error\n"</span>);
00125     }
00126 
00127     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00128     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00129 
00130     <span class="comment">//</span>
00131     <span class="comment">//  test add ace to add one to the middle of an acl</span>
00132     <span class="comment">//</span>
00133 
00134     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType = ACCESS_DENIED_ACE_TYPE;
00135     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>);
00136     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceFlags = 0;
00137     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> = 0x33333333;
00138     CopyGuid(&amp;AceListBuffer[0].Guid, &amp;DinoGuid);
00139 
00140     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a>(FredAcl, 1, 2, AceListBuffer, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>)))) {
00141         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAddAce Error\n"</span>);
00142     }
00143 
00144     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00145     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00146 
00147     <span class="comment">//</span>
00148     <span class="comment">//  test add ace to add one to the end of an acl</span>
00149     <span class="comment">//</span>
00150 
00151     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType = ACCESS_DENIED_ACE_TYPE;
00152     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>);
00153     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceFlags = 0;
00154     <a class="code" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[0].<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> = 0x55555555;
00155     CopyGuid(&amp;AceListBuffer[0].Guid, &amp;FlintstoneGuid);
00156 
00157     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a>(FredAcl, 1, MAXULONG, AceListBuffer, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>)))) {
00158         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAddAce Error\n"</span>);
00159     }
00160 
00161     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00162     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00163 
00164     <span class="comment">//</span>
00165     <span class="comment">//  Test get ace</span>
00166     <span class="comment">//</span>
00167 
00168     {
00169         <a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">PSTANDARD_ACE</a> Ace;
00170 
00171         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a12">RtlGetAce</a>(FredAcl, 2, (PVOID *)(&amp;Ace)))) {
00172             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlGetAce Error\n"</span>);
00173         }
00174 
00175         <span class="keywordflow">if</span> ((Ace-&gt;<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o0">Header</a>.AceType != ACCESS_DENIED_ACE_TYPE) ||
00176             (Ace-&gt;<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html#o1">Mask</a> != 0x33333333)) {
00177             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Got bad ace from RtlGetAce\n"</span>);
00178         }
00179     }
00180 
00181     <span class="comment">//</span>
00182     <span class="comment">//  test delete ace middle ace</span>
00183     <span class="comment">//</span>
00184 
00185     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a11">RtlDeleteAce</a>(FredAcl, 2))) {
00186         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlDeleteAce Error\n"</span>);
00187     }
00188 
00189     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(FredAcl);
00190     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00191 
00192     <span class="comment">//</span>
00193     <span class="comment">//  Test query information acl</span>
00194     <span class="comment">//</span>
00195 
00196     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a8">RtlQueryInformationAcl</a>( FredAcl,
00197                                          (PVOID)&amp;AclRevisionInfo,
00198                                          <span class="keyword">sizeof</span>(ACL_REVISION_INFORMATION),
00199                                          AclRevisionInformation))) {
00200         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlQueryInformationAcl Error\n"</span>);
00201     }
00202     <span class="keywordflow">if</span> (AclRevisionInfo.AclRevision != ACL_REVISION) {
00203         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAclRevision Error\n"</span>);
00204     }
00205 
00206     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d2/d4/acledit_8c.html#a8">RtlQueryInformationAcl</a>( FredAcl,
00207                                          (PVOID)&amp;AclSizeInfo,
00208                                          <span class="keyword">sizeof</span>(ACL_SIZE_INFORMATION),
00209                                          AclSizeInformation))) {
00210         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlQueryInformationAcl Error\n"</span>);
00211     }
00212     <span class="keywordflow">if</span> ((AclSizeInfo.AceCount != 4) ||
00213         (AclSizeInfo.AclBytesInUse != (<span class="keyword">sizeof</span>(ACL)+4*<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>))) ||
00214         (AclSizeInfo.AclBytesFree != 128 - AclSizeInfo.AclBytesInUse)) {
00215         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlAclSize Error\n"</span>);
00216         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"AclSizeInfo.AceCount = %8lx\n"</span>, AclSizeInfo.AceCount);
00217         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"AclSizeInfo.AclBytesInUse = %8lx\n"</span>, AclSizeInfo.AclBytesInUse);
00218         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"AclSizeInfo.AclBytesFree = %8lx\n"</span>, AclSizeInfo.AclBytesFree);
00219         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00220     }
00221 
00222     <span class="comment">//</span>
00223     <span class="comment">//  Test make Mask from Acl</span>
00224     <span class="comment">//</span>
00225 
00226     GuidMasks-&gt;PairCount = 11;
00227     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 0].Guid, &amp;FredGuid);
00228     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 1].Guid, &amp;WilmaGuid);
00229     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 2].Guid, &amp;PebbleGuid);
00230     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 3].Guid, &amp;DinoGuid);
00231     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 4].Guid, &amp;BarneyGuid);
00232     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 5].Guid, &amp;BettyGuid);
00233     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 6].Guid, &amp;BambamGuid);
00234     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 7].Guid, &amp;FlintstoneGuid);
00235     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 8].Guid, &amp;RubbleGuid);
00236     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[ 9].Guid, &amp;AdultGuid);
00237     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[10].Guid, &amp;ChildGuid);
00238     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(RtlMakeMaskFromAcl(FredAcl, GuidMasks))) {
00239         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlMakeMaskFromAcl Error\n"</span>);
00240     }
00241     <span class="keywordflow">if</span> ((GuidMasks-&gt;MaskGuid[ 0].Mask != 0x22222222) ||
00242         (GuidMasks-&gt;MaskGuid[ 1].Mask != 0x44444444) ||
00243         (GuidMasks-&gt;MaskGuid[ 2].Mask != 0x00000000) ||
00244         (GuidMasks-&gt;MaskGuid[ 3].Mask != 0x00000000) ||
00245         (GuidMasks-&gt;MaskGuid[ 4].Mask != 0x00000000) ||
00246         (GuidMasks-&gt;MaskGuid[ 5].Mask != 0x00000000) ||
00247         (GuidMasks-&gt;MaskGuid[ 6].Mask != 0x00000000) ||
00248         (GuidMasks-&gt;MaskGuid[ 7].Mask != 0x00000000) ||
00249         (GuidMasks-&gt;MaskGuid[ 8].Mask != 0x00000000) ||
00250         (GuidMasks-&gt;MaskGuid[ 9].Mask != 0x00000000) ||
00251         (GuidMasks-&gt;MaskGuid[10].Mask != 0x00000000)) {
00252         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Make Mask Error\n"</span>);
00253         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Fred gets       %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 0].Mask);
00254         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Wilma gets      %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 1].Mask);
00255         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Pebble gets     %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 2].Mask);
00256         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Dino gets       %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 3].Mask);
00257         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Barney gets     %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 4].Mask);
00258         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Betty gets      %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 5].Mask);
00259         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Banbam gets     %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 6].Mask);
00260         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Flintstone gets %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 7].Mask);
00261         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Rubble gets     %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 8].Mask);
00262         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Adult gets      %8lx\n"</span>, GuidMasks-&gt;MaskGuid[ 9].Mask);
00263         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Child gets      %8lx\n"</span>, GuidMasks-&gt;MaskGuid[10].Mask);
00264     }
00265 
00266     <span class="comment">//</span>
00267     <span class="comment">//  test make acl from mask</span>
00268     <span class="comment">//</span>
00269 
00270     GuidMasks-&gt;PairCount = 2;
00271     GuidMasks-&gt;MaskGuid[0].Mask = 0x55555555;
00272     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[0].Guid, &amp;BarneyGuid);
00273     GuidMasks-&gt;MaskGuid[1].Mask = 0xaaaa5555;
00274     CopyGuid(&amp;GuidMasks-&gt;MaskGuid[1].Guid, &amp;RubbleGuid);
00275 
00276     <span class="comment">//</span>
00277     <span class="comment">//  Initialize and dump a posix style acl</span>
00278     <span class="comment">//</span>
00279 
00280     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(RtlMakeAclFromMask(GuidMasks, AclPosixEnvironment, BarneyAcl, 128, 1))) {
00281         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlMakeAclFromMask Error\n"</span>);
00282     }
00283 
00284     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(BarneyAcl);
00285     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00286 
00287     <span class="comment">//</span>
00288     <span class="comment">//  Initialize and dump a OS/2 style acl</span>
00289     <span class="comment">//</span>
00290 
00291     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(RtlMakeAclFromMask(GuidMasks, AclOs2Environment, BettyAcl, 128, 1))) {
00292         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"RtlMakeAclFromMask Error\n"</span>);
00293     }
00294 
00295     <a class="code" href="../../d3/d6/tseum_8c.html#a0">RtlDumpAcl</a>(BettyAcl);
00296     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00297 
00298     <span class="comment">//</span>
00299     <span class="comment">//  We're done with the test</span>
00300     <span class="comment">//</span>
00301 
00302     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"End Acl Test\n"</span>);
00303 
00304     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00305 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="tacl.c::RtlDumpAcl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlDumpAcl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PACL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Acl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a8" doxytag="tacl.c::AceListBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a> <a class="el" href="../../d1/d9/tacl_8c.html#a8">AceListBuffer</a>[2]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00052">52</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="tacl.c::BambamAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a6">BambamAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00049">49</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="tacl.c::BarneyAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a4">BarneyAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00047">47</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="tacl.c::BettyAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a5">BettyAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00048">48</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="tacl.c::DinoAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a3">DinoAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00046">46</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="tacl.c::FredAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a0">FredAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00043">43</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="tacl.c::GuidMaskBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a7">GuidMaskBuffer</a>[512]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00051">51</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="tacl.c::PebbleAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a2">PebbleAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00045">45</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="tacl.c::WilmaAclBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR <a class="el" href="../../d1/d9/tacl_8c.html#a1">WilmaAclBuffer</a>[128]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/tacl_8c-source.html#l00044">44</a> of file <a class="el" href="../../d2/d8/tacl_8c-source.html">tacl.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:44 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
