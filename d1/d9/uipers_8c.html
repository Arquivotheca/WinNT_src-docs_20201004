<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: uipers.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>uipers.c File Reference</h1><code>#include &lt;nt.h&gt;</code><br>
<code>#include &lt;ntrtl.h&gt;</code><br>
<code>#include &lt;nturtl.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include "<a class="el" href="../../d5/d5/tsevars_8c-source.html">tsevars.c</a>"</code><br>
<code>#include "<a class="el" href="../../d3/d5/tsecomm_8c-source.html">tsecomm.c</a>"</code><br>

<p>
<a href="../../d2/d8/uipers_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a0">_TST_USER_</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a1">PrintGuid</a>(G)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a2">BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;(2048)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a4">DisplaySecurityContext</a> (IN HANDLE TokenHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a> (PISID Sid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a6">SidTranslation</a> (PSID Sid, PSTRING AccountName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a7">DisplayPrivilegeName</a> (PLUID Privilege)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a8">DisplayPrivilege</a> (PLUID_AND_ATTRIBUTES Privilege)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a9">main</a> ()</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>GUID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d9/uipers_8c.html#a3">SystemAuthenticationId</a> = SYSTEM_GUID</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="uipers.c::_TST_USER_" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define _TST_USER_          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00028">28</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="uipers.c::BUFFER_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BUFFER_SIZE&nbsp;&nbsp;&nbsp;(2048)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="uipers.c::PrintGuid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PrintGuid          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">G&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>printf( <span class="stringliteral">"(0x%lx-%hx-%hx-%hx-%hx-%hx-%hx-%hx-%hx-%hx-%hx)\n"</span>, \
                         (G)-&gt;Data1,    (G)-&gt;Data2,    (G)-&gt;Data3,               \
                         (G)-&gt;Data4[0], (G)-&gt;Data4[1], (G)-&gt;Data4[2],            \
                         (G)-&gt;Data4[3], (G)-&gt;Data4[4], (G)-&gt;Data4[5],            \
                         (G)-&gt;Data4[6], (G)-&gt;Data4[7]);                         \
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00066">66</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">DisplaySecurityContext()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="uipers.c::DisplayAccountSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisplayAccountSid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PISID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Sid</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00131">131</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">DisplaySecurityContext()</a>, and <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>.
<p>
<pre class="fragment"><div>00134 {
00135     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[128];
00136     STRING AccountName;
00137     UCHAR i;
00138     ULONG Tmp;
00139 
00140     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0] = 0;
00141 
00142     AccountName.MaximumLength = 127;
00143     AccountName.Length = 0;
00144     AccountName.Buffer = (PVOID)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00145 
00146 
00147 
00148     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/uipers_8c.html#a6">SidTranslation</a>( (PSID)Sid, &amp;AccountName) ) {
00149 
00150         printf(<span class="stringliteral">"%s\n"</span>, AccountName.Buffer );
00151 
00152     } <span class="keywordflow">else</span> {
00153         printf(<span class="stringliteral">"S-%lu-"</span>, (USHORT)Sid-&gt;Revision );
00154         <span class="keywordflow">if</span> (  (Sid-&gt;IdentifierAuthority.Value[0] != 0)  ||
00155               (Sid-&gt;IdentifierAuthority.Value[1] != 0)     ){
00156             printf(<span class="stringliteral">"0x%02hx%02hx%02hx%02hx%02hx%02hx"</span>,
00157                         (USHORT)Sid-&gt;IdentifierAuthority.Value[0],
00158                         (USHORT)Sid-&gt;IdentifierAuthority.Value[1],
00159                         (USHORT)Sid-&gt;IdentifierAuthority.Value[2],
00160                         (USHORT)Sid-&gt;IdentifierAuthority.Value[3],
00161                         (USHORT)Sid-&gt;IdentifierAuthority.Value[4],
00162                         (USHORT)Sid-&gt;IdentifierAuthority.Value[5] );
00163         } <span class="keywordflow">else</span> {
00164             Tmp = (ULONG)Sid-&gt;IdentifierAuthority.Value[5]          +
00165                   (ULONG)(Sid-&gt;IdentifierAuthority.Value[4] &lt;&lt;  8)  +
00166                   (ULONG)(Sid-&gt;IdentifierAuthority.Value[3] &lt;&lt; 16)  +
00167                   (ULONG)(Sid-&gt;IdentifierAuthority.Value[2] &lt;&lt; 24);
00168             printf(<span class="stringliteral">"%lu"</span>, Tmp);
00169         }
00170 
00171 
00172         <span class="keywordflow">for</span> (i=0;i&lt;Sid-&gt;SubAuthorityCount ;i++ ) {
00173             printf(<span class="stringliteral">"-%lu"</span>, Sid-&gt;SubAuthority[i]);
00174         }
00175         printf(<span class="stringliteral">"\n"</span>);
00176 
00177     }
00178 
00179 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="uipers.c::DisplayPrivilege" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisplayPrivilege           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PLUID_AND_ATTRIBUTES&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Privilege</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00303">303</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
References <a class="el" href="../../d2/d8/uipers_8c-source.html#l00184">DisplayPrivilegeName()</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">DisplaySecurityContext()</a>.
<p>
<pre class="fragment"><div>00306 {
00307 
00308 
00309     <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d9/uipers_8c.html#a7">DisplayPrivilegeName</a>(&amp;Privilege-&gt;Luid)) {
00310         printf(<span class="stringliteral">"(Unknown Privilege.  Value is: (0x%lx,0x%lx))"</span>,
00311                Privilege-&gt;Luid.HighPart,
00312                Privilege-&gt;Luid.LowPart
00313                );
00314     }
00315 
00316 
00317 
00318     <span class="comment">//</span>
00319     <span class="comment">// Display the attributes assigned to the privilege.</span>
00320     <span class="comment">//</span>
00321 
00322     printf(<span class="stringliteral">"\n                           ["</span>);
00323     <span class="keywordflow">if</span> (!(Privilege-&gt;Attributes &amp; SE_PRIVILEGE_ENABLED)) {
00324         printf(<span class="stringliteral">"Not "</span>);
00325     }
00326     printf(<span class="stringliteral">"Enabled"</span>);
00327 
00328     <span class="comment">//printf(" / ");</span>
00329     <span class="comment">//if (!(Privilege-&gt;Attributes &amp; SE_PRIVILEGE_ENABLED_BY_DEFAULT)) {</span>
00330     <span class="comment">//    printf("Not ");</span>
00331     <span class="comment">//}</span>
00332     <span class="comment">//printf("Enabled By Default");</span>
00333 
00334 
00335     printf(<span class="stringliteral">"]\n"</span>);
00336     printf(<span class="stringliteral">"                           "</span>);
00337 
00338 
00339     <span class="keywordflow">return</span>;
00340 
00341 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="uipers.c::DisplayPrivilegeName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN DisplayPrivilegeName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PLUID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Privilege</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00184">184</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
References <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00142">AssignPrimaryTokenPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00157">BackupPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00150">CreatePagefilePrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00158">CreatePermanentPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00141">CreateTokenPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00160">DebugPrivilege</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00151">IncreaseBasePriorityPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00144">IncreaseQuotaPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00143">LockMemoryPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00154">ProfileSingleProcessPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00156">RestorePrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00147">SecurityPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00159">ShutdownPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00152">SystemProfilePrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00153">SystemtimePrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00149">TakeOwnershipPrivilege</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00146">TcbPrivilege</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00145">UnsolicitedInputPrivilege</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00303">DisplayPrivilege()</a>.
<p>
<pre class="fragment"><div>00187 {
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// This should be rewritten to use RtlLookupPrivilegeName.</span>
00191     <span class="comment">//</span>
00192     <span class="comment">// First we should probably spec and write RtlLookupPrivilegeName.</span>
00193     <span class="comment">//</span>
00194 
00195     <span class="keywordflow">if</span> ( ((*Privilege)QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a40">CreateTokenPrivilege</a>.QuadPart))  {
00196         printf(<span class="stringliteral">"SeCreateTokenPrivilege         "</span>);
00197         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00198     }
00199 
00200     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a41">AssignPrimaryTokenPrivilege</a>.QuadPart))  {
00201         printf(<span class="stringliteral">"SeAssignPrimaryTokenPrivilege  "</span>);
00202         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00203     }
00204 
00205     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a42">LockMemoryPrivilege</a>.QuadPart))  {
00206         printf(<span class="stringliteral">"SeLockMemoryPrivilege          "</span>);
00207         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00208     }
00209 
00210     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a43">IncreaseQuotaPrivilege</a>.QuadPart))  {
00211         printf(<span class="stringliteral">"SeIncreaseQuotaPrivilege       "</span>);
00212         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00213     }
00214 
00215     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a44">UnsolicitedInputPrivilege</a>.QuadPart))  {
00216         printf(<span class="stringliteral">"SeUnsolicitedInputPrivilege    "</span>);
00217         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00218     }
00219 
00220     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a45">TcbPrivilege</a>.QuadPart))  {
00221         printf(<span class="stringliteral">"SeTcbPrivilege                 "</span>);
00222         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00223     }
00224 
00225     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a46">SecurityPrivilege</a>.QuadPart))  {
00226         printf(<span class="stringliteral">"SeSecurityPrivilege (Security Operator)  "</span>);
00227         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00228     }
00229 
00230 
00231     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a47">TakeOwnershipPrivilege</a>.QuadPart)) {
00232         printf(<span class="stringliteral">"SeTakeOwnershipPrivilege              "</span>);
00233         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00234     }
00235 
00236     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == LpcReplyBoostPrivilege.QuadPart)) {
00237         printf(<span class="stringliteral">"SeLpcReplyBoostPrivilege              "</span>);
00238         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00239     }
00240 
00241     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a48">CreatePagefilePrivilege</a>.QuadPart)) {
00242         printf(<span class="stringliteral">"SeCreatePagefilePrivilege              "</span>);
00243         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00244     }
00245 
00246     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a49">IncreaseBasePriorityPrivilege</a>.QuadPart)) {
00247         printf(<span class="stringliteral">"SeIncreaseBasePriorityPrivilege              "</span>);
00248         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00249     }
00250 
00251     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a50">SystemProfilePrivilege</a>.QuadPart)) {
00252         printf(<span class="stringliteral">"SeSystemProfilePrivilege              "</span>);
00253         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00254     }
00255 
00256     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a51">SystemtimePrivilege</a>.QuadPart)) {
00257         printf(<span class="stringliteral">"SeSystemtimePrivilege              "</span>);
00258         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00259     }
00260 
00261     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a52">ProfileSingleProcessPrivilege</a>.QuadPart)) {
00262         printf(<span class="stringliteral">"SeProfileSingleProcessPrivilege              "</span>);
00263         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00264     }
00265 
00266     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a55">CreatePermanentPrivilege</a>.QuadPart)) {
00267         printf(<span class="stringliteral">"SeCreatePermanentPrivilege              "</span>);
00268         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00269     }
00270 
00271     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a54">BackupPrivilege</a>.QuadPart)) {
00272         printf(<span class="stringliteral">"SeBackupPrivilege              "</span>);
00273         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00274     }
00275 
00276     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a53">RestorePrivilege</a>.QuadPart)) {
00277         printf(<span class="stringliteral">"SeRestorePrivilege              "</span>);
00278         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00279     }
00280 
00281     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a56">ShutdownPrivilege</a>.QuadPart)) {
00282         printf(<span class="stringliteral">"SeShutdownPrivilege             "</span>);
00283         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00284     }
00285 
00286     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == <a class="code" href="../../d4/d6/tsevars_8c.html#a57">DebugPrivilege</a>.QuadPart)) {
00287         printf(<span class="stringliteral">"SeDebugPrivilege                "</span>);
00288         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00289     }
00290 
00291     <span class="keywordflow">if</span> ( ((*Privilege).QuadPart == SystemEnvironmentPrivilege.QuadPart)) {
00292         printf(<span class="stringliteral">"SeSystemEnvironmentPrivilege    "</span>);
00293         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00294     }
00295 
00296     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00297 
00298 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="uipers.c::DisplaySecurityContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisplaySecurityContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>TokenHandle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">345</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00035">BUFFER_SIZE</a>, <a class="el" href="../../d2/d8/uipers_8c-source.html#l00131">DisplayAccountSid()</a>, <a class="el" href="../../d2/d8/uipers_8c-source.html#l00303">DisplayPrivilege()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d8/uipers_8c-source.html#l00066">PrintGuid</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00155">SystemAuthenticationId</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00543">main()</a>.
<p>
<pre class="fragment"><div>00348 {
00349 
00350 <span class="preprocessor">#define BUFFER_SIZE (2048)</span>
00351 <span class="preprocessor"></span>
00352     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00353     ULONG i;
00354     ULONG ReturnLength;
00355     TOKEN_STATISTICS ProcessTokenStatistics;
00356     GUID AuthenticationId;
00357     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d9/d9/tcmpmem_8c.html#a0">BUFFER_SIZE</a>];
00358 
00359 
00360     PTOKEN_USER UserId;
00361     PTOKEN_OWNER DefaultOwner;
00362     PTOKEN_PRIMARY_GROUP PrimaryGroup;
00363     PTOKEN_GROUPS GroupIds;
00364     PTOKEN_PRIVILEGES Privileges;
00365 
00366 
00367 
00368 
00370     <span class="comment">//                                                                     //</span>
00371     <span class="comment">// Logon ID                                                            //</span>
00372     <span class="comment">//                                                                     //</span>
00374 <span class="comment"></span>
00375     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00376                  TokenHandle,                  <span class="comment">// Handle</span>
00377                  TokenStatistics,              <span class="comment">// TokenInformationClass</span>
00378                  &amp;ProcessTokenStatistics,      <span class="comment">// TokenInformation</span>
00379                  <span class="keyword">sizeof</span>(TOKEN_STATISTICS),     <span class="comment">// TokenInformationLength</span>
00380                  &amp;ReturnLength                 <span class="comment">// ReturnLength</span>
00381                  );
00382     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00383     AuthenticationId = ProcessTokenStatistics.AuthenticationId;
00384 
00385     printf(<span class="stringliteral">"     Logon Session:        "</span>);
00386     <span class="keywordflow">if</span> (RtlEqualGuid(&amp;AuthenticationId, &amp;SystemAuthenticationId )) {
00387         printf(<span class="stringliteral">"(System Logon Session)\n"</span>);
00388     } <span class="keywordflow">else</span> {
00389         <a class="code" href="../../d1/d9/uipers_8c.html#a1">PrintGuid</a>( &amp;AuthenticationId );
00390     }
00391 
00392 
00393 
00394 
00396     <span class="comment">//                                                                     //</span>
00397     <span class="comment">// User Id                                                             //</span>
00398     <span class="comment">//                                                                     //</span>
00400 <span class="comment"></span>
00401     UserId = (PTOKEN_USER)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00402     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00403                  TokenHandle,              <span class="comment">// Handle</span>
00404                  TokenUser,                <span class="comment">// TokenInformationClass</span>
00405                  UserId,                   <span class="comment">// TokenInformation</span>
00406                  BUFFER_SIZE,              <span class="comment">// TokenInformationLength</span>
00407                  &amp;ReturnLength             <span class="comment">// ReturnLength</span>
00408                  );
00409 
00410 
00411     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00412 
00413     printf(<span class="stringliteral">"           User id:        "</span>);
00414     <a class="code" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a>( (PISID)UserId-&gt;User.Sid );
00415 
00416 
00417 
00418 
00419 
00421     <span class="comment">//                                                                     //</span>
00422     <span class="comment">// Default Owner                                                       //</span>
00423     <span class="comment">//                                                                     //</span>
00425 <span class="comment"></span>
00426     DefaultOwner = (PTOKEN_OWNER)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00427 
00428     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00429                  TokenHandle,              <span class="comment">// Handle</span>
00430                  TokenOwner,               <span class="comment">// TokenInformationClass</span>
00431                  DefaultOwner,             <span class="comment">// TokenInformation</span>
00432                  BUFFER_SIZE,              <span class="comment">// TokenInformationLength</span>
00433                  &amp;ReturnLength             <span class="comment">// ReturnLength</span>
00434                  );
00435 
00436 
00437     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00438 
00439     printf(<span class="stringliteral">"     Default Owner:        "</span>);
00440     <a class="code" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a>( (PISID)DefaultOwner-&gt;Owner );
00441 
00442 
00443 
00444 
00445 
00446 
00448     <span class="comment">//                                                                     //</span>
00449     <span class="comment">// Primary Group                                                       //</span>
00450     <span class="comment">//                                                                     //</span>
00452 <span class="comment"></span>
00453     PrimaryGroup = (PTOKEN_PRIMARY_GROUP)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00454 
00455     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00456                  TokenHandle,              <span class="comment">// Handle</span>
00457                  TokenPrimaryGroup,        <span class="comment">// TokenInformationClass</span>
00458                  PrimaryGroup,             <span class="comment">// TokenInformation</span>
00459                  BUFFER_SIZE,              <span class="comment">// TokenInformationLength</span>
00460                  &amp;ReturnLength             <span class="comment">// ReturnLength</span>
00461                  );
00462 
00463 
00464     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00465 
00466     printf(<span class="stringliteral">"     Primary Group:        "</span>);
00467     <a class="code" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a>( (PISID)PrimaryGroup-&gt;PrimaryGroup );
00468 
00469 
00470 
00471 
00472 
00473 
00475     <span class="comment">//                                                                     //</span>
00476     <span class="comment">// Group Ids                                                           //</span>
00477     <span class="comment">//                                                                     //</span>
00479 <span class="comment"></span>
00480     printf(<span class="stringliteral">"\n"</span>);
00481     GroupIds = (PTOKEN_GROUPS)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00482     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>   = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00483                    TokenHandle,              <span class="comment">// Handle</span>
00484                    TokenGroups,              <span class="comment">// TokenInformationClass</span>
00485                    GroupIds,                 <span class="comment">// TokenInformation</span>
00486                    BUFFER_SIZE,              <span class="comment">// TokenInformationLength</span>
00487                    &amp;ReturnLength             <span class="comment">// ReturnLength</span>
00488                    );
00489 
00490 
00491     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00492 
00493     <span class="comment">//printf("  Number of groups:        %ld\n", GroupIds-&gt;GroupCount);</span>
00494     printf(<span class="stringliteral">"            Groups:        "</span>);
00495 
00496     <span class="keywordflow">for</span> (i=0; i &lt; GroupIds-&gt;GroupCount; i++ ) {
00497         <span class="comment">//printf("                           Group %ld: ", i);</span>
00498         <a class="code" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a>( (PISID)GroupIds-&gt;Groups[i].Sid );
00499         printf(<span class="stringliteral">"                           "</span>);
00500     }
00501 
00502 
00503 
00504 
00505 
00507     <span class="comment">//                                                                     //</span>
00508     <span class="comment">// Privileges                                                          //</span>
00509     <span class="comment">//                                                                     //</span>
00511 <span class="comment"></span>
00512     printf(<span class="stringliteral">"\n"</span>);
00513     Privileges = (PTOKEN_PRIVILEGES)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00514     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>   = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00515                    TokenHandle,              <span class="comment">// Handle</span>
00516                    TokenPrivileges,          <span class="comment">// TokenInformationClass</span>
00517                    Privileges,               <span class="comment">// TokenInformation</span>
00518                    BUFFER_SIZE,              <span class="comment">// TokenInformationLength</span>
00519                    &amp;ReturnLength             <span class="comment">// ReturnLength</span>
00520                    );
00521 
00522 
00523     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00524 
00525     printf(<span class="stringliteral">"        Privileges:        "</span>);
00526     <span class="keywordflow">if</span> (Privileges-&gt;PrivilegeCount &gt; 0) {
00527 
00528         <span class="keywordflow">for</span> (i=0; i &lt; Privileges-&gt;PrivilegeCount; i++ ) {
00529             <a class="code" href="../../d1/d9/uipers_8c.html#a8">DisplayPrivilege</a>( &amp;(Privileges-&gt;Privileges[i]) );
00530         }
00531     } <span class="keywordflow">else</span> {
00532         printf(<span class="stringliteral">"(none assigned)\n"</span>);
00533     }
00534 
00535 
00536 
00537     <span class="keywordflow">return</span>;
00538 
00539 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="uipers.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00543">543</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.
<p>
References <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">DisplaySecurityContext()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00178">NtOpenProcessToken()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00091">ProcessToken</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.
<p>
<pre class="fragment"><div>00544 {
00545 
00546     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00547     HANDLE <a class="code" href="../../d2/d1/cttoken_8c.html#a29">ProcessToken</a>;
00548 
00549 
00550     <a class="code" href="../../d4/d6/tsevars_8c.html#a65">TSeVariableInitialization</a>();    <span class="comment">// Initialize global variables</span>
00551 
00552     printf(<span class="stringliteral">"\n"</span>);
00553 
00554 
00555     <span class="comment">//</span>
00556     <span class="comment">// Open our process token</span>
00557     <span class="comment">//</span>
00558 
00559     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d3/tokenopn_8c.html#a1">NtOpenProcessToken</a>(
00560                  NtCurrentProcess(),
00561                  TOKEN_QUERY,
00562                  &amp;ProcessToken
00563                  );
00564     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00565         printf(<span class="stringliteral">"I'm terribly sorry, but you don't seem to have access to\n"</span>);
00566         printf(<span class="stringliteral">"open your own process's token.\n"</span>);
00567         printf(<span class="stringliteral">"\n"</span>);
00568         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00569     }
00570 
00571     printf(<span class="stringliteral">"Your process level security context is:\n"</span>);
00572     printf(<span class="stringliteral">"\n"</span>);
00573     <a class="code" href="../../d1/d9/uipers_8c.html#a4">DisplaySecurityContext</a>( ProcessToken );
00574 
00575 
00576     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( ProcessToken );
00577 
00578     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00579 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="uipers.c::SidTranslation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SidTranslation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PSID&nbsp;</td>
          <td class="mdname" nowrap> <em>Sid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AccountName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">390</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00121">BatchSid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00122">InteractiveSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00110">LocalSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00123">LocalSystemSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00120">NetworkSid</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00871">RtlEqualSid()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00109">WorldSid</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00447">DisplayAccountSid()</a>.
<p>
<pre class="fragment"><div>00396 {
00397     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, WorldSid)) {
00398         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"WORLD"</span>);
00399         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00400     }
00401 
00402     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, LocalSid)) {
00403         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"LOCAL"</span>);
00404 
00405         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00406     }
00407 
00408     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, NetworkSid)) {
00409         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"NETWORK"</span>);
00410 
00411         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00412     }
00413 
00414     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, BatchSid)) {
00415         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"BATCH"</span>);
00416 
00417         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00418     }
00419 
00420     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, InteractiveSid)) {
00421         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"INTERACTIVE"</span>);
00422         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00423     }
00424 
00425     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, LocalSystemSid)) {
00426         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"SYSTEM"</span>);
00427         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00428     }
00429 
00430 <span class="comment">//</span>
00431 <span class="comment">//    if (RtlEqualSid(Sid, LocalManagerSid)) {</span>
00432 <span class="comment">//      RtlInitString( AccountName, "LOCAL MANAGER");</span>
00433 <span class="comment">//      return(TRUE);</span>
00434 <span class="comment">//  }</span>
00435 
00436 <span class="comment">//  if (RtlEqualSid(Sid, LocalAdminSid)) {</span>
00437 <span class="comment">//      RtlInitString( AccountName, "LOCAL ADMIN");</span>
00438 <span class="comment">//      return(TRUE);</span>
00439 <span class="comment">//  }</span>
00440 
00441     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00442 
00443 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a3" doxytag="uipers.c::SystemAuthenticationId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> GUID <a class="el" href="../../d1/d9/uipers_8c.html#a3">SystemAuthenticationId</a> = SYSTEM_GUID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/uipers_8c-source.html#l00035">35</a> of file <a class="el" href="../../d2/d8/uipers_8c-source.html">uipers.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:52 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
