<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: se.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>se.h</h1><a href="../../d0/d5/se_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++ BUILD Version: 0011    // Increment this if a change has global effects</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    se.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the Security routines that are only callable</span>
00012 <span class="comment">    from kernel mode.</span>
00013 <span class="comment"></span>
00014 <span class="comment">    This file is included by including "ntos.h".</span>
00015 <span class="comment"></span>
00016 <span class="comment">Author:</span>
00017 <span class="comment"></span>
00018 <span class="comment">    Gary Kimura (GaryKi) 09-Mar-1989</span>
00019 <span class="comment"></span>
00020 <span class="comment">Revision History:</span>
00021 <span class="comment"></span>
00022 <span class="comment"></span>
00023 <span class="comment"></span>
00024 <span class="comment">--*/</span>
00025 
00026 <span class="preprocessor">#ifndef _SE_</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#define _SE_</span>
00028 <span class="preprocessor"></span>
00029 
00030 
00032 <span class="comment">//                                                                          //</span>
00033 <span class="comment">//  Kernel mode only data structures                                        //</span>
00034 <span class="comment">//  Opaque security data structures are defined in seopaque.h               //</span>
00035 <span class="comment">//                                                                          //</span>
00037 <span class="comment"></span>
00038 <span class="comment">// begin_ntddk begin_nthal begin_ntifs</span>
00039 <span class="comment">//</span>
00040 <span class="comment">//  Security operation codes</span>
00041 <span class="comment">//</span>
00042 
<a name="l00043"></a><a class="code" href="../../d0/d5/se_8h.html#a200">00043</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d0/d5/se_8h.html#a200">_SECURITY_OPERATION_CODE</a> {
00044     <a class="code" href="../../d0/d5/se_8h.html#a200a108">SetSecurityDescriptor</a>,
00045     <a class="code" href="../../d0/d5/se_8h.html#a200a109">QuerySecurityDescriptor</a>,
00046     <a class="code" href="../../d0/d5/se_8h.html#a200a110">DeleteSecurityDescriptor</a>,
00047     <a class="code" href="../../d0/d5/se_8h.html#a200a111">AssignSecurityDescriptor</a>
00048     } <a class="code" href="../../d0/d5/se_8h.html#a19">SECURITY_OPERATION_CODE</a>, *<a class="code" href="../../d0/d5/se_8h.html#a20">PSECURITY_OPERATION_CODE</a>;
00049 
00050 <span class="comment">// end_ntddk end_nthal end_ntifs</span>
00051 
00052 
00053 
00054 <span class="comment">//</span>
00055 <span class="comment">//  Default security quota</span>
00056 <span class="comment">//</span>
00057 <span class="comment">//  This is the minimum amount of quota (in bytes) that will be</span>
00058 <span class="comment">//  charged for security information for an object that has</span>
00059 <span class="comment">//  security.</span>
00060 <span class="comment">//</span>
00061 
<a name="l00062"></a><a class="code" href="../../d0/d5/se_8h.html#a0">00062</a> <span class="preprocessor">#define SE_DEFAULT_SECURITY_QUOTA   2048</span>
00063 <span class="preprocessor"></span>
00064 <span class="comment">// begin_ntifs</span>
00065 <span class="comment">//</span>
00066 <span class="comment">// Token Flags</span>
00067 <span class="comment">//</span>
00068 <span class="comment">// Flags that may be defined in the TokenFlags field of the token object,</span>
00069 <span class="comment">// or in an ACCESS_STATE structure</span>
00070 <span class="comment">//</span>
00071 
<a name="l00072"></a><a class="code" href="../../d0/d5/se_8h.html#a1">00072</a> <span class="preprocessor">#define TOKEN_HAS_TRAVERSE_PRIVILEGE    0x01</span>
<a name="l00073"></a><a class="code" href="../../d0/d5/se_8h.html#a2">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define TOKEN_HAS_BACKUP_PRIVILEGE      0x02</span>
<a name="l00074"></a><a class="code" href="../../d0/d5/se_8h.html#a3">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define TOKEN_HAS_RESTORE_PRIVILEGE     0x04</span>
<a name="l00075"></a><a class="code" href="../../d0/d5/se_8h.html#a4">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define TOKEN_HAS_ADMIN_GROUP           0x08</span>
<a name="l00076"></a><a class="code" href="../../d0/d5/se_8h.html#a5">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define TOKEN_IS_RESTRICTED             0x10</span>
00077 <span class="preprocessor"></span>
00078 <span class="comment">// end_ntifs</span>
00079 
00080 
00081 <span class="comment">//</span>
00082 <span class="comment">// General flag</span>
00083 <span class="comment">//</span>
00084 
<a name="l00085"></a><a class="code" href="../../d0/d5/se_8h.html#a6">00085</a> <span class="preprocessor">#define SE_BACKUP_PRIVILEGES_CHECKED    0x00000010</span>
00086 <span class="preprocessor"></span>
00087 
00088 
00089 
00090 <span class="comment">// begin_ntddk begin_nthal begin_ntifs</span>
00091 <span class="comment">//</span>
00092 <span class="comment">//  Data structure used to capture subject security context</span>
00093 <span class="comment">//  for access validations and auditing.</span>
00094 <span class="comment">//</span>
00095 <span class="comment">//  THE FIELDS OF THIS DATA STRUCTURE SHOULD BE CONSIDERED OPAQUE</span>
00096 <span class="comment">//  BY ALL EXCEPT THE SECURITY ROUTINES.</span>
00097 <span class="comment">//</span>
00098 
<a name="l00099"></a><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html">00099</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html">_SECURITY_SUBJECT_CONTEXT</a> {
<a name="l00100"></a><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o0">00100</a>     PACCESS_TOKEN <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o0">ClientToken</a>;
<a name="l00101"></a><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o1">00101</a>     SECURITY_IMPERSONATION_LEVEL <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o1">ImpersonationLevel</a>;
<a name="l00102"></a><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o2">00102</a>     PACCESS_TOKEN <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o2">PrimaryToken</a>;
<a name="l00103"></a><a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o3">00103</a>     PVOID <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html#o3">ProcessAuditId</a>;
00104     } <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html">SECURITY_SUBJECT_CONTEXT</a>, *<a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html">PSECURITY_SUBJECT_CONTEXT</a>;
00105 
00106 <span class="comment">// end_ntddk end_nthal end_ntifs</span>
00107 <span class="comment">//</span>
00108 <span class="comment">// where</span>
00109 <span class="comment">//</span>
00110 <span class="comment">//    ClientToken - optionally points to a token object being used by the</span>
00111 <span class="comment">//        subject's thread to impersonate a client.  If the subject's</span>
00112 <span class="comment">//        thread is not impersonating a client, this field is set to null.</span>
00113 <span class="comment">//        The token's reference count is incremented to count this field</span>
00114 <span class="comment">//        as an outstanding reference.</span>
00115 <span class="comment">//</span>
00116 <span class="comment">//    ImpersonationLevel - Contains the impersonation level of the subject's</span>
00117 <span class="comment">//        thread.  This field is only meaningful if the ClientToken field</span>
00118 <span class="comment">//        is not null.  This field over-rides any higher impersonation</span>
00119 <span class="comment">//        level value that might be in the client's token.</span>
00120 <span class="comment">//</span>
00121 <span class="comment">//    PrimaryToken - points the the subject's primary token.  The token's</span>
00122 <span class="comment">//        reference count is incremented to count this field value as an</span>
00123 <span class="comment">//        outstanding reference.</span>
00124 <span class="comment">//</span>
00125 <span class="comment">//    ProcessAuditId - Is an ID assigned to represent the subject's process.</span>
00126 <span class="comment">//        As an implementation detail, this is the process object's address.</span>
00127 <span class="comment">//        However, this field should not be treated as a pointer, and the</span>
00128 <span class="comment">//        reference count of the process object is not incremented to</span>
00129 <span class="comment">//        count it as an outstanding reference.</span>
00130 <span class="comment">//</span>
00131 
00132 
00133 <span class="comment">// begin_ntddk begin_nthal begin_ntifs</span>
00135 <span class="comment"></span><span class="comment">//                                                                           //</span>
00136 <span class="comment">//                  ACCESS_STATE and related structures                      //</span>
00137 <span class="comment">//                                                                           //</span>
00139 <span class="comment"></span>
00140 <span class="comment">//</span>
00141 <span class="comment">//  Initial Privilege Set - Room for three privileges, which should</span>
00142 <span class="comment">//  be enough for most applications.  This structure exists so that</span>
00143 <span class="comment">//  it can be imbedded in an ACCESS_STATE structure.  Use PRIVILEGE_SET</span>
00144 <span class="comment">//  for all other references to Privilege sets.</span>
00145 <span class="comment">//</span>
00146 
<a name="l00147"></a><a class="code" href="../../d0/d5/se_8h.html#a7">00147</a> <span class="preprocessor">#define INITIAL_PRIVILEGE_COUNT         3</span>
00148 <span class="preprocessor"></span>
<a name="l00149"></a><a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html">00149</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html">_INITIAL_PRIVILEGE_SET</a> {
<a name="l00150"></a><a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o0">00150</a>     ULONG <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o0">PrivilegeCount</a>;
<a name="l00151"></a><a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o1">00151</a>     ULONG <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o1">Control</a>;
<a name="l00152"></a><a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o2">00152</a>     LUID_AND_ATTRIBUTES <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html#o2">Privilege</a>[<a class="code" href="../../d0/d5/se_8h.html#a7">INITIAL_PRIVILEGE_COUNT</a>];
00153     } <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html">INITIAL_PRIVILEGE_SET</a>, * <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html">PINITIAL_PRIVILEGE_SET</a>;
00154 
00155 
00156 
00157 <span class="comment">//</span>
00158 <span class="comment">// Combine the information that describes the state</span>
00159 <span class="comment">// of an access-in-progress into a single structure</span>
00160 <span class="comment">//</span>
00161 
00162 
<a name="l00163"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">00163</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">_ACCESS_STATE</a> {
<a name="l00164"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o0">00164</a>    LUID <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o0">OperationID</a>;
<a name="l00165"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o1">00165</a>    BOOLEAN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o1">SecurityEvaluated</a>;
<a name="l00166"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o2">00166</a>    BOOLEAN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o2">GenerateAudit</a>;
<a name="l00167"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o3">00167</a>    BOOLEAN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o3">GenerateOnClose</a>;
<a name="l00168"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o4">00168</a>    BOOLEAN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o4">PrivilegesAllocated</a>;
<a name="l00169"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o5">00169</a>    ULONG <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o5">Flags</a>;
<a name="l00170"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o6">00170</a>    ACCESS_MASK <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o6">RemainingDesiredAccess</a>;
<a name="l00171"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o7">00171</a>    ACCESS_MASK <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o7">PreviouslyGrantedAccess</a>;
<a name="l00172"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o8">00172</a>    ACCESS_MASK <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o8">OriginalDesiredAccess</a>;
<a name="l00173"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o9">00173</a>    <a class="code" href="../../d0/d1/struct__SECURITY__SUBJECT__CONTEXT.html">SECURITY_SUBJECT_CONTEXT</a> <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o9">SubjectSecurityContext</a>;
<a name="l00174"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o10">00174</a>    PSECURITY_DESCRIPTOR <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o10">SecurityDescriptor</a>;
<a name="l00175"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o11">00175</a>    PVOID <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o11">AuxData</a>;
00176    <span class="keyword">union </span>{
<a name="l00177"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o12">00177</a>       <a class="code" href="../../d3/d2/struct__INITIAL__PRIVILEGE__SET.html">INITIAL_PRIVILEGE_SET</a> <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o12">InitialPrivilegeSet</a>;
<a name="l00178"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o13">00178</a>       PRIVILEGE_SET <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o13">PrivilegeSet</a>;
00179       } Privileges;
00180 
<a name="l00181"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o15">00181</a>    BOOLEAN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o15">AuditPrivileges</a>;
<a name="l00182"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o16">00182</a>    UNICODE_STRING <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o16">ObjectName</a>;
<a name="l00183"></a><a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o17">00183</a>    UNICODE_STRING <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html#o17">ObjectTypeName</a>;
00184 
00185    } <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">ACCESS_STATE</a>, *<a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a>;
00186 
00187 <span class="comment">// end_ntddk end_nthal end_ntifs</span>
00188 
00189 <span class="comment">/*</span>
00190 <span class="comment">where:</span>
00191 <span class="comment"></span>
00192 <span class="comment">    OperationID - an LUID to identify the operation being performed.  This</span>
00193 <span class="comment">        ID will be put in the audit log to allow non-contiguous operations</span>
00194 <span class="comment">        on the same object to be associated with one another.</span>
00195 <span class="comment"></span>
00196 <span class="comment">    SecurityEvaluated - a marker to be set by Parse Methods to indicate</span>
00197 <span class="comment">        that security access checking and audit logging has been performed.</span>
00198 <span class="comment"></span>
00199 <span class="comment">    Flags - Holds misc flags for reference during the access attempt.</span>
00200 <span class="comment"></span>
00201 <span class="comment">    AuditHandleCreation - a flag set by SeOpenObjectAuditAlarm to indicate</span>
00202 <span class="comment">        that auditing is to take place when the handle for the object</span>
00203 <span class="comment">        is allocated.</span>
00204 <span class="comment"></span>
00205 <span class="comment">    RemainingDesiredAccess - Access mask containing the access types that</span>
00206 <span class="comment">        have not yet been granted.</span>
00207 <span class="comment"></span>
00208 <span class="comment">    PreviouslyGrantedAccess - Access mask containing the access types that</span>
00209 <span class="comment">        have been granted, one way or another (for example, a given access</span>
00210 <span class="comment">        may be granted as a result of owning a privilege rather than being</span>
00211 <span class="comment">        in an ACL.  A routine can check the privilege and mark the access</span>
00212 <span class="comment">        as granted without doing a formal access check).</span>
00213 <span class="comment"></span>
00214 <span class="comment">    SubjectSecurityContext - The subject's captured security context</span>
00215 <span class="comment"></span>
00216 <span class="comment">    PrivilegesAllocated - Flag to indicate whether we have allocated</span>
00217 <span class="comment">        space for the privilege set from pool memory, so it can be</span>
00218 <span class="comment">        freed.</span>
00219 <span class="comment"></span>
00220 <span class="comment">    SecurityDescriptor - Temporarily contains the security descriptor</span>
00221 <span class="comment">       for the object being created between the time the user's</span>
00222 <span class="comment">       security descriptor is captured and the time the security</span>
00223 <span class="comment">       descriptor is passed to SeAssignSecurity.  NO ONE BUT</span>
00224 <span class="comment">       SEASSIGNSECURITY SHOULD EVER LOOK IN THIS FIELD FOR AN</span>
00225 <span class="comment">       OBJECT'S SECURITY DESCRIPTOR.</span>
00226 <span class="comment"></span>
00227 <span class="comment">    AuxData - points to an auxillary data structure to be used for future</span>
00228 <span class="comment">        expansion of the access state in an upwardly compatible way.  This</span>
00229 <span class="comment">        field replaces the PrivilegesUsed pointer, which was for internal</span>
00230 <span class="comment">        use only.</span>
00231 <span class="comment"></span>
00232 <span class="comment">    Privileges - A set of privileges, some of which may have the</span>
00233 <span class="comment">        UsedForAccess bit set.  If the pre-allocated number of privileges</span>
00234 <span class="comment">        is not enough, we will allocate space from pool memory to allow</span>
00235 <span class="comment">        for growth.</span>
00236 <span class="comment"></span>
00237 <span class="comment">*/</span>
00238 
00239 
00240 
00241 <span class="comment">//*******************************************************************************</span>
00242 <span class="comment">//                                                                              *</span>
00243 <span class="comment">//  Since the AccessState structure is publically exposed to driver             *</span>
00244 <span class="comment">//  writers, this structure contains additional data added after NT 3.51.       *</span>
00245 <span class="comment">//                                                                              *</span>
00246 <span class="comment">//  Its contents must be accessed only through Se level interfaces,             *</span>
00247 <span class="comment">//  never directly by name.                                                     *</span>
00248 <span class="comment">//                                                                              *</span>
00249 <span class="comment">//  This structure is pointed to by the AuxData field of the AccessState.       *</span>
00250 <span class="comment">//  It is allocated by SeCreateAccessState and freed by SeDeleteAccessState.    *</span>
00251 <span class="comment">//                                                                              *</span>
00252 <span class="comment">//  DO NOT EXPOSE THIS STRUCTURE TO THE PUBLIC.                                 *</span>
00253 <span class="comment">//                                                                              *</span>
00254 <span class="comment">//*******************************************************************************</span>
00255 
00256 
<a name="l00257"></a><a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html">00257</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html">_AUX_ACCESS_DATA</a> {
<a name="l00258"></a><a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o0">00258</a>     PPRIVILEGE_SET <a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o0">PrivilegesUsed</a>;
<a name="l00259"></a><a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o1">00259</a>     GENERIC_MAPPING <a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o1">GenericMapping</a>;
<a name="l00260"></a><a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o2">00260</a>     ACCESS_MASK <a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html#o2">AccessesToAudit</a>;
00261 } <a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html">AUX_ACCESS_DATA</a>, *<a class="code" href="../../d5/d2/struct__AUX__ACCESS__DATA.html">PAUX_ACCESS_DATA</a>;
00262 
00263 <span class="comment">/*</span>
00264 <span class="comment">where:</span>
00265 <span class="comment"></span>
00266 <span class="comment">    PrivilegesUsed - Points to the set of privileges used during the access</span>
00267 <span class="comment">        validation.</span>
00268 <span class="comment"></span>
00269 <span class="comment">    GenericMapping - Points to the generic mapping for the object being accessed.</span>
00270 <span class="comment">        Normally this would be filled in with the generic mapping passed to</span>
00271 <span class="comment">        SeCreateAccessState, but in the case of the IO system (which does not</span>
00272 <span class="comment">        know the type of object being accessed until it parses the name),</span>
00273 <span class="comment">        it must be filled in later.  See the discussion of the GenericMapping</span>
00274 <span class="comment">        parameter in SeCreateAccessState for more details.</span>
00275 <span class="comment"></span>
00276 <span class="comment">    AccessToAudit - Used as a temporary holding area for the access mask</span>
00277 <span class="comment">        to put into the audit record.  This field is necessary because the</span>
00278 <span class="comment">        access being put into the newly created handle may not be the ones</span>
00279 <span class="comment">        we want to audit.  This occurs when a file is opened for read-only</span>
00280 <span class="comment">        transacted mode, where a read only file is opened for write access.</span>
00281 <span class="comment">        We don't want to audit the fact that we granted write access, since</span>
00282 <span class="comment">        we really didn't, and customers would be confused to see the extra</span>
00283 <span class="comment">        bit in the audit record.</span>
00284 <span class="comment"></span>
00285 <span class="comment"></span>
00286 <span class="comment">*/</span>
00287 
00288 
00289 
00290 <span class="comment">//</span>
00291 <span class="comment">//  Structure describing whether or not a particular type of event</span>
00292 <span class="comment">//  is being audited</span>
00293 <span class="comment">//</span>
00294 
<a name="l00295"></a><a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html">00295</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html">_SE_AUDITING_STATE</a> {
<a name="l00296"></a><a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html#o0">00296</a>     BOOLEAN <a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html#o0">AuditOnSuccess</a>;
<a name="l00297"></a><a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html#o1">00297</a>     BOOLEAN <a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html#o1">AuditOnFailure</a>;
00298 } <a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html">SE_AUDITING_STATE</a>, *<a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html">PSE_AUDITING_STATE</a>;
00299 
00300 
00301 
00302 
<a name="l00303"></a><a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html">00303</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html">_SE_PROCESS_AUDIT_INFO</a> {
<a name="l00304"></a><a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html#o0">00304</a>     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html#o0">Process</a>;
<a name="l00305"></a><a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html#o1">00305</a>     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html#o1">Parent</a>;
00306 } <a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html">SE_PROCESS_AUDIT_INFO</a>, *<a class="code" href="../../d3/d0/struct__SE__PROCESS__AUDIT__INFO.html">PSE_PROCESS_AUDIT_INFO</a>;
00307 
00308 
00309 
00310 
00311 <span class="comment">/************************************************************</span>
00312 <span class="comment"></span>
00313 <span class="comment">                 WARNING WARNING WARNING</span>
00314 <span class="comment"></span>
00315 <span class="comment"></span>
00316 <span class="comment">    Only add new fields to the end of this structure.</span>
00317 <span class="comment"></span>
00318 <span class="comment"></span>
00319 <span class="comment">*************************************************************/</span>
00320 
00321 <span class="comment">// begin_ntifs</span>
00322 
<a name="l00323"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html">00323</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html">_SE_EXPORTS</a> {
00324 
00325     <span class="comment">//</span>
00326     <span class="comment">// Privilege values</span>
00327     <span class="comment">//</span>
00328 
<a name="l00329"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o0">00329</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o0">SeCreateTokenPrivilege</a>;
<a name="l00330"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o1">00330</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o1">SeAssignPrimaryTokenPrivilege</a>;
<a name="l00331"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o2">00331</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o2">SeLockMemoryPrivilege</a>;
<a name="l00332"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o3">00332</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o3">SeIncreaseQuotaPrivilege</a>;
<a name="l00333"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o4">00333</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o4">SeUnsolicitedInputPrivilege</a>;
<a name="l00334"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o5">00334</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o5">SeTcbPrivilege</a>;
<a name="l00335"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o6">00335</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o6">SeSecurityPrivilege</a>;
<a name="l00336"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o7">00336</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o7">SeTakeOwnershipPrivilege</a>;
<a name="l00337"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o8">00337</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o8">SeLoadDriverPrivilege</a>;
<a name="l00338"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o9">00338</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o9">SeCreatePagefilePrivilege</a>;
<a name="l00339"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o10">00339</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o10">SeIncreaseBasePriorityPrivilege</a>;
<a name="l00340"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o11">00340</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o11">SeSystemProfilePrivilege</a>;
<a name="l00341"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o12">00341</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o12">SeSystemtimePrivilege</a>;
<a name="l00342"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o13">00342</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o13">SeProfileSingleProcessPrivilege</a>;
<a name="l00343"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o14">00343</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o14">SeCreatePermanentPrivilege</a>;
<a name="l00344"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o15">00344</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o15">SeBackupPrivilege</a>;
<a name="l00345"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o16">00345</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o16">SeRestorePrivilege</a>;
<a name="l00346"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o17">00346</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o17">SeShutdownPrivilege</a>;
<a name="l00347"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o18">00347</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o18">SeDebugPrivilege</a>;
<a name="l00348"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o19">00348</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o19">SeAuditPrivilege</a>;
<a name="l00349"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o20">00349</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o20">SeSystemEnvironmentPrivilege</a>;
<a name="l00350"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o21">00350</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o21">SeChangeNotifyPrivilege</a>;
<a name="l00351"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o22">00351</a>     LUID    <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o22">SeRemoteShutdownPrivilege</a>;
00352 
00353 
00354     <span class="comment">//</span>
00355     <span class="comment">// Universally defined Sids</span>
00356     <span class="comment">//</span>
00357 
00358 
<a name="l00359"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o23">00359</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o23">SeNullSid</a>;
<a name="l00360"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o24">00360</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o24">SeWorldSid</a>;
<a name="l00361"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o25">00361</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o25">SeLocalSid</a>;
<a name="l00362"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o26">00362</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o26">SeCreatorOwnerSid</a>;
<a name="l00363"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o27">00363</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o27">SeCreatorGroupSid</a>;
00364 
00365 
00366     <span class="comment">//</span>
00367     <span class="comment">// Nt defined Sids</span>
00368     <span class="comment">//</span>
00369 
00370 
<a name="l00371"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o28">00371</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o28">SeNtAuthoritySid</a>;
<a name="l00372"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o29">00372</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o29">SeDialupSid</a>;
<a name="l00373"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o30">00373</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o30">SeNetworkSid</a>;
<a name="l00374"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o31">00374</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o31">SeBatchSid</a>;
<a name="l00375"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o32">00375</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o32">SeInteractiveSid</a>;
<a name="l00376"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o33">00376</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o33">SeLocalSystemSid</a>;
<a name="l00377"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o34">00377</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o34">SeAliasAdminsSid</a>;
<a name="l00378"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o35">00378</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o35">SeAliasUsersSid</a>;
<a name="l00379"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o36">00379</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o36">SeAliasGuestsSid</a>;
<a name="l00380"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o37">00380</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o37">SeAliasPowerUsersSid</a>;
<a name="l00381"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o38">00381</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o38">SeAliasAccountOpsSid</a>;
<a name="l00382"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o39">00382</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o39">SeAliasSystemOpsSid</a>;
<a name="l00383"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o40">00383</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o40">SeAliasPrintOpsSid</a>;
<a name="l00384"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o41">00384</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o41">SeAliasBackupOpsSid</a>;
00385 
00386     <span class="comment">//</span>
00387     <span class="comment">// New Sids defined for NT5</span>
00388     <span class="comment">//</span>
00389 
<a name="l00390"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o42">00390</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o42">SeAuthenticatedUsersSid</a>;
00391 
<a name="l00392"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o43">00392</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o43">SeRestrictedSid</a>;
<a name="l00393"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o44">00393</a>     PSID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o44">SeAnonymousLogonSid</a>;
00394 
00395     <span class="comment">//</span>
00396     <span class="comment">// New Privileges defined for NT5</span>
00397     <span class="comment">//</span>
00398 
<a name="l00399"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o45">00399</a>     LUID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o45">SeUndockPrivilege</a>;
<a name="l00400"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o46">00400</a>     LUID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o46">SeSyncAgentPrivilege</a>;
<a name="l00401"></a><a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o47">00401</a>     LUID  <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html#o47">SeEnableDelegationPrivilege</a>;
00402 
00403 } <a class="code" href="../../d2/d0/struct__SE__EXPORTS.html">SE_EXPORTS</a>, *<a class="code" href="../../d2/d0/struct__SE__EXPORTS.html">PSE_EXPORTS</a>;
00404 
00405 <span class="comment">// end_ntifs</span>
00406 
00407 <span class="comment">/************************************************************</span>
00408 <span class="comment"></span>
00409 <span class="comment"></span>
00410 <span class="comment">                 WARNING WARNING WARNING</span>
00411 <span class="comment"></span>
00412 <span class="comment"></span>
00413 <span class="comment">    Only add new fields to the end of this structure.</span>
00414 <span class="comment"></span>
00415 <span class="comment"></span>
00416 <span class="comment">*************************************************************/</span>
00417 
00418 
00419 
00420 <span class="comment">// begin_ntifs</span>
00422 <span class="comment"></span><span class="comment">//                                                                           //</span>
00423 <span class="comment">//              Logon session notification callback routines                 //</span>
00424 <span class="comment">//                                                                           //</span>
00426 <span class="comment"></span>
00427 <span class="comment">//</span>
00428 <span class="comment">//  These callback routines are used to notify file systems that have</span>
00429 <span class="comment">//  registered of logon sessions being terminated, so they can cleanup state</span>
00430 <span class="comment">//  associated with this logon session</span>
00431 <span class="comment">//</span>
00432 
00433 <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00434"></a><a class="code" href="../../d0/d5/se_8h.html#a35">00434</a> (*PSE_LOGON_SESSION_TERMINATED_ROUTINE)(
00435     IN PLUID LogonId);
00436 
00437 <span class="comment">// end_ntifs</span>
00438 
00439 
00440 
00441 
00442 
00444 <span class="comment">//                                                                           //</span>
00445 <span class="comment">//                  Exported Security Macro Definitions                      //</span>
00446 <span class="comment">//                                                                           //</span>
00448 <span class="comment"></span>
00449 <span class="comment">//++</span>
00450 <span class="comment">//</span>
00451 <span class="comment">//  ACCESS_MASK</span>
00452 <span class="comment">//  SeComputeDeniedAccesses(</span>
00453 <span class="comment">//      IN ACCESS_MASK GrantedAccess,</span>
00454 <span class="comment">//      IN ACCESS_MASK DesiredAccess</span>
00455 <span class="comment">//      );</span>
00456 <span class="comment">//</span>
00457 <span class="comment">//  Routine Description:</span>
00458 <span class="comment">//</span>
00459 <span class="comment">//      This routine generates an access mask containing those accesses</span>
00460 <span class="comment">//      requested by DesiredAccess that aren't granted by GrantedAccess.</span>
00461 <span class="comment">//      The result of this routine may be compared to 0 to determine</span>
00462 <span class="comment">//      if a DesiredAccess mask contains any accesses that have not</span>
00463 <span class="comment">//      been granted.</span>
00464 <span class="comment">//</span>
00465 <span class="comment">//      If the result IS ZERO, then all desired accesses have been granted.</span>
00466 <span class="comment">//</span>
00467 <span class="comment">//  Arguments:</span>
00468 <span class="comment">//</span>
00469 <span class="comment">//      GrantedAccess - Specifies the granted access mask.</span>
00470 <span class="comment">//</span>
00471 <span class="comment">//      DesiredAccess - Specifies the desired access mask.</span>
00472 <span class="comment">//</span>
00473 <span class="comment">//  Return Value:</span>
00474 <span class="comment">//</span>
00475 <span class="comment">//      An ACCESS_MASK containing the desired accesses that have</span>
00476 <span class="comment">//      not been granted.</span>
00477 <span class="comment">//</span>
00478 <span class="comment">//--</span>
00479 
<a name="l00480"></a><a class="code" href="../../d0/d5/se_8h.html#a8">00480</a> <span class="preprocessor">#define SeComputeDeniedAccesses( GrantedAccess, DesiredAccess ) \</span>
00481 <span class="preprocessor">    ((~(GrantedAccess)) &amp; (DesiredAccess) )</span>
00482 <span class="preprocessor"></span>
00483 
00484 <span class="comment">//++</span>
00485 <span class="comment">//</span>
00486 <span class="comment">//  BOOLEAN</span>
00487 <span class="comment">//  SeComputeGrantedAccesses(</span>
00488 <span class="comment">//      IN ACCESS_MASK GrantedAccess,</span>
00489 <span class="comment">//      IN ACCESS_MASK DesiredAccess</span>
00490 <span class="comment">//      );</span>
00491 <span class="comment">//</span>
00492 <span class="comment">//  Routine Description:</span>
00493 <span class="comment">//</span>
00494 <span class="comment">//      This routine generates an access mask containing acccesses</span>
00495 <span class="comment">//      requested by DesiredAccess that are granted by GrantedAccess.</span>
00496 <span class="comment">//      The result of this routine may be compared to 0 to determine</span>
00497 <span class="comment">//      if any desired accesses have been granted.</span>
00498 <span class="comment">//</span>
00499 <span class="comment">//      If the result IS NON-ZERO, then at least one desired accesses</span>
00500 <span class="comment">//      has been granted.</span>
00501 <span class="comment">//</span>
00502 <span class="comment">//  Arguments:</span>
00503 <span class="comment">//</span>
00504 <span class="comment">//      GrantedAccess - Specifies the granted access mask.</span>
00505 <span class="comment">//</span>
00506 <span class="comment">//      DesiredAccess - Specifies the desired access mask.</span>
00507 <span class="comment">//</span>
00508 <span class="comment">//  Return Value:</span>
00509 <span class="comment">//</span>
00510 <span class="comment">//      This routine returns TRUE if the DesiredAccess mask does specifies</span>
00511 <span class="comment">//      any bits that are set in the GrantedAccess mask.</span>
00512 <span class="comment">//</span>
00513 <span class="comment">//--</span>
00514 
<a name="l00515"></a><a class="code" href="../../d0/d5/se_8h.html#a9">00515</a> <span class="preprocessor">#define SeComputeGrantedAccesses( GrantedAccess, DesiredAccess ) \</span>
00516 <span class="preprocessor">    ((GrantedAccess) &amp; (DesiredAccess) )</span>
00517 <span class="preprocessor"></span>
00518 
00519 <span class="comment">//++</span>
00520 <span class="comment">//</span>
00521 <span class="comment">//  ULONG</span>
00522 <span class="comment">//  SeLengthSid(</span>
00523 <span class="comment">//      IN PSID Sid</span>
00524 <span class="comment">//      );</span>
00525 <span class="comment">//</span>
00526 <span class="comment">//  Routine Description:</span>
00527 <span class="comment">//</span>
00528 <span class="comment">//      This routine computes the length of a SID.</span>
00529 <span class="comment">//</span>
00530 <span class="comment">//  Arguments:</span>
00531 <span class="comment">//</span>
00532 <span class="comment">//      Sid - Points to the SID whose length is to be returned.</span>
00533 <span class="comment">//</span>
00534 <span class="comment">//  Return Value:</span>
00535 <span class="comment">//</span>
00536 <span class="comment">//      The length, in bytes of the SID.</span>
00537 <span class="comment">//</span>
00538 <span class="comment">//--</span>
00539 
<a name="l00540"></a><a class="code" href="../../d0/d5/se_8h.html#a10">00540</a> <span class="preprocessor">#define SeLengthSid( Sid ) \</span>
00541 <span class="preprocessor">    (8 + (4 * ((SID *)Sid)-&gt;SubAuthorityCount))</span>
00542 <span class="preprocessor"></span>
00543 
00544 <span class="comment">//++</span>
00545 <span class="comment">//  BOOLEAN</span>
00546 <span class="comment">//  SeSameToken (</span>
00547 <span class="comment">//      IN PTOKEN_CONTROL TokenControl1,</span>
00548 <span class="comment">//      IN PTOKEN_CONTROL TokenControl2</span>
00549 <span class="comment">//      )</span>
00550 <span class="comment">//</span>
00551 <span class="comment">//</span>
00552 <span class="comment">//  Routine Description:</span>
00553 <span class="comment">//</span>
00554 <span class="comment">//      This routine returns a boolean value indicating whether the two</span>
00555 <span class="comment">//      token control values represent the same token.  The token may</span>
00556 <span class="comment">//      have changed over time, but must have the same authentication ID</span>
00557 <span class="comment">//      and token ID.  A value of TRUE indicates they</span>
00558 <span class="comment">//      are equal.  A value of FALSE indicates they are not equal.</span>
00559 <span class="comment">//</span>
00560 <span class="comment">//</span>
00561 <span class="comment">//</span>
00562 <span class="comment">//  Arguments:</span>
00563 <span class="comment">//</span>
00564 <span class="comment">//      TokenControl1 - Points to a token control to compare.</span>
00565 <span class="comment">//</span>
00566 <span class="comment">//      TokenControl2 - Points to the other token control to compare.</span>
00567 <span class="comment">//</span>
00568 <span class="comment">//  Return Value:</span>
00569 <span class="comment">//</span>
00570 <span class="comment">//      TRUE =&gt; The token control values represent the same token.</span>
00571 <span class="comment">//</span>
00572 <span class="comment">//      FALSE =&gt; The token control values do not represent the same token.</span>
00573 <span class="comment">//</span>
00574 <span class="comment">//</span>
00575 <span class="comment">//--</span>
00576 
<a name="l00577"></a><a class="code" href="../../d0/d5/se_8h.html#a11">00577</a> <span class="preprocessor">#define SeSameToken(TC1,TC2)  (                                               \</span>
00578 <span class="preprocessor">        ((TC1)-&gt;TokenId.HighPart == (TC2)-&gt;TokenId.HighPart)               &amp;&amp; \</span>
00579 <span class="preprocessor">        ((TC1)-&gt;TokenId.LowPart  == (TC2)-&gt;TokenId.LowPart)                &amp;&amp; \</span>
00580 <span class="preprocessor">        (RtlEqualLuid(&amp;(TC1)-&gt;AuthenticationId,&amp;(TC2)-&gt;AuthenticationId))     \</span>
00581 <span class="preprocessor">        )</span>
00582 <span class="preprocessor"></span>
00583 
00584 <span class="comment">// begin_ntifs</span>
00585 <span class="comment">//</span>
00586 <span class="comment">//VOID</span>
00587 <span class="comment">//SeDeleteClientSecurity(</span>
00588 <span class="comment">//    IN PSECURITY_CLIENT_CONTEXT ClientContext</span>
00589 <span class="comment">//    )</span>
00590 <span class="comment">//</span>
00592 <span class="comment"></span><span class="comment">//</span>
00593 <span class="comment">//Routine Description:</span>
00594 <span class="comment">//</span>
00595 <span class="comment">//    This service deletes a client security context block,</span>
00596 <span class="comment">//    performing whatever cleanup might be necessary to do so.  In</span>
00597 <span class="comment">//    particular, reference to any client token is removed.</span>
00598 <span class="comment">//</span>
00599 <span class="comment">//Arguments:</span>
00600 <span class="comment">//</span>
00601 <span class="comment">//    ClientContext - Points to the client security context block to be</span>
00602 <span class="comment">//        deleted.</span>
00603 <span class="comment">//</span>
00604 <span class="comment">//</span>
00605 <span class="comment">//Return Value:</span>
00606 <span class="comment">//</span>
00607 <span class="comment">//</span>
00608 <span class="comment">//</span>
00609 <span class="comment">//--*/</span>
00610 <span class="comment">//--</span>
00611 
<a name="l00612"></a><a class="code" href="../../d0/d5/se_8h.html#a12">00612</a> <span class="preprocessor">#define SeDeleteClientSecurity(C)  {                                           \</span>
00613 <span class="preprocessor">            if (SeTokenType((C)-&gt;ClientToken) == TokenPrimary) {               \</span>
00614 <span class="preprocessor">                PsDereferencePrimaryToken( (C)-&gt;ClientToken );                 \</span>
00615 <span class="preprocessor">            } else {                                                           \</span>
00616 <span class="preprocessor">                PsDereferenceImpersonationToken( (C)-&gt;ClientToken );           \</span>
00617 <span class="preprocessor">            }                                                                  \</span>
00618 <span class="preprocessor">        }</span>
00619 <span class="preprocessor"></span>
00620 <span class="comment">// end_ntifs</span>
00621 
00622 <span class="comment">//++</span>
00623 <span class="comment">//VOID</span>
00624 <span class="comment">//SeStopImpersonatingClient()</span>
00625 <span class="comment">//</span>
00627 <span class="comment"></span><span class="comment">//</span>
00628 <span class="comment">//Routine Description:</span>
00629 <span class="comment">//</span>
00630 <span class="comment">//    This service is used to stop impersonating a client using an</span>
00631 <span class="comment">//    impersonation token.  This service must be called in the context</span>
00632 <span class="comment">//    of the server thread which wishes to stop impersonating its</span>
00633 <span class="comment">//    client.</span>
00634 <span class="comment">//</span>
00635 <span class="comment">//</span>
00636 <span class="comment">//Arguments:</span>
00637 <span class="comment">//</span>
00638 <span class="comment">//    None.</span>
00639 <span class="comment">//</span>
00640 <span class="comment">//Return Value:</span>
00641 <span class="comment">//</span>
00642 <span class="comment">//    None.</span>
00643 <span class="comment">//</span>
00644 <span class="comment">//--*/</span>
00645 <span class="comment">//--</span>
00646 
<a name="l00647"></a><a class="code" href="../../d0/d5/se_8h.html#a13">00647</a> <span class="preprocessor">#define SeStopImpersonatingClient() PsRevertToSelf()</span>
00648 <span class="preprocessor"></span>
00649 
<a name="l00650"></a><a class="code" href="../../d0/d5/se_8h.html#a14">00650</a> <span class="preprocessor">#define SeAssertMappedCanonicalAccess( AccessMask )                  \</span>
00651 <span class="preprocessor">    ASSERT(!( ( AccessMask ) &amp;                                       \</span>
00652 <span class="preprocessor">            ( GENERIC_READ        |                                  \</span>
00653 <span class="preprocessor">              GENERIC_WRITE       |                                  \</span>
00654 <span class="preprocessor">              GENERIC_EXECUTE     |                                  \</span>
00655 <span class="preprocessor">              GENERIC_ALL ))                                         \</span>
00656 <span class="preprocessor">          )</span>
00657 <span class="preprocessor"></span><span class="comment">/*++</span>
00658 <span class="comment"></span>
00659 <span class="comment">Routine Description:</span>
00660 <span class="comment"></span>
00661 <span class="comment">    This routine asserts that the given AccessMask does not contain</span>
00662 <span class="comment">    any generic access types.</span>
00663 <span class="comment"></span>
00664 <span class="comment">Arguments:</span>
00665 <span class="comment"></span>
00666 <span class="comment">    AccessMask - The access mask to be checked.</span>
00667 <span class="comment"></span>
00668 <span class="comment">Return Value:</span>
00669 <span class="comment"></span>
00670 <span class="comment">    None, or doesn't return.</span>
00671 <span class="comment"></span>
00672 <span class="comment">--*/</span>
00673 
00674 
00675 
<a name="l00676"></a><a class="code" href="../../d0/d5/se_8h.html#a15">00676</a> <span class="preprocessor">#define SeComputeSecurityQuota( Size )                                 \</span>
00677 <span class="preprocessor">    (                                                                  \</span>
00678 <span class="preprocessor">       ((( Size ) * 2 )  &gt; SE_DEFAULT_SECURITY_QUOTA) ?                \</span>
00679 <span class="preprocessor">                    (( Size ) * 2 ) : SE_DEFAULT_SECURITY_QUOTA        \</span>
00680 <span class="preprocessor">    )</span>
00681 <span class="preprocessor"></span>
00682 <span class="comment">/*++</span>
00683 <span class="comment"></span>
00684 <span class="comment">Routine Description:</span>
00685 <span class="comment"></span>
00686 <span class="comment">    This macro computes the amount of quota to charge for</span>
00687 <span class="comment">    security information.</span>
00688 <span class="comment"></span>
00689 <span class="comment">    The current algorithm is to use the larger of twice the size</span>
00690 <span class="comment">    of the Group + Dacl information being applied and the default as</span>
00691 <span class="comment">    specified by SE_DEFAULT_SECURITY_QUOTA.</span>
00692 <span class="comment"></span>
00693 <span class="comment">Arguments:</span>
00694 <span class="comment"></span>
00695 <span class="comment">    Size - The size in bytes of the Group + Dacl information being applied</span>
00696 <span class="comment">        to the object.</span>
00697 <span class="comment"></span>
00698 <span class="comment">Return Value:</span>
00699 <span class="comment"></span>
00700 <span class="comment">    The size in bytes to charge for security information on this object.</span>
00701 <span class="comment"></span>
00702 <span class="comment">--*/</span>
00703 
00704 <span class="comment">// begin_ntifs</span>
00705 
00706 <span class="comment">//++</span>
00707 <span class="comment">//</span>
00708 <span class="comment">//  PACCESS_TOKEN</span>
00709 <span class="comment">//  SeQuerySubjectContextToken(</span>
00710 <span class="comment">//      IN PSECURITY_SUBJECT_CONTEXT SubjectContext</span>
00711 <span class="comment">//      );</span>
00712 <span class="comment">//</span>
00713 <span class="comment">//  Routine Description:</span>
00714 <span class="comment">//</span>
00715 <span class="comment">//      This routine returns the effective token from the subject context,</span>
00716 <span class="comment">//      either the client token, if present, or the process token.</span>
00717 <span class="comment">//</span>
00718 <span class="comment">//  Arguments:</span>
00719 <span class="comment">//</span>
00720 <span class="comment">//      SubjectContext - Context to query</span>
00721 <span class="comment">//</span>
00722 <span class="comment">//  Return Value:</span>
00723 <span class="comment">//</span>
00724 <span class="comment">//      This routine returns the PACCESS_TOKEN for the effective token.</span>
00725 <span class="comment">//      The pointer may be passed to SeQueryInformationToken.  This routine</span>
00726 <span class="comment">//      does not affect the lock status of the token, i.e. the token is not</span>
00727 <span class="comment">//      locked.  If the SubjectContext has been locked, the token remains locked,</span>
00728 <span class="comment">//      if not, the token remains unlocked.</span>
00729 <span class="comment">//</span>
00730 <span class="comment">//--</span>
00731 
<a name="l00732"></a><a class="code" href="../../d0/d5/se_8h.html#a16">00732</a> <span class="preprocessor">#define SeQuerySubjectContextToken( SubjectContext ) \</span>
00733 <span class="preprocessor">        ( ARGUMENT_PRESENT( ((PSECURITY_SUBJECT_CONTEXT) SubjectContext)-&gt;ClientToken) ? \</span>
00734 <span class="preprocessor">            ((PSECURITY_SUBJECT_CONTEXT) SubjectContext)-&gt;ClientToken : \</span>
00735 <span class="preprocessor">            ((PSECURITY_SUBJECT_CONTEXT) SubjectContext)-&gt;PrimaryToken )</span>
00736 <span class="preprocessor"></span>
00737 <span class="comment">// end_ntifs</span>
00738 
00739 
00740 
00741 
00742 
00744 <span class="comment">//                                                                           //</span>
00745 <span class="comment">//  Define the exported procedures that are callable only from kernel mode   //</span>
00746 <span class="comment">//                                                                           //</span>
00748 <span class="comment"></span>
00749 BOOLEAN
00750 <a class="code" href="../../d9/d5/seinit_8c.html#a2">SeInitSystem</a>( VOID );
00751 
00752 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00753 <a class="code" href="../../d0/d6/semethod_8c.html#a1">SeSetSecurityAccessMask</a>(
00754     IN SECURITY_INFORMATION SecurityInformation,
00755     OUT PACCESS_MASK DesiredAccess
00756     );
00757 
00758 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00759 <a class="code" href="../../d0/d6/semethod_8c.html#a2">SeQuerySecurityAccessMask</a>(
00760     IN SECURITY_INFORMATION SecurityInformation,
00761     OUT PACCESS_MASK DesiredAccess
00762     );
00763 
00764 
00765 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00766 <a class="code" href="../../d0/d6/semethod_8c.html#a3">SeDefaultObjectMethod</a> (
00767     IN PVOID Object,
00768     IN SECURITY_OPERATION_CODE OperationCode,
00769     IN PSECURITY_INFORMATION SecurityInformation,
00770     IN OUT PSECURITY_DESCRIPTOR SecurityDescriptor,
00771     IN OUT PULONG Length,
00772     IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor,
00773     IN POOL_TYPE PoolType,
00774     IN PGENERIC_MAPPING GenericMapping
00775     );
00776 
00777 
00778 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00779 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00780 <a class="code" href="../../d2/d5/se_2capture_8c.html#a1">SeCaptureSecurityDescriptor</a> (
00781     IN PSECURITY_DESCRIPTOR InputSecurityDescriptor,
00782     IN KPROCESSOR_MODE RequestorMode,
00783     IN POOL_TYPE PoolType,
00784     IN BOOLEAN ForceCapture,
00785     OUT PSECURITY_DESCRIPTOR *OutputSecurityDescriptor
00786     );
00787 
00788 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00789 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00790 <a class="code" href="../../d2/d5/se_2capture_8c.html#a2">SeReleaseSecurityDescriptor</a> (
00791     IN PSECURITY_DESCRIPTOR CapturedSecurityDescriptor,
00792     IN KPROCESSOR_MODE RequestorMode,
00793     IN BOOLEAN ForceCapture
00794     );
00795 
00796 <span class="comment">// begin_ntifs</span>
00797 
00798 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00799 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00800 <a class="code" href="../../d0/d8/subject_8c.html#a0">SeCaptureSubjectContext</a> (
00801     OUT PSECURITY_SUBJECT_CONTEXT SubjectContext
00802     );
00803 
00804 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00805 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00806 <a class="code" href="../../d0/d8/subject_8c.html#a1">SeLockSubjectContext</a>(
00807     IN PSECURITY_SUBJECT_CONTEXT SubjectContext
00808     );
00809 
00810 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00811 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00812 <a class="code" href="../../d0/d8/subject_8c.html#a2">SeUnlockSubjectContext</a>(
00813     IN PSECURITY_SUBJECT_CONTEXT SubjectContext
00814     );
00815 
00816 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00817 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00818 <a class="code" href="../../d0/d8/subject_8c.html#a3">SeReleaseSubjectContext</a> (
00819     IN PSECURITY_SUBJECT_CONTEXT SubjectContext
00820     );
00821 
00822 <span class="comment">// end_ntifs</span>
00823 
00824 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00825 <a class="code" href="../../d2/d5/se_2capture_8c.html#a7">SeCaptureSecurityQos</a> (
00826     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL,
00827     IN KPROCESSOR_MODE RequestorMode,
00828     IN PBOOLEAN SecurityQosPresent,
00829     IN PSECURITY_ADVANCED_QUALITY_OF_SERVICE CapturedSecurityQos
00830     );
00831 
00832 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00833 <a class="code" href="../../d2/d5/se_2capture_8c.html#a6">SeFreeCapturedSecurityQos</a>(
00834     IN PVOID SecurityQos
00835     );
00836 
00837 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00838 <a class="code" href="../../d2/d5/se_2capture_8c.html#a8">SeCaptureSid</a> (
00839     IN PSID InputSid,
00840     IN KPROCESSOR_MODE RequestorMode,
00841     IN PVOID CaptureBuffer OPTIONAL,
00842     IN ULONG CaptureBufferLength,
00843     IN POOL_TYPE PoolType,
00844     IN BOOLEAN ForceCapture,
00845     OUT PSID *CapturedSid
00846     );
00847 
00848 
00849 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00850 <a class="code" href="../../d2/d5/se_2capture_8c.html#a9">SeReleaseSid</a> (
00851     IN PSID CapturedSid,
00852     IN KPROCESSOR_MODE RequestorMode,
00853     IN BOOLEAN ForceCapture
00854     );
00855 
00856 
00857 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00858 <a class="code" href="../../d2/d5/se_2capture_8c.html#a10">SeCaptureAcl</a> (
00859     IN PACL InputAcl,
00860     IN KPROCESSOR_MODE RequestorMode,
00861     IN PVOID CaptureBuffer OPTIONAL,
00862     IN ULONG CaptureBufferLength,
00863     IN POOL_TYPE PoolType,
00864     IN BOOLEAN ForceCapture,
00865     OUT PACL *CapturedAcl,
00866     OUT PULONG AlignedAclSize
00867     );
00868 
00869 
00870 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00871 <a class="code" href="../../d2/d5/se_2capture_8c.html#a11">SeReleaseAcl</a> (
00872     IN PACL CapturedAcl,
00873     IN KPROCESSOR_MODE RequestorMode,
00874     IN BOOLEAN ForceCapture
00875     );
00876 
00877 
00878 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00879 <a class="code" href="../../d2/d5/se_2capture_8c.html#a12">SeCaptureLuidAndAttributesArray</a> (
00880     IN PLUID_AND_ATTRIBUTES InputArray,
00881     IN ULONG ArrayCount,
00882     IN KPROCESSOR_MODE RequestorMode,
00883     IN PVOID CaptureBuffer OPTIONAL,
00884     IN ULONG CaptureBufferLength,
00885     IN POOL_TYPE PoolType,
00886     IN BOOLEAN ForceCapture,
00887     OUT PLUID_AND_ATTRIBUTES *CapturedArray,
00888     OUT PULONG AlignedArraySize
00889     );
00890 
00891 
00892 
00893 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00894 <a class="code" href="../../d2/d5/se_2capture_8c.html#a13">SeReleaseLuidAndAttributesArray</a> (
00895     IN PLUID_AND_ATTRIBUTES CapturedArray,
00896     IN KPROCESSOR_MODE RequestorMode,
00897     IN BOOLEAN ForceCapture
00898     );
00899 
00900 
00901 
00902 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00903 <a class="code" href="../../d2/d5/se_2capture_8c.html#a14">SeCaptureSidAndAttributesArray</a> (
00904     IN PSID_AND_ATTRIBUTES InputArray,
00905     IN ULONG ArrayCount,
00906     IN KPROCESSOR_MODE RequestorMode,
00907     IN PVOID CaptureBuffer OPTIONAL,
00908     IN ULONG CaptureBufferLength,
00909     IN POOL_TYPE PoolType,
00910     IN BOOLEAN ForceCapture,
00911     OUT PSID_AND_ATTRIBUTES *CapturedArray,
00912     OUT PULONG AlignedArraySize
00913     );
00914 
00915 
00916 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00917 <a class="code" href="../../d2/d5/se_2capture_8c.html#a15">SeReleaseSidAndAttributesArray</a> (
00918     IN PSID_AND_ATTRIBUTES CapturedArray,
00919     IN KPROCESSOR_MODE RequestorMode,
00920     IN BOOLEAN ForceCapture
00921     );
00922 
00923 <span class="comment">// begin_ntddk begin_ntifs</span>
00924 
00925 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00926 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00927 <a class="code" href="../../d1/d5/seassign_8c.html#a1">SeAssignSecurity</a> (
00928     IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL,
00929     IN PSECURITY_DESCRIPTOR ExplicitDescriptor,
00930     OUT PSECURITY_DESCRIPTOR *NewDescriptor,
00931     IN BOOLEAN IsDirectoryObject,
00932     IN PSECURITY_SUBJECT_CONTEXT SubjectContext,
00933     IN PGENERIC_MAPPING GenericMapping,
00934     IN POOL_TYPE PoolType
00935     );
00936 
00937 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00938 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00939 <a class="code" href="../../d1/d5/seassign_8c.html#a2">SeAssignSecurityEx</a> (
00940     IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL,
00941     IN PSECURITY_DESCRIPTOR ExplicitDescriptor OPTIONAL,
00942     OUT PSECURITY_DESCRIPTOR *NewDescriptor,
00943     IN GUID *ObjectType OPTIONAL,
00944     IN BOOLEAN IsDirectoryObject,
00945     IN ULONG AutoInheritFlags,
00946     IN PSECURITY_SUBJECT_CONTEXT SubjectContext,
00947     IN PGENERIC_MAPPING GenericMapping,
00948     IN POOL_TYPE PoolType
00949     );
00950 
00951 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00952 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00953 <a class="code" href="../../d1/d5/seassign_8c.html#a3">SeDeassignSecurity</a> (
00954     IN OUT PSECURITY_DESCRIPTOR *SecurityDescriptor
00955     );
00956 
00957 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00958 BOOLEAN
00959 <a class="code" href="../../d0/d4/accessck_8c.html#a18">SeAccessCheck</a> (
00960     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
00961     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
00962     IN BOOLEAN SubjectContextLocked,
00963     IN ACCESS_MASK DesiredAccess,
00964     IN ACCESS_MASK PreviouslyGrantedAccess,
00965     OUT PPRIVILEGE_SET *Privileges OPTIONAL,
00966     IN PGENERIC_MAPPING GenericMapping,
00967     IN KPROCESSOR_MODE AccessMode,
00968     OUT PACCESS_MASK GrantedAccess,
00969     OUT PNTSTATUS AccessStatus
00970     );
00971 
00972 <span class="comment">// end_ntddk end_ntifs</span>
00973 
00974 BOOLEAN
00975 <a class="code" href="../../d0/d4/accessck_8c.html#a19">SeProxyAccessCheck</a> (
00976     IN PUNICODE_STRING Volume,
00977     IN PUNICODE_STRING RelativePath,
00978     IN BOOLEAN ContainerObject,
00979     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
00980     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
00981     IN BOOLEAN SubjectContextLocked,
00982     IN ACCESS_MASK DesiredAccess,
00983     IN ACCESS_MASK PreviouslyGrantedAccess,
00984     OUT PPRIVILEGE_SET *Privileges OPTIONAL,
00985     IN PGENERIC_MAPPING GenericMapping,
00986     IN KPROCESSOR_MODE AccessMode,
00987     OUT PACCESS_MASK GrantedAccess,
00988     OUT PNTSTATUS AccessStatus
00989     );
00990 
00991 <span class="comment">// begin_ntifs</span>
00992 
00993 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00994 BOOLEAN
00995 <a class="code" href="../../d8/d4/privileg_8c.html#a1">SePrivilegeCheck</a>(
00996     IN OUT PPRIVILEGE_SET RequiredPrivileges,
00997     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
00998     IN KPROCESSOR_MODE AccessMode
00999     );
01000 
01001 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01002 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01003 <a class="code" href="../../d0/d4/accessck_8c.html#a17">SeFreePrivileges</a>(
01004     IN PPRIVILEGE_SET Privileges
01005     );
01006 
01007 <span class="comment">// end_ntifs</span>
01008 
01009 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01010 <a class="code" href="../../d0/d4/accessck_8c.html#a20">SePrivilegePolicyCheck</a>(
01011     IN OUT PACCESS_MASK RemainingDesiredAccess,
01012     IN OUT PACCESS_MASK PreviouslyGrantedAccess,
01013     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext OPTIONAL,
01014     IN PACCESS_TOKEN Token OPTIONAL,
01015     OUT PPRIVILEGE_SET *PrivilegeSet,
01016     IN KPROCESSOR_MODE PreviousMode
01017     );
01018 
01019 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01020 <a class="code" href="../../d0/d5/se_8h.html#a140">SeGenerateMessage</a> (
01021     IN PSTRING ObjectName,
01022     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01023     IN PACCESS_TOKEN Token,
01024     IN ACCESS_MASK DesiredAccess,
01025     IN BOOLEAN AccessGranted,
01026     IN HANDLE AuditPort,
01027     IN HANDLE AlarmPort,
01028     IN KPROCESSOR_MODE AccessMode
01029     );
01030 
01031 <span class="comment">// begin_ntifs</span>
01032 
01033 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01034 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01035 <a class="code" href="../../d3/d5/seaudit_8c.html#a23">SeOpenObjectAuditAlarm</a> (
01036     IN PUNICODE_STRING ObjectTypeName,
01037     IN PVOID Object OPTIONAL,
01038     IN PUNICODE_STRING AbsoluteObjectName OPTIONAL,
01039     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01040     IN PACCESS_STATE AccessState,
01041     IN BOOLEAN ObjectCreated,
01042     IN BOOLEAN AccessGranted,
01043     IN KPROCESSOR_MODE AccessMode,
01044     OUT PBOOLEAN GenerateOnClose
01045     );
01046 
01047 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01048 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01049 <a class="code" href="../../d3/d5/seaudit_8c.html#a24">SeOpenObjectForDeleteAuditAlarm</a> (
01050     IN PUNICODE_STRING ObjectTypeName,
01051     IN PVOID Object OPTIONAL,
01052     IN PUNICODE_STRING AbsoluteObjectName OPTIONAL,
01053     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01054     IN PACCESS_STATE AccessState,
01055     IN BOOLEAN ObjectCreated,
01056     IN BOOLEAN AccessGranted,
01057     IN KPROCESSOR_MODE AccessMode,
01058     OUT PBOOLEAN GenerateOnClose
01059     );
01060 
01061 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01062 <a class="code" href="../../d3/d5/seaudit_8c.html#a30">SeDeleteObjectAuditAlarm</a>(
01063     IN PVOID Object,
01064     IN HANDLE Handle
01065     );
01066 
01067 
01068 <span class="comment">// end_ntifs</span>
01069 
01070 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01071 <a class="code" href="../../d3/d5/seaudit_8c.html#a29">SeCloseObjectAuditAlarm</a>(
01072     IN PVOID Object,
01073     IN HANDLE Handle,
01074     IN BOOLEAN GenerateOnClose
01075     );
01076 
01077 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01078 <a class="code" href="../../d3/d5/seaudit_8c.html#a25">SeTraverseAuditAlarm</a>(
01079     IN PLUID OperationID,
01080     IN PVOID DirectoryObject,
01081     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01082     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01083     IN BOOLEAN SubjectContextLocked,
01084     IN ACCESS_MASK TraverseAccess,
01085     IN PPRIVILEGE_SET Privileges OPTIONAL,
01086     IN BOOLEAN AccessGranted,
01087     IN KPROCESSOR_MODE AccessMode
01088     );
01089 
01090 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01091 <a class="code" href="../../d0/d5/se_8h.html#a146">SeCreateInstanceAuditAlarm</a>(
01092     IN PLUID OperationID OPTIONAL,
01093     IN PVOID Object,
01094     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01095     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01096     IN ACCESS_MASK DesiredAccess,
01097     IN PPRIVILEGE_SET Privileges OPTIONAL,
01098     IN BOOLEAN AccessGranted,
01099     IN KPROCESSOR_MODE AccessMode
01100     );
01101 
01102 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01103 <a class="code" href="../../d3/d5/seaudit_8c.html#a26">SeCreateObjectAuditAlarm</a>(
01104     IN PLUID OperationID OPTIONAL,
01105     IN PVOID Object,
01106     IN PUNICODE_STRING ComponentName,
01107     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01108     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01109     IN ACCESS_MASK DesiredAccess,
01110     IN PPRIVILEGE_SET Privileges OPTIONAL,
01111     IN BOOLEAN AccessGranted,
01112     OUT PBOOLEAN AuditPerformed,
01113     IN KPROCESSOR_MODE AccessMode
01114     );
01115 
01116 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01117 <a class="code" href="../../d3/d5/seaudit_8c.html#a27">SeObjectReferenceAuditAlarm</a>(
01118     IN PLUID OperationID OPTIONAL,
01119     IN PVOID Object,
01120     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01121     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01122     IN ACCESS_MASK DesiredAccess,
01123     IN PPRIVILEGE_SET Privileges OPTIONAL,
01124     IN BOOLEAN AccessGranted,
01125     IN KPROCESSOR_MODE AccessMode
01126     );
01127 
01128 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01129 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01130 <a class="code" href="../../d3/d5/seaudit_8c.html#a13">SePrivilegeObjectAuditAlarm</a>(
01131     IN HANDLE Handle,
01132     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01133     IN ACCESS_MASK DesiredAccess,
01134     IN PPRIVILEGE_SET Privileges,
01135     IN BOOLEAN AccessGranted,
01136     IN KPROCESSOR_MODE AccessMode
01137     );
01138 
01139 BOOLEAN
01140 <a class="code" href="../../d8/d4/privileg_8c.html#a4">SeCheckPrivilegedObject</a>(
01141     LUID PrivilegeValue,
01142     HANDLE ObjectHandle,
01143     ACCESS_MASK DesiredAccess,
01144     KPROCESSOR_MODE PreviousMode
01145     );
01146 
01147 <span class="comment">// begin_ntddk begin_ntifs</span>
01148 
01149 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01150 BOOLEAN
01151 <a class="code" href="../../d2/d5/se_2capture_8c.html#a17">SeValidSecurityDescriptor</a>(
01152     IN ULONG Length,
01153     IN PSECURITY_DESCRIPTOR SecurityDescriptor
01154     );
01155 
01156 <span class="comment">// end_ntddk end_ntifs</span>
01157 
01158 
01159 
01160 <span class="comment">//VOID</span>
01161 <span class="comment">//SeImplicitObjectAuditAlarm(</span>
01162 <span class="comment">//    IN PLUID OperationID OPTIONAL,</span>
01163 <span class="comment">//    IN PVOID Object,</span>
01164 <span class="comment">//    IN PSECURITY_DESCRIPTOR SecurityDescriptor,</span>
01165 <span class="comment">//    IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,</span>
01166 <span class="comment">//    IN ACCESS_MASK DesiredAccess,</span>
01167 <span class="comment">//    IN PPRIVILEGE_SET Privileges OPTIONAL,</span>
01168 <span class="comment">//    IN BOOLEAN AccessGranted,</span>
01169 <span class="comment">//    IN KPROCESSOR_MODE AccessMode</span>
01170 <span class="comment">//    );</span>
01171 <span class="comment">//</span>
01172 
01173 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01174 <a class="code" href="../../d3/d5/seaudit_8c.html#a28">SeAuditHandleCreation</a>(
01175     IN PACCESS_STATE AccessState,
01176     IN HANDLE Handle
01177     );
01178 
01179 
01180 
01181 PACCESS_TOKEN
01182 <a class="code" href="../../d0/d5/se_8h.html#a153">SeMakeSystemToken</a> ();
01183 
01184 PACCESS_TOKEN
01185 <a class="code" href="../../d0/d5/se_8h.html#a154">SeMakeAnonymousLogonToken</a> ();
01186 
01187 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01188 <a class="code" href="../../d4/d3/token_8c.html#a10">SeGetTokenControlInformation</a> (
01189     IN PACCESS_TOKEN Token,
01190     OUT PTOKEN_CONTROL TokenControl
01191     );
01192 
01193 <span class="comment">//++</span>
01194 <span class="comment">//</span>
01195 <span class="comment">// PVOID</span>
01196 <span class="comment">// SeTokenObjectType()</span>
01197 <span class="comment">//</span>
01198 <span class="comment">// Routine Description:</span>
01199 <span class="comment">//</span>
01200 <span class="comment">//    This function returns a pointer to the Token object type structure.</span>
01201 <span class="comment">//</span>
01202 <span class="comment">// Arguments:</span>
01203 <span class="comment">//</span>
01204 <span class="comment">//    None.</span>
01205 <span class="comment">//</span>
01206 <span class="comment">// Return Value:</span>
01207 <span class="comment">//</span>
01208 <span class="comment">//    Pointer to the token object type structure.</span>
01209 <span class="comment">//</span>
01210 <span class="comment">//--</span>
01211 
<a name="l01212"></a><a class="code" href="../../d0/d5/se_8h.html#a36">01212</a> <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">_OBJECT_TYPE</a> *<a class="code" href="../../d0/d5/se_8h.html#a36">SepTokenObjectType</a>;
<a name="l01213"></a><a class="code" href="../../d0/d5/se_8h.html#a17">01213</a> <span class="preprocessor">#define SeTokenObjectType() (PVOID)SepTokenObjectType</span>
01214 <span class="preprocessor"></span>
01215 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                     <span class="comment">// ntifs</span>
01216 TOKEN_TYPE                                      <span class="comment">// ntifs</span>
01217 <a class="code" href="../../d4/d3/token_8c.html#a3">SeTokenType</a>(                                    <span class="comment">// ntifs</span>
01218     IN PACCESS_TOKEN Token                      <span class="comment">// ntifs</span>
01219     );                                          <span class="comment">// ntifs</span>
01220 
01221 SECURITY_IMPERSONATION_LEVEL
01222 <a class="code" href="../../d4/d3/token_8c.html#a6">SeTokenImpersonationLevel</a>(
01223     IN PACCESS_TOKEN Token
01224     );
01225 
01226 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                     <span class="comment">// ntifs</span>
01227 BOOLEAN                                         <span class="comment">// ntifs</span>
01228 <a class="code" href="../../d4/d3/token_8c.html#a4">SeTokenIsAdmin</a>(                                 <span class="comment">// ntifs</span>
01229     IN PACCESS_TOKEN Token                      <span class="comment">// ntifs</span>
01230     );                                          <span class="comment">// ntifs</span>
01231 
01232 
01233 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                     <span class="comment">// ntifs</span>
01234 BOOLEAN                                         <span class="comment">// ntifs</span>
01235 <a class="code" href="../../d4/d3/token_8c.html#a5">SeTokenIsRestricted</a>(                            <span class="comment">// ntifs</span>
01236     IN PACCESS_TOKEN Token                      <span class="comment">// ntifs</span>
01237     );                                          <span class="comment">// ntifs</span>
01238 
01239 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01240 <a class="code" href="../../d4/d3/token_8c.html#a13">SeSubProcessToken</a> (
01241     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ParentProcess,
01242     OUT PACCESS_TOKEN *ChildToken
01243     );
01244 
01245 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01246 <a class="code" href="../../d4/d3/token_8c.html#a7">SeAssignPrimaryToken</a>(
01247     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
01248     IN PACCESS_TOKEN Token
01249     );
01250 
01251 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01252 <a class="code" href="../../d4/d3/token_8c.html#a8">SeDeassignPrimaryToken</a>(
01253     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
01254     );
01255 
01256 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01257 <a class="code" href="../../d4/d3/token_8c.html#a9">SeExchangePrimaryToken</a>(
01258     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
01259     IN PACCESS_TOKEN NewAccessToken,
01260     OUT PACCESS_TOKEN *OldAccessToken
01261     );
01262 
01263 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01264 <a class="code" href="../../d6/d3/tokendup_8c.html#a6">SeCopyClientToken</a>(
01265     IN PACCESS_TOKEN ClientToken,
01266     IN SECURITY_IMPERSONATION_LEVEL ImpersonationLevel,
01267     IN KPROCESSOR_MODE RequestorMode,
01268     OUT PACCESS_TOKEN *DuplicateToken
01269     );
01270 
01271 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01272 <a class="code" href="../../d6/d3/tokendup_8c.html#a8">SeFilterToken</a> (
01273     IN PACCESS_TOKEN ExistingToken,
01274     IN ULONG Flags,
01275     IN PTOKEN_GROUPS SidsToDisable OPTIONAL,
01276     IN PTOKEN_PRIVILEGES PrivilegesToDelete OPTIONAL,
01277     IN PTOKEN_GROUPS RestrictedSids OPTIONAL,
01278     OUT PACCESS_TOKEN * FilteredToken
01279     );
01280 
01281 
01282 <span class="comment">// begin_ntifs</span>
01283 
01284 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01285 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01286 <a class="code" href="../../d9/d3/tokenqry_8c.html#a1">SeQueryAuthenticationIdToken</a>(
01287     IN PACCESS_TOKEN Token,
01288     OUT PLUID AuthenticationId
01289     );
01290 
01291 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01292 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01293 <a class="code" href="../../d9/d3/tokenqry_8c.html#a3">SeQuerySessionIdToken</a>(
01294     IN PACCESS_TOKEN,
01295     IN PULONG pSessionId
01296     );
01297 
01298 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01299 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01300 <a class="code" href="../../d0/d4/tokenset_8c.html#a5">SeSetSessionIdToken</a>(
01301     IN PACCESS_TOKEN,
01302     IN ULONG SessionId
01303     );
01304 
01305 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01306 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01307 <a class="code" href="../../d4/d5/seclient_8c.html#a1">SeCreateClientSecurity</a> (
01308     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> ClientThread,
01309     IN PSECURITY_QUALITY_OF_SERVICE ClientSecurityQos,
01310     IN BOOLEAN RemoteSession,
01311     OUT <a class="code" href="../../d8/d0/struct__SECURITY__CLIENT__CONTEXT.html">PSECURITY_CLIENT_CONTEXT</a> ClientContext
01312     );
01313 
01314 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01315 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01316 <a class="code" href="../../d4/d5/seclient_8c.html#a2">SeImpersonateClient</a>(
01317     IN <a class="code" href="../../d8/d0/struct__SECURITY__CLIENT__CONTEXT.html">PSECURITY_CLIENT_CONTEXT</a> ClientContext,
01318     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> ServerThread OPTIONAL
01319     );
01320 
01321 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01322 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01323 <a class="code" href="../../d4/d5/seclient_8c.html#a3">SeImpersonateClientEx</a>(
01324     IN <a class="code" href="../../d8/d0/struct__SECURITY__CLIENT__CONTEXT.html">PSECURITY_CLIENT_CONTEXT</a> ClientContext,
01325     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> ServerThread OPTIONAL
01326     );
01327 
01328 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01329 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01330 <a class="code" href="../../d4/d5/seclient_8c.html#a4">SeCreateClientSecurityFromSubjectContext</a> (
01331     IN PSECURITY_SUBJECT_CONTEXT SubjectContext,
01332     IN PSECURITY_QUALITY_OF_SERVICE ClientSecurityQos,
01333     IN BOOLEAN ServerIsRemote,
01334     OUT <a class="code" href="../../d8/d0/struct__SECURITY__CLIENT__CONTEXT.html">PSECURITY_CLIENT_CONTEXT</a> ClientContext
01335     );
01336 
01337 <span class="comment">// end_ntifs</span>
01338 
01339 <span class="comment">//</span>
01340 <span class="comment">// Do not export the following routines to drivers.</span>
01341 <span class="comment">// If you need to do so, create a new routine that</span>
01342 <span class="comment">// does not take the AuxData parameter and export</span>
01343 <span class="comment">// that.</span>
01344 <span class="comment">//</span>
01345 
01346 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01347 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01348 <a class="code" href="../../d2/d5/seastate_8c.html#a2">SeCreateAccessState</a>(
01349    IN PACCESS_STATE AccessState,
01350    IN PAUX_ACCESS_DATA AuxData,
01351    IN ACCESS_MASK DesiredAccess,
01352    IN PGENERIC_MAPPING GenericMapping
01353    );
01354 
01355 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01356 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01357 <a class="code" href="../../d2/d5/seastate_8c.html#a3">SeDeleteAccessState</a>(
01358     IN PACCESS_STATE AccessState
01359     );
01360 
01361 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01362 <a class="code" href="../../d0/d5/se_8h.html#a175">SeUpdateClientSecurity</a>(
01363     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> ClientThread,
01364     IN OUT <a class="code" href="../../d8/d0/struct__SECURITY__CLIENT__CONTEXT.html">PSECURITY_CLIENT_CONTEXT</a> ClientContext,
01365     OUT PBOOLEAN ChangesMade,
01366     OUT PBOOLEAN NewToken
01367     );
01368 
01369 BOOLEAN
01370 <a class="code" href="../../d0/d5/se_8h.html#a176">SeRmInitPhase1</a>(
01371     );
01372 
01373 <span class="comment">// begin_ntifs</span>
01374 
01375 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01376 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01377 <a class="code" href="../../d0/d6/semethod_8c.html#a6">SeQuerySecurityDescriptorInfo</a> (
01378     IN PSECURITY_INFORMATION SecurityInformation,
01379     OUT PSECURITY_DESCRIPTOR SecurityDescriptor,
01380     IN OUT PULONG Length,
01381     IN PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor
01382     );
01383 
01384 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01385 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01386 <a class="code" href="../../d0/d6/semethod_8c.html#a4">SeSetSecurityDescriptorInfo</a> (
01387     IN PVOID Object OPTIONAL,
01388     IN PSECURITY_INFORMATION SecurityInformation,
01389     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01390     IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor,
01391     IN POOL_TYPE PoolType,
01392     IN PGENERIC_MAPPING GenericMapping
01393     );
01394 
01395 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01396 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01397 <a class="code" href="../../d0/d6/semethod_8c.html#a5">SeSetSecurityDescriptorInfoEx</a> (
01398     IN PVOID Object OPTIONAL,
01399     IN PSECURITY_INFORMATION SecurityInformation,
01400     IN PSECURITY_DESCRIPTOR ModificationDescriptor,
01401     IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor,
01402     IN ULONG AutoInheritFlags,
01403     IN POOL_TYPE PoolType,
01404     IN PGENERIC_MAPPING GenericMapping
01405     );
01406 
01407 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01408 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01409 <a class="code" href="../../d2/d5/seastate_8c.html#a5">SeAppendPrivileges</a>(
01410     PACCESS_STATE AccessState,
01411     PPRIVILEGE_SET Privileges
01412     );
01413 
01414 <span class="comment">// end_ntifs</span>
01415 
01416 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01417 <a class="code" href="../../d2/d5/se_2capture_8c.html#a16">SeComputeQuotaInformationSize</a>(
01418     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01419     OUT PULONG Size
01420     );
01421 
01422 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01423 <a class="code" href="../../d3/d5/seaudit_8c.html#a15">SePrivilegedServiceAuditAlarm</a> (
01424     IN PUNICODE_STRING ServiceName,
01425     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01426     IN PPRIVILEGE_SET Privileges,
01427     IN BOOLEAN AccessGranted
01428     );
01429 
01430 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntddk ntifs</span>
01431 BOOLEAN                                                         <span class="comment">// ntddk ntifs</span>
01432 <a class="code" href="../../d8/d4/privileg_8c.html#a3">SeSinglePrivilegeCheck</a>(                                         <span class="comment">// ntddk ntifs</span>
01433     LUID PrivilegeValue,                                        <span class="comment">// ntddk ntifs</span>
01434     KPROCESSOR_MODE PreviousMode                                <span class="comment">// ntddk ntifs</span>
01435     );                                                          <span class="comment">// ntddk ntifs</span>
01436 
01437 BOOLEAN
01438 <a class="code" href="../../d3/d5/seaudit_8c.html#a11">SeCheckAuditPrivilege</a> (
01439    IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,
01440    IN KPROCESSOR_MODE PreviousMode
01441    );
01442 
01443 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01444 <a class="code" href="../../d1/d5/seassign_8c.html#a5">SeAssignWorldSecurityDescriptor</a>(
01445     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
01446     IN OUT PULONG Length,
01447     IN PSECURITY_INFORMATION SecurityInformation
01448     );
01449 
01450 BOOLEAN
01451 <a class="code" href="../../d0/d4/accessck_8c.html#a22">SeFastTraverseCheck</a>(
01452     PSECURITY_DESCRIPTOR SecurityDescriptor,
01453     ACCESS_MASK TraverseAccess,
01454     KPROCESSOR_MODE AccessMode
01455     );
01456 
01457 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
01458 BOOLEAN                                                         <span class="comment">// ntifs</span>
01459 <a class="code" href="../../d3/d5/seaudit_8c.html#a36">SeAuditingFileEvents</a>(                                           <span class="comment">// ntifs</span>
01460     IN BOOLEAN AccessGranted,                                   <span class="comment">// ntifs</span>
01461     IN PSECURITY_DESCRIPTOR SecurityDescriptor                  <span class="comment">// ntifs</span>
01462     );                                                          <span class="comment">// ntifs</span>
01463 
01464 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
01465 BOOLEAN                                                         <span class="comment">// ntifs</span>
01466 <a class="code" href="../../d3/d5/seaudit_8c.html#a35">SeAuditingFileOrGlobalEvents</a>(                                   <span class="comment">// ntifs</span>
01467     IN BOOLEAN AccessGranted,                                   <span class="comment">// ntifs</span>
01468     IN PSECURITY_DESCRIPTOR SecurityDescriptor,                 <span class="comment">// ntifs</span>
01469     IN PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext         <span class="comment">// ntifs</span>
01470     );                                                          <span class="comment">// ntifs</span>
01471 
01472 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01473 <a class="code" href="../../d7/d6/sepaudit_8c.html#a19">SeAuditProcessCreation</a>(
01474     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
01475     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Parent,
01476     PUNICODE_STRING ImageFileName
01477     );
01478 
01479 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01480 <a class="code" href="../../d7/d6/sepaudit_8c.html#a21">SeAuditProcessExit</a>(
01481     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
01482     );
01483 
01484 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01485 <a class="code" href="../../d7/d6/sepaudit_8c.html#a20">SeAuditHandleDuplication</a>(
01486     PVOID SourceHandle,
01487     PVOID NewHandle,
01488     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> SourceProcess,
01489     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> TargetProcess
01490     );
01491 
01492 <span class="comment">// begin_ntifs</span>
01493 
01494 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
01495 <a class="code" href="../../d2/d5/seastate_8c.html#a4">SeSetAccessStateGenericMapping</a> (
01496     PACCESS_STATE AccessState,
01497     PGENERIC_MAPPING GenericMapping
01498     );
01499 
01500 <span class="comment">// end_ntifs</span>
01501 
01502 <span class="comment">// begin_ntifs</span>
01503 
01504 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01505 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01506 <a class="code" href="../../d9/d9/rmlogon_8c.html#a14">SeRegisterLogonSessionTerminatedRoutine</a>(
01507     IN PSE_LOGON_SESSION_TERMINATED_ROUTINE CallbackRoutine
01508     );
01509 
01510 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01511 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01512 <a class="code" href="../../d9/d9/rmlogon_8c.html#a15">SeUnregisterLogonSessionTerminatedRoutine</a>(
01513     IN PSE_LOGON_SESSION_TERMINATED_ROUTINE CallbackRoutine
01514     );
01515 
01516 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01517 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01518 <a class="code" href="../../d9/d9/rmlogon_8c.html#a16">SeMarkLogonSessionForTerminationNotification</a>(
01519     IN PLUID LogonId
01520     );
01521 
01522 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
01523 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01524 <a class="code" href="../../d9/d3/tokenqry_8c.html#a2">SeQueryInformationToken</a> (
01525     IN PACCESS_TOKEN Token,
01526     IN TOKEN_INFORMATION_CLASS TokenInformationClass,
01527     OUT PVOID *TokenInformation
01528     );
01529 
01530 
01531 <span class="comment">// end_ntifs</span>
01532 
01533 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01534 <a class="code" href="../../d4/d3/token_8c.html#a19">SeIsChildToken</a>(
01535     IN HANDLE Token,
01536     OUT PBOOLEAN IsChild
01537     );
01538 
01539 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01540 <a class="code" href="../../d4/d3/token_8c.html#a20">SeIsChildTokenByPointer</a>(
01541     IN PACCESS_TOKEN Token,
01542     OUT PBOOLEAN IsChild
01543     );
01544 
01545 
01546 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
01547 <a class="code" href="../../d6/d3/tokendup_8c.html#a9">SeFastFilterToken</a>(
01548     IN PACCESS_TOKEN ExistingToken,
01549     IN KPROCESSOR_MODE RequestorMode,
01550     IN ULONG Flags,
01551     IN ULONG GroupCount,
01552     IN PSID_AND_ATTRIBUTES GroupsToDisable OPTIONAL,
01553     IN ULONG PrivilegeCount,
01554     IN PLUID_AND_ATTRIBUTES PrivilegesToDelete OPTIONAL,
01555     IN ULONG SidCount,
01556     IN PSID_AND_ATTRIBUTES RestrictedSids OPTIONAL,
01557     IN ULONG SidLength,
01558     OUT PACCESS_TOKEN * FilteredToken
01559     );
01560 
01562 <span class="comment">//                                                                    //</span>
01563 <span class="comment">//           Global, READ ONLY, Security variables                    //</span>
01564 <span class="comment">//                                                                    //</span>
01566 <span class="comment"></span>
01567 
01568 <span class="comment">// begin_ntifs</span>
01569 <span class="comment">// **************************************************************</span>
01570 <span class="comment">//</span>
01571 <span class="comment">//              C A V E A T      P R O G R A M M E R</span>
01572 <span class="comment">//</span>
01573 <span class="comment">//</span>
01574 <span class="comment">//  If you wish to include this file in an NT driver and use SeExports structure</span>
01575 <span class="comment">//  defined above, you need to call:</span>
01576 <span class="comment">//</span>
01577 <span class="comment">//</span>
01578 <span class="comment">//      SeEnableAccessToExports()</span>
01579 <span class="comment">//</span>
01580 <span class="comment">//  exactly once during initialization.</span>
01581 <span class="comment">//</span>
01582 <span class="comment">//              C A V E A T      P R O G R A M M E R</span>
01583 <span class="comment">//</span>
01584 <span class="comment">// **************************************************************</span>
01585 <span class="preprocessor">#if 0</span>
01586 <span class="preprocessor"></span><span class="preprocessor">#define SeEnableAccessToExports() SeExports = *(PSE_EXPORTS *)SeExports;</span>
01587 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="../../d0/d5/se_8h.html#a34">PSE_EXPORTS</a> <a class="code" href="../../d0/d5/se_8h.html#a37">SeExports</a>;                       <span class="comment">// ntifs</span>
01588 <span class="preprocessor">#else</span>
<a name="l01589"></a><a class="code" href="../../d0/d5/se_8h.html#a18">01589</a> <span class="preprocessor"></span><span class="preprocessor">#define SeEnableAccessToExports()</span>
<a name="l01590"></a><a class="code" href="../../d0/d5/se_8h.html#a37">01590</a> <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a> <a class="code" href="../../d0/d5/se_8h.html#a34">PSE_EXPORTS</a> <a class="code" href="../../d0/d5/se_8h.html#a37">SeExports</a>;
01591 <span class="preprocessor">#endif</span>
01592 <span class="preprocessor"></span>
01593 <span class="comment">// end_ntifs</span>
01594 
01595 <span class="comment">//</span>
01596 <span class="comment">// Value used to represent the authentication ID of system processes</span>
01597 <span class="comment">//</span>
01598 
<a name="l01599"></a><a class="code" href="../../d0/d5/se_8h.html#a38">01599</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a38">SeSystemAuthenticationId</a>;
<a name="l01600"></a><a class="code" href="../../d0/d5/se_8h.html#a39">01600</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a39">SeAnonymousAuthenticationId</a>;
01601 
<a name="l01602"></a><a class="code" href="../../d0/d5/se_8h.html#a40">01602</a> <span class="keyword">extern</span> TOKEN_SOURCE <a class="code" href="../../d0/d5/se_8h.html#a40">SeSystemTokenSource</a>;
01603 
01604 <span class="comment">//</span>
01605 <span class="comment">// Universal well known SIDs</span>
01606 <span class="comment">//</span>
01607 
<a name="l01608"></a><a class="code" href="../../d0/d5/se_8h.html#a41">01608</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a41">SeNullSid</a>;
<a name="l01609"></a><a class="code" href="../../d0/d5/se_8h.html#a42">01609</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a42">SeWorldSid</a>;
<a name="l01610"></a><a class="code" href="../../d0/d5/se_8h.html#a43">01610</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a43">SeLocalSid</a>;
<a name="l01611"></a><a class="code" href="../../d0/d5/se_8h.html#a44">01611</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a44">SeCreatorOwnerSid</a>;
<a name="l01612"></a><a class="code" href="../../d0/d5/se_8h.html#a45">01612</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a45">SeCreatorGroupSid</a>;
<a name="l01613"></a><a class="code" href="../../d0/d5/se_8h.html#a46">01613</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a46">SeCreatorOwnerServerSid</a>;
<a name="l01614"></a><a class="code" href="../../d0/d5/se_8h.html#a47">01614</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a47">SeCreatorGroupServerSid</a>;
<a name="l01615"></a><a class="code" href="../../d0/d5/se_8h.html#a48">01615</a> <span class="keyword">extern</span> PSID  <a class="code" href="../../d0/d5/se_8h.html#a48">SePrincipalSelfSid</a>;
01616 
01617 
01618 <span class="comment">//</span>
01619 <span class="comment">// Sids defined by NT</span>
01620 <span class="comment">//</span>
01621 
<a name="l01622"></a><a class="code" href="../../d0/d5/se_8h.html#a49">01622</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a49">SeNtAuthoritySid</a>;
01623 
<a name="l01624"></a><a class="code" href="../../d0/d5/se_8h.html#a50">01624</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a50">SeDialupSid</a>;
<a name="l01625"></a><a class="code" href="../../d0/d5/se_8h.html#a51">01625</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a51">SeNetworkSid</a>;
<a name="l01626"></a><a class="code" href="../../d0/d5/se_8h.html#a52">01626</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a52">SeBatchSid</a>;
<a name="l01627"></a><a class="code" href="../../d0/d5/se_8h.html#a53">01627</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a53">SeInteractiveSid</a>;
<a name="l01628"></a><a class="code" href="../../d0/d5/se_8h.html#a54">01628</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a54">SeLocalSystemSid</a>;
<a name="l01629"></a><a class="code" href="../../d0/d5/se_8h.html#a55">01629</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a55">SeAuthenticatedUsersSid</a>;
<a name="l01630"></a><a class="code" href="../../d0/d5/se_8h.html#a56">01630</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a56">SeAliasAdminsSid</a>;
<a name="l01631"></a><a class="code" href="../../d0/d5/se_8h.html#a57">01631</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a57">SeRestrictedSid</a>;
<a name="l01632"></a><a class="code" href="../../d0/d5/se_8h.html#a58">01632</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a58">SeAnonymousLogonSid</a>;
<a name="l01633"></a><a class="code" href="../../d0/d5/se_8h.html#a59">01633</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a59">SeAliasUsersSid</a>;
<a name="l01634"></a><a class="code" href="../../d0/d5/se_8h.html#a60">01634</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a60">SeAliasGuestsSid</a>;
<a name="l01635"></a><a class="code" href="../../d0/d5/se_8h.html#a61">01635</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a61">SeAliasPowerUsersSid</a>;
<a name="l01636"></a><a class="code" href="../../d0/d5/se_8h.html#a62">01636</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a62">SeAliasAccountOpsSid</a>;
<a name="l01637"></a><a class="code" href="../../d0/d5/se_8h.html#a63">01637</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a63">SeAliasSystemOpsSid</a>;
<a name="l01638"></a><a class="code" href="../../d0/d5/se_8h.html#a64">01638</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a64">SeAliasPrintOpsSid</a>;
<a name="l01639"></a><a class="code" href="../../d0/d5/se_8h.html#a65">01639</a> <span class="keyword">extern</span> PSID <a class="code" href="../../d0/d5/se_8h.html#a65">SeAliasBackupOpsSid</a>;
01640 
01641 <span class="comment">//</span>
01642 <span class="comment">// Well known tokens</span>
01643 <span class="comment">//</span>
01644 
<a name="l01645"></a><a class="code" href="../../d0/d5/se_8h.html#a66">01645</a> <span class="keyword">extern</span> PACCESS_TOKEN <a class="code" href="../../d0/d5/se_8h.html#a66">SeAnonymousLogonToken</a>;
01646 
01647 <span class="comment">//</span>
01648 <span class="comment">// System default DACLs &amp; Security Descriptors</span>
01649 <span class="comment">//</span>
01650 
<a name="l01651"></a><a class="code" href="../../d0/d5/se_8h.html#a67">01651</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a67">SePublicDefaultSd</a>;
<a name="l01652"></a><a class="code" href="../../d0/d5/se_8h.html#a68">01652</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a68">SePublicDefaultUnrestrictedSd</a>;
<a name="l01653"></a><a class="code" href="../../d0/d5/se_8h.html#a69">01653</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a69">SePublicOpenSd</a>;
<a name="l01654"></a><a class="code" href="../../d0/d5/se_8h.html#a70">01654</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a70">SePublicOpenUnrestrictedSd</a>;
<a name="l01655"></a><a class="code" href="../../d0/d5/se_8h.html#a71">01655</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a71">SeSystemDefaultSd</a>;
<a name="l01656"></a><a class="code" href="../../d0/d5/se_8h.html#a72">01656</a> <span class="keyword">extern</span> PSECURITY_DESCRIPTOR <a class="code" href="../../d0/d5/se_8h.html#a72">SeUnrestrictedSd</a>;
01657 
<a name="l01658"></a><a class="code" href="../../d0/d5/se_8h.html#a73">01658</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a73">SePublicDefaultDacl</a>;
<a name="l01659"></a><a class="code" href="../../d0/d5/se_8h.html#a74">01659</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a74">SePublicDefaultUnrestrictedDacl</a>;
<a name="l01660"></a><a class="code" href="../../d0/d5/se_8h.html#a75">01660</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a75">SePublicOpenDacl</a>;
<a name="l01661"></a><a class="code" href="../../d0/d5/se_8h.html#a76">01661</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a76">SePublicOpenUnrestrictedDacl</a>;
<a name="l01662"></a><a class="code" href="../../d0/d5/se_8h.html#a77">01662</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a77">SeSystemDefaultDacl</a>;
<a name="l01663"></a><a class="code" href="../../d0/d5/se_8h.html#a78">01663</a> <span class="keyword">extern</span> PACL <a class="code" href="../../d0/d5/se_8h.html#a78">SeUnrestrictedDacl</a>;
01664 
01665 <span class="comment">//</span>
01666 <span class="comment">//  Well known privilege values</span>
01667 <span class="comment">//</span>
01668 
01669 
<a name="l01670"></a><a class="code" href="../../d0/d5/se_8h.html#a79">01670</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a79">SeCreateTokenPrivilege</a>;
<a name="l01671"></a><a class="code" href="../../d0/d5/se_8h.html#a80">01671</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a80">SeAssignPrimaryTokenPrivilege</a>;
<a name="l01672"></a><a class="code" href="../../d0/d5/se_8h.html#a81">01672</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a81">SeLockMemoryPrivilege</a>;
<a name="l01673"></a><a class="code" href="../../d0/d5/se_8h.html#a82">01673</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a82">SeIncreaseQuotaPrivilege</a>;
<a name="l01674"></a><a class="code" href="../../d0/d5/se_8h.html#a83">01674</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a83">SeUnsolicitedInputPrivilege</a>;
<a name="l01675"></a><a class="code" href="../../d0/d5/se_8h.html#a84">01675</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a84">SeTcbPrivilege</a>;
<a name="l01676"></a><a class="code" href="../../d0/d5/se_8h.html#a85">01676</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a85">SeSecurityPrivilege</a>;
<a name="l01677"></a><a class="code" href="../../d0/d5/se_8h.html#a86">01677</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a86">SeTakeOwnershipPrivilege</a>;
<a name="l01678"></a><a class="code" href="../../d0/d5/se_8h.html#a87">01678</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a87">SeLoadDriverPrivilege</a>;
<a name="l01679"></a><a class="code" href="../../d0/d5/se_8h.html#a88">01679</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a88">SeCreatePagefilePrivilege</a>;
<a name="l01680"></a><a class="code" href="../../d0/d5/se_8h.html#a89">01680</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a89">SeIncreaseBasePriorityPrivilege</a>;
<a name="l01681"></a><a class="code" href="../../d0/d5/se_8h.html#a90">01681</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a90">SeSystemProfilePrivilege</a>;
<a name="l01682"></a><a class="code" href="../../d0/d5/se_8h.html#a91">01682</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a91">SeSystemtimePrivilege</a>;
<a name="l01683"></a><a class="code" href="../../d0/d5/se_8h.html#a92">01683</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a92">SeProfileSingleProcessPrivilege</a>;
<a name="l01684"></a><a class="code" href="../../d0/d5/se_8h.html#a93">01684</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a93">SeCreatePermanentPrivilege</a>;
<a name="l01685"></a><a class="code" href="../../d0/d5/se_8h.html#a94">01685</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a94">SeBackupPrivilege</a>;
<a name="l01686"></a><a class="code" href="../../d0/d5/se_8h.html#a95">01686</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a95">SeRestorePrivilege</a>;
<a name="l01687"></a><a class="code" href="../../d0/d5/se_8h.html#a96">01687</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a96">SeShutdownPrivilege</a>;
<a name="l01688"></a><a class="code" href="../../d0/d5/se_8h.html#a97">01688</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a97">SeDebugPrivilege</a>;
<a name="l01689"></a><a class="code" href="../../d0/d5/se_8h.html#a98">01689</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a98">SeAuditPrivilege</a>;
<a name="l01690"></a><a class="code" href="../../d0/d5/se_8h.html#a99">01690</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a99">SeSystemEnvironmentPrivilege</a>;
<a name="l01691"></a><a class="code" href="../../d0/d5/se_8h.html#a100">01691</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a100">SeChangeNotifyPrivilege</a>;
<a name="l01692"></a><a class="code" href="../../d0/d5/se_8h.html#a101">01692</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a101">SeRemoteShutdownPrivilege</a>;
<a name="l01693"></a><a class="code" href="../../d0/d5/se_8h.html#a102">01693</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a102">SeUndockPrivilege</a>;
<a name="l01694"></a><a class="code" href="../../d0/d5/se_8h.html#a103">01694</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a103">SeSyncAgentPrivilege</a>;
<a name="l01695"></a><a class="code" href="../../d0/d5/se_8h.html#a104">01695</a> <span class="keyword">extern</span> LUID <a class="code" href="../../d0/d5/se_8h.html#a104">SeEnableDelegationPrivilege</a>;
01696 
01697 
01698 <span class="comment">//</span>
01699 <span class="comment">// Auditing information array</span>
01700 <span class="comment">//</span>
01701 
<a name="l01702"></a><a class="code" href="../../d0/d5/se_8h.html#a105">01702</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d0/struct__SE__AUDITING__STATE.html">SE_AUDITING_STATE</a> <a class="code" href="../../d0/d5/se_8h.html#a105">SeAuditingState</a>[];
01703 
01704 <span class="comment">//</span>
01705 <span class="comment">// Flag so that other components may quickly check for</span>
01706 <span class="comment">// auditing.</span>
01707 <span class="comment">//</span>
01708 
<a name="l01709"></a><a class="code" href="../../d0/d5/se_8h.html#a106">01709</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d0/d5/se_8h.html#a106">SeDetailedAuditing</a>;
01710 
<a name="l01711"></a><a class="code" href="../../d0/d5/se_8h.html#a107">01711</a> <span class="keyword">extern</span> UNICODE_STRING <a class="code" href="../../d0/d5/se_8h.html#a107">SeSubsystemName</a>;
01712 
01713 
01714 <span class="preprocessor">#endif // _SE_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:43 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
