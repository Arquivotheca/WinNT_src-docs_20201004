<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: debug.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>debug.c</h1><a href="../../d0/d5/rtl_2debug_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//      TITLE("Debug Support Functions")</span>
00002 <span class="comment">//++</span>
00003 <span class="comment">//</span>
00004 <span class="comment">// Copyright (c) 1990  Microsoft Corporation</span>
00005 <span class="comment">//</span>
00006 <span class="comment">// Module Name:</span>
00007 <span class="comment">//</span>
00008 <span class="comment">//    debug.c</span>
00009 <span class="comment">//</span>
00010 <span class="comment">// Abstract:</span>
00011 <span class="comment">//</span>
00012 <span class="comment">//    This module implements functions to support debugging NT.  They call</span>
00013 <span class="comment">//    architecture specific routines to do the actual work.</span>
00014 <span class="comment">//</span>
00015 <span class="comment">// Author:</span>
00016 <span class="comment">//</span>
00017 <span class="comment">//    Steven R. Wood (stevewo) 8-Nov-1994</span>
00018 <span class="comment">//</span>
00019 <span class="comment">// Environment:</span>
00020 <span class="comment">//</span>
00021 <span class="comment">//    Any mode.</span>
00022 <span class="comment">//</span>
00023 <span class="comment">// Revision History:</span>
00024 <span class="comment">//</span>
00025 <span class="comment">//--</span>
00026 
00027 <span class="preprocessor">#include "stdarg.h"</span>
00028 <span class="preprocessor">#include "stdio.h"</span>
00029 <span class="preprocessor">#include "<a class="code" href="../../d5/d9/ntrtlp_8h.html">ntrtlp.h</a>"</span>
<a name="l00030"></a><a class="code" href="../../d0/d5/rtl_2debug_8c.html#a0">00030</a> <span class="preprocessor">#define NOEXTAPI</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#include "wdbgexts.h"</span>
00032 <span class="preprocessor">#include &lt;ntdbg.h&gt;</span>
00033 
00034 
00035 ULONG
<a name="l00036"></a><a class="code" href="../../d0/d5/rtl_2debug_8c.html#a1">00036</a> <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(
00037     PCHAR Format,
00038     ...
00039     )
00040 
00041 <span class="comment">//++</span>
00042 <span class="comment">//</span>
00043 <span class="comment">// Routine Description:</span>
00044 <span class="comment">//</span>
00045 <span class="comment">//    This routine provides a "printf" style capability for the kernel</span>
00046 <span class="comment">//    debugger.</span>
00047 <span class="comment">//</span>
00048 <span class="comment">//    Note:  control-C is consumed by the debugger and returned to</span>
00049 <span class="comment">//    this routine as status.  If status indicates control-C was</span>
00050 <span class="comment">//    pressed, this routine breakpoints.</span>
00051 <span class="comment">//</span>
00052 <span class="comment">// Arguments:</span>
00053 <span class="comment">//</span>
00054 <span class="comment">//    Format     - printf style format string</span>
00055 <span class="comment">//    ...        - additional arguments consumed according to the</span>
00056 <span class="comment">//                 format string.</span>
00057 <span class="comment">//</span>
00058 <span class="comment">// Return Value:</span>
00059 <span class="comment">//</span>
00060 <span class="comment">//    Defined as returning a ULONG, actually returns status.</span>
00061 <span class="comment">//</span>
00062 <span class="comment">//--</span>
00063 
00064 {
00065     va_list arglist;
00066     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[512];
00067     <span class="keywordtype">int</span> cb;
00068     STRING Output;
00069     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00070 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00071 <span class="preprocessor"></span>
00072     <span class="keywordflow">if</span> (NtCurrentTeb()-&gt;InDbgPrint) {
00073         <span class="keywordflow">return</span> STATUS_SUCCESS;
00074     }
00075     NtCurrentTeb()-&gt;InDbgPrint = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00076 <span class="preprocessor">#endif</span>
00077 <span class="preprocessor"></span>
00078     <span class="comment">//</span>
00079     <span class="comment">// Format the output into a buffer and then print it.</span>
00080     <span class="comment">//</span>
00081 
00082     va_start(arglist, Format);
00083 
00084 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME)</span>
00085 <span class="preprocessor"></span>    __try {
00086         cb = _vsnprintf(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>), Format, arglist);
00087     } __except (<a class="code" href="../../d6/d7/halmips_8h.html#a33">EXCEPTION_EXECUTE_HANDLER</a>) {
00088         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = GetExceptionCode();
00089     }
00090 <span class="preprocessor">#else</span>
00091 <span class="preprocessor"></span>    cb = _vsnprintf(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>), Format, arglist);
00092 <span class="preprocessor">#endif</span>
00093 <span class="preprocessor"></span>
00094     va_end(arglist);
00095 
00096     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>)) {
00097 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00098 <span class="preprocessor"></span>        NtCurrentTeb()-&gt;InDbgPrint = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00099 <span class="preprocessor">#endif</span>
00100 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00101     }
00102 
00103     <span class="keywordflow">if</span> (cb == -1) {             <span class="comment">// detect buffer overflow</span>
00104         cb = <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>);
00105         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>) - 1] = <span class="charliteral">'\n'</span>;
00106     }
00107     Output.Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00108     Output.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) cb;
00109 
00110     <span class="comment">//</span>
00111     <span class="comment">// If APP is being debugged, raise an exception and the debugger</span>
00112     <span class="comment">// will catch and handle this. Otherwise, kernel debugger service</span>
00113     <span class="comment">// is called.</span>
00114     <span class="comment">//</span>
00115 
00116 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00117 <span class="preprocessor"></span><span class="preprocessor">#if !i386</span>
00118 <span class="preprocessor"></span>    <span class="comment">//</span>
00119     <span class="comment">// For non-Intel architectures, can't raise exceptions until the PebLock</span>
00120     <span class="comment">// is initialized, since the Function Table lookup code uses the PebLock</span>
00121     <span class="comment">// to serialize access to the loaded module database.  What a crock</span>
00122     <span class="comment">//</span>
00123     <span class="keywordflow">if</span> (NtCurrentPeb()-&gt;FastPebLockRoutine != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00124 <span class="preprocessor">#endif  </span>
00125 <span class="preprocessor">    if (NtCurrentPeb()-&gt;BeingDebugged) {</span>
00126 <span class="preprocessor"></span>        EXCEPTION_RECORD ExceptionRecord;
00127 
00128         <span class="comment">//</span>
00129         <span class="comment">// Construct an exception record.</span>
00130         <span class="comment">//</span>
00131 
00132         ExceptionRecord.ExceptionCode = DBG_PRINTEXCEPTION_C;
00133         ExceptionRecord.ExceptionRecord = (PEXCEPTION_RECORD)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00134         ExceptionRecord.NumberParameters = 2;
00135         ExceptionRecord.ExceptionFlags = 0;
00136         ExceptionRecord.ExceptionInformation[ 0 ] = Output.Length + 1;
00137         ExceptionRecord.ExceptionInformation[ 1 ] = (ULONG_PTR)(Output.Buffer);
00138         <a class="code" href="../../d9/d9/ppc_2exdsptch_8c.html#a9">RtlRaiseException</a>( &amp;ExceptionRecord );
00139 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00140 <span class="preprocessor"></span>        NtCurrentTeb()-&gt;InDbgPrint = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00141 <span class="preprocessor">#endif</span>
00142 <span class="preprocessor"></span>        <span class="keywordflow">return</span> STATUS_SUCCESS;
00143         }
00144 <span class="preprocessor">#endif</span>
00145 <span class="preprocessor"></span>    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>( &amp;Output );
00146     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_BREAKPOINT) {
00147         DbgBreakPointWithStatus(DBG_STATUS_CONTROL_C);
00148         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00149     }
00150 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00151 <span class="preprocessor"></span>    NtCurrentTeb()-&gt;InDbgPrint = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00152 <span class="preprocessor">#endif</span>
00153 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00154 }
00155 
00156 ULONG
<a name="l00157"></a><a class="code" href="../../d0/d5/rtl_2debug_8c.html#a2">00157</a> <a class="code" href="../../d0/d5/rtl_2debug_8c.html#a2">DbgPrintReturnControlC</a>(
00158     PCHAR Format,
00159     ...
00160     )
00161 
00162 <span class="comment">//++</span>
00163 <span class="comment">//</span>
00164 <span class="comment">// Routine Description:</span>
00165 <span class="comment">//</span>
00166 <span class="comment">//    This routine provides a "printf" style capability for the kernel</span>
00167 <span class="comment">//    debugger.</span>
00168 <span class="comment">//</span>
00169 <span class="comment">//    This routine is exactly the same as DbgPrint except that control-C</span>
00170 <span class="comment">//    is NOT handled here.   Instead, status indicating control-C is</span>
00171 <span class="comment">//    returned to the caller to do with as they will.</span>
00172 <span class="comment">//</span>
00173 <span class="comment">// Arguments:</span>
00174 <span class="comment">//</span>
00175 <span class="comment">//    Format     - printf style format string</span>
00176 <span class="comment">//    ...        - additional arguments consumed according to the</span>
00177 <span class="comment">//                 format string.</span>
00178 <span class="comment">//</span>
00179 <span class="comment">// Return Value:</span>
00180 <span class="comment">//</span>
00181 <span class="comment">//    Defined as returning a ULONG, actually returns status.</span>
00182 <span class="comment">//</span>
00183 <span class="comment">//--</span>
00184 
00185 {
00186     va_list arglist;
00187     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[512];
00188     <span class="keywordtype">int</span> cb;
00189     STRING Output;
00190 
00191     <span class="comment">//</span>
00192     <span class="comment">// Format the output into a buffer and then print it.</span>
00193     <span class="comment">//</span>
00194 
00195     va_start(arglist, Format);
00196 
00197     cb = _vsnprintf(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>), Format, arglist);
00198     <span class="keywordflow">if</span> (cb == -1) {             <span class="comment">// detect buffer overflow</span>
00199         cb = <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>);
00200         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<span class="keyword">sizeof</span>(<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>) - 1] = <span class="charliteral">'\n'</span>;
00201     }
00202     Output.Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00203     Output.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) cb;
00204 
00205     <span class="comment">//</span>
00206     <span class="comment">// If APP is being debugged, raise an exception and the debugger</span>
00207     <span class="comment">// will catch and handle this. Otherwise, kernel debugger service</span>
00208     <span class="comment">// is called.</span>
00209     <span class="comment">//</span>
00210 
00211 <span class="preprocessor">#if !defined(BLDR_KERNEL_RUNTIME) &amp;&amp; !defined(NTOS_KERNEL_RUNTIME)</span>
00212 <span class="preprocessor"></span><span class="preprocessor">#if !i386</span>
00213 <span class="preprocessor"></span>    <span class="comment">//</span>
00214     <span class="comment">// For non-Intel architectures, can't raise exceptions until the PebLock</span>
00215     <span class="comment">// is initialized, since the Function Table lookup code uses the PebLock</span>
00216     <span class="comment">// to serialize access to the loaded module database.  What a crock</span>
00217     <span class="comment">//</span>
00218     <span class="keywordflow">if</span> (NtCurrentPeb()-&gt;FastPebLockRoutine != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00219 <span class="preprocessor">#endif  </span>
00220 <span class="preprocessor">    if (NtCurrentPeb()-&gt;BeingDebugged) {</span>
00221 <span class="preprocessor"></span>        EXCEPTION_RECORD ExceptionRecord;
00222 
00223         <span class="comment">//</span>
00224         <span class="comment">// Construct an exception record.</span>
00225         <span class="comment">//</span>
00226 
00227         ExceptionRecord.ExceptionCode = DBG_PRINTEXCEPTION_C;
00228         ExceptionRecord.ExceptionRecord = (PEXCEPTION_RECORD)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00229         ExceptionRecord.NumberParameters = 2;
00230         ExceptionRecord.ExceptionFlags = 0;
00231         ExceptionRecord.ExceptionInformation[ 0 ] = Output.Length + 1;
00232         ExceptionRecord.ExceptionInformation[ 1 ] = (ULONG_PTR)(Output.Buffer);
00233         <a class="code" href="../../d9/d9/ppc_2exdsptch_8c.html#a9">RtlRaiseException</a>( &amp;ExceptionRecord );
00234         <span class="keywordflow">return</span> STATUS_SUCCESS;
00235         }
00236 <span class="preprocessor">#endif</span>
00237 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>( &amp;Output );
00238 }
00239 
00240 ULONG
<a name="l00241"></a><a class="code" href="../../d0/d5/rtl_2debug_8c.html#a3">00241</a> <a class="code" href="../../d0/d5/rtl_2debug_8c.html#a3">DbgPrompt</a>(
00242     IN PCHAR Prompt,
00243     OUT PCHAR Response,
00244     IN ULONG MaximumResponseLength
00245     )
00246 
00247 <span class="comment">//++</span>
00248 <span class="comment">//</span>
00249 <span class="comment">// Routine Description:</span>
00250 <span class="comment">//</span>
00251 <span class="comment">//    This function displays the prompt string on the debugging console and</span>
00252 <span class="comment">//    then reads a line of text from the debugging console.  The line read</span>
00253 <span class="comment">//    is returned in the memory pointed to by the second parameter.  The</span>
00254 <span class="comment">//    third parameter specifies the maximum number of characters that can</span>
00255 <span class="comment">//    be stored in the response area.</span>
00256 <span class="comment">//</span>
00257 <span class="comment">// Arguments:</span>
00258 <span class="comment">//</span>
00259 <span class="comment">//    Prompt - specifies the text to display as the prompt.</span>
00260 <span class="comment">//</span>
00261 <span class="comment">//    Response - specifies where to store the response read from the</span>
00262 <span class="comment">//       debugging console.</span>
00263 <span class="comment">//</span>
00264 <span class="comment">//    Prompt - specifies the maximum number of characters that can be</span>
00265 <span class="comment">//       stored in the Response buffer.</span>
00266 <span class="comment">//</span>
00267 <span class="comment">// Return Value:</span>
00268 <span class="comment">//</span>
00269 <span class="comment">//    Number of characters stored in the Response buffer.  Includes the</span>
00270 <span class="comment">//    terminating newline character, but not the null character after</span>
00271 <span class="comment">//    that.</span>
00272 <span class="comment">//</span>
00273 <span class="comment">//--</span>
00274 
00275 {
00276 
00277     STRING Input;
00278     STRING Output;
00279 
00280     <span class="comment">//</span>
00281     <span class="comment">// Output the prompt string and read input.</span>
00282     <span class="comment">//</span>
00283 
00284     Input.MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)MaximumResponseLength;
00285     Input.Buffer = Response;
00286     Output.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( Prompt );
00287     Output.Buffer = Prompt;
00288     <span class="keywordflow">return</span> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a45">DebugPrompt</a>( &amp;Output, &amp;Input );
00289 }
00290 
00291 <span class="preprocessor">#if defined(NTOS_KERNEL_RUNTIME) || defined(BLDR_KERNEL_RUNTIME)</span>
00292 <span class="preprocessor"></span>
00293 
00294 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00295 DbgLoadImageSymbols(
00296     IN PSTRING FileName,
00297     IN PVOID ImageBase,
00298     IN ULONG_PTR ProcessId
00299     )
00300 
00301 <span class="comment">//++</span>
00302 <span class="comment">//</span>
00303 <span class="comment">// Routine Description:</span>
00304 <span class="comment">//</span>
00305 <span class="comment">//    Tells the debugger about newly loaded symbols.</span>
00306 <span class="comment">//</span>
00307 <span class="comment">// Arguments:</span>
00308 <span class="comment">//</span>
00309 <span class="comment">// Return Value:</span>
00310 <span class="comment">//</span>
00311 <span class="comment">//--</span>
00312 
00313 {
00314 
00315     PIMAGE_NT_HEADERS NtHeaders;
00316     <a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">KD_SYMBOLS_INFO</a> SymbolInfo;
00317 
00318     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o0">BaseOfDll</a> = ImageBase;
00319     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o1">ProcessId</a> = ProcessId;
00320     NtHeaders = <a class="code" href="../../d8/d9/imagedir_8c.html#a0">RtlImageNtHeader</a>( ImageBase );
00321     <span class="keywordflow">if</span> (NtHeaders != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00322         SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o2">CheckSum</a> = (ULONG)NtHeaders-&gt;OptionalHeader.CheckSum;
00323         SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o3">SizeOfImage</a> = (ULONG)NtHeaders-&gt;OptionalHeader.SizeOfImage;
00324 
00325     } <span class="keywordflow">else</span> {
00326 
00327 <span class="preprocessor">#if defined(BLDR_KERNEL_RUNTIME)</span>
00328 <span class="preprocessor"></span>
00329         <span class="comment">//</span>
00330         <span class="comment">// There is only one image loaded in the loader environment that</span>
00331         <span class="comment">// does not have an NT image header. The image is the OS loader</span>
00332         <span class="comment">// and it is loaded by the firmware which strips the file header</span>
00333         <span class="comment">// and the optional ROM header. All the debugger requires is a</span>
00334         <span class="comment">// good guest at the size of the image.</span>
00335         <span class="comment">//</span>
00336 
00337         SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o3">SizeOfImage</a> = 0x100000;
00338 
00339 <span class="preprocessor">#else</span>
00340 <span class="preprocessor"></span>
00341         SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o3">SizeOfImage</a> = 0;
00342 
00343 <span class="preprocessor">#endif</span>
00344 <span class="preprocessor"></span>
00345         SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o2">CheckSum</a>    = 0;
00346     }
00347 
00348     <a class="code" href="../../d8/d5/debug3_8c.html#a4">DebugLoadImageSymbols</a>( FileName, &amp;SymbolInfo);
00349 
00350     <span class="keywordflow">return</span>;
00351 }
00352 
00353 
00354 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00355 DbgUnLoadImageSymbols (
00356     IN PSTRING FileName,
00357     IN PVOID ImageBase,
00358     IN ULONG_PTR ProcessId
00359     )
00360 
00361 <span class="comment">//++</span>
00362 <span class="comment">//</span>
00363 <span class="comment">// Routine Description:</span>
00364 <span class="comment">//</span>
00365 <span class="comment">//    Tells the debugger about newly unloaded symbols.</span>
00366 <span class="comment">//</span>
00367 <span class="comment">// Arguments:</span>
00368 <span class="comment">//</span>
00369 <span class="comment">// Return Value:</span>
00370 <span class="comment">//</span>
00371 <span class="comment">//--</span>
00372 
00373 {
00374     <a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">KD_SYMBOLS_INFO</a> SymbolInfo;
00375 
00376     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o0">BaseOfDll</a> = ImageBase;
00377     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o1">ProcessId</a> = ProcessId;
00378     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o2">CheckSum</a>    = 0;
00379     SymbolInfo.<a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html#o3">SizeOfImage</a> = 0;
00380 
00381     <a class="code" href="../../d8/d5/debug3_8c.html#a5">DebugUnLoadImageSymbols</a>( FileName, &amp;SymbolInfo );
00382 
00383     <span class="keywordflow">return</span>;
00384 }
00385 
00386 <span class="preprocessor">#endif // defined(NTOS_KERNEL_RUNTIME)</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:39 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
