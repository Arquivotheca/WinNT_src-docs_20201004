<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ddemlsvr.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ddemlsvr.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d2/d3/ddemlsvr_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/ddemlsvr_8c.html#a1">xxxCsDdeInitialize</a> (PHANDLE phInst, HWND *phwndEvent, LPDWORD pMonitorFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmd, PVOID pcii)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/ddemlsvr_8c.html#a2">_CsUpdateInstance</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, LPDWORD pMonitorFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> afCmd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/ddemlsvr_8c.html#a3">_CsDdeUninitialize</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/ddemlsvr_8c.html#a4">xxxDestroyThreadDDEObject</a> (<a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti, <a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a3" doxytag="ddemlsvr.c::_CsDdeUninitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _CsDdeUninitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hInst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00110">110</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, and <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">xxxDestroyThreadDDEObject()</a>.
<p>
<pre class="fragment"><div>00112 {
00113     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00114 
00115     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00116 
00117     psii = <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>(hInst, TYPE_DDEACCESS);
00118     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00119         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00120     }
00121 
00122     <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a11">xxxDestroyThreadDDEObject</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), psii);
00123     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00124 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ddemlsvr.c::_CsUpdateInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> _CsUpdateInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pMonitorFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00088">88</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">MonitorFlags</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, and <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02929">NtUserUpdateInstance()</a>.
<p>
<pre class="fragment"><div>00092 {
00093     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00094 
00095     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00096 
00097     psii = (<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>)<a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>(hInst, TYPE_DDEACCESS);
00098     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00099         <span class="keywordflow">return</span> DMLERR_INVALIDPARAMETER;
00100     }
00101     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a8">xxxChangeMonitorFlags</a>(psii, afCmd);
00102     *pMonitorFlags = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00103     <span class="keywordflow">return</span> DMLERR_NO_ERROR;
00104 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ddemlsvr.c::xxxCsDdeInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> xxxCsDdeInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PHANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>phInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND *&nbsp;</td>
          <td class="mdname" nowrap> <em>phwndEvent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pMonitorFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>afCmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">19</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02744">CW_FLAGS_DIFFHMOD</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00689">GWLP_PSII</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00828">HMAllocObject()</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00734">hModuleWin</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00355">ICLS_DDEMLEVENT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d3/d3/ddemlsvr_8h-source.html#l00019">MonitorFlags</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02949">tagSVR_INSTANCE_INFO::nextInThisThread</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03356">tagTHREADINFO::psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02951">tagSVR_INSTANCE_INFO::spwndEvent</a>, <a class="el" href="../../d4/d1/userk_8h.html#a850">SVR_INSTANCE_INFO</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00914">TYPE_DDEACCESS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00476">VER31</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00064">xxxChangeMonitorFlags()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l00033">xxxCreateWindowEx()</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l05787">xxxSetWindowLongPtr</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>.
<p>
<pre class="fragment"><div>00025 {
00026     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psii;
00027     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>        ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00028 
00029     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00030 
00031     psii = (<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>)<a class="code" href="../../d4/d1/userk_8h.html#a969">HMAllocObject</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), NULL,
00032             TYPE_DDEACCESS, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">SVR_INSTANCE_INFO</a>));
00033     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00034         <span class="keywordflow">return</span> DMLERR_SYS_ERROR;
00035     }
00036 
00037     <span class="comment">/*</span>
00038 <span class="comment">     * We have to tell CreateWindow that window is not created for the same</span>
00039 <span class="comment">     * module has the app, (CW_FLAGS_DIFFHMOD), so CreateWindow doesn't</span>
00040 <span class="comment">     * assign a hotkey to this window.  Other window are done in the</span>
00041 <span class="comment">     * client-server thunk</span>
00042 <span class="comment">     */</span>
00043     <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>(&amp;(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>), <a class="code" href="../../d4/d8/createw_8c.html#a1">xxxCreateWindowEx</a>(
00044             0,
00045             (<a class="code" href="../../d1/d9/struct__LARGE__STRING.html">PLARGE_STRING</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLEVENT],
00046             NULL,
00047             WS_POPUP | WS_CHILD,
00048             0, 0, 0, 0,
00049             (<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>)NULL,
00050             (<a class="code" href="../../d1/d1/structtagMENU.html">PMENU</a>)NULL,
00051             hModuleWin,
00052             NULL,
00053             CW_FLAGS_DIFFHMOD | VER31));
00054 
00055     <span class="keywordflow">if</span> (psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00056         <a class="code" href="../../d4/d1/userk_8h.html#a970">HMFreeObject</a>((PVOID)psii);
00057         <span class="keywordflow">return</span> DMLERR_SYS_ERROR;
00058     }
00059     <span class="comment">/*</span>
00060 <span class="comment">     * This GWL offset does NOT leave the critical section!</span>
00061 <span class="comment">     */</span>
00062     <a class="code" href="../../d4/d1/userk_8h.html#a586">xxxSetWindowLongPtr</a>(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>, GWLP_PSII, (LONG_PTR)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii), FALSE);
00063     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o3">afCmd</a> = 0;
00064     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o5">pcii</a> = pcii;
00065     <span class="comment">//</span>
00066     <span class="comment">// Link into global list</span>
00067     <span class="comment">//</span>
00068     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> = <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>;
00069     <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a> = psii;
00070 
00071     <span class="comment">//</span>
00072     <span class="comment">// Link into per-process list</span>
00073     <span class="comment">//</span>
00074     psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> = ptiCurrent-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>;
00075     ptiCurrent-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a> = psii;
00076 
00077     *phInst = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii);
00078     *phwndEvent = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(psii-&gt;spwndEvent);
00079     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a8">xxxChangeMonitorFlags</a>(psii, afCmd);        <span class="comment">// sets psii-&gt;afCmd;</span>
00080     *pMonitorFlags = <a class="code" href="../../d2/d4/ddemlsvr_8h.html#a2">MonitorFlags</a>;
00081     <span class="keywordflow">return</span> DMLERR_NO_ERROR;
00082 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ddemlsvr.c::xxxDestroyThreadDDEObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxDestroyThreadDDEObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pti</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psii</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">127</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01477">HMIsMarkDestroy</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01237">HMMarkObjectDestroy()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02948">tagSVR_INSTANCE_INFO::next</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02949">tagSVR_INSTANCE_INFO::nextInThisThread</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03356">tagTHREADINFO::psiiList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02951">tagSVR_INSTANCE_INFO::spwndEvent</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00368">Unlock</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d5/d7/createw_8c-source.html#l01591">xxxDestroyWindow()</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00110">_CsDdeUninitialize()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l02552">xxxDestroyThreadInfo()</a>.
<p>
<pre class="fragment"><div>00130 {
00131     <a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> psiiT;
00132 
00133     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00134 
00135     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a438">HMIsMarkDestroy</a>(psii)) {
00136         <span class="keywordflow">return</span>;
00137     }
00138 
00139     <span class="comment">//</span>
00140     <span class="comment">// Unlink psii from the global list.</span>
00141     <span class="comment">//</span>
00142     <span class="keywordflow">if</span> (psii == <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>) {
00143         <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>;
00144     } <span class="keywordflow">else</span> {
00145         <span class="keywordflow">for</span> (psiiT = <a class="code" href="../../d1/d4/ddemlsvr_8c.html#a0">psiiList</a>; psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> != psii; psiiT = psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>) {
00146             UserAssert(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> != NULL);
00147         }
00148         psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o1">next</a>;
00149     }
00150     <span class="comment">// psii-&gt;next = NULL;</span>
00151 
00152     <span class="comment">//</span>
00153     <span class="comment">// Unlink psii from the per-process list.</span>
00154     <span class="comment">//</span>
00155     <span class="keywordflow">if</span> (psii == pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>) {
00156         pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>;
00157     } <span class="keywordflow">else</span> {
00158         <span class="keywordflow">for</span> (psiiT = pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o24">psiiList</a>; psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> != psii; psiiT = psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>) {
00159             UserAssert(psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> != NULL);
00160         }
00161         psiiT-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a> = psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o2">nextInThisThread</a>;
00162     }
00163     <span class="comment">// psii-&gt;nextInThisThread = NULL;</span>
00164 
00165     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a971">HMMarkObjectDestroy</a>(psii)) {
00166         <a class="code" href="../../d4/d1/userk_8h.html#a1575">xxxDestroyWindow</a>(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>);
00167         <a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;(psii-&gt;<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html#o4">spwndEvent</a>));
00168 
00169         <a class="code" href="../../d4/d1/userk_8h.html#a970">HMFreeObject</a>(psii);
00170     }
00171 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="ddemlsvr.c::psiiList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a> <a class="el" href="../../d2/d4/ddemlsvr_8h.html#a1">psiiList</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00017">17</a> of file <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html">ddemlsvr.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00019">xxxCsDdeInitialize()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00120">xxxCsEvent()</a>, and <a class="el" href="../../d2/d3/ddemlsvr_8c-source.html#l00127">xxxDestroyThreadDDEObject()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:24 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
