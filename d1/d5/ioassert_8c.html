<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ioassert.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ioassert.c File Reference</h1><code>#include "<a class="el" href="../../d1/d5/iop_8h-source.html">iop.h</a>"</code><br>

<p>
<a href="../../d2/d4/ioassert_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">_DCERROR_MESSAGE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">_DC_OVERRIDE_TABLE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a0">MAX_NAMED_MAJOR_IRPS</a>&nbsp;&nbsp;&nbsp;0x1b</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a1">MAX_NAMED_PNP_IRP</a>&nbsp;&nbsp;&nbsp;0x18</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a2">MAX_NAMED_WMI_IRP</a>&nbsp;&nbsp;&nbsp;0x9</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a3">MAX_NAMED_POWER_IRP</a>&nbsp;&nbsp;&nbsp;0x3</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">_DCERROR_MESSAGE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a11">DCERROR_MESSAGE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">_DCERROR_MESSAGE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a12">PDCERROR_MESSAGE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">_DC_OVERRIDE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a19">DC_OVERRIDE_TABLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">_DC_OVERRIDE_TABLE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a20">PDC_OVERRIDE_TABLE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a26">KeBugCheckUnicodeToAnsi</a> (IN PUNICODE_STRING UnicodeString, OUT PCHAR AnsiBuffer, IN ULONG MaxAnsiLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a27">IopDriverCorrectnessTakeLock</a> (IN PULONG ControlNew, IN LONG StackFramesToSkip)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a28">IopDriverCorrectnessReleaseLock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a29">IopDriverCorrectnessCheckUnderLock</a> (IN <a class="el" href="../../d2/d5/ioassert_8h.html#a31">DCERROR_ID</a> MessageID, IN ULONG MessageParameterMask,...)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a30">IopDriverCorrectnessProcessParams</a> (IN OUT PULONG Control OPTIONAL, IN LONG StackFramesToSkip, IN <a class="el" href="../../d2/d5/ioassert_8h.html#a31">DCERROR_ID</a> MessageID, IN ULONG MessageParameterMask, IN va_list *MessageParameters, IN PVOID *DcParamArray, OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a31">IopDriverCorrectnessApplyControl</a> (IN OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a32">IopDriverCorrectnessProcessMessageText</a> (IN ULONG MaxOutputBufferSize, OUT PSTR OutputBuffer, IN OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a33">IopDriverCorrectnessThrowBugCheck</a> (IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a34">IopDriverCorrectnessPrintBuffer</a> (IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a35">IopDriverCorrectnessPrintParamData</a> (IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a36">IopDriverCorrectnessPrompt</a> (IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a> DcCheckData, OUT PBOOLEAN ExitAssertion)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a37">IopDriverCorrectnessAddressToFileHeader</a> (IN PVOID Address, OUT PLDR_DATA_TABLE_ENTRY *DataTableEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a38">IopIsMemoryRangeReadable</a> (IN PVOID Location, IN size_t Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a39">IopDriverCorrectnessPrintIrp</a> (IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a> IrpToFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a40">IopDriverCorrectnessPrintIrpStack</a> (IN <a class="el" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a> IrpSp)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a4">IopDcControlCurrent</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a5">IopDcCurrentFrameSkips</a> = -1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KIRQL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a6">IopDcControlIrql</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a7">IopDcControlLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a8">IopDcControlInitial</a> = (ULONG) -1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a9">IopDcControlOverride</a> = (ULONG) -1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html">DCPARAM_TYPE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a13">IopDcWdmDriverErrorFatal</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a14">IopDcWdmDriverErrorNonFatal</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a15">IopDcWdmDriverWarning</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a16">IopDcWdmDriverPostponed</a> = { DIAG_ZAPPED, "POSTPONED WDM DRIVER BUG" }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a17">IopDcWdmCoreError</a> = { DIAG_BEEP, "CORE DRIVER ERROR" }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">DCERROR_MESSAGE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a18">IopDcMessageTable</a> [DCERROR_MAXIMUM-DCERROR_UNSPECIFIED]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">DC_OVERRIDE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a22">IrpMajorNames</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a23">PnPIrpNames</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a24">WmiIrpNames</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d5/ioassert_8c.html#a25">PowerIrpNames</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="ioassert.c::MAX_NAMED_MAJOR_IRPS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_NAMED_MAJOR_IRPS&nbsp;&nbsp;&nbsp;0x1b          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01454">1454</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ioassert.c::MAX_NAMED_PNP_IRP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_NAMED_PNP_IRP&nbsp;&nbsp;&nbsp;0x18          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01486">1486</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ioassert.c::MAX_NAMED_POWER_IRP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_NAMED_POWER_IRP&nbsp;&nbsp;&nbsp;0x3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01512">1512</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ioassert.c::MAX_NAMED_WMI_IRP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_NAMED_WMI_IRP&nbsp;&nbsp;&nbsp;0x9          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01502">1502</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a19" doxytag="ioassert.c::DC_OVERRIDE_TABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">_DC_OVERRIDE_TABLE</a>  <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">DC_OVERRIDE_TABLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ioassert.c::DCERROR_MESSAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">_DCERROR_MESSAGE</a>  <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">DCERROR_MESSAGE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ioassert.c::PDC_OVERRIDE_TABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">_DC_OVERRIDE_TABLE</a> * <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">PDC_OVERRIDE_TABLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ioassert.c::PDCERROR_MESSAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">_DCERROR_MESSAGE</a> * <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">PDCERROR_MESSAGE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a37" doxytag="ioassert.c::IopDriverCorrectnessAddressToFileHeader" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID IopDriverCorrectnessAddressToFileHeader           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLDR_DATA_TABLE_ENTRY *&nbsp;</td>
          <td class="mdname" nowrap> <em>DataTableEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01254">1254</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d8/ps_8h-source.html#l00582">PsLoadedModuleList</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>.
<p>
<pre class="fragment"><div>01261                    :
01262 
01263     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base of an image that contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01264     specified Address. An image contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address
01265     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ImageBase, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ImageBase plus <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01266     <span class="keyword">virtual</span> image.
01267 
01268 Arguments:
01269 
01270     Address - Supplies an address to resolve to a loader entry.
01271 
01272     DataTableEntry - Suppies a pointer to a variable that receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01273         address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data table entry that describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> image.
01274 
01275 Return Value:
01276 
01277     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - No image was found that contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> passed in address.
01278 
01279     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> image that contain <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01280         address.
01281 
01282 --*/
01283 
01284 {
01285 
01286     PLIST_ENTRY ModuleListHead;
01287     PLDR_DATA_TABLE_ENTRY Entry;
01288     PLIST_ENTRY Next;
01289     UINT_PTR Bounds;
01290     PVOID ReturnBase=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, Base;
01291 
01292     ModuleListHead = &amp;<a class="code" href="../../d1/d9/ps_8h.html#a56">PsLoadedModuleList</a>;
01293 
01294     <span class="comment">//</span>
01295     <span class="comment">// It would be nice if we could call MiLookupDataTableEntry, but it's</span>
01296     <span class="comment">// pageable, so we do what the bugcheck stuff does...</span>
01297     <span class="comment">//</span>
01298     Next = ModuleListHead-&gt;Flink;
01299     <span class="keywordflow">if</span> (Next != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01300         <span class="keywordflow">while</span> (Next != ModuleListHead) {
01301             Entry = CONTAINING_RECORD(Next,
01302                                       LDR_DATA_TABLE_ENTRY,
01303                                       InLoadOrderLinks);
01304 
01305             Next = Next-&gt;Flink;
01306             Base = Entry-&gt;DllBase;
01307             Bounds = (UINT_PTR)Base + Entry-&gt;SizeOfImage;
01308             <span class="keywordflow">if</span> ((UINT_PTR)Address &gt;= (UINT_PTR)Base &amp;&amp; (UINT_PTR)Address &lt; Bounds) {
01309                 *DataTableEntry = Entry;
01310                 ReturnBase = Base;
01311                 <span class="keywordflow">break</span>;
01312             }
01313         }
01314     }
01315 
01316     <span class="keywordflow">return</span> ReturnBase;
01317 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ioassert.c::IopDriverCorrectnessApplyControl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IopDriverCorrectnessApplyControl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DcCheckData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00776">776</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00125">DIAG_CLEARED</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00126">DIAG_FATAL_ERROR</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00128">DIAG_IGNORE_DRIVER_LIST</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00122">DIAG_INITIALIZED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00056">IopDcControlInitial</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00057">IopDcControlOverride</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00134">KdDebuggerEnabled</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>00779 {
00780     ULONG assertionControl;
00781 
00782     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d5/ioassert_8c.html#a9">IopDcControlOverride</a>) {
00783 
00784         assertionControl = <a class="code" href="../../d1/d5/ioassert_8c.html#a9">IopDcControlOverride</a>;
00785 
00786     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DcCheckData-&gt;Control) {
00787 
00788         <span class="comment">//</span>
00789         <span class="comment">// Initialize the control if appropo</span>
00790         <span class="comment">//</span>
00791         <span class="keywordflow">if</span> (!((*DcCheckData-&gt;Control)&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a0">DIAG_INITIALIZED</a>)) {
00792 
00793             *DcCheckData-&gt;Control |= (
00794                 <a class="code" href="../../d2/d5/ioassert_8h.html#a0">DIAG_INITIALIZED</a> | <a class="code" href="../../d1/d5/ioassert_8c.html#a8">IopDcControlInitial</a> |
00795                 DcCheckData-&gt;AssertionClass-&gt;ClassFlags );
00796         }
00797 
00798         assertionControl = *DcCheckData-&gt;Control;
00799 
00800     } <span class="keywordflow">else</span> {
00801 
00802         assertionControl =
00803             ( <a class="code" href="../../d1/d5/ioassert_8c.html#a8">IopDcControlInitial</a> | DcCheckData-&gt;AssertionClass-&gt;ClassFlags );
00804     }
00805 
00806     <span class="keywordflow">if</span> (assertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a3">DIAG_CLEARED</a>) {
00807 
00808         <span class="comment">//</span>
00809         <span class="comment">// If the breakpoint was cleared, then return, print/rip not.</span>
00810         <span class="comment">//</span>
00811         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00812     }
00813 
00814     <span class="keywordflow">if</span> ((!(assertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a6">DIAG_IGNORE_DRIVER_LIST</a>)) &amp;&amp;
00815         (!DcCheckData-&gt;InVerifierList)) {
00816 
00817         <span class="comment">//</span>
00818         <span class="comment">// Not of interest, skip this one.</span>
00819         <span class="comment">//</span>
00820         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00821     }
00822 
00823     <span class="comment">//</span>
00824     <span class="comment">// If there is no debugger, don't halt the machine. We are probably</span>
00825     <span class="comment">// ripping like mad and the user just wants to be able to boot.</span>
00826     <span class="comment">// The one exception is if DIAG_FATAL_ERROR is set. Then we shall</span>
00827     <span class="comment">// invoke the driver bugcheck...</span>
00828     <span class="comment">//</span>
00829     <span class="keywordflow">if</span> ((!<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a>) &amp;&amp; (!(assertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a4">DIAG_FATAL_ERROR</a>))) {
00830 
00831         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00832     }
00833 
00834     <span class="comment">//</span>
00835     <span class="comment">// Record our intentions and continue.</span>
00836     <span class="comment">//</span>
00837     DcCheckData-&gt;AssertionControl = assertionControl;
00838     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00839 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ioassert.c::IopDriverCorrectnessCheckUnderLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS IopDriverCorrectnessCheckUnderLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d5/ioassert_8h.html#a31">DCERROR_ID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageParameterMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">463</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d5/ioassert_8h.html#a37">DC_CHECK_DATA</a>, <a class="el" href="../../d2/d5/ioassert_8h.html#a31">DCERROR_ID</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00067">DcParamTable</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00052">IopDcControlCurrent</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00053">IopDcCurrentFrameSkips</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00776">IopDriverCorrectnessApplyControl()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01016">IopDriverCorrectnessPrintBuffer()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01151">IopDriverCorrectnessPrintParamData()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00842">IopDriverCorrectnessProcessMessageText()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01162">IopDriverCorrectnessPrompt()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00960">IopDriverCorrectnessThrowBugCheck()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, and <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>.
<p>
<pre class="fragment"><div>00470               :
00471 
00472       This routine displays an assert and provides options <span class="keywordflow">for</span>
00473       removing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> breakpoint, changing to just a <a class="code" href="../../d7/d1/genuedef_8c.html#a5">text</a>-<a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a>, etc.
00474 
00475     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used as part of a macro <span class="keywordflow">for</span> providing <span class="stringliteral">"Zappable"</span> traps -
00476     IE, users get <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> option of changing how a specific instance of
00477     WDM_DEBUG_OUT in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> code <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> handled (<span class="keywordflow">default</span> is spew and <span class="keywordflow">break</span>, options
00478     are spew or blow away <span class="keywordflow">for</span> <span class="keyword">this</span> boot).
00479 
00480     Macro must call IopDiagSetAssertLock, IopDiagAssertPrintfUnderLock, and
00481     IopDiagReleaseAssertLock in order
00482 
00483     <a class="code" href="../../d2/d5/ioassert_8h.html#a7">DCPARAM_IRP</a>*(count)+<a class="code" href="../../d2/d5/ioassert_8h.html#a8">DCPARAM_ROUTINE</a>*(count)+<a class="code" href="../../d2/d5/ioassert_8h.html#a9">DCPARAM_DEVOBJ</a>*(count),
00484         irp1,
00485         irp2,
00486         irp3,
00487         routine1,
00488         ..,
00489         ..,
00490         devobj1,
00491 
00492     count can be a <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a> of 3.
00493 
00494 
00495    Arguments:
00496 
00497       Control - <span class="keywordflow">if</span> present, <span class="keyword">this</span> variable determines whether we will
00498                  actually <span class="keywordflow">do</span> anything.
00499 
00500                 <span class="keywordflow">if</span> <a class="code" href="../../d2/d5/ioassert_8h.html#a2">DIAG_ZAPPED</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set we will <a class="code" href="../../d0/d1/rtdeltre_8c.html#a5">print</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assert <a class="code" href="../../d7/d1/genuedef_8c.html#a5">text</a> and <span class="keywordflow">return</span>.
00501                 <span class="keywordflow">if</span> <a class="code" href="../../d2/d5/ioassert_8h.html#a3">DIAG_CLEARED</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set, we will neither <a class="code" href="../../d0/d1/rtdeltre_8c.html#a5">print</a> or stop.
00502                 <span class="keywordflow">if</span> <a class="code" href="../../d2/d5/ioassert_8h.html#a1">DIAG_BEEP</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set, we will beep <span class="keywordflow">if</span> not zapped.
00503 
00504       StackFramesToSkip - If <span class="keyword">this</span> parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> -1, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not used.
00505                           Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assertion code will attempt to walk
00506                           back <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate number of frames and
00507                           determine <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller to blame based on <span class="keywordflow">return</span>
00508                           address.
00509 
00510       IrpToFlag      - <a class="code" href="../../d0/d2/struct__IRP.html">IRP</a> to <a class="code" href="../../d0/d1/rtdeltre_8c.html#a5">print</a> <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a> data <span class="keywordflow">for</span> <span class="keywordflow">if</span> mishandling of
00511                        <span class="keyword">this</span> <a class="code" href="../../d0/d2/struct__IRP.html">IRP</a> was <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error.
00512 
00513       AddressToFlag  - Address that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assert should be blaimed on. This
00514                        should be null <span class="keywordflow">if</span> StackFramesToSkip <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not -1.
00515 
00516       AssertionClass - Text describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> overall <span class="keyword">class </span>of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assert
00517 
00518       AssertionText  - Text specifically describing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assert. Carriage
00519                        returns should not be embedded in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a5">text</a>, this
00520                        routine will automatically ensure words are not split
00521                        across <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> screen.
00522 
00523    Notes:
00524 
00525       The <a class="code" href="../../d7/d1/genuedef_8c.html#a5">text</a> will automagically be formatted and printed as such:
00526 
00527       ASSERTION CLASS: ASSERTION TEXT ASSERTION TEXT ASSERTION
00528                        TEXT ASSERTION TEXT ...
00529 
00530 --*/
00531 
00532 {
00533     va_list arglist;
00534     UCHAR finalBuffer[512];
00535     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00536     <a class="code" href="../../d3/d0/struct__DC__CHECK__DATA.html">DC_CHECK_DATA</a> dcCheckData;
00537     PVOID dcParamArray[3*<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a>)/<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html">DCPARAM_TYPE_ENTRY</a>)];
00538     BOOLEAN exitAssertion;
00539 
00540     va_start(arglist, MessageParameterMask);
00541 
00542     <span class="comment">//</span>
00543     <span class="comment">// Determine what our basic policy towards this check will be and fill out</span>
00544     <span class="comment">// the dcCheckData structure as well as we can.</span>
00545     <span class="comment">//</span>
00546     <a class="code" href="../../d2/d5/ioassert_8h.html#a104">IopDriverCorrectnessProcessParams</a>(
00547         IopDcControlCurrent,
00548         IopDcCurrentFrameSkips,
00549         MessageID,
00550         MessageParameterMask,
00551         &amp;arglist,
00552         dcParamArray,
00553         &amp;dcCheckData
00554         );
00555 
00556     va_end(arglist);
00557 
00558     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d5/ioassert_8h.html#a105">IopDriverCorrectnessApplyControl</a>(&amp;dcCheckData)) {
00559 
00560         <span class="comment">//</span>
00561         <span class="comment">// Nothing to see here, just ignore the assert...</span>
00562         <span class="comment">//</span>
00563         <span class="keywordflow">return</span> STATUS_SUCCESS;
00564     }
00565 
00566     <span class="comment">//</span>
00567     <span class="comment">// We are going to express our disatifaction somehow. Expand out the</span>
00568     <span class="comment">// message we've prepared for this scenario.</span>
00569     <span class="comment">//</span>
00570     status = <a class="code" href="../../d2/d5/ioassert_8h.html#a103">IopDriverCorrectnessProcessMessageText</a>(
00571         <span class="keyword">sizeof</span>(finalBuffer),
00572         finalBuffer,
00573         &amp;dcCheckData
00574         );
00575 
00576     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00577 
00578         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(0);
00579 
00580         <span class="comment">//</span>
00581         <span class="comment">// Something went wrong with the index lookup!</span>
00582         <span class="comment">//</span>
00583         <span class="keywordflow">return</span> status;
00584     }
00585 
00586     <span class="keywordflow">do</span> {
00587 
00588         <a class="code" href="../../d2/d5/ioassert_8h.html#a107">IopDriverCorrectnessPrintBuffer</a>(&amp;dcCheckData);
00589         <a class="code" href="../../d2/d5/ioassert_8h.html#a108">IopDriverCorrectnessPrintParamData</a>(&amp;dcCheckData);
00590         <a class="code" href="../../d2/d5/ioassert_8h.html#a106">IopDriverCorrectnessThrowBugCheck</a>(&amp;dcCheckData);
00591         <a class="code" href="../../d2/d5/ioassert_8h.html#a111">IopDriverCorrectnessPrompt</a>(&amp;dcCheckData, &amp;exitAssertion);
00592 
00593     } <span class="keywordflow">while</span> (!exitAssertion);
00594 
00595     <span class="keywordflow">return</span> status;
00596 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ioassert.c::IopDriverCorrectnessPrintBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessPrintBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DcCheckData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01016">1016</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00126">DIAG_FATAL_ERROR</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00160">KeBugCheckUnicodeToAnsi()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d9/heappage_8c.html#a68">sprintf()</a>, and <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>01019 {
01020     UCHAR buffer[82];
01021     UCHAR classBuf[81];
01022     UCHAR callerBuf[81+40];
01023     UCHAR ansiDriverName[81];
01024     LONG  lMargin, i, lMarginCur, rMargin=78;
01025     PSTR lineStart, lastWord, current, lMarginText;
01026 
01027     <span class="comment">//</span>
01028     <span class="comment">// Put down a carraige return</span>
01029     <span class="comment">//</span>
01030     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>) ;
01031 
01032     <span class="comment">//</span>
01033     <span class="comment">// Drop a banner if this is a fatal assert.</span>
01034     <span class="comment">//</span>
01035     <span class="keywordflow">if</span> (DcCheckData-&gt;AssertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a4">DIAG_FATAL_ERROR</a>) {
01036 
01037         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(
01038             <span class="stringliteral">"***********************************************************************\n"</span>
01039             <span class="stringliteral">"* THIS DRIVER BUG IS FATAL AND WILL CAUSE THE VERIFIER TO HALT        *\n"</span>
01040             <span class="stringliteral">"* WINDOWS (BUGCHECK) WHEN THE MACHINE IS NOT UNDER A KERNEL DEBUGGER! *\n"</span>
01041             <span class="stringliteral">"***********************************************************************\n"</span>
01042             <span class="stringliteral">"\n"</span>
01043             );
01044     }
01045 
01046     <span class="comment">//</span>
01047     <span class="comment">// Prepare left margin (ClassText)</span>
01048     <span class="comment">//</span>
01049     <span class="keywordflow">if</span> (DcCheckData-&gt;ClassText != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01050 
01051         lMargin = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(DcCheckData-&gt;ClassText)+2;
01052 
01053         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s: "</span>, DcCheckData-&gt;ClassText);
01054 
01055     } <span class="keywordflow">else</span> {
01056 
01057         lMargin = 0;
01058     }
01059 
01060     <span class="keywordflow">if</span> (lMargin+1&gt;=rMargin) {
01061 
01062         lMargin=0;
01063     }
01064 
01065     <span class="keywordflow">for</span>(i=0; i&lt;lMargin; i++) classBuf[i] = <span class="charliteral">' '</span>;
01066     classBuf[lMargin] = <span class="charliteral">'\0'</span>;
01067     lMarginText = classBuf+lMargin;
01068     lMarginCur = lMargin;
01069 
01070     lineStart = lastWord = current = DcCheckData-&gt;AssertionText;
01071 
01072     <span class="comment">//</span>
01073     <span class="comment">// Print out culprit if we have him...</span>
01074     <span class="comment">//</span>
01075     <span class="keywordflow">if</span> (DcCheckData-&gt;CulpritAddress) {
01076 
01077         <span class="keywordflow">if</span> (DcCheckData-&gt;DriverName.Length) {
01078 
01079             <a class="code" href="../../d9/d1/bugcheck_8c.html#a15">KeBugCheckUnicodeToAnsi</a>(
01080                 &amp;DcCheckData-&gt;DriverName,
01081                 ansiDriverName,
01082                 <span class="keyword">sizeof</span>(ansiDriverName)
01083                 );
01084 
01085             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(callerBuf, <span class="stringliteral">"[%s @ 0x%p] "</span>,
01086                 ansiDriverName,
01087                 DcCheckData-&gt;CulpritAddress
01088                 );
01089 
01090         } <span class="keywordflow">else</span> {
01091 
01092             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(callerBuf, <span class="stringliteral">"[0x%p] "</span>, DcCheckData-&gt;CulpritAddress);
01093         }
01094 
01095         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s"</span>, callerBuf);
01096         lMarginCur += <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(callerBuf);
01097     }
01098 
01099     <span class="comment">//</span>
01100     <span class="comment">// Format and print our assertion text</span>
01101     <span class="comment">//</span>
01102     <span class="keywordflow">while</span>(*current) {
01103 
01104         <span class="keywordflow">if</span> (*current == <span class="charliteral">' '</span>) {
01105 
01106             <span class="keywordflow">if</span> ((current - lineStart) &gt;= (rMargin-lMarginCur-1)) {
01107 
01108                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s"</span>, lMarginText);
01109                 lMarginText = classBuf;
01110                 lMarginCur = lMargin;
01111 
01112                 <span class="keywordflow">if</span> ((lastWord-lineStart)&lt;rMargin) {
01113 
01114                     memcpy(buffer, lineStart, (ULONG)(lastWord-lineStart)*<span class="keyword">sizeof</span>(UCHAR));
01115                     buffer[lastWord-lineStart] = <span class="charliteral">'\0'</span>;
01116                     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, buffer);
01117 
01118                 }
01119 
01120                 lineStart = lastWord+1;
01121             }
01122 
01123             lastWord = current;
01124         }
01125 
01126         current++;
01127     }
01128 
01129     <span class="keywordflow">if</span> ((current - lineStart) &gt;= (rMargin-lMarginCur-1)) {
01130 
01131         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s"</span>, lMarginText);
01132         lMarginText = classBuf;
01133 
01134         <span class="keywordflow">if</span> ((lastWord-lineStart)&lt;rMargin) {
01135 
01136             memcpy(buffer, lineStart, (ULONG)(lastWord-lineStart)*<span class="keyword">sizeof</span>(UCHAR));
01137             buffer[lastWord-lineStart] = <span class="charliteral">'\0'</span>;
01138             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, buffer);
01139         }
01140 
01141         lineStart = lastWord+1;
01142     }
01143 
01144     <span class="keywordflow">if</span> (lineStart&lt;current) {
01145 
01146         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s%s\n"</span>, lMarginText, lineStart);
01147     }
01148 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ioassert.c::IopDriverCorrectnessPrintIrp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessPrintIrp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>IrpToFlag</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01370">1370</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d0/d5/io_8h.html#a373">IO_STACK_LOCATION</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l03252">IoGetCurrentIrpStackLocation</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l03398">IoGetNextIrpStackLocation</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01320">IopIsMemoryRangeReadable()</a>, and <a class="el" href="../../d1/d4/io_8h-source.html#l02029">_IO_STACK_LOCATION::MinorFunction</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01151">IopDriverCorrectnessPrintParamData()</a>.
<p>
<pre class="fragment"><div>01373 {
01374     <a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a> irpSpCur ;
01375     <a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a> irpSpNxt ;
01376 
01377     <span class="comment">//</span>
01378     <span class="comment">// First see if we can touch the IRP header</span>
01379     <span class="comment">//</span>
01380     <span class="keywordflow">if</span>(!<a class="code" href="../../d2/d5/ioassert_8h.html#a113">IopIsMemoryRangeReadable</a>(IrpToFlag, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d2/struct__IRP.html">IRP</a>))) {
01381         <span class="keywordflow">return</span> ;
01382     }
01383 
01384     <span class="comment">//</span>
01385     <span class="comment">// OK, get the next two stack locations...</span>
01386     <span class="comment">//</span>
01387     irpSpNxt = <a class="code" href="../../d0/d5/io_8h.html#a230">IoGetNextIrpStackLocation</a>( IrpToFlag );
01388     irpSpCur = <a class="code" href="../../d0/d5/io_8h.html#a228">IoGetCurrentIrpStackLocation</a>( IrpToFlag );
01389 
01390     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d5/ioassert_8h.html#a113">IopIsMemoryRangeReadable</a>(irpSpNxt, 2*<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">IO_STACK_LOCATION</a>))) {
01391 
01392         <span class="comment">//</span>
01393         <span class="comment">// Both are present, print the best one!</span>
01394         <span class="comment">//</span>
01395         <span class="keywordflow">if</span> (irpSpNxt-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o1">MinorFunction</a> == irpSpCur-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o1">MinorFunction</a>) {
01396 
01397             <span class="comment">//</span>
01398             <span class="comment">// Looks forwarded</span>
01399             <span class="comment">//</span>
01400             <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpNxt) ;
01401         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (irpSpNxt-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o1">MinorFunction</a> == 0) {
01402 
01403             <span class="comment">//</span>
01404             <span class="comment">// Next location is probably currently zero'd</span>
01405             <span class="comment">//</span>
01406             <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpCur) ;
01407         } <span class="keywordflow">else</span> {
01408             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Next:    &gt;"</span>) ;
01409             <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpNxt) ;
01410             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Current:  "</span>) ;
01411             <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpCur) ;
01412         }
01413     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d5/ioassert_8h.html#a113">IopIsMemoryRangeReadable</a>(irpSpCur, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">IO_STACK_LOCATION</a>))) {
01414 
01415         <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpCur) ;
01416     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d5/ioassert_8h.html#a113">IopIsMemoryRangeReadable</a>(irpSpNxt, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">IO_STACK_LOCATION</a>))) {
01417 
01418         <a class="code" href="../../d2/d5/ioassert_8h.html#a110">IopDriverCorrectnessPrintIrpStack</a>(irpSpNxt) ;
01419     }
01420 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ioassert.c::IopDriverCorrectnessPrintIrpStack" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessPrintIrpStack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>IrpSp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">1516</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d0/d5/io_8h.html#a604a423">BusQueryCompatibleIDs</a>, <a class="el" href="../../d0/d5/io_8h.html#a604a421">BusQueryDeviceID</a>, <a class="el" href="../../d0/d5/io_8h.html#a604a422">BusQueryHardwareIDs</a>, <a class="el" href="../../d0/d5/io_8h.html#a604a424">BusQueryInstanceID</a>, <a class="el" href="../../d0/d5/io_8h.html#a602a412">BusRelations</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d0/d5/io_8h.html#a605a426">DeviceTextDescription</a>, <a class="el" href="../../d0/d5/io_8h.html#a605a427">DeviceTextLocationInformation</a>, <a class="el" href="../../d0/d5/io_8h.html#a603a420">DeviceUsageTypeDumpFile</a>, <a class="el" href="../../d0/d5/io_8h.html#a603a419">DeviceUsageTypeHibernation</a>, <a class="el" href="../../d0/d5/io_8h.html#a603a418">DeviceUsageTypePaging</a>, <a class="el" href="../../d0/d5/io_8h.html#a603a417">DeviceUsageTypeUndefined</a>, <a class="el" href="../../d0/d5/io_8h.html#a602a413">EjectionRelations</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00070">IRP_MJ_INTERNAL_DEVICE_CONTROL</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00082">IRP_MJ_PNP</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00077">IRP_MJ_POWER</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00078">IRP_MJ_SYSTEM_CONTROL</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00183">IRP_MN_DEVICE_USAGE_NOTIFICATION</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00182">IRP_MN_QUERY_BUS_INFORMATION</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00168">IRP_MN_QUERY_DEVICE_RELATIONS</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00173">IRP_MN_QUERY_DEVICE_TEXT</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00180">IRP_MN_QUERY_ID</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00169">IRP_MN_QUERY_INTERFACE</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00186">IRP_MN_QUERY_LEGACY_BUS_INFORMATION</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00176">IRP_MN_READ_CONFIG</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00154">IRP_MN_SCSI_CLASS</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00179">IRP_MN_SET_LOCK</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00177">IRP_MN_WRITE_CONFIG</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01422">IrpMajorNames</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01454">MAX_NAMED_MAJOR_IRPS</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01486">MAX_NAMED_PNP_IRP</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01512">MAX_NAMED_POWER_IRP</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01502">MAX_NAMED_WMI_IRP</a>, <a class="el" href="../../d8/d3/flunkirp_8c-source.html#l00075">PnPIrpNames</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01504">PowerIrpNames</a>, <a class="el" href="../../d0/d5/io_8h.html#a602a414">PowerRelations</a>, <a class="el" href="../../d0/d5/io_8h.html#a602a415">RemovalRelations</a>, <a class="el" href="../../d0/d5/io_8h.html#a602a416">TargetDeviceRelation</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01488">WmiIrpNames</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01370">IopDriverCorrectnessPrintIrp()</a>.
<p>
<pre class="fragment"><div>01519 {
01520     <span class="keywordflow">if</span> ((IrpSp-&gt;MajorFunction==<a class="code" href="../../d0/d5/io_8h.html#a28">IRP_MJ_INTERNAL_DEVICE_CONTROL</a>)&amp;&amp;(IrpSp-&gt;MinorFunction == <a class="code" href="../../d0/d5/io_8h.html#a64">IRP_MN_SCSI_CLASS</a>)) {
01521 
01522          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MJ_SCSI"</span>) ;
01523 
01524     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IrpSp-&gt;MajorFunction&lt;=<a class="code" href="../../d1/d5/ioassert_8c.html#a0">MAX_NAMED_MAJOR_IRPS</a>) {
01525 
01526          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(IrpMajorNames[IrpSp-&gt;MajorFunction]) ;
01527 
01528     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IrpSp-&gt;MajorFunction==0xFF) {
01529 
01530          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MJ_BOGUS"</span>) ;
01531 
01532     } <span class="keywordflow">else</span> {
01533 
01534          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MJ_??"</span>) ;
01535     }
01536 
01537     <span class="keywordflow">switch</span>(IrpSp-&gt;MajorFunction) {
01538 
01539          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a36">IRP_MJ_SYSTEM_CONTROL</a>:
01540              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"."</span>) ;
01541              <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction&lt;=<a class="code" href="../../d1/d5/ioassert_8c.html#a2">MAX_NAMED_WMI_IRP</a>) {
01542 
01543                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(WmiIrpNames[IrpSp-&gt;MinorFunction]) ;
01544              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction==0xFF) {
01545 
01546                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MN_BOGUS"</span>) ;
01547              } <span class="keywordflow">else</span> {
01548                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01549              }
01550              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>) ;
01551              <span class="keywordflow">break</span> ;
01552          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a40">IRP_MJ_PNP</a>:
01553              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"."</span>) ;
01554              <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction&lt;=<a class="code" href="../../d1/d5/ioassert_8c.html#a1">MAX_NAMED_PNP_IRP</a>) {
01555 
01556                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(PnPIrpNames[IrpSp-&gt;MinorFunction]) ;
01557              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction==0xFF) {
01558 
01559                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MN_BOGUS"</span>) ;
01560              } <span class="keywordflow">else</span> {
01561 
01562                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01563              }
01564              <span class="keywordflow">switch</span>(IrpSp-&gt;MinorFunction) {
01565                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a72">IRP_MN_QUERY_DEVICE_RELATIONS</a>:
01566 
01567                      <span class="keywordflow">switch</span>(IrpSp-&gt;Parameters.QueryDeviceRelations.Type) {
01568                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a602a412">BusRelations</a>:
01569                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(BusRelations)"</span>) ;
01570                              <span class="keywordflow">break</span> ;
01571                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a602a413">EjectionRelations</a>:
01572                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(EjectionRelations)"</span>) ;
01573                              <span class="keywordflow">break</span> ;
01574                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a602a414">PowerRelations</a>:
01575                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(PowerRelations)"</span>) ;
01576                              <span class="keywordflow">break</span> ;
01577                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a602a415">RemovalRelations</a>:
01578                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(RemovalRelations)"</span>) ;
01579                              <span class="keywordflow">break</span> ;
01580                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a602a416">TargetDeviceRelation</a>:
01581                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(TargetDeviceRelation)"</span>) ;
01582                              <span class="keywordflow">break</span> ;
01583                          <span class="keywordflow">default</span>:
01584                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01585                              <span class="keywordflow">break</span> ;
01586                      }
01587                      <span class="keywordflow">break</span> ;
01588                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a73">IRP_MN_QUERY_INTERFACE</a>:
01589                      <span class="keywordflow">break</span> ;
01590                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a77">IRP_MN_QUERY_DEVICE_TEXT</a>:
01591                      <span class="keywordflow">switch</span>(IrpSp-&gt;Parameters.QueryId.IdType) {
01592                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a605a426">DeviceTextDescription</a>:
01593                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceTextDescription)"</span>) ;
01594                              <span class="keywordflow">break</span> ;
01595                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a605a427">DeviceTextLocationInformation</a>:
01596                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceTextLocationInformation)"</span>) ;
01597                              <span class="keywordflow">break</span> ;
01598                          <span class="keywordflow">default</span>:
01599                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01600                              <span class="keywordflow">break</span> ;
01601                      }
01602                      <span class="keywordflow">break</span> ;
01603                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a80">IRP_MN_WRITE_CONFIG</a>:
01604                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a79">IRP_MN_READ_CONFIG</a>:
01605                      <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(WhichSpace=%x, Buffer=%x, Offset=%x, Length=%x)"</span>,
01606                          IrpSp-&gt;Parameters.ReadWriteConfig.WhichSpace,
01607                          IrpSp-&gt;Parameters.ReadWriteConfig.Buffer,
01608                          IrpSp-&gt;Parameters.ReadWriteConfig.Offset,
01609                          IrpSp-&gt;Parameters.ReadWriteConfig.Length
01610                          ) ;
01611                      <span class="keywordflow">break</span> ;
01612                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a82">IRP_MN_SET_LOCK</a>:
01613                      <span class="keywordflow">if</span> (IrpSp-&gt;Parameters.SetLock.Lock) <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(True)"</span>) ;
01614                      <span class="keywordflow">else</span> <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(False)"</span>) ;
01615                      <span class="keywordflow">break</span> ;
01616                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a83">IRP_MN_QUERY_ID</a>:
01617                      <span class="keywordflow">switch</span>(IrpSp-&gt;Parameters.QueryId.IdType) {
01618                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a604a421">BusQueryDeviceID</a>:
01619                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(BusQueryDeviceID)"</span>) ;
01620                              <span class="keywordflow">break</span> ;
01621                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a604a422">BusQueryHardwareIDs</a>:
01622                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(BusQueryHardwareIDs)"</span>) ;
01623                              <span class="keywordflow">break</span> ;
01624                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a604a423">BusQueryCompatibleIDs</a>:
01625                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(BusQueryCompatibleIDs)"</span>) ;
01626                              <span class="keywordflow">break</span> ;
01627                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a604a424">BusQueryInstanceID</a>:
01628                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(BusQueryInstanceID)"</span>) ;
01629                              <span class="keywordflow">break</span> ;
01630                          <span class="keywordflow">default</span>:
01631                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01632                              <span class="keywordflow">break</span> ;
01633                      }
01634                      <span class="keywordflow">break</span> ;
01635                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a85">IRP_MN_QUERY_BUS_INFORMATION</a>:
01636                      <span class="comment">// BUGBUG: Should print out</span>
01637                      <span class="keywordflow">break</span> ;
01638                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a86">IRP_MN_DEVICE_USAGE_NOTIFICATION</a>:
01639                      <span class="keywordflow">switch</span>(IrpSp-&gt;Parameters.UsageNotification.Type) {
01640                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a603a417">DeviceUsageTypeUndefined</a>:
01641                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceUsageTypeUndefined"</span>) ;
01642                              <span class="keywordflow">break</span> ;
01643                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a603a418">DeviceUsageTypePaging</a>:
01644                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceUsageTypePaging"</span>) ;
01645                              <span class="keywordflow">break</span> ;
01646                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a603a419">DeviceUsageTypeHibernation</a>:
01647                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceUsageTypeHibernation"</span>) ;
01648                              <span class="keywordflow">break</span> ;
01649                          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a603a420">DeviceUsageTypeDumpFile</a>:
01650                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(DeviceUsageTypeDumpFile"</span>) ;
01651                              <span class="keywordflow">break</span> ;
01652                          <span class="keywordflow">default</span>:
01653                              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01654                              <span class="keywordflow">break</span> ;
01655                      }
01656                      <span class="keywordflow">if</span> (IrpSp-&gt;Parameters.UsageNotification.InPath) {
01657                          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">", InPath=TRUE)"</span>) ;
01658                      } <span class="keywordflow">else</span> {
01659                          <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">", InPath=FALSE)"</span>) ;
01660                      }
01661                      <span class="keywordflow">break</span> ;
01662                  <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a88">IRP_MN_QUERY_LEGACY_BUS_INFORMATION</a>:
01663                      <span class="comment">// BUGBUG: Should print out</span>
01664                      <span class="keywordflow">break</span> ;
01665                  <span class="keywordflow">default</span>:
01666                      <span class="keywordflow">break</span> ;
01667              }
01668              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>) ;
01669              <span class="keywordflow">break</span> ;
01670 
01671          <span class="keywordflow">case</span> <a class="code" href="../../d0/d5/io_8h.html#a35">IRP_MJ_POWER</a>:
01672              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"."</span>) ;
01673              <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction&lt;=<a class="code" href="../../d1/d5/ioassert_8c.html#a3">MAX_NAMED_POWER_IRP</a>) {
01674 
01675                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(PowerIrpNames[IrpSp-&gt;MinorFunction]) ;
01676              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IrpSp-&gt;MinorFunction==0xFF) {
01677 
01678                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"IRP_MN_BOGUS"</span>) ;
01679              } <span class="keywordflow">else</span> {
01680                  <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"(Bogus)\n"</span>) ;
01681              }
01682              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>) ;
01683              <span class="keywordflow">break</span> ;
01684 
01685          <span class="keywordflow">default</span>:
01686              <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>) ;
01687              <span class="keywordflow">break</span> ;
01688     }
01689 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ioassert.c::IopDriverCorrectnessPrintParamData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessPrintParamData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DcCheckData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01151">1151</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01370">IopDriverCorrectnessPrintIrp()</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>01154 {
01155     <span class="keywordflow">if</span> (DcCheckData-&gt;DcParamArray[0]) {
01156 
01157         <a class="code" href="../../d2/d5/ioassert_8h.html#a109">IopDriverCorrectnessPrintIrp</a>((<a class="code" href="../../d0/d2/struct__IRP.html">PIRP</a>) DcCheckData-&gt;DcParamArray[0]);
01158     }
01159 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ioassert.c::IopDriverCorrectnessProcessMessageText" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS IopDriverCorrectnessProcessMessageText           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MaxOutputBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DcCheckData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00842">842</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00067">DcParamTable</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00123">IopDcMessageTable</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00078">_DCERROR_MESSAGE::MessageText</a>, and <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>00847 {
00848     ULONG paramType, maxParameterTypes;
00849     ULONG arrayIndex, paramLength;
00850     PSTR messageHead, newMessage;
00851     LONG charsRemaining, length;
00852 
00853     <span class="comment">//</span>
00854     <span class="comment">// Get the message text.</span>
00855     <span class="comment">//</span>
00856     messageHead = <a class="code" href="../../d1/d5/ioassert_8c.html#a18">IopDcMessageTable</a>[DcCheckData-&gt;TableIndex].<a class="code" href="../../d7/d1/struct__DCERROR__MESSAGE.html#o2">MessageText</a>;
00857 
00858     <span class="comment">//</span>
00859     <span class="comment">// Now manually build out the message.</span>
00860     <span class="comment">//</span>
00861     newMessage = OutputBuffer;
00862     charsRemaining = (MaxOutputBufferSize/<span class="keyword">sizeof</span>(UCHAR))-1;
00863     maxParameterTypes = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a>)/<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html">DCPARAM_TYPE_ENTRY</a>);
00864 
00865     <span class="keywordflow">while</span>(*messageHead != <span class="charliteral">'\0'</span>) {
00866 
00867         <span class="keywordflow">if</span> (charsRemaining &lt;= 0) {
00868 
00869             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00870         }
00871 
00872         <span class="keywordflow">if</span> (*messageHead != <span class="charliteral">'%'</span>) {
00873 
00874             *newMessage = *messageHead;
00875             newMessage++;
00876             messageHead++;
00877             charsRemaining--;
00878 
00879         } <span class="keywordflow">else</span> {
00880 
00881             <span class="keywordflow">for</span>(paramType = 0; paramType &lt; maxParameterTypes; paramType++) {
00882 
00883                 paramLength = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(DcParamTable[paramType].DcParamName);
00884 
00885                 <span class="comment">//</span>
00886                 <span class="comment">// Do we have a match?</span>
00887                 <span class="comment">//</span>
00888                 <span class="comment">// N.B. - We don't do any case 'de-sensitizing' anywhere, so</span>
00889                 <span class="comment">//        everything's cases must match!</span>
00890                 <span class="comment">//</span>
00891                 <span class="keywordflow">if</span> (RtlCompareMemory(
00892                     messageHead+1,
00893                     DcParamTable[paramType].DcParamName,
00894                     paramLength*<span class="keyword">sizeof</span>(UCHAR)) == paramLength*<span class="keyword">sizeof</span>(UCHAR)) {
00895 
00896                     arrayIndex = paramType*3;
00897                     messageHead += (paramLength+1);
00898 
00899                     <span class="comment">//</span>
00900                     <span class="comment">// Was an index passed in (ie, "3rd" irp requested)?</span>
00901                     <span class="comment">//</span>
00902                     <span class="keywordflow">if</span> ((*messageHead &gt;= <span class="charliteral">'1'</span>) &amp;&amp; (*messageHead &lt;= <span class="charliteral">'3'</span>)) {
00903 
00904                         <span class="comment">//</span>
00905                         <span class="comment">// Adjust table index appropriately.</span>
00906                         <span class="comment">//</span>
00907                         arrayIndex += (*messageHead - <span class="charliteral">'1'</span>) ;
00908                         messageHead++;
00909                     }
00910 
00911                     length = _snprintf(
00912                         newMessage,
00913                         charsRemaining+1,
00914                         <span class="stringliteral">"%p"</span>,
00915                         DcCheckData-&gt;DcParamArray[arrayIndex]
00916                         );
00917 
00918                     <span class="keywordflow">if</span> (length == -1) {
00919 
00920                         <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00921                     }
00922 
00923                     charsRemaining -= length;
00924                     newMessage += length;
00925                     <span class="keywordflow">break</span>;
00926                 }
00927             }
00928 
00929             <span class="keywordflow">if</span> (paramType == maxParameterTypes) {
00930 
00931                 <span class="comment">//</span>
00932                 <span class="comment">// Either the message we looked up is malformed, we don't recognize</span>
00933                 <span class="comment">// the %thing it is talking about, or this is %%!</span>
00934                 <span class="comment">//</span>
00935                 *newMessage = *messageHead;
00936                 messageHead++;
00937                 newMessage++;
00938                 charsRemaining--;
00939 
00940                 <span class="keywordflow">if</span> (*messageHead == <span class="charliteral">'%'</span>) {
00941 
00942                     messageHead++;
00943                 }
00944             }
00945         }
00946     }
00947 
00948     <span class="comment">//</span>
00949     <span class="comment">// Null-terminate it (we have room because we took one off the buffer size</span>
00950     <span class="comment">// above).</span>
00951     <span class="comment">//</span>
00952     *newMessage = <span class="charliteral">'\0'</span>;
00953 
00954     DcCheckData-&gt;ClassText = DcCheckData-&gt;AssertionClass-&gt;MessageClassText;
00955     DcCheckData-&gt;AssertionText = OutputBuffer;
00956     <span class="keywordflow">return</span> STATUS_SUCCESS;
00957 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ioassert.c::IopDriverCorrectnessProcessParams" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessProcessParams           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PULONG Control&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>StackFramesToSkip</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d5/ioassert_8h.html#a31">DCERROR_ID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageParameterMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN va_list *&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageParameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>DcParamArray</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DcCheckData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">599</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d5/ioassert_8h.html#a114a39">DCERROR_UNSPECIFIED</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00194">_DCPARAM_TYPE_ENTRY::DcParamMask</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00067">DcParamTable</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00123">IopDcMessageTable</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00347">IopDcOverrideTable</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01254">IopDriverCorrectnessAddressToFileHeader()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00160">KeBugCheckUnicodeToAnsi()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00077">_DCERROR_MESSAGE::MessageClass</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00338">_DC_OVERRIDE_TABLE::MessageID</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03883">MmIsAddressValid()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d5/ioassert_8h.html#a38">PDC_CHECK_DATA</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00340">_DC_OVERRIDE_TABLE::ReplacementClass</a>, <a class="el" href="../../d6/d1/ppc_2getcalr_8c-source.html#l00181">RtlCaptureStackBackTrace()</a>, <a class="el" href="../../d9/d8/imagedir_8c-source.html#l00029">RtlImageNtHeader()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>00608 {
00609     PVOID returnAddress[1];
00610     PVOID baseOfImage, culpritAddress;
00611     ULONG stackHash;
00612     PLDR_DATA_TABLE_ENTRY dataTableEntry;
00613     PIMAGE_NT_HEADERS ntHeaders;
00614     ULONG i, currentMessageMask, paramType, maxParameterTypes, paramMask;
00615     ULONG tableIndex;
00616     <span class="keywordtype">char</span> ansiDriverName[81];
00617 
00618     tableIndex = MessageID - <a class="code" href="../../d2/d5/ioassert_8h.html#a114a39">DCERROR_UNSPECIFIED</a>;
00619 
00620     <span class="comment">//</span>
00621     <span class="comment">// Retrieve a pointer to the appropriate message text.</span>
00622     <span class="comment">//</span>
00623     <span class="keywordflow">if</span> (tableIndex &gt;= <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d5/ioassert_8c.html#a18">IopDcMessageTable</a>)/<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d1/struct__DCERROR__MESSAGE.html">DCERROR_MESSAGE</a>)) {
00624 
00625         <span class="comment">//</span>
00626         <span class="comment">// Bogus message index!</span>
00627         <span class="comment">//</span>
00628         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(0);
00629         tableIndex = 0;
00630     }
00631 
00632     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(IopDcMessageTable[tableIndex].MessageID == MessageID);
00633 
00634     <span class="comment">//</span>
00635     <span class="comment">// OK, we're going to do *something*. Process the incoming parameters.</span>
00636     <span class="comment">//</span>
00637     maxParameterTypes = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a>)/<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html">DCPARAM_TYPE_ENTRY</a>);
00638 
00639     <span class="comment">//</span>
00640     <span class="comment">// First we grab parameter off the stack and slot them appropriately into</span>
00641     <span class="comment">// our array of "things".</span>
00642     <span class="comment">//</span>
00643     <span class="comment">// The array is in groups of three for each possible member of a given type</span>
00644     <span class="comment">// (three irps, three routines, three device objects, etc). Items not</span>
00645     <span class="comment">// referenced in are set to NULL.</span>
00646     <span class="comment">//</span>
00647     currentMessageMask = MessageParameterMask;
00648 
00649     <span class="keywordflow">for</span>(paramType = 0; paramType &lt; maxParameterTypes; paramType++) {
00650 
00651         paramMask = <a class="code" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a>[paramType].<a class="code" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html#o0">DcParamMask</a> ;
00652         <span class="keywordflow">for</span>(i=0; i&lt;3; i++) {
00653 
00654             <span class="keywordflow">if</span> (currentMessageMask&amp;(paramMask*3)) {
00655 
00656                 currentMessageMask -= paramMask;
00657                 DcParamArray[paramType*3+i] = va_arg(*MessageParameters, PVOID);
00658 
00659             } <span class="keywordflow">else</span> {
00660 
00661                 DcParamArray[paramType*3+i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00662             }
00663         }
00664     }
00665 
00666     <span class="comment">//</span>
00667     <span class="comment">// If this fires, part of the MessageParameterMask was not understood,</span>
00668     <span class="comment">// probably a bug by the caller!</span>
00669     <span class="comment">//</span>
00670     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(currentMessageMask == 0);
00671 
00672     <span class="comment">//</span>
00673     <span class="comment">// Pre-init unhelpful answers...</span>
00674     <span class="comment">//</span>
00675     culpritAddress = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00676     DcCheckData-&gt;OffsetIntoImage = 0;
00677     DcCheckData-&gt;InVerifierList = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00678     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;DcCheckData-&gt;DriverName, NULL);
00679 
00680     <span class="comment">//</span>
00681     <span class="comment">// Blame caller if appropriate</span>
00682     <span class="comment">//</span>
00683     <span class="keywordflow">if</span> (StackFramesToSkip != -1) {
00684 
00685         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/ppc_2getcalr_8c.html#a1">RtlCaptureStackBackTrace</a>(StackFramesToSkip+2, 1, returnAddress,
00686            &amp;stackHash)==1) {
00687 
00688             culpritAddress = returnAddress[0];
00689         }
00690 
00691     } <span class="keywordflow">else</span> {
00692 
00693         <span class="comment">//</span>
00694         <span class="comment">// %Routine1</span>
00695         <span class="comment">//</span>
00696         culpritAddress = DcParamArray[3];
00697     }
00698 
00699     <span class="comment">//</span>
00700     <span class="comment">// Extract the culprit's name if possible...</span>
00701     <span class="comment">//</span>
00702     <span class="keywordflow">if</span> (culpritAddress) {
00703 
00704         baseOfImage = <a class="code" href="../../d2/d5/ioassert_8h.html#a112">IopDriverCorrectnessAddressToFileHeader</a>(
00705             (PVOID) culpritAddress,
00706             &amp;dataTableEntry
00707             );
00708 
00709         <span class="keywordflow">if</span> (baseOfImage != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00710 
00711             <span class="comment">//</span>
00712             <span class="comment">// If we found a match, drill into the dataTableEntry's to get</span>
00713             <span class="comment">//</span>
00714             <span class="comment">//</span>
00715             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a>(dataTableEntry-&gt;DllBase) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00716 
00717                 ntHeaders = <a class="code" href="../../d8/d9/imagedir_8c.html#a0">RtlImageNtHeader</a>(dataTableEntry-&gt;DllBase);
00718 
00719                 RtlCopyMemory(
00720                     &amp;DcCheckData-&gt;DriverName,
00721                     &amp;dataTableEntry-&gt;BaseDllName,
00722                     <span class="keyword">sizeof</span>(UNICODE_STRING)
00723                     );
00724 
00725                 DcCheckData-&gt;OffsetIntoImage = (PUCHAR) culpritAddress - (PUCHAR) baseOfImage;
00726             }
00727 
00728             <span class="comment">//</span>
00729             <span class="comment">// Now record whether this is in the verifying table.</span>
00730             <span class="comment">//</span>
00731             <span class="keywordflow">if</span> (!(dataTableEntry-&gt;Flags &amp; LDRP_IMAGE_VERIFYING)) {
00732 
00733                 DcCheckData-&gt;InVerifierList = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00734             }
00735         }
00736     }
00737 
00738     DcCheckData-&gt;CulpritAddress = culpritAddress;
00739     DcCheckData-&gt;DcParamArray = DcParamArray;
00740     DcCheckData-&gt;TableIndex = tableIndex;
00741     DcCheckData-&gt;MessageID = MessageID;
00742     DcCheckData-&gt;Control = Control;
00743     DcCheckData-&gt;AssertionClass = <a class="code" href="../../d1/d5/ioassert_8c.html#a18">IopDcMessageTable</a>[DcCheckData-&gt;TableIndex].<a class="code" href="../../d7/d1/struct__DCERROR__MESSAGE.html#o1">MessageClass</a>;
00744 
00745     <span class="comment">//</span>
00746     <span class="comment">// Get an ANSI version of the driver name and root through the override</span>
00747     <span class="comment">// table.</span>
00748     <span class="comment">//</span>
00749     <a class="code" href="../../d9/d1/bugcheck_8c.html#a15">KeBugCheckUnicodeToAnsi</a>(
00750         &amp;DcCheckData-&gt;DriverName,
00751         ansiDriverName,
00752         <span class="keyword">sizeof</span>(ansiDriverName)
00753         );
00754 
00755     <span class="keywordflow">for</span>(i=0; i&lt;<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a>)/<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">DC_OVERRIDE_TABLE</a>); i++) {
00756 
00757         <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a>[i].<a class="code" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html#o0">MessageID</a> == MessageID) ||
00758            (<a class="code" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a>[i].<a class="code" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html#o0">MessageID</a> == <a class="code" href="../../d2/d5/ioassert_8h.html#a114a39">DCERROR_UNSPECIFIED</a>)) {
00759 
00760             <span class="keywordflow">if</span> (!_stricmp(ansiDriverName, IopDcOverrideTable[i].DriverName)) {
00761 
00762                 <span class="comment">//</span>
00763                 <span class="comment">// We have a match, override the error class. Note that as</span>
00764                 <span class="comment">// Control is not per-driver, but per assert, we null out</span>
00765                 <span class="comment">// the passed in Control so that we don't apply this override</span>
00766                 <span class="comment">// policy against every driver!</span>
00767                 <span class="comment">//</span>
00768                 DcCheckData-&gt;Control = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00769                 DcCheckData-&gt;AssertionClass = <a class="code" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a>[i].<a class="code" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html#o2">ReplacementClass</a>;
00770             }
00771         }
00772     }
00773 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ioassert.c::IopDriverCorrectnessPrompt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessPrompt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DcCheckData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ExitAssertion</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01162">1162</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d1/d4/rtl_2debug_8c-source.html#l00241">DbgPrompt()</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00123">DIAG_BEEP</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00125">DIAG_CLEARED</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00124">DIAG_ZAPPED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00057">IopDcControlOverride</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>01166 {
01167     <span class="keywordtype">char</span> response[2];
01168     ULONG assertionControl;
01169     BOOLEAN waitForInput;
01170 
01171     assertionControl = DcCheckData-&gt;AssertionControl;
01172 
01173     *ExitAssertion = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01174 
01175     <span class="comment">//</span>
01176     <span class="comment">// Vocalize if so ordered.</span>
01177     <span class="comment">//</span>
01178     <span class="keywordflow">if</span> (assertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a1">DIAG_BEEP</a>) {
01179 
01180         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%c"</span>, 7);
01181     }
01182 
01183     <span class="keywordflow">if</span> (assertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a2">DIAG_ZAPPED</a>) {
01184 
01185         <span class="keywordflow">return</span>;
01186     }
01187 
01188     <span class="comment">//</span>
01189     <span class="comment">// Wait for input...</span>
01190     <span class="comment">//</span>
01191     waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01192     <span class="keywordflow">while</span>(waitForInput) {
01193 
01194         <span class="keywordflow">if</span> (DcCheckData-&gt;Control) {
01195 
01196             <a class="code" href="../../d0/d5/rtl_2debug_8c.html#a3">DbgPrompt</a>( <span class="stringliteral">"Break, Ignore, Zap, Remove, Disable all (bizrd)? "</span>, response, <span class="keyword">sizeof</span>( response ));
01197         } <span class="keywordflow">else</span> {
01198 
01199             <a class="code" href="../../d0/d5/rtl_2debug_8c.html#a3">DbgPrompt</a>( <span class="stringliteral">"Break, Ignore, Disable all (bid)? "</span>, response, <span class="keyword">sizeof</span>( response ));
01200         }
01201 
01202         <span class="keywordflow">switch</span> (response[0]) {
01203 
01204             <span class="keywordflow">case</span> <span class="charliteral">'B'</span>:
01205             <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:
01206                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Breaking in... (press g&lt;enter&gt; to return to assert menu)\n"</span>);
01207                 DbgBreakPoint();
01208                 waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01209                 *ExitAssertion = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01210                 <span class="keywordflow">break</span>;
01211 
01212             <span class="keywordflow">case</span> <span class="charliteral">'I'</span>:
01213             <span class="keywordflow">case</span> <span class="charliteral">'i'</span>:
01214                 waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01215                 <span class="keywordflow">break</span>;
01216 
01217             <span class="keywordflow">case</span> <span class="charliteral">'Z'</span>:
01218             <span class="keywordflow">case</span> <span class="charliteral">'z'</span>:
01219                 <span class="keywordflow">if</span> (DcCheckData-&gt;Control) {
01220 
01221                    <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Breakpoint zapped (OS will print text and return)\n"</span>);
01222                    assertionControl |= <a class="code" href="../../d2/d5/ioassert_8h.html#a2">DIAG_ZAPPED</a>;
01223                    assertionControl &amp;=~ DIAG_BEEP;
01224                    waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01225                 }
01226                 <span class="keywordflow">break</span>;
01227 
01228             <span class="keywordflow">case</span> <span class="charliteral">'D'</span>:
01229             <span class="keywordflow">case</span> <span class="charliteral">'d'</span>:
01230                 <a class="code" href="../../d1/d5/ioassert_8c.html#a9">IopDcControlOverride</a> = <a class="code" href="../../d2/d5/ioassert_8h.html#a3">DIAG_CLEARED</a>;
01231                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Verification asserts disabled.\n"</span>);
01232                 <span class="comment">//assertionControl |= DIAG_CLEARED;</span>
01233                 waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01234                 <span class="keywordflow">break</span>;
01235 
01236             <span class="keywordflow">case</span> <span class="charliteral">'R'</span>:
01237             <span class="keywordflow">case</span> <span class="charliteral">'r'</span>:
01238                 <span class="keywordflow">if</span> (DcCheckData-&gt;Control) {
01239 
01240                    <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Breakpoint removed\n"</span>) ;
01241                    assertionControl |= <a class="code" href="../../d2/d5/ioassert_8h.html#a3">DIAG_CLEARED</a>;
01242                    waitForInput = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01243                 }
01244                 <span class="keywordflow">break</span>;
01245         }
01246     }
01247 
01248     <span class="keywordflow">if</span> (DcCheckData-&gt;Control) {
01249         *DcCheckData-&gt;Control = assertionControl;
01250     }
01251 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ioassert.c::IopDriverCorrectnessReleaseLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessReleaseLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00446">446</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00052">IopDcControlCurrent</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00054">IopDcControlIrql</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00055">IopDcControlLock</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00053">IopDcCurrentFrameSkips</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00451               :
00452 
00453       Worker routine <span class="keywordflow">for</span> KD_ASSERT_OUT, see IopDiagSetAssertLock
00454 
00455 --*/
00456 {
00457     <a class="code" href="../../d1/d5/ioassert_8c.html#a4">IopDcControlCurrent</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ;
00458     <a class="code" href="../../d1/d5/ioassert_8c.html#a5">IopDcCurrentFrameSkips</a> = -1 ;
00459     ExReleaseSpinLock( &amp;IopDcControlLock, IopDcControlIrql );
00460 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ioassert.c::IopDriverCorrectnessTakeLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessTakeLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ControlNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>StackFramesToSkip</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00423">423</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00052">IopDcControlCurrent</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00054">IopDcControlIrql</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00055">IopDcControlLock</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00053">IopDcCurrentFrameSkips</a>, <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00049">IovpInitCalled</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00091">IoVerifierInit()</a>.
<p>
<pre class="fragment"><div>00429               :
00430 
00431       Worker routine <span class="keywordflow">for</span> KD_ASSERT_OUT, takes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> assertion spinlock. We <span class="keywordflow">do</span>
00432       <span class="keyword">this</span> because we *must* use a macro to instantiate a caller-specific
00433       tag and we cannot pass in that value along with a variable printf style
00434       debug output. Hence we must <span class="stringliteral">"pre-program"</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> output routine with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00435       breakpoint <a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>, and use a spinlock to protect ourselves
00436 --*/
00437 {
00438     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(IovpInitCalled);
00439     ExAcquireSpinLock( &amp;IopDcControlLock, &amp;IopDcControlIrql );
00440     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(IopDcControlCurrent == NULL) ;
00441     <a class="code" href="../../d1/d5/ioassert_8c.html#a4">IopDcControlCurrent</a> = ControlNew ;
00442     <a class="code" href="../../d1/d5/ioassert_8c.html#a5">IopDcCurrentFrameSkips</a> = StackFramesToSkip ;
00443 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ioassert.c::IopDriverCorrectnessThrowBugCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID IopDriverCorrectnessThrowBugCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d0/struct__DC__CHECK__DATA.html">PDC_CHECK_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DcCheckData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00960">960</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d3/d4/ioassert_8h-source.html#l00126">DIAG_FATAL_ERROR</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00134">KdDebuggerEnabled</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00160">KeBugCheckUnicodeToAnsi()</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>.
<p>
<pre class="fragment"><div>00963 {
00964     PVOID parameterArray[4];
00965     <span class="keywordtype">char</span> captionBuffer[256];
00966     <span class="keywordtype">char</span> ansiDriverName[81];
00967     UNICODE_STRING unicodeString;
00968 
00969     <span class="comment">//</span>
00970     <span class="comment">// Do not bugcheck if a kernel debugger is attached, nor if this isn't a</span>
00971     <span class="comment">// fatal error.</span>
00972     <span class="comment">//</span>
00973     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> || (!(DcCheckData-&gt;AssertionControl&amp;<a class="code" href="../../d2/d5/ioassert_8h.html#a4">DIAG_FATAL_ERROR</a>))) {
00974 
00975         <span class="keywordflow">return</span>;
00976     }
00977 
00978     <span class="comment">//</span>
00979     <span class="comment">// We are here because DIAG_FATAL_ERROR is set. We use</span>
00980     <span class="comment">// FATAL_UNHANDLED_HARD_ERROR so that we can give a</span>
00981     <span class="comment">// descriptive text string for the problem.</span>
00982     <span class="comment">//</span>
00983     parameterArray[0] = (PVOID) DcCheckData-&gt;MessageID;
00984     parameterArray[1] = DcCheckData-&gt;CulpritAddress;
00985     parameterArray[2] = DcCheckData-&gt;DcParamArray[0];
00986     parameterArray[3] = DcCheckData-&gt;DcParamArray[6];
00987 
00988     <a class="code" href="../../d9/d1/bugcheck_8c.html#a15">KeBugCheckUnicodeToAnsi</a>(
00989         &amp;DcCheckData-&gt;DriverName,
00990         ansiDriverName,
00991         <span class="keyword">sizeof</span>(ansiDriverName)
00992         );
00993 
00994     _snprintf(
00995         captionBuffer,
00996         <span class="keyword">sizeof</span>(captionBuffer),
00997         <span class="stringliteral">"IO SYSTEM VERIFICATION ERROR in %s (%s %x)\n[%s+%x at %p]\n"</span>,
00998         ansiDriverName,
00999         DcCheckData-&gt;ClassText,
01000         DcCheckData-&gt;MessageID,
01001         ansiDriverName,
01002         DcCheckData-&gt;OffsetIntoImage,
01003         DcCheckData-&gt;CulpritAddress
01004         );
01005 
01006     <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(
01007         FATAL_UNHANDLED_HARD_ERROR,
01008         DRIVER_VERIFIER_IOMANAGER_VIOLATION,
01009         (ULONG_PTR) parameterArray,
01010         (ULONG_PTR) captionBuffer,
01011         (ULONG_PTR) <span class="stringliteral">""</span> <span class="comment">// DcCheckData-&gt;AssertionText is too technical</span>
01012         );
01013 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ioassert.c::IopIsMemoryRangeReadable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN IopIsMemoryRangeReadable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Location</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01320">1320</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03883">MmIsAddressValid()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01370">IopDriverCorrectnessPrintIrp()</a>, <a class="el" href="../../d8/d3/flunkirp_8c-source.html#l00191">IovpAssertNewRequest()</a>, and <a class="el" href="../../d6/d6/sessnirp_8c-source.html#l00314">IovpSessionDataAttachSurrogate()</a>.
<p>
<pre class="fragment"><div>01324 {
01325    <span class="keywordflow">while</span> (((ULONG_PTR)Location &amp; (<span class="keyword">sizeof</span>(ULONG_PTR)-1)) &amp;&amp; (Length &gt; 0)) {
01326 
01327         <span class="comment">//</span>
01328         <span class="comment">// Check to determine if the move will succeed before actually performing</span>
01329         <span class="comment">// the operation.</span>
01330         <span class="comment">//</span>
01331         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a>(Location)==<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01332             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> ;
01333         }
01334 
01335         ((PCHAR) Location)++ ;
01336         Length-- ;
01337     }
01338 
01339     <span class="keywordflow">while</span> (Length &gt; (<span class="keyword">sizeof</span>(ULONG_PTR)-1)) {
01340 
01341         <span class="comment">//</span>
01342         <span class="comment">// Check to determine if the move will succeed before actually performing</span>
01343         <span class="comment">// the operation.</span>
01344         <span class="comment">//</span>
01345         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a>(Location)==<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01346             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> ;
01347         }
01348         ((PCHAR) Location) += <span class="keyword">sizeof</span>(ULONG_PTR);
01349         Length -= <span class="keyword">sizeof</span>(ULONG_PTR);
01350 
01351     }
01352 
01353     <span class="keywordflow">while</span> (Length &gt; 0) {
01354 
01355         <span class="comment">//</span>
01356         <span class="comment">// Check to determine if the move will succeed before actually performing</span>
01357         <span class="comment">// the operation.</span>
01358         <span class="comment">//</span>
01359         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d2/pagfault_8c.html#a26">MmIsAddressValid</a>(Location)==<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01360             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01361         }
01362 
01363         ((PCHAR) Location)++ ;
01364         Length-- ;
01365     }
01366     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> ;
01367 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ioassert.c::KeBugCheckUnicodeToAnsi" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR KeBugCheckUnicodeToAnsi           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>UnicodeString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>AnsiBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MaxAnsiLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00160">160</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01016">IopDriverCorrectnessPrintBuffer()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00960">IopDriverCorrectnessThrowBugCheck()</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>.
<p>
<pre class="fragment"><div>00165 {
00166     PCHAR Dst;
00167     PWSTR Src;
00168     ULONG Length;
00169 
00170     Length = UnicodeString-&gt;Length / <span class="keyword">sizeof</span>( WCHAR );
00171     <span class="keywordflow">if</span> (Length &gt;= MaxAnsiLength) {
00172         Length = MaxAnsiLength - 1;
00173         }
00174     Src = UnicodeString-&gt;Buffer;
00175     Dst = AnsiBuffer;
00176     <span class="keywordflow">while</span> (Length--) {
00177         *Dst++ = (UCHAR)*Src++;
00178         }
00179     *Dst = <span class="charliteral">'\0'</span>;
00180     <span class="keywordflow">return</span> AnsiBuffer;
00181 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a10" doxytag="ioassert.c::DcParamTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d1/struct__DCPARAM__TYPE__ENTRY.html">DCPARAM_TYPE_ENTRY</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a10">DcParamTable</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a7">DCPARAM_IRP</a>,     <span class="stringliteral">"Irp"</span>     },
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a8">DCPARAM_ROUTINE</a>, <span class="stringliteral">"Routine"</span> },
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a9">DCPARAM_DEVOBJ</a>,  <span class="stringliteral">"DevObj"</span>  },
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a10">DCPARAM_STATUS</a>,  <span class="stringliteral">"Status"</span>  }
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00067">67</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00842">IopDriverCorrectnessProcessMessageText()</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ioassert.c::IopDcControlCurrent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PULONG <a class="el" href="../../d1/d5/ioassert_8c.html#a4">IopDcControlCurrent</a> = NULL          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00052">52</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00446">IopDriverCorrectnessReleaseLock()</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00423">IopDriverCorrectnessTakeLock()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ioassert.c::IopDcControlInitial" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d5/ioassert_8h.html#a28">IopDcControlInitial</a> = (ULONG) -1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00056">56</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00776">IopDriverCorrectnessApplyControl()</a>, and <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00091">IoVerifierInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ioassert.c::IopDcControlIrql" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KIRQL <a class="el" href="../../d1/d5/ioassert_8c.html#a6">IopDcControlIrql</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00054">54</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00446">IopDriverCorrectnessReleaseLock()</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00423">IopDriverCorrectnessTakeLock()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ioassert.c::IopDcControlLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d2/d5/ioassert_8h.html#a30">IopDcControlLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00055">55</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00446">IopDriverCorrectnessReleaseLock()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00423">IopDriverCorrectnessTakeLock()</a>, and <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00091">IoVerifierInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ioassert.c::IopDcControlOverride" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d5/ioassert_8h.html#a29">IopDcControlOverride</a> = (ULONG) -1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00057">57</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00776">IopDriverCorrectnessApplyControl()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01162">IopDriverCorrectnessPrompt()</a>, and <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00091">IoVerifierInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ioassert.c::IopDcCurrentFrameSkips" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d1/d5/ioassert_8c.html#a5">IopDcCurrentFrameSkips</a> = -1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00053">53</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00463">IopDriverCorrectnessCheckUnderLock()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00446">IopDriverCorrectnessReleaseLock()</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00423">IopDriverCorrectnessTakeLock()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ioassert.c::IopDcMessageTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d1/struct__DCERROR__MESSAGE.html">DCERROR_MESSAGE</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a18">IopDcMessageTable</a>[DCERROR_MAXIMUM-DCERROR_UNSPECIFIED]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00123">123</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00842">IopDriverCorrectnessProcessMessageText()</a>, and <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ioassert.c::IopDcOverrideTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d0/struct__DC__OVERRIDE__TABLE.html">DC_OVERRIDE_TABLE</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a21">IopDcOverrideTable</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00347">347</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00599">IopDriverCorrectnessProcessParams()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ioassert.c::IopDcWdmCoreError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a17">IopDcWdmCoreError</a> = { DIAG_BEEP, "CORE DRIVER ERROR" }          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00114">114</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ioassert.c::IopDcWdmDriverErrorFatal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a13">IopDcWdmDriverErrorFatal</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div>
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a1">DIAG_BEEP</a> | <a class="code" href="../../d2/d5/ioassert_8h.html#a4">DIAG_FATAL_ERROR</a> | <a class="code" href="../../d2/d5/ioassert_8h.html#a5">DIAG_WDM_ERROR</a>, <span class="stringliteral">"WDM DRIVER ERROR"</span> }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00103">103</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ioassert.c::IopDcWdmDriverErrorNonFatal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a14">IopDcWdmDriverErrorNonFatal</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div>
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a1">DIAG_BEEP</a> | <a class="code" href="../../d2/d5/ioassert_8h.html#a5">DIAG_WDM_ERROR</a>, <span class="stringliteral">"WDM DRIVER ERROR"</span> }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00106">106</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ioassert.c::IopDcWdmDriverPostponed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a16">IopDcWdmDriverPostponed</a> = { DIAG_ZAPPED, "POSTPONED WDM DRIVER BUG" }          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00112">112</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ioassert.c::IopDcWdmDriverWarning" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d1/struct__DCERROR__CLASS.html">DCERROR_CLASS</a> <a class="el" href="../../d1/d5/ioassert_8c.html#a15">IopDcWdmDriverWarning</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div>
    { <a class="code" href="../../d2/d5/ioassert_8h.html#a1">DIAG_BEEP</a> | <a class="code" href="../../d2/d5/ioassert_8h.html#a2">DIAG_ZAPPED</a>,    <span class="stringliteral">"WDM DRIVER WARNING"</span> }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00109">109</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ioassert.c::IrpMajorNames" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR <a class="el" href="../../d1/d5/ioassert_8c.html#a22">IrpMajorNames</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01422">1422</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ioassert.c::PnPIrpNames" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR <a class="el" href="../../d1/d5/ioassert_8c.html#a23">PnPIrpNames</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <span class="stringliteral">"IRP_MN_START_DEVICE"</span>,                    
    <span class="stringliteral">"IRP_MN_QUERY_REMOVE_DEVICE"</span>,             
    <span class="stringliteral">"IRP_MN_REMOVE_DEVICE - "</span>,                
    <span class="stringliteral">"IRP_MN_CANCEL_REMOVE_DEVICE"</span>,            
    <span class="stringliteral">"IRP_MN_STOP_DEVICE"</span>,                     
    <span class="stringliteral">"IRP_MN_QUERY_STOP_DEVICE"</span>,               
    <span class="stringliteral">"IRP_MN_CANCEL_STOP_DEVICE"</span>,              
    <span class="stringliteral">"IRP_MN_QUERY_DEVICE_RELATIONS"</span>,          
    <span class="stringliteral">"IRP_MN_QUERY_INTERFACE"</span>,                 
    <span class="stringliteral">"IRP_MN_QUERY_CAPABILITIES"</span>,              
    <span class="stringliteral">"IRP_MN_QUERY_RESOURCES"</span>,                 
    <span class="stringliteral">"IRP_MN_QUERY_RESOURCE_REQUIREMENTS"</span>,     
    <span class="stringliteral">"IRP_MN_QUERY_DEVICE_TEXT"</span>,               
    <span class="stringliteral">"IRP_MN_FILTER_RESOURCE_REQUIREMENTS"</span>,    
    <span class="stringliteral">"INVALID_IRP_CODE"</span>,                       
    <span class="stringliteral">"IRP_MN_READ_CONFIG"</span>,                     
    <span class="stringliteral">"IRP_MN_WRITE_CONFIG"</span>,                    
    <span class="stringliteral">"IRP_MN_EJECT"</span>,                           
    <span class="stringliteral">"IRP_MN_SET_LOCK"</span>,                        
    <span class="stringliteral">"IRP_MN_QUERY_ID"</span>,                        
    <span class="stringliteral">"IRP_MN_QUERY_PNP_DEVICE_STATE"</span>,          
    <span class="stringliteral">"IRP_MN_QUERY_BUS_INFORMATION"</span>,           
    <span class="stringliteral">"IRP_MN_DEVICE_USAGE_NOTIFICATION"</span>,       
    <span class="stringliteral">"IRP_MN_SURPRISE_REMOVAL"</span>,                
    <span class="stringliteral">"IRP_MN_QUERY_LEGACY_BUS_INFORMATION"</span>,    
    <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01457">1457</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ioassert.c::PowerIrpNames" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR <a class="el" href="../../d1/d5/ioassert_8c.html#a25">PowerIrpNames</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <span class="stringliteral">"IRP_MN_WAIT_WAKE"</span>,                       
    <span class="stringliteral">"IRP_MN_POWER_SEQUENCE"</span>,                  
    <span class="stringliteral">"IRP_MN_SET_POWER"</span>,                       
    <span class="stringliteral">"IRP_MN_QUERY_POWER"</span>,                     
    <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01504">1504</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ioassert.c::WmiIrpNames" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCHAR <a class="el" href="../../d1/d5/ioassert_8c.html#a24">WmiIrpNames</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <span class="stringliteral">"IRP_MN_QUERY_ALL_DATA"</span>,                  
    <span class="stringliteral">"IRP_MN_QUERY_SINGLE_INSTANCE"</span>,           
    <span class="stringliteral">"IRP_MN_CHANGE_SINGLE_INSTANCE"</span>,          
    <span class="stringliteral">"IRP_MN_CHANGE_SINGLE_ITEM"</span>,              
    <span class="stringliteral">"IRP_MN_ENABLE_EVENTS"</span>,                   
    <span class="stringliteral">"IRP_MN_DISABLE_EVENTS"</span>,                  
    <span class="stringliteral">"IRP_MN_ENABLE_COLLECTION"</span>,               
    <span class="stringliteral">"IRP_MN_DISABLE_COLLECTION"</span>,              
    <span class="stringliteral">"IRP_MN_REGINFO"</span>,                         
    <span class="stringliteral">"IRP_MN_EXECUTE_METHOD"</span>,                  
    <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01488">1488</a> of file <a class="el" href="../../d2/d4/ioassert_8c-source.html">ioassert.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ioassert_8c-source.html#l01516">IopDriverCorrectnessPrintIrpStack()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:17 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
