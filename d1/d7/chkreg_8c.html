<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: chkreg.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>chkreg.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;memory.h&gt;</code><br>
<code>#include "windows.h"</code><br>

<p>
<a href="../../d2/d6/chkreg_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a0">MSG_ERROR_VALUE_INCORRECT_SIZE</a>&nbsp;&nbsp;&nbsp;"\tERROR: Value entry data has incorrect size \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %s \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueSize = %d\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a1">MSG_ERROR_VALUE_NOT_NUL_TERMINATED</a>&nbsp;&nbsp;&nbsp;"\tERROR: Value entry data <a class="el" href="../../d3/d0/user32_8def.html#a108">is</a> not NUL terminated \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %s\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a2">MSG_ERROR_VALUE_UNKNOWN_DATA</a>&nbsp;&nbsp;&nbsp;"\tERROR: Value entry contains unknown data \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %#x \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueSize = %d\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a3">MSG_ERROR_REG_ENUM_VALUE</a>&nbsp;&nbsp;&nbsp;"\tERROR: RegEnumValue() failed, iValue = %d, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a4">MSG_ERROR_REG_OPEN_KEY_EX</a>&nbsp;&nbsp;&nbsp;"\tERROR: RegOpenKeyEx() failed, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a5">MSG_ERROR_REG_QUERY_INFO_KEY</a>&nbsp;&nbsp;&nbsp;"\tERROR: RegQueryInfoKey() failed, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a6">MSG_ERROR_REG_ENUM_KEY_EX</a>&nbsp;&nbsp;&nbsp;"ERROR: RegEnumKeyEx() failed, \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t, SubKey = %d"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a7">MSG_ERROR_REG_CONNECT_REGISTRY</a>&nbsp;&nbsp;&nbsp;"ERROR: Unable to connect to %s, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a8">MSG_COMPLETE_KEY_NAME</a>&nbsp;&nbsp;&nbsp;"%ls\\%ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a9">ExamineValueEntries</a> (IN HKEY <a class="el" href="../../d3/d0/user32_8def.html#a52">Key</a>, IN LPCWSTR CompleteKeyName, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchMaxValueName, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbMaxValueData, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cValues, IN LPCWSTR PredefinedKeyName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a> (IN HKEY PredefinedKey, IN LPCWSTR ParentName, IN LPCWSTR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a3">KeyName</a>, IN LPCWSTR PredefinedKeyName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/chkreg_8c.html#a11">main</a> (int argc, char *argv[])</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a8" doxytag="chkreg.c::MSG_COMPLETE_KEY_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_COMPLETE_KEY_NAME&nbsp;&nbsp;&nbsp;"%ls\\%ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00014">14</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>, and <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="chkreg.c::MSG_ERROR_REG_CONNECT_REGISTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_REG_CONNECT_REGISTRY&nbsp;&nbsp;&nbsp;"ERROR: Unable to connect to %s, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00013">13</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00425">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="chkreg.c::MSG_ERROR_REG_ENUM_KEY_EX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_REG_ENUM_KEY_EX&nbsp;&nbsp;&nbsp;"ERROR: RegEnumKeyEx() failed, \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t, SubKey = %d"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00012">12</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="chkreg.c::MSG_ERROR_REG_ENUM_VALUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_REG_ENUM_VALUE&nbsp;&nbsp;&nbsp;"\tERROR: RegEnumValue() failed, iValue = %d, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00009">9</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="chkreg.c::MSG_ERROR_REG_OPEN_KEY_EX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_REG_OPEN_KEY_EX&nbsp;&nbsp;&nbsp;"\tERROR: RegOpenKeyEx() failed, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00010">10</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="chkreg.c::MSG_ERROR_REG_QUERY_INFO_KEY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_REG_QUERY_INFO_KEY&nbsp;&nbsp;&nbsp;"\tERROR: RegQueryInfoKey() failed, <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a> = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00011">11</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="chkreg.c::MSG_ERROR_VALUE_INCORRECT_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_VALUE_INCORRECT_SIZE&nbsp;&nbsp;&nbsp;"\tERROR: Value entry data has incorrect size \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %s \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueSize = %d\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00006">6</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="chkreg.c::MSG_ERROR_VALUE_NOT_NUL_TERMINATED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_VALUE_NOT_NUL_TERMINATED&nbsp;&nbsp;&nbsp;"\tERROR: Value entry data <a class="el" href="../../d3/d0/user32_8def.html#a108">is</a> not NUL terminated \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %s\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00007">7</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="chkreg.c::MSG_ERROR_VALUE_UNKNOWN_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MSG_ERROR_VALUE_UNKNOWN_DATA&nbsp;&nbsp;&nbsp;"\tERROR: Value entry contains unknown data \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueName = %ls \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tNameSize  = %d \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueType = %#x \<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>\t\tValueSize = %d\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00008">8</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a10" doxytag="chkreg.c::ExamineKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExamineKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HKEY&nbsp;</td>
          <td class="mdname" nowrap> <em>PredefinedKey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>ParentName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>PredefinedKeyName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">261</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">ExamineValueEntries()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00417">Key</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00059">KeyName</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00014">MSG_COMPLETE_KEY_NAME</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00012">MSG_ERROR_REG_ENUM_KEY_EX</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00010">MSG_ERROR_REG_OPEN_KEY_EX</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00011">MSG_ERROR_REG_QUERY_INFO_KEY</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00425">main()</a>.
<p>
<pre class="fragment"><div>00268 {
00269     LPWSTR      CompleteKeyName;
00270 
00271     HKEY        <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a>;
00272 
00273     LONG        <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00274 
00275     WCHAR       szClass[ <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a> + 1 ];
00276     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cchClass;
00277     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cSubKeys;
00278     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cchMaxSubKey;
00279     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cchMaxClass;
00280     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cValues;
00281     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cchMaxValueName;
00282     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cbMaxValueData;
00283     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cbSecurityDescriptor;
00284     FILETIME    ftLastWriteTime;
00285 
00286     WCHAR       szSubKeyName[ <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a> + 1 ];
00287     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       cchSubKeyNameLength;
00288 
00289     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       iSubKey;
00290     BOOLEAN     KeyNameAlreadyPrinted;
00291 
00292 
00293     <span class="comment">//</span>
00294     <span class="comment">//  Build the complete key name</span>
00295     <span class="comment">//</span>
00296 
00297     <span class="keywordflow">if</span>( wcslen( ParentName ) == 0 ) {
00298         CompleteKeyName = wcsdup( KeyName );
00299         <span class="keywordflow">if</span>( CompleteKeyName == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00300             printf( <span class="stringliteral">"ERROR: wcsdup( KeyName ) failed \n"</span> );
00301             <span class="keywordflow">return</span>;
00302         }
00303     } <span class="keywordflow">else</span> {
00304         CompleteKeyName = wcsdup( ParentName );
00305         <span class="keywordflow">if</span>( CompleteKeyName == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00306             printf( <span class="stringliteral">"ERROR: wcsdup( ParentName ) failed \n"</span> );
00307             <span class="keywordflow">return</span>;
00308         }
00309         <span class="keywordflow">if</span>( wcslen( KeyName ) != 0 ) {
00310             CompleteKeyName = realloc( CompleteKeyName,
00311                                        ( wcslen( CompleteKeyName ) +
00312                                          wcslen( L<span class="stringliteral">"\\"</span> ) +
00313                                          wcslen( KeyName ) + 1 )*<span class="keyword">sizeof</span>( WCHAR ) );
00314             wcscat( CompleteKeyName, L<span class="stringliteral">"\\"</span> );
00315             wcscat( CompleteKeyName, KeyName );
00316         }
00317     }
00318 
00319 <span class="comment">//</span>
00320 <span class="comment">//  For debugging only</span>
00321 <span class="comment">//</span>
00322 <span class="comment">//    printf( "%ls\\%ls \n", PredefinedKeyName, CompleteKeyName );</span>
00323 <span class="comment">//</span>
00324 
00325     <span class="comment">//</span>
00326     <span class="comment">//  Open the key</span>
00327     <span class="comment">//</span>
00328 
00329     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegOpenKeyExW( PredefinedKey,
00330                            CompleteKeyName,
00331                            0,
00332                            MAXIMUM_ALLOWED,
00333                            &amp;Key );
00334 
00335 
00336     <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00337         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00338         printf( MSG_ERROR_REG_OPEN_KEY_EX, Status );
00339         free( CompleteKeyName );
00340         <span class="keywordflow">return</span>;
00341     }
00342 
00343     <span class="comment">//</span>
00344     <span class="comment">//  Determine the number of value entries, the maximum length of a value</span>
00345     <span class="comment">//  entry name, the maximum data size, and the number of subkeys</span>
00346     <span class="comment">//</span>
00347 
00348     cchClass = <span class="keyword">sizeof</span>( szClass ) / <span class="keyword">sizeof</span>( WCHAR );
00349     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegQueryInfoKeyW( Key,
00350                                szClass,
00351                                &amp;cchClass,
00352                                0,
00353                                &amp;cSubKeys,
00354                                &amp;cchMaxSubKey,
00355                                &amp;cchMaxClass,
00356                                &amp;cValues,
00357                                &amp;cchMaxValueName,
00358                                &amp;cbMaxValueData,
00359                                &amp;cbSecurityDescriptor,
00360                                &amp;ftLastWriteTime );
00361 
00362     <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00363         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00364         printf( MSG_ERROR_REG_QUERY_INFO_KEY, Status );
00365         free( CompleteKeyName );
00366         RegCloseKey( Key );
00367         <span class="keywordflow">return</span>;
00368     }
00369 
00370 
00371     <span class="keywordflow">if</span>( cValues != 0 ) {
00372 
00373         <span class="comment">//</span>
00374         <span class="comment">// Examine the value entries</span>
00375         <span class="comment">//</span>
00376 
00377         <a class="code" href="../../d1/d7/chkreg_8c.html#a9">ExamineValueEntries</a>( Key,
00378                             CompleteKeyName,
00379                             cchMaxValueName,
00380                             cbMaxValueData,
00381                             cValues,
00382                             PredefinedKeyName );
00383 
00384     }
00385 
00386     <span class="comment">//</span>
00387     <span class="comment">//  Traverse each subkey</span>
00388     <span class="comment">//</span>
00389     <span class="keywordflow">if</span>( cSubKeys != 0 ) {
00390         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00391         <span class="keywordflow">for</span>( iSubKey = 0; iSubKey &lt; cSubKeys; iSubKey++ ) {
00392             cchSubKeyNameLength = <span class="keyword">sizeof</span>( szSubKeyName )/<span class="keyword">sizeof</span>( WCHAR );
00393             cchClass = <span class="keyword">sizeof</span>( szClass ) / <span class="keyword">sizeof</span>( WCHAR );
00394             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegEnumKeyExW( Key,
00395                                     iSubKey,
00396                                     szSubKeyName,
00397                                     &amp;cchSubKeyNameLength,
00398                                     0,
00399                                     NULL,
00400                                     NULL,
00401                                     &amp;ftLastWriteTime );
00402 
00403             <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00404                 <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00405                     KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00406                     printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00407                 }
00408                 printf( MSG_ERROR_REG_ENUM_KEY_EX, Status, iSubKey );
00409                 <span class="keywordflow">continue</span>;
00410             }
00411             <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( PredefinedKey,
00412                         CompleteKeyName,
00413                         szSubKeyName,
00414                         PredefinedKeyName );
00415         }
00416     }
00417     RegCloseKey( Key );
00418 
00419     free( CompleteKeyName );
00420 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="chkreg.c::ExamineValueEntries" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExamineValueEntries           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HKEY&nbsp;</td>
          <td class="mdname" nowrap> <em>Key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>CompleteKeyName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMaxValueName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbMaxValueData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cValues</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>PredefinedKeyName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00017">17</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00417">Key</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00014">MSG_COMPLETE_KEY_NAME</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00009">MSG_ERROR_REG_ENUM_VALUE</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00006">MSG_ERROR_VALUE_INCORRECT_SIZE</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00007">MSG_ERROR_VALUE_NOT_NUL_TERMINATED</a>, <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00008">MSG_ERROR_VALUE_UNKNOWN_DATA</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00261">ExamineKey()</a>.
<p>
<pre class="fragment"><div>00025 {
00026     LONG    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00027     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   iValue;
00028     LPWSTR  lpszValue;
00029     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   cchValue;
00030     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwType;
00031     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>   lpbData;
00032     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   cbData;
00033     BOOLEAN KeyNameAlreadyPrinted;
00034 
00035     <span class="comment">//</span>
00036     <span class="comment">//  Allocate the buffers for the value name and value data</span>
00037     <span class="comment">//</span>
00038 
00039     lpszValue = ( LPWSTR )malloc( (cchMaxValueName + 1)*<span class="keyword">sizeof</span>( WCHAR ) );
00040     lpbData = ( LPBYTE )malloc( cbMaxValueData );
00041     <span class="keywordflow">if</span>( ( lpszValue == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00042         ( lpbData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ) {
00043         printf( <span class="stringliteral">"ERROR: Unable to allocate memory, cchMaxValueName = %d, cbMaxValuedata = %d \n"</span>,
00044                  cchMaxValueName, cbMaxValueData );
00045         <span class="keywordflow">if</span>( lpszValue != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00046             free( lpszValue );
00047         }
00048         <span class="keywordflow">if</span>( lpbData != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00049             free( lpbData );
00050         }
00051         <span class="keywordflow">return</span>;
00052     }
00053 
00054     <span class="comment">//</span>
00055     <span class="comment">//  Examine all value entries</span>
00056     <span class="comment">//</span>
00057 
00058     KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00059     <span class="keywordflow">for</span>( iValue = 0; iValue &lt; cValues; iValue++ ) {
00060         cchValue = cchMaxValueName + 1;
00061         cbData = cbMaxValueData;
00062         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegEnumValueW( Key,
00063                                 iValue,
00064                                 lpszValue,
00065                                 &amp;cchValue,
00066                                 0,
00067                                 &amp;dwType,
00068                                 lpbData,
00069                                 &amp;cbData );
00070 
00071         <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00072             <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00073                 KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00074                 printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00075             }
00076             printf( MSG_ERROR_REG_ENUM_VALUE, iValue, Status );
00077             <span class="keywordflow">continue</span>;
00078         }
00079 
00080 <span class="comment">//</span>
00081 <span class="comment">//      For debugging only</span>
00082 <span class="comment">//</span>
00083 <span class="comment">//        printf( "\tValueName = %ls \n", lpszValue );</span>
00084 <span class="comment">//</span>
00085 
00086         <span class="keywordflow">switch</span>( dwType ) {
00087 
00088             <span class="keywordflow">case</span> REG_BINARY:
00089 
00090                 <span class="keywordflow">if</span>( cbData == 0 ) {
00091                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00092                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00093                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00094                     }
00095                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00096                             lpszValue, cchValue, <span class="stringliteral">"REG_BINARY"</span>, cbData );
00097                 }
00098                 <span class="keywordflow">break</span>;
00099 
00100             <span class="keywordflow">case</span> REG_DWORD:
00101 
00102                 <span class="keywordflow">if</span>( cbData != <span class="keyword">sizeof</span>( <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ) ) {
00103                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00104                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00105                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00106                     }
00107                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00108                             lpszValue, cchValue, <span class="stringliteral">"REG_DWORD"</span>, cbData );
00109                 }
00110                 <span class="keywordflow">break</span>;
00111 
00112             <span class="keywordflow">case</span> REG_DWORD_BIG_ENDIAN:
00113 
00114                 <span class="keywordflow">if</span>( cbData != <span class="keyword">sizeof</span>( <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ) ) {
00115                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00116                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00117                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00118                     }
00119                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00120                             lpszValue, cchValue, <span class="stringliteral">"REG_DWORD_BIG_ENDIAN"</span>, cbData );
00121                 }
00122                 <span class="keywordflow">break</span>;
00123 
00124             <span class="keywordflow">case</span> REG_EXPAND_SZ:
00125 
00126                 <span class="keywordflow">if</span>( ( cbData != 0 )  &amp;&amp; ( ( cbData % <span class="keyword">sizeof</span>( WCHAR ) ) == 0 )) {
00127                     <span class="keywordflow">if</span>( *( ( PWCHAR )( lpbData + cbData - <span class="keyword">sizeof</span>( WCHAR ) ) ) != ( WCHAR )<span class="charliteral">'\0'</span> ) {
00128                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00129                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00130                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00131                         }
00132                         printf( MSG_ERROR_VALUE_NOT_NUL_TERMINATED,
00133                                 lpszValue, cchValue, <span class="stringliteral">"REG_EXPAND_SZ"</span> );
00134                     }
00135                 } <span class="keywordflow">else</span> {
00136                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00137                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00138                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00139                         }
00140                         printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00141                                 lpszValue, cchValue, <span class="stringliteral">"REG_EXPAND_SZ"</span>, cbData );
00142                 }
00143                 <span class="keywordflow">break</span>;
00144 
00145             <span class="keywordflow">case</span> REG_LINK:
00146 
00147                 <span class="keywordflow">if</span>( cbData == 0 ) {
00148                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00149                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00150                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00151                     }
00152                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00153                             lpszValue, cchValue, <span class="stringliteral">"REG_LINK"</span>, cbData );
00154                 }
00155                 <span class="keywordflow">break</span>;
00156 
00157             <span class="keywordflow">case</span> REG_MULTI_SZ:
00158 
00159                 <span class="keywordflow">if</span>( ( cbData != 0 )  &amp;&amp; ( ( cbData % <span class="keyword">sizeof</span>( WCHAR ) ) == 0 )) {
00160                     <span class="keywordflow">if</span>( *( ( PWCHAR )( lpbData + cbData - <span class="keyword">sizeof</span>( WCHAR ) ) ) != ( WCHAR )<span class="charliteral">'\0'</span> ) {
00161                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00162                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00163                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00164                         }
00165                         printf( MSG_ERROR_VALUE_NOT_NUL_TERMINATED,
00166                                 lpszValue, cchValue, <span class="stringliteral">"REG_MULTI_SZ"</span> );
00167                     }
00168                 } <span class="keywordflow">else</span> {
00169                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00170                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00171                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00172                         }
00173                         printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00174                                 lpszValue, cchValue, <span class="stringliteral">"REG_MULTI_SZ"</span>, cbData );
00175                 }
00176                 <span class="keywordflow">break</span>;
00177 
00178             <span class="keywordflow">case</span> REG_NONE:
00179 
00180                 <span class="keywordflow">if</span>( cbData != 0 ) {
00181                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00182                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00183                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00184                     }
00185                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00186                             lpszValue, cchValue, <span class="stringliteral">"REG_NONE"</span>, cbData );
00187                 }
00188                 <span class="keywordflow">break</span>;
00189 
00190             <span class="keywordflow">case</span> REG_RESOURCE_LIST:
00191 
00192                 <span class="keywordflow">if</span>( cbData == 0 ) {
00193                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00194                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00195                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00196                     }
00197                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00198                             lpszValue, cchValue, <span class="stringliteral">"REG_RESOURCE_LIST"</span>, cbData );
00199                 }
00200                 <span class="keywordflow">break</span>;
00201 
00202 
00203             <span class="keywordflow">case</span> REG_SZ:
00204 
00205                 <span class="keywordflow">if</span>( ( cbData != 0 ) &amp;&amp; ( ( cbData % <span class="keyword">sizeof</span>( WCHAR ) ) == 0 ) ) {
00206                     <span class="keywordflow">if</span>( *( ( PWCHAR )( lpbData + cbData - <span class="keyword">sizeof</span>( WCHAR ) ) ) != ( WCHAR )<span class="charliteral">'\0'</span> ) {
00207                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00208                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00209                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00210                         }
00211                         printf( MSG_ERROR_VALUE_NOT_NUL_TERMINATED,
00212                                 lpszValue, cchValue, <span class="stringliteral">"REG_SZ"</span> );
00213                     }
00214                 } <span class="keywordflow">else</span> {
00215                         <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00216                             KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00217                             printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00218                         }
00219                         printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00220                                 lpszValue, cchValue, <span class="stringliteral">"REG_SZ"</span>, cbData );
00221                 }
00222                 <span class="keywordflow">break</span>;
00223 
00224             <span class="keywordflow">case</span> REG_FULL_RESOURCE_DESCRIPTOR:
00225 
00226                 <span class="keywordflow">if</span>( cbData == 0 ) {
00227                     <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00228                         KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00229                         printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00230                     }
00231                     printf( MSG_ERROR_VALUE_INCORRECT_SIZE,
00232                             lpszValue, cchValue, <span class="stringliteral">"REG_FULL_RESOURCE_DESCRIPTOR"</span>, cbData );
00233                 }
00234                 <span class="keywordflow">break</span>;
00235 
00236             <span class="keywordflow">default</span>:
00237 
00238                 <span class="keywordflow">if</span>( !KeyNameAlreadyPrinted ) {
00239                     KeyNameAlreadyPrinted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00240                     printf( MSG_COMPLETE_KEY_NAME, PredefinedKeyName, CompleteKeyName );
00241                 }
00242                 printf( MSG_ERROR_VALUE_UNKNOWN_DATA,
00243                         lpszValue, cchValue, dwType, cbData );
00244                 <span class="keywordflow">break</span>;
00245 
00246         }
00247     }
00248 
00249     <span class="comment">//</span>
00250     <span class="comment">//  Free buffers for value name and value data</span>
00251     <span class="comment">//</span>
00252     free( lpszValue );
00253     free( lpbData );
00254 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="chkreg.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/chkreg_8c-source.html#l00425">425</a> of file <a class="el" href="../../d2/d6/chkreg_8c-source.html">chkreg.c</a>.
<p>
<pre class="fragment"><div>00426 {
00427     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   i;
00428     HKEY    RemoteUsers;
00429     HKEY    RemoteLocalMachine;
00430     LONG    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00431 
00432     <span class="keywordflow">if</span>( argc &lt;= 1 ) {
00433         printf( <span class="stringliteral">"\n******* Examining HKEY_LOCAL_MACHINE on local machine\n\n"</span> );
00434         <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( HKEY_LOCAL_MACHINE,
00435                     L<span class="stringliteral">""</span>,
00436                     L<span class="stringliteral">""</span>,
00437                     L<span class="stringliteral">"HKEY_LOCAL_MACHINE"</span> );
00438 
00439         printf( <span class="stringliteral">"\n******* Examining HKEY_USERS on local machine\n\n"</span> );
00440         <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( HKEY_USERS,
00441                     L<span class="stringliteral">""</span>,
00442                     L<span class="stringliteral">""</span>,
00443                     L<span class="stringliteral">"HKEY_USERS"</span> );
00444 
00445         printf( <span class="stringliteral">"\n******* Examining HKEY_CLASSES_ROOT on local machine\n\n"</span> );
00446         <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( HKEY_CLASSES_ROOT,
00447                     L<span class="stringliteral">""</span>,
00448                     L<span class="stringliteral">""</span>,
00449                     L<span class="stringliteral">"HKEY_CLASSES_ROOT"</span> );
00450 
00451         printf( <span class="stringliteral">"\n******* Examining HKEY_CURRENT_USER on local machine\n\n"</span> );
00452         <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( HKEY_CURRENT_USER,
00453                     L<span class="stringliteral">""</span>,
00454                     L<span class="stringliteral">""</span>,
00455                     L<span class="stringliteral">"HKEY_CURRENT_USER"</span> );
00456     } <span class="keywordflow">else</span> {
00457         <span class="keywordflow">for</span>( i = 1; i &lt; argc; i++ ) {
00458             <span class="comment">//</span>
00459             <span class="comment">// printf( "Machine name = %s \n", argv[ i ] );</span>
00460             <span class="comment">//</span>
00461 
00462             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegConnectRegistry( argv[ i ],
00463                                          HKEY_LOCAL_MACHINE,
00464                                          &amp;RemoteLocalMachine );
00465 
00466             <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00467                 printf( MSG_ERROR_REG_CONNECT_REGISTRY, argv[i], Status );
00468                 <span class="keywordflow">continue</span>;
00469             }
00470 
00471             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RegConnectRegistry( argv[ i ],
00472                                          HKEY_USERS,
00473                                          &amp;RemoteUsers );
00474 
00475             <span class="keywordflow">if</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != ERROR_SUCCESS ) {
00476                 RegCloseKey( RemoteLocalMachine );
00477                 printf( MSG_ERROR_REG_CONNECT_REGISTRY, argv[i], Status );
00478                 <span class="keywordflow">continue</span>;
00479             }
00480 
00481             printf( <span class="stringliteral">"\n******* Examining HKEY_LOCAL_MACHINE on %s \n\n"</span>, argv[i] );
00482             <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( RemoteLocalMachine,
00483                         L<span class="stringliteral">""</span>,
00484                         L<span class="stringliteral">""</span>,
00485                         L<span class="stringliteral">"HKEY_LOCAL_MACHINE"</span> );
00486 
00487             printf( <span class="stringliteral">"\n******* Examining HKEY_USERS on %s \n\n"</span>, argv[i] );
00488             <a class="code" href="../../d1/d7/chkreg_8c.html#a10">ExamineKey</a>( RemoteUsers,
00489                         L<span class="stringliteral">""</span>,
00490                         L<span class="stringliteral">""</span>,
00491                         L<span class="stringliteral">"HKEY_USERS"</span> );
00492 
00493             RegCloseKey( RemoteLocalMachine );
00494             RegCloseKey( RemoteUsers );
00495         }
00496     }
00497 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:03 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
