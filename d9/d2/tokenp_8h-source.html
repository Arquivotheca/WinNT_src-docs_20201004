<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tokenp.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tokenp.h</h1><a href="../../d8/d3/tokenp_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    tokenp.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the internal (private) declarations needed by the</span>
00012 <span class="comment">    TOKEN object routines.</span>
00013 <span class="comment"></span>
00014 <span class="comment">    It also contains global variables needed by the TOKEN object routines.</span>
00015 <span class="comment"></span>
00016 <span class="comment">Author:</span>
00017 <span class="comment"></span>
00018 <span class="comment">    Jim Kelly (JimK) 18-May-1990</span>
00019 <span class="comment"></span>
00020 <span class="comment">Revision History:</span>
00021 <span class="comment"></span>
00022 <span class="comment">   v10: robertre</span>
00023 <span class="comment">        Added SepAccessCheck and SepPrivilegeCheck prototypes</span>
00024 <span class="comment">   v11: robertre</span>
00025 <span class="comment">        Added parameter to SepAccessCheck</span>
00026 <span class="comment"></span>
00027 <span class="comment">--*/</span>
00028 
00029 <span class="preprocessor">#ifndef _TOKENP_</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#define _TOKENP_</span>
00031 <span class="preprocessor"></span>
00032 <span class="comment">//#define TOKEN_DEBUG</span>
00033 
00034 <span class="preprocessor">#include "<a class="code" href="../../d9/d8/ntos_8h.html">ntos.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="../../d6/d6/sep_8h.html">sep.h</a>"</span>
00036 <span class="preprocessor">#include "seopaque.h"</span>
00037 
00038 
00039 
00041 <span class="comment">//                                                                     //</span>
00042 <span class="comment">//                Token Diagnostics                                    //</span>
00043 <span class="comment">//                                                                     //</span>
00045 <span class="comment"></span>
00046 
00047 
00048 <span class="preprocessor">#if DBG</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define TOKEN_DIAGNOSTICS_ENABLED 1</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#endif // DBG</span>
00051 <span class="preprocessor"></span>
00052 
00053 <span class="comment">//</span>
00054 <span class="comment">// These definitions are useful diagnostics aids</span>
00055 <span class="comment">//</span>
00056 
00057 <span class="preprocessor">#if TOKEN_DIAGNOSTICS_ENABLED</span>
00058 <span class="preprocessor"></span>
00059 <span class="comment">//</span>
00060 <span class="comment">// Test for enabled diagnostic</span>
00061 <span class="comment">//</span>
00062 
00063 <span class="preprocessor">#define IF_TOKEN_GLOBAL( FlagName ) \</span>
00064 <span class="preprocessor">    if (TokenGlobalFlag &amp; (TOKEN_DIAG_##FlagName))</span>
00065 <span class="preprocessor"></span>
00066 <span class="comment">//</span>
00067 <span class="comment">// Diagnostics print statement</span>
00068 <span class="comment">//</span>
00069 
00070 <span class="preprocessor">#define TokenDiagPrint( FlagName, _Text_ )                               \</span>
00071 <span class="preprocessor">    IF_TOKEN_GLOBAL( FlagName )                                          \</span>
00072 <span class="preprocessor">        DbgPrint _Text_</span>
00073 <span class="preprocessor"></span>
00074 
00075 
00076 <span class="preprocessor">#else  // !TOKEN_DIAGNOSTICS_ENABLED</span>
00077 <span class="preprocessor"></span>
00078 <span class="comment">//</span>
00079 <span class="comment">// No diagnostics included in build</span>
00080 <span class="comment">//</span>
00081 
00082 
00083 <span class="comment">//</span>
00084 <span class="comment">// Test for diagnostics enabled</span>
00085 <span class="comment">//</span>
00086 
<a name="l00087"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a0">00087</a> <span class="preprocessor">#define IF_TOKEN_GLOBAL( FlagName ) if (FALSE)</span>
00088 <span class="preprocessor"></span>
00089 <span class="comment">//</span>
00090 <span class="comment">// Diagnostics print statement (expands to no-op)</span>
00091 <span class="comment">//</span>
00092 
<a name="l00093"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a1">00093</a> <span class="preprocessor">#define TokenDiagPrint( FlagName, _Text_ )     ;</span>
00094 <span class="preprocessor"></span>
00095 <span class="preprocessor">#endif // TOKEN_DIAGNOSTICS_ENABLED</span>
00096 <span class="preprocessor"></span>
00097 
00098 <span class="comment">//</span>
00099 <span class="comment">// The following flags enable or disable various diagnostic</span>
00100 <span class="comment">// capabilities within token code.  These flags are set in</span>
00101 <span class="comment">// TokenGlobalFlag (only available within a DBG system).</span>
00102 <span class="comment">//</span>
00103 <span class="comment">//</span>
00104 <span class="comment">//      TOKEN_LOCKS - Display information about acquisition and freeing</span>
00105 <span class="comment">//          of token locks.</span>
00106 <span class="comment">//</span>
00107 
<a name="l00108"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a2">00108</a> <span class="preprocessor">#define TOKEN_DIAG_TOKEN_LOCKS          ((ULONG) 0x00000001L)</span>
00109 <span class="preprocessor"></span>
00110 
00112 <span class="comment">//                                                                     //</span>
00113 <span class="comment">//                Token Related Constants                              //</span>
00114 <span class="comment">//                                                                     //</span>
00116 <span class="comment"></span>
00117 <span class="comment">//</span>
00118 <span class="comment">// By default, a token is charged the following for its dynamic component.</span>
00119 <span class="comment">// The dynamic component houses the default ACL and primary group ID.</span>
00120 <span class="comment">// If the size of these parameters passed upon token creation are larger</span>
00121 <span class="comment">// than this default, then the larger value will be charged.</span>
00122 <span class="comment">//</span>
00123 
<a name="l00124"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a3">00124</a> <span class="preprocessor">#define TOKEN_DEFAULT_DYNAMIC_CHARGE 500</span>
00125 <span class="preprocessor"></span>
00126 
00127 
00129 <span class="comment">//                                                                     //</span>
00130 <span class="comment">//                Token Object Body                                    //</span>
00131 <span class="comment">//                                                                     //</span>
00133 <span class="comment"></span>
00134 <span class="comment">//</span>
00135 <span class="comment">// Tokens have three parts:</span>
00136 <span class="comment">//</span>
00137 <span class="comment">//               Fixed part of body,</span>
00138 <span class="comment">//               Variable part of body,</span>
00139 <span class="comment">//               Dynamic part (not in body).</span>
00140 <span class="comment">//</span>
00141 <span class="comment">// The fixed and variable parts are allocated in a single block of memory.</span>
00142 <span class="comment">// The dynamic part is a separately allocated block of memory.</span>
00143 <span class="comment">//</span>
00144 <span class="comment">// The fixed part of the body contains the fixed length fields.  These</span>
00145 <span class="comment">// are defined in the TOKEN data type.</span>
00146 <span class="comment">//</span>
00147 <span class="comment">// The variable part of the body is variable in length and contains</span>
00148 <span class="comment">// privileges and user/group SIDs.  This part is variable in length</span>
00149 <span class="comment">// between different token objects, but does not change once established</span>
00150 <span class="comment">// for an individual token.</span>
00151 <span class="comment">//</span>
00152 <span class="comment">// The dynamic part is used to house default discretionary ACL information</span>
00153 <span class="comment">// and the primary group ID.</span>
00154 <span class="comment">//</span>
00155 <span class="comment">// Pictorially, a token looks like:</span>
00156 <span class="comment">//</span>
00157 <span class="comment">//    ==============      +---------------+</span>
00158 <span class="comment">//          ^             |               |</span>
00159 <span class="comment">//          |             |               |</span>
00160 <span class="comment">//          |             |               |</span>
00161 <span class="comment">//          |             | DynamicPart   o-----------+</span>
00162 <span class="comment">//          |             |- - - - - - - -|           |</span>
00163 <span class="comment">//                  +-----o Privileges    |           |</span>
00164 <span class="comment">//        Token     |     |- - - - - - - -|           |</span>
00165 <span class="comment">//        Body      |  +--o UserAndGroups |           |</span>
00166 <span class="comment">//          |       |  |  |- - - - - - - -|           |</span>
00167 <span class="comment">//          |       |  +--o RestrictedSids|          \|/</span>
00168 <span class="comment">//          |       |  |  |- - - - - - - -|        +---------------------+</span>
00169 <span class="comment">//          |       |  |  | PrimaryGroup  o-------&gt;| [Primary Group SID] |</span>
00170 <span class="comment">//          |       |  |  |- - - - - - - -|        |         o           |</span>
00171 <span class="comment">//          |       |  |  | DefaultAcl    o---+    |         o           |</span>
00172 <span class="comment">//          |       |  |  |- - - - - - - -|   |    |         o           |</span>
00173 <span class="comment">//          |       |  |  |      o        |   |    |- - - - - - - - - - -|</span>
00174 <span class="comment">//          |       |  |  |      o        |   +---&gt;| [  Default Acl  ]   |</span>
00175 <span class="comment">//          v       |  |  |      o        |        |         o           |</span>
00176 <span class="comment">//    ==============|  |  |===============|        |         o           |</span>
00177 <span class="comment">//          ^       |  +-&gt;| SIDs  Array   |        |         o           |</span>
00178 <span class="comment">//          |       |     | [User  SID ]  |        +---------------------+</span>
00179 <span class="comment">//          |       |     | [Group SID ]  |</span>
00180 <span class="comment">//                  |     | [Group SID ]  |</span>
00181 <span class="comment">//        Variable  |     | [Rest. Sid ]  |</span>
00182 <span class="comment">//         Part     |     |     o         |</span>
00183 <span class="comment">//                  |     |- - - - - - - -|</span>
00184 <span class="comment">//          |       +----&gt;| Privileges    |</span>
00185 <span class="comment">//          |             | Array         |</span>
00186 <span class="comment">//          v             |               |</span>
00187 <span class="comment">//    ==============      +---------------+</span>
00188 <span class="comment">//</span>
00189 <span class="comment">//     WARNING: The positions of fields illustrated in this picture are not</span>
00190 <span class="comment">//              intented to reflect their actual or even relative positions</span>
00191 <span class="comment">//              within the real data structures.  The exception to this is</span>
00192 <span class="comment">//              that THE USER SID IS THE FIRST SID IN THE UserAndGroups</span>
00193 <span class="comment">//              ARRAY.</span>
00194 <span class="comment">//</span>
00195 
00196 
00197 <span class="comment">//</span>
00198 <span class="comment">//             ! ! ! !     IMPORTANT     ! ! ! !</span>
00199 <span class="comment">//</span>
00200 <span class="comment">//      The access validation routines assume the SIDs are arranged</span>
00201 <span class="comment">//      in a particular order within the variable part of the token.</span>
00202 <span class="comment">//      Any changes to the order of the SIDs must be coordinated with</span>
00203 <span class="comment">//      corresponding changes to the access validation routines.</span>
00204 <span class="comment">//</span>
00205 <span class="comment">//                   ! ! ! ! ! ! ! ! ! ! !</span>
00206 
00207 
00208 
<a name="l00209"></a><a class="code" href="../../d8/d1/struct__TOKEN.html">00209</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d1/struct__TOKEN.html">_TOKEN</a> {
00210 
00211     <span class="comment">//</span>
00212     <span class="comment">// Fields arranged by size to preserve alignment.</span>
00213     <span class="comment">// Large fields before small fields.</span>
00214     <span class="comment">//</span>
00215 
00216 
00217     <span class="comment">//</span>
00218     <span class="comment">//  The following fields are either ReadOnly or ReadWrite.</span>
00219     <span class="comment">//  ReadOnly fields may be referenced any time a pointer to the</span>
00220     <span class="comment">//  token is still valid.  ReadWrite fields may only be referenced</span>
00221     <span class="comment">//  when the TokenLock is held.</span>
00222 
00223     <span class="comment">//  The dynamic part of the token (pointed to by the DynamicPart field)</span>
00224     <span class="comment">//  is also protected by the token lock.</span>
00225     <span class="comment">//</span>
00226     <span class="comment">//  ReadOnly  fields are marked Ro: in their comment.</span>
00227     <span class="comment">//  ReadWrite fields are marked Wr: in their comment.</span>
00228     <span class="comment">//</span>
00229 
<a name="l00230"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o0">00230</a>     TOKEN_SOURCE <a class="code" href="../../d8/d1/struct__TOKEN.html#o0">TokenSource</a>;                           <span class="comment">// Ro: 16-Bytes</span>
00231 
<a name="l00232"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o1">00232</a>     LUID <a class="code" href="../../d8/d1/struct__TOKEN.html#o1">TokenId</a>;                                       <span class="comment">// Ro: 8-Bytes</span>
<a name="l00233"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o2">00233</a>     LUID <a class="code" href="../../d8/d1/struct__TOKEN.html#o2">AuthenticationId</a>;                              <span class="comment">// Ro: 8-Bytes</span>
<a name="l00234"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o3">00234</a>     LUID <a class="code" href="../../d8/d1/struct__TOKEN.html#o3">ParentTokenId</a>;                                 <span class="comment">// Ro: 8-Bytes</span>
<a name="l00235"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o4">00235</a>     LARGE_INTEGER <a class="code" href="../../d8/d1/struct__TOKEN.html#o4">ExpirationTime</a>;                       <span class="comment">// Ro: 8-Bytes</span>
00236 
00237     <span class="comment">//</span>
00238     <span class="comment">// Each time the security information in a token is changed, the</span>
00239     <span class="comment">// following ID is changed.  Fields that cause this field to be</span>
00240     <span class="comment">// updated are marked as (Mod) in their comment field.</span>
00241     <span class="comment">//</span>
00242 
<a name="l00243"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o5">00243</a>     LUID <a class="code" href="../../d8/d1/struct__TOKEN.html#o5">ModifiedId</a>;                                    <span class="comment">// Wr: 8-Bytes</span>
00244 
<a name="l00245"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o6">00245</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o6">SessionId</a>;                                    <span class="comment">// Wr: 4-bytes</span>
<a name="l00246"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o7">00246</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o7">UserAndGroupCount</a>;                            <span class="comment">// Ro: 4-Bytes</span>
<a name="l00247"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o8">00247</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o8">RestrictedSidCount</a>;                           <span class="comment">// Ro: 4-Bytes</span>
<a name="l00248"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o9">00248</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o9">PrivilegeCount</a>;                               <span class="comment">// Ro: 4-Bytes</span>
<a name="l00249"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o10">00249</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o10">VariableLength</a>;                               <span class="comment">// Ro: 4-Bytes</span>
<a name="l00250"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o11">00250</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o11">DynamicCharged</a>;                               <span class="comment">// Ro: 4-Bytes</span>
00251 
<a name="l00252"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o12">00252</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o12">DynamicAvailable</a>;                             <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00253"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o13">00253</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o13">DefaultOwnerIndex</a>;                            <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00254"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o14">00254</a>     PSID_AND_ATTRIBUTES <a class="code" href="../../d8/d1/struct__TOKEN.html#o14">UserAndGroups</a>;                  <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00255"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o15">00255</a>     PSID_AND_ATTRIBUTES <a class="code" href="../../d8/d1/struct__TOKEN.html#o15">RestrictedSids</a>;                 <span class="comment">// Ro: 4-Bytes</span>
<a name="l00256"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o16">00256</a>     PSID <a class="code" href="../../d8/d1/struct__TOKEN.html#o16">PrimaryGroup</a>;                                  <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00257"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o17">00257</a>     PLUID_AND_ATTRIBUTES <a class="code" href="../../d8/d1/struct__TOKEN.html#o17">Privileges</a>;                    <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00258"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o18">00258</a>     PULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o18">DynamicPart</a>;                                 <span class="comment">// Wr: 4-Bytes (Mod)</span>
<a name="l00259"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o19">00259</a>     PACL <a class="code" href="../../d8/d1/struct__TOKEN.html#o19">DefaultDacl</a>;                                   <span class="comment">// Wr: 4-Bytes (Mod)</span>
00260 
00261 
00262 
<a name="l00263"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o20">00263</a>     TOKEN_TYPE <a class="code" href="../../d8/d1/struct__TOKEN.html#o20">TokenType</a>;                               <span class="comment">// Ro: 1-Byte</span>
<a name="l00264"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o21">00264</a>     SECURITY_IMPERSONATION_LEVEL <a class="code" href="../../d8/d1/struct__TOKEN.html#o21">ImpersonationLevel</a>;    <span class="comment">// Ro: 1-Byte</span>
00265 
<a name="l00266"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o22">00266</a>     UCHAR <a class="code" href="../../d8/d1/struct__TOKEN.html#o22">TokenFlags</a>;                                   <span class="comment">// Ro: 4-Bytes</span>
<a name="l00267"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o23">00267</a>     BOOLEAN <a class="code" href="../../d8/d1/struct__TOKEN.html#o23">TokenInUse</a>;                                 <span class="comment">// Wr: 1-Byte</span>
00268 
<a name="l00269"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o24">00269</a>     PSECURITY_TOKEN_PROXY_DATA <a class="code" href="../../d8/d1/struct__TOKEN.html#o24">ProxyData</a>;               <span class="comment">// Ro: 4-Bytes</span>
<a name="l00270"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o25">00270</a>     PSECURITY_TOKEN_AUDIT_DATA <a class="code" href="../../d8/d1/struct__TOKEN.html#o25">AuditData</a>;               <span class="comment">// Ro: 4-Bytes</span>
00271 
00272     <span class="comment">//</span>
00273     <span class="comment">// This marks the beginning of the variable part of the token.</span>
00274     <span class="comment">// It must follow all other fields in the token.</span>
00275     <span class="comment">//</span>
00276 
<a name="l00277"></a><a class="code" href="../../d8/d1/struct__TOKEN.html#o26">00277</a>     ULONG <a class="code" href="../../d8/d1/struct__TOKEN.html#o26">VariablePart</a>;                                 <span class="comment">// Wr: 4-Bytes (Mod)</span>
00278 
00279     } <a class="code" href="../../d8/d1/struct__TOKEN.html">TOKEN</a>, * <a class="code" href="../../d5/d3/parseini_8c.html#a4">PTOKEN</a>;
00280 
00281 <span class="comment">//</span>
00282 <span class="comment">// Where:</span>
00283 <span class="comment">//</span>
00284 <span class="comment">//    TokenSource - Information provided by the executive component that</span>
00285 <span class="comment">//                  requested the logon that the token represents.</span>
00286 <span class="comment">//</span>
00287 <span class="comment">//</span>
00288 <span class="comment">//    TokenId - Is an LUID value.  Each token object has a uniquely</span>
00289 <span class="comment">//        assigned LUID.</span>
00290 <span class="comment">//</span>
00291 <span class="comment">//</span>
00292 <span class="comment">//    AuthenticationId - Is the LUID assigned by the domain controller for</span>
00293 <span class="comment">//        the logon session.</span>
00294 <span class="comment">//</span>
00295 <span class="comment">//</span>
00296 <span class="comment">//    ExpirationTime - Not yet supported in NT.</span>
00297 <span class="comment">//</span>
00298 <span class="comment">//</span>
00299 <span class="comment">//    ModifiedId - Is an LUID which is changed each time a modification is</span>
00300 <span class="comment">//        made to this token which changes the security semantics of the</span>
00301 <span class="comment">//        token.  This includes enabling/disabling privileges and groups</span>
00302 <span class="comment">//        and changing default ACLs, et cetera.  Any token which is a</span>
00303 <span class="comment">//        duplicate of this token will have the same ModifiedId (until</span>
00304 <span class="comment">//        one or the other is changed).  This does not cover changes to</span>
00305 <span class="comment">//        non-security semantics fields, like TokenInUse.</span>
00306 <span class="comment">//</span>
00307 <span class="comment">//</span>
00308 <span class="comment">//    UserAndGroupCount - Indicates the number of user/group IDs in this token.</span>
00309 <span class="comment">//        This value must be at least 1.  A value of 1 indicates a user</span>
00310 <span class="comment">//        ID with no supplemental group IDs.  A value of 5 indicates a</span>
00311 <span class="comment">//        user ID and 4 supplemental group IDs.</span>
00312 <span class="comment">//</span>
00313 <span class="comment">//    PrivilegeCount - Indicates how many privileges are included in</span>
00314 <span class="comment">//        this token.  May be zero or larger.</span>
00315 <span class="comment">//</span>
00316 <span class="comment">//    TokenType - Indicates which type of token this token object is.</span>
00317 <span class="comment">//</span>
00318 <span class="comment">//    ImpersonationLevel - For TokenImpersonation type tokens, this field</span>
00319 <span class="comment">//        indicates the impersonation level.  For TokenPrimary type tokens,</span>
00320 <span class="comment">//        this field is ignored.</span>
00321 <span class="comment">//</span>
00322 <span class="comment">//    DynamicCharged - Indicates how much pool quota has been charged</span>
00323 <span class="comment">//        for the dynamic portion of this token.</span>
00324 <span class="comment">//</span>
00325 <span class="comment">//    DynamicAvailable - Indicates how much of the charged quota is still</span>
00326 <span class="comment">//        available for use.  This is modified when  pool associated</span>
00327 <span class="comment">//        with the dynamic portion of the token is allocated or freed,</span>
00328 <span class="comment">//        such as when the default DACL or primary group is replaced.</span>
00329 <span class="comment">//</span>
00330 <span class="comment">//</span>
00331 <span class="comment">//    DefaultOwnerIndex - If non-zero, identifies an ID that has explicitly</span>
00332 <span class="comment">//        been established as the default owner for this token.  If it is zero,</span>
00333 <span class="comment">//        the standard default (user ID) is used as the default owner.</span>
00334 <span class="comment">//</span>
00335 <span class="comment">//    UserAndGroups - Points to an array of SID_AND_ATTRIBUTES.  The first</span>
00336 <span class="comment">//        element in this array is the token's user ID.  Any additional</span>
00337 <span class="comment">//        elements are those of groups.  The number of entries in this</span>
00338 <span class="comment">//        array is one greater than</span>
00339 <span class="comment">//</span>
00340 <span class="comment">//    PrimaryGroup - Points to an SID that is to be used as the primary</span>
00341 <span class="comment">//        group of the token.  There are no value restrictions</span>
00342 <span class="comment">//        placed upon what can be used as a primary group.  This</span>
00343 <span class="comment">//        SID is not one of user or group IDs (although it may have the</span>
00344 <span class="comment">//        same value as one of those IDs).</span>
00345 <span class="comment">//</span>
00346 <span class="comment">//    Privileges - Points to an array of privileges represented as</span>
00347 <span class="comment">//        LUID_AND_ATTRIBUTES.  The number of elements in this array</span>
00348 <span class="comment">//        is contained in the PrivilegesCount field.</span>
00349 <span class="comment">//</span>
00350 <span class="comment">//    TokenInUse - Is a boolean that indicates whether a primary token</span>
00351 <span class="comment">//        is already in use by a process.  This field value is only</span>
00352 <span class="comment">//        valid for primary tokens.</span>
00353 <span class="comment">//</span>
00354 <span class="comment">//    ProxyData - Optionally points to a Proxy data structure, containing</span>
00355 <span class="comment">//        the information to be passed to AVR routines by file systems.</span>
00356 <span class="comment">//        This field being non-null identifies the token as a proxy token.</span>
00357 <span class="comment">//</span>
00358 <span class="comment">//    AuditData - Optionally points to an Audit data structure, containing</span>
00359 <span class="comment">//         global auditing data for this subject.</span>
00360 <span class="comment">//</span>
00361 <span class="comment">//        NOTE:  Access to this field is guarded by the global</span>
00362 <span class="comment">//               PROCESS SECURITY FIELDS LOCK.</span>
00363 <span class="comment">//    VariablePart - Is the beginning of the variable part of the token.</span>
00364 <span class="comment">//</span>
00365 
00366 
00368 <span class="comment">//</span>
00369 <span class="comment">// Internal version of Object Type list</span>
00370 <span class="comment">//</span>
00372 <span class="comment"></span>
<a name="l00373"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html">00373</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html">_IOBJECT_TYPE_LIST</a> {
<a name="l00374"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o0">00374</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o0">Level</a>;
<a name="l00375"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o1">00375</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o1">Flags</a>;
<a name="l00376"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a4">00376</a> <span class="preprocessor">#define OBJECT_SUCCESS_AUDIT 0x1</span>
<a name="l00377"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a5">00377</a> <span class="preprocessor"></span><span class="preprocessor">#define OBJECT_FAILURE_AUDIT 0x2</span>
<a name="l00378"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o2">00378</a> <span class="preprocessor"></span>    GUID <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o2">ObjectType</a>;
<a name="l00379"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o3">00379</a>     LONG <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o3">ParentIndex</a>;
<a name="l00380"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o4">00380</a>     ULONG <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o4">Remaining</a>;
<a name="l00381"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o5">00381</a>     ULONG <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o5">CurrentGranted</a>;
<a name="l00382"></a><a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o6">00382</a>     ULONG <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html#o6">CurrentDenied</a>;
00383 } <a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html">IOBJECT_TYPE_LIST</a>, *<a class="code" href="../../d7/d9/struct__IOBJECT__TYPE__LIST.html">PIOBJECT_TYPE_LIST</a>;
00384 
00385 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00386 <a class="code" href="../../d8/d3/tokenp_8h.html#a21">SeCaptureObjectTypeList</a> (
00387     IN POBJECT_TYPE_LIST ObjectTypeList OPTIONAL,
00388     IN ULONG ObjectTypeListLength,
00389     IN KPROCESSOR_MODE RequestorMode,
00390     OUT PIOBJECT_TYPE_LIST *CapturedObjectTypeList
00391     );
00392 
00393 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00394 <a class="code" href="../../d8/d3/tokenp_8h.html#a22">SeFreeCapturedObjectTypeList</a>(
00395     IN PVOID ObjectTypeList
00396     );
00397 
00398 
00400 <span class="comment">//                                                                     //</span>
00401 <span class="comment">//                Token Specific Macros                                //</span>
00402 <span class="comment">//                                                                     //</span>
00404 <span class="comment"></span>
00405 
00406 
00407 
00408 
00409 
00410 
00411 <span class="preprocessor">#ifndef TOKEN_DIAGNOSTICS_ENABLED</span>
00412 <span class="preprocessor"></span>
<a name="l00413"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a6">00413</a> <span class="preprocessor">#define SepAcquireTokenReadLock(T)  KeEnterCriticalRegion();          \</span>
00414 <span class="preprocessor">                                    ExAcquireResourceShared(&amp;SepTokenLock, TRUE)</span>
00415 <span class="preprocessor"></span>
<a name="l00416"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a7">00416</a> <span class="preprocessor">#define SepAcquireTokenWriteLock(T) KeEnterCriticalRegion();          \</span>
00417 <span class="preprocessor">                                    ExAcquireResourceExclusive(&amp;SepTokenLock, TRUE)</span>
00418 <span class="preprocessor"></span>
<a name="l00419"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a8">00419</a> <span class="preprocessor">#define SepReleaseTokenReadLock(T)  ExReleaseResource(&amp;SepTokenLock);  \</span>
00420 <span class="preprocessor">                                    KeLeaveCriticalRegion()</span>
00421 <span class="preprocessor"></span>
00422 <span class="preprocessor">#else  // TOKEN_DIAGNOSTICS_ENABLED</span>
00423 <span class="preprocessor"></span>
00424 <span class="preprocessor">#define SepAcquireTokenReadLock(T)  if (TokenGlobalFlag &amp; TOKEN_DIAG_TOKEN_LOCKS) { \</span>
00425 <span class="preprocessor">                                        DbgPrint("SE (Token):  Acquiring Token READ Lock for access to token 0x%lx\n", (T)); \</span>
00426 <span class="preprocessor">                                    }                                 \</span>
00427 <span class="preprocessor">                                    KeEnterCriticalRegion();          \</span>
00428 <span class="preprocessor">                                    ExAcquireResourceShared(&amp;SepTokenLock, TRUE)</span>
00429 <span class="preprocessor"></span>
00430 <span class="preprocessor">#define SepAcquireTokenWriteLock(T) if (TokenGlobalFlag &amp; TOKEN_DIAG_TOKEN_LOCKS) { \</span>
00431 <span class="preprocessor">                                        DbgPrint("SE (Token):  Acquiring Token WRITE Lock for access to token 0x%lx    ********************* EXCLUSIVE *****\n", (T)); \</span>
00432 <span class="preprocessor">                                    }                                 \</span>
00433 <span class="preprocessor">                                    KeEnterCriticalRegion();          \</span>
00434 <span class="preprocessor">                                    ExAcquireResourceExclusive(&amp;SepTokenLock, TRUE)</span>
00435 <span class="preprocessor"></span>
00436 <span class="preprocessor">#define SepReleaseTokenReadLock(T)  if (TokenGlobalFlag &amp; TOKEN_DIAG_TOKEN_LOCKS) { \</span>
00437 <span class="preprocessor">                                        DbgPrint("SE (Token):  Releasing Token Lock for access to token 0x%lx\n", (T)); \</span>
00438 <span class="preprocessor">                                    }                                 \</span>
00439 <span class="preprocessor">                                    ExReleaseResource(&amp;SepTokenLock); \</span>
00440 <span class="preprocessor">                                    KeLeaveCriticalRegion()</span>
00441 <span class="preprocessor"></span>
00442 <span class="preprocessor">#endif // TOKEN_DIAGNOSTICS_ENABLED</span>
00443 <span class="preprocessor"></span>
<a name="l00444"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a9">00444</a> <span class="preprocessor">#define SepReleaseTokenWriteLock(T,M)                                    \</span>
00445 <span class="preprocessor">    {                                                                    \</span>
00446 <span class="preprocessor">      if ((M)) {                                                         \</span>
00447 <span class="preprocessor">          ExAllocateLocallyUniqueId( &amp;((PTOKEN)(T))-&gt;ModifiedId  );      \</span>
00448 <span class="preprocessor">      }                                                                  \</span>
00449 <span class="preprocessor">      SepReleaseTokenReadLock( T );                                      \</span>
00450 <span class="preprocessor">    }</span>
00451 <span class="preprocessor"></span>
00452 <span class="comment">//</span>
00453 <span class="comment">// Reference individual privilege attribute flags of any privilege array</span>
00454 <span class="comment">//</span>
00455 <span class="comment">//  P - is a pointer to an array of privileges (PLUID_AND_ATTRIBUTES)</span>
00456 <span class="comment">//  I - is the index of the privilege</span>
00457 <span class="comment">//  A - is the name of the attribute desired (e.g., Enabled, EnabledByDefault, etc. )</span>
00458 <span class="comment">//</span>
00459 
<a name="l00460"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a10">00460</a> <span class="preprocessor">#define SepArrayPrivilegeAttributes(P,I) ( (P)[I].Attributes )</span>
00461 <span class="preprocessor"></span>
00462 <span class="comment">//</span>
00463 <span class="comment">// Reference individual privilege attribute flags of token privileges</span>
00464 <span class="comment">//</span>
00465 <span class="comment">//  T - is a pointer to a token</span>
00466 <span class="comment">//  I - is the index of the privilege</span>
00467 <span class="comment">//  A - is the name of the attribute desired (e.g., Enabled, EnabledByDefault, etc. )</span>
00468 <span class="comment">//</span>
00469 
<a name="l00470"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a11">00470</a> <span class="preprocessor">#define SepTokenPrivilegeAttributes(T,I) ( (T)-&gt;Privileges[I].Attributes )</span>
00471 <span class="preprocessor"></span>
00472 <span class="comment">//</span>
00473 <span class="comment">// Reference individual group attribute flags of any group array</span>
00474 <span class="comment">//</span>
00475 <span class="comment">//  G - is a pointer to the array of groups  (SID_AND_ATTRIBUTES[])</span>
00476 <span class="comment">//  I - is the index of the group</span>
00477 <span class="comment">//</span>
00478 
<a name="l00479"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a12">00479</a> <span class="preprocessor">#define SepArrayGroupAttributes(G,I)   ( (G)[I].Attributes )</span>
00480 <span class="preprocessor"></span>
00481 
00482 <span class="comment">//</span>
00483 <span class="comment">// Reference individual group attribute flags of token groups</span>
00484 <span class="comment">//</span>
00485 <span class="comment">//  T - is a pointer to a token</span>
00486 <span class="comment">//  I - is the index of the group</span>
00487 <span class="comment">//</span>
00488 
<a name="l00489"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a13">00489</a> <span class="preprocessor">#define SepTokenGroupAttributes(T,I) ( (T)-&gt;UserAndGroups[I].Attributes )</span>
00490 <span class="preprocessor"></span>
00491 
00492 
00493 
00495 <span class="comment">//                                                                    //</span>
00496 <span class="comment">//           Private Routine Declarations                             //</span>
00497 <span class="comment">//                                                                    //</span>
00499 <span class="comment"></span>
00500 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00501 <a class="code" href="../../d8/d3/tokenp_8h.html#a23">SepAdjustGroups</a>(
00502     IN PTOKEN Token,
00503     IN BOOLEAN MakeChanges,
00504     IN BOOLEAN ResetToDefault,
00505     IN ULONG GroupCount OPTIONAL,
00506     IN PSID_AND_ATTRIBUTES NewState OPTIONAL,
00507     OUT PTOKEN_GROUPS PreviousState OPTIONAL,
00508     OUT PSID SidBuffer OPTIONAL,
00509     OUT PULONG ReturnLength,
00510     OUT PULONG ChangeCount,
00511     OUT PBOOLEAN ChangesMade
00512     );
00513 
00514 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00515 <a class="code" href="../../d8/d3/tokenp_8h.html#a24">SepAdjustPrivileges</a>(
00516     IN PTOKEN Token,
00517     IN BOOLEAN MakeChanges,
00518     IN BOOLEAN DisableAllPrivileges,
00519     IN ULONG PrivilegeCount OPTIONAL,
00520     IN PLUID_AND_ATTRIBUTES NewState OPTIONAL,
00521     OUT PTOKEN_PRIVILEGES PreviousState OPTIONAL,
00522     OUT PULONG ReturnLength,
00523     OUT PULONG ChangeCount,
00524     OUT PBOOLEAN ChangesMade
00525     );
00526 
00527 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00528 <a class="code" href="../../d0/d4/tokenset_8c.html#a4">SepAppendDefaultDacl</a>(
00529     IN PTOKEN Token,
00530     IN PACL PAcl
00531     );
00532 
00533 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00534 <a class="code" href="../../d0/d4/tokenset_8c.html#a3">SepAppendPrimaryGroup</a>(
00535     IN PTOKEN Token,
00536     IN PSID PSid
00537     );
00538 
00539 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00540 <a class="code" href="../../d8/d3/tokenp_8h.html#a27">SepDuplicateToken</a>(
00541     IN PTOKEN ExistingToken,
00542     IN POBJECT_ATTRIBUTES ObjectAttributes,
00543     IN BOOLEAN EffectiveOnly,
00544     IN TOKEN_TYPE TokenType,
00545     IN SECURITY_IMPERSONATION_LEVEL ImpersonationLevel OPTIONAL,
00546     IN KPROCESSOR_MODE RequestorMode,
00547     OUT PTOKEN *DuplicateToken
00548     );
00549 
00550 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00551 <a class="code" href="../../d8/d3/tokenp_8h.html#a28">SepFilterToken</a>(
00552     IN PTOKEN ExistingToken,
00553     IN KPROCESSOR_MODE RequestorMode,
00554     IN ULONG Flags,
00555     IN ULONG GroupCount,
00556     IN PSID_AND_ATTRIBUTES GroupsToDisable OPTIONAL,
00557     IN ULONG PrivilegeCount,
00558     IN PLUID_AND_ATTRIBUTES PrivilegesToDelete OPTIONAL,
00559     IN ULONG SidCount,
00560     IN PSID_AND_ATTRIBUTES RestrictedSids OPTIONAL,
00561     IN ULONG SidLength,
00562     OUT PTOKEN * FilteredToken
00563     );
00564 
00565 BOOLEAN
00566 <a class="code" href="../../d8/d3/tokenp_8h.html#a29">SepSidInSidAndAttributes</a> (
00567     IN PSID_AND_ATTRIBUTES SidAndAttributes,
00568     IN ULONG SidCount,
00569     IN PSID PrincipalSelfSid,
00570     IN PSID Sid
00571     );
00572 
00573 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00574 <a class="code" href="../../d8/d3/tokenp_8h.html#a30">SepRemoveDisabledGroupsAndPrivileges</a>(
00575     IN PTOKEN Token,
00576     IN ULONG Flags,
00577     IN ULONG GroupCount,
00578     IN PSID_AND_ATTRIBUTES GroupsToDisable,
00579     IN ULONG PrivilegeCount,
00580     IN PLUID_AND_ATTRIBUTES PrivilegesToDelete
00581     );
00582 
00583 
00584 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00585 <a class="code" href="../../d0/d4/tokenset_8c.html#a2">SepFreeDefaultDacl</a>(
00586     IN PTOKEN Token
00587     );
00588 
00589 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00590 <a class="code" href="../../d0/d4/tokenset_8c.html#a1">SepFreePrimaryGroup</a>(
00591     IN PTOKEN Token
00592     );
00593 
00594 
00595 BOOLEAN
00596 <a class="code" href="../../d8/d3/tokenp_8h.html#a33">SepIdAssignableAsOwner</a>(
00597     IN PTOKEN Token,
00598     IN ULONG Index
00599     );
00600 
00601 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00602 <a class="code" href="../../d8/d3/tokenp_8h.html#a34">SepMakeTokenEffectiveOnly</a>(
00603     IN PTOKEN Token
00604     );
00605 
00606 BOOLEAN
00607 <a class="code" href="../../d8/d3/tokenp_8h.html#a35">SepTokenInitialization</a>( VOID );
00608 
00609 
00610 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00611 <a class="code" href="../../d8/d3/tokenp_8h.html#a36">SepTokenDeleteMethod</a> (
00612     IN PVOID Token
00613     );
00614 
00615 <span class="comment">//</span>
00616 <span class="comment">// These are here because if they are placed in sep.h, we don't</span>
00617 <span class="comment">// have the PTOKEN datatype available.</span>
00618 <span class="comment">//</span>
00619 
00620 BOOLEAN
00621 <a class="code" href="../../d8/d3/tokenp_8h.html#a37">SepPrivilegeCheck</a>(
00622     IN PTOKEN Token,
00623     IN OUT PLUID_AND_ATTRIBUTES RequiredPrivileges,
00624     IN ULONG RequiredPrivilegeCount,
00625     IN ULONG PrivilegeSetControl,
00626     IN KPROCESSOR_MODE PreviousMode
00627     );
00628 
00629 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00630 <a class="code" href="../../d8/d3/tokenp_8h.html#a38">SepAccessCheck</a> (
00631     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
00632     IN PSID PrincipalSelfSid,
00633     IN PTOKEN PrimaryToken,
00634     IN PTOKEN ClientToken OPTIONAL,
00635     IN ACCESS_MASK DesiredAccess,
00636     IN PIOBJECT_TYPE_LIST ObjectTypeList OPTIONAL,
00637     IN ULONG ObjectTypeListLength,
00638     IN PGENERIC_MAPPING GenericMapping,
00639     IN ACCESS_MASK PreviouslyGrantedAccess,
00640     IN KPROCESSOR_MODE PreviousMode,
00641     OUT PACCESS_MASK GrantedAccess,
00642     OUT PPRIVILEGE_SET *Privileges OPTIONAL,
00643     OUT PNTSTATUS AccessStatus,
00644     IN BOOLEAN ReturnResultList,
00645     OUT PBOOLEAN ReturnSomeAccessGranted,
00646     OUT PBOOLEAN ReturnSomeAccessDenied
00647     );
00648 
00649 BOOLEAN
00650 <a class="code" href="../../d8/d3/tokenp_8h.html#a39">SepObjectInTypeList</a> (
00651     IN GUID *ObjectType,
00652     IN PIOBJECT_TYPE_LIST ObjectTypeList,
00653     IN ULONG ObjectTypeListLength,
00654     OUT PULONG ReturnedIndex
00655     );
00656 
00657 <span class="preprocessor">#ifdef TOKEN_DEBUG</span>
00658 <span class="preprocessor"></span><a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00659 SepDumpToken(
00660     IN PTOKEN T
00661     );
00662 <span class="preprocessor">#endif //TOKEN_DEBUG</span>
00663 <span class="preprocessor"></span>
00665 <span class="comment">//                                                                    //</span>
00666 <span class="comment">//           Global Variables                                         //</span>
00667 <span class="comment">//                                                                    //</span>
00669 <span class="comment"></span>
00670 
<a name="l00671"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a18">00671</a> <span class="keyword">extern</span> GENERIC_MAPPING  <a class="code" href="../../d4/d3/token_8c.html#a0">SepTokenMapping</a>;
<a name="l00672"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a19">00672</a> <span class="keyword">extern</span> <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>     <a class="code" href="../../d0/d5/se_8h.html#a36">SepTokenObjectType</a>;
00673 
<a name="l00674"></a><a class="code" href="../../d8/d3/tokenp_8h.html#a20">00674</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>        <a class="code" href="../../d4/d3/token_8c.html#a2">SepTokenLock</a>;
00675 
00676 
00677 <span class="preprocessor">#ifdef    TOKEN_DIAGNOSTICS_ENABLED</span>
00678 <span class="preprocessor"></span><span class="keyword">extern</span> ULONG            TokenGlobalFlag;
00679 <span class="preprocessor">#endif // TOKEN_DIAGNOSTICS_ENABLED</span>
00680 <span class="preprocessor"></span>
00681 
00682 <span class="preprocessor">#endif // _TOKENP_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:01 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
