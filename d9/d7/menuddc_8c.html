<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: menuddc.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>menuddc.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>
<code>#include "initguid.h"</code><br>

<p>
<a href="../../d0/d7/menuddc_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d8/d1/structtagMNIDROPTARGET.html">PMNIDROPTARGET</a>)pdt)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a2">mndtAddRef</a> (LPDROPTARGET pdt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a3">mndtQueryInterface</a> (LPDROPTARGET pdt, REFIID riid, PVOID *ppvObj)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a4">mndtRelease</a> (LPDROPTARGET pdt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a5">mndtDragOver</a> (LPDROPTARGET pdt, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> grfKeyState, POINTL ptl, LPDWORD pdwEffect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a6">mndtDragEnter</a> (LPDROPTARGET pdt, LPDATAOBJECT pdo, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> grfKeyState, POINTL ptl, LPDWORD pdwEffect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a7">mndtDragLeave</a> (LPDROPTARGET pdt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a8">mndtDrop</a> (LPDROPTARGET pdt, LPDATAOBJECT pdo, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> grfKeyState, POINTL ptl, LPDWORD pdwEffect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a9">__ClientRegisterDragDrop</a> (HWND *phwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a10">__ClientRevokeDragDrop</a> (HWND *phwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a11">LoadOLEOnce</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a12">__ClientLoadOLE</a> (PVOID p)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>IDropTargetVtbl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/menuddc_8c.html#a1">idtVtbl</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="menuddc.c::PMNIDT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PMNIDT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pdt&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d8/d1/structtagMNIDROPTARGET.html">PMNIDROPTARGET</a>)pdt)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">22</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00032">mndtAddRef()</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00139">mndtDragEnter()</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00158">mndtDragLeave()</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00074">mndtDragOver()</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00182">mndtDrop()</a>, and <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00059">mndtRelease()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a12" doxytag="menuddc.c::__ClientLoadOLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> __ClientLoadOLE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00362">362</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00161">ghinstOLE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00163">gpfnOLERegisterDD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00164">gpfnOLERevokeDD</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00281">LoadOLEOnce()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02126">OLEWONTLOAD</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02154">UserCallbackReturn</a>.
<p>
<pre class="fragment"><div>00362                                 {
00363 
00364     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00365 
00366     UNREFERENCED_PARAMETER(p);
00367 
00368     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a61">ghinstOLE</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00369         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d7/menuddc_8c.html#a11">LoadOLEOnce</a>();
00370     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a61">ghinstOLE</a> == <a class="code" href="../../d6/d0/usercli_8h.html#a282">OLEWONTLOAD</a>) {
00371         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_UNSUCCESSFUL;
00372     } <span class="keywordflow">else</span> {
00373         UserAssert(gpfnOLERegisterDD != NULL);
00374         UserAssert(gpfnOLERevokeDD != NULL);
00375         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00376     }
00377 
00378     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a283">UserCallbackReturn</a>(NULL, 0, Status);
00379 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="menuddc.c::__ClientRegisterDragDrop" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> __ClientRegisterDragDrop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>phwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00224">224</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00163">gpfnOLERegisterDD</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02108">tagMNIDROPTARGET::idt</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00210">idtVtbl</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a391">MNIDROPTARGET</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a392">PMNIDROPTARGET</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02099">REGISTERDDPROC</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02154">UserCallbackReturn</a>.
<p>
<pre class="fragment"><div>00225 {
00226     HRESULT hres = STATUS_UNSUCCESSFUL;
00227     <a class="code" href="../../d8/d1/structtagMNIDROPTARGET.html">PMNIDROPTARGET</a> pmnidt;
00228 
00229     <span class="comment">/*</span>
00230 <span class="comment">     * Allocate the IDropTarget interface struct &amp; additional data</span>
00231 <span class="comment">     */</span>
00232     pmnidt = (<a class="code" href="../../d8/d1/structtagMNIDROPTARGET.html">PMNIDROPTARGET</a>)LocalAlloc(LPTR, <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d1/structtagMNIDROPTARGET.html">MNIDROPTARGET</a>));
00233     <span class="keywordflow">if</span> (pmnidt == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00234         RIPMSG0(RIP_WARNING, <span class="stringliteral">"__ClientRegisterDragDrop allocation Failed"</span>);
00235         hres = STATUS_UNSUCCESSFUL;
00236         <span class="keywordflow">goto</span> BackToKernel;
00237     }
00238 
00239     <span class="comment">/*</span>
00240 <span class="comment">     * Initialize it</span>
00241 <span class="comment">     */</span>
00242     pmnidt-&gt;<a class="code" href="../../d8/d1/structtagMNIDROPTARGET.html#o0">idt</a>.lpVtbl = &amp;<a class="code" href="../../d9/d7/menuddc_8c.html#a1">idtVtbl</a>;
00243 
00244     <span class="comment">/*</span>
00245 <span class="comment">     * Call RegisterDragDrop</span>
00246 <span class="comment">     */</span>
00247     hres = (*(<a class="code" href="../../d6/d0/usercli_8h.html#a388">REGISTERDDPROC</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a63">gpfnOLERegisterDD</a>)(*phwnd, (LPDROPTARGET)pmnidt);
00248     <span class="keywordflow">if</span> (!SUCCEEDED(hres)) {
00249         RIPMSG1(RIP_WARNING, <span class="stringliteral">"__ClientRegisterDragDrop Failed:%#lx"</span>, hres);
00250     }
00251 
00252 BackToKernel:
00253     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a283">UserCallbackReturn</a>(NULL, 0, hres);
00254 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="menuddc.c::__ClientRevokeDragDrop" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> __ClientRevokeDragDrop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>phwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00261">261</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00164">gpfnOLERevokeDD</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02100">REVOKEDDPROC</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02154">UserCallbackReturn</a>.
<p>
<pre class="fragment"><div>00262 {
00263     HRESULT hres;
00264 
00265     <span class="comment">/*</span>
00266 <span class="comment">     * Call RevokeDragDrop</span>
00267 <span class="comment">     */</span>
00268     hres = (*(<a class="code" href="../../d6/d0/usercli_8h.html#a389">REVOKEDDPROC</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a64">gpfnOLERevokeDD</a>)(*phwnd);
00269     <span class="keywordflow">if</span> (!SUCCEEDED(hres)) {
00270         RIPMSG1(RIP_WARNING, <span class="stringliteral">"__ClientRevokeDragDrop Failed:%#lx"</span>, hres);
00271     }
00272 
00273     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a283">UserCallbackReturn</a>(NULL, 0, hres);
00274 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="menuddc.c::LoadOLEOnce" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS LoadOLEOnce           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00281">281</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a393">GETPROCINFO</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00161">ghinstOLE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00162">gpfnOLEOleUninitialize</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00163">gpfnOLERegisterDD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00164">gpfnOLERevokeDD</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02120">tagGETPROCINFO::lpsz</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02097">OLEINITIALIZEPROC</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02126">OLEWONTLOAD</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02119">tagGETPROCINFO::ppfn</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00362">__ClientLoadOLE()</a>.
<p>
<pre class="fragment"><div>00281                             {
00282 
00283     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00284     <a class="code" href="../../d6/d0/usercli_8h.html#a386">OLEINITIALIZEPROC</a> pfnOLEOleInitialize;
00285 
00286     <span class="comment">/*</span>
00287 <span class="comment">     * These are the functions that we'll call.</span>
00288 <span class="comment">     */</span>
00289     <a class="code" href="../../d9/d5/structtagGETPROCINFO.html">GETPROCINFO</a> gpi [] = {
00290         {&amp;((FARPROC)pfnOLEOleInitialize), (LPCSTR)<span class="stringliteral">"OleInitialize"</span>},
00291         {&amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a62">gpfnOLEOleUninitialize</a>, (LPCSTR)<span class="stringliteral">"OleUninitialize"</span>},
00292         {&amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a63">gpfnOLERegisterDD</a>, (LPCSTR)<span class="stringliteral">"RegisterDragDrop"</span>},
00293         {&amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a64">gpfnOLERevokeDD</a>, (LPCSTR)<span class="stringliteral">"RevokeDragDrop"</span>},
00294         {<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>}
00295     };
00296 
00297     <a class="code" href="../../d9/d5/structtagGETPROCINFO.html">GETPROCINFO</a> * pgpi = gpi;
00298 
00299     <span class="comment">/*</span>
00300 <span class="comment">     * We should come here only once</span>
00301 <span class="comment">     */</span>
00302     UserAssert(ghinstOLE == NULL);
00303 
00304     <span class="comment">/*</span>
00305 <span class="comment">     * Load it</span>
00306 <span class="comment">     */</span>
00307     <a class="code" href="../../d1/d8/clglobal_8c.html#a61">ghinstOLE</a> = LoadLibrary(L<span class="stringliteral">"OLE32.DLL"</span>);
00308     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a61">ghinstOLE</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00309         RIPMSG1(RIP_WARNING, <span class="stringliteral">"LoadOLEOnce: Failed to load OLE32.DLL: %#lx"</span>, GetLastError());
00310         <span class="keywordflow">goto</span> OLEWontLoad;
00311     }
00312 
00313     <span class="comment">/*</span>
00314 <span class="comment">     * Get the address of all procs</span>
00315 <span class="comment">     */</span>
00316     <span class="keywordflow">while</span> (pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00317         *(pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a>) = GetProcAddress(ghinstOLE, pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o1">lpsz</a>);
00318         <span class="keywordflow">if</span> (*(pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a>) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00319             RIPMSG2(RIP_WARNING, <span class="stringliteral">"LoadOLEOnce: GetProcAddress failed: '%s': %#lx"</span>,
00320                     pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o1">lpsz</a>, GetLastError());
00321             <span class="keywordflow">break</span>;
00322         }
00323         pgpi++;
00324     }
00325 
00326     <span class="comment">/*</span>
00327 <span class="comment">     * If it got all procs, call OleInitialize</span>
00328 <span class="comment">     */</span>
00329     <span class="keywordflow">if</span> (pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00330         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = (*pfnOLEOleInitialize)(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00331         <span class="keywordflow">if</span> (SUCCEEDED(Status)) {
00332             <span class="keywordflow">goto</span> BackToKernel;
00333         } <span class="keywordflow">else</span> {
00334             RIPMSG1(RIP_WARNING, <span class="stringliteral">"LoadOLEOnce: OleInitialize failed:%#lx"</span>, Status);
00335         }
00336     }
00337 
00338     <span class="comment">/*</span>
00339 <span class="comment">     * Something failed; NULL out all function pointers</span>
00340 <span class="comment">     *   free the library and mark hinstOLE so we won't comeback here</span>
00341 <span class="comment">     */</span>
00342     pgpi = gpi;
00343     <span class="keywordflow">while</span> (pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00344         *(pgpi-&gt;<a class="code" href="../../d9/d5/structtagGETPROCINFO.html#o0">ppfn</a>) = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00345         pgpi++;
00346     }
00347     FreeLibrary(ghinstOLE);
00348 
00349 OLEWontLoad:
00350     <a class="code" href="../../d1/d8/clglobal_8c.html#a61">ghinstOLE</a> = <a class="code" href="../../d6/d0/usercli_8h.html#a282">OLEWONTLOAD</a>;
00351     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_UNSUCCESSFUL;
00352 
00353 BackToKernel:
00354     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00355 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="menuddc.c::mndtAddRef" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG mndtAddRef           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pdt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00032">32</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00042">mndtQueryInterface()</a>.
<p>
<pre class="fragment"><div>00033 {
00034     <span class="keywordflow">return</span> ++(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;dwRefCount);
00035 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="menuddc.c::mndtDragEnter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT mndtDragEnter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname" nowrap> <em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDATAOBJECT&nbsp;</td>
          <td class="mdname" nowrap> <em>pdo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>grfKeyState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>POINTL&nbsp;</td>
          <td class="mdname" nowrap> <em>ptl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pdwEffect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00139">139</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00074">mndtDragOver()</a>, and <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>.
<p>
<pre class="fragment"><div>00140 {
00141     <span class="comment">/*</span>
00142 <span class="comment">     * Save the IDataObject</span>
00143 <span class="comment">     */</span>
00144     <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pido = pdo;
00145 
00146     <span class="comment">/*</span>
00147 <span class="comment">     * DragEnter is the same as a DragOver; only that we will never fail it</span>
00148 <span class="comment">     */</span>
00149     <a class="code" href="../../d9/d7/menuddc_8c.html#a5">mndtDragOver</a>(pdt, grfKeyState, ptl, pdwEffect);
00150 
00151     <span class="keywordflow">return</span> NOERROR;
00152 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="menuddc.c::mndtDragLeave" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT mndtDragLeave           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pdt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00158">158</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05473">NtUserMNDragLeave()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00182">mndtDrop()</a>.
<p>
<pre class="fragment"><div>00159 {
00160     <span class="comment">/*</span>
00161 <span class="comment">     * Let the kernel mode clean up</span>
00162 <span class="comment">     */</span>
00163     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a211">NtUserMNDragLeave</a>();
00164 
00165     <span class="comment">/*</span>
00166 <span class="comment">     *  DragLeave and Release the current item, if any</span>
00167 <span class="comment">     */</span>
00168     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00169         <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;DragLeave(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00170         <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;Release(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00171         <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00172     }
00173 
00174     <span class="keywordflow">return</span> NOERROR;
00175 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="menuddc.c::mndtDragOver" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT mndtDragOver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname" nowrap> <em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>grfKeyState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>POINTL&nbsp;</td>
          <td class="mdname" nowrap> <em>ptl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pdwEffect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00074">74</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03686">tagMNDRAGOVERINFO::dwFlags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03687">tagMNDRAGOVERINFO::hmenu</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03689">tagMNDRAGOVERINFO::hwndNotify</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02763">MFMWFP_NOITEM</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1145">MNDRAGOVERINFO</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05432">NtUserMNDragOver()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03688">tagMNDRAGOVERINFO::uItemIndex</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00139">mndtDragEnter()</a>.
<p>
<pre class="fragment"><div>00075 {
00076     <a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html">MNDRAGOVERINFO</a> mndoi;
00077     MENUGETOBJECTINFO mngoi;
00078 
00079     <span class="comment">/*</span>
00080 <span class="comment">     * Get the dragover info for the selection corresponding to this point</span>
00081 <span class="comment">     */</span>
00082     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a210">NtUserMNDragOver</a>((POINT *)&amp;ptl, &amp;mndoi)) {
00083         RIPMSG0(RIP_WARNING, <span class="stringliteral">"mndtDragOver: NtUserDragOver failed"</span>);
00084         *pdwEffect = DROPEFFECT_NONE;
00085         <span class="keywordflow">return</span> NOERROR;
00086     }
00087 
00088     <span class="comment">/*</span>
00089 <span class="comment">     * If not switching items or crossing gap boundaries, pass the</span>
00090 <span class="comment">     *  the drag over.</span>
00091 <span class="comment">     */</span>
00092     <span class="keywordflow">if</span> (!(mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o0">dwFlags</a> &amp; MNGOF_CROSSBOUNDARY)) {
00093         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00094             <span class="keywordflow">return</span> <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;DragOver(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt, grfKeyState, ptl, pdwEffect);
00095         }
00096     } <span class="keywordflow">else</span> {
00097         <span class="comment">/*</span>
00098 <span class="comment">         *  DragLeave and Release the current item, if any</span>
00099 <span class="comment">         */</span>
00100         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00101             <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;DragLeave(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00102             <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;Release(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00103             <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00104         }
00105 
00106         <span class="comment">/*</span>
00107 <span class="comment">         * If an item is selected, Get the interface for it</span>
00108 <span class="comment">         */</span>
00109         <span class="keywordflow">if</span> (mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o2">uItemIndex</a> != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a778">MFMWFP_NOITEM</a>) {
00110             mngoi.hmenu = mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o1">hmenu</a>;
00111             mngoi.dwFlags = mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o0">dwFlags</a> &amp; MNGOF_GAP;
00112             mngoi.uPos = mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o2">uItemIndex</a>;
00113             mngoi.riid = (PVOID)&amp;IID_IDropTarget;
00114             mngoi.pvObj = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00115 
00116             <span class="keywordflow">if</span> (MNGO_NOERROR == <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(mndoi.<a class="code" href="../../d7/d1/structtagMNDRAGOVERINFO.html#o3">hwndNotify</a>, WM_MENUGETOBJECT, 0, (LPARAM)&amp;mngoi)) {
00117                 <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt = mngoi.pvObj;
00118             }
00119         }
00120 
00121         <span class="comment">/*</span>
00122 <span class="comment">         * If we got a new interface, AddRef and DragEnter it</span>
00123 <span class="comment">         */</span>
00124         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00125             <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;AddRef(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00126             <span class="keywordflow">return</span> <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;DragEnter(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt, <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pido, grfKeyState, ptl, pdwEffect);
00127         }
00128     } <span class="comment">/* if (!(mndoi.dwFlags &amp; MNGOF_CROSSBOUNDARY)) */</span>
00129 
00130     *pdwEffect = DROPEFFECT_NONE;
00131     <span class="keywordflow">return</span> NOERROR;
00132 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="menuddc.c::mndtDrop" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT mndtDrop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname" nowrap> <em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDATAOBJECT&nbsp;</td>
          <td class="mdname" nowrap> <em>pdo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>grfKeyState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>POINTL&nbsp;</td>
          <td class="mdname" nowrap> <em>ptl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pdwEffect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00182">182</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00158">mndtDragLeave()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>.
<p>
<pre class="fragment"><div>00183 {
00184     HRESULT hres;
00185 
00186     <span class="comment">/*</span>
00187 <span class="comment">     * If we got a target, pass the drop and release it.</span>
00188 <span class="comment">     */</span>
00189     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00190         hres = <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;Drop(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt, pdo, grfKeyState, ptl, pdwEffect);
00191         <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt-&gt;lpVtbl-&gt;Release(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt);
00192         <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;pidt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00193     } <span class="keywordflow">else</span> {
00194         *pdwEffect = DROPEFFECT_NONE;
00195         hres = NOERROR;
00196     }
00197 
00198     <span class="comment">/*</span>
00199 <span class="comment">     * Clean up</span>
00200 <span class="comment">     */</span>
00201     <a class="code" href="../../d9/d7/menuddc_8c.html#a7">mndtDragLeave</a>(pdt);
00202 
00203     <span class="keywordflow">return</span> hres;
00204 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="menuddc.c::mndtQueryInterface" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT mndtQueryInterface           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname" nowrap> <em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>REFIID&nbsp;</td>
          <td class="mdname" nowrap> <em>riid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppvObj</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00042">42</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00032">mndtAddRef()</a>.
<p>
<pre class="fragment"><div>00043 {
00044     <span class="keywordflow">if</span> (IsEqualIID(riid, &amp;IID_IUnknown) || IsEqualIID(riid, &amp;IID_IDropTarget)) {
00045         <a class="code" href="../../d9/d7/menuddc_8c.html#a2">mndtAddRef</a>(pdt);
00046         *ppvObj = pdt;
00047         <span class="keywordflow">return</span> NOERROR;
00048     } <span class="keywordflow">else</span> {
00049         <span class="keywordflow">return</span> E_NOINTERFACE;
00050     }
00051 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="menuddc.c::mndtRelease" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG mndtRelease           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPDROPTARGET&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pdt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00059">59</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
References <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00022">PMNIDT</a>.
<p>
<pre class="fragment"><div>00060 {
00061     <span class="keywordflow">if</span> (--(<a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;dwRefCount) != 0) {
00062         <span class="keywordflow">return</span> <a class="code" href="../../d9/d7/menuddc_8c.html#a0">PMNIDT</a>(pdt)-&gt;dwRefCount;
00063     }
00064 
00065     LocalFree(pdt);
00066     <span class="keywordflow">return</span> NOERROR;
00067 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a1" doxytag="menuddc.c::idtVtbl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> IDropTargetVtbl <a class="el" href="../../d9/d7/menuddc_8c.html#a1">idtVtbl</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <a class="code" href="../../d9/d7/menuddc_8c.html#a3">mndtQueryInterface</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a2">mndtAddRef</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a4">mndtRelease</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a6">mndtDragEnter</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a5">mndtDragOver</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a7">mndtDragLeave</a>,
    <a class="code" href="../../d9/d7/menuddc_8c.html#a8">mndtDrop</a>
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00210">210</a> of file <a class="el" href="../../d0/d7/menuddc_8c-source.html">menuddc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/menuddc_8c-source.html#l00224">__ClientRegisterDragDrop()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:38 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
