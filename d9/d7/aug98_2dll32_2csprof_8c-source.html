<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: csprof.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>csprof.c</h1><a href="../../d8/d8/aug98_2dll32_2csprof_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include "<a class="code" href="../../d8/d9/aug98_2dll32_2generic_8h.html">generic.h</a>"</span>
00002 
00003 <span class="preprocessor">#pragma code_seg(_ICM2SEG)</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#pragma optimize("",off)</span>
00005 <span class="preprocessor"></span>
<a name="l00006"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">00006</a> <span class="preprocessor">#define TempBfSize 128</span>
<a name="l00007"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a2">00007</a> <span class="preprocessor"></span><span class="preprocessor">#define LINELENG   128</span>
00008 <span class="preprocessor"></span><span class="preprocessor">#ifdef ICMDLL</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#define ICM2SEG</span>
00010 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00011 <span class="preprocessor"></span>
<a name="l00012"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">00012</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>[]       = <span class="stringliteral">"\n"</span> ;
<a name="l00013"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a4">00013</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>[] = <span class="stringliteral">"&lt;~"</span>;
<a name="l00014"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a5">00014</a> <span class="keyword">static</span>  <span class="keywordtype">char</span>    ICM2SEG <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>[] = <span class="stringliteral">"~&gt; cvx exec "</span>;
00015 
00016 <span class="comment">//******************************************************************</span>
00017 <span class="comment">//   Local functions to deal with output to the memory buffer</span>
00018 
<a name="l00019"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a6">00019</a> <span class="keyword">static</span>  <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a6">CPLastError</a>;
00020 
<a name="l00021"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">00021</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>     <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(SINT LastError)
00022 {
00023     <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a6">CPLastError</a> = LastError;
00024     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00025 }
00026 
<a name="l00027"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a8">00027</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>     <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a8">GetCPLastError</a>()
00028 {
00029     <span class="keywordflow">return</span>(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a6">CPLastError</a>);
00030 }
00031 
<a name="l00032"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a57">00032</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(SINT Size, HGLOBAL FAR *hMemory, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a> lpMH)
00033 {
00034     HGLOBAL hMem;
00035     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>  lpMem;
00036 
00037     *hMemory = 0;
00038     <span class="keywordflow">if</span>(lpMH == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00039     {
00040         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00041         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00042     }
00043 
00044     hMem = GlobalAlloc(GHND, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ;
00045     <span class="keywordflow">if</span>(hMem == 0 )
00046     {
00047         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a40">CP_MEMORY_ALLOC_ERR</a>);
00048         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00049     }
00050 
00051     lpMem = GlobalLock(hMem);
00052     <span class="keywordflow">if</span>(lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00053     {
00054         GlobalFree(hMem);
00055         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a40">CP_MEMORY_ALLOC_ERR</a>);
00056         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00057     }
00058     *lpMH = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)lpMem ;
00059     *hMemory = hMem;
00060     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00061 }
00062 
<a name="l00063"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a58">00063</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(HGLOBAL hMem)
00064 {
00065     <span class="keywordflow">if</span>(hMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
00066     {
00067         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00068         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00069     }
00070 
00071     GlobalUnlock(hMem);
00072     GlobalFree(hMem) ;
00073     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00074 }
00075 
00076 <span class="comment">//******************************************************************</span>
00077 <span class="comment">//      Low-level Profile functions - used for individual tag access</span>
00078 <span class="comment">//******************************************************************</span>
00079 <span class="preprocessor">#ifndef ICMDLL</span>
<a name="l00080"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a7">00080</a> <span class="preprocessor"></span><a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a7">LoadCP</a>(LPCSTR filename, HGLOBAL FAR *phMem, LPCHANDLE lpCP)
00081 {
00082     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
00083     HFILE       hFile;
00084     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res, CPSize;
00085     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      mpCP;
00086 
00087     *phMem = 0;
00088     <span class="keywordflow">if</span> (lpCP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00089     {
00090         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00091         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00092     }
00093 
00094     hFile = _lopen(filename, READ );
00095     <span class="keywordflow">if</span>( hFile == HFILE_ERROR )
00096     {
00097         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a41">CP_FILE_OPEN_ERR</a>);
00098         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00099     }
00100  
00101     Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader));
00102     <span class="keywordflow">if</span>( (Res == HFILE_ERROR) ||
00103         (Res != <span class="keyword">sizeof</span>(CPHeader)) )
00104     {
00105         _lclose(hFile);
00106         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a42">CP_FILE_READ_ERR</a>);
00107         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00108     }
00109 
00110     <span class="comment">// Make the initial check for validity of the profile</span>
00111     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
00112     {
00113         _lclose(hFile);
00114         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a43">CP_FORMAT_ERR</a>);
00115         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00116     }
00117 
00118     CPSize = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(CPHeader.size);
00119     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(CPSize, phMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;mpCP) )
00120     {
00121 
00122         *lpCP = (<a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a5">CHANDLE</a>) mpCP;  <span class="comment">// Put the memory pointer as  handle</span>
00123         <span class="comment">// Read profile into  memory</span>
00124          _lseek(hFile, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>, SEEK_SET);
00125 
00126         <span class="keywordflow">while</span>(CPSize)
00127         {
00128             Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) mpCP, 4096);
00129             <span class="keywordflow">if</span> (Res == HFILE_ERROR) 
00130             {
00131                 _lclose(hFile);
00132                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a42">CP_FILE_READ_ERR</a>);
00133                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00134             }
00135             mpCP    += Res;
00136             CPSize  -= Res;
00137         }
00138     }<span class="keywordflow">else</span>
00139     {
00140         *phMem = 0;
00141         _lclose(hFile);
00142         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00143     }
00144     _lclose(hFile);
00145     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00146 }
00147 
00148 <span class="preprocessor">#else</span>
00149 <span class="preprocessor"></span><span class="comment">//******************************************************************</span>
00150 <span class="comment">//      Low-level Profile functions - used for individual tag access</span>
00151 <span class="comment">//******************************************************************</span>
00152 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a8">LoadCP32</a>(LPCSTR filename, HGLOBAL *phMem, LPCHANDLE lpCP)
00153 {
00154     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
00155     HANDLE      hFile;
00156     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res, CPSize;
00157     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      mpCP;
00158     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        Success;
00159 
00160     <span class="keywordflow">if</span> (lpCP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00161     {
00162         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_NULL_POINTER_ERR);
00163         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00164     }
00165     hFile = CreateFile(filename, GENERIC_READ, 0, NULL, OPEN_EXISTING, 0, NULL);
00166     <span class="keywordflow">if</span>( hFile == <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a> )
00167     {
00168         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_OPEN_ERR);
00169         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00170     }
00171 
00172     Success = ReadFile(hFile, (LPVOID) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader), &amp;Res, NULL);
00173     <span class="keywordflow">if</span>( ( !Success ) || (Res != <span class="keyword">sizeof</span>(CPHeader)) )
00174     {
00175         CloseHandle(hFile);
00176         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_READ_ERR);
00177         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00178     }
00179 
00180     <span class="comment">// Make the initial check for validity of the profile</span>
00181     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
00182     {
00183         CloseHandle(hFile);
00184         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FORMAT_ERR);
00185         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00186     }
00187 
00188     CPSize = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(CPHeader.size);
00189     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a>(CPSize, phMem, (LPMEMPTR) &amp;mpCP) )
00190     {
00191 
00192         *lpCP = (<a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a5">CHANDLE</a>) mpCP;  <span class="comment">// Put the memory pointer as  handle</span>
00193         <span class="comment">// Read profile into  memory</span>
00194         SetFilePointer(hFile, 0L, NULL, FILE_BEGIN);
00195         Success = ReadFile(hFile, (LPVOID) (LPVOID)mpCP, CPSize, &amp;Res, NULL);
00196         <span class="keywordflow">if</span> (!Success) 
00197         {
00198             CloseHandle(hFile);
00199             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(CP_FILE_READ_ERR);
00200             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00201         }
00202     }<span class="keywordflow">else</span>
00203     {
00204         CloseHandle(hFile);
00205         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00206     }
00207     CloseHandle(hFile);
00208     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00209 }
00210 <span class="preprocessor">#endif</span>
00211 <span class="preprocessor"></span>
<a name="l00212"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a9">00212</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a9">FreeCP</a>(HGLOBAL hMem)
00213 {
00214     <span class="keywordflow">return</span>( <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hMem) );
00215 }
00216 
00217 
<a name="l00218"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a13">00218</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a13">GetCPElementCount</a>(CHANDLE CP, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a> lpCount)
00219 {
00220     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00221     <span class="keywordflow">if</span> (lpCount == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00222     {
00223         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00224         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00225     }
00226     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00227     *lpCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00228     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00229 }
00230 
00231 
<a name="l00232"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a14">00232</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CHANDLE CP, SINT Index,
00233                                 LPMEMPTR lpTagData, LPMEMPTR lpElemData)
00234 {
00235     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00236     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00237 
00238     <span class="keywordflow">if</span> ( (lpTagData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (lpElemData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) )
00239     {
00240         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00241         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00242     }
00243 
00244     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00245     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00246     <span class="keywordflow">if</span> ( <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> &lt;= <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> )
00247     {
00248         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a44">CP_OUT_OF_RANGE_ERR</a>);
00249         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00250     }
00251     *lpTagData      = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp;(lpTL-&gt;tags[0])) + (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>)) ;
00252     *lpElemData     = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) CP) +
00253                                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)*lpTagData)-&gt;offset);
00254     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00255 }
00256 
00257 
00258 <span class="comment">/* Checks if the profile has all required fields  for</span>
00259 <span class="comment">    this specific type of the color profile             */</span>
<a name="l00260"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a10">00260</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a10">ValidateCP</a>(CHANDLE CP)
00261 {
00262     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    Result;
00263     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>    ProfileClass;
00264 
00265     <span class="keywordflow">if</span>(<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a25">GetCPClass</a>(CP, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;ProfileClass) )
00266     {
00267         <span class="comment">// All profiles must have a ProfileDescription and</span>
00268         <span class="comment">//  a Copyright  tags.</span>
00269 
00270         <span class="keywordflow">if</span>( !<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a44">icSigProfileDescriptionTag</a>) || 
00271             !<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a29">icSigCopyrightTag</a> ) )
00272         {
00273             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00274             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00275         }
00276 
00277         <span class="comment">// All profiles, except Device-link, must have a mediaWhitePoint Tag</span>
00278         <span class="keywordflow">switch</span>( ProfileClass )
00279         {
00280             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a125">icSigLinkClass</a> :        <span class="comment">/* 'link' */</span>
00281                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00282                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>)
00283                   )
00284                 {
00285                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00286                 }<span class="keywordflow">else</span>
00287                 {
00288                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00289                 }
00290                 <span class="keywordflow">break</span>;
00291 
00292             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a122">icSigInputClass</a>:       <span class="comment">/* 'scnr' */</span>
00293                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) ||
00294                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>)      )
00295                 {
00296                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00297                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) )
00298                 {
00299                     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00300                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00301                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>) &amp;&amp;
00302                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>) &amp;&amp;
00303                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>)
00304                       )
00305                     {
00306                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00307                     }<span class="keywordflow">else</span>
00308                     {
00309                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00310                     }
00311                 }<span class="keywordflow">else</span>
00312                 {
00313                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00314                 }
00315                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00316                 <span class="keywordflow">break</span>;
00317 
00318             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a123">icSigDisplayClass</a>:     <span class="comment">/* 'mntr' */</span>
00319                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) )
00320                 {
00321                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00322                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) )
00323                 {
00324                     <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00325                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00326                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>) &amp;&amp;
00327                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>) &amp;&amp;
00328                         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>)
00329                       )
00330                     {
00331                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00332                     }<span class="keywordflow">else</span>
00333                     {
00334                         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00335                     }
00336                 }<span class="keywordflow">else</span>
00337                 {
00338                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00339                 }
00340                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00341                 <span class="keywordflow">break</span>;
00342 
00343             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a124">icSigOutputClass</a>:      <span class="comment">/* 'prtr' */</span>
00344                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) )
00345                 {
00346                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00347                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00348                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a18">icSigAToB1Tag</a>) &amp;&amp;
00349                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a19">icSigAToB2Tag</a>) &amp;&amp;
00350                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>) &amp;&amp;
00351                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>) &amp;&amp;
00352                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>) &amp;&amp;
00353                           <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a32">icSigGamutTag</a>) 
00354                         )
00355                 {
00356                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00357                 }<span class="keywordflow">else</span>
00358                 {
00359                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00360                 }
00361                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00362                 <span class="keywordflow">break</span>;
00363 
00364             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a126">icSigAbstractClass</a>:    <span class="comment">/* 'abst' */</span>
00365                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) )
00366                 {
00367                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00368                 }<span class="keywordflow">else</span>
00369                 {
00370                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00371                 }
00372                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00373                 <span class="keywordflow">break</span>;
00374 
00375             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a127">icSigColorSpaceClass</a>:  <span class="comment">/* 'spac' */</span>
00376                 <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>) &amp;&amp;
00377                     <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>)
00378                   )
00379                 {
00380                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00381                 }<span class="keywordflow">else</span>
00382                 {
00383                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00384                 }
00385                 Result  &amp;= <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CP, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>);
00386                 <span class="keywordflow">break</span>;
00387 
00388             <span class="keywordflow">default</span>:
00389                 Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00390                 <span class="keywordflow">break</span>;
00391         }
00392     }<span class="keywordflow">else</span>
00393     {
00394         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00395     }
00396     <span class="keywordflow">if</span>( Result == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> )
00397     {
00398         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00399     }
00400     <span class="keywordflow">return</span>(Result);
00401 }
00402 
<a name="l00403"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a11">00403</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(CHANDLE CP, CSIG CPTag)
00404 {
00405     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00406     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   Data;
00407     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00408 
00409     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00410     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00411     Data    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)  &amp;(lpTL-&gt;tags[0]) ; 
00412     <span class="keywordflow">while</span> ( <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>-- )
00413     {
00414         <span class="keywordflow">if</span>(  <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)Data)-&gt;sig) == CPTag )
00415         {
00416             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00417         }<span class="keywordflow">else</span>
00418         {
00419             Data    += <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>);   <span class="comment">// Bump pointer to the next tag</span>
00420         }
00421     }
00422     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00423 }
00424 
00425 
<a name="l00426"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">00426</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(CHANDLE CP, CSIG CPTag, LPSINT lpIndex)
00427 {
00428     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00429     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   Data;
00430     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
00431     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a> lpTL;
00432 
00433     <span class="keywordflow">if</span> (lpIndex == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00434     {
00435         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00436         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00437     }
00438 
00439     lpTL = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a32">lpcpTagList</a>) &amp;(((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a30">lpcpProfile</a>)CP)-&gt;count);
00440     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>   = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>(lpTL-&gt;count);
00441     Data    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)  &amp;(lpTL-&gt;tags[0]) ;
00442 
00443     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>; i++ )
00444     {
00445         <span class="keywordflow">if</span>(  <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)Data)-&gt;sig) == CPTag )
00446         {
00447             *lpIndex = i;
00448             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00449         }<span class="keywordflow">else</span>
00450         {
00451             Data    += <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structicTag.html">icTag</a>);   <span class="comment">// Bump pointer to the next tag</span>
00452         }
00453     }
00454 
00455     <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a46">CP_NOT_FOUND_ERR</a>);
00456     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00457 }
00458 
00459 
00460 
<a name="l00461"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">00461</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a>(CHANDLE CP, SINT Index, LPCSIG lpCPTag)
00462 {
00463     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00464     <span class="keywordflow">if</span> (lpCPTag == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00465     {
00466         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00467         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00468     }
00469     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00470             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00471     {
00472         *lpCPTag    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;sig ) ;
00473     }<span class="keywordflow">else</span>
00474     {
00475         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00476     }
00477     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00478 }
00479 
00480 <span class="comment">//***************************************************************</span>
00481 <span class="comment">//      Function applicable to the elements</span>
00482 <span class="comment">//</span>
00483 <span class="comment">//***************************************************************</span>
00484 
<a name="l00485"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">00485</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a>(CHANDLE CP, SINT Index, LPCSIG lpCSig)
00486 {
00487     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00488     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00489             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00490     {
00491         *lpCSig    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a34">lpcpTagBase</a>)ElemData)-&gt;sig ) ;
00492     }<span class="keywordflow">else</span>
00493     {
00494         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00495     }
00496     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00497 }
00498 
00499 
00500 
<a name="l00501"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a17">00501</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a>(CHANDLE CP, SINT Index, LPSINT lpSize)
00502 {
00503     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00504     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00505     {
00506         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00507         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00508     }
00509 
00510     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00511             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00512     {
00513         *lpSize     = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size );
00514     }<span class="keywordflow">else</span>
00515     {
00516         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00517     }
00518 
00519     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00520 }
00521 
<a name="l00522"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a18">00522</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(CHANDLE CP, SINT Index, LPSINT lpSize)
00523 {
00524     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>  TagData, ElemData;
00525     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00526     {
00527         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00528         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00529     }
00530 
00531     <span class="keywordflow">if</span> ( <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00532             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00533     {
00534 <span class="comment">//  Changed by jjia 8/24/95</span>
00535 <span class="comment">//        *lpSize     = ui32toSINT( ((lpcpTag)TagData)-&gt;size ) -</span>
00536 <span class="comment">//                                             sizeof(lpcpTagBase);</span>
00537     *lpSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size) - 
00538                     <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00539     }<span class="keywordflow">else</span>
00540     {
00541         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00542     }
00543 
00544     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00545 }
00546 
00547 <span class="comment">//***************************************************************</span>
00548 <span class="comment">//  The difference between GetCPElement and GetCPElementData</span>
00549 <span class="comment">//  is that GetCPElement reads all fields of the element,</span>
00550 <span class="comment">//  including the data tag, reserved fields and element data,</span>
00551 <span class="comment">//  while GetCPElementData only reads the actual data.</span>
00552 <span class="comment">//  Number of bytes that are required to hold the whole data element can be</span>
00553 <span class="comment">//  obtained by calling the function GetCPElementSize().</span>
00554 <span class="comment">//  The actulal number of data bytes is determined by</span>
00555 <span class="comment">//  the call to GetCPElementDataSize().</span>
00556 <span class="comment">//***************************************************************</span>
<a name="l00557"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">00557</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a>(CHANDLE CP, SINT Index,
00558                                MEMPTR lpData, SINT Size)
00559 {
00560     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        ElemSize;
00561     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      TagData, ElemData;
00562     <span class="keywordflow">if</span> (lpData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00563     {
00564         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00565         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00566     }
00567 
00568     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00569             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00570     {
00571         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00572     }
00573     ElemSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size);
00574     <span class="keywordflow">if</span>(ElemSize &gt; <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> )
00575     {
00576         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a45">CP_NO_MEMORY_ERR</a>);
00577         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00578     }
00579     MemCopy(lpData, ElemData, ElemSize);
00580     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00581 
00582 }
00583 
00584 
<a name="l00585"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a20">00585</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(CHANDLE CP, SINT Index,
00586                                 MEMPTR lpData, SINT Size)
00587 {
00588     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     ElemSize;
00589     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00590     <span class="keywordflow">if</span> (lpData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00591     {
00592         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00593         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00594     }
00595 
00596     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00597             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00598     {
00599         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00600     }
00601 <span class="comment">//  Changed by jjia 8/24/95</span>
00602 <span class="comment">//    ElemData    +=  sizeof(lpcpTagBase);</span>
00603 <span class="comment">//    ElemSize    = ui32toSINT( ((lpcpTag)TagData)-&gt;size) - </span>
00604 <span class="comment">//                     sizeof(lpcpTagBase);</span>
00605     ElemData    +=  <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) + <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00606     ElemSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a33">lpcpTag</a>)TagData)-&gt;size) - 
00607                     <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a186">icUInt32Number</a>);
00608 
00609     <span class="keywordflow">if</span>(ElemSize &gt; <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> )
00610     {
00611         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a45">CP_NO_MEMORY_ERR</a>);
00612         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00613     }
00614 
00615     MemCopy(lpData, ElemData, ElemSize);
00616     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00617 }
00618 
00619 <span class="comment">// Check the data format is binary or ascii    8/22/95  jjia</span>
00620 
<a name="l00621"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a21">00621</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a195">GetCPElementDataType</a>(CHANDLE CP, SINT Index, <span class="keywordtype">long</span> far *lpDataType)
00622 {
00623     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   TagData, ElemData;
00624 
00625     <span class="keywordflow">if</span> (lpDataType == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00626     {
00627         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00628         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00629     }
00630 
00631     <span class="keywordflow">if</span> ( !<a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a14">GetCPElementInfo</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;TagData,
00632             (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp;ElemData) )
00633     {
00634         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00635     }
00636     ElemData    +=  <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/structicTagBase.html">icTagBase</a>);
00637     *lpDataType = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d6/d1/structicData.html">icData</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a0">__huge</a> *)ElemData)-&gt;dataFlag);
00638     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00639 }
00640 
<a name="l00641"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a14">00641</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a14">ValidateCPElement</a>(CHANDLE CP, SINT Index)
00642 {
00643     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>    TagSig, DataSig;
00644     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    Result;
00645     <span class="keywordflow">if</span>( <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;TagSig) &amp;&amp;
00646         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp;DataSig) )
00647     {
00648         <span class="keywordflow">switch</span>(TagSig)
00649         {
00650             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a17">icSigAToB0Tag</a>:
00651             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a18">icSigAToB1Tag</a>:
00652             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a19">icSigAToB2Tag</a>:
00653             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>:
00654             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>:
00655             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>:
00656             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a32">icSigGamutTag</a>:
00657             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a41">icSigPreview0Tag</a>:
00658             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a42">icSigPreview1Tag</a>:
00659             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a43">icSigPreview2Tag</a>:
00660                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a90">icSigLut16Type</a>) ||
00661                          (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>) ;
00662                 <span class="keywordflow">break</span>;
00663 
00664             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>: 
00665             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>:
00666             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>:
00667             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a36">icSigLuminanceTag</a>:
00668             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a38">icSigMediaBlackPointTag</a>:
00669             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>:
00670                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a107">icSigXYZType</a>);
00671                 <span class="keywordflow">break</span>;
00672 
00673             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>:
00674             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>:
00675             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>:
00676             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>:
00677                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>);
00678                 <span class="keywordflow">break</span>;
00679 
00680             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a46">icSigPs2CRD0Tag</a>:
00681             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a47">icSigPs2CRD1Tag</a>:
00682             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a48">icSigPs2CRD2Tag</a>:
00683             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a49">icSigPs2CRD3Tag</a>:
00684             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a50">icSigPs2CSATag</a>:
00685             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>:
00686             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>:
00687             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>:
00688             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>:
00689                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a88">icSigDataType</a>);
00690                 <span class="keywordflow">break</span>;
00691 
00692             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a28">icSigCharTargetTag</a>:
00693             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a29">icSigCopyrightTag</a>:
00694                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a98">icSigTextType</a>);
00695                 <span class="keywordflow">break</span>;
00696 
00697             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a27">icSigCalibrationDateTimeTag</a>:
00698                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a89">icSigDateTimeType</a>);
00699                 <span class="keywordflow">break</span>;
00700 
00701             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a30">icSigDeviceMfgDescTag</a>:
00702             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a31">icSigDeviceModelDescTag</a>:
00703             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a44">icSigProfileDescriptionTag</a>:
00704             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a57">icSigScreeningDescTag</a>:
00705             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a61">icSigViewingCondDescTag</a>:
00706                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a99">icSigTextDescriptionType</a>);
00707                 <span class="keywordflow">break</span>;
00708 
00709             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a37">icSigMeasurementTag</a>:
00710                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a37">icSigMeasurementTag</a>);
00711                 <span class="keywordflow">break</span>;
00712 
00713             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a40">icSigNamedColorTag</a>:
00714                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a40">icSigNamedColorTag</a>);
00715                 <span class="keywordflow">break</span>;
00716         
00717             <span class="keywordflow">case</span>      <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>:
00718                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a45">icSigProfileSequenceDescTag</a>);
00719                 <span class="keywordflow">break</span>;
00720 
00721             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a58">icSigScreeningTag</a>:
00722                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a58">icSigScreeningTag</a>);
00723                 <span class="keywordflow">break</span>;
00724 
00725             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a59">icSigTechnologyTag</a>:
00726                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a97">icSigSignatureType</a>);
00727                 <span class="keywordflow">break</span>;
00728 
00729             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a60">icSigUcrBgTag</a>:
00730                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a60">icSigUcrBgTag</a>);
00731                 <span class="keywordflow">break</span>;
00732 
00733             <span class="keywordflow">case</span>     <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a62">icSigViewingConditionsTag</a>:
00734                 Result = (DataSig == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a62">icSigViewingConditionsTag</a>);
00735                 <span class="keywordflow">break</span>;
00736 
00737             <span class="keywordflow">default</span>:
00738                 Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00739                 <span class="keywordflow">break</span>;
00740         }
00741     }<span class="keywordflow">else</span>
00742     {
00743         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00744     }
00745     <span class="keywordflow">return</span>(Result);
00746 }
00747 
00748 <span class="comment">//******************************************************************</span>
00749 <span class="comment">// Functions that get all information from the Color Profile Header</span>
00750 <span class="comment">//******************************************************************</span>
<a name="l00751"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a22">00751</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a22">GetCPSize</a>(CHANDLE CP, LPSINT lpSize)
00752 {
00753     <span class="keywordflow">if</span> (lpSize == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00754     {
00755         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00756         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00757     }
00758     *lpSize    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;size);
00759     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00760 }
00761 
<a name="l00762"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a23">00762</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a23">GetCPCMMType</a>(CHANDLE CP, LPCSIG lpType)
00763 {
00764     <span class="keywordflow">if</span> (lpType == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00765     {
00766         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00767         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00768     }
00769     *lpType    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;cmmId);
00770     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00771 }
00772 
<a name="l00773"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a24">00773</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a24">GetCPVersion</a>(CHANDLE CP, LPSINT lpVers)
00774 {
00775     <span class="keywordflow">if</span> (lpVers == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00776     {
00777         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00778         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00779     }
00780     *lpVers    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;version);
00781     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00782 }
00783 
<a name="l00784"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a25">00784</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a25">GetCPClass</a>(CHANDLE CP, LPCSIG lpClass)
00785 {
00786     <span class="keywordflow">if</span> (lpClass == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00787     {
00788         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00789         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00790     }
00791     *lpClass    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;deviceClass);
00792     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00793 }
00794 
<a name="l00795"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a26">00795</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a41">GetCPDevSpace</a>(CHANDLE CP, LPCSIG lpInSpace)
00796 {
00797     <span class="keywordflow">if</span> (lpInSpace == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00798     {
00799         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00800         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00801     }
00802     *lpInSpace    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;colorSpace);
00803     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00804 }
00805 
<a name="l00806"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a27">00806</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a>(CHANDLE CP, LPCSIG lpOutSpace)
00807 {
00808     <span class="keywordflow">if</span> (lpOutSpace == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00809     {
00810         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00811         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00812     }
00813     *lpOutSpace    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>);
00814     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00815 }
00816 
<a name="l00817"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a28">00817</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a28">GetCPTarget</a>(CHANDLE CP, LPCSIG lpTarget)
00818 {
00819     <span class="keywordflow">if</span> (lpTarget == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00820     {
00821         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00822         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00823     }
00824     *lpTarget    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;platform);
00825     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00826 }
00827 
<a name="l00828"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a29">00828</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a29">GetCPManufacturer</a>(CHANDLE CP, LPCSIG lpManuf)
00829 {
00830     <span class="keywordflow">if</span> (lpManuf == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00831     {
00832         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00833         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00834     }
00835     *lpManuf    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;manufacturer);
00836     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00837 }
00838 
<a name="l00839"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a30">00839</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a30">GetCPModel</a>(CHANDLE CP, LPCSIG lpModel)
00840 {
00841     <span class="keywordflow">if</span> (lpModel == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00842     {
00843         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00844         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00845     }
00846     *lpModel    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;model);
00847     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00848 }
00849 
<a name="l00850"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a31">00850</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a31">GetCPFlags</a>(CHANDLE CP, LPSINT lpFlags)
00851 {
00852     <span class="keywordflow">if</span> (lpFlags == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00853     {
00854         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00855         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00856     }
00857     *lpFlags    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;flags);
00858     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00859 }
00860 
<a name="l00861"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a35">00861</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a42">GetCPRenderIntent</a>(CHANDLE CP, LPSINT lpIntent)
00862 {
00863     <span class="keywordflow">if</span> (lpIntent == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00864     {
00865         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00866         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00867     }
00868     *lpIntent    = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;renderingIntent);
00869     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00870 }
00871 
<a name="l00872"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a33">00872</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a>(CHANDLE CP,  <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a> lpWP)
00873 {
00874     <span class="keywordflow">if</span> (lpWP == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00875     {
00876         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a39">CP_NULL_POINTER_ERR</a>);
00877         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00878     }
00879     lpWP[0]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.X);
00880     lpWP[1]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.Y);
00881     lpWP[2]    = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a>( ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a31">lpcpHeader</a>)CP)-&gt;illuminant.Z);
00882     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00883 }
00884 
<a name="l00885"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a32">00885</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a32">GetCPAttributes</a>(CHANDLE CP, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a28">LPATTRIB</a> lpAttributes)
00886 {
00887     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00888 }
00889 
<a name="l00890"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a34">00890</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a>(CHANDLE cp,  LPSFLOAT lpMediaWP)
00891 {
00892     HGLOBAL   hTempMem;
00893     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      TempSize;
00894     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    TempBuff;
00895     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    lpTable;
00896     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      i, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00897 
00898     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>) &amp;&amp;
00899         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a39">icSigMediaWhitePointTag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00900         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; TempSize) &amp;&amp;
00901         <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (TempSize, (HGLOBAL *) &amp; hTempMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; TempBuff) &amp;&amp;
00902         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, TempBuff, TempSize))
00903     {
00904         lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp; (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a38">lpcpXYZType</a>) TempBuff)-&gt;data);
00905         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
00906         {
00907             lpMediaWP[i] = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a> (lpTable);
00908             lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a192">icS15Fixed16Number</a>);
00909         }
00910         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hTempMem);
00911         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00912     }
00913     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00914 }
00915 
00916 <span class="comment">/***************************************************************************</span>
00917 <span class="comment">*                               GetPS2ColorRenderingIntent</span>
00918 <span class="comment">*  function:</span>
00919 <span class="comment">*    this is the function which creates the Intent string </span>
00920 <span class="comment">*    from the data supplied in the Profile that can be used</span>
00921 <span class="comment">*    in --findcolorrendering-- operator.</span>
00922 <span class="comment">*  prototype:</span>
00923 <span class="comment">*       BOOL EXTERN GetPS2ColorRenderingIntent(</span>
00924 <span class="comment">*                          char         *FileName,</span>
00925 <span class="comment">*                          DWORD        Intent, </span>
00926 <span class="comment">*                          MEMPTR       lpMem,</span>
00927 <span class="comment">*                          LPDWORD      lpcbSize )</span>
00928 <span class="comment">*  parameters:</span>
00929 <span class="comment">*       FileName    --  Color Profile Filename</span>
00930 <span class="comment">*       Intent      --  Intent </span>
00931 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00932 <span class="comment">*       lpcbSize        --  Size of the memory block</span>
00933 <span class="comment">*                       Returns number of bytes required/transferred</span>
00934 <span class="comment">*  returns:</span>
00935 <span class="comment">*       BOOL        --  TRUE   if the function was successful,</span>
00936 <span class="comment">*                       FALSE  otherwise.</span>
00937 <span class="comment">***************************************************************************/</span>
<a name="l00938"></a><a class="code" href="../../d9/d9/jul98_2test_2ps2color_8h.html#a2">00938</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a28">GetPS2ColorRenderingIntent</a>(CHANDLE cp, DWORD Intent,
00939                                        MEMPTR lpMem, LPDWORD lpcbSize)
00940 {
00941     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>       <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00942     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>       <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00943         
00944     <span class="keywordflow">if</span> (!cp)
00945         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00946 
00947     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) *lpcbSize;
00948     <span class="keywordflow">if</span>( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) || ( <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> == 0 ) )
00949     {
00950         lpMem = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00951         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = 0;
00952         *lpcbSize = 0;
00953     }
00954         
00955     <span class="keywordflow">switch</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>)
00956     {
00957         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00958         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>) &amp;&amp;
00959             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a51">icSigPs2Intent0Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00960             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00961             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00962                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
00963         {
00964         }
00965         <span class="keywordflow">break</span>;
00966         
00967         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00968         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>) &amp;&amp;
00969             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a52">icSigPs2Intent1Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00970             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00971             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00972                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
00973         {
00974         }
00975         <span class="keywordflow">break</span>;
00976     
00977         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00978         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>) &amp;&amp;
00979             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a53">icSigPs2Intent2Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00980             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00981             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00982                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> ) )
00983           )
00984         {
00985         }
00986         <span class="keywordflow">break</span>;
00987         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00988         <span class="keywordflow">if</span>( <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>) &amp;&amp;
00989             <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a54">icSigPs2Intent3Tag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00990             <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp;<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) &amp;&amp;
00991             ( ( lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) ||
00992                 <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a>(cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) ) )
00993         {
00994         }
00995         <span class="keywordflow">break</span>;
00996         <span class="keywordflow">default</span>:
00997             <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = 0 ;
00998         <span class="keywordflow">break</span>;
00999     }
01000         
01001     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> != 0)
01002     {
01003         <span class="keywordflow">if</span> (lpMem)
01004         {
01005             lpMem[<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>] = <span class="charliteral">'\0'</span>;
01006         }
01007         <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> ++;
01008         *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
01009         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01010     }
01011     <span class="keywordflow">else</span>
01012     {
01013         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01014     }
01015 }
01016 
01017 <span class="comment">/***************************************************************************</span>
01018 <span class="comment">*</span>
01019 <span class="comment">*  Function to check if color matching mathod and icc profile type is </span>
01020 <span class="comment">*       supported by driver.</span>
01021 <span class="comment">*  parameters:</span>
01022 <span class="comment">*</span>
01023 <span class="comment">*  returns:</span>
01024 <span class="comment">*       BOOL:   TRUE or FALSE.</span>
01025 <span class="comment">*</span>
01026 <span class="comment">***************************************************************************/</span>
01027 
01028 <span class="preprocessor">#ifndef ICMDLL</span>
<a name="l01029"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a40">01029</a> <span class="preprocessor"></span><a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a40">ValidColorSpace</a>(LPPDEVICE lppd, <a class="code" href="../../d0/d7/structtagICMINFO.html">LPICMINFO</a> lpICMI, LPCSIG lpDevCS )
01030 {
01031     <a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>    CPHeader;
01032     HFILE       hFile;
01033     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        Res;
01034     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>        CPColorSpaceTag;
01035 
01036     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpICMI)
01037     {
01038         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01039     }
01040     hFile = _lopen(lpICMI-&gt;<a class="code" href="../../d0/d7/structtagICMINFO.html#o2">lcsDestFilename</a>, READ);
01041     <span class="keywordflow">if</span>( hFile == HFILE_ERROR )
01042     {
01043         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01044     }
01045 
01046     Res = _lread(hFile, (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) &amp;CPHeader, <span class="keyword">sizeof</span>(CPHeader));
01047     _lclose(hFile);
01048     <span class="keywordflow">if</span>( (Res == HFILE_ERROR) || (Res != <span class="keyword">sizeof</span>(CPHeader)) )
01049     {
01050         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01051     }
01052 
01053     <span class="comment">// Make the initial check for validity of the profile</span>
01054     <span class="keywordflow">if</span>( <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.magic) != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a0">icMagicNumber</a> )
01055     {
01056         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01057     }
01058     <span class="comment">// Make sure the profile is 'prtr'</span>
01059     <span class="comment">// SRGB98</span>
01060     <span class="comment">// if( SigtoCSIG(CPHeader.deviceClass) != icSigOutputClass )</span>
01061     <span class="comment">// {</span>
01062     <span class="comment">//     return(FALSE);</span>
01063     <span class="comment">// }</span>
01064     CPColorSpaceTag = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a10">SigtoCSIG</a>(CPHeader.colorSpace);
01065     *lpDevCS = CPColorSpaceTag;             <span class="comment">// 247974</span>
01066 
01067     <span class="keywordflow">switch</span> ( lppd-&gt;lpPSExtDevmode-&gt;dm.iColorMatchingMethod )
01068     {
01069         <span class="keywordflow">case</span> COLOR_MATCHING_ON_HOST:
01070             <span class="keywordflow">if</span> ((CPColorSpaceTag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>))
01071 <span class="comment">//                (CPColorSpaceTag == icSigRgbData))</span>
01072 <span class="comment">//                (CPColorSpaceTag == icSigGrayData))</span>
01073             {
01074                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01075             }
01076             <span class="keywordflow">break</span>;
01077             <span class="keywordflow">case</span> COLOR_MATCHING_ON_PRINTER:
01078             <span class="keywordflow">if</span> ((CPColorSpaceTag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a119">icSigCmyData</a>))
01079 <span class="comment">//                (CPColorSpaceTag == icSigGrayData))</span>
01080             {
01081                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01082             }
01083             <span class="keywordflow">break</span>;
01084         <span class="keywordflow">case</span> COLOR_MATCHING_PRINTER_CALIBRATION:
01085         <span class="keywordflow">default</span>:
01086             <span class="keywordflow">break</span>;
01087     }
01088     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01089 }
01090 <span class="preprocessor">#endif</span>
01091 <span class="preprocessor"></span>
01092 <span class="comment">//***************************************************************************</span>
01093 <span class="comment">//</span>
01094 <span class="comment">//      Set of functions to output data into memory buffer</span>
01095 <span class="comment">//</span>
01096 <span class="comment">//***************************************************************************</span>
01097 
01098 
01099 <span class="comment">/***************************************************************************</span>
01100 <span class="comment">*</span>
01101 <span class="comment">*   Function to put the chunk of memory as string of Hex</span>
01102 <span class="comment">*</span>
01103 <span class="comment">***************************************************************************/</span>
<a name="l01104"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a45">01104</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a227">WriteHexBuffer</a>(MEMPTR lpMem, MEMPTR lpBuff, MEMPTR lpLineStart, DWORD dwBytes)
01105 {
01106     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01107     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01108     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>  lpOldPtr = lpMem;
01109 
01110     <span class="keywordflow">for</span> ( ; dwBytes ; dwBytes-- )
01111     {
01112         Res = wsprintf( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)TempArray, (LPSTR) <span class="stringliteral">"%2.2x"</span>, *lpBuff );
01113         *lpMem++ = TempArray[0];
01114         *lpMem++ = TempArray[1];
01115         lpBuff++;
01116         <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
01117         {
01118             lpLineStart = lpMem;
01119             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(lpMem,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>);
01120         }
01121     }
01122     <span class="keywordflow">return</span>( (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(lpMem - lpOldPtr)); 
01123 }
01124 
01125 <span class="comment">/***************************************************************************</span>
01126 <span class="comment">*</span>
01127 <span class="comment">*   Function to put the string into the buffer</span>
01128 <span class="comment">*</span>
01129 <span class="comment">***************************************************************************/</span>
<a name="l01130"></a><a class="code" href="../../d7/d9/jul98_2dll32_2csprof_8h.html#a43">01130</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a>(MEMPTR lpMem, MEMPTR Obj)
01131 {
01132     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res1, Res2;
01133 
01134     Res1 = lstrlen(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>);
01135     MemCopy(lpMem, <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>, Res1);
01136 
01137     lpMem += Res1;
01138     Res2 = lstrlen(Obj);
01139     MemCopy(lpMem, Obj, Res2);
01140     <span class="keywordflow">return</span>( Res1 + Res2 );
01141 }
01142 
<a name="l01143"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a43">01143</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(MEMPTR lpMem, MEMPTR Obj)
01144 {
01145     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01146 
01147     Res = lstrlen(Obj);
01148     MemCopy(lpMem, Obj, Res);
01149     <span class="keywordflow">return</span>( Res );
01150 }
01151 
<a name="l01152"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a44">01152</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a44">WriteObjectN</a>(MEMPTR lpMem, MEMPTR Obj, SINT n)
01153 {
01154     MemCopy(lpMem, Obj, <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>);
01155     <span class="keywordflow">return</span>( <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> );
01156 }
01157 <span class="comment">/***************************************************************************</span>
01158 <span class="comment">*</span>
01159 <span class="comment">*   Function to write the integer into the buffer</span>
01160 <span class="comment">*</span>
01161 <span class="comment">***************************************************************************/</span>
<a name="l01162"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a41">01162</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a>(MEMPTR lpMem, SINT Number)
01163 {
01164     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01165     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01166     
01167     Res = wsprintf( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>)TempArray, <span class="stringliteral">"%lu "</span>, Number );
01168     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01169     <span class="keywordflow">return</span>( Res );
01170 }
01171 
01172 <span class="comment">/***************************************************************************</span>
01173 <span class="comment">*</span>
01174 <span class="comment">*   Function to write the integer into the buffer as hex</span>
01175 <span class="comment">*</span>
01176 <span class="comment">***************************************************************************/</span>
<a name="l01177"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a42">01177</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d2/d9/ps2_8c.html#a45">WriteHex</a>(MEMPTR lpMem, SINT Number)
01178 {
01179     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01180     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01181 
01182     Res = wsprintf( TempArray, <span class="stringliteral">"%2.2x"</span>, (<span class="keywordtype">int</span>)(Number &amp; 0x00FF) );
01183     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01184     <span class="keywordflow">return</span>( Res );
01185 }
01186 
01187 <span class="comment">/***************************************************************************</span>
01188 <span class="comment">*</span>
01189 <span class="comment">*   Function to write the float into the buffer</span>
01190 <span class="comment">*</span>
01191 <span class="comment">***************************************************************************/</span>
01192 
<a name="l01193"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a46">01193</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a46">WriteFloat</a>(MEMPTR lpMem, <span class="keywordtype">double</span> dFloat)
01194 {
01195     <span class="keywordtype">char</span>    cSign;
01196     <span class="keywordtype">double</span>  dInt ;
01197     <span class="keywordtype">double</span>  dFract ;
01198     LONG    lFloat ;
01199     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Res;
01200     <span class="keywordtype">char</span>    TempArray[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01201 
01202     lFloat = (LONG) floor( dFloat * 10000.0 + 0.5);
01203 
01204     dFloat = lFloat  / 10000.0 ;
01205 
01206     dInt = floor(fabs(dFloat));
01207     dFract =  fabs(dFloat) - dInt ;
01208 
01209     cSign   = <span class="charliteral">' '</span> ;
01210     <span class="keywordflow">if</span> ( dFloat &lt; 0 )
01211     {
01212         cSign   = <span class="charliteral">'-'</span> ;
01213     }
01214 
01215     Res = wsprintf( (LPSTR) TempArray, (LPSTR) <span class="stringliteral">"%c%d.%0.4lu "</span>,
01216        cSign, (WORD) dInt , (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) (dFract *10000.0)  );
01217     MemCopy(lpMem, TempArray, lstrlen(TempArray));
01218     <span class="keywordflow">return</span> ( Res );
01219 }
01220 
01221 <span class="comment">/***************************************************************************</span>
01222 <span class="comment">*</span>
01223 <span class="comment">*   Function to write the string token into the buffer</span>
01224 <span class="comment">*</span>
01225 <span class="comment">***************************************************************************/</span>
01226 
<a name="l01227"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a47">01227</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a228">WriteStringToken</a>(MEMPTR lpMem, BYTE Token, SINT sNum)
01228 {
01229     *lpMem++ = <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
01230     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((sNum &amp; 0xFF00) &gt;&gt; 8);
01231     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(sNum &amp; 0x00FF);
01232     <span class="keywordflow">return</span> (3);
01233 }
01234 
01235 <span class="comment">/***************************************************************************</span>
01236 <span class="comment">*</span>
01237 <span class="comment">*   Function to write the Homogeneous Number Array token into the buffer</span>
01238 <span class="comment">*</span>
01239 <span class="comment">***************************************************************************/</span>
01240 
<a name="l01241"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a52">01241</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a224">WriteHNAToken</a>(MEMPTR lpMem, BYTE Token, SINT sNum)
01242 {
01243     *lpMem++ = <a class="code" href="../../d6/d0/ctaccess_8c.html#a29">Token</a>;
01244     *lpMem++ = 32;       <span class="comment">// 16-bit fixed integer, high-order byte first</span>
01245     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((sNum &amp; 0xFF00) &gt;&gt; 8);
01246     *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(sNum &amp; 0x00FF);
01247     <span class="keywordflow">return</span> (4);
01248 }
01249 
01250 <span class="comment">/***************************************************************************</span>
01251 <span class="comment">*</span>
01252 <span class="comment">*   Function to convert 2-bytes unsigned integer to 2-bytes signed </span>
01253 <span class="comment">*   integer(-32768) and write them to the buffer. High byte first.</span>
01254 <span class="comment">*</span>
01255 <span class="comment">***************************************************************************/</span>
01256 
<a name="l01257"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a50">01257</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a225">WriteIntStringU2S</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sNum)
01258 {
01259     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01260     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Temp;
01261 
01262     <span class="keywordflow">for</span> (i = 0; i &lt; sNum; i ++)
01263     {
01264         Temp = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a>( lpBuff) - 32768;
01265         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((Temp &amp; 0xFF00) &gt;&gt; 8);
01266         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(Temp &amp; 0x00FF);
01267         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01268     }
01269     <span class="keywordflow">return</span>(sNum * 2); 
01270 }
01271 
01272 <span class="comment">/***************************************************************************</span>
01273 <span class="comment">*</span>
01274 <span class="comment">*   Function to convert 2-bytes unsigned integer to 2-bytes signed </span>
01275 <span class="comment">*   integer(-32768) and write them to the buffer. Low-order byte first.</span>
01276 <span class="comment">*</span>
01277 <span class="comment">***************************************************************************/</span>
01278 
<a name="l01279"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a51">01279</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a226">WriteIntStringU2S_L</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sNum)
01280 {
01281     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01282     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    Temp;
01283 
01284     <span class="keywordflow">for</span> (i = 0; i &lt; sNum; i ++)
01285     {
01286         Temp = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>)lpBuff) - 32768;
01287         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((Temp &amp; 0xFF00) &gt;&gt; 8);
01288         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(Temp &amp; 0x00FF);
01289         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01290     }
01291     <span class="keywordflow">return</span>(sNum * 2); 
01292 }
01293 
01294 <span class="comment">/***************************************************************************</span>
01295 <span class="comment">*</span>
01296 <span class="comment">*   Function to put the chunk of memory into buffer</span>
01297 <span class="comment">*</span>
01298 <span class="comment">***************************************************************************/</span>
<a name="l01299"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a48">01299</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a229">WriteByteString</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sBytes)
01300 {
01301     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01302 
01303     <span class="keywordflow">for</span> (i = 0; i &lt; sBytes; i ++)
01304         *lpMem++ = *lpBuff++;
01305     
01306     <span class="keywordflow">return</span>(sBytes); 
01307 }
01308 
01309 <span class="comment">/***************************************************************************</span>
01310 <span class="comment">*</span>
01311 <span class="comment">*   Function to put the chunk of memory into buffer</span>
01312 <span class="comment">*</span>
01313 <span class="comment">***************************************************************************/</span>
<a name="l01314"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a49">01314</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d2/d9/ps2_8c.html#a230">WriteInt2ByteString</a>(MEMPTR lpMem, MEMPTR lpBuff, SINT sBytes)
01315 {
01316     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01317 
01318        <span class="keywordflow">for</span>( i = 0; i &lt; sBytes ; i++)
01319     {
01320         *lpMem++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a>( lpBuff)/256) ;
01321         lpBuff += <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
01322     }
01323     <span class="keywordflow">return</span>(sBytes); 
01324 }
01325 
01326 <span class="comment">/***************************************************************************</span>
01327 <span class="comment">*</span>
01328 <span class="comment">*  Function to control ascii85 encoding.</span>
01329 <span class="comment">*  parameters:</span>
01330 <span class="comment">*       lpDest      --  Pointer to the encording result buffer.</span>
01331 <span class="comment">*       BufSize     --  Size of encording result buffer. </span>
01332 <span class="comment">*       lpSource    --  Pointer to the input buffer</span>
01333 <span class="comment">*       DataSize    --  Size of the input buffer</span>
01334 <span class="comment">*  returns:</span>
01335 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01336 <span class="comment">*</span>
01337 <span class="comment">****************************************************************************/</span>
01338 
<a name="l01339"></a><a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a55">01339</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a55">WriteASCII85Cont</a>(MEMPTR lpDest, SINT BufSize, MEMPTR lpSource, SINT DataSize)
01340 {
01341    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     incount;
01342    <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   lpPtr, lpSave;
01343    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     rem;
01344    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     bcount;
01345    <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>     dex;
01346    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> word;
01347    
01348    <span class="comment">/* encode the initial 4-tuples */</span>
01349    lpSave = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01350    lpPtr  = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>;
01351    word   = 0UL;
01352    bcount = 0;
01353 
01354    <span class="keywordflow">for</span> (incount = 0; incount &lt; DataSize; incount ++)
01355    {
01356       <span class="keywordflow">if</span> ( incount  &amp;&amp; ((incount % <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a2">LINELENG</a>) == 0) )
01357       <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>);
01358       word = (word&lt;&lt;8);
01359       word |= (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)*lpPtr++;
01360       <span class="keywordflow">if</span> (bcount == 3)
01361       {
01362          <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>, word, 5);
01363          word = 0UL;
01364          bcount = 0;
01365       }
01366       <span class="keywordflow">else</span>
01367       {
01368          bcount ++;
01369       }
01370    }
01371    
01372    <span class="comment">/* now do the last partial 4-tuple -- if there is one */</span>
01373    <span class="comment">/* see the Red Book spec for the rules on how this is done */</span>
01374    <span class="keywordflow">if</span> (bcount &gt; 0)
01375    {
01376       rem = 4 - bcount;  <span class="comment">/* count the remaining bytes */</span>
01377       <span class="keywordflow">for</span> (dex = 0; dex &lt; rem; dex ++) <span class="comment">/* shift left for each of them */</span>
01378       {
01379          word = (word&lt;&lt;8);      <span class="comment">/* (equivalent to adding in ZERO's)*/</span>
01380          word |= (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)32;
01381       }
01382 <span class="comment">//      lpDest += WriteAscii85(lpDest, word, (bcount + 1));  /* output only meaningful</span>
01383       <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>, word, 5);               <span class="comment">/* output only meaningful bytes + 1 */</span>
01384    }
01385    <span class="keywordflow">return</span> (<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> - lpSave);
01386 }
01387 
01388 <span class="comment">/************************************************************************</span>
01389 <span class="comment">*</span>
01390 <span class="comment">*  Function to convert 4 bytes binary data to 5 bytes ascii85 encorded data.</span>
01391 <span class="comment">*  parameters:</span>
01392 <span class="comment">*       lpDest      --  Pointer to the encording result buffer.</span>
01393 <span class="comment">*       inWord      --  Input word (4-bytes) </span>
01394 <span class="comment">*       nBytes      --  Number of bytes should be outputed.</span>
01395 <span class="comment">*  returns:</span>
01396 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01397 <span class="comment">* </span>
01398 <span class="comment">*************************************************************************/</span>
01399 
<a name="l01400"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">01400</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a53">WriteAscii85</a>(MEMPTR lpDest, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> inWord, SINT nBytes)
01401 {
01402     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> divisor;
01403     <span class="keywordtype">int</span>      bcount;
01404     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>     outchar;
01405     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>   lpSave = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01406 
01407     <span class="keywordflow">if</span> ((inWord == 0UL) &amp;&amp; (nBytes == 5))
01408         *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = <span class="charliteral">'z'</span>;
01409     <span class="keywordflow">else</span>
01410     {
01411         divisor = 52200625UL;
01412         <span class="keywordflow">for</span> (bcount = 0; bcount &lt; nBytes; bcount ++)
01413         { 
01414             outchar = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((<span class="keywordtype">int</span>)(inWord/divisor) + (<span class="keywordtype">int</span>)<span class="charliteral">'!'</span>);
01415             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = outchar;
01416             <span class="keywordflow">if</span> (bcount &lt; 4)
01417             {
01418                 inWord = (inWord % divisor);
01419                 divisor =(divisor / 85);
01420             }
01421         }
01422     }
01423     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> - lpSave);
01424 }
01425 
01426 <span class="comment">/***************************************************************************</span>
01427 <span class="comment">*</span>
01428 <span class="comment">*  Function to convert binary data to ascii by performing ASCII85 encording</span>
01429 <span class="comment">*  parameters:</span>
01430 <span class="comment">*       lpMem       --  A pointer to the buffer. </span>
01431 <span class="comment">*                       as input: contains binary data; </span>
01432 <span class="comment">*                       as output: contains ascii data. </span>
01433 <span class="comment">*       DataSize    --  The size of input binary data. </span>
01434 <span class="comment">*       BufSize     --  The size of buffer pointed by lpMem.</span>
01435 <span class="comment">*  returns:</span>
01436 <span class="comment">*       SINT        --  Number of bytes actually outputed.</span>
01437 <span class="comment">*</span>
01438 <span class="comment">***************************************************************************/</span>
01439 
<a name="l01440"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a54">01440</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a54">ConvertBinaryData2Ascii</a>(MEMPTR lpMem, SINT DataSize, SINT BufSize)
01441 {
01442     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>      intrbuf, Temp;
01443     HANDLE      intrhandle;
01444     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>        AsciiDataSize = 0;
01445 
01446     <span class="keywordflow">if</span> (BufSize &gt;= (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(DataSize/4*5 + <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>)+<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>) + 2048))
01447     {
01448         <span class="keywordflow">if</span> ((intrhandle = GlobalAlloc(GHND, BufSize)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01449         {
01450             <span class="keywordflow">if</span> ((intrbuf = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) GlobalLock(intrhandle)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01451             {
01452                 Temp = intrbuf;
01453                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>);
01454                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>);
01455                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a3">NewLine</a>);
01456                 Temp += <a class="code" href="../../d1/d9/jul98_2dll32_2csprof_8c.html#a55">WriteASCII85Cont</a>(Temp, BufSize, lpMem, DataSize);
01457                 Temp += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a>(Temp,  <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>);
01458                 AsciiDataSize = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>)(Temp - intrbuf);
01459                 lstrcpyn(lpMem, intrbuf, (WORD)AsciiDataSize); 
01460                 GlobalUnlock(intrhandle);
01461             }
01462         }
01463         GlobalFree(intrhandle);
01464    }
01465    <span class="keywordflow">return</span> (AsciiDataSize);
01466 }
01467 
01468 <span class="comment">/***************************************************************************</span>
01469 <span class="comment">*</span>
01470 <span class="comment">*  Function to check if it is need to convert a CRD from binary to ascii</span>
01471 <span class="comment">*  parameters:</span>
01472 <span class="comment">*       CP          --  Handle of memory block which contains icm profile.</span>
01473 <span class="comment">*       Index       --  Index of the element data of the profile.</span>
01474 <span class="comment">*       lpData      --  A pointer to the buffer. </span>
01475 <span class="comment">*                       as input: contains binary data; </span>
01476 <span class="comment">*                       as output: contains ascii data. </span>
01477 <span class="comment">*       BufSize     --  The size of the buffer pointed by lpData.</span>
01478 <span class="comment">*       DataSize    --  The size of input binary data.</span>
01479 <span class="comment">*       AllowBinary --  Allow binary or not(1/0).</span>
01480 <span class="comment">*  returns:</span>
01481 <span class="comment">*       SINT        --  Number of bytes required/actually outputed.</span>
01482 <span class="comment">*</span>
01483 <span class="comment">***************************************************************************/</span>
01484 
<a name="l01485"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a55">01485</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a55">Convert2Ascii</a>(CHANDLE CP, SINT Index,
01486                       MEMPTR lpData, SINT BufSize, 
01487                       SINT DataSize, BOOL AllowBinary)
01488 {
01489     <span class="keywordtype">long</span>    DataType;
01490 
01491     <a class="code" href="../../d2/d9/ps2_8c.html#a195">GetCPElementDataType</a>(CP, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, &amp;DataType);
01492     <span class="keywordflow">if</span> (BufSize == 0)
01493     {
01494         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)
01495             <span class="keywordflow">return</span> (DataSize);
01496         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DataType == 0)    <span class="comment">// Ascii data in Profile </span>
01497             <span class="keywordflow">return</span> (DataSize);
01498         <span class="keywordflow">else</span>                       <span class="comment">// Keep space for ascii85 encoding.</span>
01499             <span class="keywordflow">return</span> (DataSize / 4 * 5 + <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a4">ASCII85DecodeBegine</a>)+<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a5">ASCII85DecodeEnd</a>) + 2048);
01500     }
01501     <span class="keywordflow">else</span>
01502     {
01503         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)
01504             <span class="keywordflow">return</span> (DataSize);
01505         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(DataType == 0) 
01506             <span class="keywordflow">return</span> (DataSize);
01507         <span class="keywordflow">else</span> 
01508             <span class="keywordflow">return</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a54">ConvertBinaryData2Ascii</a>(lpData, DataSize, BufSize) );
01509     }
01510 }
01511 
01512 <span class="preprocessor">#ifdef ICMDLL</span>
01513 <span class="preprocessor"></span><a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    MemCopy(MEMPTR Dest, MEMPTR Source, SINT Length)
01514 {
01515     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    i;
01516 
01517     <span class="keywordflow">for</span> (i = 0; i &lt; Length; i++)
01518     {
01519         Dest[i] = Source[i];
01520     }
01521     <span class="keywordflow">return</span>( Length );
01522 }
01523 
01524 <span class="comment">// SRGB98</span>
01525 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a56">InvertMatrix</a> (<span class="keywordtype">double</span> FAR * lpInMatrix,
01526                    <span class="keywordtype">double</span> FAR * lpOutMatrix)
01527 {
01528     <span class="keywordtype">double</span> det;
01529 
01530     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *a;
01531     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *b;
01532     <span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>;
01533     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpInMatrix) ||
01534         (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == lpOutMatrix))
01535     {
01536         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01537     }
01538     a = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[0]);
01539     b = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[3]);
01540     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = (<span class="keywordtype">double</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;(lpInMatrix[6]);
01541 
01542     det = a[0] * b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] + a[1] * b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0] + a[2] * b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] -
01543         (a[2] * b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0] + a[1] * b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] + a[0] * b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]);
01544 
01545     <span class="keywordflow">if</span> (det == 0.0)                     <span class="comment">// What to do?</span>
01546     {
01547         lpOutMatrix[0] = 1.0;
01548         lpOutMatrix[1] = 0.0;
01549         lpOutMatrix[2] = 0.0;
01550 
01551         lpOutMatrix[3] = 0.0;
01552         lpOutMatrix[4] = 1.0;
01553         lpOutMatrix[5] = 0.0;
01554 
01555         lpOutMatrix[6] = 0.0;
01556         lpOutMatrix[7] = 0.0;
01557         lpOutMatrix[8] = 1.0;
01558         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01559     } <span class="keywordflow">else</span>
01560     {
01561         lpOutMatrix[0] = (b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]) / det;
01562         lpOutMatrix[3] = -(b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - b[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01563         lpOutMatrix[6] = (b[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] - b[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01564 
01565         lpOutMatrix[1] = -(a[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - a[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1]) / det;
01566         lpOutMatrix[4] = (a[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[2] - a[2] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01567         lpOutMatrix[7] = -(a[0] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[1] - a[1] * <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>[0]) / det;
01568 
01569         lpOutMatrix[2] = (a[1] * b[2] - a[2] * b[1]) / det;
01570         lpOutMatrix[5] = -(a[0] * b[2] - a[2] * b[0]) / det;
01571         lpOutMatrix[8] = (a[0] * b[1] - a[1] * b[0]) / det;
01572         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01573     }
01574 }
01575 
01576 <span class="comment">/*</span>
01577 <span class="comment"> *  Crc - 32 BIT ANSI X3.66 CRC checksum files</span>
01578 <span class="comment"> *</span>
01579 <span class="comment"> *</span>
01580 <span class="comment"> * Copyright (C) 1986 Gary S. Brown.  You may use this program, or</span>
01581 <span class="comment"> * code or tables extracted from it, as desired without restriction.</span>
01582 <span class="comment"> */</span>
01583 
01584 <span class="keyword">static</span> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  crc_32_tab[] = { <span class="comment">/* CRC polynomial 0xedb88320 */</span>
01585 0x00000000, 0x77073096, 0xee0e612c, 0x990951ba, 0x076dc419, 0x706af48f, 0xe963a535, 0x9e6495a3,
01586 0x0edb8832, 0x79dcb8a4, 0xe0d5e91e, 0x97d2d988, 0x09b64c2b, 0x7eb17cbd, 0xe7b82d07, 0x90bf1d91,
01587 0x1db71064, 0x6ab020f2, 0xf3b97148, 0x84be41de, 0x1adad47d, 0x6ddde4eb, 0xf4d4b551, 0x83d385c7,
01588 0x136c9856, 0x646ba8c0, 0xfd62f97a, 0x8a65c9ec, 0x14015c4f, 0x63066cd9, 0xfa0f3d63, 0x8d080df5,
01589 0x3b6e20c8, 0x4c69105e, 0xd56041e4, 0xa2677172, 0x3c03e4d1, 0x4b04d447, 0xd20d85fd, 0xa50ab56b,
01590 0x35b5a8fa, 0x42b2986c, 0xdbbbc9d6, 0xacbcf940, 0x32d86ce3, 0x45df5c75, 0xdcd60dcf, 0xabd13d59,
01591 0x26d930ac, 0x51de003a, 0xc8d75180, 0xbfd06116, 0x21b4f4b5, 0x56b3c423, 0xcfba9599, 0xb8bda50f,
01592 0x2802b89e, 0x5f058808, 0xc60cd9b2, 0xb10be924, 0x2f6f7c87, 0x58684c11, 0xc1611dab, 0xb6662d3d,
01593 0x76dc4190, 0x01db7106, 0x98d220bc, 0xefd5102a, 0x71b18589, 0x06b6b51f, 0x9fbfe4a5, 0xe8b8d433,
01594 0x7807c9a2, 0x0f00f934, 0x9609a88e, 0xe10e9818, 0x7f6a0dbb, 0x086d3d2d, 0x91646c97, 0xe6635c01,
01595 0x6b6b51f4, 0x1c6c6162, 0x856530d8, 0xf262004e, 0x6c0695ed, 0x1b01a57b, 0x8208f4c1, 0xf50fc457,
01596 0x65b0d9c6, 0x12b7e950, 0x8bbeb8ea, 0xfcb9887c, 0x62dd1ddf, 0x15da2d49, 0x8cd37cf3, 0xfbd44c65,
01597 0x4db26158, 0x3ab551ce, 0xa3bc0074, 0xd4bb30e2, 0x4adfa541, 0x3dd895d7, 0xa4d1c46d, 0xd3d6f4fb,
01598 0x4369e96a, 0x346ed9fc, 0xad678846, 0xda60b8d0, 0x44042d73, 0x33031de5, 0xaa0a4c5f, 0xdd0d7cc9,
01599 0x5005713c, 0x270241aa, 0xbe0b1010, 0xc90c2086, 0x5768b525, 0x206f85b3, 0xb966d409, 0xce61e49f,
01600 0x5edef90e, 0x29d9c998, 0xb0d09822, 0xc7d7a8b4, 0x59b33d17, 0x2eb40d81, 0xb7bd5c3b, 0xc0ba6cad,
01601 0xedb88320, 0x9abfb3b6, 0x03b6e20c, 0x74b1d29a, 0xead54739, 0x9dd277af, 0x04db2615, 0x73dc1683,
01602 0xe3630b12, 0x94643b84, 0x0d6d6a3e, 0x7a6a5aa8, 0xe40ecf0b, 0x9309ff9d, 0x0a00ae27, 0x7d079eb1,
01603 0xf00f9344, 0x8708a3d2, 0x1e01f268, 0x6906c2fe, 0xf762575d, 0x806567cb, 0x196c3671, 0x6e6b06e7,
01604 0xfed41b76, 0x89d32be0, 0x10da7a5a, 0x67dd4acc, 0xf9b9df6f, 0x8ebeeff9, 0x17b7be43, 0x60b08ed5,
01605 0xd6d6a3e8, 0xa1d1937e, 0x38d8c2c4, 0x4fdff252, 0xd1bb67f1, 0xa6bc5767, 0x3fb506dd, 0x48b2364b,
01606 0xd80d2bda, 0xaf0a1b4c, 0x36034af6, 0x41047a60, 0xdf60efc3, 0xa867df55, 0x316e8eef, 0x4669be79,
01607 0xcb61b38c, 0xbc66831a, 0x256fd2a0, 0x5268e236, 0xcc0c7795, 0xbb0b4703, 0x220216b9, 0x5505262f,
01608 0xc5ba3bbe, 0xb2bd0b28, 0x2bb45a92, 0x5cb36a04, 0xc2d7ffa7, 0xb5d0cf31, 0x2cd99e8b, 0x5bdeae1d,
01609 0x9b64c2b0, 0xec63f226, 0x756aa39c, 0x026d930a, 0x9c0906a9, 0xeb0e363f, 0x72076785, 0x05005713,
01610 0x95bf4a82, 0xe2b87a14, 0x7bb12bae, 0x0cb61b38, 0x92d28e9b, 0xe5d5be0d, 0x7cdcefb7, 0x0bdbdf21,
01611 0x86d3d2d4, 0xf1d4e242, 0x68ddb3f8, 0x1fda836e, 0x81be16cd, 0xf6b9265b, 0x6fb077e1, 0x18b74777,
01612 0x88085ae6, 0xff0f6a70, 0x66063bca, 0x11010b5c, 0x8f659eff, 0xf862ae69, 0x616bffd3, 0x166ccf45,
01613 0xa00ae278, 0xd70dd2ee, 0x4e048354, 0x3903b3c2, 0xa7672661, 0xd06016f7, 0x4969474d, 0x3e6e77db,
01614 0xaed16a4a, 0xd9d65adc, 0x40df0b66, 0x37d83bf0, 0xa9bcae53, 0xdebb9ec5, 0x47b2cf7f, 0x30b5ffe9,
01615 0xbdbdf21c, 0xcabac28a, 0x53b39330, 0x24b4a3a6, 0xbad03605, 0xcdd70693, 0x54de5729, 0x23d967bf,
01616 0xb3667a2e, 0xc4614ab8, 0x5d681b02, 0x2a6f2b94, 0xb40bbe37, 0xc30c8ea1, 0x5a05df1b, 0x2d02ef8d
01617 };
01618 
01619 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a>  PASCAL  <a class="code" href="../../d2/d9/ps2_8c.html#a253">crc32</a>(MEMPTR buff, DWORD  length)
01620 {
01621   <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  crc, charcnt;
01622   <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>;
01623 
01624 
01625   crc = 0xFFFFFFFF;
01626   charcnt = 0;
01627 
01628   <span class="keywordflow">for</span> (charcnt = 0 ; charcnt &lt; length ; charcnt++)
01629   {
01630     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = buff[charcnt] ;
01631     crc = crc_32_tab[(crc ^ <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>) &amp; 0xff] ^ (crc &gt;&gt; 8);
01632   }
01633 
01634   <span class="keywordflow">return</span> crc;
01635 }
01636 <span class="preprocessor">#endif</span>
01637 <span class="preprocessor"></span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:36 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
