<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: cnvint.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>cnvint.c File Reference</h1><code>#include &lt;<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>&gt;</code><br>

<p>
<a href="../../d0/d3/cnvint_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a2">RtlIntegerToChar</a> (IN ULONG Value, IN ULONG Base OPTIONAL, IN LONG OutputLength, OUT PSZ <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a3">RtlCharToInteger</a> (IN PCSZ <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>, IN ULONG Base OPTIONAL, OUT PULONG Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a4">RtlUnicodeStringToInteger</a> (IN PUNICODE_STRING <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>, IN ULONG Base OPTIONAL, OUT PULONG Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a5">RtlIntegerToUnicode</a> (IN ULONG Value, IN ULONG Base OPTIONAL, IN LONG OutputLength, OUT PWSTR <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a6">RtlIntegerToUnicodeString</a> (IN ULONG Value, IN ULONG Base OPTIONAL, IN OUT PUNICODE_STRING <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a7">RtlLargeIntegerToChar</a> (IN PLARGE_INTEGER Value, IN ULONG Base OPTIONAL, IN LONG OutputLength, OUT PSZ <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a8">RtlLargeIntegerToUnicode</a> (IN PLARGE_INTEGER Value, IN ULONG Base OPTIONAL, IN LONG OutputLength, OUT PWSTR <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a9">RtlInt64ToUnicodeString</a> (IN ULONGLONG Value, IN ULONG Base OPTIONAL, IN OUT PUNICODE_STRING <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a0">RtlpIntegerChars</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d3/cnvint_8c.html#a1">RtlpIntegerWChars</a> []</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a3" doxytag="cnvint.c::RtlCharToInteger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlCharToInteger           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00121">121</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d4/d9/user32_8def-source.html#l00799">c</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/rules_8c-source.html#l01540">CmpMatchAcpiCreatorRevisionRule()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l01372">CmpMatchAcpiOemRevisionRule()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l01456">CmpMatchAcpiRevisionRule()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l02476">LdrpSnapThunk()</a>, and <a class="el" href="../../d1/d4/trandom_8c-source.html#l00028">main()</a>.
<p>
<pre class="fragment"><div>00126 {
00127     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>, Sign;
00128     ULONG Result, Digit, Shift;
00129 
00130     <span class="keywordflow">while</span> ((Sign = *<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>++) &lt;= <span class="charliteral">' '</span>) {
00131         <span class="keywordflow">if</span> (!*<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>) {
00132             <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>--;
00133             <span class="keywordflow">break</span>;
00134             }
00135         }
00136 
00137     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = Sign;
00138     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'-'</span> || <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'+'</span>) {
00139         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>++;
00140         }
00141 
00142     <span class="keywordflow">if</span> (!ARGUMENT_PRESENT( (ULONG_PTR)(Base) )) {
00143         Base = 10;
00144         Shift = 0;
00145         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'0'</span>) {
00146             <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>++;
00147             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'x'</span>) {
00148                 Base = 16;
00149                 Shift = 4;
00150                 }
00151             <span class="keywordflow">else</span>
00152             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'o'</span>) {
00153                 Base = 8;
00154                 Shift = 3;
00155                 }
00156             <span class="keywordflow">else</span>
00157             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <span class="charliteral">'b'</span>) {
00158                 Base = 2;
00159                 Shift = 1;
00160                 }
00161             <span class="keywordflow">else</span> {
00162                 <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>--;
00163                 }
00164 
00165             <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>++;
00166             }
00167         }
00168     <span class="keywordflow">else</span> {
00169         <span class="keywordflow">switch</span>( Base ) {
00170             <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00171             <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00172             <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00173             <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00174             <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00175             }
00176         }
00177 
00178     Result = 0;
00179     <span class="keywordflow">while</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>) {
00180         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <span class="charliteral">'0'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <span class="charliteral">'9'</span>) {
00181             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <span class="charliteral">'0'</span>;
00182             }
00183         <span class="keywordflow">else</span>
00184         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <span class="charliteral">'A'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <span class="charliteral">'F'</span>) {
00185             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <span class="charliteral">'A'</span> + 10;
00186             }
00187         <span class="keywordflow">else</span>
00188         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <span class="charliteral">'a'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <span class="charliteral">'f'</span>) {
00189             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <span class="charliteral">'a'</span> + 10;
00190             }
00191         <span class="keywordflow">else</span> {
00192             <span class="keywordflow">break</span>;
00193             }
00194 
00195         <span class="keywordflow">if</span> (Digit &gt;= Base) {
00196             <span class="keywordflow">break</span>;
00197             }
00198 
00199         <span class="keywordflow">if</span> (Shift == 0) {
00200             Result = (Base * Result) + Digit;
00201             }
00202         <span class="keywordflow">else</span> {
00203             Result = (Result &lt;&lt; Shift) | Digit;
00204             }
00205 
00206         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>++;
00207         }
00208 
00209     <span class="keywordflow">if</span> (Sign == <span class="charliteral">'-'</span>) {
00210         Result = (ULONG)(-(LONG)Result);
00211         }
00212 
00213     <span class="keywordflow">try</span> {
00214         *Value = Result;
00215         }
00216     except( EXCEPTION_EXECUTE_HANDLER ) {
00217         <span class="keywordflow">return</span>( GetExceptionCode() );
00218         }
00219 
00220     <span class="keywordflow">return</span>( STATUS_SUCCESS );
00221 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="cnvint.c::RtlInt64ToUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlInt64ToUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00632">632</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00456">RtlLargeIntegerToChar()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00638 {
00639 
00640     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00641     UCHAR ResultBuffer[32];
00642     ANSI_STRING AnsiString;
00643     LARGE_INTEGER Temp;
00644 
00645     Temp.QuadPart = Value;
00646     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/cnvint_8c.html#a7">RtlLargeIntegerToChar</a>(&amp;Temp,
00647                                    Base,
00648                                    <span class="keyword">sizeof</span>(ResultBuffer),
00649                                    ResultBuffer);
00650 
00651     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00652         AnsiString.Buffer = ResultBuffer;
00653         AnsiString.MaximumLength = <span class="keyword">sizeof</span>(ResultBuffer);
00654         AnsiString.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(ResultBuffer);
00655         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(String, &amp;AnsiString, FALSE);
00656     }
00657 
00658     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00659 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="cnvint.c::RtlIntegerToChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlIntegerToChar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00040">40</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00032">RtlpIntegerChars</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d8/d6/uclient_8c-source.html#l00033">ClientThread()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d3/d6/class_8c-source.html#l00244">InternalRegisterClassEx()</a>, <a class="el" href="../../d6/d1/fekbdcom_8c-source.html#l00199">KbdLayerRealDllFileForWBT()</a>, <a class="el" href="../../d1/d4/trandom_8c-source.html#l00028">main()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00433">RtlIntegerToUnicodeString()</a>, and <a class="el" href="../../d9/d0/userver_8c-source.html#l00173">ServerThread()</a>.
<p>
<pre class="fragment"><div>00049                    :
00050 
00051 Arguments:
00052 
00053 Return Value:
00054 
00055 --*/
00056 
00057 {
00058     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Result[ 33 ], *s;
00059     ULONG Shift, Mask, Digit, Length;
00060 
00061     Shift = 0;
00062     <span class="keywordflow">switch</span>( Base ) {
00063         <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00064         <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00065         <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00066 
00067         <span class="keywordflow">case</span>  0:    Base = 10;
00068         <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00069         <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00070         }
00071 
00072     <span class="keywordflow">if</span> (Shift != 0) {
00073         Mask = 0xF &gt;&gt; (4 - Shift);
00074         }
00075 
00076     s = &amp;Result[ 32 ];
00077     *s = <span class="charliteral">'\0'</span>;
00078     <span class="keywordflow">do</span> {
00079         <span class="keywordflow">if</span> (Shift != 0) {
00080             Digit = Value &amp; Mask;
00081             Value &gt;&gt;= Shift;
00082             }
00083         <span class="keywordflow">else</span> {
00084             Digit = Value % Base;
00085             Value = Value / Base;
00086             }
00087 
00088         *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a0">RtlpIntegerChars</a>[ Digit ];
00089     } <span class="keywordflow">while</span> (Value != 0);
00090 
00091     Length = (ULONG) (&amp;Result[ 32 ] - s);
00092     <span class="keywordflow">if</span> (OutputLength &lt; 0) {
00093         OutputLength = -OutputLength;
00094         <span class="keywordflow">while</span> ((LONG)Length &lt; OutputLength) {
00095             *--s = <span class="charliteral">'0'</span>;
00096             Length++;
00097             }
00098         }
00099 
00100     <span class="keywordflow">if</span> ((LONG)Length &gt; OutputLength) {
00101         <span class="keywordflow">return</span>( STATUS_BUFFER_OVERFLOW );
00102         }
00103     <span class="keywordflow">else</span> {
00104         <span class="keywordflow">try</span> {
00105             RtlMoveMemory( String, s, Length );
00106 
00107             <span class="keywordflow">if</span> ((LONG)Length &lt; OutputLength) {
00108                 <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>[ Length ] = <span class="charliteral">'\0'</span>;
00109                 }
00110             }
00111         except( EXCEPTION_EXECUTE_HANDLER ) {
00112             <span class="keywordflow">return</span>( GetExceptionCode() );
00113             }
00114 
00115         <span class="keywordflow">return</span>( STATUS_SUCCESS );
00116         }
00117 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="cnvint.c::RtlIntegerToUnicode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlIntegerToUnicode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00352">352</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00035">RtlpIntegerWChars</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/sertl_8c-source.html#l01611">RtlConvertSidToUnicodeString()</a>.
<p>
<pre class="fragment"><div>00361                    :
00362 
00363 Arguments:
00364 
00365 Return Value:
00366 
00367 --*/
00368 
00369 {
00370     WCHAR Result[ 33 ], *s;
00371     ULONG Shift, Mask, Digit, Length;
00372 
00373     Shift = 0;
00374     <span class="keywordflow">switch</span>( Base ) {
00375         <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00376         <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00377         <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00378 
00379         <span class="keywordflow">case</span>  0:    Base = 10;
00380         <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00381         <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00382         }
00383 
00384     <span class="keywordflow">if</span> (Shift != 0) {
00385         Mask = 0xF &gt;&gt; (4 - Shift);
00386         }
00387 
00388     s = &amp;Result[ 32 ];
00389     *s = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00390     <span class="keywordflow">do</span> {
00391         <span class="keywordflow">if</span> (Shift != 0) {
00392             Digit = Value &amp; Mask;
00393             Value &gt;&gt;= Shift;
00394             }
00395         <span class="keywordflow">else</span> {
00396             Digit = Value % Base;
00397             Value = Value / Base;
00398             }
00399 
00400         *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a1">RtlpIntegerWChars</a>[ Digit ];
00401     } <span class="keywordflow">while</span> (Value != 0);
00402 
00403     Length = (ULONG) (&amp;Result[ 32 ] - s);
00404     <span class="keywordflow">if</span> (OutputLength &lt; 0) {
00405         OutputLength = -OutputLength;
00406         <span class="keywordflow">while</span> ((LONG)Length &lt; OutputLength) {
00407             *--s = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span>;
00408             Length++;
00409             }
00410         }
00411 
00412     <span class="keywordflow">if</span> ((LONG)Length &gt; OutputLength) {
00413         <span class="keywordflow">return</span>( STATUS_BUFFER_OVERFLOW );
00414         }
00415     <span class="keywordflow">else</span> {
00416         <span class="keywordflow">try</span> {
00417             RtlMoveMemory( String, s, Length * <span class="keyword">sizeof</span>( WCHAR ));
00418 
00419             <span class="keywordflow">if</span> ((LONG)Length &lt; OutputLength) {
00420                 <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>[ Length ] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00421                 }
00422             }
00423         except( EXCEPTION_EXECUTE_HANDLER ) {
00424             <span class="keywordflow">return</span>( GetExceptionCode() );
00425             }
00426 
00427         <span class="keywordflow">return</span>( STATUS_SUCCESS );
00428         }
00429 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="cnvint.c::RtlIntegerToUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlIntegerToUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00433">433</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00040">RtlIntegerToChar()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/rules_8c-source.html#l02430">CmpFindRSDTTable()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00769">ExpValidateLocale()</a>, <a class="el" href="../../d4/d0/layime_8c-source.html#l00038">ImmLoadLayout()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00565">pIoQueryDeviceDescription()</a>, and <a class="el" href="../../d5/d0/layout_8c-source.html#l00497">UIntToStr()</a>.
<p>
<pre class="fragment"><div>00438 {
00439     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00440     UCHAR ResultBuffer[ 16 ];
00441     ANSI_STRING AnsiString;
00442 
00443     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/cnvint_8c.html#a2">RtlIntegerToChar</a>( Value, Base, <span class="keyword">sizeof</span>( ResultBuffer ), ResultBuffer );
00444     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status )) {
00445         AnsiString.Buffer = ResultBuffer;
00446         AnsiString.MaximumLength = <span class="keyword">sizeof</span>( ResultBuffer );
00447         AnsiString.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( ResultBuffer );
00448         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>( String, &amp;AnsiString, FALSE );
00449         }
00450 
00451     <span class="keywordflow">return</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> );
00452 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="cnvint.c::RtlLargeIntegerToChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlLargeIntegerToChar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00456">456</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d1/d0/largeic_8c-source.html#l00040">RtlExtendedLargeIntegerDivide()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00032">RtlpIntegerChars</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00632">RtlInt64ToUnicodeString()</a>.
<p>
<pre class="fragment"><div>00465                    :
00466 
00467 Arguments:
00468 
00469 Return Value:
00470 
00471 --*/
00472 
00473 {
00474     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Result[ 100 ], *s;
00475     ULONG Shift, Mask, Digit, Length;
00476 
00477     Shift = 0;
00478     <span class="keywordflow">switch</span>( Base ) {
00479         <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00480         <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00481         <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00482 
00483         <span class="keywordflow">case</span>  0:
00484         <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00485         <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00486         }
00487 
00488     <span class="keywordflow">if</span> (Shift != 0) {
00489         Mask = 0xF &gt;&gt; (4 - Shift);
00490         }
00491 
00492     s = &amp;Result[ 99 ];
00493     *s = <span class="charliteral">'\0'</span>;
00494     <span class="keywordflow">if</span> (Shift != 0) {
00495         ULONG LowValue,HighValue,HighShift,HighMask;
00496 
00497         LowValue = Value-&gt;LowPart;
00498         HighValue = Value-&gt;HighPart;
00499         HighShift = Shift - (<span class="keyword">sizeof</span>(ULONG) % Shift);
00500         HighMask = 0xF &gt;&gt; (4 - HighShift);
00501         <span class="keywordflow">do</span> {
00502             Digit = LowValue &amp; Mask;
00503             LowValue = (LowValue &gt;&gt; Shift) | ((HighValue &amp; HighMask) &lt;&lt; (<span class="keyword">sizeof</span>(ULONG) - HighShift));
00504             HighValue = HighValue &gt;&gt; HighShift;
00505             *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a0">RtlpIntegerChars</a>[ Digit ];
00506         } <span class="keywordflow">while</span> ((LowValue | HighValue) != 0);
00507     } <span class="keywordflow">else</span> {
00508         LARGE_INTEGER TempValue=*Value;
00509         <span class="keywordflow">do</span> {
00510             TempValue = <a class="code" href="../../d0/d1/largeic_8c.html#a0">RtlExtendedLargeIntegerDivide</a>(TempValue,Base,&amp;Digit);
00511             *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a0">RtlpIntegerChars</a>[ Digit ];
00512         } <span class="keywordflow">while</span> (TempValue.HighPart != 0 || TempValue.LowPart != 0);
00513     }
00514 
00515     Length = (ULONG)(&amp;Result[ 99 ] - s);
00516     <span class="keywordflow">if</span> (OutputLength &lt; 0) {
00517         OutputLength = -OutputLength;
00518         <span class="keywordflow">while</span> ((LONG)Length &lt; OutputLength) {
00519             *--s = <span class="charliteral">'0'</span>;
00520             Length++;
00521             }
00522         }
00523 
00524     <span class="keywordflow">if</span> ((LONG)Length &gt; OutputLength) {
00525         <span class="keywordflow">return</span>( STATUS_BUFFER_OVERFLOW );
00526         }
00527     <span class="keywordflow">else</span> {
00528         <span class="keywordflow">try</span> {
00529             RtlMoveMemory( String, s, Length );
00530 
00531             <span class="keywordflow">if</span> ((LONG)Length &lt; OutputLength) {
00532                 <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>[ Length ] = <span class="charliteral">'\0'</span>;
00533                 }
00534             }
00535         except( EXCEPTION_EXECUTE_HANDLER ) {
00536             <span class="keywordflow">return</span>( GetExceptionCode() );
00537             }
00538 
00539         <span class="keywordflow">return</span>( STATUS_SUCCESS );
00540         }
00541 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="cnvint.c::RtlLargeIntegerToUnicode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlLargeIntegerToUnicode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00544">544</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d0/largeic_8c-source.html#l00040">RtlExtendedLargeIntegerDivide()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00035">RtlpIntegerWChars</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/sertl_8c-source.html#l01611">RtlConvertSidToUnicodeString()</a>.
<p>
<pre class="fragment"><div>00553                    :
00554 
00555 Arguments:
00556 
00557 Return Value:
00558 
00559 --*/
00560 
00561 {
00562     WCHAR Result[ 100 ], *s;
00563     ULONG Shift, Mask, Digit, Length;
00564 
00565     Shift = 0;
00566     <span class="keywordflow">switch</span>( Base ) {
00567         <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00568         <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00569         <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00570 
00571         <span class="keywordflow">case</span>  0:
00572         <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00573         <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00574         }
00575 
00576     <span class="keywordflow">if</span> (Shift != 0) {
00577         Mask = 0xF &gt;&gt; (4 - Shift);
00578         }
00579 
00580     s = &amp;Result[ 99 ];
00581     *s = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00582     <span class="keywordflow">if</span> (Shift != 0) {
00583         ULONG LowValue,HighValue,HighShift,HighMask;
00584 
00585         LowValue = Value-&gt;LowPart;
00586         HighValue = Value-&gt;HighPart;
00587         HighShift = Shift - (<span class="keyword">sizeof</span>(ULONG) % Shift);
00588         HighMask = 0xF &gt;&gt; (4 - HighShift);
00589         <span class="keywordflow">do</span> {
00590             Digit = LowValue &amp; Mask;
00591             LowValue = (LowValue &gt;&gt; Shift) | ((HighValue &amp; HighMask) &lt;&lt; (<span class="keyword">sizeof</span>(ULONG) - HighShift));
00592             HighValue = HighValue &gt;&gt; HighShift;
00593             *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a1">RtlpIntegerWChars</a>[ Digit ];
00594         } <span class="keywordflow">while</span> ((LowValue | HighValue) != 0);
00595     } <span class="keywordflow">else</span> {
00596         LARGE_INTEGER TempValue=*Value;
00597         <span class="keywordflow">do</span> {
00598             TempValue = <a class="code" href="../../d0/d1/largeic_8c.html#a0">RtlExtendedLargeIntegerDivide</a>(TempValue,Base,&amp;Digit);
00599             *--s = <a class="code" href="../../d9/d3/cnvint_8c.html#a1">RtlpIntegerWChars</a>[ Digit ];
00600         } <span class="keywordflow">while</span> (TempValue.HighPart != 0 || TempValue.LowPart != 0);
00601     }
00602 
00603     Length = (ULONG)(&amp;Result[ 99 ] - s);
00604     <span class="keywordflow">if</span> (OutputLength &lt; 0) {
00605         OutputLength = -OutputLength;
00606         <span class="keywordflow">while</span> ((LONG)Length &lt; OutputLength) {
00607             *--s = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span>;
00608             Length++;
00609             }
00610         }
00611 
00612     <span class="keywordflow">if</span> ((LONG)Length &gt; OutputLength) {
00613         <span class="keywordflow">return</span>( STATUS_BUFFER_OVERFLOW );
00614         }
00615     <span class="keywordflow">else</span> {
00616         <span class="keywordflow">try</span> {
00617             RtlMoveMemory( String, s, Length * <span class="keyword">sizeof</span>( WCHAR ));
00618 
00619             <span class="keywordflow">if</span> ((LONG)Length &lt; OutputLength) {
00620                 <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>[ Length ] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00621                 }
00622             }
00623         except( EXCEPTION_EXECUTE_HANDLER ) {
00624             <span class="keywordflow">return</span>( GetExceptionCode() );
00625             }
00626 
00627         <span class="keywordflow">return</span>( STATUS_SUCCESS );
00628         }
00629 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="cnvint.c::RtlUnicodeStringToInteger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUnicodeStringToInteger           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG Base&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00225">225</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
References <a class="el" href="../../d4/d9/user32_8def-source.html#l00799">c</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/immhotky_8c-source.html#l00229">CliGetPreloadKeyboardLayouts()</a>, <a class="el" href="../../d6/d9/immhotky_8c-source.html#l00353">CliSetSingleHotKey()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l01284">CmpFindProfileOption()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l00076">CmpGetAcpiProfileInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00666">ExpGetCurrentUserUILanguage()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00486">ExpGetUILanguagePolicy()</a>, <a class="el" href="../../d4/d0/layime_8c-source.html#l00115">ExtractColumn()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00945">FastGetProfileIntW()</a>, <a class="el" href="../../d1/d6/server_2server_8c-source.html#l01029">GetRegIntFromID()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01983">GetServerIMEKeyboardLayout()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l01796">LdrQueryImageFileExecutionOptions()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04019">OpenKeyboardLayoutFile()</a>, <a class="el" href="../../d9/d8/dllinit_8c-source.html#l00111">ParseReserved()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l01096">RegGetKeyValue()</a>, <a class="el" href="../../d8/d3/loadbits_8c-source.html#l00190">ResStrCmp()</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00385">RtlpGetIntegerAtom()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00814">SetAppCompatFlags()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00702">SetAppImeCompatFlags()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00480">StrToUInt()</a>, and <a class="el" href="../../d7/d1/kbdlyout_8c-source.html#l00654">xxxLoadKeyboardLayoutEx()</a>.
<p>
<pre class="fragment"><div>00230 {
00231     PCWSTR s;
00232     WCHAR <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a>, Sign;
00233     ULONG nChars, Result, Digit, Shift;
00234 
00235     s = <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Buffer;
00236     nChars = <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Length / <span class="keyword">sizeof</span>( WCHAR );
00237     <span class="keywordflow">while</span> (nChars-- &amp;&amp; (Sign = *s++) &lt;= <span class="charliteral">' '</span>) {
00238         <span class="keywordflow">if</span> (!nChars) {
00239             Sign = UNICODE_NULL;
00240             <span class="keywordflow">break</span>;
00241             }
00242         }
00243 
00244     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = Sign;
00245     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'-'</span> || <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'+'</span>) {
00246         <span class="keywordflow">if</span> (nChars) {
00247             nChars--;
00248             <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *s++;
00249             }
00250         <span class="keywordflow">else</span> {
00251             <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = UNICODE_NULL;
00252             }
00253         }
00254 
00255     <span class="keywordflow">if</span> (!ARGUMENT_PRESENT( (ULONG_PTR)Base )) {
00256         Base = 10;
00257         Shift = 0;
00258         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span>) {
00259             <span class="keywordflow">if</span> (nChars) {
00260                 nChars--;
00261                 <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *s++;
00262                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'x'</span>) {
00263                     Base = 16;
00264                     Shift = 4;
00265                     }
00266                 <span class="keywordflow">else</span>
00267                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'o'</span>) {
00268                     Base = 8;
00269                     Shift = 3;
00270                     }
00271                 <span class="keywordflow">else</span>
00272                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'b'</span>) {
00273                     Base = 2;
00274                     Shift = 1;
00275                     }
00276                 <span class="keywordflow">else</span> {
00277                     nChars++;
00278                     s--;
00279                     }
00280                 }
00281 
00282             <span class="keywordflow">if</span> (nChars) {
00283                 nChars--;
00284                 <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *s++;
00285                 }
00286             <span class="keywordflow">else</span> {
00287                 <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = UNICODE_NULL;
00288                 }
00289             }
00290         }
00291     <span class="keywordflow">else</span> {
00292         <span class="keywordflow">switch</span>( Base ) {
00293             <span class="keywordflow">case</span> 16:    Shift = 4;  <span class="keywordflow">break</span>;
00294             <span class="keywordflow">case</span>  8:    Shift = 3;  <span class="keywordflow">break</span>;
00295             <span class="keywordflow">case</span>  2:    Shift = 1;  <span class="keywordflow">break</span>;
00296             <span class="keywordflow">case</span> 10:    Shift = 0;  <span class="keywordflow">break</span>;
00297             <span class="keywordflow">default</span>:    <span class="keywordflow">return</span>( STATUS_INVALID_PARAMETER );
00298             }
00299         }
00300 
00301     Result = 0;
00302     <span class="keywordflow">while</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> != UNICODE_NULL) {
00303         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'9'</span>) {
00304             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span>;
00305             }
00306         <span class="keywordflow">else</span>
00307         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'A'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'F'</span>) {
00308             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'A'</span> + 10;
00309             }
00310         <span class="keywordflow">else</span>
00311         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &gt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'a'</span> &amp;&amp; <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> &lt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'f'</span>) {
00312             Digit = <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> - <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'a'</span> + 10;
00313             }
00314         <span class="keywordflow">else</span> {
00315             <span class="keywordflow">break</span>;
00316             }
00317 
00318         <span class="keywordflow">if</span> (Digit &gt;= Base) {
00319             <span class="keywordflow">break</span>;
00320             }
00321 
00322         <span class="keywordflow">if</span> (Shift == 0) {
00323             Result = (Base * Result) + Digit;
00324             }
00325         <span class="keywordflow">else</span> {
00326             Result = (Result &lt;&lt; Shift) | Digit;
00327             }
00328 
00329         <span class="keywordflow">if</span> (!nChars) {
00330             <span class="keywordflow">break</span>;
00331             }
00332         nChars--;
00333         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> = *s++;
00334         }
00335 
00336     <span class="keywordflow">if</span> (Sign == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'-'</span>) {
00337         Result = (ULONG)(-(LONG)Result);
00338         }
00339 
00340     <span class="keywordflow">try</span> {
00341         *Value = Result;
00342         }
00343     except( EXCEPTION_EXECUTE_HANDLER ) {
00344         <span class="keywordflow">return</span>( GetExceptionCode() );
00345         }
00346 
00347     <span class="keywordflow">return</span>( STATUS_SUCCESS );
00348 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="cnvint.c::RtlpIntegerChars" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a> <a class="el" href="../../d9/d3/cnvint_8c.html#a0">RtlpIntegerChars</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {<span class="charliteral">'0'</span>, <span class="charliteral">'1'</span>, <span class="charliteral">'2'</span>, <span class="charliteral">'3'</span>, <span class="charliteral">'4'</span>, <span class="charliteral">'5'</span>, <span class="charliteral">'6'</span>, <span class="charliteral">'7'</span>,
                           <span class="charliteral">'8'</span>, <span class="charliteral">'9'</span>, <span class="charliteral">'A'</span>, <span class="charliteral">'B'</span>, <span class="charliteral">'C'</span>, <span class="charliteral">'D'</span>, <span class="charliteral">'E'</span>, <span class="charliteral">'F'</span>}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00032">32</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00040">RtlIntegerToChar()</a>, and <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00456">RtlLargeIntegerToChar()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="cnvint.c::RtlpIntegerWChars" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR <a class="el" href="../../d9/d3/cnvint_8c.html#a1">RtlpIntegerWChars</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'1'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'2'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'3'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'4'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'5'</span>,
                              <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'6'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'7'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'8'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'9'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'A'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'B'</span>,
                              <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'C'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'D'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'E'</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'F'</span> }
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00035">35</a> of file <a class="el" href="../../d0/d3/cnvint_8c-source.html">cnvint.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00352">RtlIntegerToUnicode()</a>, and <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00544">RtlLargeIntegerToUnicode()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:12 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
