<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: debug3.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>debug3.c</h1><a href="../../d8/d5/debug3_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//++</span>
00002 <span class="comment">//</span>
00003 <span class="comment">// Copyright (c) 1990  Microsoft Corporation</span>
00004 <span class="comment">//</span>
00005 <span class="comment">// Module Name:</span>
00006 <span class="comment">//</span>
00007 <span class="comment">//    debug3.c</span>
00008 <span class="comment">//</span>
00009 <span class="comment">// Abstract:</span>
00010 <span class="comment">//</span>
00011 <span class="comment">//    This module implements architecture specific functions to support debugging NT.</span>
00012 <span class="comment">//</span>
00013 <span class="comment">// Author:</span>
00014 <span class="comment">//</span>
00015 <span class="comment">//    Steven R. Wood (stevewo) 3-Aug-1989</span>
00016 <span class="comment">//</span>
00017 <span class="comment">// Environment:</span>
00018 <span class="comment">//</span>
00019 <span class="comment">//    Any mode.</span>
00020 <span class="comment">//</span>
00021 <span class="comment">// Revision History:</span>
00022 <span class="comment">//</span>
00023 <span class="comment">//--</span>
00024 
00025 <span class="preprocessor">#include "stdarg.h"</span>
00026 <span class="preprocessor">#include "stdio.h"</span>
00027 <span class="preprocessor">#include "string.h"</span>
00028 <span class="preprocessor">#include "<a class="code" href="../../d5/d9/ntrtlp_8h.html">ntrtlp.h</a>"</span>
00029 
00030 <span class="comment">//</span>
00031 <span class="comment">// Prototype for local procedure</span>
00032 <span class="comment">//</span>
00033 
00034 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00035 <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>(
00036     ULONG   ServiceClass,
00037     PVOID   Arg1,
00038     PVOID   Arg2
00039     );
00040 
<a name="l00041"></a><a class="code" href="../../d8/d5/debug3_8c.html#a1">00041</a> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> <a class="code" href="../../d8/d5/debug3_8c.html#a1">_fptrap</a>() {};
00042 
00043 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00044"></a><a class="code" href="../../d5/d9/ntrtlp_8h.html#a44">00044</a> <a class="code" href="../../d7/d2/drivesup_8c.html#a0">DebugPrint</a>(
00045     IN PSTRING Output
00046     )
00047 {
00048     <span class="keywordflow">return</span> <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>( BREAKPOINT_PRINT, Output, 0 );
00049 }
00050 
00051 
00052 ULONG
<a name="l00053"></a><a class="code" href="../../d5/d9/ntrtlp_8h.html#a45">00053</a> <a class="code" href="../../d5/d9/ntrtlp_8h.html#a45">DebugPrompt</a>(
00054     IN PSTRING Output,
00055     IN PSTRING Input
00056     )
00057 {
00058     <span class="keywordflow">return</span> <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>( BREAKPOINT_PROMPT, Output, Input );
00059 }
00060 
00061 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00062"></a><a class="code" href="../../d8/d5/debug3_8c.html#a4">00062</a> <a class="code" href="../../d8/d5/debug3_8c.html#a4">DebugLoadImageSymbols</a>(
00063     IN PSTRING FileName,
00064     IN <a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a> SymbolInfo
00065     )
00066 {
00067     <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>( BREAKPOINT_LOAD_SYMBOLS, <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>, SymbolInfo );
00068 }
00069 
00070 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00071"></a><a class="code" href="../../d8/d5/debug3_8c.html#a0">00071</a> <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>(
00072     ULONG   ServiceClass,
00073     PVOID   Arg1,
00074     PVOID   Arg2
00075     )
00076 
00077 <span class="comment">//++</span>
00078 <span class="comment">//</span>
00079 <span class="comment">//  Routine Description:</span>
00080 <span class="comment">//</span>
00081 <span class="comment">//      Allocate an ExceptionRecord, fill in data to allow exception</span>
00082 <span class="comment">//      dispatch code to do the right thing with the service, and</span>
00083 <span class="comment">//      call RtlRaiseException (NOT ExRaiseException!!!).</span>
00084 <span class="comment">//</span>
00085 <span class="comment">//  Arguments:</span>
00086 <span class="comment">//      ServiceClass - which call is to be performed</span>
00087 <span class="comment">//      Arg1 - generic first argument</span>
00088 <span class="comment">//      Arg2 - generic second argument</span>
00089 <span class="comment">//</span>
00090 <span class="comment">//  Returns:</span>
00091 <span class="comment">//      Whatever the exception returns in eax</span>
00092 <span class="comment">//</span>
00093 <span class="comment">//--</span>
00094 
00095 {
00096     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>    RetValue;
00097 
00098 <span class="preprocessor">#if defined(BUILD_WOW6432)</span>
00099 <span class="preprocessor"></span>
00100     <span class="keyword">extern</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d2/d0/ntwow64_8h.html#a13">NtWow64DebuggerCall</a>(ULONG, PVOID, PVOID);
00101     RetValue = <a class="code" href="../../d2/d0/ntwow64_8h.html#a13">NtWow64DebuggerCall</a>(ServiceClass, Arg1, Arg2);
00102 
00103 <span class="preprocessor">#else</span>
00104 <span class="preprocessor"></span>    _asm {
00105         mov     eax, ServiceClass
00106         mov     ecx, Arg1
00107         mov     edx, Arg2
00108 
00109         <span class="keywordtype">int</span>     2dh                 ; Raise exception
00110         <span class="keywordtype">int</span>     3                   ; DO NOT REMOVE (See KiDebugService)
00111 
00112         mov     RetValue, eax
00113 
00114     }
00115 <span class="preprocessor">#endif</span>
00116 <span class="preprocessor"></span>
00117     <span class="keywordflow">return</span> RetValue;
00118 }
00119 
00120 
00121 <span class="comment">// DebugUnloadImageSymbols must appear after DebugSerive.  Moved</span>
00122 <span class="comment">// it down below DebugService, so BBT would have a label after DebugService.</span>
00123 <span class="comment">// A label after the above _asm  is necessary so BBT can treat DebugService</span>
00124 <span class="comment">// as  "KnownDataRange".   Otherwise, the two  'int' instructions could get broken up</span>
00125 <span class="comment">// by BBT's optimizer.</span>
00126 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00127"></a><a class="code" href="../../d8/d5/debug3_8c.html#a5">00127</a> <a class="code" href="../../d8/d5/debug3_8c.html#a5">DebugUnLoadImageSymbols</a>(
00128     IN PSTRING FileName,
00129     IN <a class="code" href="../../d6/d5/struct__KD__SYMBOLS__INFO.html">PKD_SYMBOLS_INFO</a> SymbolInfo
00130     )
00131 {
00132     <a class="code" href="../../d8/d5/debug3_8c.html#a0">DebugService</a>( BREAKPOINT_UNLOAD_SYMBOLS, <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>, SymbolInfo );
00133 }
00134 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:39 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
