<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ctrlc.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ctrlc.c File Reference</h1><code>#include "<a class="el" href="../../d5/d2/w32_2ntcon_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d0/d0/ctrlc_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a0">LIST_INCREMENT</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a1">INITIAL_LIST_SIZE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a2">NUMBER_OF_CTRL_EVENTS</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a3">SYSTEM_CLOSE_EVENT</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a4">IGNORE_CTRL_C</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a10">DefaultHandler</a> (IN ULONG CtrlType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a11">InitializeCtrlHandling</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a12">CtrlRoutine</a> (IN <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpThreadParameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a13">SetLastConsoleEventActiveInternal</a> (VOID)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defined(BUILD_WOW64)  <a href="#a13"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a14">SetLastConsoleEventActive</a> (VOID)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defined(BUILD_WOW6432)  <a href="#a14"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a15">SetCtrlHandler</a> (IN PHANDLER_ROUTINE HandlerRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a16">RemoveCtrlHandler</a> (IN PHANDLER_ROUTINE HandlerRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a17">SetConsoleCtrlHandler</a> (IN PHANDLER_ROUTINE HandlerRoutine, IN BOOL Add)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PHANDLER_ROUTINE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a5">SingleHandler</a> [INITIAL_LIST_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a7">AllocatedHandlerListLength</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PHANDLER_ROUTINE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/ctrlc_8c.html#a9">LastConsoleEventActive</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a4" doxytag="ctrlc.c::IGNORE_CTRL_C" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IGNORE_CTRL_C&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00037">37</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ctrlc.c::INITIAL_LIST_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INITIAL_LIST_SIZE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00027">27</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ctrlc.c::LIST_INCREMENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LIST_INCREMENT&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00026">26</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ctrlc.c::NUMBER_OF_CTRL_EVENTS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NUMBER_OF_CTRL_EVENTS&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00034">34</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ctrlc.c::SYSTEM_CLOSE_EVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SYSTEM_CLOSE_EVENT&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00035">35</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a12" doxytag="ctrlc.c::CtrlRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CtrlRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpThreadParameter</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">93</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00043">DefaultHandler()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00032">HandlerList</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00030">HandlerListLength</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00037">IGNORE_CTRL_C</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00039">LastConsoleEventActive</a>, <a class="el" href="../../d7/d3/condll_8h-source.html#l00068">LockDll</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00034">NUMBER_OF_CTRL_EVENTS</a>, <a class="el" href="../../d0/d9/ppc_2exdsptch_8c-source.html#l00466">RtlRaiseException()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00035">SYSTEM_CLOSE_EVENT</a>, and <a class="el" href="../../d7/d3/condll_8h-source.html#l00069">UnlockDll</a>.
<p>
<pre class="fragment"><div>00099                    :
00100 
00101     This thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> created when ctrl-<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a35">c</a> or ctrl-<span class="keywordflow">break</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> entered,
00102     or when close <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> selected.  <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> calls <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate handlers.
00103 
00104 Arguments:
00105 
00106     lpThreadParameter - what <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of event happened.
00107 
00108 Return Value:
00109 
00110     STATUS_SUCCESS
00111 
00112 --*/
00113 
00114 {
00115     ULONG i;
00116     ULONG EventNumber,OriginalEventNumber;
00117     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fNoExit;
00118     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwExitCode;
00119     EXCEPTION_RECORD ExceptionRecord;
00120 
00121     SetThreadPriority(NtCurrentThread(), THREAD_PRIORITY_HIGHEST);
00122     OriginalEventNumber = EventNumber = PtrToUlong(lpThreadParameter);
00123 
00124     <span class="comment">//</span>
00125     <span class="comment">// If this bit is set, it means we don't want to cause this process</span>
00126     <span class="comment">// to exit itself if it is a logoff or shutdown event.</span>
00127     <span class="comment">//</span>
00128     fNoExit = 0x80000000 &amp; EventNumber;
00129     EventNumber &amp;= ~0x80000000;
00130 
00131     <span class="comment">//</span>
00132     <span class="comment">// the ctrl_close event is set when the user selects the window</span>
00133     <span class="comment">// close option from the system menu, or EndTask, or Settings-Terminate.</span>
00134     <span class="comment">// the system close event is used when another ctrl-thread times out.</span>
00135     <span class="comment">//</span>
00136 
00137     <span class="keywordflow">switch</span> (EventNumber) {
00138     <span class="keywordflow">default</span>:
00139         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (EventNumber &lt; NUMBER_OF_CTRL_EVENTS);
00140         <span class="keywordflow">if</span> (EventNumber &gt;= <a class="code" href="../../d9/d0/ctrlc_8c.html#a2">NUMBER_OF_CTRL_EVENTS</a>)
00141             <span class="keywordflow">return</span> (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)STATUS_UNSUCCESSFUL;
00142         <span class="keywordflow">break</span>;
00143 
00144     <span class="keywordflow">case</span> CTRL_C_EVENT:
00145     <span class="keywordflow">case</span> CTRL_BREAK_EVENT:
00146         <span class="comment">//</span>
00147         <span class="comment">// If the process is being debugged, give the debugger</span>
00148         <span class="comment">// a shot. If the debugger handles the exception, then</span>
00149         <span class="comment">// go back and wait.</span>
00150         <span class="comment">//</span>
00151 
00152         <span class="keywordflow">if</span> (!IsDebuggerPresent())
00153             <span class="keywordflow">break</span>;
00154 
00155         <span class="keywordflow">if</span> ( EventNumber == CTRL_C_EVENT ) {
00156             ExceptionRecord.ExceptionCode = DBG_CONTROL_C;
00157             }
00158         <span class="keywordflow">else</span> {
00159             ExceptionRecord.ExceptionCode = DBG_CONTROL_BREAK;
00160             }
00161         ExceptionRecord.ExceptionFlags = 0;
00162         ExceptionRecord.ExceptionRecord = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00163         ExceptionRecord.ExceptionAddress = (PVOID)<a class="code" href="../../d9/d0/ctrlc_8c.html#a10">DefaultHandler</a>;
00164         ExceptionRecord.NumberParameters = 0;
00165 
00166         <span class="keywordflow">try</span> {
00167             <a class="code" href="../../d9/d9/ppc_2exdsptch_8c.html#a9">RtlRaiseException</a>(&amp;ExceptionRecord);
00168         } except (EXCEPTION_EXECUTE_HANDLER) {
00169             <a class="code" href="../../d6/d4/condll_8h.html#a9">LockDll</a>();
00170             <span class="keywordflow">try</span> {
00171                 <span class="keywordflow">if</span> (EventNumber != CTRL_C_EVENT ||
00172                         NtCurrentPeb()-&gt;ProcessParameters-&gt;ConsoleFlags != <a class="code" href="../../d9/d0/ctrlc_8c.html#a4">IGNORE_CTRL_C</a>) {
00173                     <span class="keywordflow">for</span> (i=<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>;i&gt;0;i--) {
00174                         <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a>[i-1])(EventNumber)) {
00175                             <span class="keywordflow">break</span>;
00176                         }
00177                     }
00178                 }
00179             } finally {
00180                 <a class="code" href="../../d6/d4/condll_8h.html#a10">UnlockDll</a>();
00181             }
00182         }
00183         ExitThread(0);
00184         <span class="keywordflow">break</span>;
00185 
00186     <span class="keywordflow">case</span> <a class="code" href="../../d9/d0/ctrlc_8c.html#a3">SYSTEM_CLOSE_EVENT</a>:
00187         ExitProcess((DWORD)CONTROL_C_EXIT);
00188         <span class="keywordflow">break</span>;
00189 
00190     <span class="keywordflow">case</span> SYSTEM_ROOT_CONSOLE_EVENT:
00191         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d0/ctrlc_8c.html#a9">LastConsoleEventActive</a>)
00192             ExitThread(0);
00193         <span class="keywordflow">break</span>;
00194 
00195     <span class="keywordflow">case</span> CTRL_CLOSE_EVENT:
00196     <span class="keywordflow">case</span> CTRL_LOGOFF_EVENT:
00197     <span class="keywordflow">case</span> CTRL_SHUTDOWN_EVENT:
00198         <span class="comment">//if (LastConsoleEventActive)</span>
00199             <span class="comment">//EventNumber = SYSTEM_ROOT_CONSOLE_EVENT;</span>
00200         <span class="keywordflow">break</span>;
00201     }
00202 
00203     <a class="code" href="../../d6/d4/condll_8h.html#a9">LockDll</a>();
00204     dwExitCode = 0;
00205     <span class="keywordflow">try</span> {
00206         <span class="keywordflow">if</span> (EventNumber != CTRL_C_EVENT ||
00207                 NtCurrentPeb()-&gt;ProcessParameters-&gt;ConsoleFlags != <a class="code" href="../../d9/d0/ctrlc_8c.html#a4">IGNORE_CTRL_C</a>) {
00208             <span class="keywordflow">for</span> (i=<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>;i&gt;0;i--) {
00209 
00210                 <span class="comment">//</span>
00211                 <span class="comment">// Don't call the last handler (the default one which calls</span>
00212                 <span class="comment">// ExitProcess() if this process isn't supposed to exit (system</span>
00213                 <span class="comment">// process are not supposed to exit because of shutdown or</span>
00214                 <span class="comment">// logoff event notification).</span>
00215                 <span class="comment">//</span>
00216 
00217                 <span class="keywordflow">if</span> ((i-1) == 0 &amp;&amp; fNoExit) {
00218                     <span class="keywordflow">if</span> (EventNumber == CTRL_LOGOFF_EVENT ||
00219                         EventNumber == CTRL_SHUTDOWN_EVENT) {
00220                         <span class="keywordflow">break</span>;
00221                     }
00222                 }
00223 
00224                 <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a>[i-1])(EventNumber)) {
00225                     <span class="keywordflow">switch</span> (EventNumber) {
00226                     <span class="keywordflow">case</span> CTRL_CLOSE_EVENT:
00227                     <span class="keywordflow">case</span> CTRL_LOGOFF_EVENT:
00228                     <span class="keywordflow">case</span> CTRL_SHUTDOWN_EVENT:
00229                     <span class="keywordflow">case</span> SYSTEM_ROOT_CONSOLE_EVENT:
00230                         dwExitCode = OriginalEventNumber;
00231                         <span class="keywordflow">break</span>;
00232                     }
00233                     <span class="keywordflow">break</span>;
00234                 }
00235             }
00236         }
00237     } finally {
00238         <a class="code" href="../../d6/d4/condll_8h.html#a10">UnlockDll</a>();
00239     }
00240     ExitThread(dwExitCode);
00241     <span class="keywordflow">return</span> STATUS_SUCCESS;
00242 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ctrlc.c::DefaultHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DefaultHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CtrlType</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00043">43</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>.
<p>
<pre class="fragment"><div>00051           :
00052 
00053     CtrlType - <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of ctrl event (ctrl-c, ctrl-<span class="keywordflow">break</span>).
00054 
00055 Return Value:
00056 
00057     none.
00058 
00059 --*/
00060 
00061 {
00062     ExitProcess((DWORD)CONTROL_C_EXIT);
00063     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00064     UNREFERENCED_PARAMETER(CtrlType);
00065 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ctrlc.c::InitializeCtrlHandling" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitializeCtrlHandling           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">68</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00031">AllocatedHandlerListLength</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00043">DefaultHandler()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00032">HandlerList</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00030">HandlerListLength</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00027">INITIAL_LIST_SIZE</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00029">SingleHandler</a>.
<p>
Referenced by <a class="el" href="../../d9/d8/dllinit_8c-source.html#l00803">AllocConsole()</a>, and <a class="el" href="../../d9/d8/dllinit_8c-source.html#l00470">ConDllInitialize()</a>.
<p>
<pre class="fragment"><div>00075           :
00076 
00077     none.
00078 
00079 Return Value:
00080 
00081     none.
00082 
00083 --*/
00084 
00085 {
00086     <a class="code" href="../../d9/d0/ctrlc_8c.html#a7">AllocatedHandlerListLength</a> = <a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a> = <a class="code" href="../../d9/d0/ctrlc_8c.html#a1">INITIAL_LIST_SIZE</a>;
00087     <a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a> = <a class="code" href="../../d9/d0/ctrlc_8c.html#a5">SingleHandler</a>;
00088     <a class="code" href="../../d9/d0/ctrlc_8c.html#a5">SingleHandler</a>[0] = <a class="code" href="../../d9/d0/ctrlc_8c.html#a10">DefaultHandler</a>;
00089     <span class="keywordflow">return</span> STATUS_SUCCESS;
00090 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ctrlc.c::RemoveCtrlHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL RemoveCtrlHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PHANDLER_ROUTINE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandlerRoutine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00368">368</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00032">HandlerList</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00030">HandlerListLength</a>, <a class="el" href="../../d7/d3/condll_8h-source.html#l00048">SET_LAST_ERROR</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00417">SetConsoleCtrlHandler()</a>.
<p>
<pre class="fragment"><div>00374                    :
00375 
00376     This routine removes a ctrl handler from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process's list.
00377 
00378 Arguments:
00379 
00380     HandlerRoutine - pointer to ctrl handler.
00381 
00382 Return Value:
00383 
00384     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - success.
00385 
00386 --*/
00387 
00388 {
00389     ULONG i;
00390 
00391     <span class="comment">//</span>
00392     <span class="comment">// NULL handler routine is not stored in table. It is</span>
00393     <span class="comment">// used to temporarily inhibit ^C event handling. Removing</span>
00394     <span class="comment">// this handler allows normal processing to occur</span>
00395     <span class="comment">//</span>
00396 
00397     <span class="keywordflow">if</span> ( !HandlerRoutine ) {
00398         NtCurrentPeb()-&gt;ProcessParameters-&gt;ConsoleFlags = 0;
00399         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00400         }
00401 
00402     <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>;i++) {
00403         <span class="keywordflow">if</span> (*(<a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a>+i) == HandlerRoutine) {
00404             <span class="keywordflow">if</span> (i &lt; (<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>-1)) {
00405                 memmove(&amp;HandlerList[i],&amp;HandlerList[i+1],<span class="keyword">sizeof</span>(PHANDLER_ROUTINE) * (HandlerListLength - i - 1));
00406             }
00407             <a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a> -= 1;
00408             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00409         }
00410     }
00411     <a class="code" href="../../d6/d4/condll_8h.html#a2">SET_LAST_ERROR</a>(ERROR_INVALID_PARAMETER);
00412     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00413 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ctrlc.c::SetConsoleCtrlHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY SetConsoleCtrlHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PHANDLER_ROUTINE&nbsp;</td>
          <td class="mdname" nowrap> <em>HandlerRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>Add</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00417">417</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d3/condll_8h-source.html#l00068">LockDll</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00368">RemoveCtrlHandler()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>, and <a class="el" href="../../d7/d3/condll_8h-source.html#l00069">UnlockDll</a>.
<p>
<pre class="fragment"><div>00424                    :
00425 
00426     This routine adds or removes a ctrl handler from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process's list.
00427 
00428 Arguments:
00429 
00430     HandlerRoutine - pointer to ctrl handler.
00431 
00432     Add - <span class="keywordflow">if</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, add handler.  <span class="keywordflow">else</span> remove.
00433 
00434 Return Value:
00435 
00436     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - success.
00437 
00438 --*/
00439 
00440 {
00441     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> Success;
00442 
00443     <a class="code" href="../../d6/d4/condll_8h.html#a9">LockDll</a>();
00444     <span class="keywordflow">if</span> (Add) {
00445         Success = <a class="code" href="../../d9/d0/ctrlc_8c.html#a15">SetCtrlHandler</a>(HandlerRoutine);
00446     }
00447     <span class="keywordflow">else</span> {
00448         Success = <a class="code" href="../../d9/d0/ctrlc_8c.html#a16">RemoveCtrlHandler</a>(HandlerRoutine);
00449     }
00450     <a class="code" href="../../d6/d4/condll_8h.html#a10">UnlockDll</a>();
00451     <span class="keywordflow">return</span> Success;
00452 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ctrlc.c::SetCtrlHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SetCtrlHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PHANDLER_ROUTINE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandlerRoutine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">297</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00031">AllocatedHandlerListLength</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00032">HandlerList</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00030">HandlerListLength</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00037">IGNORE_CTRL_C</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00026">LIST_INCREMENT</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00022">RtlAllocateHeap</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00023">RtlFreeHeap</a>, <a class="el" href="../../d7/d3/condll_8h-source.html#l00048">SET_LAST_ERROR</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00029">SingleHandler</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00417">SetConsoleCtrlHandler()</a>.
<p>
<pre class="fragment"><div>00303                    :
00304 
00305     This routine adds a ctrl handler to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process's list.
00306 
00307 Arguments:
00308 
00309     HandlerRoutine - pointer to ctrl handler.
00310 
00311 Return Value:
00312 
00313     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - success.
00314 
00315 --*/
00316 
00317 {
00318     PHANDLER_ROUTINE *NewHandlerList;
00319 
00320     <span class="comment">//</span>
00321     <span class="comment">// NULL handler routine is not stored in table. It is</span>
00322     <span class="comment">// used to temporarily inhibit ^C event handling</span>
00323     <span class="comment">//</span>
00324 
00325     <span class="keywordflow">if</span> ( !HandlerRoutine ) {
00326         NtCurrentPeb()-&gt;ProcessParameters-&gt;ConsoleFlags = <a class="code" href="../../d9/d0/ctrlc_8c.html#a4">IGNORE_CTRL_C</a>;
00327         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00328         }
00329 
00330     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a> == <a class="code" href="../../d9/d0/ctrlc_8c.html#a7">AllocatedHandlerListLength</a>) {
00331 
00332         <span class="comment">//</span>
00333         <span class="comment">// grow list</span>
00334         <span class="comment">//</span>
00335 
00336         NewHandlerList = (PHANDLER_ROUTINE *) <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a0">RtlAllocateHeap</a>( RtlProcessHeap(), 0,
00337                                                  <span class="keyword">sizeof</span>(PHANDLER_ROUTINE) * (HandlerListLength + LIST_INCREMENT));
00338         <span class="keywordflow">if</span> (!NewHandlerList) {
00339             <a class="code" href="../../d6/d4/condll_8h.html#a2">SET_LAST_ERROR</a>(ERROR_NOT_ENOUGH_MEMORY);
00340             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00341         }
00342 
00343         <span class="comment">//</span>
00344         <span class="comment">// copy list</span>
00345         <span class="comment">//</span>
00346 
00347         RtlCopyMemory(NewHandlerList,HandlerList,<span class="keyword">sizeof</span>(PHANDLER_ROUTINE) * HandlerListLength);
00348 
00349         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a> != <a class="code" href="../../d9/d0/ctrlc_8c.html#a5">SingleHandler</a>) {
00350 
00351             <span class="comment">//</span>
00352             <span class="comment">// free old list</span>
00353             <span class="comment">//</span>
00354 
00355             <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a1">RtlFreeHeap</a>(RtlProcessHeap(), 0, HandlerList);
00356         }
00357         <a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a> = NewHandlerList;
00358         <a class="code" href="../../d9/d0/ctrlc_8c.html#a7">AllocatedHandlerListLength</a> += <a class="code" href="../../d9/d0/ctrlc_8c.html#a0">LIST_INCREMENT</a>;
00359     }
00360     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (HandlerListLength &lt; AllocatedHandlerListLength);
00361 
00362     <a class="code" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a>[<a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>] = HandlerRoutine;
00363     <a class="code" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>++;
00364     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00365 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ctrlc.c::SetLastConsoleEventActive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID APIENTRY SetLastConsoleEventActive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
defined(BUILD_WOW6432) 
<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00288">288</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00039">LastConsoleEventActive</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00250">SetLastConsoleEventActiveInternal()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00290 {
00291 
00292     <a class="code" href="../../d9/d0/ctrlc_8c.html#a9">LastConsoleEventActive</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00293     <a class="code" href="../../d9/d0/ctrlc_8c.html#a13">SetLastConsoleEventActiveInternal</a>();
00294 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ctrlc.c::SetLastConsoleEventActiveInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID APIENTRY SetLastConsoleEventActiveInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
defined(BUILD_WOW64) 
<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00250">250</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
References <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00750">_CONSOLE_NOTIFYLASTCLOSE_MSG::ConsoleHandle</a>, <a class="el" href="../../d5/d5/conmsg_8h.html#a236a230">ConsolepNotifyLastClose</a>, <a class="el" href="../../d9/d8/wow64csr_8c-source.html#l00075">CsrClientCallServer()</a>, <a class="el" href="../../d7/d3/condll_8h-source.html#l00047">GET_CONSOLE_HANDLE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d9/struct__CONSOLE__API__MSG.html#o77">_CONSOLE_API_MSG::u</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00288">SetLastConsoleEventActive()</a>.
<p>
<pre class="fragment"><div>00254                    :
00255 
00256     Sends a <a class="code" href="../../d5/d5/conmsg_8h.html#a236a230">ConsolepNotifyLastClose</a> command to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> server.
00257 
00258 Arguments:
00259 
00260     none.
00261 
00262 Return Value:
00263 
00264     None.
00265 
00266 --*/
00267 
00268 {
00269     <a class="code" href="../../d5/d9/struct__CONSOLE__API__MSG.html">CONSOLE_API_MSG</a> m;
00270     <a class="code" href="../../d8/d3/struct__CONSOLE__NOTIFYLASTCLOSE__MSG.html">PCONSOLE_NOTIFYLASTCLOSE_MSG</a> a = &amp;m.<a class="code" href="../../d5/d9/struct__CONSOLE__API__MSG.html#o77">u</a>.SetLastConsoleEventActive;
00271 
00272     a-&gt;<a class="code" href="../../d8/d3/struct__CONSOLE__NOTIFYLASTCLOSE__MSG.html#o0">ConsoleHandle</a> = <a class="code" href="../../d6/d4/condll_8h.html#a1">GET_CONSOLE_HANDLE</a>;
00273     <a class="code" href="../../d8/d9/wow64csr_8c.html#a4">CsrClientCallServer</a>( (PCSR_API_MSG)&amp;m,
00274                          NULL,
00275                          CSR_MAKE_API_NUMBER( CONSRV_SERVERDLL_INDEX,
00276                                               ConsolepNotifyLastClose
00277                                             ),
00278                          <span class="keyword">sizeof</span>( *a )
00279                        );
00280 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a7" doxytag="ctrlc.c::AllocatedHandlerListLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d0/ctrlc_8c.html#a7">AllocatedHandlerListLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00031">31</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ctrlc.c::HandlerList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PHANDLER_ROUTINE* <a class="el" href="../../d9/d0/ctrlc_8c.html#a8">HandlerList</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00032">32</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00814">Psp386InsertVdmIoHandlerBlock()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00368">RemoveCtrlHandler()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ctrlc.c::HandlerListLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d0/ctrlc_8c.html#a6">HandlerListLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00030">30</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>, <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00368">RemoveCtrlHandler()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ctrlc.c::LastConsoleEventActive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d9/d0/ctrlc_8c.html#a9">LastConsoleEventActive</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00039">39</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00093">CtrlRoutine()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00288">SetLastConsoleEventActive()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ctrlc.c::SingleHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PHANDLER_ROUTINE <a class="el" href="../../d9/d0/ctrlc_8c.html#a5">SingleHandler</a>[INITIAL_LIST_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00029">29</a> of file <a class="el" href="../../d0/d0/ctrlc_8c-source.html">ctrlc.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00068">InitializeCtrlHandling()</a>, and <a class="el" href="../../d0/d0/ctrlc_8c-source.html#l00297">SetCtrlHandler()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:21 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
