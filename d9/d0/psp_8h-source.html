<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: psp.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>psp.h</h1><a href="../../d8/d1/psp_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    psp.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Private Interfaces for process structure.</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Mark Lucovsky (markl) 20-Apr-1989</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#ifndef _PSP_</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#define _PSP_</span>
00023 <span class="preprocessor"></span>
00024 <span class="preprocessor">#include "<a class="code" href="../../d9/d8/ntos_8h.html">ntos.h</a>"</span>
00025 <span class="preprocessor">#include "ntrtl.h"</span>
00026 <span class="preprocessor">#include "nturtl.h"</span>
00027 <span class="preprocessor">#include "zwapi.h"</span>
00028 <span class="preprocessor">#include "<a class="code" href="../../d0/d0/ki_8h.html">ki.h</a>"</span>
00029 <span class="preprocessor">#if defined(_X86_)</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="../../d1/d5/vdmntos_8h.html">vdmntos.h</a>&gt;</span>
00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a><a class="code" href="../../d8/d1/psp_8h.html#a0">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define NOEXTAPI</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#include "wdbgexts.h"</span>
00034 <span class="preprocessor">#include "ntdbg.h"</span>
00035 <span class="preprocessor">#include &lt;string.h&gt;</span>
00036 <span class="preprocessor">#if defined(_WIN64)</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#include &lt;wow64t.h&gt;</span>
00038 <span class="preprocessor">#endif</span>
00039 <span class="preprocessor"></span>
00040 <span class="preprocessor">#ifdef POOL_TAGGING</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define ExAllocatePool(a,b) ExAllocatePoolWithTag(a,b,'  sP')</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define ExAllocatePoolWithQuota(a,b) ExAllocatePoolWithQuotaTag(a,b,'  sP')</span>
00043 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00044 <span class="preprocessor"></span>
00045 <span class="comment">//</span>
00046 <span class="comment">// Process Quota Charges:</span>
00047 <span class="comment">//</span>
00048 <span class="comment">//  PagedPool</span>
00049 <span class="comment">//      Directory Base Page - PAGE_SIZE</span>
00050 <span class="comment">//</span>
00051 <span class="comment">//  NonPaged</span>
00052 <span class="comment">//      Object Body         - sizeof(EPROCESS)</span>
00053 <span class="comment">//</span>
00054 
<a name="l00055"></a><a class="code" href="../../d8/d1/psp_8h.html#a1">00055</a> <span class="preprocessor">#define PSP_PROCESS_PAGED_CHARGE    (PAGE_SIZE)</span>
<a name="l00056"></a><a class="code" href="../../d8/d1/psp_8h.html#a2">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define PSP_PROCESS_NONPAGED_CHARGE (sizeof(EPROCESS))</span>
00057 <span class="preprocessor"></span>
00058 <span class="comment">//</span>
00059 <span class="comment">// Thread Quota Charges:</span>
00060 <span class="comment">//</span>
00061 <span class="comment">//  PagedPool</span>
00062 <span class="comment">//      Kernel Stack        - 0</span>
00063 <span class="comment">//</span>
00064 <span class="comment">//  NonPaged</span>
00065 <span class="comment">//      Object Body         - sizeof(ETHREAD)</span>
00066 <span class="comment">//</span>
00067 
<a name="l00068"></a><a class="code" href="../../d8/d1/psp_8h.html#a3">00068</a> <span class="preprocessor">#define PSP_THREAD_PAGED_CHARGE     (0)</span>
<a name="l00069"></a><a class="code" href="../../d8/d1/psp_8h.html#a4">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define PSP_THREAD_NONPAGED_CHARGE  (sizeof(ETHREAD))</span>
00070 <span class="preprocessor"></span>
<a name="l00071"></a><a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html">00071</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html">_TERMINATION_PORT</a> {
<a name="l00072"></a><a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html#o0">00072</a>     LIST_ENTRY <a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html#o0">Links</a>;
<a name="l00073"></a><a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html#o1">00073</a>     PVOID <a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html#o1">Port</a>;
00074 } <a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html">TERMINATION_PORT</a>, *<a class="code" href="../../d3/d0/struct__TERMINATION__PORT.html">PTERMINATION_PORT</a>;
00075 
<a name="l00076"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html">00076</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html">_GETSETCONTEXT</a> {
<a name="l00077"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o0">00077</a>     <a class="code" href="../../d1/d5/struct__KAPC.html">KAPC</a> <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o0">Apc</a>;
<a name="l00078"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o1">00078</a>     <a class="code" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o1">Mode</a>;
<a name="l00079"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o2">00079</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o2">OperationComplete</a>;
<a name="l00080"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o3">00080</a>     CONTEXT <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o3">Context</a>;
<a name="l00081"></a><a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o4">00081</a>     KNONVOLATILE_CONTEXT_POINTERS <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html#o4">NonVolatileContext</a>;
00082 } <a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html">GETSETCONTEXT</a>, *<a class="code" href="../../d1/d2/struct__GETSETCONTEXT.html">PGETSETCONTEXT</a>;
00083 
<a name="l00084"></a><a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html">00084</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html">_SYSTEM_DLL</a> {
<a name="l00085"></a><a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o0">00085</a>     PVOID <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o0">Section</a>;
<a name="l00086"></a><a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">00086</a>     PVOID <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o1">DllBase</a>;
<a name="l00087"></a><a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o2">00087</a>     <a class="code" href="../../d0/d9/ntosdef_8h.html#a41">PKNORMAL_ROUTINE</a> <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html#o2">LoaderInitRoutine</a>;
00088 } <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html">SYSTEM_DLL</a>, <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html">PSYSTEM_DLL</a>;
00089 
<a name="l00090"></a><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html">00090</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html">_JOB_WORKING_SET_CHANGE_HEAD</a> {
<a name="l00091"></a><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o0">00091</a>     LIST_ENTRY <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o0">Links</a>;
<a name="l00092"></a><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o1">00092</a>     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o1">Lock</a>;
<a name="l00093"></a><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o2">00093</a>     SIZE_T <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o2">MinimumWorkingSetSize</a>;
<a name="l00094"></a><a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o3">00094</a>     SIZE_T <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html#o3">MaximumWorkingSetSize</a>;
00095 } <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html">JOB_WORKING_SET_CHANGE_HEAD</a>, *<a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html">PJOB_WORKING_SET_CHANGE_HEAD</a>;
00096 
<a name="l00097"></a><a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html">00097</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html">_JOB_WORKING_SET_CHANGE_RECORD</a> {
<a name="l00098"></a><a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html#o0">00098</a>     LIST_ENTRY <a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html#o0">Links</a>;
<a name="l00099"></a><a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html#o1">00099</a>     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html#o1">Process</a>;
00100 } <a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html">JOB_WORKING_SET_CHANGE_RECORD</a>, *<a class="code" href="../../d8/d4/struct__JOB__WORKING__SET__CHANGE__RECORD.html">PJOB_WORKING_SET_CHANGE_RECORD</a>;
00101 
<a name="l00102"></a><a class="code" href="../../d8/d1/psp_8h.html#a20">00102</a> <a class="code" href="../../d7/d4/struct__JOB__WORKING__SET__CHANGE__HEAD.html">JOB_WORKING_SET_CHANGE_HEAD</a> <a class="code" href="../../d8/d1/psp_8h.html#a20">PspWorkingSetChangeHead</a>;
00103 
00104 <span class="comment">//</span>
00105 <span class="comment">// Private Entry Points</span>
00106 <span class="comment">//</span>
00107 
00108 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00109 <a class="code" href="../../d8/d1/psp_8h.html#a49">PspProcessDump</a>(
00110     IN PVOID Object,
00111     IN <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">POB_DUMP_CONTROL</a> Control OPTIONAL
00112     );
00113 
00114 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00115 <a class="code" href="../../d8/d1/psp_8h.html#a50">PspProcessDelete</a>(
00116     IN PVOID Object
00117     );
00118 
00119 
00120 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00121 <a class="code" href="../../d8/d1/psp_8h.html#a51">PspThreadDump</a>(
00122     IN PVOID Object,
00123     IN <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">POB_DUMP_CONTROL</a> Control OPTIONAL
00124     );
00125 
00126 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00127 <a class="code" href="../../d0/d2/psquota_8c.html#a4">PspInheritQuota</a>(
00128     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> NewProcess,
00129     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ParentProcess
00130     );
00131 
00132 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00133 <a class="code" href="../../d0/d2/psquota_8c.html#a6">PspDereferenceQuota</a>(
00134     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00135     );
00136 
00137 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00138 <a class="code" href="../../d8/d1/psp_8h.html#a54">PspThreadDelete</a>(
00139     IN PVOID Object
00140     );
00141 
00142 <span class="comment">//</span>
00143 <span class="comment">// Initialization and loader entrypoints</span>
00144 <span class="comment">//</span>
00145 
00146 BOOLEAN
00147 <a class="code" href="../../d8/d1/psp_8h.html#a55">PspInitPhase0</a> (
00148     IN <a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock
00149     );
00150 
00151 BOOLEAN
00152 <a class="code" href="../../d8/d1/psp_8h.html#a56">PspInitPhase1</a> (
00153     IN <a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock
00154     );
00155 
00156 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00157 <a class="code" href="../../d8/d1/psp_8h.html#a57">PspInitializeSystemDll</a>( VOID );
00158 
00159 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00160 <a class="code" href="../../d8/d1/psp_8h.html#a58">PspLookupSystemDllEntryPoint</a>(
00161     IN PSZ EntryPointName,
00162     OUT PVOID *EntryPointAddress
00163     );
00164 
00165 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00166 <a class="code" href="../../d8/d1/psp_8h.html#a59">PspLookupKernelUserEntryPoints</a>(
00167     VOID
00168     );
00169 
00170 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>
00171 <a class="code" href="../../d8/d1/psp_8h.html#a60">PspNameToOrdinal</a>(
00172     IN PSZ EntryPointName,
00173     IN ULONG DllBase,
00174     IN ULONG NumberOfNames,
00175     IN PULONG NameTableBase,
00176     IN PUSHORT OrdinalTableBase
00177     );
00178 
00179 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00180 <a class="code" href="../../d8/d1/psp_8h.html#a61">PspMapSystemDll</a>(
00181     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00182     OUT PVOID *DllBase OPTIONAL
00183     );
00184 
00185 <span class="comment">//</span>
00186 <span class="comment">// Internal Creation Functions</span>
00187 <span class="comment">//</span>
00188 
<a name="l00189"></a><a class="code" href="../../d8/d1/psp_8h.html#a5">00189</a> <span class="preprocessor">#define PSP_MAX_CREATE_PROCESS_NOTIFY 8</span>
00190 <span class="preprocessor"></span>
<a name="l00191"></a><a class="code" href="../../d8/d1/psp_8h.html#a21">00191</a> ULONG <a class="code" href="../../d8/d1/psp_8h.html#a21">PspCreateProcessNotifyRoutineCount</a>;
<a name="l00192"></a><a class="code" href="../../d8/d1/psp_8h.html#a22">00192</a> <a class="code" href="../../d1/d9/ps_8h.html#a67">PCREATE_PROCESS_NOTIFY_ROUTINE</a> <a class="code" href="../../d8/d1/psp_8h.html#a22">PspCreateProcessNotifyRoutine</a>[ <a class="code" href="../../d8/d1/psp_8h.html#a5">PSP_MAX_CREATE_PROCESS_NOTIFY</a> ];
00193 
00194 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00195 <a class="code" href="../../d8/d1/psp_8h.html#a62">PspCreateProcess</a>(
00196     OUT PHANDLE ProcessHandle,
00197     IN ACCESS_MASK DesiredAccess,
00198     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL,
00199     IN HANDLE ParentProcess OPTIONAL,
00200     IN BOOLEAN InheritObjectTable,
00201     IN HANDLE SectionHandle OPTIONAL,
00202     IN HANDLE DebugPort OPTIONAL,
00203     IN HANDLE ExceptionPort OPTIONAL
00204     );
00205 
<a name="l00206"></a><a class="code" href="../../d8/d1/psp_8h.html#a6">00206</a> <span class="preprocessor">#define PSP_MAX_CREATE_THREAD_NOTIFY 8</span>
00207 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="../../d8/d1/psp_8h.html#a23">00208</a> ULONG <a class="code" href="../../d8/d1/psp_8h.html#a23">PspCreateThreadNotifyRoutineCount</a>;
<a name="l00209"></a><a class="code" href="../../d8/d1/psp_8h.html#a24">00209</a> <a class="code" href="../../d1/d9/ps_8h.html#a68">PCREATE_THREAD_NOTIFY_ROUTINE</a> <a class="code" href="../../d8/d1/psp_8h.html#a24">PspCreateThreadNotifyRoutine</a>[ <a class="code" href="../../d8/d1/psp_8h.html#a6">PSP_MAX_CREATE_THREAD_NOTIFY</a> ];
00210 
00211 
<a name="l00212"></a><a class="code" href="../../d8/d1/psp_8h.html#a7">00212</a> <span class="preprocessor">#define PSP_MAX_LOAD_IMAGE_NOTIFY 8</span>
<a name="l00213"></a><a class="code" href="../../d8/d1/psp_8h.html#a25">00213</a> <span class="preprocessor"></span>ULONG <a class="code" href="../../d8/d1/psp_8h.html#a25">PspLoadImageNotifyRoutineCount</a>;
<a name="l00214"></a><a class="code" href="../../d8/d1/psp_8h.html#a26">00214</a> <a class="code" href="../../d1/d9/ps_8h.html#a71">PLOAD_IMAGE_NOTIFY_ROUTINE</a> <a class="code" href="../../d8/d1/psp_8h.html#a26">PspLoadImageNotifyRoutine</a>[ <a class="code" href="../../d8/d1/psp_8h.html#a7">PSP_MAX_LOAD_IMAGE_NOTIFY</a> ];
00215 
00216 
00217 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00218 <a class="code" href="../../d8/d1/psp_8h.html#a63">PspCreateThread</a>(
00219     OUT PHANDLE ThreadHandle,
00220     IN ACCESS_MASK DesiredAccess,
00221     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL,
00222     IN HANDLE ProcessHandle,
00223     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ProcessPointer,
00224     OUT PCLIENT_ID ClientId OPTIONAL,
00225     IN PCONTEXT ThreadContext OPTIONAL,
00226     IN PINITIAL_TEB InitialTeb OPTIONAL,
00227     IN BOOLEAN CreateSuspended,
00228     IN PKSTART_ROUTINE StartRoutine OPTIONAL,
00229     IN PVOID StartContext
00230     );
00231 
00232 <span class="comment">//</span>
00233 <span class="comment">// Startup Routines</span>
00234 <span class="comment">//</span>
00235 
00236 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00237 <a class="code" href="../../d8/d1/psp_8h.html#a64">PspUserThreadStartup</a>(
00238     IN PKSTART_ROUTINE StartRoutine,
00239     IN PVOID StartContext
00240     );
00241 
00242 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00243 <a class="code" href="../../d8/d1/psp_8h.html#a65">PspSystemThreadStartup</a>(
00244     IN PKSTART_ROUTINE StartRoutine,
00245     IN PVOID StartContext
00246     );
00247 
00248 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00249 <a class="code" href="../../d8/d1/psp_8h.html#a66">PspReaper</a>(
00250     IN PVOID StartContext
00251     );
00252 
00253 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00254 <a class="code" href="../../d8/d1/psp_8h.html#a67">PspNullSpecialApc</a>(
00255     IN <a class="code" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc,
00256     IN OUT PKNORMAL_ROUTINE *NormalRoutine,
00257     IN OUT PVOID *NormalContext,
00258     IN OUT PVOID *SystemArgument1,
00259     IN OUT PVOID *SystemArgument2
00260     );
00261 
00262 <span class="comment">//</span>
00263 <span class="comment">// Thread Exit Support</span>
00264 <span class="comment">//</span>
00265 
00266 DECLSPEC_NORETURN
00267 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00268 <a class="code" href="../../d8/d1/psp_8h.html#a68">PspExitThread</a>(
00269     IN NTSTATUS ExitStatus
00270     );
00271 
00272 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00273 <a class="code" href="../../d8/d1/psp_8h.html#a69">PspTerminateThreadByPointer</a>(
00274     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread,
00275     IN NTSTATUS ExitStatus
00276     );
00277 
00278 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00279 <a class="code" href="../../d8/d1/psp_8h.html#a70">PspExitSpecialApc</a>(
00280     IN <a class="code" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc,
00281     IN OUT PKNORMAL_ROUTINE *NormalRoutine,
00282     IN OUT PVOID *NormalContext,
00283     IN OUT PVOID *SystemArgument1,
00284     IN OUT PVOID *SystemArgument2
00285     );
00286 
00287 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00288 <a class="code" href="../../d8/d1/psp_8h.html#a71">PspExitProcess</a>(
00289     IN BOOLEAN TrimAddressSpace,
00290     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00291     );
00292 
00293 
00294 <span class="comment">//</span>
00295 <span class="comment">// Context Management</span>
00296 <span class="comment">//</span>
00297 
00298 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00299 <a class="code" href="../../d8/d1/psp_8h.html#a72">PspSetContext</a>(
00300     OUT PKTRAP_FRAME TrapFrame,
00301     OUT PKNONVOLATILE_CONTEXT_POINTERS NonVolatileContext,
00302     IN PCONTEXT Context,
00303     KPROCESSOR_MODE Mode
00304     );
00305 
00306 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00307 <a class="code" href="../../d8/d1/psp_8h.html#a73">PspGetContext</a>(
00308     IN PKTRAP_FRAME TrapFrame,
00309     IN PKNONVOLATILE_CONTEXT_POINTERS NonVolatileContext,
00310     IN OUT PCONTEXT Context
00311     );
00312 
00313 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00314 <a class="code" href="../../d8/d1/psp_8h.html#a74">PspGetSetContextSpecialApc</a>(
00315     IN <a class="code" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc,
00316     IN OUT PKNORMAL_ROUTINE *NormalRoutine,
00317     IN OUT PVOID *NormalContext,
00318     IN OUT PVOID *SystemArgument1,
00319     IN OUT PVOID *SystemArgument2
00320     );
00321 
00322 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00323 <a class="code" href="../../d8/d1/psp_8h.html#a75">PspExitNormalApc</a>(
00324     IN PVOID NormalContext,
00325     IN PVOID SystemArgument1,
00326     IN PVOID SystemArgument2
00327     );
00328 
00329 <span class="comment">//</span>
00330 <span class="comment">// private security routines</span>
00331 <span class="comment">//</span>
00332 
00333 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00334 <a class="code" href="../../d6/d5/ps_2security_8c.html#a10">PspInitializeProcessSecurity</a>(
00335     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Parent OPTIONAL,
00336     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Child
00337     );
00338 
00339 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00340 <a class="code" href="../../d6/d5/ps_2security_8c.html#a11">PspDeleteProcessSecurity</a>(
00341   IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00342   );
00343 
00344 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00345 <a class="code" href="../../d6/d5/ps_2security_8c.html#a13">PspInitializeThreadSecurity</a>(
00346     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00347     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread
00348     );
00349 
00350 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00351 <a class="code" href="../../d6/d5/ps_2security_8c.html#a14">PspDeleteThreadSecurity</a>(
00352     IN <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread
00353     );
00354 
00355 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00356 <a class="code" href="../../d6/d5/ps_2security_8c.html#a12">PspAssignPrimaryToken</a>(
00357     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00358     IN HANDLE Token OPTIONAL,
00359     IN PACCESS_TOKEN TokenPointer OPTIONAL
00360     );
00361 
00362 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00363 <a class="code" href="../../d9/d1/psquery_8c.html#a17">PspSetPrimaryToken</a>(
00364     IN HANDLE ProcessHandle,
00365     IN HANDLE TokenHandle OPTIONAL,
00366     IN PACCESS_TOKEN TokenPointer OPTIONAL
00367     );
00368 
00369 <span class="comment">//</span>
00370 <span class="comment">// Ldt support routines</span>
00371 <span class="comment">//</span>
00372 
00373 <span class="preprocessor">#if defined(i386)</span>
00374 <span class="preprocessor"></span><a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00375 <a class="code" href="../../d3/d1/i386_2psldt_8c.html#a9">PspLdtInitialize</a>(
00376     );
00377 <span class="preprocessor">#endif</span>
00378 <span class="preprocessor"></span>
00379 <span class="comment">//</span>
00380 <span class="comment">// Vdm support Routines</span>
00381 
00382 <span class="preprocessor">#if defined(i386)</span>
00383 <span class="preprocessor"></span><a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00384 <a class="code" href="../../d3/d2/i386_2psvdm_8c.html#a11">PspVdmInitialize</a>(
00385     );
00386 <span class="preprocessor">#endif</span>
00387 <span class="preprocessor"></span>
00388 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00389 <a class="code" href="../../d8/d1/psp_8h.html#a82">PspQueryLdtInformation</a>(
00390     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00391     OUT PVOID LdtInformation,
00392     IN ULONG LdtInformationLength,
00393     OUT PULONG ReturnLength
00394     );
00395 
00396 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00397 <a class="code" href="../../d8/d1/psp_8h.html#a83">PspSetLdtInformation</a>(
00398     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00399     IN PVOID LdtInformation,
00400     IN ULONG LdtInformationLength
00401     );
00402 
00403 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00404 <a class="code" href="../../d8/d1/psp_8h.html#a84">PspSetLdtSize</a>(
00405     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00406     IN PVOID LdtSize,
00407     IN ULONG LdtSizeLength
00408     );
00409 
00410 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00411 <a class="code" href="../../d8/d1/psp_8h.html#a85">PspDeleteLdt</a>(
00412     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00413     );
00414 
00415 <span class="comment">//</span>
00416 <span class="comment">// Io handling support routines</span>
00417 <span class="comment">//</span>
00418 
00419 
00420 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00421 <a class="code" href="../../d5/d5/vdmprint_8h.html#a15">PspSetProcessIoHandlers</a>(
00422     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00423     IN PVOID IoHandlerInformation,
00424     IN ULONG IoHandlerLength
00425     );
00426 
00427 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00428 <a class="code" href="../../d8/d1/psp_8h.html#a87">PspDeleteVdmObjects</a>(
00429     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00430     );
00431 
00432 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00433 <a class="code" href="../../d8/d1/psp_8h.html#a88">PspQueryDescriptorThread</a> (
00434     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread,
00435     PVOID ThreadInformation,
00436     ULONG ThreadInformationLength,
00437     PULONG ReturnLength
00438     );
00439 
00440 <span class="comment">//</span>
00441 <span class="comment">// Job Object Support Routines</span>
00442 <span class="comment">//</span>
00443 
00444 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00445 <a class="code" href="../../d8/d1/psp_8h.html#a89">PspJobDelete</a>(
00446     IN PVOID Object
00447     );
00448 
00449 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00450 <a class="code" href="../../d8/d1/psp_8h.html#a90">PspJobClose</a> (
00451     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00452     IN PVOID Object,
00453     IN ACCESS_MASK GrantedAccess,
00454     IN ULONG ProcessHandleCount,
00455     IN ULONG SystemHandleCount
00456     );
00457 
00458 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00459 <a class="code" href="../../d8/d1/psp_8h.html#a91">PspAddProcessToJob</a>(
00460     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00461     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00462     );
00463 
00464 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00465 <a class="code" href="../../d8/d1/psp_8h.html#a92">PspRemoveProcessFromJob</a>(
00466     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00467     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00468     );
00469 
00470 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00471 <a class="code" href="../../d8/d1/psp_8h.html#a93">PspExitProcessFromJob</a>(
00472     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00473     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00474     );
00475 
00476 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00477 <a class="code" href="../../d8/d1/psp_8h.html#a94">PspTerminateProcess</a>(
00478     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00479     NTSTATUS Status,
00480     PSLOCKPROCESSMODE LockMode
00481     );
00482 
00483 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00484 <a class="code" href="../../d8/d1/psp_8h.html#a95">PspApplyJobLimitsToProcessSet</a>(
00485     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job
00486     );
00487 
00488 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00489 <a class="code" href="../../d8/d1/psp_8h.html#a96">PspApplyJobLimitsToProcess</a>(
00490     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00491     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00492     );
00493 
00494 BOOLEAN
00495 <a class="code" href="../../d8/d1/psp_8h.html#a97">PspTerminateAllProcessesInJob</a>(
00496     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00497     NTSTATUS Status,
00498     PSLOCKPROCESSMODE LockMode
00499     );
00500 
00501 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00502 <a class="code" href="../../d8/d1/psp_8h.html#a98">PspFoldProcessAccountingIntoJob</a>(
00503     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job,
00504     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00505     );
00506 
00507 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00508 <a class="code" href="../../d8/d1/psp_8h.html#a99">PspCaptureTokenFilter</a>(
00509     KPROCESSOR_MODE PreviousMode,
00510     PJOBOBJECT_SECURITY_LIMIT_INFORMATION SecurityLimitInfo,
00511     <a class="code" href="../../d6/d1/struct__PS__JOB__TOKEN__FILTER.html">PPS_JOB_TOKEN_FILTER</a> * TokenFilter
00512     );
00513 
00514 <span class="comment">//</span>
00515 <span class="comment">//</span>
00516 <span class="comment">// Global Data</span>
00517 <span class="comment">//</span>
00518 
<a name="l00519"></a><a class="code" href="../../d8/d1/psp_8h.html#a27">00519</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> <a class="code" href="../../d6/d8/sysinfo_8c.html#a1">PspCidTable</a>;
<a name="l00520"></a><a class="code" href="../../d8/d1/psp_8h.html#a28">00520</a> <span class="keyword">extern</span> HANDLE <a class="code" href="../../d6/d3/modwrite_8c.html#a13">PspInitialSystemProcessHandle</a>;
<a name="l00521"></a><a class="code" href="../../d8/d1/psp_8h.html#a29">00521</a> <span class="keyword">extern</span> PACCESS_TOKEN <a class="code" href="../../d0/d1/psinit_8c.html#a14">PspBootAccessToken</a>;
<a name="l00522"></a><a class="code" href="../../d8/d1/psp_8h.html#a30">00522</a> <span class="keyword">extern</span> KSPIN_LOCK <a class="code" href="../../d4/d4/alpha_2splocks_8c.html#a17">PspEventPairLock</a>;
<a name="l00523"></a><a class="code" href="../../d8/d1/psp_8h.html#a31">00523</a> <span class="keyword">extern</span> <a class="code" href="../../d0/d8/struct__SYSTEM__DLL.html">SYSTEM_DLL</a> <a class="code" href="../../d0/d1/psinit_8c.html#a30">PspSystemDll</a>;
<a name="l00524"></a><a class="code" href="../../d8/d1/psp_8h.html#a32">00524</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d6/d8/sysinfo_8c.html#a25">PspActiveProcessMutex</a>;
<a name="l00525"></a><a class="code" href="../../d8/d1/psp_8h.html#a33">00525</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d2/d8/ps_2create_8c.html#a9">PspProcessLockMutex</a>;
00526 
<a name="l00527"></a><a class="code" href="../../d8/d1/psp_8h.html#a34">00527</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d0/cmdat3_8c.html#a41">PspDefaultPagedLimit</a>;
<a name="l00528"></a><a class="code" href="../../d8/d1/psp_8h.html#a35">00528</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d0/cmdat3_8c.html#a42">PspDefaultNonPagedLimit</a>;
<a name="l00529"></a><a class="code" href="../../d8/d1/psp_8h.html#a36">00529</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d0/cmdat3_8c.html#a43">PspDefaultPagefileLimit</a>;
00530 
<a name="l00531"></a><a class="code" href="../../d8/d1/psp_8h.html#a37">00531</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d4/struct__EPROCESS__QUOTA__BLOCK.html">EPROCESS_QUOTA_BLOCK</a> <a class="code" href="../../d6/d1/mmquota_8c.html#a11">PspDefaultQuotaBlock</a>;
<a name="l00532"></a><a class="code" href="../../d8/d1/psp_8h.html#a38">00532</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d0/d1/psinit_8c.html#a23">PspDoingGiveBacks</a>;
00533 
<a name="l00534"></a><a class="code" href="../../d8/d1/psp_8h.html#a39">00534</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d9/ps_8h.html#a74">PKWIN32_PROCESS_CALLOUT</a> <a class="code" href="../../d8/d1/psp_8h.html#a39">PspW32ProcessCallout</a>;
<a name="l00535"></a><a class="code" href="../../d8/d1/psp_8h.html#a40">00535</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d9/ps_8h.html#a80">PKWIN32_THREAD_CALLOUT</a> <a class="code" href="../../d8/d1/psp_8h.html#a40">PspW32ThreadCallout</a>;
<a name="l00536"></a><a class="code" href="../../d8/d1/psp_8h.html#a41">00536</a> <span class="keyword">extern</span> <a class="code" href="../../d1/d9/ps_8h.html#a78">PKWIN32_JOB_CALLOUT</a> <a class="code" href="../../d8/d1/psp_8h.html#a41">PspW32JobCallout</a>;
<a name="l00537"></a><a class="code" href="../../d8/d1/psp_8h.html#a42">00537</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d1/psp_8h.html#a42">PspW32ProcessSize</a>;
<a name="l00538"></a><a class="code" href="../../d8/d1/psp_8h.html#a43">00538</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d8/d1/psp_8h.html#a43">PspW32ThreadSize</a>;
<a name="l00539"></a><a class="code" href="../../d8/d1/psp_8h.html#a44">00539</a> <span class="keyword">extern</span> SCHAR <a class="code" href="../../d0/d1/psinit_8c.html#a21">PspForegroundQuantum</a>[3];
00540 
00541 
<a name="l00542"></a><a class="code" href="../../d8/d1/psp_8h.html#a8">00542</a> <span class="preprocessor">#define PSP_NUMBER_OF_SCHEDULING_CLASSES    10</span>
<a name="l00543"></a><a class="code" href="../../d8/d1/psp_8h.html#a9">00543</a> <span class="preprocessor"></span><span class="preprocessor">#define PSP_DEFAULT_SCHEDULING_CLASSES      5</span>
00544 <span class="preprocessor"></span>
<a name="l00545"></a><a class="code" href="../../d8/d1/psp_8h.html#a45">00545</a> <span class="keyword">extern</span> SCHAR <a class="code" href="../../d0/d1/psinit_8c.html#a38">PspJobSchedulingClasses</a>[<a class="code" href="../../d8/d1/psp_8h.html#a8">PSP_NUMBER_OF_SCHEDULING_CLASSES</a>];
<a name="l00546"></a><a class="code" href="../../d8/d1/psp_8h.html#a46">00546</a> <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d0/d1/psinit_8c.html#a37">PspUseJobSchedulingClasses</a>;
00547 
<a name="l00548"></a><a class="code" href="../../d8/d1/psp_8h.html#a47">00548</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a> <a class="code" href="../../d0/d1/psinit_8c.html#a25">PspJobListLock</a>;
<a name="l00549"></a><a class="code" href="../../d8/d1/psp_8h.html#a48">00549</a> <span class="keyword">extern</span> LIST_ENTRY <a class="code" href="../../d0/d1/psinit_8c.html#a26">PspJobList</a>;
00550 
00551 <span class="preprocessor">#endif // _PSP_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:33 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
