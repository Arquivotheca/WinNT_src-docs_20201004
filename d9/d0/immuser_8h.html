<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: immuser.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>immuser.h File Reference</h1><code>#include &lt;imm.h&gt;</code><br>
<code>#include &lt;immp.h&gt;</code><br>
<code>#include &lt;ime.h&gt;</code><br>
<code>#include &lt;imep.h&gt;</code><br>

<p>
<a href="../../d0/d0/immuser_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d0/structtagCLIENTIMC.html">tagCLIENTIMC</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d7/structtagIMEDPI.html">tagIMEDPI</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d7/structtagIMEDPI_1_1__tagImeFunctions.html">tagIMEDPI::_tagImeFunctions</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">tagIMEPRIVATESAVER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">tagIMEMODESAVER</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a0">InitImcCrit</a>(pClientImc)&nbsp;&nbsp;&nbsp;RtlInitializeCriticalSection(&amp;pClientImc-&gt;cs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a1">DeleteImcCrit</a>(pClientImc)&nbsp;&nbsp;&nbsp;RtlDeleteCriticalSection(&amp;pClientImc-&gt;cs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a2">EnterImcCrit</a>(pClientImc)&nbsp;&nbsp;&nbsp;RtlEnterCriticalSection(&amp;pClientImc-&gt;cs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a3">LeaveImcCrit</a>(pClientImc)&nbsp;&nbsp;&nbsp;RtlLeaveCriticalSection(&amp;pClientImc-&gt;cs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a4">IMEDPI_UNLOADED</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a5">IMEDPI_UNLOCKUNLOAD</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">tagCLIENTIMC</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a6">CLIENTIMC</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">tagCLIENTIMC</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a7">PCLIENTIMC</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a8">PFNINQUIREA</a> )(LPIMEINFO, LPSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a9">PFNINQUIREW</a> )(LPIMEINFO, LPWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a10">PFNCONVLISTA</a> )(HIMC, LPCSTR, LPCANDIDATELIST, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, UINT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a11">PFNCONVLISTW</a> )(HIMC, LPCWSTR, LPCANDIDATELIST, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, UINT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a12">PFNREGWORDA</a> )(LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a13">PFNREGWORDW</a> )(LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a14">PFNUNREGWORDA</a> )(LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a15">PFNUNREGWORDW</a> )(LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef UINT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a16">PFNGETREGWORDSTYA</a> )(UINT, LPSTYLEBUFA)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef UINT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a17">PFNGETREGWORDSTYW</a> )(UINT, LPSTYLEBUFW)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef UINT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a18">PFNENUMREGWORDA</a> )(REGISTERWORDENUMPROCA, LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef UINT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a19">PFNENUMREGWORDW</a> )(REGISTERWORDENUMPROCW, LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a20">PFNCONFIGURE</a> )(HKL, HWND, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a21">PFNDESTROY</a> )(UINT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LRESULT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a22">PFNESCAPE</a> )(HIMC, UINT, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a23">PFNPROCESSKEY</a> )(HIMC, UINT, LPARAM, CONST LPBYTE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a24">PFNSELECT</a> )(HIMC, BOOL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a25">PFNSETACTIVEC</a> )(HIMC, BOOL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef UINT(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a26">PFNTOASCEX</a> )(UINT, UINT, CONST LPBYTE, PTRANSMSGLIST, UINT, HIMC)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a27">PFNNOTIFY</a> )(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOL(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a28">PFNSETCOMPSTR</a> )(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCVOID, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCVOID, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a29">PFNGETIMEMENUITEMS</a> )(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d7/structtagIMEDPI.html">tagIMEDPI</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a30">IMEDPI</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d7/structtagIMEDPI.html">tagIMEDPI</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a31">PIMEDPI</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">tagIMEPRIVATESAVER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a32">IMEPRIVATEMODESAVER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">tagIMEPRIVATESAVER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a33">PIMEPRIVATEMODESAVER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">tagIMEMODESAVER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a34">IMEMODESAVER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">tagIMEMODESAVER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a35">PIMEMODESAVER</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a36">ImmSetActiveContext</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, HIMC hImc, BOOL fActivate)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a37">ImmLoadIME</a> (HKL hKL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a38">ImmUnloadIME</a> (HKL hKL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a39">ImmFreeLayout</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a40">ImmActivateLayout</a> (HKL hSelKL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a41">ImmLoadLayout</a> (HKL hKL, <a class="el" href="../../d0/d8/structtagIMEINFOEX.html">PIMEINFOEX</a> piiex)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a42">ImmDisableIme</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwThreadId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a43">ImmLockClientImc</a> (HIMC hImc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a44">ImmUnlockClientImc</a> (<a class="el" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a> pClientImc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a45">ImmLockImeDpi</a> (HKL hKL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a46">ImmUnlockImeDpi</a> (<a class="el" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a47">ImmGetImeInfoEx</a> (<a class="el" href="../../d0/d8/structtagIMEINFOEX.html">PIMEINFOEX</a> piiex, <a class="el" href="../../d8/d0/immstruc_8h.html#a42">IMEINFOEXCLASS</a> SearchType, PVOID pvSearchKey)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a48">ImmProcessKey</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, HKL hkl, UINT uVKey, LPARAM lParam, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwHotKeyID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a49">ImmTranslateMessage</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d0/immuser_8h.html#a50">ImmInitializeHotKeys</a> (BOOL bUserLoggedOn)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="immuser.h::DeleteImcCrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DeleteImcCrit          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pClientImc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlDeleteCriticalSection(&amp;pClientImc-&gt;cs)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00033">33</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00747">ImmUnlockClientImc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="immuser.h::EnterImcCrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EnterImcCrit          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pClientImc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlEnterCriticalSection(&amp;pClientImc-&gt;cs)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00034">34</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00303">InternalImmLockIMC()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="immuser.h::IMEDPI_UNLOADED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IMEDPI_UNLOADED&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00063">63</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">ImmLockImeDpi()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00365">ImmUnloadIME()</a>, and <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="immuser.h::IMEDPI_UNLOCKUNLOAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IMEDPI_UNLOCKUNLOAD&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00064">64</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>, and <a class="el" href="../../d7/d9/immime_8c-source.html#l00234">LoadImeDpi()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="immuser.h::InitImcCrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define InitImcCrit          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pClientImc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlInitializeCriticalSection(&amp;pClientImc-&gt;cs)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00032">32</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00026">ImmCreateContext()</a>, and <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00689">ImmLockClientImc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="immuser.h::LeaveImcCrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LeaveImcCrit          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pClientImc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;RtlLeaveCriticalSection(&amp;pClientImc-&gt;cs)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00035">35</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00303">InternalImmLockIMC()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a6" doxytag="immuser.h::CLIENTIMC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">tagCLIENTIMC</a>  <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">CLIENTIMC</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00026">ImmCreateContext()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="immuser.h::IMEDPI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d7/structtagIMEDPI.html">tagIMEDPI</a>  <a class="el" href="../../d2/d7/structtagIMEDPI.html">IMEDPI</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="immuser.h::IMEMODESAVER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">tagIMEMODESAVER</a>  <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">IMEMODESAVER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="immuser.h::IMEPRIVATEMODESAVER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">tagIMEPRIVATESAVER</a>  <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">IMEPRIVATEMODESAVER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="immuser.h::PCLIENTIMC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">tagCLIENTIMC</a> * <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00484">ImmEnableIME()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="immuser.h::PFNCONFIGURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a20">PFNCONFIGURE</a>)(HKL, HWND, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00052">52</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="immuser.h::PFNCONVLISTA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a10">PFNCONVLISTA</a>)(HIMC, LPCSTR, LPCANDIDATELIST, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, UINT)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00042">42</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="immuser.h::PFNCONVLISTW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a11">PFNCONVLISTW</a>)(HIMC, LPCWSTR, LPCANDIDATELIST, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, UINT)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00043">43</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="immuser.h::PFNDESTROY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a21">PFNDESTROY</a>)(UINT)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00053">53</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="immuser.h::PFNENUMREGWORDA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef UINT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a18">PFNENUMREGWORDA</a>)(REGISTERWORDENUMPROCA, LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00050">50</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="immuser.h::PFNENUMREGWORDW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef UINT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a19">PFNENUMREGWORDW</a>)(REGISTERWORDENUMPROCW, LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00051">51</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="immuser.h::PFNESCAPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LRESULT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a22">PFNESCAPE</a>)(HIMC, UINT, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00054">54</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="immuser.h::PFNGETIMEMENUITEMS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a29">PFNGETIMEMENUITEMS</a>)(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00061">61</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="immuser.h::PFNGETREGWORDSTYA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef UINT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a16">PFNGETREGWORDSTYA</a>)(UINT, LPSTYLEBUFA)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00048">48</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="immuser.h::PFNGETREGWORDSTYW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef UINT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a17">PFNGETREGWORDSTYW</a>)(UINT, LPSTYLEBUFW)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00049">49</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="immuser.h::PFNINQUIREA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a8">PFNINQUIREA</a>)(LPIMEINFO, LPSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00040">40</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="immuser.h::PFNINQUIREW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a9">PFNINQUIREW</a>)(LPIMEINFO, LPWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00041">41</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="immuser.h::PFNNOTIFY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a27">PFNNOTIFY</a>)(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00059">59</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="immuser.h::PFNPROCESSKEY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a23">PFNPROCESSKEY</a>)(HIMC, UINT, LPARAM, CONST LPBYTE)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00055">55</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="immuser.h::PFNREGWORDA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a12">PFNREGWORDA</a>)(LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00044">44</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="immuser.h::PFNREGWORDW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a13">PFNREGWORDW</a>)(LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00045">45</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="immuser.h::PFNSELECT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a24">PFNSELECT</a>)(HIMC, BOOL)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00056">56</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="immuser.h::PFNSETACTIVEC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a25">PFNSETACTIVEC</a>)(HIMC, BOOL)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00057">57</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="immuser.h::PFNSETCOMPSTR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a28">PFNSETCOMPSTR</a>)(HIMC, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCVOID, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCVOID, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00060">60</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="immuser.h::PFNTOASCEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef UINT(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a26">PFNTOASCEX</a>)(UINT, UINT, CONST LPBYTE, PTRANSMSGLIST, UINT, HIMC)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00058">58</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="immuser.h::PFNUNREGWORDA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a14">PFNUNREGWORDA</a>)(LPCSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCSTR)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00046">46</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="immuser.h::PFNUNREGWORDW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOL(CALLBACK* <a class="el" href="../../d9/d0/immuser_8h.html#a15">PFNUNREGWORDW</a>)(LPCWSTR, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, LPCWSTR)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/immuser_8h-source.html#l00047">47</a> of file <a class="el" href="../../d0/d0/immuser_8h-source.html">immuser.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="immuser.h::PIMEDPI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d7/structtagIMEDPI.html">tagIMEDPI</a> * <a class="el" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d4/ntuser_2imm_2conime_8c-source.html#l00034">ImmCallImeConsoleIME()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="immuser.h::PIMEMODESAVER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">tagIMEMODESAVER</a> * <a class="el" href="../../d2/d8/structtagIMEMODESAVER.html">PIMEMODESAVER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00436">GetImeModeSaver()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="immuser.h::PIMEPRIVATEMODESAVER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">tagIMEPRIVATESAVER</a> * <a class="el" href="../../d3/d8/structtagIMEPRIVATESAVER.html">PIMEPRIVATEMODESAVER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00464">DestroyImeModeSaver()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a40" doxytag="immuser.h::ImmActivateLayout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmActivateLayout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HKL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hSelKL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/immime_8c-source.html#l00495">495</a> of file <a class="el" href="../../d7/d9/immime_8c-source.html">immime.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00508">_CLIENTINFO::CI_flags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00570">CI_INPUTCONTEXT_REINIT</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04502">GetKeyboardLayout()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00016">tagSELECTCONTEXT_ENUM::hSelKL</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00017">tagSELECTCONTEXT_ENUM::hUnSelKL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00070">tagIMEDPI::ImeInfo</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l01211">ImmEnumInputContext()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00027">ImmGetDefaultIMEWnd()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00346">ImmLoadIME()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">ImmLockImeDpi()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00021">NotifyIMEProc()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13037">NtUserSetThreadLayoutHandles()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00031">SelectContextProc()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>.
<p>
<pre class="fragment"><div>00497 {
00498     HKL     hUnSelKL;
00499     HWND    hWndDefaultIme;
00500     <a class="code" href="../../d9/d5/structtagSELECTCONTEXT__ENUM.html">SCE</a>     sce;
00501     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwCPS;
00502     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi;
00503     BOOLEAN fOptimizeActivation = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00504 
00505     hUnSelKL = <a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0);
00506 
00507     {
00508         <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pClientInfo = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>();
00509 
00510         <span class="keywordflow">if</span> (pClientInfo-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o0">CI_flags</a> &amp; <a class="code" href="../../d1/d0/inc_2user_8h.html#a105">CI_INPUTCONTEXT_REINIT</a>) {
00511             fOptimizeActivation = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00512         }
00513     }
00514 
00515     <span class="comment">/*</span>
00516 <span class="comment">     * if already current active, do nothing</span>
00517 <span class="comment">     */</span>
00518     <span class="keywordflow">if</span> (hUnSelKL == hSelKL &amp;&amp; fOptimizeActivation)
00519         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00520 
00521     <a class="code" href="../../d9/d0/immuser_8h.html#a37">ImmLoadIME</a>(hSelKL);
00522 
00523     <span class="keywordflow">if</span> (hUnSelKL != hSelKL) {
00524         pImeDpi = <a class="code" href="../../d9/d0/immuser_8h.html#a45">ImmLockImeDpi</a>(hUnSelKL);
00525         <span class="keywordflow">if</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00526             <span class="comment">/*</span>
00527 <span class="comment">             * Send out CPS_CANCEL or CPS_COMPLETE to every input</span>
00528 <span class="comment">             * context assoicated to window(s) created by this thread.</span>
00529 <span class="comment">             * Starting from SUR, we only assoicate input context to window created</span>
00530 <span class="comment">             * by the same thread.</span>
00531 <span class="comment">             */</span>
00532             dwCPS = (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_COMPLETE_ON_UNSELECT) ? CPS_COMPLETE : CPS_CANCEL;
00533             <a class="code" href="../../d9/d0/immuser_8h.html#a46">ImmUnlockImeDpi</a>(pImeDpi);
00534             <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a19">ImmEnumInputContext</a>(0, NotifyIMEProc, dwCPS);
00535         }
00536 
00537         hWndDefaultIme = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a4">ImmGetDefaultIMEWnd</a>(NULL);
00538 
00539         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hWndDefaultIme))
00540             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWndDefaultIme, WM_IME_SELECT, FALSE, (LPARAM)hUnSelKL);
00541 
00542         <span class="comment">/*</span>
00543 <span class="comment">         * This is the time to update the kernel side layout handles.</span>
00544 <span class="comment">         * We must do this before sending WM_IME_SELECT.</span>
00545 <span class="comment">         */</span>
00546         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a399">NtUserSetThreadLayoutHandles</a>(hSelKL, hUnSelKL);
00547     }
00548 
00549     <span class="comment">/*</span>
00550 <span class="comment">     * Unselect and select input context(s).</span>
00551 <span class="comment">     */</span>
00552     sce.<a class="code" href="../../d9/d5/structtagSELECTCONTEXT__ENUM.html#o0">hSelKL</a>   = hSelKL;
00553     sce.<a class="code" href="../../d9/d5/structtagSELECTCONTEXT__ENUM.html#o1">hUnSelKL</a> = hUnSelKL;
00554     <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a19">ImmEnumInputContext</a>(0, (IMCENUMPROC)SelectContextProc, (LPARAM)&amp;sce);
00555 
00556     <span class="comment">/*</span>
00557 <span class="comment">     * inform UI select after all hIMC select</span>
00558 <span class="comment">     */</span>
00559     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hWndDefaultIme))
00560         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWndDefaultIme, WM_IME_SELECT, TRUE, (LPARAM)hSelKL);
00561 
00562     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00563 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="immuser.h::ImmDisableIme" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmDisableIme           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwThreadId</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="immuser.h::ImmFreeLayout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmFreeLayout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwFlag</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/immime_8c-source.html#l00416">416</a> of file <a class="el" href="../../d7/d9/immime_8c-source.html">immime.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04502">GetKeyboardLayout()</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00033">gpImeDpi</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00069">tagIMEDPI::hKL</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00052">IFL_DEACTIVATEIME</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00053">IFL_UNLOADIME</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00557">ImmLocalAlloc()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00365">ImmUnloadIME()</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00149">IS_IME_KBDLAYOUT</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04463">LoadKeyboardLayoutW()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00067">tagIMEDPI::pNext</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>.
<p>
<pre class="fragment"><div>00418 {
00419     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi;
00420     HKL   *phklRoot, hklCurrent;
00421     WCHAR  pwszNonImeKLID[KL_NAMELENGTH];
00422     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>   nLayouts, uNonImeKLID = 0, i;
00423 
00424     hklCurrent = <a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0);
00425 
00426     <span class="keywordflow">switch</span> (dwFlag) {
00427 
00428     <span class="keywordflow">case</span> <a class="code" href="../../d8/d0/immstruc_8h.html#a15">IFL_DEACTIVATEIME</a>:
00429         <span class="comment">/*</span>
00430 <span class="comment">         * Do nothing if no IME to be deactivated.</span>
00431 <span class="comment">         */</span>
00432         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d5/conimep_8h.html#a49">IS_IME_KBDLAYOUT</a>(hklCurrent))
00433             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00434 
00435         <span class="comment">/*</span>
00436 <span class="comment">         * Deactivate IME based layout by activating a non-IME based</span>
00437 <span class="comment">         * keyboard layout.</span>
00438 <span class="comment">         */</span>
00439         uNonImeKLID = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)LANGIDFROMLCID(GetSystemDefaultLCID());
00440 
00441         nLayouts = GetKeyboardLayoutList(0, NULL);
00442 
00443         <span class="keywordflow">if</span> (nLayouts != 0) {
00444             phklRoot = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a22">ImmLocalAlloc</a>(0, nLayouts * <span class="keyword">sizeof</span>(HKL));
00445             <span class="keywordflow">if</span> (phklRoot == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00446                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00447 
00448             nLayouts = GetKeyboardLayoutList(nLayouts, phklRoot);
00449 
00450             <span class="keywordflow">for</span> (i = 0; i &lt; nLayouts &amp;&amp; <a class="code" href="../../d4/d5/conimep_8h.html#a49">IS_IME_KBDLAYOUT</a>(phklRoot[i]); i++) ;
00451 
00452             <span class="keywordflow">if</span> (i &lt; nLayouts)
00453                 uNonImeKLID = HandleToUlong(phklRoot[i]) &amp; 0xffff;
00454 
00455             <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(phklRoot);
00456         }
00457 
00458         wsprintf(pwszNonImeKLID, L<span class="stringliteral">"%08x"</span>, uNonImeKLID);
00459 
00460         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/client_8c.html#a151">LoadKeyboardLayoutW</a>(pwszNonImeKLID, KLF_ACTIVATE) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00461             RIPMSG1(RIP_WARNING, <span class="stringliteral">"ImmFreeLayout: LoadKeyboardLayoutW(%S, KLF_ACTIVATE) failed. Trying 00000409"</span>, pwszNonImeKLID);
00462             <span class="comment">// Somehow it failed (probably a bad setup), let's try</span>
00463             <span class="comment">// 409 KL, which should be installed on all localized NTs.</span>
00464             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/client_8c.html#a151">LoadKeyboardLayoutW</a>(L<span class="stringliteral">"00000409"</span>, KLF_ACTIVATE | KLF_FAILSAFE) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00465                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadKeyboardLayoutW(00000409) failed either. will try NULL."</span>);
00466             }
00467         }
00468 
00469         <span class="keywordflow">break</span>;
00470 
00471     <span class="keywordflow">case</span> <a class="code" href="../../d8/d0/immstruc_8h.html#a16">IFL_UNLOADIME</a>:
00472         RtlEnterCriticalSection(&amp;gcsImeDpi);
00473 UnloadImeDpiLoop:
00474         <span class="keywordflow">for</span> (pImeDpi = <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a>; pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pImeDpi = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>) {
00475             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d0/immuser_8h.html#a38">ImmUnloadIME</a>(pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o2">hKL</a>))
00476                 <span class="keywordflow">goto</span> UnloadImeDpiLoop;        <span class="comment">// Rescan as list was updated.</span>
00477         }
00478         RtlLeaveCriticalSection(&amp;gcsImeDpi);
00479         <span class="keywordflow">break</span>;
00480 
00481     <span class="keywordflow">default</span>:
00482         {
00483             HKL hklFlag = (HKL)LongToHandle( dwFlag );
00484             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d5/conimep_8h.html#a49">IS_IME_KBDLAYOUT</a>(hklFlag) &amp;&amp; hklFlag != hklCurrent) {
00485                 <a class="code" href="../../d9/d0/immuser_8h.html#a38">ImmUnloadIME</a>(hklFlag);
00486             }
00487         }
00488         <span class="keywordflow">break</span>;
00489     }
00490 
00491     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00492 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="immuser.h::ImmGetImeInfoEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmGetImeInfoEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d8/structtagIMEINFOEX.html">PIMEINFOEX</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>piiex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d0/immstruc_8h.html#a42">IMEINFOEXCLASS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SearchType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pvSearchKey</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00876">876</a> of file <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html">w32/ntuser/imm/misc.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00100">tagIMEINFOEX::hkl</a>, <a class="el" href="../../d8/d0/immstruc_8h.html#a75a54">ImeInfoExImeFileName</a>, <a class="el" href="../../d8/d0/immstruc_8h.html#a75a52">ImeInfoExKeyboardLayout</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00059">ImmAssert</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00149">IS_IME_KBDLAYOUT</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12769">NtUserGetImeInfoEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00109">tagIMEINFOEX::wszImeFile</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00087">ImmGetDescriptionA()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00046">ImmGetDescriptionW()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00165">ImmGetIMEFileNameA()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00124">ImmGetIMEFileNameW()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00202">ImmGetProperty()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00250">ImmIMPQueryIMEW()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00374">ImmIMPSetIMEW()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00266">ImmInstallIMEW()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00468">ImmIsIME()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00230">IMPGetIMEWorker()</a>, and <a class="el" href="../../d7/d9/immime_8c-source.html#l00234">LoadImeDpi()</a>.
<p>
<pre class="fragment"><div>00880 {
00881     <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>(piiex != NULL &amp;&amp; pvSearchKey != NULL);
00882 
00883     <span class="keywordflow">switch</span> (SearchType) {
00884     <span class="keywordflow">case</span> <a class="code" href="../../d8/d0/immstruc_8h.html#a75a52">ImeInfoExKeyboardLayout</a>:
00885         piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o0">hkl</a> = *((HKL *)pvSearchKey);
00886         <span class="comment">/*</span>
00887 <span class="comment">         * Quick return for non-IME based keyboard layout</span>
00888 <span class="comment">         */</span>
00889         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d5/conimep_8h.html#a49">IS_IME_KBDLAYOUT</a>(piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o0">hkl</a>))
00890             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00891         <span class="keywordflow">break</span>;
00892 
00893     <span class="keywordflow">case</span> <a class="code" href="../../d8/d0/immstruc_8h.html#a75a54">ImeInfoExImeFileName</a>:
00894         wcscpy(piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o9">wszImeFile</a>, (PWSTR)pvSearchKey);
00895         <span class="keywordflow">break</span>;
00896 
00897     <span class="keywordflow">default</span>:
00898         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00899     }
00900 
00901     <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a391">NtUserGetImeInfoEx</a>(piiex, SearchType);
00902 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="immuser.h::ImmInitializeHotKeys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ImmInitializeHotKeys           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bUserLoggedOn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="immuser.h::ImmLoadIME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmLoadIME           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HKL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hKL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/immime_8c-source.html#l00346">346</a> of file <a class="el" href="../../d7/d9/immime_8c-source.html">immime.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00769">ImmGetImeDpi()</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00149">IS_IME_KBDLAYOUT</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00234">LoadImeDpi()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>, and <a class="el" href="../../d7/d9/immime_8c-source.html#l00495">ImmActivateLayout()</a>.
<p>
<pre class="fragment"><div>00348 {
00349     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi;
00350 
00351     <span class="comment">/*</span>
00352 <span class="comment">     * Non IME based keyboard layout doesn't have IMEDPI.</span>
00353 <span class="comment">     */</span>
00354     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d5/conimep_8h.html#a49">IS_IME_KBDLAYOUT</a>(hKL))
00355         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00356 
00357     pImeDpi = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a30">ImmGetImeDpi</a>(hKL);
00358     <span class="keywordflow">if</span> (pImeDpi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00359         pImeDpi = <a class="code" href="../../d6/d0/immime_8c.html#a10">LoadImeDpi</a>(hKL, FALSE);
00360 
00361     <span class="keywordflow">return</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00362 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="immuser.h::ImmLoadLayout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmLoadLayout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HKL&nbsp;</td>
          <td class="mdname" nowrap> <em>hKL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d8/structtagIMEINFOEX.html">PIMEINFOEX</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>piiex</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/layime_8c-source.html#l00038">38</a> of file <a class="el" href="../../d4/d0/layime_8c-source.html">layime.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00105">tagIMEINFOEX::fLoadFlag</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00045">gszRegKbdLayout</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00051">gszValImeFile</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00100">tagIMEINFOEX::hkl</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00065">IM_FILE_SIZE</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00060">IMEF_NONLOAD</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d0/layime_8c-source.html#l00305">LoadVersionInfo()</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00433">RtlIntegerToUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00109">tagIMEINFOEX::wszImeFile</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>.
<p>
<pre class="fragment"><div>00041 {
00042     UNICODE_STRING strIme;
00043     WCHAR    wszIme[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
00044     HKEY     hKeyKbdLayout, hKeyIme;
00045     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00046     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>    dwTmp;
00047     LONG     lRet;
00048 
00049     strIme.Buffer = wszIme;
00050     strIme.MaximumLength = <span class="keyword">sizeof</span>(wszIme);
00051 
00052     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/cnvint_8c.html#a6">RtlIntegerToUnicodeString</a>(HandleToUlong(hKL), 16, &amp;strIme);
00053     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00054         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00055     }
00056 
00057     lRet = RegOpenKey(HKEY_LOCAL_MACHINE, gszRegKbdLayout, &amp;hKeyKbdLayout);
00058     <span class="keywordflow">if</span> ( lRet != ERROR_SUCCESS ) {
00059         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00060     }
00061 
00062     lRet = RegOpenKey(hKeyKbdLayout, strIme.Buffer, &amp;hKeyIme);
00063     <span class="keywordflow">if</span> ( lRet != ERROR_SUCCESS ) {
00064         RegCloseKey(hKeyKbdLayout);
00065         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00066     }
00067 
00068     dwTmp = <a class="code" href="../../d8/d0/immstruc_8h.html#a22">IM_FILE_SIZE</a>;
00069     lRet = RegQueryValueEx(hKeyIme,
00070                            gszValImeFile,
00071                            NULL,
00072                            NULL,
00073                            (LPBYTE)piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o9">wszImeFile</a>,
00074                            &amp;dwTmp);
00075 
00076     <span class="keywordflow">if</span> ( lRet != ERROR_SUCCESS ) {
00077         RegCloseKey(hKeyIme);
00078         RegCloseKey(hKeyKbdLayout);
00079         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00080     }
00081 
00082     piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o9">wszImeFile</a>[<a class="code" href="../../d8/d0/immstruc_8h.html#a22">IM_FILE_SIZE</a> - 1] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00083 
00084     RegCloseKey(hKeyIme);
00085     RegCloseKey(hKeyKbdLayout);
00086 
00087     piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o0">hkl</a> = hKL;
00088     piiex-&gt;<a class="code" href="../../d0/d8/structtagIMEINFOEX.html#o5">fLoadFlag</a> = <a class="code" href="../../d8/d0/immstruc_8h.html#a18">IMEF_NONLOAD</a>;
00089 
00090     <span class="keywordflow">return</span> <a class="code" href="../../d3/d1/layime_8c.html#a22">LoadVersionInfo</a>(piiex);
00091 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="immuser.h::ImmLockClientImc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a> WINAPI ImmLockClientImc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HIMC&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hImc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00689">689</a> of file <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html">w32/ntuser/imm/misc.c</a>.
<p>
References <a class="el" href="../../d0/d0/immuser_8h-source.html#l00025">tagCLIENTIMC::cLockObj</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02065">tagIMC::dwClientImcData</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00027">tagCLIENTIMC::dwImeCompatFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00150">HMValidateHandle()</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00041">IMCF_DEFAULTIMC</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00039">IMCF_INDESTROY</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00557">ImmLocalAlloc()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00032">InitImcCrit</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07799">NtUserGetThreadState()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12654">NtUserUpdateInputContext()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00025">NULL_HIMC</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00162">SetICF</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00166">TestICF</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00598">TestInputContextProcess()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00922">TYPE_INPUTCONTEXT</a>, and <a class="el" href="../../d8/d0/immstruc_8h.html#a73a46">UpdateClientInputContext</a>.
<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00563">CreateInputContext()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00484">ImmEnableIME()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00171">ImmGenerateMessage()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00912">ImmGetAppCompatFlags()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00879">ImmGetCandidateListCountWorker()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01014">ImmGetCandidateListWorker()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01583">ImmGetCompositionFontA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01643">ImmGetCompositionFontW()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00036">ImmGetCompositionStringA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00099">ImmGetCompositionStringW()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01173">ImmGetGuideLineWorker()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00412">ImmGetIMCLockCount()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00225">ImmGetSaveContext()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00408">ImmPostMessages()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l03349">ImmRequestMessageWorker()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00309">ImmSetActiveContext()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01694">ImmSetCompositionFontA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01764">ImmSetCompositionFontW()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00383">ImmUnlockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00303">InternalImmLockIMC()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00456">IsAnsiIMC()</a>, <a class="el" href="../../d3/d4/transsub_8c-source.html#l01328">MySetCompFont()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00837">SelectInputContext()</a>, and <a class="el" href="../../d3/d4/transsub_8c-source.html#l01222">SetFontForMCWVERTICAL()</a>.
<p>
<pre class="fragment"><div>00691 {
00692     <a class="code" href="../../d1/d7/structtagIMC.html">PIMC</a>       pImc;
00693     <a class="code" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a> pClientImc;
00694 
00695     <span class="keywordflow">if</span> (hImc == <a class="code" href="../../d8/d0/immstruc_8h.html#a0">NULL_HIMC</a>)
00696         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00697 
00698     pImc = <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a6">HMValidateHandle</a>((HANDLE)hImc, TYPE_INPUTCONTEXT);
00699 
00700     <span class="comment">/*</span>
00701 <span class="comment">     * Cannot access input context from other process.</span>
00702 <span class="comment">     */</span>
00703     <span class="keywordflow">if</span> (pImc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || !<a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a24">TestInputContextProcess</a>(pImc))
00704         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00705 
00706     pClientImc = (<a class="code" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a>)pImc-&gt;<a class="code" href="../../d1/d7/structtagIMC.html#o2">dwClientImcData</a>;
00707 
00708     <span class="keywordflow">if</span> (pClientImc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00709         <span class="comment">/*</span>
00710 <span class="comment">         * We delay the creation of client side per-thread default Imc.</span>
00711 <span class="comment">         * Now, this is the time to create it.</span>
00712 <span class="comment">         */</span>
00713         pClientImc = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a22">ImmLocalAlloc</a>(HEAP_ZERO_MEMORY, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d0/structtagCLIENTIMC.html">CLIENTIMC</a>));
00714         <span class="keywordflow">if</span> (pClientImc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00715             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00716 
00717         <a class="code" href="../../d9/d0/immuser_8h.html#a0">InitImcCrit</a>(pClientImc);
00718         pClientImc-&gt;<a class="code" href="../../d3/d0/structtagCLIENTIMC.html#o3">dwImeCompatFlags</a> = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a287">NtUserGetThreadState</a>(UserThreadStateImeCompatFlags);
00719 
00720         <span class="comment">/*</span>
00721 <span class="comment">         * Update the kernel side input context.</span>
00722 <span class="comment">         */</span>
00723         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a388">NtUserUpdateInputContext</a>(hImc,
00724                 UpdateClientInputContext, (ULONG_PTR)pClientImc)) {
00725             <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pClientImc);
00726             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00727         }
00728 
00729         <span class="comment">/*</span>
00730 <span class="comment">         * Marks with default input context signature.</span>
00731 <span class="comment">         */</span>
00732         <a class="code" href="../../d4/d0/immcli_8h.html#a19">SetICF</a>(pClientImc, IMCF_DEFAULTIMC);
00733     }
00734     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/immcli_8h.html#a21">TestICF</a>(pClientImc, IMCF_INDESTROY)) {
00735         <span class="comment">/*</span>
00736 <span class="comment">         * Cannot access destroyed input context.</span>
00737 <span class="comment">         */</span>
00738         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00739     }
00740 
00741     InterlockedIncrement(&amp;pClientImc-&gt;<a class="code" href="../../d3/d0/structtagCLIENTIMC.html#o1">cLockObj</a>);
00742 
00743     <span class="keywordflow">return</span> pClientImc;
00744 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="immuser.h::ImmLockImeDpi" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> WINAPI ImmLockImeDpi           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HKL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hKL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">793</a> of file <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html">w32/ntuser/imm/misc.c</a>.
<p>
References <a class="el" href="../../d0/d0/immuser_8h-source.html#l00073">tagIMEDPI::cLock</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00074">tagIMEDPI::dwFlag</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00033">gpImeDpi</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00069">tagIMEDPI::hKL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00063">IMEDPI_UNLOADED</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d0/immuser_8h-source.html#l00067">tagIMEDPI::pNext</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00563">CreateInputContext()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00718">DestroyInputContext()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00327">FindOrLoadImeDpi()</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00087">HotKeyIDDispatcher()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00495">ImmActivateLayout()</a>, <a class="el" href="../../d2/d4/ntuser_2imm_2conime_8c-source.html#l00034">ImmCallImeConsoleIME()</a>, <a class="el" href="../../d7/d8/softkbd_8c-source.html#l00137">ImmCreateSoftKeyboard()</a>, <a class="el" href="../../d3/d9/imemenu_8c-source.html#l00759">ImmGetImeMenuItemsWorker()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l01294">ImmNotifyIME()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00030">ImmProcessKey()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00309">ImmSetActiveContext()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00610">ImmSetCompositionStringWorker()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00196">ImmTranslateMessage()</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00155">JCloseOpen()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l03158">MakeIMENotify()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00837">SelectInputContext()</a>, and <a class="el" href="../../d3/d4/transsub_8c-source.html#l01042">TransHanjaMode()</a>.
<p>
<pre class="fragment"><div>00795 {
00796     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi;
00797 
00798     RtlEnterCriticalSection(&amp;gcsImeDpi);
00799 
00800     pImeDpi = <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a>;
00801 
00802     <span class="keywordflow">while</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o2">hKL</a> != hKL)
00803         pImeDpi = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00804 
00805     <span class="keywordflow">if</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00806         <span class="keywordflow">if</span> (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o7">dwFlag</a> &amp; <a class="code" href="../../d9/d0/immuser_8h.html#a4">IMEDPI_UNLOADED</a>)
00807             pImeDpi = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00808         <span class="keywordflow">else</span>
00809             pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o6">cLock</a>++;
00810     }
00811 
00812     RtlLeaveCriticalSection(&amp;gcsImeDpi);
00813 
00814     <span class="keywordflow">return</span> (<a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a>)pImeDpi;
00815 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="immuser.h::ImmProcessKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI ImmProcessKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HKL&nbsp;</td>
          <td class="mdname" nowrap> <em>hkl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uVKey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwHotKeyID</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00030">30</a> of file <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html">ntuser/imm/input.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00381">GetKeyboardState</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00087">HotKeyIDDispatcher()</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00070">tagIMEDPI::ImeInfo</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00086">tagIMEDPI::_tagImeFunctions::ImeProcessKey</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00059">ImmAssert</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00912">ImmGetAppCompatFlags()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00201">ImmGetContext()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00557">ImmLocalAlloc()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00371">ImmLockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">ImmLockImeDpi()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00292">ImmReleaseContext()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00196">ImmTranslateMessage()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00383">ImmUnlockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00145">IPHK_HOTKEY</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00146">IPHK_PROCESSBYIME</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d2/d7/structtagIMEDPI.html#o8">tagIMEDPI::pfn</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d2/d4/ntuser_2imm_2conime_8c-source.html#l00034">ImmCallImeConsoleIME()</a>.
<p>
<pre class="fragment"><div>00036 {
00037     HIMC hIMC = <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a5">ImmGetContext</a>(hWnd);
00038     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi = <a class="code" href="../../d9/d0/immuser_8h.html#a45">ImmLockImeDpi</a>(hkl);
00039     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwReturn = 0;
00040 <span class="preprocessor">#if DBG</span>
00041 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (dwHotKeyID &gt;= IME_KHOTKEY_FIRST &amp;&amp; dwHotKeyID &lt;= IME_KHOTKEY_LAST) {
00042         TAGMSG2(DBGTAG_IMM, <span class="stringliteral">"ImmProcessKey: Kor IME Hotkeys should not come here: dwHotKeyID=%x, uVKey=%x"</span>, dwHotKeyID, uVKey);
00043     }
00044 <span class="preprocessor">#endif</span>
00045 <span class="preprocessor"></span>
00046     <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>(dwHotKeyID != IME_KHOTKEY_ENGLISH &amp;&amp;
00047               dwHotKeyID != IME_KHOTKEY_SHAPE_TOGGLE &amp;&amp;
00048               dwHotKeyID != IME_KHOTKEY_HANJACONVERT);
00049 
00050     <span class="comment">//</span>
00051     <span class="comment">// call ImeProcessKey</span>
00052     <span class="comment">//</span>
00053     <span class="keywordflow">if</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00054         PINPUTCONTEXT pInputContext = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a12">ImmLockIMC</a>(hIMC);
00055 
00056         <span class="keywordflow">if</span> (pInputContext != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00057             BOOLEAN fTruncateWideVK = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00058             BOOLEAN fCallIme = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00059             BOOLEAN fSkipThisKey = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00060 
00061 <span class="preprocessor">#ifdef LATER</span>
00062 <span class="preprocessor"></span>
00063             <span class="comment">//</span>
00064             <span class="comment">// if the current imc is not open and IME doesn't need</span>
00065             <span class="comment">// keys when being closed, we don't pass any keyboard</span>
00066             <span class="comment">// input to ime except hotkey and keys that change</span>
00067             <span class="comment">// the keyboard status.</span>
00068             <span class="comment">//</span>
00069             <span class="keywordflow">if</span> ((pImeDpi-&gt;fdwProperty &amp; IME_PROP_NO_KEYS_ON_CLOSE) &amp;&amp;
00070                     !pInputContext-&gt;fOpen &amp;&amp;
00071                     uVKey != VK_SHIFT &amp;&amp;
00072                     uVKey != VK_CONTROL &amp;&amp;
00073                     uVKey != VK_CAPITAL &amp;&amp;
00074                     uVKey != VK_KANA &amp;&amp;
00075                     uVKey != VK_NUMLOCK &amp;&amp;
00076                     uVKey != VK_SCROLL) {
00077                 <span class="comment">// Check if Korea Hanja conversion mode</span>
00078                 <span class="keywordflow">if</span>(!(pimc-&gt;fdwConvMode &amp; IME_CMODE_HANJACONVERT)) {
00079                     fCallIme = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00080                 }
00081             }
00082             <span class="keywordflow">else</span>
00083 <span class="preprocessor">#endif</span>
00084 <span class="preprocessor"></span>            <span class="comment">//</span>
00085             <span class="comment">// Protect IMEs which are unaware of wide virtual keys.</span>
00086             <span class="comment">//</span>
00087             <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)uVKey == VK_PACKET &amp;&amp;
00088                     (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_ACCEPT_WIDE_VKEY) == 0) {
00089 
00090                 <span class="keywordflow">if</span> (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_UNICODE) {
00091                     <span class="comment">//</span>
00092                     <span class="comment">// Since this IME is not ready to accept wide VKey, we should</span>
00093                     <span class="comment">// truncate it.</span>
00094                     <span class="comment">//</span>
00095                     fTruncateWideVK = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00096                 }
00097                 <span class="keywordflow">else</span> {
00098                     <span class="comment">//</span>
00099                     <span class="comment">// Hmm, this guy is ANSI IME, and does not declare Wide Vkey awareness.</span>
00100                     <span class="comment">// Let's guess this one is not ready to accept Wide Vkey, so let's not</span>
00101                     <span class="comment">// pass it to this guy.</span>
00102                     <span class="comment">// And if it is opened, we'd better skip this key for safety.</span>
00103                     <span class="comment">//</span>
00104                     fCallIme = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00105                     <span class="keywordflow">if</span> (pInputContext-&gt;fOpen) {
00106                         fSkipThisKey = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00107                     }
00108                 }
00109             }
00110 
00111             <span class="keywordflow">if</span> (fCallIme) {
00112                 <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbKeyState = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a22">ImmLocalAlloc</a>(0, 256);
00113 
00114                 <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>(fSkipThisKey == FALSE);
00115 
00116                 <span class="keywordflow">if</span> (pbKeyState != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00117                     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d0/user32_8def.html#a46">GetKeyboardState</a>(pbKeyState)) {
00118                         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uVKeyIme = uVKey;
00119                         <span class="keywordflow">if</span> (fTruncateWideVK) {
00120                             uVKeyIme &amp;= 0xffff;
00121                         }
00122                         <span class="keywordflow">if</span> ( (*pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o8">pfn</a>.<a class="code" href="../../d3/d7/structtagIMEDPI_1_1__tagImeFunctions.html#o22">ImeProcessKey</a>)(hIMC, uVKeyIme, lParam, pbKeyState) ) {
00123                             <span class="comment">//</span>
00124                             <span class="comment">// if the return value of ImeProcessKey is TRUE,</span>
00125                             <span class="comment">// it means the key is the one that the ime is</span>
00126                             <span class="comment">// waiting for.</span>
00127                             <span class="comment">//</span>
00128                             pInputContext-&gt;fChgMsg = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00129                             pInputContext-&gt;uSavedVKey = uVKey;
00130                             dwReturn |= <a class="code" href="../../d4/d5/conimep_8h.html#a47">IPHK_PROCESSBYIME</a>;
00131                         }
00132                     }
00133                     <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pbKeyState);
00134                 }
00135             }
00136             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fSkipThisKey) {
00137                 dwReturn |= IPHK_SKIPTHISKEY;
00138                 <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>((dwReturn &amp; (IPHK_PROCESSBYIME | IPHK_HOTKEY)) == 0);
00139             }
00140             <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a13">ImmUnlockIMC</a>(hIMC);
00141         }
00142         <a class="code" href="../../d9/d0/immuser_8h.html#a46">ImmUnlockImeDpi</a>(pImeDpi);
00143     }
00144 
00145     <span class="comment">//</span>
00146     <span class="comment">// call hotkey handler</span>
00147     <span class="comment">//</span>
00148     <span class="keywordflow">if</span> (dwHotKeyID != IME_INVALID_HOTKEY &amp;&amp; <a class="code" href="../../d4/d0/immcli_8h.html#a105">HotKeyIDDispatcher</a>(hWnd, hIMC, hkl, dwHotKeyID)) {
00149         <span class="comment">// Backward compat:</span>
00150         <span class="comment">// On Japanese system, some applications may want VK_KANJI.</span>
00151         <span class="keywordflow">if</span> ((uVKey != VK_KANJI) ||
00152                 (dwHotKeyID != IME_JHOTKEY_CLOSE_OPEN)) {
00153             dwReturn |= <a class="code" href="../../d4/d5/conimep_8h.html#a46">IPHK_HOTKEY</a>;
00154         }
00155     }
00156 
00157     <span class="comment">//</span>
00158     <span class="comment">// some 3.x application doesn't like to see</span>
00159     <span class="comment">// VK_PROCESSKEY.</span>
00160     <span class="comment">//</span>
00161     <span class="keywordflow">if</span> (dwReturn &amp; <a class="code" href="../../d4/d5/conimep_8h.html#a47">IPHK_PROCESSBYIME</a>) {
00162 
00163         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwImeCompat = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a34">ImmGetAppCompatFlags</a>(hIMC);
00164 
00165         <span class="keywordflow">if</span> (dwImeCompat &amp; IMECOMPAT_NOVKPROCESSKEY) {
00166 
00167             <span class="comment">// Korea 3.x application doesn't like to see dummy finalize VK_PROCESSKEY</span>
00168             <span class="comment">// and IME hot key.</span>
00169 
00170             <span class="keywordflow">if</span> ( PRIMARYLANGID(LANGIDFROMLCID(GetSystemDefaultLCID())) == LANG_KOREAN &amp;&amp;
00171                  ( (uVKey == VK_PROCESSKEY) || (dwReturn &amp; <a class="code" href="../../d4/d5/conimep_8h.html#a46">IPHK_HOTKEY</a>) ) ) {
00172                 <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a7">ImmReleaseContext</a>(hWnd, hIMC);
00173                 <span class="keywordflow">return</span> dwReturn;
00174             }
00175 
00176             <a class="code" href="../../d9/d0/immuser_8h.html#a49">ImmTranslateMessage</a>(hWnd, WM_KEYDOWN, VK_PROCESSKEY, lParam);
00177             dwReturn &amp;= ~<a class="code" href="../../d4/d5/conimep_8h.html#a47">IPHK_PROCESSBYIME</a>;
00178             dwReturn |= IPHK_SKIPTHISKEY;
00179         }
00180     }
00181     <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a7">ImmReleaseContext</a>(hWnd, hIMC);
00182 
00183     <span class="keywordflow">return</span> dwReturn;
00184 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="immuser.h::ImmSetActiveContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ImmSetActiveContext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HIMC&nbsp;</td>
          <td class="mdname" nowrap> <em>hImc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fActivate</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00309">309</a> of file <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html">w32/ntuser/imm/context.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00164">ClrICF</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04502">GetKeyboardLayout()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01547">GETPTI</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00046">IGSC_DEFIMCFALLBACK</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00034">IMCF_ACTIVE</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00088">tagIMEDPI::_tagImeFunctions::ImeSetActiveContext</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00027">ImmGetDefaultIMEWnd()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00225">ImmGetSaveContext()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00689">ImmLockClientImc()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00371">ImmLockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">ImmLockImeDpi()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00747">ImmUnlockClientImc()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00383">ImmUnlockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00591">IS_IME_ENABLED</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13072">NtUserNotifyIMEStatus()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00025">NULL_HIMC</a>, <a class="el" href="../../d2/d7/structtagIMEDPI.html#o8">tagIMEDPI::pfn</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00162">SetICF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00086">ImmAssociateContext()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00142">ImmAssociateContextEx()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00484">ImmEnableIME()</a>, and <a class="el" href="../../d2/d4/ntuser_2imm_2conime_8c-source.html#l00188">ImmSetActiveContextConsoleIME()</a>.
<p>
<pre class="fragment"><div>00313 {
00314     <a class="code" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a>    pClientImc;
00315     PINPUTCONTEXT pInputContext;
00316     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a>       pImeDpi;
00317     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>         dwISC;
00318     HIMC          hSaveImc;
00319     HWND          hDefImeWnd;
00320     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>         dwOpenStatus = 0;
00321     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>         dwConversion = 0;
00322 <span class="preprocessor">#ifdef DEBUG</span>
00323 <span class="preprocessor"></span>    <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>          pWnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hWnd);
00324 
00325     <span class="keywordflow">if</span> (pWnd != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a455">GETPTI</a>(pWnd) != <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>()) {
00326         RIPMSG1(RIP_WARNING, <span class="stringliteral">"hWnd (=%lx) is not of current thread."</span>, hWnd);
00327     }
00328 <span class="preprocessor">#endif</span>
00329 <span class="preprocessor"></span>
00330     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>()) {
00331         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00332     }
00333 
00334     dwISC = ISC_SHOWUIALL;
00335 
00336     pClientImc = <a class="code" href="../../d9/d0/immuser_8h.html#a43">ImmLockClientImc</a>(hImc);
00337 
00338     <span class="keywordflow">if</span> (!fActivate) {
00339         <span class="keywordflow">if</span> (pClientImc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00340             <a class="code" href="../../d4/d0/immcli_8h.html#a20">ClrICF</a>(pClientImc, IMCF_ACTIVE);
00341         <span class="keywordflow">goto</span> NotifySetActive;
00342     }
00343 
00344     <span class="keywordflow">if</span> (hImc == <a class="code" href="../../d8/d0/immstruc_8h.html#a0">NULL_HIMC</a>) {
00345         hSaveImc = <a class="code" href="../../d4/d0/immcli_8h.html#a72">ImmGetSaveContext</a>(hWnd, IGSC_DEFIMCFALLBACK);
00346         pInputContext = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a12">ImmLockIMC</a>(hSaveImc);
00347         <span class="keywordflow">if</span> (pInputContext != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00348             pInputContext-&gt;hWnd = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00349             <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a13">ImmUnlockIMC</a>(hSaveImc);
00350         }
00351         <span class="keywordflow">goto</span> NotifySetActive;
00352     }
00353 
00354     <span class="comment">/*</span>
00355 <span class="comment">     * Non-NULL input context, window handle have to be updated.</span>
00356 <span class="comment">     */</span>
00357     <span class="keywordflow">if</span> (pClientImc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00358         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00359 
00360     pInputContext = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a12">ImmLockIMC</a>(hImc);
00361     <span class="keywordflow">if</span> (pInputContext == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00362         <a class="code" href="../../d9/d0/immuser_8h.html#a44">ImmUnlockClientImc</a>(pClientImc);
00363         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00364     }
00365 
00366     pInputContext-&gt;hWnd = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00367     <a class="code" href="../../d4/d0/immcli_8h.html#a19">SetICF</a>(pClientImc, IMCF_ACTIVE);
00368 
00369 <span class="preprocessor">#ifdef LATER</span>
00370 <span class="preprocessor"></span>    <span class="comment">// Do uNumLangVKey checking later</span>
00371 <span class="preprocessor">#endif</span>
00372 <span class="preprocessor"></span>
00373     <span class="keywordflow">if</span> (pInputContext-&gt;fdw31Compat &amp; F31COMPAT_MCWHIDDEN)
00374         dwISC = ISC_SHOWUIALL - ISC_SHOWUICOMPOSITIONWINDOW;
00375 
00376     dwOpenStatus = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)pInputContext-&gt;fOpen;
00377     dwConversion = pInputContext-&gt;fdwConversion;
00378     <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a13">ImmUnlockIMC</a>(hImc);
00379 
00380 NotifySetActive:
00381 
00382     pImeDpi = <a class="code" href="../../d9/d0/immuser_8h.html#a45">ImmLockImeDpi</a>(<a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0));
00383     <span class="keywordflow">if</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00384         (*pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o8">pfn</a>.<a class="code" href="../../d3/d7/structtagIMEDPI_1_1__tagImeFunctions.html#o24">ImeSetActiveContext</a>)(hImc, fActivate);
00385         <a class="code" href="../../d9/d0/immuser_8h.html#a46">ImmUnlockImeDpi</a>(pImeDpi);
00386     }
00387 
00388     <span class="comment">/*</span>
00389 <span class="comment">     * Notify UI</span>
00390 <span class="comment">     */</span>
00391     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(hWnd)) {
00392         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd, WM_IME_SETCONTEXT, fActivate, dwISC);
00393 
00394         <span class="comment">/*</span>
00395 <span class="comment">         * send notify to shell / keyboard driver</span>
00396 <span class="comment">         */</span>
00397         <span class="keywordflow">if</span> ( fActivate )
00398             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a400">NtUserNotifyIMEStatus</a>( hWnd, dwOpenStatus, dwConversion );
00399     }
00400     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!fActivate) {
00401         <span class="comment">/*</span>
00402 <span class="comment">         * Because hWnd is not there (maybe destroyed), we send</span>
00403 <span class="comment">         * WM_IME_SETCONTEXT to the default IME window.</span>
00404 <span class="comment">         */</span>
00405         <span class="keywordflow">if</span> ((hDefImeWnd = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a4">ImmGetDefaultIMEWnd</a>(NULL)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00406             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hDefImeWnd, WM_IME_SETCONTEXT, fActivate, dwISC);
00407         }
00408         <span class="keywordflow">else</span> {
00409             RIPMSG0(RIP_WARNING,
00410                   <span class="stringliteral">"ImmSetActiveContext: can't send WM_IME_SETCONTEXT(FALSE)."</span>);
00411         }
00412     }
00413 <span class="preprocessor">#ifdef DEBUG</span>
00414 <span class="preprocessor"></span>    <span class="keywordflow">else</span> {
00415         RIPMSG0(RIP_WARNING,
00416               <span class="stringliteral">"ImmSetActiveContext: can't send WM_IME_SETCONTEXT(TRUE)."</span>);
00417     }
00418 <span class="preprocessor">#endif</span>
00419 <span class="preprocessor"></span>
00420 <span class="preprocessor">#ifdef LATER</span>
00421 <span class="preprocessor"></span>    <span class="comment">// Implements ProcessIMCEvent() later.</span>
00422 <span class="preprocessor">#endif</span>
00423 <span class="preprocessor"></span>
00424     <span class="keywordflow">if</span> (pClientImc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00425         <a class="code" href="../../d9/d0/immuser_8h.html#a44">ImmUnlockClientImc</a>(pClientImc);
00426 
00427     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00428 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="immuser.h::ImmTranslateMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ImmTranslateMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00196">196</a> of file <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html">ntuser/imm/input.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04502">GetKeyboardLayout()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00381">GetKeyboardState</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00251">GetWindowThreadProcessId()</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00070">tagIMEDPI::ImeInfo</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00089">tagIMEDPI::_tagImeFunctions::ImeToAsciiEx</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00059">ImmAssert</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00201">ImmGetContext()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00557">ImmLocalAlloc()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00371">ImmLockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00471">ImmLockIMCC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00793">ImmLockImeDpi()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00408">ImmPostMessages()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00292">ImmReleaseContext()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00383">ImmUnlockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00488">ImmUnlockIMCC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">ImmUnlockImeDpi()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d2/d7/structtagIMEDPI.html#o8">tagIMEDPI::pfn</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01112">ToAsciiEx()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00946">ToUnicode()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00186">TRANSMSGCOUNT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d1/d9/imefull_8c-source.html#l00208">CharHandlerFromConsole()</a>, and <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00030">ImmProcessKey()</a>.
<p>
<pre class="fragment"><div>00201 {
00202     HIMC hImc;
00203     PINPUTCONTEXT pInputContext;
00204     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fReturn = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00205     HKL  hkl;
00206     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00207     <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pbKeyState;
00208     PTRANSMSG pTransMsg;
00209     PTRANSMSGLIST pTransMsgList;
00210     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwSize;
00211     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uVKey;
00212     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a> iNum;
00213 
00214     UNREFERENCED_PARAMETER(wParam);
00215 
00216     <span class="comment">//</span>
00217     <span class="comment">// we're interested in only those keyboard messages.</span>
00218     <span class="comment">//</span>
00219     <span class="keywordflow">switch</span> (message) {
00220     <span class="keywordflow">case</span> WM_KEYDOWN:
00221     <span class="keywordflow">case</span> WM_KEYUP:
00222     <span class="keywordflow">case</span> WM_SYSKEYDOWN:
00223     <span class="keywordflow">case</span> WM_SYSKEYUP:
00224         <span class="keywordflow">break</span>;
00225     <span class="keywordflow">default</span>:
00226         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00227     }
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">// input context is necessary for further handling</span>
00231     <span class="comment">//</span>
00232     hImc = <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a5">ImmGetContext</a>(hwnd);
00233     pInputContext = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a12">ImmLockIMC</a>(hImc);
00234     <span class="keywordflow">if</span> (pInputContext == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00235         <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a7">ImmReleaseContext</a>(hwnd, hImc);
00236         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00237     }
00238 
00239     <span class="comment">//</span>
00240     <span class="comment">// At first, handle VK_PROCESSKEY generated by IME.</span>
00241     <span class="comment">//</span>
00242     <span class="keywordflow">if</span> (!pInputContext-&gt;fChgMsg) {
00243 
00244         <span class="keywordflow">if</span> ((iNum=pInputContext-&gt;dwNumMsgBuf) != 0) {
00245 
00246             pTransMsg = (PTRANSMSG)<a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a17">ImmLockIMCC</a>(pInputContext-&gt;hMsgBuf);
00247             <span class="keywordflow">if</span> (pTransMsg != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00248                 <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a4">ImmPostMessages</a>(hwnd, hImc, iNum, pTransMsg);
00249                 <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a18">ImmUnlockIMCC</a>(pInputContext-&gt;hMsgBuf);
00250                 fReturn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00251             }
00252 
00253             pInputContext-&gt;dwNumMsgBuf = 0;
00254         }
00255         <span class="keywordflow">goto</span> ExitITM;
00256     }
00257 
00258     pInputContext-&gt;fChgMsg = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00259 
00260     <span class="comment">//</span>
00261     <span class="comment">// retrieve the keyboard layout and IME entry points</span>
00262     <span class="comment">//</span>
00263     hkl = <a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>( <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwnd, NULL) );
00264     pImeDpi = <a class="code" href="../../d9/d0/immuser_8h.html#a45">ImmLockImeDpi</a>(hkl);
00265     <span class="keywordflow">if</span> (pImeDpi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00266         RIPMSG1(RIP_WARNING, <span class="stringliteral">"ImmTranslateMessage pImeDpi is NULL(hkl=%x)"</span>, hkl);
00267         <span class="keywordflow">goto</span> ExitITM;
00268     }
00269 
00270     pbKeyState = <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a22">ImmLocalAlloc</a>(0, 256);
00271     <span class="keywordflow">if</span> ( pbKeyState == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00272         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ImmTranslateMessage out of memory"</span> );
00273         <span class="keywordflow">goto</span> ExitITM;
00274     }
00275 
00276     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d0/user32_8def.html#a46">GetKeyboardState</a>(pbKeyState)) {
00277         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ImmTranslateMessage GetKeyboardState() failed"</span> );
00278         <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>( pbKeyState );
00279         <span class="keywordflow">goto</span> ExitITM;
00280     }
00281 
00282     <span class="comment">//</span>
00283     <span class="comment">// Translate the saved vkey into character code if needed</span>
00284     <span class="comment">//</span>
00285     uVKey = pInputContext-&gt;uSavedVKey;
00286 
00287     <span class="keywordflow">if</span> (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_KBD_CHAR_FIRST) {
00288 
00289         <span class="keywordflow">if</span> (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_UNICODE) {
00290             WCHAR wcTemp;
00291 
00292             iNum = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a24">ToUnicode</a>(pInputContext-&gt;uSavedVKey, <span class="comment">// virtual-key code</span>
00293                              HIWORD(lParam),            <span class="comment">// scan code</span>
00294                              pbKeyState,                <span class="comment">// key-state array</span>
00295                              &amp;wcTemp,                   <span class="comment">// buffer for translated key</span>
00296                              1,                         <span class="comment">// size of buffer</span>
00297                              0);
00298             <span class="keywordflow">if</span> (iNum == 1) {
00299                 <span class="comment">//</span>
00300                 <span class="comment">// hi word            : unicode character code</span>
00301                 <span class="comment">// hi byte of lo word : zero</span>
00302                 <span class="comment">// lo byte of lo word : virtual key</span>
00303                 <span class="comment">//</span>
00304                 uVKey = (uVKey &amp; 0x00ff) | ((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)wcTemp &lt;&lt; 16);
00305             }
00306 
00307         } <span class="keywordflow">else</span> {
00308             WORD wTemp = 0;
00309 
00310             iNum = <a class="code" href="../../d3/d8/client_8c.html#a47">ToAsciiEx</a>(pInputContext-&gt;uSavedVKey, <span class="comment">// virtual-key code</span>
00311                              HIWORD(lParam),            <span class="comment">// scan code</span>
00312                              pbKeyState,                <span class="comment">// key-state array</span>
00313                              &amp;wTemp,                    <span class="comment">// buffer for translated key</span>
00314                              0,                         <span class="comment">// active-menu flag</span>
00315                              hkl);
00316             <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>(iNum &lt;= 2);
00317             <span class="keywordflow">if</span> (iNum &gt; 0) {
00318                 <span class="comment">//</span>
00319                 <span class="comment">// hi word            : should be zero</span>
00320                 <span class="comment">// hi byte of lo word : character code</span>
00321                 <span class="comment">// lo byte of lo word : virtual key</span>
00322                 <span class="comment">//</span>
00323                 uVKey = (uVKey &amp; 0x00FF) | ((<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)wTemp &lt;&lt; 8);
00324 
00325                 <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)uVKey == VK_PACKET) {
00326                     <span class="comment">//</span>
00327                     <span class="comment">// If ANSI IME is wide vkey aware, its ImeToAsciiEx will receive the uVKey</span>
00328                     <span class="comment">// as follows:</span>
00329                     <span class="comment">//</span>
00330                     <span class="comment">//  31            24 23                         16 15                8 7             0</span>
00331                     <span class="comment">// +----------------+-----------------------------+-------------------+---------------+</span>
00332                     <span class="comment">// | 24~31:reserved | 16~23:trailing byte(if any) | 8~15:leading byte | 0~7:VK_PACKET |</span>
00333                     <span class="comment">// +----------------+-----------------------------+-------------------+---------------+</span>
00334                     <span class="comment">//</span>
00335                     <a class="code" href="../../d4/d0/immcli_8h.html#a2">ImmAssert</a>(pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_ACCEPT_WIDE_VKEY);
00336                 }
00337                 <span class="keywordflow">else</span> {
00338                     uVKey &amp;= 0xffff;
00339                 }
00340             }
00341         }
00342     }
00343 
00344     dwSize = FIELD_OFFSET(TRANSMSGLIST, TransMsg)
00345            + <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a1">TRANSMSGCOUNT</a> * <span class="keyword">sizeof</span>(TRANSMSG);
00346 
00347     pTransMsgList = (PTRANSMSGLIST)<a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a22">ImmLocalAlloc</a>(0, dwSize);
00348 
00349     <span class="keywordflow">if</span> (pTransMsgList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00350         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ImmTranslateMessage out of memory"</span> );
00351         <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pbKeyState);
00352         <span class="keywordflow">goto</span> ExitITM;
00353     }
00354 
00355     pTransMsgList-&gt;uMsgCount = <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a1">TRANSMSGCOUNT</a>;
00356     iNum = (*pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o8">pfn</a>.<a class="code" href="../../d3/d7/structtagIMEDPI_1_1__tagImeFunctions.html#o25">ImeToAsciiEx</a>)(uVKey,
00357                                         HIWORD(lParam),
00358                                         pbKeyState,
00359                                         pTransMsgList,
00360                                         0,
00361                                         hImc);
00362 
00363     <span class="keywordflow">if</span> (iNum &gt; <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a1">TRANSMSGCOUNT</a>) {
00364 
00365         <span class="comment">//</span>
00366         <span class="comment">// The message buffer is not big enough. IME put messages</span>
00367         <span class="comment">// into hMsgBuf in the input context.</span>
00368         <span class="comment">//</span>
00369 
00370         pTransMsg = (PTRANSMSG)<a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a17">ImmLockIMCC</a>(pInputContext-&gt;hMsgBuf);
00371         <span class="keywordflow">if</span> (pTransMsg != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00372             <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a4">ImmPostMessages</a>(hwnd, hImc, iNum, pTransMsg);
00373             <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a18">ImmUnlockIMCC</a>(pInputContext-&gt;hMsgBuf);
00374         }
00375 
00376 <span class="preprocessor">#ifdef LATER</span>
00377 <span class="preprocessor"></span>        <span class="comment">// Shouldn't we need this ?</span>
00378         fReturn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00379 <span class="preprocessor">#endif</span>
00380 <span class="preprocessor"></span>
00381     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iNum &gt; 0) {
00382         <a class="code" href="../../d4/d3/ntuser_2imm_2input_8c.html#a4">ImmPostMessages</a>(hwnd, hImc, iNum, &amp;pTransMsgList-&gt;TransMsg[0]);
00383         fReturn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00384     }
00385 
00386     <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pbKeyState);
00387     <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pTransMsgList);
00388 
00389 ExitITM:
00390     <a class="code" href="../../d9/d0/immuser_8h.html#a46">ImmUnlockImeDpi</a>(pImeDpi);
00391     <a class="code" href="../../d5/d0/w32_2ntuser_2imm_2misc_8c.html#a13">ImmUnlockIMC</a>(hImc);
00392     <a class="code" href="../../d7/d6/w32_2ntuser_2imm_2context_8c.html#a7">ImmReleaseContext</a>(hwnd, hImc);
00393 
00394     <span class="keywordflow">return</span> fReturn;
00395 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="immuser.h::ImmUnloadIME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI ImmUnloadIME           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HKL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hKL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/immime_8c-source.html#l00365">365</a> of file <a class="el" href="../../d7/d9/immime_8c-source.html">immime.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00073">tagIMEDPI::cLock</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00074">tagIMEDPI::dwFlag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00033">gpImeDpi</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00069">tagIMEDPI::hKL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00063">IMEDPI_UNLOADED</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00067">tagIMEDPI::pNext</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/immime_8c-source.html#l00212">UnloadIME()</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/immime_8c-source.html#l00416">ImmFreeLayout()</a>.
<p>
<pre class="fragment"><div>00367 {
00368     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpi, pImeDpiT;
00369 
00370     RtlEnterCriticalSection(&amp;gcsImeDpi);
00371 
00372     pImeDpi = <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a>;
00373 
00374     <span class="keywordflow">while</span> (pImeDpi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o2">hKL</a> != hKL)
00375         pImeDpi = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00376 
00377     <span class="keywordflow">if</span> (pImeDpi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00378         RtlLeaveCriticalSection(&amp;gcsImeDpi);
00379         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00380     }
00381     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o6">cLock</a> != 0) {
00382         pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o7">dwFlag</a> |= <a class="code" href="../../d9/d0/immuser_8h.html#a4">IMEDPI_UNLOADED</a>;
00383         RtlLeaveCriticalSection(&amp;gcsImeDpi);
00384         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00385     }
00386 
00387     <span class="comment">/*</span>
00388 <span class="comment">     * Unlink it.</span>
00389 <span class="comment">     */</span>
00390     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a> == pImeDpi) {
00391         <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a> = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00392     }
00393     <span class="keywordflow">else</span> {
00394         pImeDpiT = <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a>;
00395 
00396         <span class="keywordflow">while</span> (pImeDpiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a> != pImeDpi)
00397             pImeDpiT = pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00398 
00399         <span class="keywordflow">if</span> (pImeDpiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00400             pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a> = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00401     }
00402 
00403     <span class="comment">/*</span>
00404 <span class="comment">     * Unload the IME DLL.</span>
00405 <span class="comment">     */</span>
00406     <a class="code" href="../../d6/d0/immime_8c.html#a9">UnloadIME</a>(pImeDpi, TRUE);
00407 
00408     <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pImeDpi);
00409 
00410     RtlLeaveCriticalSection(&amp;gcsImeDpi);
00411 
00412     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00413 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="immuser.h::ImmUnlockClientImc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID WINAPI ImmUnlockClientImc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d0/structtagCLIENTIMC.html">PCLIENTIMC</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pClientImc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00747">747</a> of file <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html">w32/ntuser/imm/misc.c</a>.
<p>
References <a class="el" href="../../d0/d0/immuser_8h-source.html#l00025">tagCLIENTIMC::cLockObj</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00033">DeleteImcCrit</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00024">tagCLIENTIMC::hInputContext</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00039">IMCF_INDESTROY</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00166">TestICF</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00563">CreateInputContext()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00718">DestroyInputContext()</a>, <a class="el" href="../../d7/d8/clwinnls_8c-source.html#l00484">ImmEnableIME()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00171">ImmGenerateMessage()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00912">ImmGetAppCompatFlags()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00879">ImmGetCandidateListCountWorker()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01014">ImmGetCandidateListWorker()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01583">ImmGetCompositionFontA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01643">ImmGetCompositionFontW()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00036">ImmGetCompositionStringA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00099">ImmGetCompositionStringW()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01173">ImmGetGuideLineWorker()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00412">ImmGetIMCLockCount()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00225">ImmGetSaveContext()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00408">ImmPostMessages()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l03349">ImmRequestMessageWorker()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00309">ImmSetActiveContext()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01694">ImmSetCompositionFontA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01764">ImmSetCompositionFontW()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00383">ImmUnlockIMC()</a>, <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00303">InternalImmLockIMC()</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00456">IsAnsiIMC()</a>, <a class="el" href="../../d3/d4/transsub_8c-source.html#l01328">MySetCompFont()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00837">SelectInputContext()</a>, and <a class="el" href="../../d3/d4/transsub_8c-source.html#l01222">SetFontForMCWVERTICAL()</a>.
<p>
<pre class="fragment"><div>00749 {
00750     <span class="keywordflow">if</span> (InterlockedDecrement(&amp;pClientImc-&gt;<a class="code" href="../../d3/d0/structtagCLIENTIMC.html#o1">cLockObj</a>) == 0) {
00751         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/immcli_8h.html#a21">TestICF</a>(pClientImc, IMCF_INDESTROY)) {
00752             <span class="keywordflow">if</span> (pClientImc-&gt;<a class="code" href="../../d3/d0/structtagCLIENTIMC.html#o0">hInputContext</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00753                 LocalFree(pClientImc-&gt;<a class="code" href="../../d3/d0/structtagCLIENTIMC.html#o0">hInputContext</a>);
00754 
00755             <a class="code" href="../../d9/d0/immuser_8h.html#a1">DeleteImcCrit</a>(pClientImc);
00756             <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pClientImc);
00757         }
00758     }
00759 
00760     <span class="keywordflow">return</span>;
00761 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="immuser.h::ImmUnlockImeDpi" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID WINAPI ImmUnlockImeDpi           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pImeDpi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html#l00824">824</a> of file <a class="el" href="../../d6/d9/w32_2ntuser_2imm_2misc_8c-source.html">w32/ntuser/imm/misc.c</a>.
<p>
References <a class="el" href="../../d0/d0/immuser_8h-source.html#l00073">tagIMEDPI::cLock</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00074">tagIMEDPI::dwFlag</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00033">gpImeDpi</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00063">IMEDPI_UNLOADED</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00064">IMEDPI_UNLOCKUNLOAD</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00070">tagIMEDPI::ImeInfo</a>, <a class="el" href="../../d5/d9/immcli_8h-source.html#l00137">ImmLocalFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/immuser_8h-source.html#l00067">tagIMEDPI::pNext</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00212">UnloadIME()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00563">CreateInputContext()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00718">DestroyInputContext()</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00087">HotKeyIDDispatcher()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00495">ImmActivateLayout()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00575">ImmConfigureIMEA()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00707">ImmConfigureIMEW()</a>, <a class="el" href="../../d7/d8/softkbd_8c-source.html#l00137">ImmCreateSoftKeyboard()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00539">ImmEnumRegisterWordA()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00642">ImmEnumRegisterWordW()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00849">ImmEscapeA()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l00999">ImmEscapeW()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01841">ImmGetConversionListA()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l01964">ImmGetConversionListW()</a>, <a class="el" href="../../d3/d9/imemenu_8c-source.html#l00759">ImmGetImeMenuItemsWorker()</a>, <a class="el" href="../../d5/d0/layout_8c-source.html#l00202">ImmGetProperty()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00397">ImmGetRegisterWordStyleA()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00469">ImmGetRegisterWordStyleW()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l01294">ImmNotifyIME()</a>, <a class="el" href="../../d7/d9/immime_8c-source.html#l01128">ImmPenAuxInput()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00030">ImmProcessKey()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00025">ImmRegisterWordA()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00116">ImmRegisterWordW()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00309">ImmSetActiveContext()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l00610">ImmSetCompositionStringWorker()</a>, <a class="el" href="../../d5/d2/ntuser_2imm_2input_8c-source.html#l00196">ImmTranslateMessage()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00211">ImmUnregisterWordA()</a>, <a class="el" href="../../d7/d6/regword_8c-source.html#l00302">ImmUnregisterWordW()</a>, <a class="el" href="../../d3/d1/hotkey_8c-source.html#l00155">JCloseOpen()</a>, <a class="el" href="../../d5/d0/ctxtinfo_8c-source.html#l03158">MakeIMENotify()</a>, <a class="el" href="../../d8/d5/w32_2ntuser_2imm_2context_8c-source.html#l00837">SelectInputContext()</a>, and <a class="el" href="../../d3/d4/transsub_8c-source.html#l01042">TransHanjaMode()</a>.
<p>
<pre class="fragment"><div>00826 {
00827     <a class="code" href="../../d2/d7/structtagIMEDPI.html">PIMEDPI</a> pImeDpiT;
00828 
00829     <span class="keywordflow">if</span> (pImeDpi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00830         <span class="keywordflow">return</span>;
00831 
00832     RtlEnterCriticalSection(&amp;gcsImeDpi);
00833 
00834     <span class="keywordflow">if</span> (--pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o6">cLock</a> == 0) {
00835 
00836         <span class="keywordflow">if</span> ((pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o7">dwFlag</a> &amp; <a class="code" href="../../d9/d0/immuser_8h.html#a4">IMEDPI_UNLOADED</a>) ||
00837             ((pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o7">dwFlag</a> &amp; <a class="code" href="../../d9/d0/immuser_8h.html#a5">IMEDPI_UNLOCKUNLOAD</a>) &amp;&amp;
00838              (pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o3">ImeInfo</a>.fdwProperty &amp; IME_PROP_END_UNLOAD)))
00839         {
00840             <span class="comment">/*</span>
00841 <span class="comment">             * Unlink it.</span>
00842 <span class="comment">             */</span>
00843             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a> == pImeDpi) {
00844                 <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a> = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00845             }
00846             <span class="keywordflow">else</span> {
00847                 pImeDpiT = <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a7">gpImeDpi</a>;
00848 
00849                 <span class="keywordflow">while</span> (pImeDpiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a> != pImeDpi)
00850                     pImeDpiT = pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00851 
00852                 <span class="keywordflow">if</span> (pImeDpiT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00853                     pImeDpiT-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a> = pImeDpi-&gt;<a class="code" href="../../d2/d7/structtagIMEDPI.html#o0">pNext</a>;
00854             }
00855 
00856             <span class="comment">/*</span>
00857 <span class="comment">             * Unload the IME DLL.</span>
00858 <span class="comment">             */</span>
00859             <a class="code" href="../../d6/d0/immime_8c.html#a9">UnloadIME</a>(pImeDpi, TRUE);
00860             <a class="code" href="../../d4/d0/immcli_8h.html#a8">ImmLocalFree</a>(pImeDpi);
00861         }
00862     }
00863 
00864     RtlLeaveCriticalSection(&amp;gcsImeDpi);
00865 
00866     <span class="keywordflow">return</span>;
00867 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:10 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
