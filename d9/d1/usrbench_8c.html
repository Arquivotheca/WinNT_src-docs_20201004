<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: usrbench.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>usrbench.c File Reference</h1><code>#include "<a class="el" href="../../d4/d3/w32_2ntuser_2tools_2usrbench_2precomp_8h-source.html">precomp.h</a>"</code><br>
<code>#include "<a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html">resource.h</a>"</code><br>
<code>#include "wchar.h"</code><br>
<code>#include "<a class="el" href="../../d1/d1/usrbench_8h-source.html">usrbench.h</a>"</code><br>
<code>#include "<a class="el" href="../../d3/d0/bench_8h-source.html">bench.h</a>"</code><br>

<p>
<a href="../../d0/d1/usrbench_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a0">MAIN_MODULE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(fmt, v)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a15">MDIChildWndProc</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a16">InitializeInstance</a> (HINSTANCE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, HINSTANCE hPrev, <a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a> nCmdShow)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int PASCAL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a17">WinMain</a> (HINSTANCE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, HINSTANCE hPrev, LPSTR szCmdLine, int cmdShow)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT FAR PASCAL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a18">WndProc</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, unsigned <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a19">SaveResults</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a20">ResultsDlgProc</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR APIENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a21">HelpDlgProc</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a22">SelectOutFileName</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a23">WriteBatchResults</a> (FILE *fpOut, int TestType, int cycle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a24">SyncMenuChecks</a> (HWND <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a29">hWnd</a>, int Last_Checked, int New_Checked)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a25">Std_Parse</a> (char *txtbuf, int limit, int *array)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> = DEFAULT_A_STRING</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = DEFAULT_W_STRING</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a4">gfPentium</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a5">gfUseCycleCount</a> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HINSTANCE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a7">ghaccel</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a8">ghinst</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a9">ghwndFrame</a> = NULL <a class="el" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> = NULL</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>MDICREATESTRUCT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a10">mcs</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a11">szChild</a> [] = "child"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a> [] = "frame"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CHOOSEFONT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a13">cf</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LOGFONT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/usrbench_8c.html#a14">lf</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="usrbench.c::MAIN_MODULE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAIN_MODULE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00057">57</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="usrbench.c::SUBITEM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SUBITEM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fmt,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>v&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a8">sprintf</a>(szT, fmt, v); \
                ListView_SetItemText(hwndList, lvl.iItem, ++lvl.iSubItem, szT);
</div></pre>
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01398">ResultsDlgProc()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a21" doxytag="usrbench.c::HelpDlgProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR APIENTRY HelpDlgProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01500">1500</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d3/d8/dlgend_8c-source.html#l00024">EndDialog()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00046">IDC_HELPLIST</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00717">SendDlgItemMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01505 {
01506     ULONG ix, last_ix;
01507     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* szT[] = {
01508         <span class="stringliteral">"Usage:"</span>,
01509         <span class="stringliteral">"usrbench (interactive mode), or "</span>,
01510         <span class="stringliteral">"usrbench /b (batch mode)"</span>,
01511         <span class="stringliteral">"         /d (Print detailed distribution if more than 5 percent of samples filtered out)"</span>,
01512         <span class="stringliteral">"         /m (Message when batch finished)"</span>,
01513         <span class="stringliteral">"         /s (Stay, don't close application when batch finished)"</span>,
01514         <span class="stringliteral">"         /t (Batch and Interactive Modes; Measure test time - not Cycle Counts, on Pentium Machines)"</span>,
01515         <span class="stringliteral">"         /i [INI filename] (optional, def.= USRBATCH.INI )"</span>,
01516         <span class="stringliteral">""</span>,
01517         <span class="stringliteral">"Batch Mode requires preparing an INI file (default: USRBATCH.INI) in the same directory where the application is being run."</span>,
01518         <span class="stringliteral">"You may also specify an INI filename using /i [INI filename] in the command line (must reside in the directory mentioned above)."</span>,
01519         <span class="stringliteral">""</span>,
01520         <span class="stringliteral">"INI file Sections and Keys: (Use  ' , '  or  ' ; '  as separators where necessary)"</span>,
01521         <span class="stringliteral">"[BATCH]"</span>,
01522         <span class="stringliteral">"RUN= ALL / QUICK / TEXT / SELECT (Test type, select one, def.= TEXT"</span>,
01523         <span class="stringliteral">"CYCLE= (No. of batch cycles, def.= 1)"</span>,
01524         <span class="stringliteral">"TEST= test numbers (Selected tests to run, needed only for test type= SELECT)"</span>,
01525         <span class="stringliteral">"[TEXT]"</span>,
01526         <span class="stringliteral">"FONT = name, +optional parameters   (Font name + any combination of:"</span>,
01527         <span class="stringliteral">" BOLD, ITALIC, UNDERLINE, STRIKE, TRANSPARENT, RGB(r,g,b), def.= Arial)"</span>,
01528         <span class="stringliteral">"STRING_CONTENT= string (Text string to be used, up to 128 characters)"</span>,
01529         <span class="stringliteral">"[RUN]"</span>,
01530         <span class="stringliteral">"FONT_SIZE= font sizes (Font sizes to be tested, def. 12)"</span>,
01531         <span class="stringliteral">"STRING_LENGTH= string lengths (String Length to be tested, taken as sub-strings of the one specified, def. 32)"</span>,
01532         <span class="stringliteral">"ORDER= test loop order (Order of test loops (first is outer); example: FONT_SIZE STRING_LENGTH )"</span>,
01533         <span class="stringliteral">""</span>,
01534         <span class="stringliteral">"Batch Output:"</span>,
01535         <span class="stringliteral">"Output files will be generated automatically in the run directory, with the name [USBxxx.log], where xxx is a number."</span>,
01536         <span class="stringliteral">"Note that the program will refuse to run if more than 200 output files are accumulated..."</span>,
01537     };
01538 
01539     <span class="keywordtype">int</span> aiT[2];
01540 
01541     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01542     <span class="keywordflow">case</span> WM_INITDIALOG:
01543         aiT[0] = 100;
01544         aiT[1] = 190;
01545         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hwnd, IDC_HELPLIST, LB_SETTABSTOPS, 2,
01546                 (LPARAM)aiT);
01547 
01548         <span class="keywordflow">for</span> (ix = 0; ix &lt; <span class="keyword">sizeof</span> szT / <span class="keyword">sizeof</span> szT[0]; ix++) {
01549             <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hwnd, IDC_HELPLIST, LB_ADDSTRING, 0,
01550                         (LPARAM)szT[ix]);
01551         }
01552 
01553 
01554         <span class="keywordflow">break</span>;
01555 
01556     <span class="keywordflow">case</span> WM_COMMAND:
01557         <span class="keywordflow">switch</span> (LOWORD(wParam)) {
01558         <span class="keywordflow">case</span> IDOK:
01559             <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hwnd, 0);
01560             <span class="keywordflow">break</span>;
01561         <span class="keywordflow">default</span>:
01562             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01563         }
01564         <span class="keywordflow">break</span>;
01565 
01566     <span class="keywordflow">default</span>:
01567         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01568     }
01569 
01570     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01571 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="usrbench.c::InitializeInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL APIENTRY InitializeInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hPrev</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nCmdShow</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">1995</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00608">GetClientRect()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00120">GetDesktopWindow()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00655">GetWindowRect()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00108">ghinst</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndFrame</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndMDIClient</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d3/d0/bench_8h-source.html#l00011">IDNOTE</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00037">IDR_USRBENCH_MENU</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00081">mcs</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01934">MDIChildWndProc()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l01415">RegisterClass</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00180">ShowWindow</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00084">szChild</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00085">szFrame</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03608">UpdateWindow()</a>, and <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00288">WndProc()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>.
<p>
<pre class="fragment"><div>01999 {
02000 
02001     WNDCLASS    wc;
02002     HWND        hWndDesk;
02003     RECT        hwRect;
02004     RECT        rc;
02005 
02006     CLIENTCREATESTRUCT ccs;
02007 
02008     hWndDesk = <a class="code" href="../../d3/d9/client_2wow_8c.html#a4">GetDesktopWindow</a>();
02009     <a class="code" href="../../d3/d9/client_2wow_8c.html#a26">GetWindowRect</a>(hWndDesk,&amp;hwRect);
02010 
02011     <span class="keywordflow">if</span> (!hPrev)
02012     {
02013         wc.hInstance      = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
02014         wc.hCursor        = LoadCursor((HINSTANCE)NULL, IDC_ARROW);
02015         wc.hIcon          = LoadIcon(hInst, MAKEINTRESOURCE(IDR_USRBENCH_MENU));
02016         wc.lpszMenuName   = MAKEINTRESOURCE(IDR_USRBENCH_MENU);
02017         wc.lpszClassName  = <a class="code" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a>;
02018         wc.hbrBackground  = (HBRUSH)GetStockObject(GRAY_BRUSH);
02019         wc.style          = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)0;
02020         wc.lpfnWndProc    = <a class="code" href="../../d0/d5/ntcon_2conime_2conime_8c.html#a12">WndProc</a>;
02021         wc.cbWndExtra     = 0;
02022         wc.cbClsExtra     = 0;
02023 
02024 
02025         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d9/cltxt_8h.html#a7">RegisterClass</a>(&amp;wc)) {
02026             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02027         }
02028     <span class="comment">/*</span>
02029 <span class="comment">     * Register the MDI child class</span>
02030 <span class="comment">     */</span>
02031         wc.lpfnWndProc   = <a class="code" href="../../d9/d1/usrbench_8c.html#a15">MDIChildWndProc</a>;
02032         wc.hIcon         = LoadIcon(ghinst, IDNOTE);
02033         wc.lpszMenuName  = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02034         wc.cbWndExtra    = <span class="keyword">sizeof</span>(HWND);
02035         wc.lpszClassName = <a class="code" href="../../d9/d1/usrbench_8c.html#a11">szChild</a>;
02036 
02037         <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d9/cltxt_8h.html#a7">RegisterClass</a>(&amp;wc))<span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02038 
02039 
02040     }
02041 
02042 
02043     <span class="comment">//</span>
02044     <span class="comment">// Create and show the main Frame window</span>
02045     <span class="comment">//</span>
02046 
02047     <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a> = CreateWindow (szFrame,
02048                             <span class="stringliteral">"USER Call Performance"</span>,
02049                             WS_OVERLAPPEDWINDOW | WS_CLIPCHILDREN,
02050                             0,
02051                             0,
02052                             hwRect.right,
02053                             hwRect.bottom,
02054                             (HWND)NULL,
02055                             (HMENU)NULL,
02056                             (HINSTANCE)hInst,
02057                             (LPSTR)NULL
02058                            );
02059 
02060     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02061         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
02062 
02063     }
02064 
02065     <span class="comment">//</span>
02066     <span class="comment">//  Show the window</span>
02067     <span class="comment">//</span>
02068 
02069     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(ghwndFrame,nCmdShow);
02070     <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>(ghwndFrame);
02071     <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(ghwndFrame);
02072 
02073     <span class="comment">//  Create a Desktop Window inside the Frame Window</span>
02074 
02075     ccs.hWindowMenu = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02076     ccs.idFirstChild = 0;
02077 
02078     <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(ghwndFrame, (LPRECT)&amp;rc);
02079 
02080     <a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> = CreateWindow(<span class="stringliteral">"mdiclient"</span>,
02081                                     <span class="stringliteral">"Desktop"</span>,
02082                                     WS_CHILD | WS_CLIPCHILDREN | WS_VISIBLE | WS_BORDER,
02083                                     rc.left,
02084                                     rc.top+100,
02085                                     rc.right-rc.left,
02086                                     rc.bottom-(rc.top+100),
02087                                     ghwndFrame,
02088                                     (HMENU)0xCAC,
02089                                     ghinst,
02090                                     (LPSTR)&amp;ccs
02091                                   );
02092 
02093     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02094         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
02095     }
02096 
02097     <span class="comment">/*</span>
02098 <span class="comment">     * Create MDI child window for potential use of Userbench tests.</span>
02099 <span class="comment">     */</span>
02100 
02101     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.szClass = <span class="stringliteral">"mdiclient"</span>;
02102     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.szTitle = <span class="stringliteral">"Test Object"</span>;
02103     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.hOwner  = <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>;
02104     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.x = <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.cx = CW_USEDEFAULT;
02105     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.y = <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.cy = CW_USEDEFAULT;
02106     <a class="code" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>.style = WS_OVERLAPPEDWINDOW;
02107 
02108     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndMDIClient, WM_MDICREATE, 0, (LPARAM)&amp;mcs);
02109 
02110     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02111 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="usrbench.c::MDIChildWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT APIENTRY MDIChildWndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01934">1934</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00048">APIENTRY</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00608">GetClientRect()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00108">ghinst</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndMDIClient</a>, <a class="el" href="../../d3/d0/bench_8h-source.html#l00009">GWLP_HWNDEDIT</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00078">ID_EDIT</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>.
<p>
<pre class="fragment"><div>01939 {
01940     HWND hwndEdit;
01941 
01942     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01943     <span class="keywordflow">case</span> WM_MDICREATE:
01944 
01945         <span class="comment">/*</span>
01946 <span class="comment">         * Create an edit control</span>
01947 <span class="comment">         */</span>
01948         hwndEdit = CreateWindow(<span class="stringliteral">"edit"</span>, NULL,
01949                 WS_CHILD | WS_HSCROLL | WS_MAXIMIZE | WS_VISIBLE |
01950                 WS_VSCROLL | ES_AUTOHSCROLL | ES_AUTOVSCROLL | ES_MULTILINE | WS_OVERLAPPEDWINDOW,
01951                 0, 0, 0, 0, ghwndMDIClient, (HMENU)ID_EDIT, ghinst, NULL);
01952 
01953         <span class="comment">/*</span>
01954 <span class="comment">         * Remember the window handle and initialize some window attributes</span>
01955 <span class="comment">         */</span>
01956         <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(hwnd, GWLP_HWNDEDIT, (LONG_PTR)hwndEdit);
01957         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(hwndEdit);
01958         <span class="keywordflow">break</span>;
01959 
01960     <span class="keywordflow">case</span> WM_CLOSE:
01961         <span class="keywordflow">break</span>;
01962 
01963     <span class="keywordflow">case</span> WM_SIZE: {
01964         RECT rc;
01965 
01966         <span class="comment">/*</span>
01967 <span class="comment">         * On creation or resize, size the edit control.</span>
01968 <span class="comment">         */</span>
01969 
01970         hwndEdit = (HWND)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_HWNDEDIT);
01971         <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(hwnd, &amp;rc);
01972         MoveWindow(hwndEdit, rc.left, rc.top,
01973                 rc.right - rc.left, rc.bottom - rc.top, TRUE);
01974         <span class="keywordflow">return</span> DefMDIChildProc(hwnd, msg, wParam, lParam);
01975     }
01976 
01977     <span class="keywordflow">case</span> WM_SETFOCUS:
01978         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>((HWND)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_HWNDEDIT));
01979         <span class="keywordflow">break</span>;
01980 
01981     <span class="keywordflow">default</span>:
01982         <span class="keywordflow">return</span> DefMDIChildProc(hwnd, msg, wParam, lParam);
01983     }
01984 
01985     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01986 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="usrbench.c::ResultsDlgProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR APIENTRY ResultsDlgProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01398">1398</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00140">_TEST_ENTRY::Api</a>, <a class="el" href="../../d8/d4/stats_8h-source.html#l00039">_TEST_STATS::Average</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d8/dlgend_8c-source.html#l00024">EndDialog()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00608">GetClientRect()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00124">gfPentium</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01922">gTestEntry</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00034">IDC_RESULTSLIST</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00035">IDM_SAVERESULTS</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00211">NUM_SAMPLES</a>, <a class="el" href="../../d1/d5/tscroll_8c-source.html#l00037">NUM_TESTS</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01317">SaveResults()</a>, <a class="el" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00221">TestStats</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01403 {
01404     ULONG ix;
01405     <span class="keywordtype">char</span> szT[180];
01406     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fResults;
01407     <span class="keywordtype">int</span> aiT[2];
01408 
01409     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
01410     <span class="keywordflow">case</span> WM_INITDIALOG:
01411         aiT[0] = 100;
01412         aiT[1] = 190;
01413         fResults = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01414 
01415         {
01416             LV_COLUMN lvc;
01417             LV_ITEM lvl;
01418             <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> width;
01419             RECT rc;
01420             HWND hwndList = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hwnd, IDC_RESULTSLIST);
01421             <span class="keywordtype">int</span> i;
01422             <span class="keyword">static</span> LPCSTR title[] = {
01423                 <span class="stringliteral">"Function"</span>, <span class="stringliteral">"Time(100ns)"</span>, <span class="stringliteral">"StdDev%"</span>, <span class="stringliteral">"Best"</span>, <span class="stringliteral">"Worst"</span>,
01424                 <span class="stringliteral">"Valid Samples"</span>, <span class="stringliteral">"Out of"</span>, <span class="stringliteral">"Iterations"</span>,
01425             };
01426 <span class="preprocessor">#ifdef _X86_</span>
01427 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d1/bench_8c.html#a23">gfPentium</a>)
01428                 title[1] = <span class="stringliteral">"Cycle Counts"</span>;
01429 <span class="preprocessor">#endif</span>
01430 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (hwndList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01431                 <span class="keywordflow">break</span>;
01432             <a class="code" href="../../d3/d9/client_2wow_8c.html#a24">GetClientRect</a>(hwndList, &amp;rc);
01433             <span class="comment">// only first column has doubled width</span>
01434             lvc.cx = (width = (rc.right - rc.left) / (<span class="keyword">sizeof</span> title / <span class="keyword">sizeof</span> *title + 1)) * 2;
01435             lvc.mask = LVCF_FMT | LVCF_WIDTH | LVCF_TEXT | LVCF_SUBITEM;
01436             lvc.fmt = LVCFMT_LEFT;
01437             <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span> title / <span class="keyword">sizeof</span> *title; ++i) {
01438                 lvc.pszText = (LPSTR)title[i];
01439                 ListView_InsertColumn(hwndList, i, &amp;lvc);
01440                 lvc.cx = width;     <span class="comment">// normal width</span>
01441             }
01442 
01443             lvl.iItem = 0;
01444             lvl.mask = LVIF_TEXT;
01445             <span class="keywordflow">for</span> (ix = 0; ix &lt; <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; ix++) {
01446                 <span class="keywordflow">if</span> ((<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o0">Average</a>) == 0) {
01447                     <span class="comment">// no measuement, skip</span>
01448                     <span class="keywordflow">continue</span>;
01449                 }
01450                 lvl.iSubItem = 0;
01451                 lvl.pszText = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[ix].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o0">Api</a>;
01452                 ListView_InsertItem(hwndList, &amp;lvl);
01453 <span class="preprocessor">#define SUBITEM(fmt, v) \</span>
01454 <span class="preprocessor">                sprintf(szT, fmt, v); \</span>
01455 <span class="preprocessor">                ListView_SetItemText(hwndList, lvl.iItem, ++lvl.iSubItem, szT);</span>
01456 <span class="preprocessor"></span>
01457                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Average));
01458                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%.2f"</span>, (<span class="keywordtype">float</span>)TestStats[ix].StdDev);
01459                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Minimum_Result));
01460                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Maximum_Result));
01461                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, TestStats[ix].NumSamplesValid);
01462                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, (<span class="keywordtype">long</span>)NUM_SAMPLES);
01463                 <a class="code" href="../../d9/d1/usrbench_8c.html#a1">SUBITEM</a>(<span class="stringliteral">"%ld"</span>, gTestEntry[ix].Iter);
01464 <span class="preprocessor">#undef SUBITEM</span>
01465 <span class="preprocessor"></span>                ++lvl.iItem;
01466                 fResults = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01467             }
01468 
01469             <span class="keywordflow">if</span> (!fResults)
01470                 MessageBox(hwnd, <span class="stringliteral">"No results have been generated yet or Test may have failed!"</span>,
01471                     <span class="stringliteral">"UsrBench"</span>, MB_OK | MB_ICONEXCLAMATION);
01472         }
01473         <span class="keywordflow">break</span>;
01474 
01475     <span class="keywordflow">case</span> WM_COMMAND:
01476         <span class="keywordflow">switch</span> (LOWORD(wParam)) {
01477         <span class="keywordflow">case</span> IDOK:
01478         <span class="keywordflow">case</span> IDCANCEL:
01479             <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hwnd, 0);
01480             <span class="keywordflow">break</span>;
01481 
01482         <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a6">IDM_SAVERESULTS</a>:
01483             <a class="code" href="../../d9/d1/usrbench_8c.html#a19">SaveResults</a>();
01484             <span class="keywordflow">break</span>;
01485 
01486         <span class="keywordflow">default</span>:
01487             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01488         }
01489         <span class="keywordflow">break</span>;
01490 
01491     <span class="keywordflow">default</span>:
01492         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01493     }
01494 
01495     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01496 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="usrbench.c::SaveResults" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SaveResults           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01317">1317</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00242">BatchFlag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndFrame</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00072">hInstMain</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01638">WriteBatchResults()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01398">ResultsDlgProc()</a>.
<p>
<pre class="fragment"><div>01318 {
01319     <span class="keyword">static</span> OPENFILENAME ofn;
01320     <span class="keyword">static</span> <span class="keywordtype">char</span> szFilename[80];
01321     <span class="keywordtype">char</span> szT[80];
01322     <span class="keywordtype">int</span> i, hfile;
01323     FILE *fpOut;
01324 
01325     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01326 
01327     <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(ofn); i++)
01328     {
01329         <span class="comment">//</span>
01330         <span class="comment">// clear out the OPENFILENAME struct</span>
01331         <span class="comment">//</span>
01332 
01333         ((<span class="keywordtype">char</span> *)&amp;ofn)[i] = 0;
01334     }
01335 
01336     ofn.lStructSize = <span class="keyword">sizeof</span>(ofn);
01337     ofn.hwndOwner = <a class="code" href="../../d1/d1/bench_8c.html#a20">ghwndFrame</a>;
01338     ofn.hInstance = <a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>;
01339 
01340     ofn.lpstrFilter = <span class="stringliteral">"USRBench (*.cs;*.km)\0*.cs;*.km\0All Files\0*.*\0\0"</span>;
01341     ofn.lpstrCustomFilter = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01342     ofn.nMaxCustFilter = 0;
01343     ofn.nFilterIndex = 0;
01344     ofn.lpstrFileTitle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01345     ofn.nMaxFileTitle = 0;
01346     ofn.lpstrInitialDir = <span class="stringliteral">"C:\\"</span>;
01347     ofn.Flags = 0;
01348     ofn.lpstrDefExt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01349     ofn.lCustData = 0;
01350     ofn.lpfnHook = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01351     ofn.lpTemplateName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01352 
01353     lstrcpy(szFilename, <span class="stringliteral">"USRB001.km"</span>);
01354 
01355     ofn.lpstrFile = szFilename;
01356     ofn.nMaxFile = <span class="keyword">sizeof</span>(szFilename);
01357     ofn.lpstrTitle = <span class="stringliteral">"Save As"</span>;
01358 
01359     <span class="keywordflow">if</span> (!GetSaveFileName(&amp;ofn))
01360     {
01361         <span class="keywordflow">return</span>;
01362     }
01363 
01364     fpOut = fopen(szFilename, <span class="stringliteral">"w+"</span>);
01365     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != fpOut)
01366     {
01367         <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOut,0,0);
01368         fclose(fpOut);
01369     }
01370     <span class="keywordflow">else</span>
01371     {
01372         MessageBox(ghwndFrame,<span class="stringliteral">"Cannot Open File to Save Results"</span>, <span class="stringliteral">"Output File Creation Error"</span>,MB_ICONSTOP|MB_OK);
01373     }
01374 
01375 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="usrbench.c::SelectOutFileName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* SelectOutFileName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hWnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01590">1590</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d4/d2/dumpuser_8c-source.html#l00043">buf2</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d6/d9/heappage_8c.html#a68">sprintf()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01592 {
01593 
01594     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[11];
01595     <span class="keywordtype">char</span> <a class="code" href="../../d3/d3/dumpuser_8c.html#a12">buf2</a>[4];
01596     FILE *fpFile;
01597     <span class="keywordtype">int</span> i;
01598 
01599     lstrcpy(buf,<span class="stringliteral">"usb"</span>);
01600 
01601     <span class="keywordflow">for</span> (i=1; i&lt;201; i++)   <span class="comment">// Allow for up to 200 output files to exist in current directory</span>
01602     {
01603       <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(&amp;buf[3],<span class="stringliteral">"%03s.log"</span>,_itoa(i,buf2,10));
01604 
01605       fpFile = fopen(&amp;buf[0],<span class="stringliteral">"r"</span>);  <span class="comment">// Try to open for read, if succeeds the file already exists</span>
01606                                     <span class="comment">//                       if fails, thats the next file selected</span>
01607       <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != fpFile)
01608       {
01609         fclose(fpFile);
01610         <span class="keywordflow">continue</span>;
01611       }
01612       <span class="keywordflow">return</span> buf;
01613     }
01614 
01615     MessageBox(hWnd,<span class="stringliteral">"Cannot Continue, Limit of 200 usbxxx.log Output Files Exceeded, Please Clean Up! "</span>, <span class="stringliteral">"Output File Creation Error"</span>,MB_ICONSTOP|MB_OK);
01616     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01617 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="usrbench.c::Std_Parse" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int Std_Parse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>txtbuf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>array</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01886">1886</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01887 {
01888     <span class="keywordtype">int</span> i = 0;
01889     <span class="keywordtype">int</span> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = 0;
01890     <span class="keywordtype">char</span> tst[2];
01891 
01892     array[0] = 0;
01893 
01894     <span class="keywordflow">do</span>
01895     {
01896         sscanf(&amp;txtbuf[n],<span class="stringliteral">"%1c"</span>,tst);
01897 
01898         <span class="keywordflow">if</span>((array[i] != 0)&amp;&amp;((tst[0] == <span class="charliteral">' '</span>)||(tst[0] == <span class="charliteral">','</span>)||(tst[0] == <span class="charliteral">';'</span>)))
01899         {
01900             ++i;
01901             array[i] = 0;
01902         }
01903 
01904         <span class="keywordflow">if</span>(tst[0] == <span class="charliteral">'\n'</span>)
01905         {
01906             ++i;
01907             <span class="keywordflow">break</span>;
01908         }
01909         <span class="keywordflow">while</span>((<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&lt;limit)&amp;&amp;((tst[0] == <span class="charliteral">' '</span>)||(tst[0] == <span class="charliteral">','</span>)||(tst[0] == <span class="charliteral">';'</span>)))
01910         {
01911             ++<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01912             sscanf(&amp;txtbuf[n],<span class="stringliteral">"%1c"</span>,tst);
01913         }
01914         <span class="keywordflow">if</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&gt;=limit)
01915             <span class="keywordflow">break</span>;
01916 
01917         array[i] = 10*array[i] + atoi(tst);
01918         ++<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01919 
01920     }<span class="keywordflow">while</span>(<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>&lt;limit );
01921 
01922     <span class="keywordflow">if</span>(array[i] != 0) ++i;
01923     <span class="keywordflow">return</span> i;
01924 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="usrbench.c::SyncMenuChecks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int SyncMenuChecks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Last_Checked</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>New_Checked</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01859">1859</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d8/d6/menuc_8c-source.html#l00015">CheckMenuItem()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00180">GetMenu()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00350">GetSubMenu()</a>, and <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01860 {
01861     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(hWnd),2),0),0);
01862     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,Last_Checked,MF_BYPOSITION|MF_UNCHECKED);
01863     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,New_Checked,MF_BYPOSITION|MF_CHECKED);
01864     Last_Checked = New_Checked;
01865     <span class="keywordflow">return</span> Last_Checked;
01866 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="usrbench.c::WinMain" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int PASCAL WinMain           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hPrev</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szCmdLine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmdShow</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">103</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00242">BatchFlag</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00147">CMD_IS</a>, <a class="el" href="../../d7/d4/ioep_8h-source.html#l00067">DBGPRINT</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00194">DEFAULT_STRING_LENGTH</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00874">DispatchMessage()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00245">Dont_Close_App</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00040">dwConsoleThreadId</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00244">Finish_Message</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00249">GetMessage()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00070">gfUseCycleCount</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00075">ghaccel</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00108">ghinst</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndFrame</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndMDIClient</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00072">hInstMain</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00045">IDM_HELP</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00252">IniFileName</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00109">InitConsoleIME()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>, <a class="el" href="../../d1/d4/ntcon_2conime_2conime_8c-source.html#l00056">InputExceptionFilter</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00483">PeekMessage()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00248">Print_Detailed</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00043">RUN_BATCH</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00246">SelectedFontTransparent</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00231">SourceStringW</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00247">String_Length_Warn</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00228">StrLen</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00241">TextSuiteFlag</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00452">TranslateAccelerator</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00096">TranslateMDISysAccel()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00885">TranslateMessage()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00112                    :
00113 
00114    Process messages.
00115 
00116 Arguments:
00117 
00118    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>    - window hande
00119    <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>     - <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of message
00120    wParam  - additional information
00121    lParam  - additional information
00122 
00123 Return Value:
00124 
00125    status of operation
00126 
00127 
00128 Revision <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>:
00129 
00130       02-17-91      Initial code
00131 
00132 --*/
00133 
00134 
00135 {
00136     MSG         <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
00137     HWND        hWndDesk;
00138     HWND        hwnd;
00139     HDC hdc2;
00140 
00141     <span class="keywordtype">char</span> txtbuf[80];
00142     <span class="keywordtype">char</span> *ptr;
00143 
00144     <a class="code" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a> =  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00145     <a class="code" href="../../d1/d1/bench_8c.html#a22">ghinst</a>    =  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00146 
00147     <span class="comment">// Initialize Instance, Create Frame Window, Desktop Window and an MDI client Window</span>
00148 
00149     <span class="keywordflow">if</span>(!<a class="code" href="../../d9/d1/usrbench_8c.html#a16">InitializeInstance</a>(hInst, hPrev, cmdShow))
00150         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00151 
00152     <span class="comment">// Initialize Source Strings</span>
00153 
00154     strcpy(SourceString, <span class="stringliteral">"This is just a silly test string. Would you rather have a different one? Well, you can define one if you run GDI bench in batch!"</span>);
00155     wcscpy(SourceStringW, L<span class="stringliteral">"This is just a silly test string. Would you rather have a different one? Well, you can define one if you run GDI bench in batch!"</span>);
00156     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>                  = <a class="code" href="../../d0/d2/usrbench_8h.html#a10">DEFAULT_STRING_LENGTH</a>;
00157 
00158     <span class="comment">//  Batch Mode Related</span>
00159 
00160     <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>           = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00161     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a>               = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00162     <a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00163     <a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00164     <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00165     <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a>      = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00166     <a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a>          = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00167 
00168 <span class="comment">//  GdiSetBatchLimit(1);                // Kills all GDI Batching</span>
00169 
00170 
00171     <span class="comment">// Check for help or batch-mode command-line parameters</span>
00172 
00173 
00174     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-?"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/?"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-h"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-H"</span>) ||<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/h"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/H"</span>))
00175     {
00176         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndFrame,WM_COMMAND,IDM_HELP,0L);       <span class="comment">// Show Help Dialog</span>
00177     }
00178 
00179     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-b"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-B"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/b"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/B"</span>))
00180     {
00181         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00182         GetCurrentDirectory(<span class="keyword">sizeof</span>(IniFileName),IniFileName);  <span class="comment">// Prepare INI file path, append name later</span>
00183         strcat(IniFileName,<span class="stringliteral">"\\"</span>);
00184     }
00185 
00186     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-m"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-M"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/m"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/M"</span>))
00187         <a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00188 
00189     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-s"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-S"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/s"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/S"</span>))
00190         <a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00191 
00192     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-t"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-T"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/t"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/T"</span>))
00193         <a class="code" href="../../d9/d1/usrbench_8c.html#a5">gfUseCycleCount</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00194 
00195     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-d"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-D"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/d"</span>) || <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/D"</span>))
00196         <a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00197 
00198 
00199     <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-i"</span>))
00200     {
00201         ptr = strstr(szCmdLine, <span class="stringliteral">"-i"</span>);
00202         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00203         strcat(IniFileName,txtbuf);
00204     }
00205     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"-I"</span>))
00206     {
00207         ptr = strstr(szCmdLine, <span class="stringliteral">"-I"</span>);
00208         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00209         strcat(IniFileName,txtbuf);
00210     }
00211     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/i"</span>))
00212     {
00213         ptr = strstr(szCmdLine, <span class="stringliteral">"/i"</span>);
00214         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00215         strcat(IniFileName,txtbuf);
00216     }
00217     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d2/usrbench_8h.html#a0">CMD_IS</a>(<span class="stringliteral">"/I"</span>))
00218     {
00219         ptr = strstr(szCmdLine, <span class="stringliteral">"/I"</span>);
00220         sscanf(ptr+2,<span class="stringliteral">"%s"</span>,txtbuf);
00221         strcat(IniFileName,txtbuf);
00222     }
00223     <span class="keywordflow">else</span>
00224     {
00225         strcat(IniFileName,<span class="stringliteral">"USRBATCH.INI"</span>);
00226     }
00227 
00228     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00229         <span class="comment">/*</span>
00230 <span class="comment">         * Suck any messages out of the queue before starting to avoid</span>
00231 <span class="comment">         * contaminating our results.</span>
00232 <span class="comment">         */</span>
00233         <span class="keywordflow">while</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a14">PeekMessage</a>(&amp;msg,NULL,0,0,PM_REMOVE))
00234         {
00235             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;msg);
00236             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;msg);
00237         }
00238 
00239         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndFrame,WM_COMMAND,RUN_BATCH,0L);      <span class="comment">// Start Batch</span>
00240     }
00241 
00242     <span class="comment">//</span>
00243     <span class="comment">// Main message loop</span>
00244     <span class="comment">//</span>
00245 
00246     <span class="keywordflow">while</span> (<a class="code" href="../../d0/d8/ntcftxt_8h.html#a16">GetMessage</a>(&amp;msg,(HWND)NULL,0,0))
00247     {
00248         <span class="comment">/*</span>
00249 <span class="comment">         * If a keyboard message is for the MDI, let the MDI client</span>
00250 <span class="comment">         * take care of it.  Otherwise, check to see if it's a normal</span>
00251 <span class="comment">         * accelerator key (like F3 = find next).  Otherwise, just handle</span>
00252 <span class="comment">         * the message as usual.</span>
00253 <span class="comment">         */</span>
00254         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d5/mdiwin_8c.html#a8">TranslateMDISysAccel</a>(ghwndMDIClient, &amp;msg) &amp;&amp;
00255                 !<a class="code" href="../../d3/d0/user32_8def.html#a57">TranslateAccelerator</a>(ghwndFrame, ghaccel, &amp;msg)) {
00256             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;msg);
00257             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;msg);
00258         }
00259 
00260     }
00261 
00262   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam;
00263 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="usrbench.c::WndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT FAR PASCAL WndProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>unsigned&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">268</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00198">ALL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l01734">AppendMenu()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00243">BatchCycle</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00242">BatchFlag</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00327">BeginPaint</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00087">cf</a>, <a class="el" href="../../d8/d6/menuc_8c-source.html#l00015">CheckMenuItem()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00195">DEFAULT_A_STRING</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00232">DestString</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00233">DestStringW</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00222">Detailed_Data</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00245">Dont_Close_App</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l00061">FillRect()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00244">Finish_Message</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00191">FIRST_TEXT_FUNCTION</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00250">fpIniFile</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00251">fpOutFile</a>, <a class="el" href="../../d7/d4/stats_8c-source.html#l00061">Get_Stats()</a>, <a class="el" href="../../d4/d3/w32_2ntuser_2client_2nt6_2pch_8h-source.html#l00021">GetDC</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00180">GetMenu()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00350">GetSubMenu()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00305">GetWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00107">ghwndMDIClient</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01922">gTestEntry</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01500">HelpDlgProc()</a>, <a class="el" href="../../d8/d4/stats_8h-source.html#l00027">HI_FILTER</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00072">hInstMain</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00110">hWnd</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00058">ID_TEST_START</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00033">IDD_HELP</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00032">IDD_RESULTS</a>, <a class="el" href="../../d7/d7/aug98_2test_2main_8h-source.html#l00020">IDM_EXIT</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00056">IDM_FONT</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00045">IDM_HELP</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00041">IDM_QRUN1</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00042">IDM_QRUN2</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00040">IDM_RUN</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00047">IDM_S001</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00048">IDM_S002</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00049">IDM_S004</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00050">IDM_S008</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00051">IDM_S016</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00052">IDM_S032</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00053">IDM_S064</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00054">IDM_S128</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00036">IDM_SHOW</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00057">IDM_TRANSPARENT</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00252">IniFileName</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00142">_TEST_ENTRY::Iter</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00192">LAST_TEXT_FUNCTION</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00098">lf</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00081">mcs</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00210">NUM_QTESTS</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00211">NUM_SAMPLES</a>, <a class="el" href="../../d1/d5/tscroll_8c-source.html#l00037">NUM_TESTS</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00253">OutFileName</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00224">PerformanceFreq</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00141">_TEST_ENTRY::pfn</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00136">PFN_MS</a>, <a class="el" href="../../d8/d5/font_8h-source.html#l00053">POINTS_PER_INCH</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03387">PostQuitMessage()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00066">pszTest</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00067">pwszTest</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00199">QUICK</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01052">ReleaseDC()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00143">_TEST_ENTRY::Result</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01398">ResultsDlgProc()</a>, <a class="el" href="../../d4/d8/ntuser_2tools_2usrbench_2resource_8h-source.html#l00043">RUN_BATCH</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00201">SELECT</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00246">SelectedFontTransparent</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01590">SelectOutFileName()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03531">ShowCursor()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00231">SourceStringW</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01886">Std_Parse()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00247">String_Length_Warn</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00449">StringLength()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00228">StrLen</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d7/d5/ttime_8c-source.html#l00044">Sum</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01859">SyncMenuChecks()</a>, <a class="el" href="../../d0/d6/ttseacc_8c-source.html#l00040">Test()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00221">TestStats</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00200">TEXT_SUITE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00241">TextSuiteFlag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00213">VAR_LIMIT</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01638">WriteBatchResults()</a>.
<p>
<pre class="fragment"><div>00276                    :
00277 
00278    Process messages.
00279 
00280 Arguments:
00281 
00282    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>    - window hande
00283    <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>     - <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of message
00284    wParam  - additional information
00285    lParam  - additional information
00286 
00287 Return Value:
00288 
00289    status of operation
00290 
00291 
00292 Revision <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>:
00293 
00294       02-17-91      Initial code
00295 
00296 --*/
00297 
00298 {
00299 
00300     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00301     UCHAR tmsg[256];
00302     <span class="keywordtype">int</span> MBresult;
00303     <span class="keywordtype">char</span> txtbuf[80];
00304     <span class="keywordtype">char</span> strbuf[256];
00305     <span class="keywordtype">char</span> tmpbuf[5][20];
00306     <span class="keywordtype">int</span> i,j,k,<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
00307     <span class="keywordtype">char</span> *kptr;
00308     <span class="keywordtype">char</span> TestTypeEntry[16];
00309     <span class="keywordtype">int</span> TestType;
00310     <span class="keywordtype">int</span> Num_Selected_Tests;
00311     <span class="keywordtype">int</span> Test_Item[25];
00312     <span class="keywordtype">char</span> SelectedFont[32];
00313     <span class="keywordtype">int</span>  SelectedFontSize       = 12;
00314     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontBold       = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00315     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontItalic     = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00316     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontUnderline  = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00317     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> SelectedFontStrike     = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00318     COLORREF SelectedFontColor  = RGB(0,0,0);
00319     <span class="keywordtype">char</span> tst[2];
00320     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> FontRed, FontGreen, FontBlue;
00321     <span class="keywordtype">char</span> TextString[256];
00322     <span class="keywordtype">int</span> No_String_Lengths, No_Font_Sizes;
00323     <span class="keywordtype">int</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[16], FontSize[16];
00324     <span class="keywordtype">int</span> Source_String_Length;
00325     <span class="keywordtype">int</span> Text_Test_Order[16];
00326     <span class="keywordtype">int</span> VPixelsPerLogInch;
00327     <span class="keyword">static</span> <span class="keywordtype">int</span> Last_Checked = 5;
00328 
00329     <span class="keywordtype">double</span> <a class="code" href="../../d6/d6/ttime_8c.html#a12">Sum</a>;
00330     <span class="keywordtype">double</span> Sample[<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>];
00331 
00332     <span class="keyword">static</span> HDC hdc2;          <span class="comment">/* display DC handle            */</span>
00333     <span class="keyword">static</span> HFONT hfont;       <span class="comment">/* new logical font handle      */</span>
00334     <span class="keyword">static</span> HFONT hfontOld;    <span class="comment">/* original logical font handle */</span>
00335     <span class="keyword">static</span> COLORREF crOld;    <span class="comment">/* original text color          */</span>
00336 
00337 
00338     <span class="keywordflow">switch</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>) {
00339 
00340     <span class="keywordflow">case</span> WM_CREATE:
00341     {
00342         ULONG ix;
00343         HWND hwnd;
00344         HMENU hAdd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(hWnd),1);
00345         HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(hWnd),2),0),0);
00346 
00347         <span class="keywordflow">for</span> (ix=0;ix&lt;<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;ix++)
00348         {
00349 
00350             <span class="keywordflow">if</span> ((ix &gt; 0) &amp;&amp; ((ix % 20) == 0))
00351             {
00352                 <a class="code" href="../../d5/d9/cltxt_8h.html#a33">AppendMenu</a>(hAdd, MF_MENUBARBREAK | MF_SEPARATOR,0,0);
00353             }
00354 
00355             wsprintf(tmsg,<span class="stringliteral">"T%i: %s"</span>,ix,gTestEntry[ix].Api);
00356             <a class="code" href="../../d5/d9/cltxt_8h.html#a33">AppendMenu</a>(hAdd, MF_STRING | MF_ENABLED, ID_TEST_START + ix, tmsg);
00357         }
00358 
00359         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,5,MF_BYPOSITION|MF_CHECKED);
00360 
00361     }
00362     <span class="keywordflow">break</span>;
00363     <span class="keywordflow">case</span> WM_COMMAND:
00364     {
00365 
00366             <span class="keywordflow">switch</span> (LOWORD(wParam)){
00367             <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>:
00368             {
00369                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_CLOSE,0,0L);
00370             }
00371              <span class="keywordflow">break</span>;
00372 
00373             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a7">IDM_SHOW</a>:
00374                 DialogBox(hInstMain, (LPSTR)IDD_RESULTS, hWnd, ResultsDlgProc);
00375                 <span class="keywordflow">break</span>;
00376 
00377             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a15">IDM_HELP</a>:
00378                 DialogBox(hInstMain, (LPSTR)IDD_HELP, hWnd, HelpDlgProc);
00379                 <span class="keywordflow">break</span>;
00380 
00381 <span class="comment">//</span>
00382 <span class="comment">// Choose and Set Text String Length</span>
00383 <span class="comment">//</span>
00384 
00385             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a17">IDM_S001</a>:
00386                 {
00387                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 1;
00388                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 0);
00389                 }
00390                 <span class="keywordflow">break</span>;
00391 
00392             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a18">IDM_S002</a>:
00393                 {
00394                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 2;
00395                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 1);
00396 
00397                 }
00398                 <span class="keywordflow">break</span>;
00399 
00400             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a19">IDM_S004</a>:
00401                 {
00402                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 4;
00403                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 2);
00404 
00405                 }
00406                 <span class="keywordflow">break</span>;
00407 
00408             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a20">IDM_S008</a>:
00409                 {
00410                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 8;
00411                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 3);
00412 
00413                 }
00414                 <span class="keywordflow">break</span>;
00415 
00416             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a21">IDM_S016</a>:
00417                 {
00418                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 16;
00419                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 4);
00420 
00421                 }
00422                 <span class="keywordflow">break</span>;
00423 
00424             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a22">IDM_S032</a>:
00425                 {
00426                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 32;
00427                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 5);
00428 
00429                 }
00430                 <span class="keywordflow">break</span>;
00431 
00432             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a23">IDM_S064</a>:
00433                 {
00434                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 64;
00435                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 6);
00436 
00437                 }
00438                 <span class="keywordflow">break</span>;
00439 
00440             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a24">IDM_S128</a>:
00441                 {
00442                     <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = 128;
00443                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, 7);
00444 
00445                 }
00446                 <span class="keywordflow">break</span>;
00447 
00448 <span class="comment">//            case IDM_SXXX:</span>
00449 <span class="comment">//</span>
00450 <span class="comment">//            break;</span>
00451 
00452             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a27">IDM_TRANSPARENT</a>:
00453                 {
00454                     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(hWnd),2),0);
00455                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00456                     {
00457                         <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00458                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_UNCHECKED);
00459                     }
00460                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)
00461                     {
00462                         <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00463                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_CHECKED);
00464                     }
00465                 }
00466                 <span class="keywordflow">break</span>;
00467 
00468 
00469             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a26">IDM_FONT</a>:         <span class="comment">// Invoke the ChooseFont Dialog (interactive mode)</span>
00470                 {
00471         <span class="comment">/* Initialize the necessary members */</span>
00472 
00473                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lStructSize = <span class="keyword">sizeof</span> (CHOOSEFONT);
00474                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00475                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont = &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
00476                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS | CF_INITTOLOGFONTSTRUCT;
00477                     <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.nFontType = SCREEN_FONTTYPE;
00478 <span class="comment">/*</span>
00479 <span class="comment"> * Display the dialog box, allow the user to</span>
00480 <span class="comment"> * choose a font, and render the text in the</span>
00481 <span class="comment"> * window with that selection.</span>
00482 <span class="comment"> */</span>
00483                     <span class="keywordflow">if</span> (ChooseFont(&amp;cf)){
00484                         hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00485                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00486                         hfontOld = SelectObject(hdc2, hfont);
00487                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00488 
00489                     }
00490 
00491                 }
00492                 <span class="keywordflow">break</span>;
00493 
00494             <span class="comment">//</span>
00495             <span class="comment">// Run all tests</span>
00496             <span class="comment">//</span>
00497 
00498             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a10">IDM_RUN</a>:               <span class="comment">// Run all tests</span>
00499                 {
00500                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00501                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00502                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00503                     RECT CliRect = {20,20,500,40};
00504 
00505                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(ghwndMDIClient,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00506                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndMDIClient, WM_MDICREATE, 0, (LPARAM)&amp;mcs); <span class="comment">//Create Test Object</span>
00507 
00508                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>&lt;<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00509                     {
00510                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00511 
00512                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00513                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,gTestEntry[Index].Api);
00514                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00515                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00516                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(FALSE);
00517 
00518                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00519                         hfontOld = SelectObject(hdc2, hfont);
00520                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00521                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00522 
00524 
00525                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00526                         {
00527 
00528                             GdiFlush();
00529 
00530                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00531                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00532                         }
00533 
00534                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,NUM_SAMPLES,HI_FILTER,VAR_LIMIT,&amp;TestStats[Index]);
00536 
00537                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(TRUE);
00538 
00539                         SetTextColor(hdc, crOld);
00540                         SelectObject(hdc, hfontOld);
00541                         DeleteObject(hfont);
00542                         SetBkMode(hdc2,OPAQUE);
00543 
00544                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc2);
00545                     }
00546 
00547                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc);
00548                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00549                         DialogBox(hInstMain, (LPSTR)IDD_RESULTS, hWnd, ResultsDlgProc);
00550                 }
00551                 <span class="keywordflow">break</span>;
00552 
00553             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a11">IDM_QRUN1</a>:             <span class="comment">// Run the quick test suite 1</span>
00554                 {
00555                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00556                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00557                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00558                     RECT CliRect = {20,20,500,40};
00559 
00560 
00561                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(ghwndMDIClient,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00562                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndMDIClient, WM_MDICREATE, 0, (LPARAM)&amp;mcs); <span class="comment">//Create Test Object</span>
00563 
00564                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a19">NUM_QTESTS</a>;<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00565                     {
00566                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00567 
00568                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00569                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,gTestEntry[Index].Api);
00570                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00571                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00572                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(FALSE);
00573 
00574                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00575                         hfontOld = SelectObject(hdc2, hfont);
00576                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00577                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00578 
00580 
00581                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00582                         {
00583 
00584                             GdiFlush();
00585 
00586                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00587                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00588                         }
00589 
00590                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,NUM_SAMPLES,HI_FILTER,VAR_LIMIT,&amp;TestStats[Index]);
00592 
00593 
00594                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(TRUE);
00595 
00596                         SetTextColor(hdc, crOld);
00597                         SelectObject(hdc, hfontOld);
00598                         DeleteObject(hfont);
00599                         SetBkMode(hdc2,OPAQUE);
00600                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc2);
00601                     }
00602 
00603                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc);
00604 
00605                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00606                         DialogBox(hInstMain, (LPSTR)IDD_RESULTS, hWnd, ResultsDlgProc);
00607                 }
00608                 <span class="keywordflow">break</span>;
00609 
00610             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a12">IDM_QRUN2</a>:         <span class="comment">// Run Quick Test Suite 2</span>
00611                 {
00612                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00613                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
00614                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00615                     RECT CliRect = {20,20,500,40};
00616 
00617                     <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00618 
00619                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(ghwndMDIClient,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
00620                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndMDIClient, WM_MDICREATE, 0, (LPARAM)&amp;mcs); <span class="comment">//Create Test Object</span>
00621 
00622                     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a8">FIRST_TEXT_FUNCTION</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt;= <a class="code" href="../../d0/d2/usrbench_8h.html#a9">LAST_TEXT_FUNCTION</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00623                     {
00624                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00625 
00626                         <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
00627                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,gTestEntry[Index].Api);
00628                         TextOut(hdc2,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
00629                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
00630                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(FALSE);
00631 
00632                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
00633                         hfontOld = SelectObject(hdc2, hfont);
00634                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
00635                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
00637 
00638                         <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
00639                         {
00640 
00641                             GdiFlush();
00642 
00643                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
00644                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
00645 
00646                         }
00647 
00648                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,NUM_SAMPLES,HI_FILTER,VAR_LIMIT,&amp;TestStats[Index]);
00650 
00651                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(TRUE);
00652                         SetTextColor(hdc, crOld);
00653                         SelectObject(hdc, hfontOld);
00654                         DeleteObject(hfont);
00655                         SetBkMode(hdc2,OPAQUE);
00656 
00657                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc2);
00658 
00659                     }
00660 
00661                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc);
00662 
00663                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00664                         DialogBox(hInstMain, (LPSTR)IDD_RESULTS, hWnd, ResultsDlgProc);
00665 
00666                 }
00667                 <span class="keywordflow">break</span>;
00668 
00669 <span class="comment">//</span>
00670 <span class="comment">// Run in Batch Mode</span>
00671 <span class="comment">//</span>
00672             <span class="keywordflow">case</span> <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a13">RUN_BATCH</a>:
00673                 {
00674                     <a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a> = fopen(IniFileName,<span class="stringliteral">"r"</span>);
00675                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a47">fpIniFile</a>)
00676                     {
00677                         MessageBox(hWnd,<span class="stringliteral">"USRBATCH.INI File Not Found, Cannot Continue in Batch Mode"</span>,<span class="stringliteral">"INI File Not Found"</span>,MB_ICONSTOP|MB_OK);
00678                         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00679                         <span class="keywordflow">break</span>;
00680                     }
00681                     <span class="keywordflow">else</span>                    <span class="comment">//Start reading INI file Keys</span>
00682 
00683                     {
00684                         <span class="keywordflow">if</span>(!GetPrivateProfileString(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"TEXT"</span>,TestTypeEntry,<span class="keyword">sizeof</span>(TestTypeEntry),IniFileName))
00685                         {
00686                             MessageBox(hWnd,<span class="stringliteral">"Invalid Caption 1 in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00687                             <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00688                             <span class="keywordflow">break</span>;
00689                         }
00690 
00691                         <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a> = GetPrivateProfileInt(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"CYCLE"</span>,1,IniFileName);
00692 
00693                         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"ALL"</span>))
00694                         {
00695                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a13">ALL</a>;
00696                         }
00697                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"QUICK"</span>))
00698                         {
00699                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a14">QUICK</a>;
00700                         }
00701                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"TEXT"</span>))
00702                         {
00703                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a>;
00704                         }
00705                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(TestTypeEntry, <span class="stringliteral">"SELECT"</span>))
00706                         {
00707                             TestType = <a class="code" href="../../d0/d2/usrbench_8h.html#a16">SELECT</a>;
00708                         }
00709                         <span class="keywordflow">else</span>
00710                         {
00711                             MessageBox(hWnd,<span class="stringliteral">"Invalid or No Test-Type Entry in USRBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00712                             <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00713                             <span class="keywordflow">break</span>;
00714                         }
00715 
00716                         <span class="keywordflow">switch</span> (TestType)
00717                         {
00718                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a13">ALL</a>:                   <span class="comment">// Run all tests</span>
00719                             {
00720                                 fclose(fpIniFile);
00721                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(hWnd);
00722                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
00723                                 {
00724                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00725                                     <span class="keywordflow">break</span>;
00726                                 }
00727                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(OutFileName, <span class="stringliteral">"w+"</span>);
00728 
00729                                 <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; i++)
00730                                 {
00731                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_RUN,0L);
00732                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOutFile, TestType, i+1);
00733                                 }
00734 
00735                                 fclose(fpOutFile);
00736 
00737                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00738                                 {
00739                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
00740                                     strcat(txtbuf,OutFileName);
00741                                     MessageBox(hWnd,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
00742                                 }
00743 
00744                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00745                                 {
00746                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00747                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
00748                                     {
00749                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
00750                                     }
00751                                 }
00752                                 <span class="keywordflow">else</span>
00753                                 {
00754                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_EXIT,0L);
00755                                 }
00756 
00757                             }
00758 
00759                             <span class="keywordflow">break</span>;
00760 
00761                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a14">QUICK</a>:                 <span class="comment">// Run the quick suite</span>
00762                             {
00763                                 fclose(fpIniFile);
00764 
00765                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(hWnd);
00766 
00767                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(OutFileName, <span class="stringliteral">"w+"</span>);
00768                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a>)
00769                                 {
00770                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00771                                     <span class="keywordflow">break</span>;
00772                                 }
00773 
00774                                 <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; i++)
00775                                 {
00776                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_QRUN1,0L);
00777                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOutFile, TestType, i+1);
00778                                 }
00779 
00780                                 fclose(fpOutFile);
00781 
00782                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00783                                 {
00784                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
00785                                     strcat(txtbuf,OutFileName);
00786                                     MessageBox(hWnd,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
00787                                 }
00788 
00789                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00790                                 {
00791                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00792                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
00793                                     {
00794                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
00795                                     }
00796                                 }
00797                                 <span class="keywordflow">else</span>
00798                                 {
00799                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_EXIT,0L);
00800                                 }
00801 
00802                             }
00803                             <span class="keywordflow">break</span>;
00804 
00805                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a>:                    <span class="comment">// Get some more keys then run the text suite</span>
00806                             {
00807 
00808                                 <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = GetPrivateProfileString(<span class="stringliteral">"TEXT"</span>,<span class="stringliteral">"FONT"</span>,<span class="stringliteral">"Arial"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),IniFileName);
00809 
00810                                 i = 0;
00811 
00812                                 <span class="keywordflow">do</span>
00813                                 {
00814                                     sscanf(&amp;txtbuf[i],<span class="stringliteral">"%1c"</span>,tst);
00815                                     ++i;
00816                                 }
00817                                 <span class="keywordflow">while</span>((i &lt;= <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> ) &amp;&amp; (tst[0] != <span class="charliteral">','</span>) &amp;&amp; (tst[0] != <span class="charliteral">';'</span>));
00818 
00819                                 strncpy(&amp;SelectedFont[0],&amp;txtbuf[0],i-1);
00820                                 strcpy(&amp;SelectedFont[i-1],<span class="stringliteral">"\0"</span>);
00821 
00822                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"BOLD"</span>))
00823                                 {
00824                                     SelectedFontBold = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00825                                 }
00826 
00827                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"ITALIC"</span>))
00828                                 {
00829                                     SelectedFontItalic = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00830                                 }
00831 
00832                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"UNDERLINE"</span>))
00833                                 {
00834                                     SelectedFontUnderline = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00835                                 }
00836 
00837                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"STRIKE"</span>))
00838                                 {
00839                                     SelectedFontStrike = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00840                                 }
00841 
00842                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != strstr(&amp;txtbuf[i], <span class="stringliteral">"TRANSPARENT"</span>))
00843                                 {
00844                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00845                                 }
00846 
00847                                 kptr = strstr(&amp;txtbuf[0], <span class="stringliteral">"RGB("</span>);   <span class="comment">// Parse and interpret the RGB values if exist</span>
00848                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != kptr)
00849                                 {
00850                                     sscanf(kptr+4,<span class="stringliteral">"%s"</span>,tmpbuf[0]);
00851 
00852                                     FontRed     = 0;
00853                                     FontGreen   = 0;
00854                                     FontBlue    = 0;
00855 
00856                                     j = 0;
00857 
00858                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00859 
00860                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00861                                     {
00862                                         ++j;
00863                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00864                                     }
00865                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">','</span>)
00866                                     {
00867                                         FontRed = 10*FontRed + atoi(tst);
00868                                         ++j;
00869                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00870                                     }
00871 
00872                                     ++j;
00873                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00874                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00875                                     {
00876                                         ++j;
00877                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00878                                     }
00879                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">','</span>)
00880                                     {
00881                                         FontGreen = 10*FontGreen + atoi(tst);
00882                                         ++j;
00883                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00884                                     }
00885 
00886                                     ++j;
00887                                     sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00888                                     <span class="keywordflow">while</span>(tst[0] == <span class="charliteral">' '</span>)
00889                                     {
00890                                         ++j;
00891                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00892                                     }
00893                                     <span class="keywordflow">while</span>(tst[0] != <span class="charliteral">')'</span>)
00894                                     {
00895                                         FontBlue = 10*FontBlue + atoi(tst);
00896                                         ++j;
00897                                         sscanf(&amp;tmpbuf[0][j],<span class="stringliteral">"%1c"</span>,tst);
00898                                         <span class="keywordflow">if</span>(tst[0] == <span class="charliteral">' '</span>)<span class="keywordflow">break</span>;
00899                                     }
00900 
00901                                     SelectedFontColor = RGB(FontRed, FontGreen, FontBlue);
00902                                 }
00903 
00904                                 k = GetPrivateProfileString(<span class="stringliteral">"TEXT"</span>,<span class="stringliteral">"STRING_CONTENT"</span>,DEFAULT_A_STRING,strbuf,<span class="keyword">sizeof</span>(strbuf),IniFileName);
00905 
00906                                 strncpy(SourceString,strbuf,(size_t)k);
00907                                 Source_String_Length = k;
00908 
00909                                 MultiByteToWideChar(CP_ACP|CP_OEMCP,0,SourceString,-1,SourceStringW,<span class="keyword">sizeof</span>(SourceStringW));
00910 
00911                                 <span class="keywordflow">for</span>(j=0; j&lt;2; j++)
00912                                     Text_Test_Order[j] = 0;
00913 
00914                                 GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"ORDER"</span>,<span class="stringliteral">"FONT_SIZE, STRING_LENGTH"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),IniFileName);
00915                                 <span class="keywordflow">if</span>(strstr(txtbuf,<span class="stringliteral">"STRING_LENGTH"</span>) &gt; strstr(txtbuf,<span class="stringliteral">"FONT_SIZE"</span>))
00916                                 {
00917                                     Text_Test_Order[0] = 1;
00918                                     Text_Test_Order[1] = 2;
00919                                 }
00920                                 <span class="keywordflow">else</span>
00921                                 {
00922                                     Text_Test_Order[0] = 2;
00923                                     Text_Test_Order[1] = 1;
00924                                 }
00925 
00926                                 k = GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"STRING_LENGTH"</span>,<span class="stringliteral">"32"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),IniFileName);
00927                                 No_String_Lengths = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, StringLength);
00928 
00929                                 <span class="keywordflow">if</span>(No_String_Lengths==0)
00930                                 {
00931                                     MessageBox(hWnd,<span class="stringliteral">"Invalid or No String Length Entry in GDIBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00932                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00933                                     <span class="keywordflow">break</span>;
00934                                 }
00935 
00936                                 k = GetPrivateProfileString(<span class="stringliteral">"RUN"</span>,<span class="stringliteral">"FONT_SIZE"</span>,<span class="stringliteral">"10"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),IniFileName);
00937                                 No_Font_Sizes = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, FontSize);
00938 
00939                                 <span class="keywordflow">if</span>(No_Font_Sizes==0)
00940                                 {
00941                                     MessageBox(hWnd,<span class="stringliteral">"Invalid or No Font Size Entry in GDIBATCH.INI File"</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
00942                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00943                                     <span class="keywordflow">break</span>;
00944                                 }
00945 
00946                                 fclose(fpIniFile);
00947 
00948     <span class="comment">// Initialize the LOGFONT struct</span>
00949 
00950                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWidth          = 0;
00951                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfEscapement     = 0;
00952                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfOrientation    = 0;
00953                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWeight         = (SelectedFontBold == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)? 400 : 700;
00954                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfItalic         = SelectedFontItalic;
00955                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfUnderline      = SelectedFontUnderline;
00956                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfStrikeOut      = SelectedFontStrike;
00957                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfCharSet        = ANSI_CHARSET;
00958                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfOutPrecision   = OUT_DEFAULT_PRECIS;
00959                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfClipPrecision  = CLIP_DEFAULT_PRECIS;
00960                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfQuality        = DEFAULT_QUALITY;
00961                                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfPitchAndFamily = DEFAULT_PITCH | FF_DONTCARE;
00962                                 lstrcpy(&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0],&amp;SelectedFont[0]);
00963 
00964     <span class="comment">// Get some necessary font information for the present screen to be able to determine its height</span>
00965 
00966                                 hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
00967                                 GetTextFace(hdc2, <span class="keyword">sizeof</span>(SelectedFont), &amp;SelectedFont[0]);
00968                                 VPixelsPerLogInch = GetDeviceCaps(hdc2, LOGPIXELSY);
00969                                 <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc2);
00970 
00971     <span class="comment">// Some more font initialization</span>
00972 
00973                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lStructSize      = <span class="keyword">sizeof</span> (CHOOSEFONT);
00974                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.hwndOwner        = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00975                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont        = &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
00976                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.Flags            = CF_SCREENFONTS | CF_EFFECTS | CF_INITTOLOGFONTSTRUCT;
00977                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.nFontType        = SCREEN_FONTTYPE;
00978                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors        = SelectedFontColor;
00979 
00980     <span class="comment">// Auto Select an output file name</span>
00981 
00982                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(hWnd);
00983                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(OutFileName, <span class="stringliteral">"w+"</span>);
00984                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
00985                                 {
00986                                     MessageBox(hWnd,<span class="stringliteral">"Could not Open an Output File, Batch Mode Halted"</span>, <span class="stringliteral">"Output Open File Error"</span>,MB_ICONSTOP|MB_OK);
00987                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00988                                     <span class="keywordflow">break</span>;
00989                                 }
00990 
00991     <span class="comment">// Execute Text Suite, Depending on the Predefined Order of Loops</span>
00992 
00993                                 <span class="keywordflow">if</span>(Text_Test_Order[1] == 1)
00994                                 {
00995 
00996                                     <span class="keywordflow">for</span>(i = 0; i &lt; No_String_Lengths; i++)
00997                                     {
00998                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[i];
00999                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a> = (<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> &lt;= (size_t)Source_String_Length)? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01000                                         strcpy(&amp;DestString[StrLen],<span class="stringliteral">"\0"</span>);
01001                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(&amp;DestString[0], SourceString, StrLen);
01002                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(&amp;DestStringW[0], SourceStringW, StrLen);
01003 
01004                                         <span class="keywordflow">for</span>(j = 0; j &lt; No_Font_Sizes; j++)
01005                                         {
01006                                             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfHeight = -MulDiv(FontSize[j], VPixelsPerLogInch, POINTS_PER_INCH);
01007                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize = 10*FontSize[j];  <span class="comment">// Point Size is in 1/10 of a point</span>
01008 
01009                                             <span class="keywordflow">for</span>(k=0; k &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; k++)
01010                                             {
01011                                                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_QRUN2,0L);
01012                                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOutFile, TestType, k+1);
01013                                             }
01014 
01015                                         }
01016 
01017                                     }
01018 
01019                                 }               <span class="comment">//endif</span>
01020 
01021                                 <span class="keywordflow">else</span>
01022                                 {
01023 
01024                                     <span class="keywordflow">for</span>(i = 0; i &lt; No_Font_Sizes; i++)
01025                                     {
01026 
01027                                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfHeight = -MulDiv(FontSize[i], VPixelsPerLogInch, POINTS_PER_INCH);
01028                                         <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize = 10*FontSize[i];  <span class="comment">// Point Size is in 1/10 of a point</span>
01029 
01030                                         <span class="keywordflow">for</span>(j = 0; j &lt; No_String_Lengths; j++)
01031                                         {
01032                                             <a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1158">StringLength</a>[j];
01033                                             <a class="code" href="../../d0/d2/usrbench_8h.html#a45">String_Length_Warn</a> = (<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> &lt;= (size_t)Source_String_Length)? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01034                                             strcpy(&amp;DestString[StrLen],<span class="stringliteral">"\0"</span>);
01035                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(&amp;DestString[0], SourceString, StrLen);
01036                                             <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(&amp;DestStringW[0], SourceStringW, StrLen);
01037 
01038                                             <span class="keywordflow">for</span>(k=0; k &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; k++)
01039                                             {
01040                                                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_QRUN2,0L);
01041                                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOutFile, TestType, k+1);
01042                                             }
01043 
01044                                         }
01045 
01046                                     }
01047 
01048                                 }                <span class="comment">//else</span>
01049 
01050     <span class="comment">// Cleanup</span>
01051                                 fclose(fpOutFile);
01052 
01053                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01054                                 {
01055                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
01056                                     strcat(txtbuf,OutFileName);
01057                                     MessageBox(hWnd,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
01058                                 }
01059 
01060                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)<span class="comment">// App Stays Open, Check Appropriate Menu Items for Last Selection</span>
01061                                 {
01062                                     HMENU hmenu = <a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a14">GetSubMenu</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(hWnd),2),0);
01063                                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01064                                     {
01065                                         <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>(hmenu,2,MF_BYPOSITION|MF_CHECKED);
01066                                     }
01067 
01068                                     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> == 1)i=0;
01069                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     2)i=1;
01070                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     4)i=2;
01071                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==     8)i=3;
01072                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    16)i=4;
01073                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    32)i=5;
01074                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==    64)i=6;
01075                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a> ==   128)i=7;
01076                                     <span class="keywordflow">else</span>
01077                                     {
01078                                         i = 8;                         <span class="comment">// "Other" non-standard menu selection</span>
01079                                     }
01080                                     Last_Checked = <a class="code" href="../../d0/d2/usrbench_8h.html#a62">SyncMenuChecks</a>(hWnd, Last_Checked, i);
01081 
01082                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01083                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
01084                                     {
01085                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
01086                                     }
01087 
01088                                 }
01089                                 <span class="keywordflow">else</span>
01090                                 {
01091                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_EXIT,0L);
01092                                 }
01093 
01094                             }             <span class="comment">//case TEXT_SUITE</span>
01095 
01096                             <span class="keywordflow">break</span>;
01097 
01098                             <span class="keywordflow">case</span> <a class="code" href="../../d0/d2/usrbench_8h.html#a16">SELECT</a>:        <span class="comment">// Read some more keys then run the selected test suite</span>
01099                             {
01100 
01101                                 k = GetPrivateProfileString(<span class="stringliteral">"BATCH"</span>,<span class="stringliteral">"TEST"</span>,<span class="stringliteral">"0"</span>,txtbuf,<span class="keyword">sizeof</span>(txtbuf),IniFileName);
01102                                 fclose(fpIniFile);
01103 
01104                                 Num_Selected_Tests = <a class="code" href="../../d0/d2/usrbench_8h.html#a63">Std_Parse</a>(txtbuf, k, Test_Item);
01105 
01106                                 <span class="keywordflow">if</span>(Num_Selected_Tests == 0)
01107                                 {
01108                                     MessageBox(hWnd,<span class="stringliteral">"Invalid Test-Number Entry in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
01109                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01110                                     <span class="keywordflow">break</span>;
01111                                 }
01112 
01113                                 <span class="keywordflow">for</span>(i=0; i&lt;Num_Selected_Tests; i++)
01114                                 {
01115                                     <span class="keywordflow">if</span>(Test_Item[i] &gt; (<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>)
01116                                     {
01117                                         MessageBox(hWnd,<span class="stringliteral">"Invalid Test-Number Entry in USRBATCH.INI File "</span>, <span class="stringliteral">"INI File Error"</span>,MB_ICONSTOP|MB_OK);
01118                                         <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01119                                         <span class="keywordflow">break</span>;
01120                                     }
01121                                 }
01122 
01123                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a60">SelectOutFileName</a>(hWnd);
01124                                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a50">OutFileName</a>)
01125                                 {
01126                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01127                                     <span class="keywordflow">break</span>;
01128                                 }
01129                                 <a class="code" href="../../d0/d2/usrbench_8h.html#a48">fpOutFile</a> = fopen(OutFileName, <span class="stringliteral">"w+"</span>);
01130 
01131                                 <span class="keywordflow">for</span>(j=0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a41">BatchCycle</a>; j++)
01132                                 {
01133                                     <span class="keywordflow">for</span>(i=0; i &lt; Num_Selected_Tests; i++)
01134                                     {
01135                                         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,ID_TEST_START+Test_Item[i],0L);
01136                                     }
01137 
01138                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a61">WriteBatchResults</a>(fpOutFile, TestType, i+1);
01139                                 }
01140 
01141                                 fclose(fpOutFile);
01142 
01143                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a42">Finish_Message</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01144                                 {
01145                                     strcpy(txtbuf,<span class="stringliteral">"Batch Job Finished Successfully, Results Written to "</span>);
01146                                     strcat(txtbuf,OutFileName);
01147                                     MessageBox(hWnd,txtbuf, <span class="stringliteral">"Batch Job Finished"</span>,MB_ICONINFORMATION|MB_OK);
01148                                 }
01149 
01150                                 <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a43">Dont_Close_App</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01151                                 {
01152                                     <a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01153                                     <span class="keywordflow">for</span>(i=0; i&lt;(<span class="keywordtype">int</span>)<a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>; i++)
01154                                     {
01155                                         <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[i].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o3">Result</a> = 0;
01156                                     }
01157                                 }
01158                                 <span class="keywordflow">else</span>
01159                                 {
01160                                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hWnd,WM_COMMAND,IDM_EXIT,0L);
01161                                 }
01162 
01163                             }
01164                             <span class="keywordflow">break</span>;
01165 
01166                         }       <span class="comment">// switch TestType</span>
01167 
01168                     }           <span class="comment">//else (RUN_BATCH - OK to Proceed)</span>
01169 
01170                 }               <span class="comment">// case RUN_BATCH</span>
01171                 <span class="keywordflow">break</span>;
01172 
01173             <span class="comment">//</span>
01174             <span class="comment">// run a single selected test (interactive mode)</span>
01175             <span class="comment">//</span>
01176 
01177             <span class="keywordflow">default</span>:
01178 
01179                 {
01180                     ULONG <a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a> = LOWORD(wParam) - <a class="code" href="../../d3/d9/ntuser_2tools_2usrbench_2resource_8h.html#a28">ID_TEST_START</a>;
01181                     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01182                     <a class="code" href="../../d0/d2/usrbench_8h.html#a23">PFN_MS</a> pfn;
01183                     RECT CliRect = {0,0,10000,10000};
01184                     HDC hdc = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
01185                     <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(hdc,&amp;CliRect,GetStockObject(GRAY_BRUSH));
01186 
01187                     <span class="keywordflow">if</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>==<a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(ghwndMDIClient,GW_CHILD))                     <span class="comment">//If Test Object doesn't exist</span>
01188                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(ghwndMDIClient, WM_MDICREATE, 0, (LPARAM)&amp;mcs); <span class="comment">//Create Test Object</span>
01189 
01190                     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a> &lt; <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>)
01191                     {
01192                         HDC hdc2 = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>(hWnd);
01193 
01194                         wsprintf(tmsg,<span class="stringliteral">"Testing %s"</span>,gTestEntry[Test].Api);
01195                         TextOut(hdc,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
01196 
01197                         pfn = <a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o1">pfn</a>;
01198                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(FALSE);
01199 
01200                         hfont = CreateFontIndirect(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.lpLogFont);
01201                         hfontOld = SelectObject(hdc2, hfont);
01202                         crOld = SetTextColor(hdc2, <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors);
01203                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a44">SelectedFontTransparent</a>)SetBkMode(hdc2,TRANSPARENT);
01204 
01206                         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = <a class="code" href="../../d9/d6/ttseacc_8c.html#a1">Test</a>;
01207                         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
01208                         {
01209 
01210                             GdiFlush();
01211 
01212                             Sample[j] = (<span class="keywordtype">double</span>)(*pfn)(hdc2,<a class="code" href="../../d1/d1/bench_8c.html#a25">gTestEntry</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d4/d0/struct__TEST__ENTRY.html#o2">Iter</a>);
01213                             <a class="code" href="../../d0/d2/usrbench_8h.html#a30">Detailed_Data</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>][j] = (<span class="keywordtype">long</span>)(0.5 + Sample[j]);
01214                             <span class="keywordflow">if</span> (Sample[j] == 0) {
01215                                 <span class="comment">// error occurred</span>
01216                                 <span class="keywordflow">break</span>;
01217                             }
01218 
01219                         }
01220 
01221                         <a class="code" href="../../d7/d5/stats_8h.html#a10">Get_Stats</a>(Sample,NUM_SAMPLES,HI_FILTER,VAR_LIMIT,&amp;TestStats[Index]);
01223 
01224                         <a class="code" href="../../d3/d8/client_8c.html#a134">ShowCursor</a>(TRUE);
01225 
01226                         SetTextColor(hdc2, crOld);
01227                         SelectObject(hdc2, hfontOld);
01228                         DeleteObject(hfont);
01229                         SetBkMode(hdc2, OPAQUE);
01230 
01231                         <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc2);
01232                         <span class="comment">// HIRO</span>
01233                         wsprintf(tmsg,<span class="stringliteral">"Finished %s"</span>,gTestEntry[Test].Api);
01234                         TextOut(hdc,20,20,tmsg,<a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(tmsg));
01235                     }
01236 
01237                     <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>(hWnd,hdc);
01238                 }
01239 
01240             }       <span class="comment">// SWITCH CASE</span>
01241 
01242 
01243             <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a40">BatchFlag</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)               <span class="comment">// Initialize Test Strings (interactive mode)</span>
01244             {
01245                 <a class="code" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> =(PSZ) strncpy(DestString, SourceString, StrLen);
01246                 <a class="code" href="../../d0/d2/usrbench_8h.html#a35">DestString</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>] = <span class="charliteral">'\0'</span>;
01247                 <a class="code" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = (PWSTR) wcsncpy(DestStringW, SourceStringW, StrLen);
01248                 <a class="code" href="../../d0/d2/usrbench_8h.html#a36">DestStringW</a>[<a class="code" href="../../d0/d2/usrbench_8h.html#a32">StrLen</a>] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
01249             }
01250 
01251         }       <span class="comment">// WM_COMMAND</span>
01252         <span class="keywordflow">break</span>;
01253 
01254     <span class="keywordflow">case</span> WM_PAINT:
01255         {
01256             PAINTSTRUCT ps;
01257             HDC hDC = <a class="code" href="../../d3/d0/user32_8def.html#a41">BeginPaint</a>(hWnd,&amp;ps);
01258             EndPaint(hWnd,&amp;ps);
01259         }
01260         <span class="keywordflow">break</span>;
01261 
01262     <span class="keywordflow">case</span> WM_DESTROY:
01263             <a class="code" href="../../d3/d8/client_8c.html#a122">PostQuitMessage</a>(0);
01264             <span class="keywordflow">break</span>;
01265 
01266     <span class="keywordflow">default</span>:
01267 
01268         <span class="comment">//</span>
01269         <span class="comment">// Passes message on if unproccessed</span>
01270         <span class="comment">//</span>
01271         <span class="comment">/*</span>
01272 <span class="comment">         * Use DefFrameProc() instead of DefWindowProc() since there are</span>
01273 <span class="comment">         * things that have to be handled differently because of MDI.</span>
01274 <span class="comment">         */</span>
01275         <span class="keywordflow">return</span> DefFrameProc(hWnd, ghwndMDIClient, msg, wParam, lParam);
01276 
01277     }
01278 
01279 <span class="comment">/* Calculate Timer Frequency For Current Machine and Convert to MicroSeconds (Actual time will be presented in units of 100ns) */</span>
01280 
01281     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = QueryPerformanceFrequency((LARGE_INTEGER *)&amp;PerformanceFreq);
01282     <span class="keywordflow">if</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>){
01283            <a class="code" href="../../d0/d2/usrbench_8h.html#a31">PerformanceFreq</a> /= 10000;<span class="comment">//PerformanceFreq is in Counts/Sec.</span>
01284                                     <span class="comment">//Dividing it by 1,000,000 gives Counts/nanosecond</span>
01285     }                               <span class="comment">//Dividing it by 10,000 gives Counts/(100 nanosecond unit)</span>
01286     <span class="keywordflow">else</span>
01287     {
01288             MessageBox(NULL,
01289                <span class="stringliteral">"High Resolution Performance Counter Doesn't Seem to be Supported on This Machine"</span>,
01290                <span class="stringliteral">"Warning"</span>, MB_OK | MB_ICONEXCLAMATION);
01291 
01292             <a class="code" href="../../d0/d2/usrbench_8h.html#a31">PerformanceFreq</a> = 1;                <span class="comment">/* To Prevent Possible Div by zero later */</span>
01293     }
01294 
01295 
01296     <span class="keywordflow">return</span> ((LRESULT)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01297 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="usrbench.c::WriteBatchResults" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void WriteBatchResults           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>fpOut</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>TestType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cycle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01638">1638</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
References <a class="el" href="../../d4/d2/i386_8c-source.html#l00018">_X86_</a>, <a class="el" href="../../d8/d4/stats_8h-source.html#l00039">_TEST_STATS::Average</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00243">BatchCycle</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00242">BatchFlag</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00087">cf</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00232">DestString</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00222">Detailed_Data</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00191">FIRST_TEXT_FUNCTION</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00124">gfPentium</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01922">gTestEntry</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00192">LAST_TEXT_FUNCTION</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00098">lf</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00211">NUM_SAMPLES</a>, <a class="el" href="../../d1/d5/tscroll_8c-source.html#l00037">NUM_TESTS</a>, <a class="el" href="../../d8/d4/stats_8h-source.html#l00043">_TEST_STATS::NumSamplesValid</a>, <a class="el" href="../../d6/d8/udfstruc_8h.html#a129a115">Physical</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00248">Print_Detailed</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00246">SelectedFontTransparent</a>, <a class="el" href="../../d6/d9/heappage_8c.html#a68">sprintf()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00247">String_Length_Warn</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00228">StrLen</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00221">TestStats</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00200">TEXT_SUITE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00241">TextSuiteFlag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00213">VAR_LIMIT</a>, and <a class="el" href="../../d3/d4/editreg_8c-source.html#l00332">Version</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01317">SaveResults()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.
<p>
<pre class="fragment"><div>01639 {
01640     <span class="keywordtype">char</span> szT[180];
01641     OSVERSIONINFO Win32VersionInformation;
01642     MEMORYSTATUS MemoryStatus;
01643     <span class="keywordtype">char</span> ComputerName[MAX_COMPUTERNAME_LENGTH + 1];
01644     <span class="keywordtype">int</span> SizBuf = MAX_COMPUTERNAME_LENGTH + 1;
01645     <span class="keywordtype">int</span> i,j;
01646     ULONG ix;
01647     <span class="keywordtype">char</span> *pszOSName;
01648     ULONG ixStart = 0;
01649     ULONG ixEnd  = <a class="code" href="../../d0/d6/tscroll_8c.html#a1">NUM_TESTS</a>;
01650 
01651     <span class="keywordflow">if</span>(<a class="code" href="../../d0/d2/usrbench_8h.html#a15">TEXT_SUITE</a> == TestType){
01652         ixStart = <a class="code" href="../../d0/d2/usrbench_8h.html#a8">FIRST_TEXT_FUNCTION</a>;
01653         ixEnd  = <a class="code" href="../../d0/d2/usrbench_8h.html#a9">LAST_TEXT_FUNCTION</a> + 1;
01654     }
01655 
01656 
01657     <span class="comment">/*</span>
01658 <span class="comment">     * Write out the build information and current date.</span>
01659 <span class="comment">     */</span>
01660     Win32VersionInformation.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(Win32VersionInformation);
01661     <span class="keywordflow">if</span> (GetVersionEx(&amp;Win32VersionInformation))
01662     {
01663         <span class="keywordflow">switch</span> (Win32VersionInformation.dwPlatformId)
01664         {
01665             <span class="keywordflow">case</span> VER_PLATFORM_WIN32s:
01666                 pszOSName = <span class="stringliteral">"WIN32S"</span>;
01667                 <span class="keywordflow">break</span>;
01668             <span class="keywordflow">case</span> VER_PLATFORM_WIN32_WINDOWS:
01669                 pszOSName = <span class="stringliteral">"Windows 95"</span>;
01670                 <span class="keywordflow">break</span>;
01671             <span class="keywordflow">case</span> VER_PLATFORM_WIN32_NT:
01672                 pszOSName = <span class="stringliteral">"Windows NT"</span>;
01673                 <span class="keywordflow">break</span>;
01674             <span class="keywordflow">default</span>:
01675                 pszOSName = <span class="stringliteral">"Windows ???"</span>;
01676                 <span class="keywordflow">break</span>;
01677         }
01678 
01679         GetComputerName(ComputerName, &amp;SizBuf);
01680         wsprintf(szT, <span class="stringliteral">"\n\n</span>
01681 <span class="stringliteral">        fwrite(szT, sizeof(char), lstrlen(szT), fpOut);</span>
01682 <span class="stringliteral"></span>
01683 <span class="stringliteral">        wsprintf(szT, "</span>%s Version %d.%d Build %d <span class="stringliteral">", pszOSName,</span>
01684 <span class="stringliteral">        Win32VersionInformation.dwMajorVersion,</span>
01685 <span class="stringliteral">        Win32VersionInformation.dwMinorVersion,</span>
01686 <span class="stringliteral">        Win32VersionInformation.dwBuildNumber);</span>
01687 <span class="stringliteral">        fwrite(szT, sizeof(char), lstrlen(szT), fpOut);</span>
01688 <span class="stringliteral"></span>
01689 <span class="stringliteral">        MemoryStatus.dwLength = sizeof(MEMORYSTATUS);</span>
01690 <span class="stringliteral">        GlobalMemoryStatus(&amp;MemoryStatus);</span>
01691 <span class="stringliteral"></span>
01692 <span class="stringliteral">        wsprintf(szT, "</span>Physical Memory = %dKB   
01693         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01694 
01695         wsprintf(szT,<span class="stringliteral">"\nComputer Name = %s"</span>, ComputerName);
01696         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01697 
01698     }
01699 
01700     wsprintf(szT, <span class="stringliteral">"\n\nMaximum Variation Coefficient (Standard Deviation/Average) Imposed on Test Data = %d %%"</span>, VAR_LIMIT);
01701     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01702     wsprintf(szT, <span class="stringliteral">"\n\nBest and Worst Cycle or Time Counts per Call are Unprocessed Values"</span>, VAR_LIMIT);
01703     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01704 
01705 
01706     <span class="keywordflow">if</span>(BatchFlag == TRUE)
01707     {
01708         wsprintf(szT, <span class="stringliteral">"\n\nBatch Cycle No. %d Out of %d Cycles"</span>, cycle, BatchCycle );
01709         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01710     }
01711     <span class="keywordflow">else</span>
01712     {
01713         wsprintf(szT, <span class="stringliteral">"\n\nResults of interactive mode session;"</span>);
01714         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01715     }
01716 
01717     <span class="keywordflow">if</span>(TEXT_SUITE == TestType || TRUE == TextSuiteFlag){
01718         wsprintf(szT, <span class="stringliteral">"\n\nFor Text Function Suit:\n\nTest String Length = %d Characters"</span>, StrLen);
01719         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01720 
01721         wsprintf(szT, <span class="stringliteral">"\nString Used=   %s"</span>, DestString);
01722         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01723 
01724         <span class="keywordflow">if</span>(String_Length_Warn == TRUE)
01725         {
01726             wsprintf(szT, <span class="stringliteral">"\n!!!WARNING: One or More String Lengths Specified in INI File \n           is Longer than Supplied or Default Source String"</span>);
01727             fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01728         }
01729 
01730         wsprintf(szT, <span class="stringliteral">"\nFont name = %s, Font Size = %d"</span>, &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0], <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize/10);
01731         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01732 
01733         wsprintf(szT, <span class="stringliteral">"\nFont Weight = %ld (400 = Normal, 700 = Bold)"</span>,<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfWeight);
01734         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01735 
01736         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfItalic != FALSE)?wsprintf(szT,<span class="stringliteral">"\nItalic = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nItalic = FALSE"</span>);
01737         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01738 
01739         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfUnderline==TRUE)?wsprintf(szT,<span class="stringliteral">"\nUnderline = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nUnderline = FALSE"</span>);
01740         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01741 
01742         (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfStrikeOut==TRUE)?wsprintf(szT,<span class="stringliteral">"\nStrikeOut = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nStrikeOut = FALSE"</span>);
01743         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01744 
01745         (SelectedFontTransparent==TRUE)?wsprintf(szT,<span class="stringliteral">"\nTransparent Background = TRUE"</span>):wsprintf(szT,<span class="stringliteral">"\nOpaque Background = TRUE"</span>);
01746         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01747 
01748         wsprintf(szT, <span class="stringliteral">"\nColor Used: RED = %d, GREEN = %d, BLUE = %d"</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors&gt;&gt;8), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(<a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.rgbColors&gt;&gt;16) );
01749         fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01750    }
01751 
01752     <span class="keywordflow">if</span>(TEXT_SUITE == TestType || TRUE == TextSuiteFlag)
01753       {
01754 #ifdef _X86_
01755                 <span class="keywordflow">if</span>(gfPentium)
01756                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\t Cycle Counts \tStdDev%\tBest \t Worst \t Valid Samples \t Out of\tIterations  StrLen \t Font Size   Font Name\n\n"</span>);
01757                 <span class="keywordflow">else</span>
01758 #endif
01759                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\tTime (100 ns) \tStdDev%\tBest \t Worst \t Valid Samples \t Out of\tIterations  StrLen \t Font Size   Font Name\n\n"</span>);
01760       }
01761     <span class="keywordflow">else</span>
01762       {
01763 #ifdef _X86_
01764                 <span class="keywordflow">if</span>(gfPentium)
01765                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\t Cycle Counts \tStdDev% \t Best \t Worst \t Valid Samples \t Out of \t Iterations\n\n"</span>);
01766                 <span class="keywordflow">else</span>
01767 #endif
01768                     lstrcpy(szT, <span class="stringliteral">"\n\n  Function\t\tTime (100 ns) \tStdDev% \t Best \t Worst \t Valid Samples \t Out of \t Iterations\n\n"</span>);
01769 
01770       }
01771 
01772     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01773 
01774     <span class="keywordflow">for</span> (ix = ixStart; ix &lt; ixEnd; ix++) {
01775 
01776         <span class="keywordflow">if</span>(TEXT_SUITE == TestType || TRUE == TextSuiteFlag)
01777         {
01778             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,
01779                    <span class="stringliteral">"%-30s\t,%6ld\t,%6.2f\t,%6ld\t,%6ld\t,%6ld\t\t,%6ld\t,%6ld\t,%6ld\t,%6ld\t,%s\n"</span>,
01780                    (LPSTR)gTestEntry[ix].Api,
01781                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Average),
01782                                 (<span class="keywordtype">float</span>)TestStats[ix].StdDev,
01783                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Minimum_Result),
01784                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Maximum_Result),
01785                                 TestStats[ix].NumSamplesValid,
01786                                 (<span class="keywordtype">long</span>)NUM_SAMPLES,
01787                                 gTestEntry[ix].Iter,
01788                                 StrLen,
01789                                 <a class="code" href="../../d9/d1/usrbench_8c.html#a13">cf</a>.iPointSize / 10,
01790                                 &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>.lfFaceName[0]);
01791 
01792 
01793         }
01794         <span class="keywordflow">else</span>
01795         {
01796             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,
01797                    <span class="stringliteral">"%-50s\t,%10ld\t,%6.2f\t,%10ld\t,%10ld\t,%6ld\t\t,%6ld\t,%6ld\n"</span>,
01798                    (LPSTR)gTestEntry[ix].Api,
01799                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Average),
01800                                 (<span class="keywordtype">float</span>)TestStats[ix].StdDev,
01801                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Minimum_Result),
01802                                 (<span class="keywordtype">long</span>)(0.5 + TestStats[ix].Maximum_Result),
01803                                 TestStats[ix].NumSamplesValid,
01804                                 (<span class="keywordtype">long</span>)NUM_SAMPLES,
01805                                 gTestEntry[ix].Iter);
01806         }
01807 
01808         <span class="keywordflow">if</span>((<span class="keywordtype">long</span>)(0.5 + <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o0">Average</a>) != 0)
01809         {
01810             fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01811             <span class="keywordflow">if</span>((<a class="code" href="../../d0/d2/usrbench_8h.html#a46">Print_Detailed</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) &amp;&amp; ((<span class="keywordtype">float</span>)(<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a> - <a class="code" href="../../d0/d2/usrbench_8h.html#a29">TestStats</a>[ix].<a class="code" href="../../d6/d0/struct__TEST__STATS.html#o4">NumSamplesValid</a>)/(<span class="keywordtype">float</span>)<a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a> &gt; 0.05F))
01812             {
01813                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"\nThe Last Test Had More Than 5 Percent of Its Samples Filtered Out;\n\n"</span>);
01814                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01815 
01816                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"Here Is a Detailed Distribution of the Samples:\n\n"</span>);
01817                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01818 
01819                 <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="../../d0/d2/usrbench_8h.html#a20">NUM_SAMPLES</a>; j++)
01820                 {
01821                     <span class="keywordflow">if</span>((j+1)%10)
01822                         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"%d\t"</span>,Detailed_Data[ix][j]);
01823                     <span class="keywordflow">else</span>
01824                         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"%d\n"</span>,Detailed_Data[ix][j]);
01825 
01826                     fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01827                 }
01828                 <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>(szT,<span class="stringliteral">"\n"</span>);
01829                 fwrite(szT, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), lstrlen(szT), fpOut);
01830 
01831             }
01832         }
01833         <span class="keywordflow">else</span> {
01834             fputs(<span class="stringliteral">"\n"</span>, fpOut);
01835         }
01836     }
01837 
01838     <span class="keywordflow">if</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> == <a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a>)<a class="code" href="../../d0/d2/usrbench_8h.html#a39">TextSuiteFlag</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01839 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a13" doxytag="usrbench.c::cf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CHOOSEFONT <a class="el" href="../../d9/d1/usrbench_8c.html#a13">cf</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00087">87</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01638">WriteBatchResults()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="usrbench.c::gfPentium" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d9/d1/usrbench_8c.html#a4">gfPentium</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00069">69</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/bench_8c-source.html#l00126">BeginTimeMeasurement()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00166">EndTimeMeasurement()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01398">ResultsDlgProc()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01638">WriteBatchResults()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="usrbench.c::gfUseCycleCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d9/d1/usrbench_8c.html#a5">gfUseCycleCount</a> = TRUE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00070">70</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/bench_8c-source.html#l00126">BeginTimeMeasurement()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="usrbench.c::ghaccel" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d9/d1/usrbench_8c.html#a7">ghaccel</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00075">75</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="usrbench.c::ghinst" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d9/d1/usrbench_8c.html#a8">ghinst</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00076">76</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01934">MDIChildWndProc()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00369">msProfAvgDlgCreate()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00393">msProfAvgDlgCreateDestroy()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00473">msProfAvgDlgCreateDestroyEmpty()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00446">msProfAvgDlgCreateDestroyNoFont()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00420">msProfAvgDlgCreateDestroyNoMenu()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00342">msProfAvgDlgDraw()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01613">msProfCallback()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00262">msProfClassGroup()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00828">msProfCreateDestroyButton()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00555">msProfCreateDestroyChildWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00880">msProfCreateDestroyCombobox()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00932">msProfCreateDestroyEdit()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00776">msProfCreateDestroyListbox()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01036">msProfCreateDestroyScrollbar()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00984">msProfCreateDestroyStatic()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00501">msProfCreateDestroyWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01559">msProfDispatchMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00674">msProfGetWindowLong()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01088">msProfListboxInsert1()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01153">msProfListboxInsert2()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01217">msProfListboxInsert3()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00224">msProfRegisterClass()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01659">msProfSendMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00725">msProfSetWindowLong()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01843">msProfTranslateMessage()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01791">msProfUpdateWindow()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l01705">SendMessageDiffThreadFunc()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="usrbench.c::ghwndFrame" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND <a class="el" href="../../d9/d1/usrbench_8c.html#a9">ghwndFrame</a> = NULL <a class="el" href="../../d1/d1/bench_8c.html#a21">ghwndMDIClient</a> = NULL          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00077">77</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00369">msProfAvgDlgCreate()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00393">msProfAvgDlgCreateDestroy()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00473">msProfAvgDlgCreateDestroyEmpty()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00446">msProfAvgDlgCreateDestroyNoFont()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00420">msProfAvgDlgCreateDestroyNoMenu()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00342">msProfAvgDlgDraw()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00262">msProfClassGroup()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00307">msProfClipboardGroup()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01317">SaveResults()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="usrbench.c::hInstMain" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HINSTANCE <a class="el" href="../../d9/d1/usrbench_8c.html#a6">hInstMain</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00072">72</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01317">SaveResults()</a>, <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00103">WinMain()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="usrbench.c::lf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LOGFONT <a class="el" href="../../d9/d1/usrbench_8c.html#a14">lf</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00088">88</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="usrbench.c::mcs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MDICREATESTRUCT <a class="el" href="../../d9/d1/usrbench_8c.html#a10">mcs</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00081">81</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>, and <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="usrbench.c::pszTest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSZ <a class="el" href="../../d9/d1/usrbench_8c.html#a2">pszTest</a> = DEFAULT_A_STRING          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00066">66</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="usrbench.c::pwszTest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PWSTR <a class="el" href="../../d9/d1/usrbench_8c.html#a3">pwszTest</a> = DEFAULT_W_STRING          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00067">67</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00268">WndProc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="usrbench.c::szChild" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a> <a class="el" href="../../d9/d1/usrbench_8c.html#a11">szChild</a>[] = "child"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00084">84</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="usrbench.c::szFrame" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a> <a class="el" href="../../d9/d1/usrbench_8c.html#a12">szFrame</a>[] = "frame"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/usrbench_8c-source.html#l00085">85</a> of file <a class="el" href="../../d0/d1/usrbench_8c-source.html">usrbench.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/usrbench_8c-source.html#l01995">InitializeInstance()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:06 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
