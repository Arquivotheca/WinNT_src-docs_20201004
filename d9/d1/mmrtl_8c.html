<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mmrtl.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>mmrtl.c File Reference</h1>
<p>
<a href="../../d0/d1/mmrtl_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a0">Int32x32To32</a>(x, y)&nbsp;&nbsp;&nbsp;((x) * (y))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a1">BEGIN_EXCEPTION_HANDLER</a>&nbsp;&nbsp;&nbsp;try {</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a2">END_EXCEPTION_HANDLER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a3">END_EXCEPTION_HANDLER_EMPTY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a4">MONITORFROMPOINTALGORITHM</a>(SUMSQUARESMAX, SUMSQUARESTYPE, POINTMULTIPLY)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a5">MONITORFROMRECTALGORITHM</a>(SUMSQUARESMAX, SUMSQUARESTYPE, POINTMULTIPLY)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a6">_MonitorFromPoint</a> (POINT pt, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a7">_MonitorFromRect</a> (LPCRECT lprc, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/mmrtl_8c.html#a8">_MonitorFromWindow</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="mmrtl.c::BEGIN_EXCEPTION_HANDLER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BEGIN_EXCEPTION_HANDLER&nbsp;&nbsp;&nbsp;try {          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00023">23</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00221">_MonitorFromRect()</a>, and <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00426">_MonitorFromWindow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="mmrtl.c::END_EXCEPTION_HANDLER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define END_EXCEPTION_HANDLER          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>} except (W32ExceptionHandler(TRUE, RIP_WARNING)) { \
        pMonitorResult = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00024">24</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00221">_MonitorFromRect()</a>, and <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00426">_MonitorFromWindow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="mmrtl.c::END_EXCEPTION_HANDLER_EMPTY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define END_EXCEPTION_HANDLER_EMPTY          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>} except (W32ExceptionHandler(TRUE, RIP_WARNING)) { \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00028">28</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="mmrtl.c::Int32x32To32" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Int32x32To32          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>y&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((x) * (y))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00012">12</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>, and <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00426">_MonitorFromWindow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="mmrtl.c::MONITORFROMPOINTALGORITHM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MONITORFROMPOINTALGORITHM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SUMSQUARESMAX,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SUMSQUARESTYPE,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>POINTMULTIPLY&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="mmrtl.c::MONITORFROMRECTALGORITHM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MONITORFROMRECTALGORITHM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SUMSQUARESMAX,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SUMSQUARESTYPE,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>POINTMULTIPLY&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00221">_MonitorFromRect()</a>, and <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00426">_MonitorFromWindow()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a6" doxytag="mmrtl.c::_MonitorFromPoint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> _MonitorFromPoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">POINT&nbsp;</td>
          <td class="mdname" nowrap> <em>pt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">56</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
References <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00023">BEGIN_EXCEPTION_HANDLER</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02201">tagDISPLAYINFO::cMonitors</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02156">tagMONITOR::dwMONFlags</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00024">END_EXCEPTION_HANDLER</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00028">END_EXCEPTION_HANDLER_EMPTY</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02598">GetDispInfo()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02604">GetPrimaryMonitor()</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00012">Int32x32To32</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02054">MONF_VISIBLE</a>, <a class="el" href="../../d9/d1/mmrtl_8c.html#a4">MONITORFROMPOINTALGORITHM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02067">tagMONITOR::pMonitorNext</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00118">PtInRect()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07343">REBASESHAREDPTR</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07344">REBASESHAREDPTRALWAYS</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00221">_MonitorFromRect()</a>, <a class="el" href="../../d2/d4/multimon_8c-source.html#l00033">ClipPointToDesktop()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>, <a class="el" href="../../d4/d0/mmcl_8c-source.html#l00016">MonitorFromPoint()</a>, <a class="el" href="../../d2/d3/tooltips_8c-source.html#l00285">TooltipGetPosition()</a>, and <a class="el" href="../../d3/d2/mnpopup_8c-source.html#l00052">xxxTrackPopupMenuEx()</a>.
<p>
<pre class="fragment"><div>00057 {
00058     <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>        pMonitor, pMonitorResult;
00059     <span class="keywordtype">int</span>             dx;
00060     <span class="keywordtype">int</span>             dy;
00061 
00062     UserAssert(dwFlags == MONITOR_DEFAULTTONULL ||
00063                dwFlags == MONITOR_DEFAULTTOPRIMARY ||
00064                dwFlags == MONITOR_DEFAULTTONEAREST);
00065 
00066     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a792">GetDispInfo</a>()-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o11">cMonitors</a> == 1 &amp;&amp; <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> != MONITOR_DEFAULTTONULL)
00067         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00068 
00069     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>) {
00070     <span class="keywordflow">case</span> MONITOR_DEFAULTTONULL:
00071     <span class="keywordflow">case</span> MONITOR_DEFAULTTOPRIMARY:
00072         <span class="comment">/*</span>
00073 <span class="comment">         * Return the monitor the point is in.</span>
00074 <span class="comment">         */</span>
00075 
00076         <a class="code" href="../../d9/d1/mmrtl_8c.html#a1">BEGIN_EXCEPTION_HANDLER</a>
00077 
00078         <span class="keywordflow">for</span> (   pMonitor = <a class="code" href="../../d4/d1/userk_8h.html#a751">REBASESHAREDPTRALWAYS</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a792">GetDispInfo</a>()-&gt;pMonitorFirst);
00079                 pMonitor;
00080                 pMonitor = <a class="code" href="../../d4/d1/userk_8h.html#a750">REBASESHAREDPTR</a>(pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o1">pMonitorNext</a>)) {
00081 
00082             <span class="keywordflow">if</span> (!(pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o2">dwMONFlags</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a525">MONF_VISIBLE</a>))
00083                 <span class="keywordflow">continue</span>;
00084 
00085             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/rect_8c.html#a5">PtInRect</a>(&amp;((<a class="code" href="../../d0/d2/structtagMONITOR.html">MONITOR</a> *)pMonitor)-&gt;rcMonitor, pt)) {
00086                 <span class="keywordflow">return</span> pMonitor;
00087             }
00088         }
00089 
00090         <a class="code" href="../../d9/d1/mmrtl_8c.html#a3">END_EXCEPTION_HANDLER_EMPTY</a>
00091 
00092         <span class="comment">/*</span>
00093 <span class="comment">         * Return what the user wants if it's not found.</span>
00094 <span class="comment">         */</span>
00095         <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>) {
00096         <span class="keywordflow">case</span> MONITOR_DEFAULTTONULL:
00097             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00098 
00099         <span class="keywordflow">case</span> MONITOR_DEFAULTTOPRIMARY:
00100             <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00101 
00102         <span class="keywordflow">default</span>:
00103             UserAssertMsg0(FALSE, <span class="stringliteral">"Logic error in _MonitorFromPoint"</span>);
00104             <span class="keywordflow">break</span>;
00105         }
00106 
00107     <span class="keywordflow">case</span> MONITOR_DEFAULTTONEAREST:
00108 
00109 <span class="preprocessor">#define MONITORFROMPOINTALGORITHM(SUMSQUARESMAX, SUMSQUARESTYPE, POINTMULTIPLY)     \</span>
00110 <span class="preprocessor">        SUMSQUARESTYPE  sumsquare;                                                  \</span>
00111 <span class="preprocessor">        SUMSQUARESTYPE  leastsumsquare;                                             \</span>
00112 <span class="preprocessor">        leastsumsquare = SUMSQUARESMAX;                                             \</span>
00113 <span class="preprocessor">        for (   pMonitor = REBASESHAREDPTRALWAYS(GetDispInfo()-&gt;pMonitorFirst);     \</span>
00114 <span class="preprocessor">                pMonitor;                                                           \</span>
00115 <span class="preprocessor">                pMonitor = REBASESHAREDPTR(pMonitor-&gt;pMonitorNext)) {               \</span>
00116 <span class="preprocessor">                                                                                    \</span>
00117 <span class="preprocessor">            if (!(pMonitor-&gt;dwMONFlags &amp; MONF_VISIBLE))                             \</span>
00118 <span class="preprocessor">                continue;                                                           \</span>
00119 <span class="preprocessor">                                                                                    \</span>
00120 <span class="preprocessor">            </span><span class="comment">/*                                                                      \</span>
00121 <span class="comment">             * Determine distance from monitor along x axis.                        \</span>
00122 <span class="comment">             */</span>                                                                     \
00123             if (pt.x &lt; pMonitor-&gt;rcMonitor.left) {                                  \
00124                 dx = pMonitor-&gt;rcMonitor.left - pt.x;                               \
00125             } else if (pt.x &lt; pMonitor-&gt;rcMonitor.right) {                          \
00126                 dx = 0;                                                             \
00127             } else {                                                                \
00128                 <span class="comment">/*                                                                  \</span>
00129 <span class="comment">                 * Monitor rectangles do not include the rightmost edge.            \</span>
00130 <span class="comment">                 */</span>                                                                 \
00131                 dx = pt.x - (pMonitor-&gt;rcMonitor.right - 1);                        \
00132             }                                                                       \
00133                                                                                     \
00134             <span class="comment">/*                                                                      \</span>
00135 <span class="comment">             * Skip this monitor if dx is greater than dx^2 + dy^2.                 \</span>
00136 <span class="comment">             * We do this check to avoid multiplication operations.                 \</span>
00137 <span class="comment">             */</span>                                                                     \
00138             if ((SUMSQUARESTYPE) dx &gt;= leastsumsquare)                              \
00139                 continue;                                                           \
00140                                                                                     \
00141             <span class="comment">/*                                                                      \</span>
00142 <span class="comment">             * Determine distance from monitor along y axis.                        \</span>
00143 <span class="comment">             */</span>                                                                     \
00144             if (pt.y &lt; pMonitor-&gt;rcMonitor.top) {                                   \
00145                 dy = pMonitor-&gt;rcMonitor.top - pt.y;                                \
00146             } else if (pt.y &lt; pMonitor-&gt;rcMonitor.bottom) {                         \
00147                 <span class="comment">/*                                                                  \</span>
00148 <span class="comment">                 * The point is in the monitor and we're done                       \</span>
00149 <span class="comment">                 * if both dx and dy are zero.                                      \</span>
00150 <span class="comment">                 */</span>                                                                 \
00151                 if (dx == 0)                                                        \
00152                     return pMonitor;                                                \
00153                                                                                     \
00154                 dy = 0;                                                             \
00155             } else {                                                                \
00156                 dy = pt.y - (pMonitor-&gt;rcMonitor.bottom - 1);                       \
00157             }                                                                       \
00158                                                                                     \
00159             <span class="comment">/*                                                                      \</span>
00160 <span class="comment">             * Calculate dx^2. Skip this monitor if dx is greater                   \</span>
00161 <span class="comment">             * than dx^2 + dy^2. We do this check to avoid                          \</span>
00162 <span class="comment">             * multiplication operations.                                           \</span>
00163 <span class="comment">             */</span>                                                                     \
00164             sumsquare = POINTMULTIPLY(dx, dx);                                      \
00165             if (sumsquare &gt;= leastsumsquare)                                        \
00166                 continue;                                                           \
00167                                                                                     \
00168             <span class="comment">/*                                                                      \</span>
00169 <span class="comment">             * Skip this monitor if dx^2 + y is greater than dx^2 + dy^2.           \</span>
00170 <span class="comment">             * We do this check to avoid multiplication operations.                 \</span>
00171 <span class="comment">             */</span>                                                                     \
00172             if (sumsquare + (SUMSQUARESTYPE) dy &gt;= leastsumsquare)                  \
00173                 continue;                                                           \
00174                                                                                     \
00175             <span class="comment">/*                                                                      \</span>
00176 <span class="comment">             * Compute dx^2 + dy^2. Skip this monitor if it's not the least.        \</span>
00177 <span class="comment">             */</span>                                                                     \
00178             sumsquare += (SUMSQUARESTYPE) POINTMULTIPLY(dy, dy);                    \
00179             if (sumsquare &gt;= leastsumsquare)                                        \
00180                 continue;                                                           \
00181                                                                                     \
00182             <span class="comment">/*                                                                      \</span>
00183 <span class="comment">             * This is the closest monitor so far.                                  \</span>
00184 <span class="comment">             */</span>                                                                     \
00185             leastsumsquare = sumsquare;                                             \
00186             pMonitorResult = pMonitor;                                              \
00187         }
00188 
00189 <span class="preprocessor">#if DBG</span>
00190 <span class="preprocessor"></span>        pMonitorResult = (<a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>) -1;
00191 <span class="preprocessor">#endif</span>
00192 <span class="preprocessor"></span>
00193         <span class="keywordflow">if</span> (    pt.x &lt; SHRT_MIN || SHRT_MAX &lt; pt.x ||
00194                 pt.y &lt; SHRT_MIN || SHRT_MAX &lt; pt.y) {
00195 
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="mmrtl.c::_MonitorFromRect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> _MonitorFromRect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00221">221</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
References <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00056">_MonitorFromPoint()</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00023">BEGIN_EXCEPTION_HANDLER</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02201">tagDISPLAYINFO::cMonitors</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02156">tagMONITOR::dwMONFlags</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00024">END_EXCEPTION_HANDLER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00244">EqualRect</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02598">GetDispInfo()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02604">GetPrimaryMonitor()</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00191">IntersectRect()</a>, <a class="el" href="../../d4/d5/rect_8c-source.html#l00101">IsRectEmpty()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02054">MONF_VISIBLE</a>, <a class="el" href="../../d9/d1/mmrtl_8c.html#a5">MONITORFROMRECTALGORITHM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02067">tagMONITOR::pMonitorNext</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02206">tagDISPLAYINFO::rcScreen</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07343">REBASESHAREDPTR</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l07344">REBASESHAREDPTRALWAYS</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00679">_GetWindowPlacement()</a>, <a class="el" href="../../d9/d2/movesize_8c-source.html#l00335">CkptRestore()</a>, <a class="el" href="../../d2/d3/spb_8c-source.html#l00341">CreateSpb()</a>, <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l00460">DefDlgProcWorker()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>, <a class="el" href="../../d4/d0/mmcl_8c-source.html#l00042">MonitorFromRect()</a>, <a class="el" href="../../d3/d7/swp_8c-source.html#l05305">xxxCheckFullScreen()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l01683">xxxMNPositionHierarchy()</a>, <a class="el" href="../../d9/d2/movesize_8c-source.html#l00437">xxxMS_TrackMove()</a>, <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l01054">xxxSetInternalWindowPos()</a>, <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00911">xxxSetWindowPlacement()</a>, and <a class="el" href="../../d5/d4/rare_8c-source.html#l01497">xxxSystemParametersInfo()</a>.
<p>
<pre class="fragment"><div>00227            :
00228 *     lprc    - The rect.
00229 *     <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> - One of:
00230 *         MONITOR_DEFAULTTONULL - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> rect doesn'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> intersect a monitor,
00231 *             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.
00232 *
00233 *         MONITOR_DEFAULTTOPRIMARY - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> rect doesn'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> intersect a monitor,
00234 *             <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> primary monitor.
00235 *
00236 *         MONITOR_DEFAULTTONEAREST - Return <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> monitor nearest <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> rect.
00237 *
00238 * <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>:
00239 * 22-Sep-1996 adams     Created.
00240 * 29-Mar-1997 adams     Moved to rtl.
00241 \***************************************************************************/
00242 
00243 <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>
00244 <a class="code" href="../../d9/d1/mmrtl_8c.html#a7">_MonitorFromRect</a>(LPCRECT lprc, DWORD dwFlags)
00245 {
00246     <a class="code" href="../../d9/d3/structtagDISPLAYINFO.html">PDISPLAYINFO</a>    pDispInfo;
00247     <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>        pMonitor, pMonitorResult;
00248     RECT            rc;
00249     <span class="keywordtype">int</span>             area, areaMost;
00250 
00251     UserAssert(dwFlags == MONITOR_DEFAULTTONULL ||
00252                dwFlags == MONITOR_DEFAULTTOPRIMARY ||
00253                dwFlags == MONITOR_DEFAULTTONEAREST);
00254 
00255     <span class="comment">/*</span>
00256 <span class="comment">     * Special case the most common case - 1 monitor.</span>
00257 <span class="comment">     */</span>
00258     pDispInfo = <a class="code" href="../../d6/d0/usercli_8h.html#a792">GetDispInfo</a>();
00259     <span class="keywordflow">if</span> (pDispInfo-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o11">cMonitors</a> == 1 &amp;&amp; <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> != MONITOR_DEFAULTTONULL)
00260         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00261 
00262     <span class="comment">/*</span>
00263 <span class="comment">     * If rect is empty, use topleft point.</span>
00264 <span class="comment">     */</span>
00265     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/rect_8c.html#a4">IsRectEmpty</a>(lprc)) {
00266         <span class="keywordflow">return</span> <a class="code" href="../../d9/d1/mmrtl_8c.html#a6">_MonitorFromPoint</a>(*(LPPOINT)lprc, dwFlags);
00267     }
00268 
00269     <span class="comment">/*</span>
00270 <span class="comment">     * Return the primary monitor if the rectangle covers the desktop.</span>
00271 <span class="comment">     */</span>
00272     <span class="keywordflow">if</span> (    lprc-&gt;left   &lt;= pDispInfo-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o14">rcScreen</a>.left &amp;&amp;
00273             lprc-&gt;top    &lt;= pDispInfo-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o14">rcScreen</a>.top &amp;&amp;
00274             lprc-&gt;right  &gt;= pDispInfo-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o14">rcScreen</a>.right &amp;&amp;
00275             lprc-&gt;bottom &gt;= pDispInfo-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o14">rcScreen</a>.bottom) {
00276 
00277         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00278     }
00279 
00280     <span class="comment">/*</span>
00281 <span class="comment">     * Calculate the nearest rectangle by determining which</span>
00282 <span class="comment">     * monitor has the greatest intersection with the rectangle.</span>
00283 <span class="comment">     */</span>
00284 
00285     <a class="code" href="../../d9/d1/mmrtl_8c.html#a1">BEGIN_EXCEPTION_HANDLER</a>
00286 
00287     areaMost = 0;
00288     <span class="keywordflow">for</span> (   pMonitor = <a class="code" href="../../d4/d1/userk_8h.html#a751">REBASESHAREDPTRALWAYS</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a792">GetDispInfo</a>()-&gt;pMonitorFirst);
00289             pMonitor;
00290             pMonitor = <a class="code" href="../../d4/d1/userk_8h.html#a750">REBASESHAREDPTR</a>(pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o1">pMonitorNext</a>)) {
00291 
00292         <span class="keywordflow">if</span> (!(pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o2">dwMONFlags</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a525">MONF_VISIBLE</a>))
00293             <span class="keywordflow">continue</span>;
00294 
00295         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/rect_8c.html#a8">IntersectRect</a>(&amp;rc, lprc, &amp;((<a class="code" href="../../d0/d2/structtagMONITOR.html">MONITOR</a> *)pMonitor)-&gt;rcMonitor)) {
00296             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a34">EqualRect</a>(&amp;rc, lprc))
00297                 <span class="keywordflow">return</span> pMonitor;
00298 
00299             <span class="comment">/*</span>
00300 <span class="comment">             * Calculate the area of the intersection. Note that</span>
00301 <span class="comment">             * the intersection must be in 16bit coordinats, since</span>
00302 <span class="comment">             * we limit monitor rects to 16bit coordinate space.</span>
00303 <span class="comment">             * So the result of any area calculation will fit in</span>
00304 <span class="comment">             * in an int.</span>
00305 <span class="comment">             */</span>
00306             area = (rc.right - rc.left) * (rc.bottom - rc.top);
00307             <span class="keywordflow">if</span> (area &gt; areaMost) {
00308                 areaMost = area;
00309                 pMonitorResult = pMonitor;
00310             }
00311         }
00312     }
00313 
00314     <a class="code" href="../../d9/d1/mmrtl_8c.html#a2">END_EXCEPTION_HANDLER</a>
00315 
00316     UserAssert(areaMost &gt;= 0);
00317     <span class="keywordflow">if</span> (areaMost &gt; 0)
00318         <span class="keywordflow">return</span> pMonitorResult;
00319 
00320 
00321     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>) {
00322     <span class="keywordflow">case</span> MONITOR_DEFAULTTONULL:
00323         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00324 
00325     <span class="keywordflow">case</span> MONITOR_DEFAULTTOPRIMARY:
00326         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00327 
00328     <span class="keywordflow">case</span> MONITOR_DEFAULTTONEAREST:
00329         {
00330             <span class="keywordtype">int</span> dx, dy;
00331 
00332 <span class="preprocessor">#define MONITORFROMRECTALGORITHM(SUMSQUARESMAX, SUMSQUARESTYPE, POINTMULTIPLY)      \</span>
00333 <span class="preprocessor">            SUMSQUARESTYPE  sumsquare;                                              \</span>
00334 <span class="preprocessor">            SUMSQUARESTYPE  leastsumsquare;                                         \</span>
00335 <span class="preprocessor">            leastsumsquare = SUMSQUARESMAX;                                         \</span>
00336 <span class="preprocessor">            for (   pMonitor = REBASESHAREDPTRALWAYS(GetDispInfo()-&gt;pMonitorFirst); \</span>
00337 <span class="preprocessor">                    pMonitor;                                                       \</span>
00338 <span class="preprocessor">                    pMonitor = REBASESHAREDPTR(pMonitor-&gt;pMonitorNext)) {           \</span>
00339 <span class="preprocessor">                                                                                    \</span>
00340 <span class="preprocessor">                if (!(pMonitor-&gt;dwMONFlags &amp; MONF_VISIBLE))                         \</span>
00341 <span class="preprocessor">                    continue;                                                       \</span>
00342 <span class="preprocessor">                                                                                    \</span>
00343 <span class="preprocessor">                </span><span class="comment">/*                                                                  \</span>
00344 <span class="comment">                 * Determine distance from monitor along x axis.                    \</span>
00345 <span class="comment">                 */</span>                                                                 \
00346                 if (lprc-&gt;right &lt;= pMonitor-&gt;rcMonitor.left) {                      \
00347                     <span class="comment">/*                                                              \</span>
00348 <span class="comment">                     * Add 1 because rectangles do not include the rightmost edge.  \</span>
00349 <span class="comment">                     */</span>                                                             \
00350                     dx = pMonitor-&gt;rcMonitor.left - lprc-&gt;right + 1;                \
00351                 } else if (lprc-&gt;left &lt; pMonitor-&gt;rcMonitor.right) {                \
00352                     dx = 0;                                                         \
00353                 } else {                                                            \
00354                     <span class="comment">/*                                                              \</span>
00355 <span class="comment">                     * Add 1 because rectangles do not include the rightmost edge.  \</span>
00356 <span class="comment">                     */</span>                                                             \
00357                     dx = lprc-&gt;left - (pMonitor-&gt;rcMonitor.right - 1);              \
00358                 }                                                                   \
00359                                                                                     \
00360                 <span class="comment">/*                                                                  \</span>
00361 <span class="comment">                 * Skip this monitor if dx is greater than dx^2 + dy^2.             \</span>
00362 <span class="comment">                 * We do this check to avoid multiplication operations.             \</span>
00363 <span class="comment">                 */</span>                                                                 \
00364                 if ((SUMSQUARESTYPE) dx &gt;= leastsumsquare)                          \
00365                     continue;                                                       \
00366                                                                                     \
00367                 <span class="comment">/*                                                                  \</span>
00368 <span class="comment">                 * Determine distance from monitor along y axis.                    \</span>
00369 <span class="comment">                 */</span>                                                                 \
00370                 if (lprc-&gt;bottom &lt;= pMonitor-&gt;rcMonitor.top) {                      \
00371                     <span class="comment">/*                                                              \</span>
00372 <span class="comment">                     * Add 1 because rectangles do not include the bottommost edge. \</span>
00373 <span class="comment">                     */</span>                                                             \
00374                     dy = pMonitor-&gt;rcMonitor.top - lprc-&gt;bottom + 1;                \
00375                 } else if (lprc-&gt;top &lt; pMonitor-&gt;rcMonitor.bottom) {                \
00376                     UserAssert(dx != 0 &amp;&amp; "This rectangle intersects a monitor, so we shouldn't be here."); \
00377                     dy = 0;                                                         \
00378                 } else {                                                            \
00379                     <span class="comment">/*                                                              \</span>
00380 <span class="comment">                     * Add 1 because rectangles do not include the bottommost edge. \</span>
00381 <span class="comment">                     */</span>                                                             \
00382                     dy = lprc-&gt;top - pMonitor-&gt;rcMonitor.bottom + 1;                \
00383                 }                                                                   \
00384                                                                                     \
00385                 <span class="comment">/*                                                                  \</span>
00386 <span class="comment">                 * Calculate dx^2. Skip this monitor if dx is greater               \</span>
00387 <span class="comment">                 * than dx^2 + dy^2. We do this check to avoid                      \</span>
00388 <span class="comment">                 * multiplication operations.                                       \</span>
00389 <span class="comment">                 */</span>                                                                 \
00390                 sumsquare = POINTMULTIPLY(dx, dx);                                  \
00391                 if (sumsquare &gt;= leastsumsquare)                                    \
00392                     continue;                                                       \
00393                                                                                     \
00394                 <span class="comment">/*                                                                  \</span>
00395 <span class="comment">                 * Skip this monitor if dx^2 + y is greater than dx^2 + dy^2.       \</span>
00396 <span class="comment">                 * We do this check to avoid multiplication operations.             \</span>
00397 <span class="comment">                 */</span>                                                                 \
00398                 if (sumsquare + (SUMSQUARESTYPE) dy &gt;= leastsumsquare)              \
                    continue;                                                       \
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="mmrtl.c::_MonitorFromWindow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> _MonitorFromWindow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00426">426</a> of file <a class="el" href="../../d0/d1/mmrtl_8c-source.html">mmrtl.c</a>.
<p>
References <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00023">BEGIN_EXCEPTION_HANDLER</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00024">END_EXCEPTION_HANDLER</a>, <a class="el" href="../../d0/d1/mmrtl_8c-source.html#l00012">Int32x32To32</a>, <a class="el" href="../../d9/d1/mmrtl_8c.html#a5">MONITORFROMRECTALGORITHM</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/swp_8c-source.html#l05919">FixBogusSWP()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00490">GetDialogMonitor()</a>, <a class="el" href="../../d6/d2/mnsys_8c-source.html#l00208">IsSmallerThanScreen()</a>, <a class="el" href="../../d4/d0/mmcl_8c-source.html#l00068">MonitorFromWindow()</a>, <a class="el" href="../../d3/d7/swp_8c-source.html#l05753">SelectWindowRgn()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00869">ValidatePositionableWindow()</a>, <a class="el" href="../../d2/d3/combo_8c-source.html#l01819">xxxCBShowListBoxWindow()</a>, <a class="el" href="../../d3/d7/swp_8c-source.html#l05305">xxxCheckFullScreen()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l00033">xxxCreateWindowEx()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l02218">xxxFreeWindow()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l00032">xxxInitSendValidateMinMaxInfo()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l01683">xxxMNPositionHierarchy()</a>, and <a class="el" href="../../d9/d6/winloop2_8c-source.html#l00100">xxxSetTrayWindow()</a>.
<p>
<pre class="fragment"><div>00428                    {
00429 
00430                 <a class="code" href="../../d9/d1/mmrtl_8c.html#a1">BEGIN_EXCEPTION_HANDLER</a>
00431                 <a class="code" href="../../d9/d1/mmrtl_8c.html#a5">MONITORFROMRECTALGORITHM</a>(UINT_MAX, UINT, Int32x32To32)
00432                 END_EXCEPTION_HANDLER
00433 
00434             }
00435 
00436             UserAssert(pMonitorResult != (<a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a>) -1);
00437             return pMonitorResult;
00438         }
00439 
00440     default:
00441         UserAssertMsg0(0, "Logic error in _MonitorFromWindow, shouldn't have gotten here.");
00442         break;
00443     }
00444 
00445     UserAssertMsg0(0, "Logic error in _MonitorFromWindow, shouldn't have gotten here.");
00446     return NULL;
00447 }
00448 
00449 
00450 
00451 <span class="comment">/***************************************************************************\</span>
00452 <span class="comment">* _MonitorFromWindow</span>
00453 <span class="comment">*</span>
00454 <span class="comment">* Calculate the monitor that a window is in or is nearest to. We use</span>
00455 <span class="comment">* the center of the window to determine its location. If the window</span>
00456 <span class="comment">* is minimized, use its normal position.</span>
00457 <span class="comment">*</span>
00458 <span class="comment">* Arguments:</span>
00459 <span class="comment">*     pwnd    - The window.</span>
00460 <span class="comment">*     dwFlags - One of:</span>
00461 <span class="comment">*         MONITOR_DEFAULTTONULL - If the window doesn't intersect a monitor,</span>
00462 <span class="comment">*             return NULL.</span>
00463 <span class="comment">*</span>
00464 <span class="comment">*         MONITOR_DEFAULTTOPRIMARY - If the window doesn't intersect a monitor,</span>
00465 <span class="comment">*             return the primary monitor.</span>
00466 <span class="comment">*</span>
00467 <span class="comment">*         MONITOR_DEFAULTTONEAREST - Return the monitor nearest the window.</span>
00468 <span class="comment">*</span>
00469 <span class="comment">* History:</span>
00470 <span class="comment">* 22-Sep-1996 adams     Created.</span>
00471 <span class="comment">* 29-Mar-1997 adams     Moved to rtl.</span>
00472 <span class="comment">\***************************************************************************/</span>
00473 
00474 PMONITOR
00475 _MonitorFromWindow(<a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, DWORD dwFlags)
00476 {
00477     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>            pwndParent;
00478 
00479     UserAssert(dwFlags == MONITOR_DEFAULTTONULL ||
00480                dwFlags == MONITOR_DEFAULTTOPRIMARY ||
00481                dwFlags == MONITOR_DEFAULTTONEAREST);
00482 
00483     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a792">GetDispInfo</a>()-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o11">cMonitors</a> == 1 &amp;&amp; <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> != MONITOR_DEFAULTTONULL) {
00484         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>();
00485     }
00486 
00487     <span class="keywordflow">if</span> (!pwnd)
00488         <span class="keywordflow">goto</span> NoWindow;
00489 
00490     <span class="comment">/*</span>
00491 <span class="comment">     * Handle minimized windows.</span>
00492 <span class="comment">     */</span>
00493     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, WFMINIMIZED))
00494     {
00495 <span class="preprocessor">#ifdef _USERK_</span>
00496 <span class="preprocessor"></span>        <a class="code" href="../../d0/d0/structtagCHECKPOINT.html">CHECKPOINT</a> *    pcp;
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:47 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
