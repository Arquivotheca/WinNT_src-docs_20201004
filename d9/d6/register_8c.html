<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: register.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>register.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d0/d6/register_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/register_8c.html#a0">SendRegisterMessageToClass</a> (ATOM atomClass, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> ga, HWND hwndFrom, BOOL fPost)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/register_8c.html#a1">RegisterService</a> (BOOL fRegister, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaApp, HWND hwndListen)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/register_8c.html#a2">ProcessRegistrationMessage</a> (HWND hwnd, UINT <a class="el" href="../../d2/d1/userexts_8c.html#a129">msg</a>, WPARAM wParam, LPARAM lParam)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="register.c::ProcessRegistrationMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT ProcessRegistrationMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/register_8c-source.html#l00090">90</a> of file <a class="el" href="../../d0/d6/register_8c-source.html">register.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">GlobalToLocalAtom()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00668">GWLP_INSTANCE_INFO</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00071">INST_SPECIFIC_HSZ_FROM_LATOM</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00367">MakeInstSpecificAtom()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00906">TYPE_WINDOW</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00027">DDEMLMotherWndProc()</a>.
<p>
<pre class="fragment"><div>00095 {
00096     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00097     LRESULT lRet = 0;
00098 
00099     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00100 
00101     <span class="comment">/*</span>
00102 <span class="comment">     * wParam = GATOM of app</span>
00103 <span class="comment">     * lParam = hwndListen of source - may be a WOW DDEML source unthunked.</span>
00104 <span class="comment">     */</span>
00105     lParam = (LPARAM)<a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>((HWND)lParam, TYPE_WINDOW);
00106     lParam = (LPARAM)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>((PVOID)lParam);
00107 
00108     <span class="keywordflow">if</span> (lParam == 0) {
00109         <span class="keywordflow">return</span>(0);
00110     }
00111 
00112     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00113 
00114     pcii = (<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(hwnd, GWLP_INSTANCE_INFO);
00115     <span class="keywordflow">if</span> (pcii != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
00116             !((<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> == UM_REGISTER) &amp;&amp; (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_REGISTRATIONS)) &amp;&amp;
00117             !((<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> == UM_UNREGISTER) &amp;&amp; (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_UNREGISTRATIONS))) {
00118 
00119         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, lais;
00120 
00121         la = <a class="code" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a>((GATOM)wParam);
00122         lais = <a class="code" href="../../d4/d2/hsz_8c.html#a10">MakeInstSpecificAtom</a>(la, (HWND)lParam);
00123 
00124         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcii,
00125                 (WORD)((msg == UM_REGISTER) ? XTYP_REGISTER : XTYP_UNREGISTER),
00126                 0,
00127                 (HCONV)0L,
00128                 (HSZ)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(la),
00129                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a15">INST_SPECIFIC_HSZ_FROM_LATOM</a>(lais),
00130                 (HDDEDATA)0L,
00131                 0L,
00132                 0L);
00133 
00134         DeleteAtom(la);
00135         DeleteAtom(lais);
00136         lRet = 1;
00137     }
00138 
00139     GlobalDeleteAtom((ATOM)wParam);  <span class="comment">// receiver frees</span>
00140     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00141     <span class="keywordflow">return</span>(1);
00142 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="register.c::RegisterService" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RegisterService           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fRegister</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>gaApp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndListen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/register_8c-source.html#l00068">68</a> of file <a class="el" href="../../d0/d6/register_8c-source.html">register.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00357">ICLS_DDEML16BIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00356">ICLS_DDEMLMOTHER</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00030">SendRegisterMessageToClass()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>.
<p>
<pre class="fragment"><div>00072 {
00073     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00074 
00075     <span class="comment">/*</span>
00076 <span class="comment">     * Send notification to each DDEML32 listening window.</span>
00077 <span class="comment">     */</span>
00078     <a class="code" href="../../d9/d6/register_8c.html#a0">SendRegisterMessageToClass</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLMOTHER], fRegister ? UM_REGISTER : UM_UNREGISTER,
00079             gaApp, hwndListen, fRegister);
00080     <span class="comment">/*</span>
00081 <span class="comment">     * Send notification to each DDEML16 listening window.</span>
00082 <span class="comment">     */</span>
00083     <a class="code" href="../../d9/d6/register_8c.html#a0">SendRegisterMessageToClass</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEML16BIT], fRegister ? UM_REGISTER : UM_UNREGISTER,
00084             gaApp, hwndListen, fRegister);
00085 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="register.c::SendRegisterMessageToClass" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SendRegisterMessageToClass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ATOM&nbsp;</td>
          <td class="mdname" nowrap> <em>atomClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ga</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndFrom</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fPost</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/register_8c-source.html#l00030">30</a> of file <a class="el" href="../../d0/d6/register_8c-source.html">register.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01738">tagCLS::atomClassName</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00120">GetDesktopWindow()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00305">GetWindow()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00210">REBASEALWAYS</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00047">ValidateHwndNoRip()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/register_8c-source.html#l00068">RegisterService()</a>.
<p>
<pre class="fragment"><div>00036 {
00037     HWND hwnd;
00038     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00039     <a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a> pcls;
00040 
00041     hwnd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a4">GetDesktopWindow</a>(), GW_CHILD);
00042     <span class="keywordflow">while</span> (hwnd != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00043         pwnd=<a class="code" href="../../d3/d9/client_2wow_8c.html#a1">ValidateHwndNoRip</a>(hwnd);
00044         <span class="keywordflow">if</span> (pwnd) {
00045             pcls = (<a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a24">REBASEALWAYS</a>(pwnd, pcls);
00046             <span class="keywordflow">if</span> (pcls-&gt;<a class="code" href="../../d7/d0/structtagCLS.html#o1">atomClassName</a> == atomClass) {
00047                 <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(ga); <span class="comment">// receiver frees</span>
00048                 <span class="keywordflow">if</span> (fPost) {
00049                     <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(hwnd, msg, (WPARAM)ga, (LPARAM)hwndFrom);
00050                 } <span class="keywordflow">else</span> {
00051                     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwnd, msg, (WPARAM)ga, (LPARAM)hwndFrom);
00052                 }
00053             }
00054         }
00055         hwnd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a12">GetWindow</a>(hwnd, GW_HWNDNEXT);
00056     }
00057 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
