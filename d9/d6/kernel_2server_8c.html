<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kernel/server.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>server.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d0/d6/kernel_2server_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a0">USRINIT_SHAREDSECT_SIZE</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a1">USRINIT_ATOMBUCKET_SIZE</a>&nbsp;&nbsp;&nbsp;37</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a2">USRINIT_WINDOWSECT_SIZE</a>&nbsp;&nbsp;&nbsp;512</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a3">USRINIT_NOIOSECT_SIZE</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a4">USRINIT_SHAREDSECT_BUFF_SIZE</a>&nbsp;&nbsp;&nbsp;640</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a5">USRINIT_SHAREDSECT_READ_SIZE</a>&nbsp;&nbsp;&nbsp;(USRINIT_SHAREDSECT_BUFF_SIZE-33)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a6">WRAPPFN</a>(pfn, <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(member, procname)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a8">InitGlobalRIPFlags</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a9">PAGE_SIZE</a>&nbsp;&nbsp;&nbsp;0x1000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a10">ROUND_UP_TO_PAGES</a>(SIZE)&nbsp;&nbsp;&nbsp;(((ULONG)(SIZE) + PAGE_SIZE - 1) &amp; ~(PAGE_SIZE - 1))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(element)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a49">InitQEntryLookaside</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a50">InitSMSLookaside</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a51">InitCreateSharedSection</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a52">InitCreateObjectDirectory</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a53">InitCreateUserSubsystem</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a54">InitFunctionTables</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a55">InitMessageTables</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a56">InitWindowMsgTable</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> *, <a class="el" href="../../d9/d5/ndismain_8h.html#a266">PUINT</a>, CONST WORD *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a57">VerifySyncOnlyMessages</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a58">InitOLEFormats</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a59">Win32UserInitialize</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a60">WRAPPFN</a> (DesktopWndProc, <a class="el" href="../../d6/d9/structtagWND.html">PWND</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a61">xxxWrapSendMessage</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, ULONG_PTR xParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a62">xxxWrapSendMessageBSM</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, ULONG_PTR xParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a63">xxxUnusedFunctionId</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, ULONG_PTR xParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a64">xxxWrapCallWindowProc</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT message, WPARAM wParam, LPARAM lParam, ULONG_PTR xParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a65">_GetTextMetricsW</a> (HDC hdc, LPTEXTMETRICW ptm)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a66">_TextOutW</a> (HDC hdc, int x, int y, LPCWSTR lp, UINT cc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a67">InitCreateUserCrit</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a68">InitCreateUserSubsystem</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a69">CreateSetupNameArray</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a70">InitMapSharedSection</a> (<a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process, <a class="el" href="../../d6/d4/struct__USERCONNECT.html">PUSERCONNECT</a> pUserConnect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a71">InitLoadResources</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a72">GetCharDimensions</a> (HDC hdc, TEXTMETRIC *lptm, LPINT lpcy)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PMDEV&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a73">InitVideo</a> (BOOL bReenumerationNeeded)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a74">DrvDriverFailure</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a75">UserInitialize</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a76">IsDBCSEnabledSystem</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a77">IsIMMEnabledSystem</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a78">IsMidEastEnabledSystem</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a79">SetupClassAtoms</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDC&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a80">UserGetDesktopDC</a> (ULONG <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, BOOL bAltType, BOOL bValidate)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a81">UserThreadCallout</a> (IN <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> pEThread, IN <a class="el" href="../../d1/d9/ps_8h.html#a79">PSW32THREADCALLOUTTYPE</a> CalloutType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a82">TellGdiToGetReady</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a83">NtUserInitialize</a> (IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwVersion, IN HANDLE hPowerRequestEvent, IN HANDLE hMediaRequestEvent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a84">NtUserProcessConnect</a> (IN HANDLE hProcess, IN OUT PVOID pConnectInfo, IN ULONG cbConnectInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a85">xxxUserProcessCallout</a> (IN PW32PROCESS Process, IN BOOLEAN Initialize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDEV&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a86">UserGetHDEV</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a87">UserGlobalAtomTableCallout</a> (VOID)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a12">gDispatchTableValues</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a13">gbUserInitialized</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a14">szCHECKPOINT_PROP_NAME</a> [] = L"SysCP"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a15">szDDETRACK_PROP_NAME</a> [] = L"SysDT"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a16">szQOS_PROP_NAME</a> [] = L"SysQOS"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a17">szDDEIMP_PROP_NAME</a> [] = L"SysDDEI"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a18">szWNDOBJ_PROP_NAME</a> [] = L"SysWNDO"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a19">szIMELEVEL_PROP_NAME</a> [] = L"SysIMEL"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a20">szLAYER_PROP_NAME</a> [] = L"SysLayer"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a21">szUSER32</a> [] = L"USER32"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a22">szMESSAGE</a> [] = L"Message"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a23">szCONTEXTHELPIDPROP</a> [] = L"SysCH"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a24">szICONSM_PROP_NAME</a> [] = L"SysICS"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a25">szICON_PROP_NAME</a> [] = ICON_PROP_NAME</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a26">szSHELLHOOK</a> [] = L"SHELLHOOK"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a27">szACTIVATESHELLWINDOW</a> [] = L"ACTIVATESHELLWINDOW"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a28">szOTHERWINDOWCREATED</a> [] = L"OTHERWINDOWCREATED"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a29">szOTHERWINDOWDESTROYED</a> [] = L"OTHERWINDOWDESTROYED"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a30">szOLEMAINTHREADWNDCLASS</a> [] = L"OleMainThreadWndClass"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a31">szFLASHWSTATE</a> [] = L"FlashWState"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a32">gawDefDlgProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a33">gawMenuWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a34">gawDesktopWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a35">gawScrollBarWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a36">gawStaticWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a37">gawButtonWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a38">gawListboxWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a39">gawComboWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a40">gawEditWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a41">gawImeWndProc</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a42">gawDefWindowMsgs</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WORD&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a43">gawDefWindowSpecMsgs</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST LPCWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a44">lpszOLEFormats</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST LPCWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a45">lpszControls</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a46">gpastrSetupExe</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a47">giSetupExe</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d6/kernel_2server_8c.html#a48">glpSetupPrograms</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a11" doxytag="kernel/server.c::CALC_DELTA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALC_DELTA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">element&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(PVOID)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pClientBase +          \
        ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.element -         \
        (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a>))
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01640">1640</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01654">InitMapSharedSection()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="kernel/server.c::InitGlobalRIPFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define InitGlobalRIPFlags          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01172">1172</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="kernel/server.c::INITMSGTABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INITMSGTABLE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">member,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>procname&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d9/d6/kernel_2server_8c.html#a56">InitWindowMsgTable</a>(&amp;(<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.member.abMsgs),  \
                       &amp;(<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.member.maxMsgs), \
                       gaw ## procname);
</div></pre>
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01049">InitMessageTables()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="kernel/server.c::PAGE_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PAGE_SIZE&nbsp;&nbsp;&nbsp;0x1000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01214">1214</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="kernel/server.c::ROUND_UP_TO_PAGES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ROUND_UP_TO_PAGES          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SIZE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((ULONG)(SIZE) + PAGE_SIZE - 1) &amp; ~(PAGE_SIZE - 1))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01217">1217</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="kernel/server.c::USRINIT_ATOMBUCKET_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_ATOMBUCKET_SIZE&nbsp;&nbsp;&nbsp;37          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00052">52</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="kernel/server.c::USRINIT_NOIOSECT_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_NOIOSECT_SIZE&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00055">55</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="kernel/server.c::USRINIT_SHAREDSECT_BUFF_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_SHAREDSECT_BUFF_SIZE&nbsp;&nbsp;&nbsp;640          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00057">57</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="kernel/server.c::USRINIT_SHAREDSECT_READ_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_SHAREDSECT_READ_SIZE&nbsp;&nbsp;&nbsp;(USRINIT_SHAREDSECT_BUFF_SIZE-33)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00058">58</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="kernel/server.c::USRINIT_SHAREDSECT_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_SHAREDSECT_SIZE&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00051">51</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01229">InitCreateSharedSection()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="kernel/server.c::USRINIT_WINDOWSECT_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USRINIT_WINDOWSECT_SIZE&nbsp;&nbsp;&nbsp;512          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00054">54</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="kernel/server.c::WRAPPFN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WRAPPFN          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">pfn,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>LRESULT xxxWrap ## pfn(                                      \
    <a class="code" href="../../d6/d9/structtagWND.html">PWND</a>  pwnd,                                              \
    UINT  message,                                           \
    WPARAM wParam,                                           \
    LPARAM lParam,                                           \
    ULONG_PTR xParam)                                         \
{                                                            \
    DBG_UNREFERENCED_PARAMETER(xParam);                      \
                                                             \
    <span class="keywordflow">return</span> xxx ## pfn((type)pwnd, message, wParam, lParam);  \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00745">745</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a65" doxytag="kernel/server.c::_GetTextMetricsW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _GetTextMetricsW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTEXTMETRICW&nbsp;</td>
          <td class="mdname" nowrap> <em>ptm</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01187">1187</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d2/d0/xcpt4_8c-source.html#l02336">fret()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01829">GetCharDimensions()</a>, <a class="el" href="../../d2/d4/caption_8c-source.html#l00688">xxxDrawCaptionTemp()</a>, and <a class="el" href="../../d6/d9/kernel_2text_8c-source.html#l00041">xxxPSMTextOut()</a>.
<p>
<pre class="fragment"><div>01190 {
01191     TMW_INTERNAL tmi;
01192     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>         <a class="code" href="../../d1/d1/xcpt4_8c.html#a13">fret</a>;
01193 
01194     <a class="code" href="../../d1/d1/xcpt4_8c.html#a13">fret</a> = GreGetTextMetricsW(hdc, &amp;tmi);
01195 
01196     *ptm = tmi.tmw;
01197 
01198     <span class="keywordflow">return</span> <a class="code" href="../../d1/d1/xcpt4_8c.html#a13">fret</a>;
01199 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="kernel/server.c::_TextOutW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL _TextOutW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01201">1201</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/kernel_2text_8c-source.html#l00041">xxxPSMTextOut()</a>.
<p>
<pre class="fragment"><div>01207 {
01208     <span class="keywordflow">return</span> GreExtTextOutW(hdc, x, y, 0, NULL, (LPWSTR)lp, cc, NULL);
01209 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="kernel/server.c::CreateSetupNameArray" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CreateSetupNameArray           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">1559</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01173">FastGetProfileValue()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00688">giSetupExe</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00032">glpSetupPrograms</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00031">gpastrSetupExe</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06874">PMAP_SETUPPROGRAMNAMES</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01559                             {
01560     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  dwProgNames;
01561     <span class="keywordtype">int</span>    iSetupProgramCount = 0;
01562     WCHAR* lpTemp;
01563     <span class="keywordtype">int</span>    ic, icnt, icMax;
01564 
01565     dwProgNames = <a class="code" href="../../d4/d1/userk_8h.html#a2013">FastGetProfileValue</a>(NULL, PMAP_SETUPPROGRAMNAMES,
01566                         L<span class="stringliteral">"SetupProgramNames"</span>,NULL,NULL, 0);
01567 
01568     <span class="comment">/*</span>
01569 <span class="comment">     * This key is a multi-string, so is best to read as a value.</span>
01570 <span class="comment">     * First, get the length and create the buffer to hold all of</span>
01571 <span class="comment">     * the strings.</span>
01572 <span class="comment">     */</span>
01573     <span class="keywordflow">if</span> (dwProgNames == 0) {
01574         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01575     }
01576 
01577     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a> = UserAllocPoolWithQuota(dwProgNames,
01578                                        TAG_SYSTEM);
01579 
01580     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01581         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateSetupNameArray: Memory allocation failure"</span>);
01582         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01583     }
01584 
01585     <a class="code" href="../../d4/d1/userk_8h.html#a2013">FastGetProfileValue</a>(NULL,
01586                         PMAP_SETUPPROGRAMNAMES,
01587                         L<span class="stringliteral">"SetupProgramNames"</span>,
01588                         NULL,
01589                         (PBYTE)glpSetupPrograms,
01590                         dwProgNames);
01591 
01592     lpTemp = <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a>;
01593     icMax = dwProgNames/2;
01594     ic = 0; icnt=0;
01595     <span class="comment">/*</span>
01596 <span class="comment">     * Now count the strings.</span>
01597 <span class="comment">     */</span>
01598     <span class="keywordflow">while</span> (ic &lt; icMax) {
01599         <span class="keywordflow">if</span> (*(lpTemp+ic) == 0) {
01600             ic++;
01601             <span class="keywordflow">continue</span>;
01602         }
01603         ic += wcslen(lpTemp+ic)+1;
01604         icnt++;
01605     }
01606 
01607     <span class="comment">/*</span>
01608 <span class="comment">     * gpastrSetupExe is a pointer to an array of UNICODE_STRING structures.</span>
01609 <span class="comment">     * Each structure is the name of one setup program.</span>
01610 <span class="comment">     */</span>
01611     <a class="code" href="../../d6/d3/queue_8c.html#a14">giSetupExe</a> = icnt;
01612     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a> = UserAllocPoolWithQuota(giSetupExe * <span class="keyword">sizeof</span>(UNICODE_STRING),
01613                                        TAG_SYSTEM);
01614 
01615     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01616         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateSetupNameArray: Memory allocation failure"</span>);
01617         <a class="code" href="../../d6/d3/queue_8c.html#a14">giSetupExe</a> = 0;
01618         UserFreePool(glpSetupPrograms);
01619         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01620         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01621     }
01622 
01623     ic = 0; icnt=0;
01624     <span class="keywordflow">while</span> (ic &lt; icMax) {
01625         <span class="keywordflow">if</span> (*(lpTemp+ic) == 0) {
01626             ic++;
01627             <span class="keywordflow">continue</span>;
01628         }
01629         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a>[icnt].Buffer = lpTemp+ic;
01630         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a>[icnt].Length = <span class="keyword">sizeof</span>(WCHAR)*wcslen(lpTemp+ic);
01631         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a>[icnt].MaximumLength = <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a>[icnt].Length + <span class="keyword">sizeof</span>(WCHAR);
01632         ic += wcslen(lpTemp+ic)+1;
01633         icnt++;
01634 
01635     }
01636 
01637     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01638 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="kernel/server.c::DrvDriverFailure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DrvDriverFailure           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01985">1985</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01305">USERCURRENTVERSION</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.
<p>
<pre class="fragment"><div>01986 {
01987     <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(VIDEO_DRIVER_INIT_FAILURE,
01988                  0,
01989                  0,
01990                  0,
01991                  USERCURRENTVERSION);
01992 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="kernel/server.c::GetCharDimensions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int GetCharDimensions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>TEXTMETRIC *&nbsp;</td>
          <td class="mdname" nowrap> <em>lptm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpcy</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01829">1829</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01187">_GetTextMetricsW()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00564">UpdateUserScreen()</a>, <a class="el" href="../../d7/d1/mndraw_8c-source.html#l01972">xxxDrawMenuBarTemp()</a>, and <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00861">xxxSetNCFonts()</a>.
<p>
<pre class="fragment"><div>01834 {
01835     TEXTMETRIC tm;
01836 
01837     <span class="comment">/*</span>
01838 <span class="comment">     * Didn't find it in cache, store the font metrics info.</span>
01839 <span class="comment">     */</span>
01840     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a1933">_GetTextMetricsW</a>(hdc, &amp;tm)) {
01841         RIPMSG1(RIP_WARNING, <span class="stringliteral">"GetCharDimensions: _GetTextMetricsW failed. hdc %#lx"</span>, hdc);
01842         tm = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;tmSysFont; <span class="comment">// damage control</span>
01843 
01844         <span class="keywordflow">if</span> (tm.tmAveCharWidth == 0) {
01845             RIPMSG0(RIP_WARNING, <span class="stringliteral">"GetCharDimensions: _GetTextMetricsW first time failure"</span>);
01846             tm.tmAveCharWidth = 8;
01847         }
01848     }
01849     <span class="keywordflow">if</span> (lptm != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01850         *lptm = tm;
01851     <span class="keywordflow">if</span> (lpcy != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01852         *lpcy = tm.tmHeight;
01853 
01854     <span class="comment">/*</span>
01855 <span class="comment">     * If variable_width font</span>
01856 <span class="comment">     */</span>
01857     <span class="keywordflow">if</span> (tm.tmPitchAndFamily &amp; TMPF_FIXED_PITCH) {
01858         SIZE size;
01859         <span class="keyword">static</span> CONST WCHAR wszAvgChars[] =
01860                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;
01861 
01862         <span class="comment">/*</span>
01863 <span class="comment">         * Change from tmAveCharWidth.  We will calculate a true average</span>
01864 <span class="comment">         * as opposed to the one returned by tmAveCharWidth.  This works</span>
01865 <span class="comment">         * better when dealing with proportional spaced fonts.</span>
01866 <span class="comment">         */</span>
01867         <span class="keywordflow">if</span> (GreGetTextExtentW(
01868                 hdc, (LPWSTR)wszAvgChars,
01869                 (<span class="keyword">sizeof</span>(wszAvgChars) / <span class="keyword">sizeof</span>(WCHAR)) - 1,
01870                 &amp;size, GGTE_WIN3_EXTENT)) {
01871 
01872             UserAssert((((size.cx / 26) + 1) / 2) &gt; 0);
01873             <span class="keywordflow">return</span> ((size.cx / 26) + 1) / 2;    <span class="comment">// round up</span>
01874         } <span class="keywordflow">else</span> {
01875             RIPMSG1(RIP_WARNING, <span class="stringliteral">"GetCharDimensions: GreGetTextExtentW failed. hdc %#lx"</span>, hdc);
01876         }
01877     }
01878 
01879     UserAssert(tm.tmAveCharWidth &gt; 0);
01880 
01881     <span class="keywordflow">return</span> tm.tmAveCharWidth;
01882 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="kernel/server.c::InitCreateObjectDirectory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitCreateObjectDirectory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01417">1417</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d2/d9/kernel_2exitwin_8c-source.html#l00026">gpsdInitWinSta</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l00041">szWindowStationDirectory</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.
<p>
<pre class="fragment"><div>01418 {
01419     HANDLE            hDir;
01420     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>          <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01421     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
01422     UNICODE_STRING    UnicodeString;
01423     ULONG             attributes = OBJ_CASE_INSENSITIVE | OBJ_PERMANENT;
01424 
01425     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Create User Object-Directory\n"</span>));
01426 
01427     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;UnicodeString, szWindowStationDirectory);
01428 
01429     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>) {
01430        <span class="comment">/*</span>
01431 <span class="comment">        * Remote sessions don't use this flag</span>
01432 <span class="comment">        */</span>
01433        attributes &amp;= ~OBJ_PERMANENT;
01434     }
01435 
01436     InitializeObjectAttributes(&amp;ObjectAttributes,
01437                                &amp;UnicodeString,
01438                                attributes,
01439                                NULL,
01440                                gpsdInitWinSta);
01441 
01442     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwCreateDirectoryObject(&amp;hDir,
01443                                      DIRECTORY_CREATE_OBJECT,
01444                                      &amp;ObjectAttributes);
01445 
01446     UserFreePool(gpsdInitWinSta);
01447 
01448     <span class="comment">/*</span>
01449 <span class="comment">     * Do not close this handle for remote session because</span>
01450 <span class="comment">     * if we do close it then the directory will go away and</span>
01451 <span class="comment">     * we don't want that to happen. When CSRSS will go away</span>
01452 <span class="comment">     * this handle will be freed also.</span>
01453 <span class="comment">     */</span>
01454     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>)
01455         ZwClose(hDir);
01456 
01457     <a class="code" href="../../d1/d0/kernel_2exitwin_8c.html#a5">gpsdInitWinSta</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01458 
01459     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01460 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="kernel/server.c::InitCreateSharedSection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitCreateSharedSection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01229">1229</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00918">ghSectionShared</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00921">gpvSharedAlloc</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00919">gpvSharedBase</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1030">HANDLEENTRY</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d0/d9/csrdll_8h-source.html#l00124">ROUND_UP_TO_PAGES</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d3/d8/w32_2ntuser_2kernel_2heap_8c-source.html#l00133">UserCommitSharedMemory()</a>, <a class="el" href="../../d3/d8/w32_2ntuser_2kernel_2heap_8c-source.html#l00189">UserCreateHeap()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00051">USRINIT_SHAREDSECT_SIZE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01230 {
01231     ULONG             ulHeapSize;
01232     ULONG             ulHandleTableSize;
01233     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>          <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01234     LARGE_INTEGER     SectionSize;
01235     SIZE_T            ViewSize;
01236     PVOID             pHeapBase;
01237 
01238     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Create Shared Memory Section\n"</span>));
01239 
01240     UserAssert(ghSectionShared == NULL);
01241 
01242     ulHeapSize        = <a class="code" href="../../d9/d9/csrdll_8h.html#a3">ROUND_UP_TO_PAGES</a>(USRINIT_SHAREDSECT_SIZE * 1024);
01243     ulHandleTableSize = <a class="code" href="../../d9/d9/csrdll_8h.html#a3">ROUND_UP_TO_PAGES</a>(0x10000 * <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html">HANDLEENTRY</a>));
01244 
01245     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Share: TableSize = %X; HeapSize = %X\n"</span>,
01246             ulHandleTableSize, ulHeapSize));
01247 
01248     SectionSize.LowPart  = ulHeapSize + ulHandleTableSize;
01249     SectionSize.HighPart = 0;
01250 
01251     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = Win32CreateSection(&amp;ghSectionShared,
01252                                 SECTION_ALL_ACCESS,
01253                                 (POBJECT_ATTRIBUTES)NULL,
01254                                 &amp;SectionSize,
01255                                 PAGE_EXECUTE_READWRITE,
01256                                 SEC_RESERVE,
01257                                 (HANDLE)NULL,
01258                                 NULL,
01259                                 TAG_SECTION_SHARED);
01260 
01261     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01262         RIPMSG1(RIP_WARNING,
01263                 <span class="stringliteral">"MmCreateSection failed in InitCreateSharedSection with Status %x"</span>,
01264                 Status);
01265         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01266     }
01267 
01268     ViewSize = 0;
01269     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01270 
01271     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = Win32MapViewInSessionSpace(ghSectionShared, &amp;gpvSharedBase, &amp;ViewSize);
01272 
01273     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01274         RIPMSG1(RIP_WARNING, <span class="stringliteral">"Win32MapViewInSessionSpace failed with Status %x"</span>,
01275                 Status);
01276         Win32DestroySection(ghSectionShared);
01277         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a320">ghSectionShared</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01278         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01279     }
01280 
01281     pHeapBase = ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a> + ulHandleTableSize);
01282 
01283     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Share: BaseAddr = %X; Heap = %X, ViewSize = %X\n"</span>,
01284             gpvSharedBase, pHeapBase, ViewSize));
01285 
01286     <span class="comment">/*</span>
01287 <span class="comment">     * Create shared heap.</span>
01288 <span class="comment">     */</span>
01289     <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a322">gpvSharedAlloc</a> = <a class="code" href="../../d4/d1/userk_8h.html#a999">UserCreateHeap</a>(
01290             ghSectionShared,
01291             ulHandleTableSize,
01292             pHeapBase,
01293             ulHeapSize,
01294             UserCommitSharedMemory)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01295 
01296         RIPERR0(ERROR_NOT_ENOUGH_MEMORY, RIP_WARNING, <span class="stringliteral">"Can't create shared memory heap."</span>);
01297 
01298         Win32UnmapViewInSessionSpace(gpvSharedBase);
01299 
01300         Win32DestroySection(ghSectionShared);
01301         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a322">gpvSharedAlloc</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01302         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01303         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a320">ghSectionShared</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01304 
01305         <span class="keywordflow">return</span> STATUS_NO_MEMORY;
01306     }
01307 
01308     UserAssert(Win32HeapGetHandle(gpvSharedAlloc) == pHeapBase);
01309 
01310     <span class="keywordflow">return</span> STATUS_SUCCESS;
01311 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="kernel/server.c::InitCreateUserCrit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitCreateUserCrit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">1322</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a125">ERESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00367">ExInitializeFastMutex</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00209">ExInitializeResourceLite()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00758">gpHandleFlagsMutex</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00523">gpresDeviceInfoList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00537">gpresMouseEventQueue</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00757">gpresUser</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01323 {
01324     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: InitCreateUserCrit()\n"</span>));
01325 
01326     <span class="comment">/*</span>
01327 <span class="comment">     * Initialize a critical section structure that will be used to protect</span>
01328 <span class="comment">     * all of the User Server's critical sections (except a few special</span>
01329 <span class="comment">     * cases like the RIT -- see below).</span>
01330 <span class="comment">     */</span>
01331     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a278">gpresUser</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01332                                       <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>),
01333                                       TAG_ERESOURCE);
01334     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a278">gpresUser</a>) {
01335         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01336     }
01337     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d5/d8/ex_8h.html#a266">ExInitializeResourceLite</a>(gpresUser))) {
01338         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01339     }
01340 
01341     <span class="comment">/*</span>
01342 <span class="comment">     * Initialize a critical section to be used in [Un]QueueMouseEvent</span>
01343 <span class="comment">     * to protect the queue of mouse input events that the desktop thread</span>
01344 <span class="comment">     * uses to pass input on to the RIT, after having moved the cursor</span>
01345 <span class="comment">     * without obtaining gpresUser itself.</span>
01346 <span class="comment">     */</span>
01347     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a212">gpresMouseEventQueue</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01348                                                  <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>),
01349                                                  TAG_ERESOURCE);
01350     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a212">gpresMouseEventQueue</a>) {
01351         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01352     }
01353     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d5/d8/ex_8h.html#a266">ExInitializeResourceLite</a>(gpresMouseEventQueue))) {
01354         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01355     }
01356 
01357     <span class="comment">/*</span>
01358 <span class="comment">     * Initialize a critical section to protect the list of DEVICEINFO structs</span>
01359 <span class="comment">     * kept under gpDeviceInfoList.  This is used by the RIT when reading kbd</span>
01360 <span class="comment">     * input, the desktop thread when reading mouse input, and the PnP callback</span>
01361 <span class="comment">     * routines DeviceClassNotify() and DeviceNotify() when devices come and go.</span>
01362 <span class="comment">     */</span>
01363     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a206">gpresDeviceInfoList</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01364                                             <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>),
01365                                             TAG_ERESOURCE);
01366     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a206">gpresDeviceInfoList</a>) {
01367         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01368     }
01369     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d5/d8/ex_8h.html#a266">ExInitializeResourceLite</a>(gpresDeviceInfoList))) {
01370         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01371     }
01372 
01373     <span class="comment">/*</span>
01374 <span class="comment">     * Create the handle flag mutex. We'll need this once we start creating</span>
01375 <span class="comment">     * windowstations and desktops.</span>
01376 <span class="comment">     */</span>
01377     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a279">gpHandleFlagsMutex</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01378                                                <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>),
01379                                                TAG_SYSTEM);
01380     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a279">gpHandleFlagsMutex</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01381         <span class="keywordflow">goto</span> InitCreateUserCritExit;
01382     }
01383     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(gpHandleFlagsMutex);
01384 
01385     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: gpHandleFlagsMutex = 0x%p\n"</span>, gpHandleFlagsMutex));
01386     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: gpresDeviceInfoList = 0x%X\n"</span>, gpresDeviceInfoList));
01387     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: gpresMouseEventQueue = 0x%X\n"</span>, gpresMouseEventQueue));
01388     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: gpresUser  = 0x%X\n"</span>, gpresUser));
01389 
01390     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Win32UserInit: exit InitCreateUserCrit()\n"</span>));
01391     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01392 
01393 InitCreateUserCritExit:
01394     RIPERR0(ERROR_NOT_ENOUGH_MEMORY, RIP_ERROR,
01395             <span class="stringliteral">"Win32UserInit: InitCreateUserCrit failed"</span>);
01396 
01397     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a278">gpresUser</a>) {
01398         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresUser);
01399     }
01400     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a212">gpresMouseEventQueue</a>) {
01401         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresMouseEventQueue);
01402     }
01403     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a206">gpresDeviceInfoList</a>) {
01404         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresDeviceInfoList);
01405     }
01406     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01407 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="kernel/server.c::InitCreateUserSubsystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitCreateUserSubsystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">1471</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00806">FastGetProfileStringW()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00851">gdwDesktopSectionSize</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00852">gdwNOIOSectionSize</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06850">PMAP_SUBSYSTEMS</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00225">RtlUnicodeStringToInteger()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00055">USRINIT_NOIOSECT_SIZE</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00057">USRINIT_SHAREDSECT_BUFF_SIZE</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00058">USRINIT_SHAREDSECT_READ_SIZE</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00054">USRINIT_WINDOWSECT_SIZE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01472 {
01473     LPWSTR         lpszSubSystem;
01474     LPWSTR         lpszT;
01475     UNICODE_STRING strSize;
01476 
01477     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Create User SubSystem\n"</span>));
01478 
01479     <span class="comment">/*</span>
01480 <span class="comment">     * Initialize the subsystem section.  This identifies the default</span>
01481 <span class="comment">     * user-heap size.</span>
01482 <span class="comment">     */</span>
01483     lpszSubSystem = UserAllocPoolWithQuota(USRINIT_SHAREDSECT_BUFF_SIZE * <span class="keyword">sizeof</span>(WCHAR),
01484                                            TAG_SYSTEM);
01485 
01486     <span class="keywordflow">if</span> (lpszSubSystem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01487         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01488     }
01489 
01490     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a2007">FastGetProfileStringW</a>(NULL, PMAP_SUBSYSTEMS,
01491                               L<span class="stringliteral">"Windows"</span>,
01492                               L<span class="stringliteral">"SharedSection=,3072"</span>,
01493                               lpszSubSystem,
01494                               USRINIT_SHAREDSECT_READ_SIZE
01495                               ) == 0) {
01496         RIPMSG0(RIP_WARNING,
01497                 <span class="stringliteral">"UserInit: Windows subsystem definition not found"</span>);
01498         UserFreePool(lpszSubSystem);
01499         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01500     }
01501 
01502     <span class="comment">/*</span>
01503 <span class="comment">     * Locate the SharedSection portion of the definition and extract</span>
01504 <span class="comment">     * the second value.</span>
01505 <span class="comment">     */</span>
01506     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a309">gdwDesktopSectionSize</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a2">USRINIT_WINDOWSECT_SIZE</a>;
01507     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a310">gdwNOIOSectionSize</a>    = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a3">USRINIT_NOIOSECT_SIZE</a>;
01508 
01509     <span class="keywordflow">if</span> (lpszT = wcsstr(lpszSubSystem, L<span class="stringliteral">"SharedSection"</span>)) {
01510 
01511         *(lpszT + 32) = UNICODE_NULL;
01512 
01513         <span class="keywordflow">if</span> (lpszT = wcschr(lpszT, L<span class="charliteral">','</span>)) {
01514 
01515             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strSize, ++lpszT);
01516             <a class="code" href="../../d9/d3/cnvint_8c.html#a4">RtlUnicodeStringToInteger</a>(&amp;strSize, 0, &amp;gdwDesktopSectionSize);
01517 
01518             <span class="comment">/*</span>
01519 <span class="comment">             * Assert this logic doesn't need to change.</span>
01520 <span class="comment">             */</span>
01521             UserAssert(gdwDesktopSectionSize &gt;= USRINIT_WINDOWSECT_SIZE);
01522 
01523             <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a309">gdwDesktopSectionSize</a> = <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(USRINIT_WINDOWSECT_SIZE, gdwDesktopSectionSize);
01524             <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a310">gdwNOIOSectionSize</a>    = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a309">gdwDesktopSectionSize</a>;
01525 
01526             <span class="comment">/*</span>
01527 <span class="comment">             * Now see if the optional non-interactive desktop</span>
01528 <span class="comment">             * heap size was specified.</span>
01529 <span class="comment">             */</span>
01530             <span class="keywordflow">if</span> (lpszT = wcschr(lpszT, L<span class="charliteral">','</span>)) {
01531 
01532                 <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strSize, ++lpszT);
01533                 <a class="code" href="../../d9/d3/cnvint_8c.html#a4">RtlUnicodeStringToInteger</a>(&amp;strSize, 0, &amp;gdwNOIOSectionSize);
01534 
01535                 UserAssert(gdwNOIOSectionSize &gt;= USRINIT_NOIOSECT_SIZE);
01536                 <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a310">gdwNOIOSectionSize</a> = <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(USRINIT_NOIOSECT_SIZE, gdwNOIOSectionSize);
01537             }
01538         }
01539     }
01540 
01541     UserFreePool(lpszSubSystem);
01542 
01543     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01544 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="kernel/server.c::InitCreateUserSubsystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitCreateUserSubsystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="kernel/server.c::InitFunctionTables" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitFunctionTables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">975</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00842">CBFNID</a>, <a class="el" href="../../d0/d4/srvhook_8c-source.html#l00490">fnHkINLPCWPEXSTRUCT()</a>, <a class="el" href="../../d0/d4/srvhook_8c-source.html#l00512">fnHkINLPCWPRETEXSTRUCT()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00840">FNID</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00829">FNID_ARRAY_SIZE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00815">FNID_CALLWINDOWPROC</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00788">FNID_DEFWINDOWPROC</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00787">FNID_DESKTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00805">FNID_HKINLPCWPEXSTRUCT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00806">FNID_HKINLPCWPRETEXSTRUCT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00785">FNID_ICONTITLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00786">FNID_MENU</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00784">FNID_SCROLLBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00811">FNID_SENDMESSAGE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00816">FNID_SENDMESSAGEBSM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00814">FNID_SENDMESSAGEEX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00813">FNID_SENDMESSAGEFF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00781">FNID_START</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00790">FNID_WNDPROCEND</a>, <a class="el" href="../../d4/d1/userk_8h.html#a844">MENUWND</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1092">SBWND</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00841">STOCID</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00845">WNDPROC_PWND</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00883">xxxDesktopWndProc()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d9/d3/sbctl_8c-source.html#l02582">xxxSBWndProc()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00609">xxxSendMessageEx()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00556">xxxSendMessageFF()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00822">xxxUnusedFunctionId()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00849">xxxWrapCallWindowProc()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00763">xxxWrapSendMessage()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00781">xxxWrapSendMessageBSM()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>00976 {
00977     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> i;
00978 
00979     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Initialize Function Tables\n"</span>));
00980 
00981     UserAssert(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d2/struct__CLIENTINFO.html">CLIENTINFO</a>) &lt;= <span class="keyword">sizeof</span>(NtCurrentTeb()-&gt;Win32ClientInfo));
00982 
00983     <span class="comment">/*</span>
00984 <span class="comment">     * This table is used to convert from server procs to client procs.</span>
00985 <span class="comment">     */</span>
00986     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_SCROLLBAR)              = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a988">WNDPROC_PWND</a>)<a class="code" href="../../d8/d4/sbctl_8c.html#a47">xxxSBWndProc</a>;
00987     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_ICONTITLE)              = <a class="code" href="../../d8/d3/dwp_8c.html#a17">xxxDefWindowProc</a>;
00988     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_MENU)                   = <a class="code" href="../../d2/d7/ntuser_2kernel_2menu_8c.html#a43">xxxMenuWindowProc</a>;
00989     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_DESKTOP)                = <a class="code" href="../../d9/d6/desktop_8c.html#a10">xxxDesktopWndProc</a>;
00990     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_DEFWINDOWPROC)          = <a class="code" href="../../d8/d3/dwp_8c.html#a17">xxxDefWindowProc</a>;
00991 
00992     <span class="comment">/*</span>
00993 <span class="comment">     * This table is used to determine the number minimum number</span>
00994 <span class="comment">     * of reserved windows words required for the server proc.</span>
00995 <span class="comment">     */</span>
00996     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a231">CBFNID</a>(FNID_SCROLLBAR)              = <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d5/structtagSBWND.html">SBWND</a>);
00997     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a231">CBFNID</a>(FNID_ICONTITLE)              = <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">WND</a>);
00998     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a231">CBFNID</a>(FNID_MENU)                   = <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d1/structtagMENUWND.html">MENUWND</a>);
00999 
01000     <span class="comment">/*</span>
01001 <span class="comment">     * Initialize this data structure (api function table).</span>
01002 <span class="comment">     */</span>
01003     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a224">FNID_ARRAY_SIZE</a>; i++) {
01004         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>((i + FNID_START)) = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a63">xxxUnusedFunctionId</a>;
01005     }
01006     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_SCROLLBAR)                = xxxWrapSBWndProc;
01007     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_ICONTITLE)                = xxxWrapDefWindowProc;
01008     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_MENU)                     = xxxWrapMenuWindowProc;
01009     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_DESKTOP)                  = xxxWrapDesktopWndProc;
01010     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_DEFWINDOWPROC)            = xxxWrapDefWindowProc;
01011     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_SENDMESSAGE)              = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a61">xxxWrapSendMessage</a>;
01012     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_HKINLPCWPEXSTRUCT)        = <a class="code" href="../../d9/d4/srvhook_8c.html#a2">fnHkINLPCWPEXSTRUCT</a>;
01013     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_HKINLPCWPRETEXSTRUCT)     = <a class="code" href="../../d9/d4/srvhook_8c.html#a3">fnHkINLPCWPRETEXSTRUCT</a>;
01014     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_SENDMESSAGEFF)            = <a class="code" href="../../d3/d6/kernel_2sendmsg_8c.html#a21">xxxSendMessageFF</a>;
01015     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_SENDMESSAGEEX)            = <a class="code" href="../../d3/d6/kernel_2sendmsg_8c.html#a22">xxxSendMessageEx</a>;
01016     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_CALLWINDOWPROC)           = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a64">xxxWrapCallWindowProc</a>;
01017     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_SENDMESSAGEBSM)           = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a62">xxxWrapSendMessageBSM</a>;
01018 
01019 <span class="preprocessor">#if DBG</span>
01020 <span class="preprocessor"></span>    {
01021         PULONG_PTR pdw;
01022 
01023         <span class="comment">/*</span>
01024 <span class="comment">         * Make sure that everyone got initialized.</span>
01025 <span class="comment">         */</span>
01026         <span class="keywordflow">for</span> (pdw=(PULONG_PTR)&amp;<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_START);
01027                 (ULONG_PTR)pdw&lt;(ULONG_PTR)(&amp;<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a230">STOCID</a>(FNID_WNDPROCEND)); pdw++) {
01028             UserAssert(*pdw);
01029         }
01030 
01031         <span class="keywordflow">for</span> (pdw=(PULONG_PTR)&amp;<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_START);
01032                 (ULONG_PTR)pdw&lt;(ULONG_PTR)(&amp;<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a229">FNID</a>(FNID_WNDPROCEND)); pdw++) {
01033             UserAssert(*pdw);
01034         }
01035     }
01036 <span class="preprocessor">#endif</span>
01037 <span class="preprocessor"></span>
01038 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="kernel/server.c::InitLoadResources" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitLoadResources           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01738">1738</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l04556">tagDISPLAYRESOURCE::cxBorder</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04557">tagDISPLAYRESOURCE::cyBorder</a>, <a class="el" href="../../d4/d1/userk_8h.html#a914">DISPLAYRESOURCE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02604">GetPrimaryMonitor()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02157">tagMONITOR::rcMonitor</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04553">tagDISPLAYRESOURCE::xCompressCursor</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04551">tagDISPLAYRESOURCE::xCompressIcon</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04554">tagDISPLAYRESOURCE::yCompressCursor</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04552">tagDISPLAYRESOURCE::yCompressIcon</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l04555">tagDISPLAYRESOURCE::yKanji</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00020">RemoteConnect()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.
<p>
<pre class="fragment"><div>01739 {
01740     PRECT   prc;
01741 
01742     <a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html">DISPLAYRESOURCE</a> dr = {
01743         17,     <span class="comment">// Height of vertical thumb</span>
01744         17,     <span class="comment">// Width of horizontal thumb</span>
01745         2,      <span class="comment">// Icon horiz compression factor</span>
01746         2,      <span class="comment">// Icon vert compression factor</span>
01747         1,      <span class="comment">// Cursor horz compression factor</span>
01748         1,      <span class="comment">// Cursor vert compression factor</span>
01749         0,      <span class="comment">// Kanji window height</span>
01750         1,      <span class="comment">// cxBorder (thickness of vertical lines)</span>
01751         1       <span class="comment">// cyBorder (thickness of horizontal lines)</span>
01752     };
01753 
01754 
01755     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Load Display Resources\n"</span>));
01756 
01757     <span class="keywordflow">if</span> (dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o2">xCompressIcon</a> &gt; 10) {
01758 
01759         <span class="comment">/*</span>
01760 <span class="comment">         * If so, the actual dimensions of icons and cursors are</span>
01761 <span class="comment">         * kept in OEMBIN.</span>
01762 <span class="comment">         */</span>
01763         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXICON)   = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o2">xCompressIcon</a>;
01764         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYICON)   = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o3">yCompressIcon</a>;
01765         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXCURSOR) = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o4">xCompressCursor</a>;
01766         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYCURSOR) = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o5">yCompressCursor</a>;
01767 
01768     } <span class="keywordflow">else</span> {
01769 
01770         <span class="comment">/*</span>
01771 <span class="comment">         * Else, only the ratio of (64/icon dimensions) is kept there.</span>
01772 <span class="comment">         */</span>
01773         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXICON)   = (64 / dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o2">xCompressIcon</a>);
01774         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYICON)   = (64 / dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o3">yCompressIcon</a>);
01775         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXCURSOR) = (32 / dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o4">xCompressCursor</a>);
01776         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYCURSOR) = (32 / dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o5">yCompressCursor</a>);
01777     }
01778 
01779     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXSMICON) = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXICON) / 2;
01780     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYSMICON) = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYICON) / 2;
01781 
01782     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYKANJIWINDOW) = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o6">yKanji</a>;
01783 
01784     <span class="comment">/*</span>
01785 <span class="comment">     * Get border thicknesses.</span>
01786 <span class="comment">     */</span>
01787     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER) = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o7">cxBorder</a>;
01788     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER) = dr.<a class="code" href="../../d0/d4/structtagDISPLAYRESOURCE.html#o8">cyBorder</a>;
01789 
01790     <span class="comment">/*</span>
01791 <span class="comment">     * Edge is two borders.</span>
01792 <span class="comment">     */</span>
01793     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE) = 2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER);
01794     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE) = 2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
01795 
01796     <span class="comment">/*</span>
01797 <span class="comment">     * Fixed frame is outer edge + border.</span>
01798 <span class="comment">     */</span>
01799     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXDLGFRAME) = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE) + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER);
01800     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYDLGFRAME) = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE) + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
01801 
01802     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>) {
01803         <span class="keywordflow">return</span>;
01804     }
01805 
01806     prc = &amp;<a class="code" href="../../d6/d0/usercli_8h.html#a793">GetPrimaryMonitor</a>()-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o3">rcMonitor</a>;
01807     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXFULLSCREEN) = prc-&gt;right;
01808     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYFULLSCREEN) = prc-&gt;bottom - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYCAPTION);
01809 
01810     <span class="comment">/*</span>
01811 <span class="comment">     * Set the initial cursor position to the center of the primary screen.</span>
01812 <span class="comment">     */</span>
01813     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;ptCursor.x = prc-&gt;right / 2;
01814     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;ptCursor.y = prc-&gt;bottom / 2;
01815 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="kernel/server.c::InitMapSharedSection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitMapSharedSection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d4/struct__USERCONNECT.html">PUSERCONNECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pUserConnect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01654">1654</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01273">_WNDMSG::abMsgs</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01278">tagSHAREDINFO::aheList</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01355">tagSHAREDINFO::awmControl</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01640">CALC_DELTA</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01357">tagSHAREDINFO::DefWindowMsgs</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01358">tagSHAREDINFO::DefWindowSpecMsgs</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00819">FNID_END</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00781">FNID_START</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00918">ghSectionShared</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00919">gpvSharedBase</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00052">gSharedInfo</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01344">_WNDMSG::maxMsgs</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00753">MmMapViewOfSection()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01279">tagSHAREDINFO::pDispInfo</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01277">tagSHAREDINFO::psi</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1006">PUSERCONNECT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01365">_USERCONNECT::siClient</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01280">tagSHAREDINFO::ulSharedDelta</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04498">ValidateProcessSessionId</a>, and <a class="el" href="../../d2/d8/ps_8h-source.html#l00284">_EPROCESS::Win32Process</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02788">NtUserProcessConnect()</a>.
<p>
<pre class="fragment"><div>01657 {
01658     <span class="keywordtype">int</span>           i;
01659     PVOID         pClientBase = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01660     ULONG_PTR      ulSharedDelta;
01661 
01662     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Map Shared Memory Section\n"</span>));
01663 
01664     UserAssert(ghSectionShared != NULL);
01665 
01666     <a class="code" href="../../d4/d1/userk_8h.html#a519">ValidateProcessSessionId</a>(Process);
01667 
01668     <span class="comment">/*</span>
01669 <span class="comment">     * Check to see if we haven't already mapped the section</span>
01670 <span class="comment">     * This might happen for multiple LoadLibrary()/FreeLibrary calls</span>
01671 <span class="comment">     * in one process.  MCostea #56946</span>
01672 <span class="comment">     */</span>
01673     <span class="keywordflow">if</span> (Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ||
01674         ((<a class="code" href="../../d7/d3/structtagPROCESSINFO.html">PPROCESSINFO</a>)Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a>)-&gt;pClientBase == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01675 
01676         SIZE_T        ViewSize;
01677         LARGE_INTEGER liOffset;
01678         <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01679 
01680         ViewSize = 0;
01681         liOffset.QuadPart = 0;
01682 
01683         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d5/mapview_8c.html#a21">MmMapViewOfSection</a>(ghSectionShared,
01684                                 Process,
01685                                 &amp;pClientBase,
01686                                 0,
01687                                 0,
01688                                 &amp;liOffset,
01689                                 &amp;ViewSize,
01690                                 ViewUnmap,
01691                                 SEC_NO_CHANGE,
01692                                 PAGE_EXECUTE_READ);
01693         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01694             <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Map: Client SharedInfo Base = %x\n"</span>, pClientBase));
01695 
01696             UserAssert(gpvSharedBase &gt; pClientBase);
01697             <span class="keywordflow">if</span> (Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01698                 ((<a class="code" href="../../d7/d3/structtagPROCESSINFO.html">PPROCESSINFO</a>)Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a>)-&gt;pClientBase = pClientBase;
01699             }
01700         } <span class="keywordflow">else</span> {
01701             <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01702         }
01703 
01704     } <span class="keywordflow">else</span> {
01705         pClientBase = ((<a class="code" href="../../d7/d3/structtagPROCESSINFO.html">PPROCESSINFO</a>)Process-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a>)-&gt;pClientBase;
01706     }
01707     ulSharedDelta = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a> - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pClientBase;
01708     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o3">ulSharedDelta</a> = ulSharedDelta;
01709 
01710     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o0">psi</a>          = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(psi);
01711     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o1">aheList</a>      = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(aheList);
01712     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o2">pDispInfo</a>    = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(pDispInfo);
01713 
01714 
01715     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o6">DefWindowMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a>     = <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o6">DefWindowMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a>;
01716     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o6">DefWindowMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o1">abMsgs</a>      = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(DefWindowMsgs.abMsgs);
01717     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o7">DefWindowSpecMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o7">DefWindowSpecMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a>;
01718     pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o7">DefWindowSpecMsgs</a>.<a class="code" href="../../d1/d9/struct__WNDMSG.html#o1">abMsgs</a>  = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(DefWindowSpecMsgs.abMsgs);
01719 
01720     <span class="keywordflow">for</span> (i = 0; i &lt; (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a223">FNID_END</a> - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a191">FNID_START</a> + 1); ++i) {
01721 
01722         pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o5">awmControl</a>[i].<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o5">awmControl</a>[i].<a class="code" href="../../d1/d9/struct__WNDMSG.html#o0">maxMsgs</a>;
01723 
01724         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o5">awmControl</a>[i].<a class="code" href="../../d1/d9/struct__WNDMSG.html#o1">abMsgs</a>)
01725             pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o5">awmControl</a>[i].<a class="code" href="../../d1/d9/struct__WNDMSG.html#o1">abMsgs</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a11">CALC_DELTA</a>(awmControl[i].abMsgs);
01726         <span class="keywordflow">else</span>
01727             pUserConnect-&gt;<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o3">siClient</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o5">awmControl</a>[i].<a class="code" href="../../d1/d9/struct__WNDMSG.html#o1">abMsgs</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01728     }
01729     <span class="keywordflow">return</span> STATUS_SUCCESS;
01730 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="kernel/server.c::InitMessageTables" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitMessageTables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01049">1049</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00079">EditWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00793">FNID_BUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00794">FNID_COMBOBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00795">FNID_COMBOLISTBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00787">FNID_DESKTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00796">FNID_DIALOG</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00797">FNID_EDIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00802">FNID_IME</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00798">FNID_LISTBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00786">FNID_MENU</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00784">FNID_SCROLLBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00781">FNID_START</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00800">FNID_STATIC</a>, <a class="el" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01050 {
01051     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Initialize Message Tables\n"</span>));
01052 
01053 <span class="preprocessor">#define INITMSGTABLE(member, procname)                \</span>
01054 <span class="preprocessor">    InitWindowMsgTable(&amp;(gSharedInfo.member.abMsgs),  \</span>
01055 <span class="preprocessor">                       &amp;(gSharedInfo.member.maxMsgs), \</span>
01056 <span class="preprocessor">                       gaw ## procname);</span>
01057 <span class="preprocessor"></span>
01058     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(DefWindowMsgs, DefWindowMsgs);
01059     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(DefWindowSpecMsgs, DefWindowSpecMsgs);
01060 
01061     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_DIALOG       - FNID_START], DefDlgProc);
01062     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_SCROLLBAR    - FNID_START], ScrollBarWndProc);
01063     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_MENU         - FNID_START], MenuWndProc);
01064     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_DESKTOP      - FNID_START], DesktopWndProc);
01065     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_STATIC       - FNID_START], StaticWndProc);
01066     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_BUTTON       - FNID_START], ButtonWndProc);
01067     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_LISTBOX      - FNID_START], ListboxWndProc);
01068     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_COMBOBOX     - FNID_START], ComboWndProc);
01069     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_COMBOLISTBOX - FNID_START], ListboxWndProc);
01070     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_EDIT         - FNID_START], EditWndProc);
01071     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a7">INITMSGTABLE</a>(awmControl[FNID_IME          - FNID_START], ImeWndProc);
01072 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="kernel/server.c::InitOLEFormats" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitOLEFormats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01087">1087</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00075">ARRAY_SIZE</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00690">lpszOLEFormats</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00035">UserAddAtom()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01088 {
01089     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> idx;
01090     ATOM a1;
01091     ATOM a2;
01092     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01093 
01094     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"UserInit: Initialize OLE Formats\n"</span>));
01095 
01096     a1 = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(lpszOLEFormats[0], TRUE);
01097 
01098     <span class="keywordflow">for</span> (idx = 1; idx &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a2">ARRAY_SIZE</a>(lpszOLEFormats); idx++) {
01099         a2 = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(lpszOLEFormats[idx], TRUE);
01100         fSuccess &amp;= !!a2;
01101 
01102         UserAssert(((a1 + 1) == a2) &amp;&amp; (a1 = a2));
01103     }
01104 
01105     <span class="keywordflow">if</span> (!fSuccess) {
01106         RIPMSG0(RIP_ERROR, <span class="stringliteral">"InitOLEFormats: at least one atom not registered"</span>);
01107     }
01108 
01109     <span class="keywordflow">return</span> fSuccess;
01110 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="kernel/server.c::InitQEntryLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitQEntryLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="kernel/server.c::InitSMSLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitSMSLookaside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="kernel/server.c::InitVideo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PMDEV InitVideo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bReenumerationNeeded</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01893">1893</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02601">GW_DESKTOP_ID</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02094">tagDISPLAYINFO::hDev</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07385">HH_INITVIDEO</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07404">HYDRA_HINT</a>, <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00775">InitUserScreen()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02095">tagDISPLAYINFO::pmdev</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00020">RemoteConnect()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.
<p>
<pre class="fragment"><div>01895 {
01896     PMDEV pmdev;
01897     LONG  ChangeStatus;
01898 
01899     <span class="comment">/*</span>
01900 <span class="comment">     * BUGBUG !!! Need to get a status return from this call.</span>
01901 <span class="comment">     */</span>
01902     DrvInitConsole(bReenumerationNeeded);
01903 
01904     <span class="comment">/*</span>
01905 <span class="comment">     * BASEVIDEO may be on or off, whether we are in setup or not.</span>
01906 <span class="comment">     */</span>
01907 
01908     ChangeStatus = DrvChangeDisplaySettings(NULL,
01909                                             NULL,
01910                                             NULL,
01911                                             (PVOID) (GW_DESKTOP_ID),
01912                                             KernelMode,
01913                                             FALSE,
01914                                             TRUE,
01915                                             NULL,
01916                                             &amp;pmdev,
01917                                             GRE_DEFAULT,
01918                                             TRUE);
01919 
01920     <span class="keywordflow">if</span> (ChangeStatus != GRE_DISP_CHANGE_SUCCESSFUL) {
01921 
01922         <span class="comment">/*</span>
01923 <span class="comment">         * If we fail, try BASEVIDEO temporarily</span>
01924 <span class="comment">         */</span>
01925 
01926         DrvSetBaseVideo(TRUE);
01927 
01928         ChangeStatus = DrvChangeDisplaySettings(NULL,
01929                                                 NULL,
01930                                                 NULL,
01931                                                 (PVOID) (GW_DESKTOP_ID),
01932                                                 KernelMode,
01933                                                 FALSE,
01934                                                 TRUE,
01935                                                 NULL,
01936                                                 &amp;pmdev,
01937                                                 GRE_DEFAULT,
01938                                                 TRUE);
01939 
01940         DrvSetBaseVideo(FALSE);
01941 
01942         <span class="comment">/*</span>
01943 <span class="comment">         * Give it one last try, not in basevideo, to handle TGA</span>
01944 <span class="comment">         * (non-vgacompatible) during GUI-mode setup (BASEVIDEO is on by</span>
01945 <span class="comment">         * default)</span>
01946 <span class="comment">         */</span>
01947 
01948         <span class="keywordflow">if</span> (ChangeStatus != GRE_DISP_CHANGE_SUCCESSFUL) {
01949 
01950             ChangeStatus = DrvChangeDisplaySettings(NULL,
01951                                                     NULL,
01952                                                     NULL,
01953                                                     (PVOID) (GW_DESKTOP_ID),
01954                                                     KernelMode,
01955                                                     FALSE,
01956                                                     TRUE,
01957                                                     NULL,
01958                                                     &amp;pmdev,
01959                                                     GRE_DEFAULT,
01960                                                     TRUE);
01961 
01962         }
01963     }
01964 
01965     <span class="keywordflow">if</span> (ChangeStatus != GRE_DISP_CHANGE_SUCCESSFUL) {
01966         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitVideo: No working display driver found"</span>);
01967         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01968     }
01969 
01970     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>  = pmdev-&gt;hdevParent;
01971     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o1">pmdev</a> = pmdev;
01972 
01973     GreUpdateSharedDevCaps(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>);
01974 
01975     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8/fullscr_8c.html#a17">InitUserScreen</a>()) {
01976         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitUserScreen failed"</span>);
01977         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01978     }
01979 
01980     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_INITVIDEO);
01981 
01982     <span class="keywordflow">return</span> pmdev;
01983 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="kernel/server.c::InitWindowMsgTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitWindowMsgTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d5/ndismain_8h.html#a266">PUINT</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST WORD *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00944">944</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02137">SharedAlloc()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00948 {
00949     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> i;
00950     WORD <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
00951     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> cbTable;
00952 
00953     *pmax = 0;
00954     <span class="keywordflow">for</span> (i = 0; (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> = pw[i]) != 0; i++) {
00955         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> &gt; *pmax)
00956             *pmax = <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
00957     }
00958 
00959     cbTable = *pmax / 8 + 1;
00960     *ppbyte = <a class="code" href="../../d4/d1/userk_8h.html#a1000">SharedAlloc</a>(cbTable);
00961 
00962     <span class="keywordflow">for</span> (i = 0; (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> = pw[i]) != 0; i++)
00963         (*ppbyte)[<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> / 8] |= (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(1 &lt;&lt; (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> &amp; 7));
00964 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="kernel/server.c::IsDBCSEnabledSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsDBCSEnabledSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02118">2118</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00086">NlsMbCodePageTag</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02125">IsIMMEnabledSystem()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>02119 {
02120     <span class="keyword">extern</span> BOOLEAN* <a class="code" href="../../d9/d6/nlsxlat_8c.html#a19">NlsMbCodePageTag</a>;
02121     <span class="keywordflow">return</span> !!*<a class="code" href="../../d9/d6/nlsxlat_8c.html#a19">NlsMbCodePageTag</a>;
02122 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="kernel/server.c::IsIMMEnabledSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsIMMEnabledSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02125">2125</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00575">FastGetProfileDwordW()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02118">IsDBCSEnabledSystem()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06871">PMAP_IMM</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>02126 {
02127     <span class="comment">// if the entire system is DBCS enabled, IMM/IME should be activated anyway</span>
02128     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d6/kernel_2server_8c.html#a76">IsDBCSEnabledSystem</a>())
02129         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02130 
02131     <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(NULL, PMAP_IMM, TEXT(<span class="stringliteral">"LoadIMM"</span>), 0);
02132 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="kernel/server.c::IsMidEastEnabledSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsMidEastEnabledSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02135">2135</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d6/d5/chartran_8c-source.html#l00016">__declspec()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00079">NlsAnsiCodePage</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>02136 {
02137     <span class="keyword">extern</span> <a class="code" href="../../d5/d6/chartran_8c.html#a2">__declspec</a>(dllimport) USHORT NlsAnsiCodePage;
02138     <span class="comment">//1255 Hebrew and 1256 Arabic</span>
02139     if ((NlsAnsiCodePage == 1255) || (NlsAnsiCodePage == 1256)) {
02140         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02141     }
02142     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02143 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="kernel/server.c::NtUserInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS NtUserInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwVersion</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hPowerRequestEvent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hMediaRequestEvent</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02713">2713</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00794">gpepCSRSS</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00931">gSessionId</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00119">InitializeMediaChange()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00180">InitializePowerRequestList()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d9/d6/kernel_2server_8c.html#a82">TellGdiToGetReady()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01305">USERCURRENTVERSION</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>, and <a class="el" href="../../d2/d8/ps_8h-source.html#l00284">_EPROCESS::Win32Process</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2server_8c-source.html#l00192">UserServerDllInitialization()</a>.
<p>
<pre class="fragment"><div>02717 {
02718     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02719 
02720     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering NtUserInitialize\n"</span>));
02721 
02722     <span class="comment">/*</span>
02723 <span class="comment">     * Make sure we're not trying to load this twice.</span>
02724 <span class="comment">     */</span>
02725     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02726         RIPMSG0(RIP_ERROR, <span class="stringliteral">"Can't initialize more than once"</span>);
02727         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02728     }
02729 
02730     <span class="comment">/*</span>
02731 <span class="comment">     * Check version number</span>
02732 <span class="comment">     */</span>
02733     <span class="keywordflow">if</span> (dwVersion != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a409">USERCURRENTVERSION</a>) {
02734         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(WIN32K_INIT_OR_RIT_FAILURE,
02735                      0,
02736                      0,
02737                      dwVersion,
02738                      USERCURRENTVERSION);
02739     }
02740 
02741     <span class="comment">/*</span>
02742 <span class="comment">     * Get the session ID from the EPROCESS structure</span>
02743 <span class="comment">     */</span>
02744     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a327">gSessionId</a> = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;SessionId;
02745 
02746     UserAssert(gSessionId == 0 || gbRemoteSession == TRUE);
02747 
02748     <span class="comment">/*</span>
02749 <span class="comment">     * Initialize the power request list.</span>
02750 <span class="comment">     */</span>
02751     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1966">InitializePowerRequestList</a>(hPowerRequestEvent);
02752     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02753         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02754     }
02755 
02756     <a class="code" href="../../d4/d1/userk_8h.html#a996">InitializeMediaChange</a>(hMediaRequestEvent);
02757 
02758     <span class="comment">/*</span>
02759 <span class="comment">     * Save the system process structure.</span>
02760 <span class="comment">     */</span>
02761     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a> = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>();
02762 
02763     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d6/kernel_2server_8c.html#a82">TellGdiToGetReady</a>())
02764     {
02765         RIPMSG0(RIP_WARNING, <span class="stringliteral">"TellGdiToGetReady failed"</span>);
02766         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_UNSUCCESSFUL;
02767         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02768     }
02769 
02770     <span class="comment">/*</span>
02771 <span class="comment">     * Allow CSR to read the screen</span>
02772 <span class="comment">     */</span>
02773     ((PW32PROCESS)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a>-&gt;<a class="code" href="../../d0/d4/struct__EPROCESS.html#o72">Win32Process</a>)-&gt;W32PF_Flags |= (W32PF_READSCREENACCESSGRANTED|W32PF_IOWINSTA);
02774 
02775 
02776     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a75">UserInitialize</a>();
02777 
02778     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Leaving NtUserInitialize\n"</span>));
02779     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02780 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="kernel/server.c::NtUserProcessConnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS NtUserProcessConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hProcess</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pConnectInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>cbConnectInfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02788">2788</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01364">_USERCONNECT::dwDispatchCount</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d5/ntuser_2client_2globals_8h-source.html#l00026">gDispatchTableValues</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00092">GetCurrentProcessId</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01654">InitMapSharedSection()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d0/d4/probe_8c-source.html#l00034">ProbeForWrite()</a>, <a class="el" href="../../d0/d8/ntos_8h-source.html#l00088">PsProcessType</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01362">_USERCONNECT::ulVersion</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1005">USERCONNECT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01305">USERCURRENTVERSION</a>, and <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>, and <a class="el" href="../../d1/d6/server_2server_8c-source.html#l00357">UserClientConnect()</a>.
<p>
<pre class="fragment"><div>02792 {
02793     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a>    Process;
02794     <a class="code" href="../../d6/d4/struct__USERCONNECT.html">PUSERCONNECT</a> pucConnect = (<a class="code" href="../../d6/d4/struct__USERCONNECT.html">PUSERCONNECT</a>)pConnectInfo;
02795     <a class="code" href="../../d6/d4/struct__USERCONNECT.html">USERCONNECT</a>  ucLocal;
02796     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
02797 
02798 
02799     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering NtUserProcessConnect\n"</span>));
02800 
02801     <span class="keywordflow">if</span> (!pucConnect || (cbConnectInfo != <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/struct__USERCONNECT.html">USERCONNECT</a>))) {
02802         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02803     }
02804 
02805     <span class="keywordflow">try</span> {
02806         <a class="code" href="../../d5/d8/ex_8h.html#a259">ProbeForWrite</a>(pucConnect, cbConnectInfo, <span class="keyword">sizeof</span>(DWORD));
02807 
02808         ucLocal = *pucConnect;
02809     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
02810         <span class="keywordflow">return</span> GetExceptionCode();
02811     }
02812 
02813     <span class="comment">/*</span>
02814 <span class="comment">     * Check client/server versions.</span>
02815 <span class="comment">     */</span>
02816     <span class="keywordflow">if</span> (ucLocal.<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o0">ulVersion</a> != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a409">USERCURRENTVERSION</a>) {
02817 
02818         RIPMSG2(RIP_ERROR,
02819             <span class="stringliteral">"Client version %lx &gt; server version %lx\n"</span>,
02820             ucLocal.<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o0">ulVersion</a>, USERCURRENTVERSION);
02821         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02822     }
02823 
02824 
02825 
02826     <span class="keywordflow">if</span> (ucLocal.<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o2">dwDispatchCount</a> != <a class="code" href="../../d8/d6/ntuser_2client_2globals_8h.html#a11">gDispatchTableValues</a>) {
02827         RIPMSG2(RIP_ERROR,
02828             <span class="stringliteral">"!!!! Client Dispatch info %lX != Server %lX\n"</span>,
02829             ucLocal.<a class="code" href="../../d6/d4/struct__USERCONNECT.html#o2">dwDispatchCount</a>, gDispatchTableValues);
02830     }
02831 
02832 
02833     <span class="comment">/*</span>
02834 <span class="comment">     * Reference the process.</span>
02835 <span class="comment">     */</span>
02836     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(hProcess,
02837                                        PROCESS_VM_OPERATION,
02838                                        *PsProcessType,
02839                                        UserMode,
02840                                        &amp;Process,
02841                                        NULL);
02842     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status))
02843         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02844     <span class="comment">/*</span>
02845 <span class="comment">     * Return client's view of shared data.</span>
02846 <span class="comment">     */</span>
02847     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a70">InitMapSharedSection</a>(Process, &amp;ucLocal);
02848 
02849     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)                       &amp;&amp;
02850         (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_NO_MEMORY)              &amp;&amp;
02851         (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_PROCESS_IS_TERMINATING) &amp;&amp;
02852         (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_QUOTA_EXCEEDED)         &amp;&amp;
02853         (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_COMMITMENT_LIMIT)) {
02854 
02855         RIPMSG2(RIP_ERROR,
02856               <span class="stringliteral">"Failed to map shared data into client %x, status = %x\n"</span>,
02857               <a class="code" href="../../d4/d1/userk_8h.html#a19">GetCurrentProcessId</a>(), Status);
02858     }
02859 
02860     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(Process);
02861 
02862     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02863 
02864         <span class="keywordflow">try</span> {
02865              *pucConnect = ucLocal;
02866         } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
02867             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = GetExceptionCode();
02868         }
02869     }
02870 
02871     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Leaving NtUserProcessConnect\n"</span>));
02872 
02873     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02874 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="kernel/server.c::SetupClassAtoms" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL SetupClassAtoms           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">2151</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00774">atomCheckpointProp</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01314">tagSERVERINFO::atomContextHelpIdProp</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00777">atomDDEImp</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00775">atomDDETrack</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01312">tagSERVERINFO::atomIconProp</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01311">tagSERVERINFO::atomIconSmProp</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00779">atomImeLevel</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00781">atomLayer</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00776">atomQOS</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00778">atomWndObj</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00289">DESKTOPCLASS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00290">DIALOGCLASS</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00773">gaFlashWState</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00772">gaOleMainThreadWndClass</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00769">gatomLastPinned</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00771">gatomMessage</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00789">guiActivateShellWindow</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00787">guiOtherWindowCreated</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00788">guiOtherWindowDestroyed</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00339">ICLS_BUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00346">ICLS_CTL_MAX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00348">ICLS_DESKTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00349">ICLS_DIALOG</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00352">ICLS_ICONTITLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00350">ICLS_MENU</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00351">ICLS_SWITCH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00363">ICLS_TOOLTIP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00292">ICONTITLECLASS</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00714">lpszControls</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00295">MENUCLASS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00291">SWITCHWNDCLASS</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00082">szACTIVATESHELLWINDOW</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00069">szCHECKPOINT_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00078">szCONTEXTHELPIDPROP</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00072">szDDEIMP_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00070">szDDETRACK_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00086">szFLASHWSTATE</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00080">szICON_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00079">szICONSM_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00074">szIMELEVEL_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00075">szLAYER_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00077">szMESSAGE</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00085">szOLEMAINTHREADWNDCLASS</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00083">szOTHERWINDOWCREATED</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00084">szOTHERWINDOWDESTROYED</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00071">szQOS_PROP_NAME</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00081">szSHELLHOOK</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00073">szWNDOBJ_PROP_NAME</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00294">TOOLTIPCLASS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01302">tagSERVERINFO::uiShellMsg</a>, and <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00035">UserAddAtom()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>02153 {
02154     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02155     <span class="keywordtype">int</span>  ind;
02156 
02157     <span class="comment">/*</span>
02158 <span class="comment">     * Set up class atoms</span>
02159 <span class="comment">     */</span>
02160     <span class="comment">/*</span>
02161 <span class="comment">     * HACK: Controls are registered on the client side so we can't</span>
02162 <span class="comment">     * fill in their atomSysClass entry the same way we do for the other</span>
02163 <span class="comment">     * classes.</span>
02164 <span class="comment">     */</span>
02165     <span class="keywordflow">for</span> (ind = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a68">ICLS_BUTTON</a>; ind &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a74">ICLS_CTL_MAX</a>; ind++) {
02166         <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ind] = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(lpszControls[ind], TRUE);
02167         fSuccess &amp;= !!<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ind];
02168     }
02169 
02170     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a76">ICLS_DIALOG</a>]    = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(DIALOGCLASS);
02171     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a79">ICLS_ICONTITLE</a>] = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(ICONTITLECLASS);
02172     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a90">ICLS_TOOLTIP</a>]   = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(TOOLTIPCLASS);
02173     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a75">ICLS_DESKTOP</a>]   = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(DESKTOPCLASS);
02174     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a78">ICLS_SWITCH</a>]    = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(SWITCHWNDCLASS);
02175     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a77">ICLS_MENU</a>]      = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(MENUCLASS);
02176 
02177     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o30">atomContextHelpIdProp</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szCONTEXTHELPIDPROP, TRUE);
02178     fSuccess &amp;= !!<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o30">atomContextHelpIdProp</a>;
02179 
02180     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o28">atomIconSmProp</a>        = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szICONSM_PROP_NAME, TRUE);
02181     fSuccess &amp;= !!<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o28">atomIconSmProp</a>;
02182 
02183     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o29">atomIconProp</a>          = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szICON_PROP_NAME, TRUE);
02184     fSuccess &amp;= !!<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o29">atomIconProp</a>;
02185 
02186     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o15">uiShellMsg</a>            = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szSHELLHOOK, TRUE);
02187     fSuccess &amp;= !!<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o15">uiShellMsg</a>;
02188 
02189     <span class="comment">/*</span>
02190 <span class="comment">     * Initialize the integer atoms for our magic window properties</span>
02191 <span class="comment">     */</span>
02192     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a287">atomCheckpointProp</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szCHECKPOINT_PROP_NAME, TRUE);
02193     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a287">atomCheckpointProp</a>;
02194 
02195     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a288">atomDDETrack</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szDDETRACK_PROP_NAME, TRUE);
02196     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a288">atomDDETrack</a>;
02197 
02198     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a289">atomQOS</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szQOS_PROP_NAME, TRUE);
02199     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a289">atomQOS</a>;
02200 
02201     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a290">atomDDEImp</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szDDEIMP_PROP_NAME, TRUE);
02202     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a290">atomDDEImp</a>;
02203 
02204     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a291">atomWndObj</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szWNDOBJ_PROP_NAME, TRUE);
02205     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a291">atomWndObj</a>;
02206 
02207     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a292">atomImeLevel</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szIMELEVEL_PROP_NAME, TRUE);
02208     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a292">atomImeLevel</a>;
02209 
02210     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a293">atomLayer</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szLAYER_PROP_NAME, TRUE);
02211     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a293">atomLayer</a>;
02212 
02213     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a296">guiActivateShellWindow</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szACTIVATESHELLWINDOW, TRUE);
02214     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a296">guiActivateShellWindow</a>;
02215 
02216     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a294">guiOtherWindowCreated</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szOTHERWINDOWCREATED, TRUE);
02217     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a294">guiOtherWindowCreated</a>;
02218 
02219     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a295">guiOtherWindowDestroyed</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szOTHERWINDOWDESTROYED, TRUE);
02220     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a295">guiOtherWindowDestroyed</a>;
02221 
02222     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a284">gatomMessage</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szMESSAGE, TRUE);
02223     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a284">gatomMessage</a>;
02224 
02225 <span class="preprocessor">#ifdef HUNGAPP_GHOSTING</span>
02226 <span class="preprocessor"></span>    gatomGhost = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szGHOST, TRUE);
02227     fSuccess &amp;= !!gatomGhost;
02228 <span class="preprocessor">#endif // HUNGAPP_GHOSTING</span>
02229 <span class="preprocessor"></span>
02230     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a285">gaOleMainThreadWndClass</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szOLEMAINTHREADWNDCLASS, TRUE);
02231     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a285">gaOleMainThreadWndClass</a>;
02232 
02233     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a286">gaFlashWState</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szFLASHWSTATE, TRUE);
02234     fSuccess &amp;= !!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a286">gaFlashWState</a>;
02235 
02236     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a283">gatomLastPinned</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a285">gaOleMainThreadWndClass</a>;
02237 
02238     <span class="keywordflow">return</span> fSuccess;
02239 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="kernel/server.c::TellGdiToGetReady" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TellGdiToGetReady           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02713">NtUserInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="kernel/server.c::UserGetDesktopDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDC UserGetDesktopDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bAltType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bValidate</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02519">2519</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d9/d2/dc_8c-source.html#l00608">_GetDCEx()</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00794">gpepCSRSS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02094">tagDISPLAYINFO::hDev</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00639">IS_SYSTEM_THREAD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03284">IS_THREAD_RESTRICTED</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02644">tagDESKTOP::pDeskInfo</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02645">tagDESKTOP::pDispInfo</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00059">PtiCurrentShared</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03327">tagTHREADINFO::rpdesk</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02156">tagDESKTOPINFO::spwnd</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00441">_ETHREAD::ThreadsProcess</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, and <a class="el" href="../../d5/d9/immcli_8h-source.html#l00120">ValidateHwnd</a>.
<p>
<pre class="fragment"><div>02523 {
02524     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>    Thread;
02525     HDC         hdc;
02526     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();  <span class="comment">// This is called from outside the crit sec</span>
02527     HDEV        hdev  = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>;
02528 
02529     <span class="keywordflow">if</span> (bValidate &amp;&amp; <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> != DCTYPE_INFO &amp;&amp;
02530         <a class="code" href="../../d4/d1/userk_8h.html#a382">IS_THREAD_RESTRICTED</a>(pti, JOB_OBJECT_UILIMIT_HANDLES)) {
02531 
02532         UserAssert(pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o6">rpdesk</a> != NULL);
02533 
02534         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o6">rpdesk</a>-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o0">pDeskInfo</a>-&gt;<a class="code" href="../../d1/d3/structtagDESKTOPINFO.html#o2">spwnd</a>))) {
02535             RIPMSG0(RIP_WARNING,
02536                     <span class="stringliteral">"UserGetDesktopDC fails desktop window validation"</span>);
02537             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02538         }
02539     }
02540 
02541     <span class="comment">/*</span>
02542 <span class="comment">     * !!! BUGBUG</span>
02543 <span class="comment">     * This is a real nasty trick to get both DCs created on a desktop on</span>
02544 <span class="comment">     * a different device to work (for the video applet) and to be able</span>
02545 <span class="comment">     * to clip DCs that are actually on the same device ...</span>
02546 <span class="comment">     */</span>
02547     <span class="keywordflow">if</span> (pti &amp;&amp; pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o6">rpdesk</a>)
02548         hdev = pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o6">rpdesk</a>-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o1">pDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>;
02549 
02550     <span class="comment">/*</span>
02551 <span class="comment">     * We want to turn this call that was originally OpenDC("Display", ...)</span>
02552 <span class="comment">     * into GetDC null call so this DC will be clipped to the current</span>
02553 <span class="comment">     * desktop or else the DC can write to any desktop.  Only do this</span>
02554 <span class="comment">     * for client apps; let the server do whatever it wants.</span>
02555 <span class="comment">     */</span>
02556     Thread = <a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
02557     <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> != DCTYPE_DIRECT)  ||
02558         (hdev != <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>) ||
02559         <a class="code" href="../../d1/d9/ps_8h.html#a18">IS_SYSTEM_THREAD</a>(Thread) ||
02560         (Thread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o28">ThreadsProcess</a> == <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a>)) {
02561 
02562         hdc = GreCreateDisplayDC(hdev, type, bAltType);
02563 
02564     } <span class="keywordflow">else</span> {
02565 
02566         <a class="code" href="../../d0/d3/structtagDESKTOP.html">PDESKTOP</a> pdesk;
02567 
02568         <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02569 
02570         <span class="keywordflow">if</span> (pdesk = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>()-&gt;rpdesk) {
02571 
02572             hdc = <a class="code" href="../../d4/d1/userk_8h.html#a1695">_GetDCEx</a>(pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o0">pDeskInfo</a>-&gt;<a class="code" href="../../d1/d3/structtagDESKTOPINFO.html#o2">spwnd</a>,
02573                            NULL,
02574                            DCX_WINDOW | DCX_CACHE | DCX_CREATEDC);
02575         } <span class="keywordflow">else</span> {
02576             hdc = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02577         }
02578 
02579         <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02580     }
02581 
02582     <span class="keywordflow">return</span> hdc;
02583 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="kernel/server.c::UserGetHDEV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDEV UserGetHDEV           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l03011">3011</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02094">tagDISPLAYINFO::hDev</a>.
<p>
<pre class="fragment"><div>03012 {
03013 
03014     <span class="comment">/*</span>
03015 <span class="comment">     * BUGBUG This is busted.</span>
03016 <span class="comment">     *        This need to return the device for the current desktop.</span>
03017 <span class="comment">     *        The graphics device may not be the same for all desktops.</span>
03018 <span class="comment">     *        -Andre</span>
03019 <span class="comment">     */</span>
03020     <span class="keywordflow">return</span> <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>;
03021 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="kernel/server.c::UserGlobalAtomTableCallout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID UserGlobalAtomTableCallout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l03035">3035</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00259">gpJobsList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03284">IS_THREAD_RESTRICTED</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03445">tagW32JOB::Job</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03446">tagW32JOB::pAtomTable</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02739">tagWINDOWSTATION::pGlobalAtomTable</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03444">tagW32JOB::pNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03319">tagTHREADINFO::ppi</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00087">PtiFromThread</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03501">tagPROCESSINFO::pW32Job</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l01366">ReferenceWindowStation()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d8/ps_8h-source.html#l00523">_EJOB::UIRestrictionsClass</a>.
<p>
<pre class="fragment"><div>03036 {
03037     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>       Thread;
03038     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>    pti;
03039     <a class="code" href="../../d4/d9/structtagWINDOWSTATION.html">PWINDOWSTATION</a> pwinsta;
03040     <a class="code" href="../../d1/d9/structtagW32JOB.html">PW32JOB</a>        pW32Job;
03041     <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a>          Job;
03042     PVOID          GlobalAtomTable = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03043 
03044     Thread = <a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
03045 
03046     pti = <a class="code" href="../../d4/d1/userk_8h.html#a17">PtiFromThread</a>(Thread);
03047 
03048     <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
03049 
03050     <span class="comment">/*</span>
03051 <span class="comment">     * For restricted threads access the atom table off of the job object</span>
03052 <span class="comment">     */</span>
03053     <span class="keywordflow">if</span> (pti != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; <a class="code" href="../../d4/d1/userk_8h.html#a382">IS_THREAD_RESTRICTED</a>(pti, JOB_OBJECT_UILIMIT_GLOBALATOMS)) {
03054 
03055         UserAssert(pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a> != NULL);
03056 
03057         pW32Job = pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o2">ppi</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o25">pW32Job</a>;
03058 
03059         UserAssert(pW32Job != NULL &amp;&amp; pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o2">pAtomTable</a> != NULL);
03060 
03061         GlobalAtomTable = pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o2">pAtomTable</a>;
03062 
03063         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
03064     }
03065 
03066     Job = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;Job;
03067 
03068     <span class="comment">/*</span>
03069 <span class="comment">     * Now handle the case where this si not a GUI thread/process</span>
03070 <span class="comment">     * but it is assigned to a job that has JOB_OBJECT_UILIMIT_GLOBALATOMS</span>
03071 <span class="comment">     * restrictions set. There is no easy way to convert this thread</span>
03072 <span class="comment">     * to GUI.</span>
03073 <span class="comment">     */</span>
03074     <span class="keywordflow">if</span> (pti == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; Job != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
03075         (Job-&gt;<a class="code" href="../../d0/d3/struct__EJOB.html#o20">UIRestrictionsClass</a> &amp; JOB_OBJECT_UILIMIT_GLOBALATOMS)) {
03076 
03077         <span class="comment">/*</span>
03078 <span class="comment">         * find the W32JOB in the global list</span>
03079 <span class="comment">         */</span>
03080         pW32Job = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a113">gpJobsList</a>;
03081 
03082         <span class="keywordflow">while</span> (pW32Job) {
03083             <span class="keywordflow">if</span> (pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o1">Job</a> == Job) {
03084                 <span class="keywordflow">break</span>;
03085             }
03086             pW32Job = pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o0">pNext</a>;
03087         }
03088 
03089         UserAssert(pW32Job != NULL &amp;&amp; pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o2">pAtomTable</a> != NULL);
03090 
03091         GlobalAtomTable = pW32Job-&gt;<a class="code" href="../../d1/d9/structtagW32JOB.html#o2">pAtomTable</a>;
03092 
03093         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
03094     }
03095 
03096 <span class="preprocessor">#if DBG</span>
03097 <span class="preprocessor"></span>    pwinsta = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03098 <span class="preprocessor">#endif</span>
03099 <span class="preprocessor"></span>
03100     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d8/d8/winsta_8c.html#a13">ReferenceWindowStation</a>(Thread,
03101                                     <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;Win32WindowStation,
03102                                     WINSTA_ACCESSGLOBALATOMS,
03103                                     &amp;pwinsta,
03104                                     TRUE))) {
03105         UserAssert(pwinsta != NULL);
03106 
03107         GlobalAtomTable = pwinsta-&gt;<a class="code" href="../../d4/d9/structtagWINDOWSTATION.html#o16">pGlobalAtomTable</a>;
03108     }
03109 
03110 <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>:
03111     <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
03112 
03113 <span class="preprocessor">#if DBG</span>
03114 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (GlobalAtomTable == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03115         RIPMSG1(RIP_WARNING,
03116                 <span class="stringliteral">"_UserGetGlobalAtomTable: NULL Atom Table for pwinsta=0x%x"</span>,
03117                 pwinsta);
03118     }
03119 <span class="preprocessor">#endif</span>
03120 <span class="preprocessor"></span>
03121     <span class="keywordflow">return</span> GlobalAtomTable;
03122 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="kernel/server.c::UserInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS UserInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">2004</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d7/ex_8c-source.html#l00346">CreateKernelEvent()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01985">DrvDriverFailure()</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00021">gbUserInitialized</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00923">gbVideoInitialized</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00077">gpEventDiconnectDesktop</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00931">gSessionId</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07384">HH_USERINITIALIZE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07404">HYDRA_HINT</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01417">InitCreateObjectDirectory()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01172">InitGlobalRIPFlags</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01738">InitLoadResources()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01893">InitVideo()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03600">ISTS</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01820">LW_BrushInit()</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00370">NtGlobalFlag</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d9/d8/dllinit_8c-source.html#l00057">SESSION_ROOT</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l00041">szWindowStationDirectory</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00737">TraceInitialization</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00369">WINSTA_DIR</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l01501">xxxCreateThreadInfo()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02713">NtUserInitialize()</a>.
<p>
<pre class="fragment"><div>02005 {
02006     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02007 
02008     <span class="comment">/*</span>
02009 <span class="comment">     * Allow a trace of all the init stuff going on related to display drivers.</span>
02010 <span class="comment">     * Usefull to debug boot time problems related to graphics.</span>
02011 <span class="comment">     */</span>
02012     <span class="keywordflow">if</span> (**((PULONG *)&amp;<a class="code" href="../../d9/d2/ldrp_8h.html#a33">NtGlobalFlag</a>) &amp; FLG_SHOW_LDR_SNAPS)
02013         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a275">TraceInitialization</a> = 1;
02014 
02015     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering UserInitialize\n"</span>));
02016 
02017     <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02018 
02019     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_USERINITIALIZE);
02020 
02021     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/inc_2user_8h.html#a882">ISTS</a>()) {
02022 
02023         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>) {
02024             swprintf(szWindowStationDirectory, L<span class="stringliteral">"%ws\\%ld%ws"</span>,
02025                      SESSION_ROOT, gSessionId, WINSTA_DIR);
02026         } <span class="keywordflow">else</span> {
02027             wcscpy(szWindowStationDirectory, WINSTA_DIR);
02028         }
02029     } <span class="keywordflow">else</span> {
02030         wcscpy(szWindowStationDirectory, WINSTA_DIR);
02031     }
02032 
02033     <span class="comment">/*</span>
02034 <span class="comment">     * Create WindowStation object directory.</span>
02035 <span class="comment">     */</span>
02036     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a52">InitCreateObjectDirectory</a>();
02037 
02038     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02039         RIPMSG1(RIP_WARNING, <span class="stringliteral">"InitCreateObjectDirectory failed with Status %x"</span>,
02040                 Status);
02041 
02042         <span class="keywordflow">goto</span> Exit;
02043     }
02044 
02045     <span class="comment">/*</span>
02046 <span class="comment">     * WinStations get init'ed on the first connect</span>
02047 <span class="comment">     */</span>
02048     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>) {
02049 
02050         <span class="comment">/*</span>
02051 <span class="comment">         * Create the event for the diconnect desktop creation</span>
02052 <span class="comment">         */</span>
02053         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a19">gpEventDiconnectDesktop</a> = <a class="code" href="../../d4/d1/userk_8h.html#a965">CreateKernelEvent</a>(SynchronizationEvent, FALSE);
02054 
02055         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a19">gpEventDiconnectDesktop</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02056             RIPMSG0(RIP_WARNING, <span class="stringliteral">"Failed to create gpEventDiconnectDesktop"</span>);
02057             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_NO_MEMORY;
02058             <span class="keywordflow">goto</span> Exit;
02059         }
02060 
02061         <span class="keywordflow">goto</span> SkipRemote;
02062     }
02063 
02064     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1264">InitVideo</a>(TRUE) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02065         <a class="code" href="../../d9/d6/kernel_2server_8c.html#a74">DrvDriverFailure</a>();
02066     }
02067 
02068     <span class="comment">/*</span>
02069 <span class="comment">     * Do this here so power callouts</span>
02070 <span class="comment">     * have the pmdev in gpDispInfo set</span>
02071 <span class="comment">     */</span>
02072     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a323">gbVideoInitialized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02073 
02074 SkipRemote:
02075 
02076     <a class="code" href="../../d7/d2/power_8c.html#a0">gbUserInitialized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02077 
02078     <span class="comment">/*</span>
02079 <span class="comment">     * Now that the system is initialized, allocate</span>
02080 <span class="comment">     * a pti for this thread.</span>
02081 <span class="comment">     */</span>
02082     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1189">xxxCreateThreadInfo</a>(<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>(), FALSE);
02083 
02084     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02085         RIPMSG1(RIP_WARNING, <span class="stringliteral">"xxxCreateThreadInfo failed during UserInitialize with Status"</span>,
02086                 Status);
02087         <span class="keywordflow">goto</span> Exit;
02088     }
02089 
02090     <span class="comment">/*</span>
02091 <span class="comment">     * Initialize Global RIP flags (debug only).</span>
02092 <span class="comment">     */</span>
02093     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a8">InitGlobalRIPFlags</a>();
02094 
02095     <span class="comment">/*</span>
02096 <span class="comment">     * WinStations get init'ed on the first connect</span>
02097 <span class="comment">     */</span>
02098     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>)
02099         UserVerify(<a class="code" href="../../d4/d1/userk_8h.html#a1844">LW_BrushInit</a>());
02100 
02101     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a71">InitLoadResources</a>();
02102 
02103 Exit:
02104     <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02105 
02106     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Leaving UserInitialize\n"</span>));
02107 
02108     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02109 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="kernel/server.c::UserThreadCallout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS UserThreadCallout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pEThread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/ps_8h.html#a79">PSW32THREADCALLOUTTYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CalloutType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02595">2595</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00101">FullScreenCleanup()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00927">gbCleanedUpResources</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00925">gbNoMorePowerCallouts</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00021">gbUserInitialized</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00923">gbVideoInitialized</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00794">gpepCSRSS</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00757">gpresUser</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02094">tagDISPLAYINFO::hDev</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/ps_8h.html#a157a97">PsW32ThreadCalloutExit</a>, <a class="el" href="../../d1/d9/ps_8h.html#a157a96">PsW32ThreadCalloutInitialize</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03331">tagTHREADINFO::TIF_flags</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02826">TIF_INCLEANUP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l01501">xxxCreateThreadInfo()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l02552">xxxDestroyThreadInfo()</a>.
<p>
<pre class="fragment"><div>02598 {
02599     <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti;
02600     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>    <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
02601 
02602     UserAssert(gpresUser != NULL);
02603 
02604     <span class="keywordflow">switch</span> (CalloutType) {
02605         <span class="keywordflow">case</span> <a class="code" href="../../d1/d9/ps_8h.html#a157a96">PsW32ThreadCalloutInitialize</a>:
02606             <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering UserThreadCallout PsW32ThreadCalloutInitialize\n"</span>));
02607 
02608             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a324">gbNoMorePowerCallouts</a>) {
02609                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"No more GUI threads allowed"</span>);
02610                 <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02611             }
02612 
02613             <span class="comment">/*</span>
02614 <span class="comment">             * Only create a thread info structure if we're initialized.</span>
02615 <span class="comment">             */</span>
02616             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d2/power_8c.html#a0">gbUserInitialized</a>) {
02617                 <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02618                 UserAssert(gpepCSRSS != NULL);
02619 
02620                 <span class="comment">/*</span>
02621 <span class="comment">                 * Initialize this thread</span>
02622 <span class="comment">                 */</span>
02623                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1189">xxxCreateThreadInfo</a>(pEThread, FALSE);
02624 
02625                 <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02626             }
02627             <span class="keywordflow">break</span>;
02628 
02629        <span class="keywordflow">case</span> <a class="code" href="../../d1/d9/ps_8h.html#a157a97">PsW32ThreadCalloutExit</a>:
02630 
02631             <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering UserThreadCallout PsW32ThreadCalloutExit\n"</span>));
02632 
02633             <span class="comment">/*</span>
02634 <span class="comment">             * If we aren't already inside the critical section, enter it.</span>
02635 <span class="comment">             * Because this is the first pass, we remain in the critical</span>
02636 <span class="comment">             * section when we return so that our try/finally handlers</span>
02637 <span class="comment">             * are protected by the critical section.</span>
02638 <span class="comment">             * EnterCrit here before GreUnlockDisplay() provides a pti which</span>
02639 <span class="comment">             * may be required if unlocking the display may release some</span>
02640 <span class="comment">             * deferred WinEvents, for which a pti is required.</span>
02641 <span class="comment">             */</span>
02642             <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02643 
02644             pti = (<a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>)pEThread-&gt;Tcb.Win32Thread;
02645 
02646             <span class="comment">/*</span>
02647 <span class="comment">             * WinStations that haven't gone through the first connect do not</span>
02648 <span class="comment">             * have any of the graphics setup.</span>
02649 <span class="comment">             */</span>
02650             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a> || <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a323">gbVideoInitialized</a>) {
02651 
02652                 <span class="comment">/*</span>
02653 <span class="comment">                 * Assert that we did not cleaned up gpDispInfo-&gt;hDev</span>
02654 <span class="comment">                 */</span>
02655                 UserAssert(!gbCleanedUpResources);
02656 
02657                 GreLockDisplay(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>);
02658                 GreUnlockDisplay(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a>);
02659             }
02660 
02661 
02662            <span class="comment">/*</span>
02663 <span class="comment">            * Mark this thread as in the middle of cleanup. This is useful for</span>
02664 <span class="comment">            * several problems in USER where we need to know this information.</span>
02665 <span class="comment">            */</span>
02666            pti-&gt;<a class="code" href="../../d2/d8/structtagTHREADINFO.html#o9">TIF_flags</a> |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a795">TIF_INCLEANUP</a>;
02667 
02668            <span class="comment">/*</span>
02669 <span class="comment">            * If we died during a full screen switch make sure we cleanup</span>
02670 <span class="comment">            * correctly</span>
02671 <span class="comment">            */</span>
02672            <a class="code" href="../../d8/d8/fullscr_8c.html#a9">FullScreenCleanup</a>();
02673            <span class="comment">/*</span>
02674 <span class="comment">            * Cleanup gpDispInfo-&gt;hdcScreen - if we crashed while using it,</span>
02675 <span class="comment">            * it may have owned objects still selected into it. Cleaning</span>
02676 <span class="comment">            * it this way will ensure that gdi doesn't try to delete these</span>
02677 <span class="comment">            * objects while they are still selected into this public hdc.</span>
02678 <span class="comment">            */</span>
02679 
02680            <span class="comment">/*</span>
02681 <span class="comment">            * WinStations that haven't gone through the first connect do not</span>
02682 <span class="comment">            * have any of the graphics setup.</span>
02683 <span class="comment">            */</span>
02684            <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a> || <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a323">gbVideoInitialized</a>) {
02685                GreCleanDC(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>);
02686            }
02687 
02688            <span class="comment">/*</span>
02689 <span class="comment">            * This thread is exiting execution; xxxDestroyThreadInfo cleans</span>
02690 <span class="comment">            *  up everything that can go now</span>
02691 <span class="comment">            */</span>
02692            UserAssert(pti == <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>());
02693            <a class="code" href="../../d4/d1/userk_8h.html#a1885">xxxDestroyThreadInfo</a>();
02694            <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02695 
02696            <span class="keywordflow">break</span>;
02697     }
02698 
02699     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Leaving UserThreadCallout\n"</span>));
02700 
02701     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02702 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="kernel/server.c::VerifySyncOnlyMessages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID VerifySyncOnlyMessages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="kernel/server.c::Win32UserInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS Win32UserInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="kernel/server.c::WRAPPFN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WRAPPFN           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">DesktopWndProc&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="kernel/server.c::xxxUnusedFunctionId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT xxxUnusedFunctionId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>xParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00822">822</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">InitFunctionTables()</a>.
<p>
<pre class="fragment"><div>00828 {
00829     DBG_UNREFERENCED_PARAMETER(pwnd);
00830     DBG_UNREFERENCED_PARAMETER(message);
00831     DBG_UNREFERENCED_PARAMETER(wParam);
00832     DBG_UNREFERENCED_PARAMETER(lParam);
00833     DBG_UNREFERENCED_PARAMETER(xParam);
00834 
00835     UserAssert(FALSE);
00836     <span class="keywordflow">return</span> 0;
00837 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="kernel/server.c::xxxUserProcessCallout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS xxxUserProcessCallout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PW32PROCESS&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Initialize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02882">2882</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01278">tagSHAREDINFO::aheList</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01514">_HANDLEENTRY::bType</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l01068">_WIN32_JOBCALLOUT_PARAMETERS::CalloutType</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l01069">_WIN32_JOBCALLOUT_PARAMETERS::Data</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03592">tagDCE::DCX_flags</a>, <a class="el" href="../../d9/d2/dc_8c-source.html#l01638">DestroyCacheDC()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04976">DestroyProcessInfo()</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00849">giheLast</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00794">gpepCSRSS</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00255">gppiList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00757">gpresUser</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00052">gSharedInfo</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03586">tagDCE::hdc</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l01067">_WIN32_JOBCALLOUT_PARAMETERS::Job</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00491">_EJOB::JobLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02197">tagDISPLAYINFO::pdceFirst</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03585">tagDCE::pdceNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03482">tagPROCESSINFO::ppiNextRunning</a>, <a class="el" href="../../d1/d9/ps_8h.html#a156a94">PsW32JobCalloutAddProcess</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00255">RemoveProcessFromJob()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00541">_EJOB::SessionId</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00905">TYPE_FREE</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00026">UserJobCallout()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l04874">xxxInitProcessInfo()</a>.
<p>
<pre class="fragment"><div>02885 {
02886     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
02887 
02888     <span class="keywordflow">if</span> (Initialize) {
02889 
02890         <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering xxxUserProcessCallout Initialize\n"</span>));
02891 
02892         UserAssert(gpresUser != NULL);
02893         <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02894 
02895         <span class="comment">/*</span>
02896 <span class="comment">         * Initialize the important process level stuff.</span>
02897 <span class="comment">         */</span>
02898         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1200">xxxInitProcessInfo</a>(Process);
02899 
02900         <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02901 
02902         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_SUCCESS) {
02903 
02904             <span class="keywordflow">if</span> (Process-&gt;Process &amp;&amp;
02905                 Process-&gt;Process-&gt;Job &amp;&amp;
02906                 Process-&gt;Process-&gt;Job-&gt;UIRestrictionsClass != 0) {
02907 
02908                 <a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html">WIN32_JOBCALLOUT_PARAMETERS</a> Parms;
02909 
02910                 <a class="code" href="../../d0/d3/struct__EJOB.html">PEJOB</a> Job = Process-&gt;Process-&gt;Job;
02911 
02912                 <span class="comment">/*</span>
02913 <span class="comment">                 * aquire the job's lock and after that enter the user</span>
02914 <span class="comment">                 * critical section.</span>
02915 <span class="comment">                 */</span>
02916                 <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
02917                 <a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>(&amp;Job-&gt;<a class="code" href="../../d0/d3/struct__EJOB.html#o3">JobLock</a>, TRUE);
02918 
02919                 Parms.<a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o0">Job</a> = Job;
02920                 Parms.<a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o1">CalloutType</a> = <a class="code" href="../../d1/d9/ps_8h.html#a156a94">PsW32JobCalloutAddProcess</a>;
02921                 Parms.<a class="code" href="../../d4/d8/struct__WIN32__JOBCALLOUT__PARAMETERS.html#o2">Data</a> = Process;
02922 
02923                 UserAssert(Job-&gt;<a class="code" href="../../d0/d3/struct__EJOB.html#o27">SessionId</a> == Process-&gt;Process-&gt;SessionId);
02924 
02925                 <a class="code" href="../../d4/d1/userk_8h.html#a1144">UserJobCallout</a>(&amp;Parms);
02926 
02927                 <a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>(&amp;Job-&gt;<a class="code" href="../../d0/d3/struct__EJOB.html#o3">JobLock</a>);
02928                 <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
02929             }
02930         }
02931     } <span class="keywordflow">else</span> {
02932 
02933         <span class="keywordtype">int</span>  i;
02934         <a class="code" href="../../d2/d4/struct__HANDLEENTRY.html">PHE</a>  phe;
02935         <a class="code" href="../../d3/d2/structtagDCE.html">PDCE</a> *ppdce;
02936         <a class="code" href="../../d3/d2/structtagDCE.html">PDCE</a> pdce;
02937 
02938         <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering xxxUserProcessCallout Cleanup\n"</span>));
02939 
02940         UserAssert(gpresUser != NULL);
02941 
02942         <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02943 
02944 <span class="preprocessor">#if DBG</span>
02945 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (Process-&gt;Process == <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a>) {
02946 
02947             <span class="comment">/*</span>
02948 <span class="comment">             * CSRSS should be the last to go ...</span>
02949 <span class="comment">             */</span>
02950             UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a110">gppiList</a>-&gt;<a class="code" href="../../d7/d3/structtagPROCESSINFO.html#o8">ppiNextRunning</a> == NULL);
02951         }
02952 <span class="preprocessor">#endif // DBG</span>
02953 <span class="preprocessor"></span>
02954         <span class="keywordflow">if</span> (Process-&gt;Process &amp;&amp; Process-&gt;Process-&gt;Job != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02955             <a class="code" href="../../d4/d1/userk_8h.html#a1145">RemoveProcessFromJob</a>((<a class="code" href="../../d7/d3/structtagPROCESSINFO.html">PPROCESSINFO</a>)Process);
02956         }
02957 
02958         <span class="comment">/*</span>
02959 <span class="comment">         * DestroyProcessInfo will return TRUE if any threads ever</span>
02960 <span class="comment">         * connected.  If nothing ever connected, we needn't do</span>
02961 <span class="comment">         * this cleanup.</span>
02962 <span class="comment">         */</span>
02963         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1190">DestroyProcessInfo</a>(Process)) {
02964 
02965             <span class="comment">/*</span>
02966 <span class="comment">             * See if we can compact the handle table.</span>
02967 <span class="comment">             */</span>
02968             i = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a308">giheLast</a>;
02969             phe = &amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o1">aheList</a>[<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a308">giheLast</a>];
02970             <span class="keywordflow">while</span> ((phe &gt; &amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o1">aheList</a>[0]) &amp;&amp; (phe-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o2">bType</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a236">TYPE_FREE</a>)) {
02971                 phe--;
02972                 <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a308">giheLast</a>--;
02973             }
02974 
02975             <span class="comment">/*</span>
02976 <span class="comment">             * Scan the DC cache to find any DC's that need to be destroyed.</span>
02977 <span class="comment">             */</span>
02978             <span class="keywordflow">for</span> (ppdce = &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o9">pdceFirst</a>; *ppdce != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; ) {
02979 
02980                 pdce = *ppdce;
02981                 <span class="keywordflow">if</span> (pdce-&gt;<a class="code" href="../../d3/d2/structtagDCE.html#o7">DCX_flags</a> &amp; DCX_DESTROYTHIS)
02982                     <a class="code" href="../../d4/d1/userk_8h.html#a1700">DestroyCacheDC</a>(ppdce, pdce-&gt;<a class="code" href="../../d3/d2/structtagDCE.html#o1">hdc</a>);
02983 
02984                 <span class="comment">/*</span>
02985 <span class="comment">                 * Step to the next DC.  If the DC was deleted, there</span>
02986 <span class="comment">                 * is no need to calculate address of the next entry.</span>
02987 <span class="comment">                 */</span>
02988                 <span class="keywordflow">if</span> (pdce == *ppdce)
02989                     ppdce = &amp;pdce-&gt;<a class="code" href="../../d3/d2/structtagDCE.html#o0">pdceNext</a>;
02990             }
02991         }
02992 
02993         UserAssert(gpresUser != NULL);
02994 
02995         <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02996     }
02997 
02998     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Leaving xxxUserProcessCallout\n"</span>));
02999 
03000     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
03001 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="kernel/server.c::xxxWrapCallWindowProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT xxxWrapCallWindowProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>xParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00849">849</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01207">tagSERVERINFO::apfnClientA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01208">tagSERVERINFO::apfnClientW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01562">CPD_UNICODE_TO_ANSI</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d7/d8/rtl_2wow_8c-source.html#l00353">HMValidateHandleNoRip()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01580">_CALLPROCDATA::pfnClientPrevious</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00878">_PFNCLIENT::pfnDispatchMessage</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00867">_PFNCLIENT::pfnEditWndProc</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02248">SCMS_FLAGS_ANSI</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02263">ScSendMessage</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00912">TYPE_CALLPROC</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01658">_CALLPROCDATA::wType</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">InitFunctionTables()</a>.
<p>
<pre class="fragment"><div>00855 {
00856     <a class="code" href="../../d3/d7/struct__CALLPROCDATA.html">PCALLPROCDATA</a> pCPD;
00857     LRESULT       lRet = 0;
00858 
00859     <span class="keywordflow">if</span> (pCPD = <a class="code" href="../../d6/d9/rtl_2wow_8c.html#a8">HMValidateHandleNoRip</a>((PVOID)xParam, TYPE_CALLPROC)) {
00860 
00861         lRet = <a class="code" href="../../d4/d1/userk_8h.html#a246">ScSendMessage</a>(pwnd,
00862                               message,
00863                               wParam,
00864                               lParam,
00865                               pCPD-&gt;<a class="code" href="../../d3/d7/struct__CALLPROCDATA.html#o2">pfnClientPrevious</a>,
00866                               <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o17">pfnDispatchMessage</a>,
00867                               (pCPD-&gt;<a class="code" href="../../d3/d7/struct__CALLPROCDATA.html#o3">wType</a> &amp; CPD_UNICODE_TO_ANSI) ?
00868                                       SCMS_FLAGS_ANSI : 0);
00869 
00870     } <span class="keywordflow">else</span> {
00871 
00872         <span class="comment">/*</span>
00873 <span class="comment">         * If it is not a real call proc handle it must be a special</span>
00874 <span class="comment">         * handler for editwndproc or regular EditWndProc</span>
00875 <span class="comment">         */</span>
00876         lRet = <a class="code" href="../../d4/d1/userk_8h.html#a246">ScSendMessage</a>(pwnd,
00877                               message,
00878                               wParam,
00879                               lParam,
00880                               xParam,
00881                               <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o8">apfnClientA</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o17">pfnDispatchMessage</a>,
00882                               (xParam == (ULONG_PTR)<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o8">apfnClientA</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o9">pfnEditWndProc</a>) ?
00883                                       SCMS_FLAGS_ANSI : 0);
00884     }
00885 
00886     <span class="keywordflow">return</span> lRet;
00887 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="kernel/server.c::xxxWrapSendMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT xxxWrapSendMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>xParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00763">763</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00764">xxxSendMessageTimeout()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">InitFunctionTables()</a>.
<p>
<pre class="fragment"><div>00769 {
00770     DBG_UNREFERENCED_PARAMETER(xParam);
00771 
00772     <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a1580">xxxSendMessageTimeout</a>(pwnd,
00773                                  message,
00774                                  wParam,
00775                                  lParam,
00776                                  SMTO_NORMAL,
00777                                  0,
00778                                  NULL);
00779 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="kernel/server.c::xxxWrapSendMessageBSM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LRESULT xxxWrapSendMessageBSM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>xParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00781">781</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00807">BROADCASTSYSTEMMSGPARAMS::dwRecipients</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d9/server_2exitwin_8c-source.html#l02001">IsPrivileged()</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a987">LPBROADCASTSYSTEMMSGPARAMS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00575">ProbeAndReadBroadcastSystemMsgParams</a>, <a class="el" href="../../d0/d6/ntuser_2kernel_2globals_8h-source.html#l00512">psTcb</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00466">xxxSendMessageBSM()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">InitFunctionTables()</a>.
<p>
<pre class="fragment"><div>00787 {
00788     <a class="code" href="../../d3/d1/structBROADCASTSYSTEMMSGPARAMS.html">BROADCASTSYSTEMMSGPARAMS</a> bsmParams;
00789 
00790     <span class="keywordflow">try</span> {
00791         bsmParams = <a class="code" href="../../d4/d1/userk_8h.html#a59">ProbeAndReadBroadcastSystemMsgParams</a>((LPBROADCASTSYSTEMMSGPARAMS)xParam);
00792     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00793         <span class="keywordflow">return</span> 0;
00794     }
00795 
00796     <span class="comment">/*</span>
00797 <span class="comment">     * If this broadcast is going to all desktops, make sure the thread has</span>
00798 <span class="comment">     * sufficient privileges. Do the check here, so we don't effect kernel</span>
00799 <span class="comment">     * generated broadcasts (i.e power messages).</span>
00800 <span class="comment">     */</span>
00801     <span class="keywordflow">if</span> (bsmParams.<a class="code" href="../../d3/d1/structBROADCASTSYSTEMMSGPARAMS.html#o0">dwRecipients</a> &amp; (BSM_ALLDESKTOPS)) {
00802         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0/server_2exitwin_8c.html#a22">IsPrivileged</a>(&amp;psTcb)) {
00803             bsmParams.<a class="code" href="../../d3/d1/structBROADCASTSYSTEMMSGPARAMS.html#o0">dwRecipients</a> &amp;= ~(BSM_ALLDESKTOPS);
00804         }
00805     }
00806 
00807     <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a1577">xxxSendMessageBSM</a>(pwnd,
00808                              message,
00809                              wParam,
00810                              lParam,
00811                              &amp;bsmParams);
00812 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a37" doxytag="kernel/server.c::gawButtonWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a37">gawButtonWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00251">251</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="kernel/server.c::gawComboWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a39">gawComboWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00378">378</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="kernel/server.c::gawDefDlgProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a32">gawDefDlgProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00113">113</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="kernel/server.c::gawDefWindowMsgs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a42">gawDefWindowMsgs</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00589">589</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="kernel/server.c::gawDefWindowSpecMsgs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a43">gawDefWindowSpecMsgs</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00637">637</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="kernel/server.c::gawDesktopWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a34">gawDesktopWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    WM_PAINT,
    WM_ERASEBKGND,
    0
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00192">192</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="kernel/server.c::gawEditWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a40">gawEditWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00467">467</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="kernel/server.c::gawImeWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a41">gawImeWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    WM_ERASEBKGND,
    WM_PAINT,
    WM_DESTROY,
    WM_NCDESTROY,
    WM_FINALDESTROY,
    WM_CREATE,
    WM_IME_SYSTEM,
    WM_IME_SELECT,
    WM_IME_CONTROL,
    WM_IME_SETCONTEXT,
    WM_IME_NOTIFY,
    WM_IME_COMPOSITION,
    WM_IME_STARTCOMPOSITION,
    WM_IME_ENDCOMPOSITION,
    WM_IME_REQUEST,
    WM_COPYDATA,
    0
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00565">565</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="kernel/server.c::gawListboxWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a38">gawListboxWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00288">288</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="kernel/server.c::gawMenuWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a33">gawMenuWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00149">149</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="kernel/server.c::gawScrollBarWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a35">gawScrollBarWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    WM_CREATE,
    WM_SETFOCUS,
    WM_KILLFOCUS,
    WM_ERASEBKGND,
    WM_PAINT,
    WM_LBUTTONDBLCLK,
    WM_LBUTTONDOWN,
    WM_KEYUP,
    WM_KEYDOWN,
    WM_ENABLE,
    SBM_ENABLE_ARROWS,
    SBM_SETPOS,
    SBM_SETRANGEREDRAW,
    SBM_SETRANGE,
    SBM_SETSCROLLINFO,
    SBM_GETSCROLLINFO,
    WM_PRINTCLIENT,
    WM_MOUSEMOVE,
    WM_MOUSELEAVE,
    0
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00198">198</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="kernel/server.c::gawStaticWndProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WORD <a class="el" href="../../d9/d6/kernel_2server_8c.html#a36">gawStaticWndProc</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    STM_GETICON,
    STM_GETIMAGE,
    STM_SETICON,
    STM_SETIMAGE,
    WM_ERASEBKGND,
    WM_PAINT,
    WM_PRINTCLIENT,
    WM_CREATE,
    WM_DESTROY,
    WM_NCCREATE,
    WM_NCDESTROY,
    WM_FINALDESTROY,
    WM_NCHITTEST,
    WM_LBUTTONDOWN,
    WM_NCLBUTTONDOWN,
    WM_LBUTTONDBLCLK,
    WM_NCLBUTTONDBLCLK,
    WM_SETTEXT,
    WM_ENABLE,
    WM_GETDLGCODE,
    WM_SETFONT,
    WM_GETFONT,
    WM_GETTEXT,
    WM_TIMER,
    WM_INPUTLANGCHANGEREQUEST,
    WM_UPDATEUISTATE,
    0
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00221">221</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="kernel/server.c::gbUserInitialized" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d9/d6/kernel_2server_8c.html#a13">gbUserInitialized</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00016">16</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02595">UserThreadCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="kernel/server.c::gDispatchTableValues" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WORD <a class="el" href="../../d0/d7/server_2server_8c.html#a21">gDispatchTableValues</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00014">14</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="kernel/server.c::giSetupExe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="../../d9/d6/kernel_2server_8c.html#a47">giSetupExe</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01547">1547</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">CreateSetupNameArray()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l00702">SetAppImeCompatFlags()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="kernel/server.c::glpSetupPrograms" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR* <a class="el" href="../../d9/d6/kernel_2server_8c.html#a48">glpSetupPrograms</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01550">1550</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">CreateSetupNameArray()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="kernel/server.c::gpastrSetupExe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING* <a class="el" href="../../d9/d6/kernel_2server_8c.html#a46">gpastrSetupExe</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01546">1546</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="kernel/server.c::lpszControls" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST LPCWSTR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a45">lpszControls</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Button"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Edit"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Static"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ListBox"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ScrollBar"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ComboBox"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"MDIClient"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ComboLBox"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLEvent"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLMom"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DMGClass"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLAnsiClient"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLUnicodeClient"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLAnsiServer"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLUnicodeServer"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"IME"</span>,
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00714">714</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="kernel/server.c::lpszOLEFormats" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST LPCWSTR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a44">lpszOLEFormats</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ObjectLink"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"OwnerLink"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Native"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Binary"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"FileName"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"FileNameW"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"NetworkName"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DataObject"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Embedded Object"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Embed Source"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Custom Link Source"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Link Source"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Object Descriptor"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Link Source Descriptor"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"OleDraw"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"PBrush"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"MSDraw"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Ole Private Data"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Screen Picture"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"OleClipboardPersistOnFlush"</span>,
    <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"MoreOlePrivateData"</span>
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00690">690</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01087">InitOLEFormats()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="kernel/server.c::szACTIVATESHELLWINDOW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a27">szACTIVATESHELLWINDOW</a>[] = L"ACTIVATESHELLWINDOW"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00082">82</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="kernel/server.c::szCHECKPOINT_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a14">szCHECKPOINT_PROP_NAME</a>[] = L"SysCP"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00069">69</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="kernel/server.c::szCONTEXTHELPIDPROP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a23">szCONTEXTHELPIDPROP</a>[] = L"SysCH"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00078">78</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="kernel/server.c::szDDEIMP_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a17">szDDEIMP_PROP_NAME</a>[] = L"SysDDEI"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00072">72</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="kernel/server.c::szDDETRACK_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a15">szDDETRACK_PROP_NAME</a>[] = L"SysDT"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00070">70</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="kernel/server.c::szFLASHWSTATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a31">szFLASHWSTATE</a>[] = L"FlashWState"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00086">86</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="kernel/server.c::szICON_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a25">szICON_PROP_NAME</a>[] = ICON_PROP_NAME          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00080">80</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="kernel/server.c::szICONSM_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a24">szICONSM_PROP_NAME</a>[] = L"SysICS"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00079">79</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="kernel/server.c::szIMELEVEL_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a19">szIMELEVEL_PROP_NAME</a>[] = L"SysIMEL"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00074">74</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="kernel/server.c::szLAYER_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a20">szLAYER_PROP_NAME</a>[] = L"SysLayer"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00075">75</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="kernel/server.c::szMESSAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a22">szMESSAGE</a>[] = L"Message"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00077">77</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="kernel/server.c::szOLEMAINTHREADWNDCLASS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a30">szOLEMAINTHREADWNDCLASS</a>[] = L"OleMainThreadWndClass"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00085">85</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="kernel/server.c::szOTHERWINDOWCREATED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a28">szOTHERWINDOWCREATED</a>[] = L"OTHERWINDOWCREATED"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00083">83</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="kernel/server.c::szOTHERWINDOWDESTROYED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a29">szOTHERWINDOWDESTROYED</a>[] = L"OTHERWINDOWDESTROYED"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00084">84</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="kernel/server.c::szQOS_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a16">szQOS_PROP_NAME</a>[] = L"SysQOS"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00071">71</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="kernel/server.c::szSHELLHOOK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a26">szSHELLHOOK</a>[] = L"SHELLHOOK"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00081">81</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="kernel/server.c::szUSER32" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a21">szUSER32</a>[] = L"USER32"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00076">76</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="kernel/server.c::szWNDOBJ_PROP_NAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d9/d6/kernel_2server_8c.html#a18">szWNDOBJ_PROP_NAME</a>[] = L"SysWNDO"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00073">73</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:37 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
