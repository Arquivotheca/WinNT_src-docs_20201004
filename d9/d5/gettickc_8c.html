<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: gettickc.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>gettickc.c File Reference</h1><code>#include "<a class="el" href="../../d5/d9/exp_8h-source.html">exp.h</a>"</code><br>

<p>
<a href="../../d0/d5/gettickc_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a> (VOID)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="gettickc.c::NtGetTickCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG NtGetTickCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">26</a> of file <a class="el" href="../../d0/d5/gettickc_8c-source.html">gettickc.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l03315">ExpTickCountMultiplier</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l02797">KeTickCount</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/sprite_8c-source.html#l00984">AnimateFade()</a>, <a class="el" href="../../d1/d8/clmsg_8c-source.html#l01533">DispatchMessageWorker()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d6/d1/hungapp_8c-source.html#l00080">FHungApp()</a>, <a class="el" href="../../d7/d1/mndraw_8c-source.html#l00290">MNAnimate()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00048">MonotonicTick()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00483">PeekMessage()</a>, <a class="el" href="../../d6/d2/ntuser_2kernel_2input_8c-source.html#l01254">PostMove()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l01137">ProcessMouseInput()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l03644">RtlpGet64BitTickCount()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l05256">RtlpInitializeTimerThreadPool()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l01820">RtlpStartIOWorkerThread()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l01763">RtlpStartWorkerThread()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l02824">RtlpWaitThread()</a>, <a class="el" href="../../d3/d0/threads_8c-source.html#l00437">RtlQueueWorkItem()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d9/d3/sprite_8c-source.html#l00879">StartFade()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04799">StoreMessage()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04831">StoreQMessage()</a>, <a class="el" href="../../d5/d1/timers_8c-source.html#l00746">TimersProc()</a>, <a class="el" href="../../d2/d3/tooltips_8c-source.html#l00148">TooltipAnimate()</a>, <a class="el" href="../../d7/d4/vdmtrace_8c-source.html#l00037">VdmTraceEvent()</a>, <a class="el" href="../../d4/d5/focusact_8c-source.html#l00472">xxxActivateThisWindow()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l00558">xxxAnimateCaption()</a>, <a class="el" href="../../d2/d1/hooks_8c-source.html#l01797">xxxCallJournalPlaybackHook()</a>, <a class="el" href="../../d6/d2/ntuser_2kernel_2input_8c-source.html#l00762">xxxDispatchMessage()</a>, <a class="el" href="../../d6/d1/hungapp_8c-source.html#l00446">xxxHungAppDemon()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l01296">xxxInterSendMsgEx()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00275">xxxMessageEvent()</a>, <a class="el" href="../../d9/d2/ntuser_2kernel_2access_8c-source.html#l01675">xxxMKButtonSetState()</a>, <a class="el" href="../../d9/d2/ntuser_2kernel_2access_8c-source.html#l01616">xxxMKMouseMove()</a>, <a class="el" href="../../d9/d2/ntuser_2kernel_2access_8c-source.html#l01543">xxxMKMoveAccelCursorTimer()</a>, <a class="el" href="../../d9/d2/ntuser_2kernel_2access_8c-source.html#l01486">xxxMKMoveConstCursorTimer()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03213">xxxMouseEventDirect()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05481">xxxPollAndWaitForSingleObject()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02791">xxxProcessKeyEvent()</a>, <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00536">xxxPushKeyEvent()</a>, <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00446">xxxRemoteStopScreenUpdates()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l03797">xxxSimulateShiftF10()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l01497">xxxSystemParametersInfo()</a>, <a class="el" href="../../d2/d3/tooltips_8c-source.html#l00570">xxxTooltipWndProc()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00481">xxxUserPowerStateCalloutWorker()</a>, <a class="el" href="../../d6/d6/kernel_2winable_8c-source.html#l00274">xxxWindowEvent()</a>, <a class="el" href="../../d8/d0/ntuser_2kernel_2cursor_8c-source.html#l00389">zzzAnimateCursor()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00591">zzzCalcStartCursorHide()</a>, <a class="el" href="../../d8/d0/ntuser_2kernel_2cursor_8c-source.html#l00080">zzzSetCursorPos()</a>, and <a class="el" href="../../d8/d0/ntuser_2kernel_2cursor_8c-source.html#l00496">zzzUpdateCursorImage()</a>.
<p>
<pre class="fragment"><div>00032                    :
00033 
00034     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of milliseconds since <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system
00035     was booted. The computation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed by multiplying <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> clock
00036     interrupt count by a scaled fixed binary multiplier and then right
00037     shifting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 64-bit result to extract <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> 32-bit millisecond count.
00038 
00039     The multiplier fraction <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> scaled by 24 bits. Thus <span class="keywordflow">for</span> a 100 Hz clock
00040     rate, there are 10 ticks per millisecond, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> multiplier <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00041     0x0a000000 (10 &lt;&lt; 24). For a 128 Hz clock rate, there are 7.8125, or
00042     7 13/16 ticks per millisecond, and so <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> multiplier <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> 0x07d00000.
00043 
00044     This effectively replaces a (slow) divide instruction with a (fast)
00045     multiply instruction. The multiplier value is only calculated once
00046     based on the TimeIncrement value (clock tick interval in 100ns units).
00047 
00048     N.B. The tick count value wraps every 2^32 milliseconds (49.71 days).
00049 
00050 Arguments:
00051 
00052     None.
00053 
00054 Return Value:
00055 
00056     The number of milliseconds since the system was booted is returned
00057     as the function value.
00058 
00059 --*/
00060 
00061 {
00062     ULONGLONG Product;
00063 
00064     <span class="comment">//</span>
00065     <span class="comment">// compute unsigned 64-bit product</span>
00066     <span class="comment">//</span>
00067 
00068     Product = (ULONGLONG)<a class="code" href="../../d4/d9/ke_8h.html#a147">KeTickCount</a> * <a class="code" href="../../d5/d8/ex_8h.html#a165">ExpTickCountMultiplier</a>;
00069 
00070     <span class="comment">//</span>
00071     <span class="comment">// shift off 24-bit fraction part and </span>
00072     <span class="comment">// return the 32-bit canonical ULONG integer part.</span>
00073     <span class="comment">//</span>
00074             
00075     <span class="keywordflow">return</span> ((ULONG)(Product &gt;&gt; 24));
00076 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:54 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
