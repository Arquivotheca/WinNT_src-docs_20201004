<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CProfileAssociationPage class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CProfileAssociationPage Class Reference</h1><code>#include &lt;<a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CProfileAssociationPage:
<p><center><img src="d9/d5/classCProfileAssociationPage.png" usemap="#CProfileAssociationPage_map" border="0" alt=""></center>
<map name="CProfileAssociationPage_map">
<area href="d9/d6/classCShellExtensionPage.html" alt="CShellExtensionPage" shape="rect" coords="0,56,152,80">
<area href="d2/d6/classCPropertyPage.html" alt="CPropertyPage" shape="rect" coords="0,0,152,24">
</map>
<a href="../../d7/d2/classCProfileAssociationPage-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a0">CProfileAssociationPage</a> (HINSTANCE hiWhere, LPCTSTR lpstrTarget)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a1">~CProfileAssociationPage</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a4">OnInit</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a5">OnCommand</a> (WORD wNotifyCode, WORD wid, HWND hwndControl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a6">OnNotify</a> (int idCtrl, LPNMHDR pnmh)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a7">OnDestroy</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a8">OnHelp</a> (LPHELPINFO pHelp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a9">OnContextMenu</a> (HWND hwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HINSTANCE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a10">Instance</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d5/classCProfile.html">CProfile</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a11">Profile</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a12">Associate</a> (unsigned uAdd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a13">Dissociate</a> (unsigned uRemove)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a14">Association</a> (unsigned u)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a> () const</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a16">AssociationChanged</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a17">DeviceListChanged</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCTSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#a18">DisplayName</a> (unsigned u)</td></tr>

<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r0">m_csProfile</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d5/classCProfile.html">CProfile</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r5">m_bAssociationChanged</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CProfileAssociationPage::CProfileAssociationPage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CProfileAssociationPage::CProfileAssociationPage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hiWhere</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrTarget</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00036">36</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00092">AssociateDevicePage</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00032">AssociatePropertyString</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00036">CProfileAssociationPage()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00022">m_csProfile</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00036">CProfileAssociationPage()</a>.
<p>
<pre class="fragment"><div>00037                                                                       {
00038     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00039     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r0">m_csProfile</a> = lpstrTarget;
00040     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.dwSize = <span class="keyword">sizeof</span> <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>;
00041     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.dwFlags |= PSP_USETITLE;
00042     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.hInstance = hiWhere;
00043     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.pszTemplate = MAKEINTRESOURCE(AssociateDevicePage);
00044     <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.pszTitle = MAKEINTRESOURCE(AssociatePropertyString);
00045 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CProfileAssociationPage::~CProfileAssociationPage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CProfileAssociationPage::~<a class="el" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00049">49</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>.
<p>
<pre class="fragment"><div>00049                                                   {
00050     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00051         <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00052     }
00053 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a12" doxytag="CProfileAssociationPage::Associate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfileAssociationPage::Associate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>uAdd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">132</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00424">CUintArray::Add()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00065">DeviceListChanged()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">m_cuaAdd</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">m_cuaAssociate</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">m_cuaDelete</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00421">CAddDeviceDialog::OnCommand()</a>.
<p>
<pre class="fragment"><div>00132                                                         {
00133 
00134     <span class="comment">//  First, see if it's on the delete list.  If it is, remove it from there</span>
00135     <span class="comment">//  Otherwise, add us to the add list, if it's a new association.</span>
00136 
00137     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00138         <span class="keywordflow">if</span>  (uAdd == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>[u])
00139             <span class="keywordflow">break</span>;
00140 
00141     <span class="keywordflow">if</span>  (u &lt; m_cuaDelete.Count())
00142         m_cuaDelete.Remove(u);
00143     <span class="keywordflow">else</span> {
00144         <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00145             <span class="keywordflow">if</span>  (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>[u] == uAdd)
00146                 <span class="keywordflow">break</span>;
00147         <span class="keywordflow">if</span>  (u == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>())
00148             <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(uAdd);
00149     }
00150 
00151     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a17">DeviceListChanged</a>();
00152 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="CProfileAssociationPage::Association" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned CProfileAssociationPage::Association           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>u</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00055">55</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00055">Association()</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">m_cuaAssociate</a>.
<p>
Referenced by <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00055">Association()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00389">CAddDeviceDialog::OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
<pre class="fragment"><div>00055                                         {
00056         <span class="keywordflow">return</span>  <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>[u]; 
00057     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="CProfileAssociationPage::AssociationChanged" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::AssociationChanged           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00061">61</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00031">m_bAssociationChanged</a>.
<p>
<pre class="fragment"><div>00061                                         {
00062         <span class="keywordflow">return</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r5">m_bAssociationChanged</a>;
00063     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="CProfileAssociationPage::AssociationCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned CProfileAssociationPage::AssociationCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00058">58</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">m_cuaAssociate</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00389">CAddDeviceDialog::OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
<pre class="fragment"><div>00058                                          { 
00059         <span class="keywordflow">return</span>  <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00060     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CProfileAssociationPage::ConstructAssociations" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CProfileAssociationPage::ConstructAssociations           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">107</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00424">CUintArray::Add()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">CProfile::Association()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">CProfile::AssociationCount()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00412">CUintArray::Empty()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">m_cuaAdd</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">m_cuaAssociate</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">m_cuaDelete</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00065">DeviceListChanged()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.
<p>
<pre class="fragment"><div>00107                                                        {
00108 
00109     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>(); <span class="comment">//  Clean it up!</span>
00110 
00111     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a9">AssociationCount</a>(); u++) {
00112 
00113         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uDelete = 0;
00114              uDelete &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00115              uDelete++) {
00116             <span class="keywordflow">if</span>  (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>[uDelete] == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a12">Association</a>(u))
00117                 <span class="keywordflow">break</span>;
00118         }
00119 
00120         <span class="keywordflow">if</span>  (uDelete == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>())    <span class="comment">//  Not yet deleted</span>
00121             <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a12">Association</a>(u));
00122     }
00123 
00124     <span class="comment">//  Now, add any added associations</span>
00125 
00126     <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00127         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(m_cuaAdd[u]);
00128 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="CProfileAssociationPage::DeviceListChanged" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CProfileAssociationPage::DeviceListChanged           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00065">65</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>.
<p>
<pre class="fragment"><div>00065                                         {
00066         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a>();
00067     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="CProfileAssociationPage::DisplayName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCTSTR CProfileAssociationPage::DisplayName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>u</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">69</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">CProfile::DisplayName()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">DisplayName()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">m_cuaAssociate</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>.
<p>
Referenced by <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">DisplayName()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
<pre class="fragment"><div>00069                                         { 
00070         <span class="keywordflow">return</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a11">DisplayName</a>(m_cuaAssociate[u]);
00071     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="CProfileAssociationPage::Dissociate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfileAssociationPage::Dissociate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>uRemove</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">156</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00424">CUintArray::Add()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00065">DeviceListChanged()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">m_cuaAdd</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">m_cuaDelete</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00220">OnCommand()</a>.
<p>
<pre class="fragment"><div>00156                                                             {
00157 
00158     <span class="comment">//  First, see if it's on the add list.  If it is, remove it from there</span>
00159     <span class="comment">//  Otherwise, add us to the delete list.</span>
00160 
00161     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00162         <span class="keywordflow">if</span>  (uRemove == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>[u])
00163             <span class="keywordflow">break</span>;
00164 
00165     <span class="keywordflow">if</span>  (u &lt; m_cuaAdd.Count())
00166         m_cuaAdd.Remove(u);
00167     <span class="keywordflow">else</span>
00168         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(uRemove);
00169 
00170     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a17">DeviceListChanged</a>();
00171 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="CProfileAssociationPage::Instance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HINSTANCE CProfileAssociationPage::Instance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00049">49</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
<pre class="fragment"><div>00049 { <span class="keywordflow">return</span> <a class="code" href="../../d2/d6/classCPropertyPage.html#p0">m_psp</a>.hInstance; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="CProfileAssociationPage::OnCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wNotifyCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndControl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a7">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00220">220</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00093">CAddDeviceDialog::bCanceled()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00106">DeviceListControl</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00061">CPropertyPage::EnableApplyButton()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00220">OnCommand()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00717">SendDlgItemMessage()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00220">OnCommand()</a>.
<p>
<pre class="fragment"><div>00220                                                                                        {
00221 
00222     <span class="keywordflow">switch</span> (wid) {
00223 
00224         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a> :
00225             <span class="keywordflow">if</span>  (wNotifyCode == BN_CLICKED) {
00226                 <a class="code" href="../../d4/d1/classCAddDeviceDialog.html">CAddDeviceDialog</a> cadd(<span class="keyword">this</span>, m_hwnd);
00227                 <span class="keywordflow">if</span> (!cadd.<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a5">bCanceled</a>()) {
00228                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00229                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00230                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(TRUE);
00231                 }
00232                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00233             }
00234             <span class="keywordflow">break</span>;
00235 
00236         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a> :
00237             <span class="keywordflow">if</span>  (wNotifyCode == BN_CLICKED) {
00238                 LRESULT i = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl,
00239                     LB_GETCURSEL, 0, 0);
00240 
00241                 <span class="keywordflow">if</span>  (i == -1)
00242                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00243 
00244                 <span class="keywordtype">unsigned</span> uItem = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl,
00245                     LB_GETITEMDATA, i, 0);
00246                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a13">Dissociate</a>(uItem);
00247                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00248                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00249                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(TRUE);
00250                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00251             }
00252             <span class="keywordflow">break</span>;
00253 
00254         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a> :
00255             <span class="keywordflow">if</span> (wNotifyCode == LBN_SELCHANGE) {
00256                 <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton),
00257                     -1 != <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_GETCURSEL, 0, 0));
00258                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00259             }
00260             <span class="keywordflow">break</span>;
00261     }
00262 
00263     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00264 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="CProfileAssociationPage::OnContextMenu" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnContextMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a12">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00358">358</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d8/nt6_2dlgmgr_8c-source.html#l00169">GetDlgCtrlID()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00358">OnContextMenu()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00020">ProfileAssociationUIHelpIds</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00358">OnContextMenu()</a>.
<p>
<pre class="fragment"><div>00358                                                         {
00359 
00360     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iCtrlID = <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a11">GetDlgCtrlID</a>(hwnd);
00361 
00362     WinHelp(hwnd, WINDOWS_HELP_FILE,
00363             HELP_CONTEXTMENU, (ULONG_PTR) (LPSTR) ProfileAssociationUIHelpIds);
00364 
00365     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00366 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="CProfileAssociationPage::OnDestroy" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnDestroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a10">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00266">266</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00266                                            {
00267 
00268     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00269         <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00270         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = (<a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> *) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00271     }
00272 
00273     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;  <span class="comment">// still need to handle this message by def. proc.</span>
00274 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="CProfileAssociationPage::OnHelp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnHelp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPHELPINFO&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pHelp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a11">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00348">348</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00348">OnHelp()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00020">ProfileAssociationUIHelpIds</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00348">OnHelp()</a>.
<p>
<pre class="fragment"><div>00348                                                         {
00349 
00350     <span class="keywordflow">if</span> (pHelp-&gt;iContextType == HELPINFO_WINDOW) {
00351         WinHelp((HWND) pHelp-&gt;hItemHandle, WINDOWS_HELP_FILE,
00352                 HELP_WM_HELP, (ULONG_PTR) (LPSTR) ProfileAssociationUIHelpIds);
00353     }
00354 
00355     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00356 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CProfileAssociationPage::OnInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a9">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">57</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00084">DefaultIcon</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00412">CUintArray::Empty()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00182">CProfile::GetName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">CProfile::IsInstalled()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00022">m_csProfile</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">m_cuaAdd</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">m_cuaDelete</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00119">ProfileFilename</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00717">SendDlgItemMessage()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00768">SetDlgItemText()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00123">StatusIcon</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00085">UninstalledIcon</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
<pre class="fragment"><div>00057                                         {
00058 
00059     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>(m_csProfile);
00060 
00061     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00062 
00063         <span class="comment">// Set profile filename</span>
00064 
00065         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, ProfileFilename, <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>());
00066 
00067         <span class="comment">// Update ICON to show installed/non-installed status.</span>
00068 
00069         HICON hIcon = LoadIcon(CGlobals::Instance(),
00070                                MAKEINTRESOURCE(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>() ? <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a44">DefaultIcon</a> : <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a45">UninstalledIcon</a>));
00071 
00072         <span class="keywordflow">if</span> (hIcon) {
00073             <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, StatusIcon, STM_SETICON, (WPARAM) hIcon, 0);
00074         }
00075 
00076         <span class="comment">// Clean up add/delete list.</span>
00077 
00078         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>();
00079         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>();
00080 
00081         <span class="comment">// Build tentitive association list.</span>
00082 
00083         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a>();
00084 
00085         <span class="comment">// And then, fill up device listbox</span>
00086 
00087         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00088 
00089         <span class="comment">// And set focus on AddButton.</span>
00090 
00091         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd,AddButton));
00092 
00093         <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00094         <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
00095 
00096         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00097 
00098     } <span class="keywordflow">else</span> {
00099         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00100     }
00101 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="CProfileAssociationPage::OnNotify" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfileAssociationPage::OnNotify           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idCtrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPNMHDR&nbsp;</td>
          <td class="mdname" nowrap> <em>pnmh</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a8">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">278</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">CProfile::Associate()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00084">DefaultIcon</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">CProfile::DeviceName()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">CProfile::Dissociate()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">CProfile::IsInstalled()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00022">m_csProfile</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">m_cuaAdd</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">m_cuaDelete</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00449">CUintArray::Remove()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00717">SendDlgItemMessage()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00123">StatusIcon</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00085">UninstalledIcon</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">UpdateDeviceListBox()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.
<p>
<pre class="fragment"><div>00278                                                                   {
00279 
00280     <span class="keywordflow">switch</span>  (pnmh -&gt; code) {
00281 
00282         <span class="keywordflow">case</span> PSN_APPLY: {
00283 
00284             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>()) {
00285 
00286                 <span class="comment">//  Disable apply button, because current request are</span>
00287                 <span class="comment">//  going to be "Applied".</span>
00288 
00289                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00290 
00291                 <span class="comment">//  We are going to update changed.</span>
00292 
00293                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
00294 
00295                 <span class="comment">//  Remove any associations we're removing</span>
00296 
00297                 <span class="keywordflow">while</span>   (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) {
00298                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a17">Dissociate</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(m_cuaDelete[0]));
00299                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(0);
00300                 }
00301 
00302                 <span class="comment">//  Add any associations we're adding</span>
00303 
00304                 <span class="keywordflow">while</span>   (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) {
00305                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a16">Associate</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(m_cuaAdd[0]));
00306                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(0);
00307                 }
00308 
00309                 <span class="comment">//  Re-create CProfile object.</span>
00310                 <span class="comment">//</span>
00311                 <span class="comment">//  !!! Need to be done some performance work here.</span>
00312 
00313                 <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00314                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>(m_csProfile);
00315 
00316                 <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>)
00317                 {
00318                     <span class="comment">// BUGBUG proper error should happen.</span>
00319 
00320                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00321                 }
00322 
00323                 <span class="comment">//  Re-Build tentitive association list.</span>
00324 
00325                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a>();
00326 
00327                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00328 
00329                 <span class="comment">//  check the install status to refect icon.</span>
00330 
00331                 HICON hIcon = LoadIcon(CGlobals::Instance(),
00332                                    MAKEINTRESOURCE(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>() ? <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a44">DefaultIcon</a> : <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a45">UninstalledIcon</a>));
00333 
00334                 <span class="keywordflow">if</span> (hIcon) {
00335                     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, StatusIcon, STM_SETICON, (WPARAM) hIcon, 0);
00336                 }
00337             }
00338 
00339             <span class="keywordflow">break</span>;
00340         }
00341     }
00342 
00343     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00344 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="CProfileAssociationPage::Profile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d5/classCProfile.html">CProfile</a>* CProfileAssociationPage::Profile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00051">51</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
References <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">m_pcpTarget</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00389">CAddDeviceDialog::OnInit()</a>.
<p>
<pre class="fragment"><div>00051 { <span class="keywordflow">return</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CProfileAssociationPage::UpdateDeviceListBox" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CProfileAssociationPage::UpdateDeviceListBox           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00173">173</a> of file <a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00055">Association()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00058">AssociationCount()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00106">DeviceListControl</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">DisplayName()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00090">GetFocus()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00717">SendDlgItemMessage()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00220">OnCommand()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.
<p>
<pre class="fragment"><div>00173                                                      {
00174 
00175     <span class="comment">//  Add the associations to the list</span>
00176 
00177     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_RESETCONTENT, 0, 0);
00178 
00179     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>(); u++ ) {
00180         LRESULT iItem = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_ADDSTRING,
00181             0, (LPARAM) <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a18">DisplayName</a>(u));
00182         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_SETITEMDATA, iItem,
00183             (LPARAM) <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a14">Association</a>(u));
00184     }
00185 
00186     <span class="comment">//  If there are no associations, disable the Remove Devices button</span>
00187 
00188     HWND hwndRemove = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd,RemoveButton);
00189 
00190     <span class="comment">//  If there are no more devices, or all are associated, disable the Add</span>
00191     <span class="comment">//  Devices button.</span>
00192     <span class="comment">//</span>
00193     <span class="comment">//  !!! To get more performance !!!</span>
00194     <span class="comment">//</span>
00195     <span class="comment">//  EnableWindow(GetDlgItem(m_hwnd, AddButton),</span>
00196     <span class="comment">//     m_pcpTarget-&gt;DeviceCount() &amp;&amp; m_pcpTarget-&gt;DeviceCount() &gt; AssociationCount());</span>
00197     <span class="comment">//</span>
00198     <span class="comment">//  !!! AddButton NEVER DISABLED !!!</span>
00199     <span class="comment">//</span>
00200 
00201     <span class="comment">// If focus is on Remove, move it to Add button.</span>
00202 
00203     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>() == hwndRemove) {
00204 
00205         HWND hwndAdd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, AddButton);
00206 
00207         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(hwndAdd);
00208         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndRemove, BM_SETSTYLE, BS_PUSHBUTTON, MAKELPARAM(TRUE, 0));
00209         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndAdd, BM_SETSTYLE, BS_DEFPUSHBUTTON, MAKELPARAM(TRUE, 0));
00210     }
00211 
00212     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(hwndRemove, !!(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>()));
00213 
00214     <span class="comment">//  If there is any device, set focus to 1st entry.</span>
00215 
00216     <span class="keywordflow">if</span>  (<a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_GETCOUNT, 0, 0))
00217         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, DeviceListControl, LB_SETCURSEL, 0, 0);
00218 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r5" doxytag="CProfileAssociationPage::m_bAssociationChanged" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r5">CProfileAssociationPage::m_bAssociationChanged</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00031">31</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00061">AssociationChanged()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="CProfileAssociationPage::m_csProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r0">CProfileAssociationPage::m_csProfile</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00022">22</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00036">CProfileAssociationPage()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="CProfileAssociationPage::m_cuaAdd" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a> <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r2">CProfileAssociationPage::m_cuaAdd</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00026">26</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r4" doxytag="CProfileAssociationPage::m_cuaAssociate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a> <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r4">CProfileAssociationPage::m_cuaAssociate</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00029">29</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00055">Association()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00058">AssociationCount()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, and <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">DisplayName()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r3" doxytag="CProfileAssociationPage::m_cuaDelete" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a> <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r3">CProfileAssociationPage::m_cuaDelete</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00027">27</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00132">Associate()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00156">Dissociate()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="CProfileAssociationPage::m_pcpTarget" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d5/classCProfile.html">CProfile</a>* <a class="el" href="../../d9/d5/classCProfileAssociationPage.html#r1">CProfileAssociationPage::m_pcpTarget</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00024">24</a> of file <a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">ConstructAssociations()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00036">CProfileAssociationPage()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">DisplayName()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00266">OnDestroy()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">OnInit()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">OnNotify()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00051">Profile()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00049">~CProfileAssociationPage()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d8/d4/profassoc_8h-source.html">profassoc.h</a><li><a class="el" href="../../d7/d4/profassoc_8cpp-source.html">profassoc.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
