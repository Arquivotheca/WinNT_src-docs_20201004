<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: wstrings.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>wstrings.c</h1><a href="../../d8/d0/wstrings_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/****************************** Module Header ******************************\</span>
00002 <span class="comment">* Module Name: wstrings.c</span>
00003 <span class="comment">*</span>
00004 <span class="comment">* Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00005 <span class="comment">*</span>
00006 <span class="comment">* History:</span>
00007 <span class="comment">* 03-20-91 IanJa      Created</span>
00008 <span class="comment">\***************************************************************************/</span>
00009 
00010 <span class="preprocessor">#include "<a class="code" href="../../d7/d3/w32_2ntuser_2client_2precomp_8h.html">precomp.h</a>"</span>
00011 <span class="preprocessor">#pragma hdrstop</span>
00012 <span class="preprocessor"></span>
00013 <span class="comment">/* LATER these should be in a public header file!!!</span>
00014 <span class="comment"> * Assorted defines used to support the standard Windows ANSI code page</span>
00015 <span class="comment"> * (now known as code page 1252 and officially registered by IBM).</span>
00016 <span class="comment"> * This is intended only for the PDK release.  Subsequent releases will</span>
00017 <span class="comment"> * use the NLSAPI and Unicode.</span>
00018 <span class="comment"> */</span>
<a name="l00019"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a0">00019</a> <span class="preprocessor">#define LATIN_CAPITAL_LETTER_A_GRAVE    (WCHAR)0xc0</span>
<a name="l00020"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a1">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define LATIN_CAPITAL_LETTER_THORN      (WCHAR)0xde</span>
<a name="l00021"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a2">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define LATIN_SMALL_LETTER_SHARP_S      (WCHAR)0xdf</span>
<a name="l00022"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a3">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define LATIN_SMALL_LETTER_Y_DIAERESIS  (WCHAR)0xff</span>
<a name="l00023"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a4">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define DIVISION_SIGN                   (WCHAR)0xf7</span>
<a name="l00024"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a5">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define MULTIPLICATION_SIGN             (WCHAR)0xd7</span>
00025 <span class="preprocessor"></span>
00026 
00027 <span class="comment">/*</span>
00028 <span class="comment"> * Temporary defines to support Unicode block 1 (0x0000 - 0x00ff).</span>
00029 <span class="comment"> */</span>
<a name="l00030"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a6">00030</a> <span class="preprocessor">#define WCTOA(wch)  ((wch) &amp; 0xff)</span>
<a name="l00031"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a7">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define IS_UNICODE_BLK1(wch)  ((int)(wch) &lt;= 0x00ff)</span>
00032 <span class="preprocessor"></span>
00033 
00034 <span class="comment">/***************************************************************************\</span>
00035 <span class="comment">* CharLowerW (API)</span>
00036 <span class="comment">*</span>
00037 <span class="comment">* Convert either a single character or an entire string to lower case.  The</span>
00038 <span class="comment">* two cases are differentiated by checking the high-word of pwsz.  If it is</span>
00039 <span class="comment">* 0 then we just convert the low-word of pwsz.</span>
00040 <span class="comment">*</span>
00041 <span class="comment">* History:</span>
00042 <span class="comment">* 06-24-91 GregoryW     Created.  Supports Unicode equivalent of code</span>
00043 <span class="comment">*                       page 1252 (simple zero extension).  This is for</span>
00044 <span class="comment">*                       the PDK release only.  After the PDK this routine</span>
00045 <span class="comment">*                       will be modified to use the NLSAPI.</span>
00046 <span class="comment">* 02-11-93 IanJa        Modified to use NLS API.</span>
00047 <span class="comment">\***************************************************************************/</span>
00048 
<a name="l00049"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a8">00049</a> LPWSTR WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a8">CharLowerW</a>(
00050     LPWSTR pwsz)
00051 {
00052     <span class="comment">/*</span>
00053 <span class="comment">     * Early out for NULL string or '\0'</span>
00054 <span class="comment">     */</span>
00055     <span class="keywordflow">if</span> (pwsz == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00056         <span class="keywordflow">return</span> pwsz;
00057     }
00058 
00059     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pwsz)) {
00060         <span class="keywordflow">if</span> (!LCMapStringW(
00061                  LOCALE_USER_DEFAULT,
00062                  LCMAP_LOWERCASE,
00063                  (LPWSTR)&amp;pwsz,
00064                  1,
00065                  (LPWSTR)&amp;pwsz,
00066                  1
00067                  )) {
00068             <span class="comment">/*</span>
00069 <span class="comment">             * We don't expect LCMapString to fail!  The caller is not expecting</span>
00070 <span class="comment">             * failure, CharLowerW does not have a failure indicator, so we do</span>
00071 <span class="comment">             * nothing.</span>
00072 <span class="comment">             */</span>
00073             RIPMSG1(RIP_WARNING, <span class="stringliteral">"CharLowerW(%#p): LCMapString failed\n"</span>, pwsz);
00074         }
00075 
00076         <span class="keywordflow">return</span> pwsz;
00077     }
00078 
00079     <span class="comment">/*</span>
00080 <span class="comment">     * pwsz is a null-terminated string</span>
00081 <span class="comment">     */</span>
00082     <a class="code" href="../../d8/d0/wstrings_8c.html#a12">CharLowerBuffW</a>(pwsz, wcslen(pwsz)+1);
00083     <span class="keywordflow">return</span> pwsz;
00084 }
00085 
00086 
00087 <span class="comment">/***************************************************************************\</span>
00088 <span class="comment">* CharUpperW (API)</span>
00089 <span class="comment">*</span>
00090 <span class="comment">* Convert either a single character or an entire string to upper case.  The</span>
00091 <span class="comment">* two cases are differentiated by checking the high-word of pwsz.  If it is</span>
00092 <span class="comment">* 0 then we just convert the low-word of pwsz.</span>
00093 <span class="comment">*</span>
00094 <span class="comment">* History:</span>
00095 <span class="comment">* 06-24-91 GregoryW     Created.  Supports Unicode equivalent of code</span>
00096 <span class="comment">*                       page 1252 (simple zero extension).  This is for</span>
00097 <span class="comment">*                       the PDK release only.  After the PDK this routine</span>
00098 <span class="comment">*                       will be modified to use the NLSAPI.</span>
00099 <span class="comment">* 02-11-93 IanJa        Modified to use NLS API.</span>
00100 <span class="comment">\***************************************************************************/</span>
00101 
<a name="l00102"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a9">00102</a> LPWSTR WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a9">CharUpperW</a>(
00103     LPWSTR pwsz)
00104 {
00105     <span class="comment">/*</span>
00106 <span class="comment">     * Early out for NULL string or '\0'</span>
00107 <span class="comment">     */</span>
00108     <span class="keywordflow">if</span> (pwsz == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00109         <span class="keywordflow">return</span> pwsz;
00110     }
00111 
00112     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pwsz)) {
00113         <span class="keywordflow">if</span> (!LCMapStringW(
00114                  LOCALE_USER_DEFAULT,
00115                  LCMAP_UPPERCASE,
00116                  (LPWSTR)&amp;pwsz,
00117                  1,
00118                  (LPWSTR)&amp;pwsz,
00119                  1
00120                  )) {
00121             <span class="comment">/*</span>
00122 <span class="comment">             * We don't expect LCMapString to fail!  The caller is not expecting</span>
00123 <span class="comment">             * failure, CharLowerW does not have a failure indicator, so we do</span>
00124 <span class="comment">             * nothing.</span>
00125 <span class="comment">             */</span>
00126             RIPMSG1(RIP_WARNING, <span class="stringliteral">"CharUpperW(%#p): LCMapString failed"</span>, pwsz);
00127         }
00128 
00129         <span class="keywordflow">return</span> pwsz;
00130     }
00131 
00132     <span class="comment">/*</span>
00133 <span class="comment">     * pwsz is a null-terminated string</span>
00134 <span class="comment">     */</span>
00135     <a class="code" href="../../d8/d0/wstrings_8c.html#a13">CharUpperBuffW</a>(pwsz, wcslen(pwsz)+1);
00136     <span class="keywordflow">return</span> pwsz;
00137 }
00138 
00139 
00140 <span class="comment">/***************************************************************************\</span>
00141 <span class="comment">* CharNextW (API)</span>
00142 <span class="comment">*</span>
00143 <span class="comment">* Move to next character in string unless already at '\0' terminator</span>
00144 <span class="comment">*</span>
00145 <span class="comment">* History:</span>
00146 <span class="comment">* 06-24-91 GregoryW     Created.  This routine will not work for non-spacing</span>
00147 <span class="comment">*                       characters!!  This version is only intended for</span>
00148 <span class="comment">*                       limited use in the PDK release.</span>
00149 <span class="comment">* 02-20-92 GregoryW     Modified to work with combining marks (formerly known</span>
00150 <span class="comment">*                       as non-spacing).</span>
00151 <span class="comment">* 09-21-93 JulieB       Added ALPHA to combining mark code.</span>
00152 <span class="comment">\***************************************************************************/</span>
00153 
<a name="l00154"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a10">00154</a> LPWSTR WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a10">CharNextW</a>(
00155     LPCWSTR lpwCurrentChar)
00156 {
00157     WORD ctype3info;
00158 
00159     <span class="keywordflow">if</span> (*lpwCurrentChar) {
00160         <span class="comment">//</span>
00161         <span class="comment">// Examine each code element.  Skip all combining elements.</span>
00162         <span class="comment">//</span>
00163         <span class="keywordflow">while</span> (*(++lpwCurrentChar)) {
00164             <span class="keywordflow">if</span> (!GetStringTypeW(
00165                     CT_CTYPE3,
00166                     lpwCurrentChar,
00167                     1,
00168                     &amp;ctype3info)) {
00169                 <span class="comment">/*</span>
00170 <span class="comment">                 * GetStringTypeW failed!  The caller is not expecting failure,</span>
00171 <span class="comment">                 * CharNextW does not have a failure indicator, so just return</span>
00172 <span class="comment">                 * a pointer to the character we couldn't analyze.</span>
00173 <span class="comment">                 */</span>
00174                 RIPMSG2(RIP_WARNING, <span class="stringliteral">"CharNextW failed, L'\\x%.4x' at %#p"</span>,
00175                         *lpwCurrentChar, lpwCurrentChar);
00176                 <span class="keywordflow">break</span>;
00177             }
00178             <span class="keywordflow">if</span> (!((ctype3info &amp; C3_NONSPACING) &amp;&amp; (!(ctype3info &amp; C3_ALPHA)))) {
00179                 <span class="keywordflow">break</span>;
00180             }
00181         }
00182     }
00183 
00184     <span class="keywordflow">return</span> (LPWSTR)lpwCurrentChar;
00185 }
00186 
00187 
00188 <span class="comment">/***************************************************************************\</span>
00189 <span class="comment">* CharPrevW (API)</span>
00190 <span class="comment">*</span>
00191 <span class="comment">* Move to previous character in string, unless already at start</span>
00192 <span class="comment">*</span>
00193 <span class="comment">* History:</span>
00194 <span class="comment">* 06-24-91 GregoryW     Created.  This routine will not work for non-spacing</span>
00195 <span class="comment">*                       characters!!  This version is only intended for</span>
00196 <span class="comment">*                       limited use in the PDK release.</span>
00197 <span class="comment">* 02-20-92 GregoryW     Modified to work with combining marks (formerly</span>
00198 <span class="comment">*                       known as non-spacing).</span>
00199 <span class="comment">* 09-21-93 JulieB       Added ALPHA to combining mark code.</span>
00200 <span class="comment">* 12-06-93 JulieB       Fixed combining mark code.</span>
00201 <span class="comment">\***************************************************************************/</span>
00202 
<a name="l00203"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a11">00203</a> LPWSTR WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a11">CharPrevW</a>(
00204     LPCWSTR lpwStart,
00205     LPCWSTR lpwCurrentChar)
00206 {
00207     WORD ctype3info;
00208     LPWSTR lpwValidChar = (LPWSTR)lpwCurrentChar;
00209 
00210 
00211     <span class="keywordflow">if</span> (lpwCurrentChar &gt; lpwStart) {
00212         <span class="comment">//</span>
00213         <span class="comment">// Examine each code element.  Skip all combining elements.</span>
00214         <span class="comment">//</span>
00215         <span class="keywordflow">while</span> (lpwCurrentChar-- &gt; lpwStart) {
00216             <span class="keywordflow">if</span> (!GetStringTypeW(
00217                     CT_CTYPE3,
00218                     lpwCurrentChar,
00219                     1,
00220                     &amp;ctype3info)) {
00221                 <span class="comment">/*</span>
00222 <span class="comment">                 * GetStringTypeW failed!  The caller is not expecting failure,</span>
00223 <span class="comment">                 * CharPrevW does not have a failure indicator, so just return</span>
00224 <span class="comment">                 * a pointer to the character we couldn't analyze.</span>
00225 <span class="comment">                 */</span>
00226                 RIPMSG2(RIP_WARNING, <span class="stringliteral">"CharPrevW failed, L'\\x%.4x' at %#p"</span>,
00227                         *lpwCurrentChar, lpwCurrentChar);
00228                 <span class="keywordflow">break</span>;
00229             }
00230             <span class="keywordflow">if</span> (!((ctype3info &amp; C3_NONSPACING) &amp;&amp; (!(ctype3info &amp; C3_ALPHA)))) {
00231                 lpwValidChar = (LPWSTR)lpwCurrentChar;
00232                 <span class="keywordflow">break</span>;  <span class="comment">// found non-combining code element</span>
00233             }
00234         }
00235     }
00236 
00237     <span class="keywordflow">return</span> (LPWSTR)lpwValidChar;
00238 }
00239 
00240 
00241 <span class="comment">/***************************************************************************\</span>
00242 <span class="comment">* CharLowerBuffW (API)</span>
00243 <span class="comment">*</span>
00244 <span class="comment">* History:</span>
00245 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00246 <span class="comment">*                       block 1 (0x0000 - 0x00ff).  All other code points</span>
00247 <span class="comment">*                       are copied verbatim.  This version is intended</span>
00248 <span class="comment">*                       only for the PDK release.</span>
00249 <span class="comment">* 02-11-93 IanJa        Modified to use NLS API.</span>
00250 <span class="comment">\***************************************************************************/</span>
00251 
<a name="l00252"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a12">00252</a> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a12">CharLowerBuffW</a>(
00253     LPWSTR pwsz,
00254     DWORD cwch)
00255 {
00256     <span class="keywordtype">int</span> cwchT;
00257     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> i;
00258 
00259     <span class="keywordflow">if</span> (cwch == 0) {
00260         <span class="keywordflow">return</span> 0;
00261     }
00262 
00263     cwchT = LCMapStringW(LOCALE_USER_DEFAULT, LCMAP_LOWERCASE,
00264                 pwsz, cwch, pwsz, cwch);
00265 
00266     <span class="keywordflow">if</span> (cwchT != 0) {
00267         <span class="keywordflow">return</span> cwchT;
00268     }
00269 
00270     <span class="comment">/*</span>
00271 <span class="comment">     * LCMapString failed!  The caller is not expecting failure,</span>
00272 <span class="comment">     * CharLowerBuffW does not have a failure indicator, so we</span>
00273 <span class="comment">     * convert the buffer to lower case as best we can.</span>
00274 <span class="comment">     */</span>
00275     RIPMSG1(RIP_WARNING, <span class="stringliteral">"CharLowerBuffW(%ls) failed"</span>, pwsz);
00276 
00277     <span class="keywordflow">for</span> (i=0; i &lt; cwch; i++) {
00278         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/wstrings_8c.html#a7">IS_UNICODE_BLK1</a>(pwsz[i]) &amp;&amp; <a class="code" href="../../d5/d7/strings_8c.html#a16">IsCharUpperA</a>((<span class="keywordtype">char</span>)pwsz[i])) {
00279             pwsz[i] += <span class="charliteral">'a'</span>-<span class="charliteral">'A'</span>;
00280         }
00281     }
00282 
00283     <span class="keywordflow">return</span> cwch;
00284 }
00285 
00286 
00287 <span class="comment">/***************************************************************************\</span>
00288 <span class="comment">* CharUpperBuffW (API)</span>
00289 <span class="comment">*</span>
00290 <span class="comment">* History:</span>
00291 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00292 <span class="comment">*                       block 1 (0x0000 - 0x00ff).  All other code points</span>
00293 <span class="comment">*                       are copied verbatim.  This version is intended</span>
00294 <span class="comment">*                       only for the PDK release.</span>
00295 <span class="comment">* 02-11-93 IanJa        Modified to use NLS API.</span>
00296 <span class="comment">\***************************************************************************/</span>
00297 
<a name="l00298"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a13">00298</a> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a13">CharUpperBuffW</a>(
00299     LPWSTR pwsz,
00300     DWORD cwch)
00301 {
00302     <span class="keywordtype">int</span> cwchT;
00303     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> i;
00304 
00305     <span class="keywordflow">if</span> (cwch == 0) {
00306         <span class="keywordflow">return</span> 0;
00307     }
00308 
00309     cwchT = LCMapStringW(LOCALE_USER_DEFAULT, LCMAP_UPPERCASE,
00310                 pwsz, cwch, pwsz, cwch);
00311 
00312     <span class="keywordflow">if</span> (cwchT != 0) {
00313         <span class="keywordflow">return</span> cwchT;
00314     }
00315 
00316     <span class="comment">/*</span>
00317 <span class="comment">     * LCMapString failed!  The caller is not expecting failure,</span>
00318 <span class="comment">     * CharUpperBuffW does not have a failure indicator, so we</span>
00319 <span class="comment">     * convert the buffer to upper case as best we can.</span>
00320 <span class="comment">     */</span>
00321     RIPMSG1(RIP_WARNING, <span class="stringliteral">"CharUpperBuffW(%ls) failed"</span>, pwsz);
00322 
00323     <span class="keywordflow">for</span> (i=0; i &lt; cwch; i++) {
00324         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/wstrings_8c.html#a7">IS_UNICODE_BLK1</a>(pwsz[i]) &amp;&amp;
00325                 <a class="code" href="../../d5/d7/strings_8c.html#a15">IsCharLowerA</a>((<span class="keywordtype">char</span>)pwsz[i]) &amp;&amp;
00326                 (pwsz[i] != <a class="code" href="../../d5/d7/strings_8c.html#a2">LATIN_SMALL_LETTER_SHARP_S</a>) &amp;&amp;
00327                 (pwsz[i] != <a class="code" href="../../d5/d7/strings_8c.html#a3">LATIN_SMALL_LETTER_Y_DIAERESIS</a>)) {
00328             pwsz[i] += (WCHAR)(<span class="charliteral">'A'</span>-<span class="charliteral">'a'</span>);
00329         }
00330     }
00331 
00332     <span class="keywordflow">return</span> cwch;
00333 }
00334 
00335 
00336 
00337 <span class="comment">/***************************************************************************\</span>
00338 <span class="comment">* IsCharLowerW (API)</span>
00339 <span class="comment">*</span>
00340 <span class="comment">* History:</span>
00341 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00342 <span class="comment">*                       block 1 (0x0000 - 0x00ff).  FALSE is returned</span>
00343 <span class="comment">*                       for all other code points. This version is intended</span>
00344 <span class="comment">*                       only for the PDK release.</span>
00345 <span class="comment">* 02-20-92 GregoryW     Modified to use NLS API.</span>
00346 <span class="comment">\***************************************************************************/</span>
00347 
<a name="l00348"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a14">00348</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a14">IsCharLowerW</a>(
00349     WCHAR wChar)
00350 {
00351     WORD ctype1info;
00352 
00353     <span class="keywordflow">if</span> (GetStringTypeW(CT_CTYPE1, &amp;wChar, 1, &amp;ctype1info)) {
00354         <span class="keywordflow">if</span> (ctype1info &amp; C1_LOWER) {
00355             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00356         } <span class="keywordflow">else</span> {
00357             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00358         }
00359     }
00360 
00361     <span class="comment">/*</span>
00362 <span class="comment">     * GetStringTypeW failed!  The caller is not expecting</span>
00363 <span class="comment">     * failure, IsCharLowerW does not have a failure indicator, so we</span>
00364 <span class="comment">     * determine the case as best we can.</span>
00365 <span class="comment">     */</span>
00366     RIPMSG1(RIP_WARNING, <span class="stringliteral">"IsCharLowerW(L'\\x%.4lx') failed"</span>, wChar);
00367 
00368     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/wstrings_8c.html#a7">IS_UNICODE_BLK1</a>(wChar)) {
00369         <span class="keywordflow">return</span> <a class="code" href="../../d5/d7/strings_8c.html#a15">IsCharLowerA</a>((<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>)wChar);
00370     } <span class="keywordflow">else</span> {
00371         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00372     }
00373 }
00374 
00375 
00376 <span class="comment">/***************************************************************************\</span>
00377 <span class="comment">* IsCharUpperW (API)</span>
00378 <span class="comment">*</span>
00379 <span class="comment">* History:</span>
00380 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00381 <span class="comment">*                       block 1 (0x0000 - 0x00ff).  FALSE is returned</span>
00382 <span class="comment">*                       for all other code points. This version is intended</span>
00383 <span class="comment">*                       only for the PDK release.</span>
00384 <span class="comment">* 02-20-92 GregoryW     Modified to use NLS API.</span>
00385 <span class="comment">\***************************************************************************/</span>
00386 
<a name="l00387"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a15">00387</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a15">IsCharUpperW</a>(
00388     WCHAR wChar)
00389 {
00390     WORD ctype1info;
00391 
00392     <span class="keywordflow">if</span> (GetStringTypeW(CT_CTYPE1, &amp;wChar, 1, &amp;ctype1info)) {
00393         <span class="keywordflow">if</span> (ctype1info &amp; C1_UPPER) {
00394             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00395         } <span class="keywordflow">else</span> {
00396             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00397         }
00398     }
00399 
00400     <span class="comment">/*</span>
00401 <span class="comment">     * GetStringTypeW failed!  The caller is not expecting</span>
00402 <span class="comment">     * failure, IsCharLowerW does not have a failure indicator, so we</span>
00403 <span class="comment">     * determine the case as best we can.</span>
00404 <span class="comment">     */</span>
00405     RIPMSG1(RIP_WARNING, <span class="stringliteral">"IsCharUpper(L'\\x%.4lx') failed"</span>, wChar);
00406 
00407     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/wstrings_8c.html#a7">IS_UNICODE_BLK1</a>(wChar)) {
00408         <span class="keywordflow">return</span> <a class="code" href="../../d5/d7/strings_8c.html#a16">IsCharUpperA</a>((<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>)wChar);
00409     } <span class="keywordflow">else</span> {
00410         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00411     }
00412 }
00413 
00414 
00415 <span class="comment">/***************************************************************************\</span>
00416 <span class="comment">* IsCharAlphaNumericW (API)</span>
00417 <span class="comment">*</span>
00418 <span class="comment">* Returns TRUE if character is alphabetical or numerical, otherwise FALSE</span>
00419 <span class="comment">*</span>
00420 <span class="comment">* History:</span>
00421 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00422 <span class="comment">*                       block 1 (0x0000 - 0x00ff).</span>
00423 <span class="comment">*                       This version is intended only for the PDK release.</span>
00424 <span class="comment">* 02-20-92 GregoryW     Modified to use NLS API.</span>
00425 <span class="comment">\***************************************************************************/</span>
00426 
<a name="l00427"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a16">00427</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a16">IsCharAlphaNumericW</a>(
00428     WCHAR wChar)
00429 {
00430     WORD ctype1info;
00431 
00432     <span class="keywordflow">if</span> (!GetStringTypeW(CT_CTYPE1, &amp;wChar, 1, &amp;ctype1info)) {
00433         <span class="comment">//</span>
00434         <span class="comment">// GetStringTypeW returned an error!  IsCharAlphaNumericW has no</span>
00435         <span class="comment">// provision for returning an error...  The best we can do is to</span>
00436         <span class="comment">// return FALSE</span>
00437         <span class="comment">//</span>
00438         UserAssert(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00439         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00440     }
00441     <span class="comment">//</span>
00442     <span class="comment">// LATER 20 Feb 92 GregoryW</span>
00443     <span class="comment">//    We may need to check ctype 3 info if we want to check for</span>
00444     <span class="comment">//    digits other than ASCII '0'-'9' (such as Lao digits or</span>
00445     <span class="comment">//    Tibetan digits, etc.).</span>
00446     <span class="comment">//</span>
00447 <span class="preprocessor">#ifdef FE_SB // IsCharAlphaNumericW()</span>
00448 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (ctype1info &amp; C1_ALPHA) {
00449         WORD ctype3info = 0;
00450         <span class="comment">/*</span>
00451 <span class="comment">         * We don't want to return TRUE for halfwidth katakana.</span>
00452 <span class="comment">         * Katakana is linguistic character (C1_ALPHA), but it is not</span>
00453 <span class="comment">         * alphabet character.</span>
00454 <span class="comment">         */</span>
00455         <span class="keywordflow">if</span> (!GetStringTypeW(CT_CTYPE3, &amp;wChar, 1, &amp;ctype3info)) {
00456             UserAssert(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00457             <span class="comment">/*</span>
00458 <span class="comment">             * Assume, it is alphabet character, because it has</span>
00459 <span class="comment">             * C1_ALPHA attribute.</span>
00460 <span class="comment">             */</span>
00461             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00462         }
00463 
00464         <span class="keywordflow">if</span> (ctype3info &amp; (C3_KATAKANA|C3_HIRAGANA)) {
00465             <span class="comment">/*</span>
00466 <span class="comment">             * This is 'Katakana'.</span>
00467 <span class="comment">             */</span>
00468             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00469         } <span class="keywordflow">else</span> {
00470             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00471         }
00472     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype1info &amp; C1_DIGIT) {
00473         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00474     } <span class="keywordflow">else</span> {
00475         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00476     }
00477 <span class="preprocessor">#else</span>
00478 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ((ctype1info &amp; C1_ALPHA) || (ctype1info &amp; C1_DIGIT)) {
00479         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00480     } <span class="keywordflow">else</span> {
00481         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00482     }
00483 <span class="preprocessor">#endif // FE_SB</span>
00484 <span class="preprocessor"></span>}
00485 
00486 
00487 <span class="comment">/***************************************************************************\</span>
00488 <span class="comment">* IsCharAlphaW (API)</span>
00489 <span class="comment">*</span>
00490 <span class="comment">* Returns TRUE if character is alphabetical, otherwise FALSE</span>
00491 <span class="comment">*</span>
00492 <span class="comment">* History:</span>
00493 <span class="comment">* 06-24-91 GregoryW     Created.  This version only supports Unicode</span>
00494 <span class="comment">*                       block 1 (0x0000 - 0x00ff).</span>
00495 <span class="comment">*                       This version is intended only for the PDK release.</span>
00496 <span class="comment">* 02-20-92 GregoryW     Modified to use NLS API.</span>
00497 <span class="comment">\***************************************************************************/</span>
00498 
<a name="l00499"></a><a class="code" href="../../d8/d0/wstrings_8c.html#a17">00499</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d8/d0/wstrings_8c.html#a17">IsCharAlphaW</a>(
00500     WCHAR wChar)
00501 {
00502     WORD ctype1info;
00503 
00504     <span class="keywordflow">if</span> (!GetStringTypeW(CT_CTYPE1, &amp;wChar, 1, &amp;ctype1info)) {
00505         <span class="comment">//</span>
00506         <span class="comment">// GetStringTypeW returned an error!  IsCharAlphaW has no</span>
00507         <span class="comment">// provision for returning an error...  The best we can do</span>
00508         <span class="comment">// is to return FALSE</span>
00509         <span class="comment">//</span>
00510         UserAssert(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00511         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00512     }
00513     <span class="keywordflow">if</span> (ctype1info &amp; C1_ALPHA) {
00514 <span class="preprocessor">#ifdef FE_SB // IsCharAlphaA()</span>
00515 <span class="preprocessor"></span>        WORD ctype3info = 0;
00516         <span class="comment">/*</span>
00517 <span class="comment">         * We don't want to return TRUE for halfwidth katakana.</span>
00518 <span class="comment">         * Katakana is linguistic character (C1_ALPHA), but it is not</span>
00519 <span class="comment">         * alphabet character.</span>
00520 <span class="comment">         */</span>
00521         <span class="keywordflow">if</span> (!GetStringTypeW(CT_CTYPE3, &amp;wChar, 1, &amp;ctype3info)) {
00522             UserAssert(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00523             <span class="comment">/*</span>
00524 <span class="comment">             * Assume, it is alphabet character, because it has</span>
00525 <span class="comment">             * C1_ALPHA attribute.</span>
00526 <span class="comment">             */</span>
00527             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00528         }
00529 
00530         <span class="keywordflow">if</span> (ctype3info &amp; (C3_KATAKANA|C3_HIRAGANA)) {
00531             <span class="comment">/*</span>
00532 <span class="comment">             * This is 'Katakana'.</span>
00533 <span class="comment">             */</span>
00534             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00535         } <span class="keywordflow">else</span> {
00536             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00537         }
00538 <span class="preprocessor">#else</span>
00539 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00540 <span class="preprocessor">#endif // FE_SB</span>
00541 <span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
00542         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00543     }
00544 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:29 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
