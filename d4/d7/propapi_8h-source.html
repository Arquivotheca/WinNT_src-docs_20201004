<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: propapi.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>propapi.h</h1><a href="../../d3/d8/propapi_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//+-------------------------------------------------------------------------</span>
00002 <span class="comment">//</span>
00003 <span class="comment">//  Microsoft Windows</span>
00004 <span class="comment">//  Copyright (C) Microsoft Corporation, 1992-1998.</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  File:       propapi.h</span>
00007 <span class="comment">//</span>
00008 <span class="comment">//  Contents:   Stuff needed to make properties build for Nashville and</span>
00009 <span class="comment">//              NT... definitions of Nt property api.</span>
00010 <span class="comment">//</span>
00011 <span class="comment">//</span>
00012 <span class="comment">//  History:    07-Aug-95   BillMo      Created.</span>
00013 <span class="comment">//              22-Feb-96   MikeHill    Fixed the non-WINNT version of</span>
00014 <span class="comment">//                                      PROPASSERTMSG.</span>
00015 <span class="comment">//              09-May-96   MikeHill    Update define to allow PropSet names</span>
00016 <span class="comment">//                                      to be 255 characters (from 127).</span>
00017 <span class="comment">//              31-May-96   MikeHill    Add OSVersion to RtlCreatePropSet.</span>
00018 <span class="comment">//              18-Jun-96   MikeHill    Add OleAut32 wrappers to Unicode callouts.</span>
00019 <span class="comment">//              15-Jul-96   MikeHill    - Remvd Win32 SEH exception-related code.</span>
00020 <span class="comment">//                                      - WCHAR=&gt;OLECHAR where applicable.</span>
00021 <span class="comment">//                                      - Added RtlOnMappedStreamEvent</span>
00022 <span class="comment">//                                      - Added Mac versions of PROPASSERT</span>
00023 <span class="comment">//</span>
00024 <span class="comment">//--------------------------------------------------------------------------</span>
00025 
00026 
00027 <span class="preprocessor">#ifndef _PROPAPI_H_</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#define _PROPAPI_H_</span>
00029 <span class="preprocessor"></span>
00030 <span class="preprocessor">#ifdef __cplusplus</span>
00031 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00032 <span class="preprocessor">#endif</span>
00033 <span class="preprocessor"></span>
00034 <span class="comment">//</span>
00035 <span class="comment">// typedef the function prototypes necessary</span>
00036 <span class="comment">// for the UNICODECALLOUTS structure.</span>
00037 <span class="comment">//</span>
00038 
00039 <span class="keyword">typedef</span> <a class="code" href="../../d3/d8/propapi_8h.html#a48">UINT</a> (WINAPI FNGETACP)(<a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>);
00040 
00041 <span class="keyword">typedef</span> <a class="code" href="../../d3/d8/propapi_8h.html#a49">int</a> (WINAPI FNMULTIBYTETOWIDECHAR)(
00042     IN <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> CodePage,
<a name="l00043"></a><a class="code" href="../../d3/d8/propapi_8h.html#a37">00043</a>     IN <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>,
00044     IN LPCSTR <a class="code" href="../../d3/d8/propapi_8h.html#a35">lpMultiByteStr</a>,
00045     IN <span class="keywordtype">int</span> <a class="code" href="../../d3/d8/propapi_8h.html#a36">cchMultiByte</a>,
00046     OUT LPWSTR <a class="code" href="../../d3/d8/propapi_8h.html#a37">lpWideCharStr</a>,
00047     IN <span class="keywordtype">int</span> <a class="code" href="../../d3/d8/propapi_8h.html#a38">cchWideChar</a>);
00048 
00049 <span class="keyword">typedef</span> <a class="code" href="../../d3/d8/propapi_8h.html#a49">int</a> (WINAPI FNWIDECHARTOMULTIBYTE)(
00050     IN <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> CodePage,
<a name="l00051"></a><a class="code" href="../../d3/d8/propapi_8h.html#a40">00051</a>     IN <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>,
00052     IN LPCWSTR <a class="code" href="../../d3/d8/propapi_8h.html#a37">lpWideCharStr</a>,
00053     IN <span class="keywordtype">int</span> <a class="code" href="../../d3/d8/propapi_8h.html#a38">cchWideChar</a>,
00054     OUT LPSTR <a class="code" href="../../d3/d8/propapi_8h.html#a35">lpMultiByteStr</a>,
00055     IN <span class="keywordtype">int</span> <a class="code" href="../../d3/d8/propapi_8h.html#a36">cchMultiByte</a>,
00056     IN LPCSTR <a class="code" href="../../d3/d8/propapi_8h.html#a39">lpDefaultChar</a>,
00057     IN LPBOOL <a class="code" href="../../d3/d8/propapi_8h.html#a40">lpUsedDefaultChar</a>);
00058 
<a name="l00059"></a><a class="code" href="../../d3/d8/propapi_8h.html#a41">00059</a> <span class="keyword">typedef</span> BSTR <a class="code" href="../../d3/d8/propapi_8h.html#a41">FNSYSALLOCSTRING</a>(
00060     OLECHAR FAR* pwsz);
00061 
<a name="l00062"></a><a class="code" href="../../d3/d8/propapi_8h.html#a42">00062</a> <span class="keyword">typedef</span> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> <a class="code" href="../../d3/d8/propapi_8h.html#a42">FNSYSFREESTRING</a>(
00063     BSTR pwsz);
00064 
00065 <span class="comment">//</span>
00066 <span class="comment">// The UNICODECALLOUTS structure holds function</span>
00067 <span class="comment">// pointers for routines needed by the property</span>
00068 <span class="comment">// set routines in NTDLL.</span>
00069 <span class="comment">//</span>
00070 
<a name="l00071"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html">00071</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html">_UNICODECALLOUTS</a>
00072 {
<a name="l00073"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o0">00073</a>     FNGETACP              *<a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o0">pfnGetACP</a>;
<a name="l00074"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o1">00074</a>     FNMULTIBYTETOWIDECHAR *<a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o1">pfnMultiByteToWideChar</a>;
<a name="l00075"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o2">00075</a>     FNWIDECHARTOMULTIBYTE *<a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o2">pfnWideCharToMultiByte</a>;
<a name="l00076"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o3">00076</a>     <a class="code" href="../../d3/d8/propapi_8h.html#a41">FNSYSALLOCSTRING</a>      *<a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o3">pfnSysAllocString</a>;
<a name="l00077"></a><a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o4">00077</a>     <a class="code" href="../../d3/d8/propapi_8h.html#a42">FNSYSFREESTRING</a>       *<a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html#o4">pfnSysFreeString</a>;
00078 } <a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html">UNICODECALLOUTS</a>;
00079 
00080 
00081 <span class="comment">//</span>
00082 <span class="comment">// Define the default UNICODECALLOUTS</span>
00083 <span class="comment">// values.</span>
00084 <span class="comment">//</span>
00085 
00086 STDAPI_(BSTR)
00087 PropSysAllocString(OLECHAR FAR* pwsz);
00088 
00089 STDAPI_(VOID)
00090 PropSysFreeString(BSTR bstr);
00091 
<a name="l00092"></a><a class="code" href="../../d3/d8/propapi_8h.html#a0">00092</a> #define WIN32_UNICODECALLOUTS \
00093     GetACP,                   \
00094     MultiByteToWideChar,      \
00095     WideCharToMultiByte,      \
00096     PropSysAllocString,       \
00097     PropSysFreeString
00098 
00099 
00100 <span class="comment">// Is this pure NT (the IProp DLL needs to run on Win95)?</span>
00101 #if defined(WINNT) &amp;&amp; !defined(IPROPERTY_DLL)
00102 
00103     <span class="comment">// Set the function modifiers</span>
00104 #   define PROPSYSAPI NTSYSAPI
00105 #   define PROPAPI NTAPI
00106 
00107     <span class="comment">// How do we free mem allocated in the low-level propset routines?</span>
00108 #   define PropFreeHeap(h, z, p) RtlFreeHeap(h, z, p)
00109 
00110     <span class="comment">// Assert implementations</span>
00111 #   define PROPASSERT ASSERT
00112 #   define PROPASSERTMSG ASSERTMSG
00113 
00114     <span class="comment">// Generate the default non-simple property stream/storage name</span>
00115 #   define PROPGENPROPERTYNAME(s,n) swprintf ((s), L"prop%lu", (n))
00116 
00117     <span class="comment">// Ansi sprintf implementations</span>
00118 #   define PropSprintfA sprintf
00119 #   define PropVsprintfA vsprintf
00120 
00121 <span class="comment">// Otherwise this is either the IProp DLL (NT, Win95, Mac),</span>
00122 <span class="comment">// or it's the Win95 OLE32build.</span>
00123 
00124 #else <span class="comment">// #if defined(WINNT) &amp;&amp; !defined(IPROPERTY_DLL)</span>
00125 
00126     <span class="comment">// Set the function modifiers</span>
<a name="l00127"></a><a class="code" href="../../d3/d8/propapi_8h.html#a1">00127</a> #   define PROPSYSAPI
<a name="l00128"></a><a class="code" href="../../d3/d8/propapi_8h.html#a2">00128</a> #   define PROPAPI
00129 
00130     <span class="comment">// How do we free mem allocated in low-level propset routines?</span>
<a name="l00131"></a><a class="code" href="../../d3/d8/propapi_8h.html#a3">00131</a> #   define PropFreeHeap(h, z, p) CoTaskMemFree(p)
00132 
00133     <span class="comment">// Assert implementations</span>
00134 #   if DBG==1
00135 #       ifdef _MAC_NODOC
00136 #           define PROPASSERT(f)                { <span class="keywordflow">if</span> (!(f)) FnAssert(#f, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, __FILE__, __LINE__); }
00137 <span class="preprocessor">#           define PROPASSERTMSG(szReason, f)   { if (!(f)) FnAssert(#f, szReason, __FILE__, __LINE__); }</span>
00138 <span class="preprocessor"></span><span class="preprocessor">#       else</span>
00139 <span class="preprocessor"></span><span class="preprocessor">#           define PROPASSERT(f) Win4Assert((f))</span>
00140 <span class="preprocessor"></span><span class="preprocessor">#           define PROPASSERTMSG(szReason, f) Win4Assert( (szReason &amp;&amp; FALSE) || (f))</span>
00141 <span class="preprocessor"></span><span class="preprocessor">#       endif</span>
00142 <span class="preprocessor"></span><span class="preprocessor">#   else</span>
<a name="l00143"></a><a class="code" href="../../d3/d8/propapi_8h.html#a4">00143</a> <span class="preprocessor"></span><span class="preprocessor">#       define PROPASSERT(f)</span>
<a name="l00144"></a><a class="code" href="../../d3/d8/propapi_8h.html#a5">00144</a> <span class="preprocessor"></span><span class="preprocessor">#       define PROPASSERTMSG(szReason, f)</span>
00145 <span class="preprocessor"></span><span class="preprocessor">#   endif // #if DBG==1</span>
00146 <span class="preprocessor"></span>
00147     <span class="comment">// Generate the default non-simple property stream/storage name</span>
<a name="l00148"></a><a class="code" href="../../d3/d8/propapi_8h.html#a6">00148</a> <span class="preprocessor">#   define PROPGENPROPERTYNAME(s,n) \</span>
00149 <span class="preprocessor">    { \</span>
00150 <span class="preprocessor">        memcpy ((s), OLESTR("prop"), sizeof (OLESTR("prop"))); \</span>
00151 <span class="preprocessor">        ULTOO  ((n), &amp;(s)[sizeof("prop") - 1], 10); \</span>
00152 <span class="preprocessor">    }</span>
00153 <span class="preprocessor"></span>
00154     <span class="comment">// Ansi sprintf implementations</span>
00155 <span class="preprocessor">#   ifdef IPROPERTY_DLL</span>
00156 <span class="preprocessor"></span><span class="preprocessor">#       define PropSprintfA sprintf</span>
00157 <span class="preprocessor"></span><span class="preprocessor">#       define PropVsprintfA vsprintf</span>
00158 <span class="preprocessor"></span><span class="preprocessor">#   else</span>
<a name="l00159"></a><a class="code" href="../../d3/d8/propapi_8h.html#a7">00159</a> <span class="preprocessor"></span><span class="preprocessor">#       define PropSprintfA wsprintfA</span>
<a name="l00160"></a><a class="code" href="../../d3/d8/propapi_8h.html#a8">00160</a> <span class="preprocessor"></span><span class="preprocessor">#       define PropVsprintfA wvsprintfA</span>
00161 <span class="preprocessor"></span><span class="preprocessor">#   endif       // #ifdef _MAC_NODOC</span>
00162 <span class="preprocessor"></span>
00163 <span class="preprocessor">#endif // #if defined(WINNT) &amp;&amp; !defined(IPROPERTY_DLL) ... #else</span>
00164 <span class="preprocessor"></span>
00165 
00166 <span class="preprocessor">#ifdef IPROPERTY_DLL</span>
00167 <span class="preprocessor"></span><span class="preprocessor">#define MAX_ULONG ((ULONG) -1)</span>
00168 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00169 <span class="preprocessor"></span>
00170 
<a name="l00171"></a><a class="code" href="../../d3/d8/propapi_8h.html#a9">00171</a> <span class="preprocessor">#define WC_PROPSET0     ((WCHAR) 0x0005)</span>
<a name="l00172"></a><a class="code" href="../../d3/d8/propapi_8h.html#a10">00172</a> <span class="preprocessor"></span><span class="preprocessor">#define OC_PROPSET0     ((OLECHAR) 0x0005)</span>
00173 <span class="preprocessor"></span>
<a name="l00174"></a><a class="code" href="../../d3/d8/propapi_8h.html#a11">00174</a> <span class="preprocessor">#define CBIT_BYTE       8</span>
<a name="l00175"></a><a class="code" href="../../d3/d8/propapi_8h.html#a12">00175</a> <span class="preprocessor"></span><span class="preprocessor">#define CBIT_GUID       (CBIT_BYTE * sizeof(GUID))</span>
<a name="l00176"></a><a class="code" href="../../d3/d8/propapi_8h.html#a13">00176</a> <span class="preprocessor"></span><span class="preprocessor">#define CBIT_CHARMASK   5</span>
00177 <span class="preprocessor"></span>
00178 <span class="comment">// Allow for OC_PROPSET0 and a GUID mapped to a 32 character alphabet</span>
<a name="l00179"></a><a class="code" href="../../d3/d8/propapi_8h.html#a14">00179</a> <span class="preprocessor">#define CCH_PROPSET        (1 + (CBIT_GUID + CBIT_CHARMASK-1)/CBIT_CHARMASK)</span>
<a name="l00180"></a><a class="code" href="../../d3/d8/propapi_8h.html#a15">00180</a> <span class="preprocessor"></span><span class="preprocessor">#define CCH_PROPSETSZ      (CCH_PROPSET + 1)            // allow null</span>
<a name="l00181"></a><a class="code" href="../../d3/d8/propapi_8h.html#a16">00181</a> <span class="preprocessor"></span><span class="preprocessor">#define CCH_PROPSETCOLONSZ (1 + CCH_PROPSET + 1)        // allow colon and null</span>
00182 <span class="preprocessor"></span>
00183 <span class="comment">// Define the max property name in units of characters</span>
00184 <span class="comment">// (and synonomously in wchars).</span>
00185 
<a name="l00186"></a><a class="code" href="../../d3/d8/propapi_8h.html#a17">00186</a> <span class="preprocessor">#define CCH_MAXPROPNAME    255                          // Matches Shell &amp; Office</span>
<a name="l00187"></a><a class="code" href="../../d3/d8/propapi_8h.html#a18">00187</a> <span class="preprocessor"></span><span class="preprocessor">#define CCH_MAXPROPNAMESZ  (CCH_MAXPROPNAME + 1)        // allow null</span>
<a name="l00188"></a><a class="code" href="../../d3/d8/propapi_8h.html#a19">00188</a> <span class="preprocessor"></span><span class="preprocessor">#define CWC_MAXPROPNAME    CCH_MAXPROPNAME</span>
<a name="l00189"></a><a class="code" href="../../d3/d8/propapi_8h.html#a20">00189</a> <span class="preprocessor"></span><span class="preprocessor">#define CWC_MAXPROPNAMESZ  CCH_MAXPROPNAMESZ</span>
00190 <span class="preprocessor"></span>
<a name="l00191"></a><a class="code" href="../../d3/d8/propapi_8h.html#a21">00191</a> <span class="preprocessor">#define MAX_DOCFILE_ENTRY_NAME  31</span>
00192 <span class="preprocessor"></span>
00193 <span class="comment">//+--------------------------------------------------------------------------</span>
00194 <span class="comment">// Property Access APIs:</span>
00195 <span class="comment">//---------------------------------------------------------------------------</span>
00196 
<a name="l00197"></a><a class="code" href="../../d3/d8/propapi_8h.html#a44">00197</a> <span class="keyword">typedef</span> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> *<a class="code" href="../../d3/d8/propapi_8h.html#a44">NTPROP</a>;
<a name="l00198"></a><a class="code" href="../../d3/d8/propapi_8h.html#a45">00198</a> <span class="keyword">typedef</span> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> *<a class="code" href="../../d3/d8/propapi_8h.html#a45">NTMAPPEDSTREAM</a>;
<a name="l00199"></a><a class="code" href="../../d3/d8/propapi_8h.html#a46">00199</a> <span class="keyword">typedef</span> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> *<a class="code" href="../../d3/d8/propapi_8h.html#a46">NTMEMORYALLOCATOR</a>;
00200 
00201 
00202 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00203 <a class="code" href="../../d3/d8/propapi_8h.html#a52">RtlSetUnicodeCallouts</a>(
00204     IN <a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html">UNICODECALLOUTS</a> *pUnicodeCallouts);
00205 
00206 ULONG <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00207 <a class="code" href="../../d3/d8/propapi_8h.html#a53">RtlGuidToPropertySetName</a>(
00208     IN GUID <span class="keyword">const</span> *pguid,
00209     OUT OLECHAR aocname[]);
00210 
00211 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00212 <a class="code" href="../../d3/d8/propapi_8h.html#a54">RtlPropertySetNameToGuid</a>(
00213     IN ULONG cwcname,
00214     IN OLECHAR <span class="keyword">const</span> aocname[],
00215     OUT GUID *pguid);
00216 
00217 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a> 
00218 <a class="code" href="../../d3/d8/propapi_8h.html#a55">PrSetUnicodeCallouts</a>(
00219     IN <a class="code" href="../../d9/d3/struct__UNICODECALLOUTS.html">UNICODECALLOUTS</a> *pUnicodeCallouts);
00220 
00221 ULONG 
00222 <a class="code" href="../../d3/d8/propapi_8h.html#a56">PrGuidToPropertySetName</a>(
00223     IN GUID <span class="keyword">const</span> *pguid,
00224     OUT OLECHAR aocname[]);
00225 
00226 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00227 <a class="code" href="../../d3/d8/propapi_8h.html#a57">PrPropertySetNameToGuid</a>(
00228     IN ULONG cwcname,
00229     IN OLECHAR <span class="keyword">const</span> aocname[],
00230     OUT GUID *pguid);
00231 
00232 
00233 <span class="comment">// RtlCreatePropertySet Flags:</span>
00234 
<a name="l00235"></a><a class="code" href="../../d3/d8/propapi_8h.html#a22">00235</a> <span class="preprocessor">#define CREATEPROP_READ         0x0000 // request read access (must exist)</span>
<a name="l00236"></a><a class="code" href="../../d3/d8/propapi_8h.html#a23">00236</a> <span class="preprocessor"></span><span class="preprocessor">#define CREATEPROP_WRITE        0x0001 // request write access (must exist)</span>
<a name="l00237"></a><a class="code" href="../../d3/d8/propapi_8h.html#a24">00237</a> <span class="preprocessor"></span><span class="preprocessor">#define CREATEPROP_CREATE       0x0002 // create (overwrite if exists)</span>
<a name="l00238"></a><a class="code" href="../../d3/d8/propapi_8h.html#a25">00238</a> <span class="preprocessor"></span><span class="preprocessor">#define CREATEPROP_CREATEIF     0x0003 // create (open existing if exists)</span>
<a name="l00239"></a><a class="code" href="../../d3/d8/propapi_8h.html#a26">00239</a> <span class="preprocessor"></span><span class="preprocessor">#define CREATEPROP_DELETE       0x0004 // delete</span>
<a name="l00240"></a><a class="code" href="../../d3/d8/propapi_8h.html#a27">00240</a> <span class="preprocessor"></span><span class="preprocessor">#define CREATEPROP_MODEMASK     0x000f // open mode mask</span>
00241 <span class="preprocessor"></span>
<a name="l00242"></a><a class="code" href="../../d3/d8/propapi_8h.html#a28">00242</a> <span class="preprocessor">#define CREATEPROP_NONSIMPLE    0x0010 // Is non-simple propset (in a storage)</span>
00243 <span class="preprocessor"></span>
00244 
00245 <span class="comment">// RtlCreateMappedStream Flags:</span>
00246 
<a name="l00247"></a><a class="code" href="../../d3/d8/propapi_8h.html#a29">00247</a> <span class="preprocessor">#define CMS_READONLY      0x00000000    // Opened for read-only</span>
<a name="l00248"></a><a class="code" href="../../d3/d8/propapi_8h.html#a30">00248</a> <span class="preprocessor"></span><span class="preprocessor">#define CMS_WRITE         0x00000001    // Opened for write access</span>
<a name="l00249"></a><a class="code" href="../../d3/d8/propapi_8h.html#a31">00249</a> <span class="preprocessor"></span><span class="preprocessor">#define CMS_TRANSACTED    0x00000002    // Is transacted</span>
00250 <span class="preprocessor"></span>
00251 
00252 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00253 <a class="code" href="../../d3/d8/propapi_8h.html#a58">RtlCreatePropertySet</a>(
00254     IN NTMAPPEDSTREAM ms,       <span class="comment">// Nt mapped stream</span>
00255     IN USHORT Flags,    <span class="comment">// NONSIMPLE|*1* of READ/WRITE/CREATE/CREATEIF/DELETE</span>
00256     OPTIONAL IN GUID <span class="keyword">const</span> *pguid, <span class="comment">// property set guid (create only)</span>
00257     OPTIONAL IN GUID <span class="keyword">const</span> *pclsid,<span class="comment">// CLASSID of propset code (create only)</span>
00258     IN NTMEMORYALLOCATOR ma,    <span class="comment">// caller's memory allocator</span>
00259     IN ULONG LocaleId,          <span class="comment">// Locale Id (create only)</span>
00260     OPTIONAL OUT ULONG *pOSVersion,<span class="comment">// OS Version field in header.</span>
00261     IN OUT USHORT *pCodePage,   <span class="comment">// IN: CodePage of property set (create only)</span>
00262                                 <span class="comment">// OUT: CodePage of property set (always)</span>
00263     OUT NTPROP *pnp);           <span class="comment">// Nt property set context</span>
00264 
00265 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00266 <a class="code" href="../../d3/d8/propapi_8h.html#a59">RtlClosePropertySet</a>(
00267     IN NTPROP np);              <span class="comment">// property set context</span>
00268 
00269 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00270 <a class="code" href="../../d3/d8/propapi_8h.html#a60">PrCreatePropertySet</a>(
00271     IN NTMAPPEDSTREAM ms,       <span class="comment">// Nt mapped stream</span>
00272     IN USHORT Flags,    <span class="comment">// NONSIMPLE|*1* of READ/WRITE/CREATE/CREATEIF/DELETE</span>
00273     OPTIONAL IN GUID <span class="keyword">const</span> *pguid, <span class="comment">// property set guid (create only)</span>
00274     OPTIONAL IN GUID <span class="keyword">const</span> *pclsid,<span class="comment">// CLASSID of propset code (create only)</span>
00275     IN NTMEMORYALLOCATOR ma,    <span class="comment">// caller's memory allocator</span>
00276     IN ULONG LocaleId,          <span class="comment">// Locale Id (create only)</span>
00277     OPTIONAL OUT ULONG *pOSVersion,<span class="comment">// OS Version field in header.</span>
00278     IN OUT USHORT *pCodePage,   <span class="comment">// IN: CodePage of property set (create only)</span>
00279                                 <span class="comment">// OUT: CodePage of property set (always)</span>
00280     OUT NTPROP *pnp);           <span class="comment">// Nt property set context</span>
00281 
00282 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00283 <a class="code" href="../../d3/d8/propapi_8h.html#a61">PrClosePropertySet</a>(
00284     IN NTPROP np);              <span class="comment">// property set context</span>
00285 
00286 <span class="comment">// *NOTE* RtlOnMappedStreamEvent assumes that the caller has</span>
00287 <span class="comment">// already taken the CPropertySetStream::Lock.</span>
<a name="l00288"></a><a class="code" href="../../d3/d8/propapi_8h.html#a32">00288</a> <span class="preprocessor">#define CBSTM_UNKNOWN   ((ULONG) -1)</span>
00289 <span class="preprocessor"></span><a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00290 <a class="code" href="../../d3/d8/propapi_8h.html#a62">RtlOnMappedStreamEvent</a>(
00291     IN VOID *pv,               <span class="comment">// property set context (NTPROP)</span>
00292     IN VOID *pbuf,             <span class="comment">// property set buffer</span>
00293     IN ULONG cbstm );          <span class="comment">// size of underlying stream, or CBSTM_UNKNOWN</span>
00294 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00295 <a class="code" href="../../d3/d8/propapi_8h.html#a63">PrOnMappedStreamEvent</a>(
00296     IN VOID *pv,               <span class="comment">// property set context (NTPROP)</span>
00297     IN VOID *pbuf,             <span class="comment">// property set buffer</span>
00298     IN ULONG cbstm );          <span class="comment">// size of underlying stream, or CBSTM_UNKNOWN</span>
00299 
00300 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00301 <a class="code" href="../../d3/d8/propapi_8h.html#a64">RtlFlushPropertySet</a>(
00302     IN NTPROP np);              <span class="comment">// property set context</span>
00303 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00304 <a class="code" href="../../d3/d8/propapi_8h.html#a65">PrFlushPropertySet</a>(
00305     IN NTPROP np);              <span class="comment">// property set context</span>
00306 
<a name="l00307"></a><a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">00307</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">_INDIRECTPROPERTY</a>        <span class="comment">// ip</span>
00308 {
<a name="l00309"></a><a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html#o0">00309</a>     ULONG       <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html#o0">Index</a>;          <span class="comment">// Index into Variant and PropId arrays</span>
<a name="l00310"></a><a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html#o1">00310</a>     LPOLESTR    <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html#o1">poszName</a>;       <span class="comment">// Old indirect name, RtlSetProperties() only</span>
00311 } <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">INDIRECTPROPERTY</a>;
00312 
00313 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00314 <a class="code" href="../../d3/d8/propapi_8h.html#a66">RtlSetProperties</a>(
00315     IN NTPROP np,               <span class="comment">// property set context</span>
00316     IN ULONG cprop,             <span class="comment">// property count</span>
00317     IN PROPID pidNameFirst,     <span class="comment">// first PROPID for new named properties</span>
00318     IN PROPSPEC <span class="keyword">const</span> aprs[],   <span class="comment">// array of property specifiers</span>
00319     OPTIONAL OUT PROPID apid[], <span class="comment">// buffer for array of propids</span>
00320     OPTIONAL OUT <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">INDIRECTPROPERTY</a> **ppip, <span class="comment">// pointer to returned pointer to</span>
00321                                 <span class="comment">// MAXULONG terminated array of Indirect</span>
00322                                 <span class="comment">// properties w/indexes into aprs &amp; avar</span>
00323     OPTIONAL IN PROPVARIANT <span class="keyword">const</span> avar[]);<span class="comment">// array of properties with values</span>
00324 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00325 <a class="code" href="../../d3/d8/propapi_8h.html#a67">PrSetProperties</a>(
00326     IN NTPROP np,               <span class="comment">// property set context</span>
00327     IN ULONG cprop,             <span class="comment">// property count</span>
00328     IN PROPID pidNameFirst,     <span class="comment">// first PROPID for new named properties</span>
00329     IN PROPSPEC <span class="keyword">const</span> aprs[],   <span class="comment">// array of property specifiers</span>
00330     OPTIONAL OUT PROPID apid[], <span class="comment">// buffer for array of propids</span>
00331     OPTIONAL OUT <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">INDIRECTPROPERTY</a> **ppip, <span class="comment">// pointer to returned pointer to</span>
00332                                 <span class="comment">// MAXULONG terminated array of Indirect</span>
00333                                 <span class="comment">// properties w/indexes into aprs &amp; avar</span>
00334     OPTIONAL IN PROPVARIANT <span class="keyword">const</span> avar[]);<span class="comment">// array of properties with values</span>
00335 
00336 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00337 <a class="code" href="../../d3/d8/propapi_8h.html#a68">RtlQueryProperties</a>(
00338     IN NTPROP np,               <span class="comment">// property set context</span>
00339     IN ULONG cprop,             <span class="comment">// property count</span>
00340     IN PROPSPEC <span class="keyword">const</span> aprs[],   <span class="comment">// array of property specifiers</span>
00341     OPTIONAL OUT PROPID apid[], <span class="comment">// buffer for array of propids</span>
00342     OPTIONAL OUT <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">INDIRECTPROPERTY</a> **ppip, <span class="comment">// pointer to returned pointer to</span>
00343                                 <span class="comment">// MAXULONG terminated array of Indirect</span>
00344                                 <span class="comment">// properties w/indexes into aprs &amp; avar</span>
00345     IN OUT PROPVARIANT *avar,   <span class="comment">// IN: array of uninitialized PROPVARIANTs,</span>
00346                                 <span class="comment">// OUT: may contain pointers to alloc'd memory</span>
00347     OUT ULONG *pcpropFound);    <span class="comment">// count of property values retrieved</span>
00348 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00349 <a class="code" href="../../d3/d8/propapi_8h.html#a69">PrQueryProperties</a>(
00350     IN NTPROP np,               <span class="comment">// property set context</span>
00351     IN ULONG cprop,             <span class="comment">// property count</span>
00352     IN PROPSPEC <span class="keyword">const</span> aprs[],   <span class="comment">// array of property specifiers</span>
00353     OPTIONAL OUT PROPID apid[], <span class="comment">// buffer for array of propids</span>
00354     OPTIONAL OUT <a class="code" href="../../d9/d1/struct__INDIRECTPROPERTY.html">INDIRECTPROPERTY</a> **ppip, <span class="comment">// pointer to returned pointer to</span>
00355                                 <span class="comment">// MAXULONG terminated array of Indirect</span>
00356                                 <span class="comment">// properties w/indexes into aprs &amp; avar</span>
00357     IN OUT PROPVARIANT *avar,   <span class="comment">// IN: array of uninitialized PROPVARIANTs,</span>
00358                                 <span class="comment">// OUT: may contain pointers to alloc'd memory</span>
00359     OUT ULONG *pcpropFound);    <span class="comment">// count of property values retrieved</span>
00360 
00361 
00362 
<a name="l00363"></a><a class="code" href="../../d3/d8/propapi_8h.html#a33">00363</a> <span class="preprocessor">#define ENUMPROP_NONAMES        0x00000001      // return property IDs only</span>
00364 <span class="preprocessor"></span>
00365 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00366 <a class="code" href="../../d3/d8/propapi_8h.html#a70">RtlEnumerateProperties</a>(
00367     IN NTPROP np,               <span class="comment">// property set context</span>
00368     IN ULONG Flags,             <span class="comment">// flags: No Names (propids only), etc.</span>
00369     IN OUT ULONG *pkey,         <span class="comment">// bookmark; caller set to 0 before 1st call</span>
00370     IN OUT ULONG *pcprop,       <span class="comment">// pointer to property count</span>
00371     OPTIONAL OUT PROPSPEC aprs[],<span class="comment">// IN: array of uninitialized PROPSPECs</span>
00372                                 <span class="comment">// OUT: may contain pointers to alloc'd strings</span>
00373     OPTIONAL OUT STATPROPSTG asps[]);
00374                                 <span class="comment">// IN: array of uninitialized STATPROPSTGs</span>
00375                                 <span class="comment">// OUT: may contain pointers to alloc'd strings</span>
00376 
00377 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00378 <a class="code" href="../../d3/d8/propapi_8h.html#a71">RtlQueryPropertyNames</a>(
00379     IN NTPROP np,               <span class="comment">// property set context</span>
00380     IN ULONG cprop,             <span class="comment">// property count</span>
00381     IN PROPID <span class="keyword">const</span> *apid,      <span class="comment">// PROPID array</span>
00382     OUT OLECHAR *aposz[]        <span class="comment">// OUT pointers to allocated strings</span>
00383     );
00384 
00385 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00386 <a class="code" href="../../d3/d8/propapi_8h.html#a72">RtlSetPropertyNames</a>(
00387     IN NTPROP np,               <span class="comment">// property set context</span>
00388     IN ULONG cprop,             <span class="comment">// property count</span>
00389     IN PROPID <span class="keyword">const</span> *apid,      <span class="comment">// PROPID array</span>
00390     IN OLECHAR <span class="keyword">const</span> * <span class="keyword">const</span> aposz[] <span class="comment">// pointers to property names</span>
00391     );
00392 
00393 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00394 <a class="code" href="../../d3/d8/propapi_8h.html#a73">RtlSetPropertySetClassId</a>(
00395     IN NTPROP np,               <span class="comment">// property set context</span>
00396     IN GUID <span class="keyword">const</span> *pclsid       <span class="comment">// new CLASSID of propset code</span>
00397     );
00398 
00399 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00400 <a class="code" href="../../d3/d8/propapi_8h.html#a74">RtlQueryPropertySet</a>(
00401     IN NTPROP np,               <span class="comment">// property set context</span>
00402     OUT STATPROPSETSTG *pspss   <span class="comment">// buffer for property set stat information</span>
00403     );
00404 
00405 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d3/d8/propapi_8h.html#a1">PROPSYSAPI</a> <a class="code" href="../../d3/d8/propapi_8h.html#a2">PROPAPI</a>
00406 <a class="code" href="../../d3/d8/propapi_8h.html#a75">RtlEnumeratePropertySets</a>(
00407     IN HANDLE hstg,             <span class="comment">// structured storage handle</span>
00408     IN BOOLEAN fRestart,        <span class="comment">// restart scan</span>
00409     IN OUT ULONG *pcspss,       <span class="comment">// pointer to count of STATPROPSETSTGs</span>
00410     IN OUT GUID *pkey,          <span class="comment">// bookmark</span>
00411     OUT STATPROPSETSTG *pspss   <span class="comment">// array of STATPROPSETSTGs</span>
00412     );
00413 
00414 
00415 
00416 
00417 
00418 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00419 <a class="code" href="../../d3/d8/propapi_8h.html#a76">PrEnumerateProperties</a>(
00420     IN NTPROP np,               <span class="comment">// property set context</span>
00421     IN ULONG Flags,             <span class="comment">// flags: No Names (propids only), etc.</span>
00422     IN OUT ULONG *pkey,         <span class="comment">// bookmark; caller set to 0 before 1st call</span>
00423     IN OUT ULONG *pcprop,       <span class="comment">// pointer to property count</span>
00424     OPTIONAL OUT PROPSPEC aprs[],<span class="comment">// IN: array of uninitialized PROPSPECs</span>
00425                                 <span class="comment">// OUT: may contain pointers to alloc'd strings</span>
00426     OPTIONAL OUT STATPROPSTG asps[]);
00427                                 <span class="comment">// IN: array of uninitialized STATPROPSTGs</span>
00428                                 <span class="comment">// OUT: may contain pointers to alloc'd strings</span>
00429 
00430 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00431 <a class="code" href="../../d3/d8/propapi_8h.html#a77">PrQueryPropertyNames</a>(
00432     IN NTPROP np,               <span class="comment">// property set context</span>
00433     IN ULONG cprop,             <span class="comment">// property count</span>
00434     IN PROPID <span class="keyword">const</span> *apid,      <span class="comment">// PROPID array</span>
00435     OUT OLECHAR *aposz[]        <span class="comment">// OUT pointers to allocated strings</span>
00436     );
00437 
00438 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00439 <a class="code" href="../../d3/d8/propapi_8h.html#a78">PrSetPropertyNames</a>(
00440     IN NTPROP np,               <span class="comment">// property set context</span>
00441     IN ULONG cprop,             <span class="comment">// property count</span>
00442     IN PROPID <span class="keyword">const</span> *apid,      <span class="comment">// PROPID array</span>
00443     IN OLECHAR <span class="keyword">const</span> * <span class="keyword">const</span> aposz[] <span class="comment">// pointers to property names</span>
00444     );
00445 
00446 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00447 <a class="code" href="../../d3/d8/propapi_8h.html#a79">PrSetPropertySetClassId</a>(
00448     IN NTPROP np,               <span class="comment">// property set context</span>
00449     IN GUID <span class="keyword">const</span> *pclsid       <span class="comment">// new CLASSID of propset code</span>
00450     );
00451 
00452 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00453 <a class="code" href="../../d3/d8/propapi_8h.html#a80">PrQueryPropertySet</a>(
00454     IN NTPROP np,               <span class="comment">// property set context</span>
00455     OUT STATPROPSETSTG *pspss   <span class="comment">// buffer for property set stat information</span>
00456     );
00457 
00458 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> 
00459 <a class="code" href="../../d3/d8/propapi_8h.html#a81">PrEnumeratePropertySets</a>(
00460     IN HANDLE hstg,             <span class="comment">// structured storage handle</span>
00461     IN BOOLEAN fRestart,        <span class="comment">// restart scan</span>
00462     IN OUT ULONG *pcspss,       <span class="comment">// pointer to count of STATPROPSETSTGs</span>
00463     IN OUT GUID *pkey,          <span class="comment">// bookmark</span>
00464     OUT STATPROPSETSTG *pspss   <span class="comment">// array of STATPROPSETSTGs</span>
00465     );
00466 
00467 
00468 
00469 <span class="preprocessor">#ifdef __cplusplus</span>
00470 <span class="preprocessor"></span>}
00471 <span class="preprocessor">#endif</span>
00472 <span class="preprocessor"></span>
00473 <span class="preprocessor">#endif // ifndef _PROPAPI_H_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:30 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
