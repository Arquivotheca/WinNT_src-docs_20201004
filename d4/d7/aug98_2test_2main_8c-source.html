<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: main.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>main.c</h1><a href="../../d3/d8/aug98_2test_2main_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 
00002 <span class="comment">/******************************************************************************\</span>
00003 <span class="comment">*       This is a part of the Microsoft Source Code Samples. </span>
00004 <span class="comment">*       Copyright (C) 1993 Microsoft Corporation.</span>
00005 <span class="comment">*       All rights reserved. </span>
00006 <span class="comment">*       This source code is only intended as a supplement to </span>
00007 <span class="comment">*       Microsoft Development Tools and/or WinHelp documentation.</span>
00008 <span class="comment">*       See these sources for detailed information regarding the </span>
00009 <span class="comment">*       Microsoft samples programs.</span>
00010 <span class="comment">\******************************************************************************/</span>
00011 
00012 <span class="comment">/****************************************************************************</span>
00013 <span class="comment">*</span>
00014 <span class="comment">*</span>
00015 <span class="comment">*    PROGRAM: CmnDlg.c</span>
00016 <span class="comment">*</span>
00017 <span class="comment">*    PURPOSE: Sample demonstrating the use of the common dialogs in Windows</span>
00018 <span class="comment">*</span>
00019 <span class="comment">*    FUNCTIONS:</span>
00020 <span class="comment">*</span>
00021 <span class="comment">*        WinMain() - calls initialization function, processes message loop</span>
00022 <span class="comment">*        InitApplication() - initializes window data and registers window</span>
00023 <span class="comment">*        InitInstance() - saves instance handle and creates main window</span>
00024 <span class="comment">*        MainWndProc() - processes messages</span>
00025 <span class="comment">*        About() - processes messages for "About" dialog box</span>
00026 <span class="comment">*        OpenNewFile() - opens a new file</span>
00027 <span class="comment">*        SaveToFile() - saves the current text buffer to the current filename</span>
00028 <span class="comment">*        SaveAs() - saves the current text buffer to a new file name</span>
00029 <span class="comment">*        EnterNew() - to enter new text into the text buffer</span>
00030 <span class="comment">*        FileOpenHookProc() - Hook procedure for GetOpenFileName() common dialog</span>
00031 <span class="comment">*        FileSaveHookProc() - Hook procedure for GetSaveFileName() common dialog</span>
00032 <span class="comment">*        ChooseFontHookProc() - Hook procedure for ChooseFont() common dialog</span>
00033 <span class="comment">*        FindTextHookProc() - Hook procedure for FindText() common dialog</span>
00034 <span class="comment">*        ReplaceTextHookProc() - Hook procedure for the ReplaceText() common dialog</span>
00035 <span class="comment">*        PrintDlgHookProc() - Hook procedure for the PrintDlg() common dialog</span>
00036 <span class="comment">*        PrintSetupHookProc() - Hook procedure for the PrintDlg() setup common dialog</span>
00037 <span class="comment">*        SearchFile() - Searches for the specified text in the file buffer</span>
00038 <span class="comment">*        ChooseNewFont() - chooses a new font for display</span>
00039 <span class="comment">*        ChooseNewColor() - chooses a new color for display</span>
00040 <span class="comment">*        PrintFile() - prints the current text in the file buffer</span>
00041 <span class="comment">*        CallFindText() - calls the FindText() common dialog function</span>
00042 <span class="comment">*        CallReplaceText() - calls the ReplaceText() common dialog function</span>
00043 <span class="comment">*        ProcessCDError() - uses CommonDialogExtendedError() to output useful error messages</span>
00044 <span class="comment">*</span>
00045 <span class="comment">*    COMMENTS:</span>
00046 <span class="comment">*</span>
00047 <span class="comment">*</span>
00048 <span class="comment">*        The common dialog APIs demonstrated in the sample include:</span>
00049 <span class="comment">*</span>
00050 <span class="comment">*            ChooseColor()</span>
00051 <span class="comment">*            ChooseFont()</span>
00052 <span class="comment">*            FindText()</span>
00053 <span class="comment">*            GetOpenFileName()</span>
00054 <span class="comment">*            GetSaveFileName()</span>
00055 <span class="comment">*            PrintDlg()</span>
00056 <span class="comment">*            ReplaceText()</span>
00057 <span class="comment">*</span>
00058 <span class="comment">*</span>
00059 <span class="comment">*        Each dialog box is demonstrated being used in three different ways:</span>
00060 <span class="comment">*        standard, using a modified template and using a hook function.</span>
00061 <span class="comment">*</span>
00062 <span class="comment">*</span>
00063 <span class="comment">****************************************************************************/</span>
00064 
00065 <span class="preprocessor">#include &lt;windows.h&gt;</span>    <span class="comment">// includes basic windows functionality</span>
00066 <span class="preprocessor">#include &lt;commdlg.h&gt;</span>    <span class="comment">// includes common dialog functionality</span>
00067 <span class="preprocessor">#include &lt;dlgs.h&gt;</span>       <span class="comment">// includes common dialog template defines</span>
00068 <span class="preprocessor">#include &lt;stdio.h&gt;</span>      <span class="comment">// includes standard file i/o functionality</span>
00069 <span class="preprocessor">#include &lt;string.h&gt;</span>     <span class="comment">// includes string functions</span>
00070 <span class="preprocessor">#include &lt;<a class="code" href="../../d8/d5/jul98_2test_2cderr_8h.html">cderr.h</a>&gt;</span>      <span class="comment">// includes the common dialog error codes</span>
00071 <span class="preprocessor">#include "<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html">main.h</a>"</span>       <span class="comment">// includes my common dialog functions</span>
00072 <span class="preprocessor">#include "<a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html">resource.h</a>"</span>
00073 
<a name="l00074"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">00074</a> HANDLE       <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
<a name="l00075"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">00075</a> OPENFILENAME <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>;
<a name="l00076"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a2">00076</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a2">szDirName</a>[256]   = <span class="stringliteral">""</span>;
<a name="l00077"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">00077</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">szFile</a>[256]      = <span class="stringliteral">"\0"</span>;
<a name="l00078"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">00078</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">szFileTitle</a>[256];
00079 
00080 <span class="comment">// Filter specification for the OPENFILENAME struct</span>
00081 <span class="comment">// This is portable for i386 and MIPS</span>
00082 <span class="comment">// Leaving out the \0 terminator will cause improper DWORD alignment</span>
00083 <span class="comment">// and cause a failure under MIPS</span>
<a name="l00084"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a5">00084</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a5">szFilter</a>[] = <span class="stringliteral">"Text Files (*.ICM)\0*.ICM\0All Files (*.*)\0*.*\0"</span>;
<a name="l00085"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a6">00085</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a6">szSaveFilter</a>[] = <span class="stringliteral">"Text Files (*.CSA)\0*.CSA\0All Files (*.*)\0*.*\0"</span>;
00086 
<a name="l00087"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">00087</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>];
<a name="l00088"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">00088</a> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>        <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>;
<a name="l00089"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a9">00089</a> <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a9">FindReplaceMsg</a>;
<a name="l00090"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">00090</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">szFindString</a>[64]   = <span class="stringliteral">""</span>;
<a name="l00091"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a11">00091</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a11">szReplaceString</a>[64]   = <span class="stringliteral">""</span>;
<a name="l00092"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">00092</a> FINDREPLACE  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>;
<a name="l00093"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">00093</a> LPFINDREPLACE <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>;
<a name="l00094"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">00094</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *       <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
<a name="l00095"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">00095</a> CHOOSEFONT   <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>;
<a name="l00096"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">00096</a> CHOOSECOLOR  <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>;
<a name="l00097"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a17">00097</a> COLORREF     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a17">crColor</a>;
<a name="l00098"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">00098</a> LOGFONT      <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
<a name="l00099"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">00099</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>;
<a name="l00100"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">00100</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a16">IDM_ASCII</a>;
<a name="l00101"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">00101</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a13">IDM_PERCEPUAL</a>;
<a name="l00102"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">00102</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">wCSAMode</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a18">IDM_AUTO</a>;
<a name="l00103"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">00103</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">wInpDrvClrSp</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a21">IDM_INP_AUTO</a>;
<a name="l00104"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">00104</a> WORD         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> = <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a25">IDM_CSA</a>;
<a name="l00105"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">00105</a> HWND         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
<a name="l00106"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">00106</a> PRINTDLG     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>;
00107 
<a name="l00108"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">00108</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
<a name="l00109"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">00109</a> <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>        <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a> = 0;
<a name="l00110"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">00110</a> HWND         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>; 
00111 
00112 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d5/d8/jul98_2test_2main_8c.html#a30">OpenFiles</a>(
00113         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
00114         UINT message,             <span class="comment">/* type of message                 */</span>
00115         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
00116         LPARAM lParam);
00117 
00118 <span class="comment">/****************************************************************************</span>
00119 <span class="comment">*</span>
00120 <span class="comment">*    FUNCTION: WinMain(HINSTANCE, HINSTANCE, LPSTR, int)</span>
00121 <span class="comment">*</span>
00122 <span class="comment">*    PURPOSE: calls initialization function, processes message loop</span>
00123 <span class="comment">*</span>
00124 <span class="comment">*    COMMENTS:</span>
00125 <span class="comment">*</span>
00126 <span class="comment">*</span>
00127 <span class="comment">****************************************************************************/</span>
00128 
<a name="l00129"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a31">00129</a> <span class="keywordtype">int</span> PASCAL <a class="code" href="../../d0/d2/usrbench_8h.html#a51">WinMain</a>(
00130     HINSTANCE hInstance,
00131     HINSTANCE hPrevInstance,
00132     LPSTR lpCmdLine,
00133     <span class="keywordtype">int</span> nCmdShow
00134     )
00135 {
00136 
00137     MSG <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;                         <span class="comment">/* message                      */</span>
00138 
00139     <span class="keywordflow">if</span> (!hPrevInstance)                  <span class="comment">/* Other instances of app running? */</span>
00140         <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a72">InitApplication</a>(hInstance)) <span class="comment">/* Initialize shared things */</span>
00141             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);              <span class="comment">/* Exits if unable to initialize     */</span>
00142 
00143     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a> = hInstance;
00144 
00145     <span class="comment">/* Perform initializations that apply to a specific instance */</span>
00146 
00147     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a73">InitInstance</a>(hInstance, nCmdShow))
00148         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00149 
00150     <span class="comment">// register window message for FindText() and ReplaceText() hook procs</span>
00151     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a9">FindReplaceMsg</a> = <a class="code" href="../../d0/d8/ntcftxt_8h.html#a25">RegisterWindowMessage</a>( (LPSTR) FINDMSGSTRING );
00152 
00153     <span class="comment">/* Acquire and dispatch messages until a WM_QUIT message is received. */</span>
00154 
00155     <span class="keywordflow">while</span> (<a class="code" href="../../d0/d8/ntcftxt_8h.html#a16">GetMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>,        <span class="comment">/* message structure                      */</span>
00156             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,                  <span class="comment">/* handle of window receiving the message */</span>
00157             0,                     <span class="comment">/* lowest message to examine              */</span>
00158             0))                    <span class="comment">/* highest message to examine             */</span>
00159         <span class="keywordflow">if</span> ( !<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a> || !<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a>) || !<a class="code" href="../../d3/d0/user32_8def.html#a39">IsDialogMessage</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a>, &amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a> ) )
00160             {
00161             <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a21">TranslateMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);    <span class="comment">/* Translates virtual key codes */</span>
00162             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>);     <span class="comment">/* Dispatches message to window */</span>
00163             }
00164     <span class="keywordflow">return</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.wParam);           <span class="comment">/* Returns the value from PostQuitMessage */</span>
00165 
00166     <span class="comment">// avoid compiler warnings at W3</span>
00167     lpCmdLine;
00168 }
00169 
00170 
00171 <span class="comment">/****************************************************************************</span>
00172 <span class="comment">*</span>
00173 <span class="comment">*    FUNCTION: InitApplication(HANDLE)</span>
00174 <span class="comment">*</span>
00175 <span class="comment">*    PURPOSE: Initializes window data and registers window class</span>
00176 <span class="comment">*</span>
00177 <span class="comment">*    COMMENTS:</span>
00178 <span class="comment">*</span>
00179 <span class="comment">*        In this function, we initialize a window class by filling out a data</span>
00180 <span class="comment">*        structure of type WNDCLASS and calling the Windows RegisterClass()</span>
00181 <span class="comment">*        function.</span>
00182 <span class="comment">*</span>
00183 <span class="comment">****************************************************************************/</span>
00184 
<a name="l00185"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a72">00185</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a72">InitApplication</a>(HANDLE hInstance)       <span class="comment">/* current instance             */</span>
00186 {
00187     WNDCLASS  wc;
00188 
00189     <span class="comment">/* Fill in window class structure with parameters that describe the       */</span>
00190     <span class="comment">/* main window.                                                           */</span>
00191 
00192     wc.style = 0;                       <span class="comment">/* Class style(s).                    */</span>
00193     wc.lpfnWndProc = (WNDPROC)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a34">MainWndProc</a>;       <span class="comment">/* Function to retrieve messages for  */</span>
00194                                         <span class="comment">/* windows of this class.             */</span>
00195     wc.cbClsExtra = 0;                  <span class="comment">/* No per-class extra data.           */</span>
00196     wc.cbWndExtra = 0;                  <span class="comment">/* No per-window extra data.          */</span>
00197     wc.hInstance = hInstance;           <span class="comment">/* Application that owns the class.   */</span>
00198     wc.hIcon = LoadIcon(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a1">IDI_ICON1</a>);
00199     wc.hCursor = LoadCursor(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, IDC_ARROW);
00200     wc.hbrBackground = GetStockObject(WHITE_BRUSH); 
00201     wc.lpszMenuName =  <span class="stringliteral">"CmnDlgMenu"</span>;   <span class="comment">/* Name of menu resource in .RC file. */</span>
00202     wc.lpszClassName = <span class="stringliteral">"CmnDlgWClass"</span>; <span class="comment">/* Name used in call to CreateWindow. */</span>
00203 
00204     <span class="comment">/* Register the window class and return success/failure code. */</span>
00205 
00206     <span class="keywordflow">return</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a7">RegisterClass</a>(&amp;wc));
00207 
00208 }
00209 
00210 
00211 <span class="comment">/****************************************************************************</span>
00212 <span class="comment">*</span>
00213 <span class="comment">*    FUNCTION:  InitInstance(HANDLE, int)</span>
00214 <span class="comment">*</span>
00215 <span class="comment">*    PURPOSE:  Saves instance handle and creates main window</span>
00216 <span class="comment">*</span>
00217 <span class="comment">*    COMMENTS:</span>
00218 <span class="comment">*</span>
00219 <span class="comment">*        In this function, we save the instance handle in a static variable and</span>
00220 <span class="comment">*        create and display the main program window.</span>
00221 <span class="comment">*</span>
00222 <span class="comment">****************************************************************************/</span>
00223 
<a name="l00224"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a73">00224</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a73">InitInstance</a>(
00225     HANDLE          hInstance,          <span class="comment">/* Current instance identifier.       */</span>
00226     <span class="keywordtype">int</span>             nCmdShow)           <span class="comment">/* Param for first ShowWindow() call. */</span>
00227 {
00228     HWND            hWND;               <span class="comment">/* Main window handle.                */</span>
00229 
00230     <span class="comment">/* Save the instance handle in static variable, which will be used in  */</span>
00231     <span class="comment">/* many subsequence calls from this application to Windows.            */</span>
00232 
00233     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a> = hInstance;
00234 
00235     <span class="comment">/* Create a main window for this application instance.  */</span>
00236 
00237     hWND = CreateWindow(
00238         <span class="stringliteral">"CmnDlgWClass"</span>,                 <span class="comment">/* See RegisterClass() call.          */</span>
00239         <span class="stringliteral">"CIEBASED_CDEF Color Space"</span>,    <span class="comment">/* Text for window title bar.         */</span>
00240         WS_OVERLAPPEDWINDOW,            <span class="comment">/* Window style.                      */</span>
00241         CW_USEDEFAULT,                  <span class="comment">/* Default horizontal position.       */</span>
00242         CW_USEDEFAULT,                  <span class="comment">/* Default vertical position.         */</span>
00243         CW_USEDEFAULT,                  <span class="comment">/* Default width.                     */</span>
00244         CW_USEDEFAULT,                  <span class="comment">/* Default height.                    */</span>
00245         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,                           <span class="comment">/* Overlapped windows have no parent. */</span>
00246         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,                           <span class="comment">/* Use the window class menu.         */</span>
00247         hInstance,                      <span class="comment">/* This instance owns this window.    */</span>
00248         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>                            <span class="comment">/* Pointer not needed.                */</span>
00249     );
00250 
00251     <span class="comment">/* If window could not be created, return "failure" */</span>
00252 
00253     <span class="keywordflow">if</span> (!hWND)
00254         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00255      
00256     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> = hWND;
00257     <span class="comment">/* Make the window visible; update its client area; and return "success" */</span>
00258 
00259     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, nCmdShow);  <span class="comment">/* Show the window                        */</span>
00260     <a class="code" href="../../d3/d8/client_8c.html#a140">UpdateWindow</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);          <span class="comment">/* Sends WM_PAINT message                 */</span>
00261     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);               <span class="comment">/* Returns the value from PostQuitMessage */</span>
00262 
00263 }
00264 
00265 <span class="comment">/****************************************************************************</span>
00266 <span class="comment">*</span>
00267 <span class="comment">*    FUNCTION: MainWndProc(HWND, UINT, WPARAM, LPARAM)</span>
00268 <span class="comment">*</span>
00269 <span class="comment">*    PURPOSE:  Processes messages</span>
00270 <span class="comment">*</span>
00271 <span class="comment">*    COMMENTS:</span>
00272 <span class="comment">*</span>
00273 <span class="comment">*        This function processes all messags sent to the window.  When the</span>
00274 <span class="comment">*        user choses one of the options from one of the menus, the command</span>
00275 <span class="comment">*        is processed here and passed onto the function for that command.</span>
00276 <span class="comment">*        This function also processes the special "FindReplace" message that</span>
00277 <span class="comment">*        this application registers for hook processing of the FindText()</span>
00278 <span class="comment">*        and ReplaceText() common dialog functions.</span>
00279 <span class="comment">*</span>
00280 <span class="comment">****************************************************************************/</span>
00281 
<a name="l00282"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a61">00282</a> LRESULT CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a61">MainWndProc</a>(
00283         HWND hWnd,                <span class="comment">/* window handle                   */</span>
00284         UINT message,             <span class="comment">/* type of message                 */</span>
00285         WPARAM wParam,            <span class="comment">/* additional information          */</span>
00286         LPARAM lParam)            <span class="comment">/* additional information          */</span>
00287 {
00288     FARPROC lpProcAbout;          <span class="comment">/* pointer to the "About" function */</span>
00289     FARPROC lpProcOpen;
00290     FARPROC lpProcEnterNew;       <span class="comment">/* pointer to the "EnterNew" function */</span>
00291     HDC hDC;
00292     PAINTSTRUCT ps;
00293     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a> nDrawX;
00294     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a> nDrawY;
00295     HFONT hFont;
00296     HANDLE <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00297     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> NewFont;
00298 
00299     <span class="keywordflow">switch</span> (message) {
00300 
00301 
00302         <span class="keywordflow">case</span> WM_CREATE:
00303             <span class="comment">//initialize the output on the screen</span>
00304             strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, <span class="stringliteral">" "</span>);
00305             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
00306             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>);
00307             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a17">crColor</a> = 0;
00308             NewFont = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00309             <span class="keywordflow">break</span>;
00310 
00311 
00312         <span class="keywordflow">case</span> WM_PAINT:
00313             <span class="comment">/* Set up a display context to begin painting */</span>
00314             hDC = <a class="code" href="../../d3/d0/user32_8def.html#a41">BeginPaint</a> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, &amp;ps);
00315 
00316             <span class="comment">/* Initialize drawing position to 1/4 inch from the top  */</span>
00317             <span class="comment">/* and from the left of the top, left corner of the      */</span>
00318             <span class="comment">/* client area of the main windows.                      */</span>
00319             nDrawX = GetDeviceCaps(hDC, LOGPIXELSX) / 4;   <span class="comment">/* 1/4 inch */</span>
00320             nDrawY = GetDeviceCaps(hDC, LOGPIXELSY) / 4;   <span class="comment">/* 1/4 inch */</span>
00321 
00322             <span class="keywordflow">if</span> ( NewFont == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> )
00323             {
00324                 hFont = CreateFontIndirect( &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a> );
00325                 <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> = SelectObject( hDC, hFont );
00326             }
00327 
00328             SetTextColor( hDC, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a17">crColor</a> );
00329 
00330             <span class="comment">// end painting and release hDC</span>
00331             EndPaint( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, &amp;ps );
00332             <span class="keywordflow">break</span>;
00333 
00334 
00335         <span class="keywordflow">case</span> WM_COMMAND:           <span class="comment">/* message: command from application menu */</span>
00336 
00337             <span class="keywordflow">switch</span>( LOWORD( wParam ))
00338             {
00339                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a0">IDM_OPENFILE</a>:
00340                    lpProcOpen = MakeProcInstance((FARPROC)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a30">OpenFiles</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>);
00341 
00342                     DialogBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>,             <span class="comment">/* current instance         */</span>
00343                         <span class="stringliteral">"OPENFILES"</span>,             <span class="comment">/* resource to use          */</span>
00344                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,                    <span class="comment">/* parent handle            */</span>
00345                         (DLGPROC)lpProcOpen);    <span class="comment">/* About() instance address */</span>
00346 
00347                     FreeProcInstance(lpProcOpen);
00348                     <span class="keywordflow">break</span>;
00349 
00350                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a4">IDM_EXIT</a>:
00351                     <a class="code" href="../../d3/d8/client_8c.html#a122">PostQuitMessage</a>(0);
00352                     <span class="keywordflow">break</span>;
00353 
00354                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a6">IDM_CHOOSECOLOR</a>:
00355                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a79">ChooseNewColor</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ))
00356                         InvalidateRect( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00357                     <span class="keywordflow">break</span>;
00358 
00359                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a7">IDM_CHOOSEFONT</a>:
00360                     <span class="keywordflow">if</span> (NewFont = <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a78">ChooseNewFont</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ))
00361                         InvalidateRect( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00362 
00363                     <span class="keywordflow">break</span>;
00364 
00365                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a8">IDM_FINDTEXT</a>:
00366                     <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a81">CallFindText</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
00367                     <span class="keywordflow">break</span>;
00368 
00369                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a9">IDM_REPLACETEXT</a>:
00370                     <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a82">CallReplaceText</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
00371                     <span class="keywordflow">break</span>;
00372 
00373                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
00374                   <span class="comment">// enable the ChooseColor() option</span>
00375                     <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a6">IDM_CHOOSECOLOR</a>,
00376                             MF_BYCOMMAND | MF_ENABLED );
00377                     <span class="comment">// uncheck previous selection</span>
00378                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00379                     <span class="comment">//reset mode</span>
00380                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> = LOWORD(wParam);
00381                     <span class="comment">//check new selection</span>
00382                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a>, MF_CHECKED | MF_BYCOMMAND);
00383                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00384                     <span class="keywordflow">break</span>;
00385                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
00386                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
00387                     <span class="comment">// disable the ChooseColor() option</span>
00388                     <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a6">IDM_CHOOSECOLOR</a>,
00389                             MF_BYCOMMAND | MF_GRAYED );
00390                      <span class="comment">// uncheck previous selection</span>
00391                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00392                     <span class="comment">//reset mode</span>
00393                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> = LOWORD(wParam);
00394                     <span class="comment">//check new selection</span>
00395                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a>, MF_CHECKED | MF_BYCOMMAND);
00396                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00397                     <span class="keywordflow">break</span>;
00398 
00399                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a5">IDM_ENTERNEW</a>:
00400                     lpProcEnterNew = MakeProcInstance((FARPROC)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a35">EnterNew</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>);
00401 
00402                     <span class="keywordflow">if</span> (DialogBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>,                 <span class="comment">/* current instance         */</span>
00403                         <span class="stringliteral">"EnterNewBox"</span>,           <span class="comment">/* resource to use          */</span>
00404                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,                    <span class="comment">/* parent handle            */</span>
00405                         (DLGPROC)lpProcEnterNew) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
00406 
00407                         InvalidateRect( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00408 
00409                     FreeProcInstance(lpProcEnterNew);
00410                     <span class="keywordflow">break</span>;
00411 
00412                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a13">IDM_PERCEPUAL</a>:
00413                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a> = 0;
00414                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00415                     <span class="comment">//reset mode</span>
00416                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a> = LOWORD(wParam);
00417                     <span class="comment">//check new selection</span>
00418                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_CHECKED | MF_BYCOMMAND);
00419                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00420                     <span class="keywordflow">break</span>;
00421                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a14">IDM_COLOR</a>:
00422                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a> = 1;
00423                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00424                     <span class="comment">//reset mode</span>
00425                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a> = LOWORD(wParam);
00426                     <span class="comment">//check new selection</span>
00427                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_CHECKED | MF_BYCOMMAND);
00428                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00429                     <span class="keywordflow">break</span>;
00430                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a15">IDM_SATURATION</a>:
00431                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a> = 2;
00432                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00433                     <span class="comment">//reset mode</span>
00434                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a> = LOWORD(wParam);
00435                     <span class="comment">//check new selection</span>
00436                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a21">wIntentMode</a>, MF_CHECKED | MF_BYCOMMAND);
00437                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00438                     <span class="keywordflow">break</span>;
00439 
00440                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a16">IDM_ASCII</a>:
00441                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00442                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00443                     <span class="comment">//reset mode</span>
00444                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a> = LOWORD(wParam);
00445                     <span class="comment">//check new selection</span>
00446                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a>, MF_CHECKED | MF_BYCOMMAND);
00447                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00448                     <span class="keywordflow">break</span>;
00449                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a17">IDM_BINARY</a>:
00450                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00451                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00452                     <span class="comment">//reset mode</span>
00453                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a> = LOWORD(wParam);
00454                     <span class="comment">//check new selection</span>
00455                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a20">wAsciiMode</a>, MF_CHECKED | MF_BYCOMMAND);
00456                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00457                     <span class="keywordflow">break</span>;
00458                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a18">IDM_AUTO</a>:
00459                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a19">IDM_ABC</a>:
00460                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a20">IDM_DEFG</a>:
00461                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">wCSAMode</a>, MF_UNCHECKED | MF_BYCOMMAND);
00462                     <span class="comment">//reset mode</span>
00463                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">wCSAMode</a> = LOWORD(wParam);
00464                     <span class="comment">//check new selection</span>
00465                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">wCSAMode</a>, MF_CHECKED | MF_BYCOMMAND);
00466                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00467                     <span class="keywordflow">break</span>;
00468 
00469                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a21">IDM_INP_AUTO</a>:
00470                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a22">IDM_INP_GRAY</a>:
00471                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a23">IDM_INP_RGB</a>:
00472                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a24">IDM_INP_CMYK</a>:
00473                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">wInpDrvClrSp</a>, MF_UNCHECKED | MF_BYCOMMAND);
00474                     <span class="comment">//reset mode</span>
00475                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">wInpDrvClrSp</a> = LOWORD(wParam);
00476                     <span class="comment">//check new selection</span>
00477                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">wInpDrvClrSp</a>, MF_CHECKED | MF_BYCOMMAND);
00478                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00479                     <span class="keywordflow">break</span>;
00480 
00481                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a25">IDM_CSA</a>:
00482                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a26">IDM_CRD</a>:
00483                                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a28">IDM_PROFCRD</a>:
00484                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a27">IDM_INTENT</a>:
00485                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a>, MF_UNCHECKED | MF_BYCOMMAND);
00486                     <span class="comment">//reset mode</span>
00487                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> = LOWORD(wParam);
00488                     <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a26">IDM_CRD</a>) || (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a27">IDM_INTENT</a>))
00489                     {
00490                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a21">IDM_INP_AUTO</a>, MF_BYCOMMAND | MF_GRAYED );
00491                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a22">IDM_INP_GRAY</a>, MF_BYCOMMAND | MF_GRAYED );
00492                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a23">IDM_INP_RGB</a>,  MF_BYCOMMAND | MF_GRAYED );
00493                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a24">IDM_INP_CMYK</a>, MF_BYCOMMAND | MF_GRAYED );
00494                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a18">IDM_AUTO</a>, MF_BYCOMMAND | MF_GRAYED );
00495                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a19">IDM_ABC</a>,  MF_BYCOMMAND | MF_GRAYED );
00496                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a20">IDM_DEFG</a>, MF_BYCOMMAND | MF_GRAYED );
00497                     }
00498                     <span class="keywordflow">else</span>
00499                     {
00500                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a21">IDM_INP_AUTO</a>, MF_BYCOMMAND | MF_ENABLED );
00501                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a22">IDM_INP_GRAY</a>, MF_BYCOMMAND | MF_ENABLED );
00502                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a23">IDM_INP_RGB</a>,  MF_BYCOMMAND | MF_ENABLED );
00503                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a24">IDM_INP_CMYK</a>, MF_BYCOMMAND | MF_ENABLED );
00504                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a18">IDM_AUTO</a>, MF_BYCOMMAND | MF_ENABLED );
00505                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a19">IDM_ABC</a>,  MF_BYCOMMAND | MF_ENABLED );
00506                         <a class="code" href="../../d3/d9/client_2wow_8c.html#a28">EnableMenuItem</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>), <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a20">IDM_DEFG</a>, MF_BYCOMMAND | MF_ENABLED );
00507                     }
00508 
00509                     <span class="comment">//check new selection</span>
00510                     <a class="code" href="../../d7/d7/menuc_8c.html#a0">CheckMenuItem</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a7">GetMenu</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a>, MF_CHECKED | MF_BYCOMMAND);
00511                     <a class="code" href="../../d3/d8/client_8c.html#a97">DrawMenuBar</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>);
00512                     <span class="keywordflow">break</span>;
00513 
00514                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a29">IDM_ABOUT</a>:
00515                     lpProcAbout = MakeProcInstance((FARPROC)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a36">About</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>);
00516 
00517                     DialogBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>,             <span class="comment">/* current instance         */</span>
00518                         <span class="stringliteral">"AboutBox"</span>,              <span class="comment">/* resource to use          */</span>
00519                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>,                    <span class="comment">/* parent handle            */</span>
00520                         (DLGPROC)lpProcAbout);   <span class="comment">/* About() instance address */</span>
00521 
00522                     FreeProcInstance(lpProcAbout);
00523                     <span class="keywordflow">break</span>;
00524 
00525                 <span class="keywordflow">default</span>:
00526                     <span class="keywordflow">return</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, message, wParam, lParam));
00527 
00528             }
00529             <span class="keywordflow">break</span>;
00530 
00531         <span class="keywordflow">case</span> WM_DESTROY:                  <span class="comment">/* message: window being destroyed */</span>
00532             <a class="code" href="../../d3/d8/client_8c.html#a122">PostQuitMessage</a>(0);
00533             <span class="keywordflow">break</span>;
00534 
00535 
00536         <span class="keywordflow">default</span>:
00537             <span class="comment">// Handle the special findreplace message (FindReplaceMsg) which</span>
00538             <span class="comment">// was registered at initialization time.</span>
00539             <span class="keywordflow">if</span> ( message == <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a9">FindReplaceMsg</a> )
00540             {
00541                 <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a> = (LPFINDREPLACE) lParam )
00542                     {
00543                     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; FR_DIALOGTERM )  <span class="comment">// terminating dialog</span>
00544                         <span class="keywordflow">return</span> (0);
00545                     <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a77">SearchFile</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a> );
00546                     InvalidateRect( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00547                     }
00548                 <span class="keywordflow">return</span> (0);
00549             }
00550 
00551             <span class="keywordflow">return</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a15">DefWindowProc</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, message, wParam, lParam));
00552     }
00553     <span class="keywordflow">return</span> (0);
00554 }
00555 
00556 
00557 <span class="comment">/****************************************************************************</span>
00558 <span class="comment">*</span>
00559 <span class="comment">*    FUNCTION: EnterNew(HWND, UINT, WPARAM, LPARAM)</span>
00560 <span class="comment">*</span>
00561 <span class="comment">*    PURPOSE:  Processes messages for "EnterNew" dialog box</span>
00562 <span class="comment">*</span>
00563 <span class="comment">*    COMMENTS:</span>
00564 <span class="comment">*</span>
00565 <span class="comment">*        This function allows the user to enter new text in the current</span>
00566 <span class="comment">*        window.  This text is stored in the global current buffer.</span>
00567 <span class="comment">*</span>
00568 <span class="comment">****************************************************************************/</span>
00569 
<a name="l00570"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a63">00570</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a63">EnterNew</a>(
00571         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
00572         UINT message,             <span class="comment">/* type of message                 */</span>
00573         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
00574         LPARAM lParam)
00575 {
00576     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Buf[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>-1];
00577 
00578     <span class="keywordflow">switch</span> (message)
00579     {
00580         <span class="keywordflow">case</span> WM_INITDIALOG:                <span class="comment">/* message: initialize dialog box */</span>
00581             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00582 
00583         <span class="keywordflow">case</span> WM_COMMAND:                      <span class="comment">/* message: received a command */</span>
00584             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
00585             {
00586                 <a class="code" href="../../d5/d9/cltxt_8h.html#a19">GetDlgItemText</a>( hDlg, <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a30">IDEDIT</a>, Buf, <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>-1);
00587                 strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, Buf);
00588                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
00589                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>);
00590                 <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>( hDlg, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00591                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00592             }
00593             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LOWORD(wParam) == IDCANCEL)
00594             {   <span class="comment">/* System menu close command? */</span>
00595                 <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hDlg, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);       <span class="comment">/* Exits the dialog box        */</span>
00596                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00597             }
00598             <span class="keywordflow">break</span>;
00599     }
00600     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);                           <span class="comment">/* Didn't process a message    */</span>
00601 
00602     <span class="comment">// avoid compiler warnings at W3</span>
00603     lParam;
00604 }
00605 
00606 
00607 <span class="comment">/****************************************************************************</span>
00608 <span class="comment">*</span>
00609 <span class="comment">*    FUNCTION: About(HWND, UINT, WPARAM, LPARAM)</span>
00610 <span class="comment">*</span>
00611 <span class="comment">*    PURPOSE:  Processes messages for "About" dialog box</span>
00612 <span class="comment">*</span>
00613 <span class="comment">*    COMMENTS:</span>
00614 <span class="comment">*</span>
00615 <span class="comment">*       No initialization is needed for this particular dialog box, but TRUE</span>
00616 <span class="comment">*       must be returned to Windows.</span>
00617 <span class="comment">*</span>
00618 <span class="comment">*       Wait for user to click on "Ok" button, then close the dialog box.</span>
00619 <span class="comment">*</span>
00620 <span class="comment">****************************************************************************/</span>
00621 
<a name="l00622"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a62">00622</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a62">About</a>(
00623         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
00624         UINT message,             <span class="comment">/* type of message                 */</span>
00625         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
00626         LPARAM lParam)
00627 {
00628     <span class="keywordflow">switch</span> (message)
00629     {
00630         <span class="keywordflow">case</span> WM_INITDIALOG:                <span class="comment">/* message: initialize dialog box */</span>
00631             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00632 
00633         <span class="keywordflow">case</span> WM_COMMAND:                      <span class="comment">/* message: received a command */</span>
00634             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK          <span class="comment">/* "OK" box selected?        */</span>
00635                 || LOWORD(wParam) == IDCANCEL) {        <span class="comment">/* System menu close command? */</span>
00636                 <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hDlg, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);        <span class="comment">/* Exits the dialog box        */</span>
00637                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00638             }
00639             <span class="keywordflow">break</span>;
00640     }
00641     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);                           <span class="comment">/* Didn't process a message    */</span>
00642 
00643     <span class="comment">// avoid compiler warnings at W3</span>
00644     lParam;
00645 }
00646 
00647 <span class="comment">/****************************************************************************</span>
00648 <span class="comment">*</span>
00649 <span class="comment">*    FUNCTION: FileOpenHookProc(HWND, UINT, WPARAM, LPARAM)</span>
00650 <span class="comment">*</span>
00651 <span class="comment">*    PURPOSE:  Processes messages for GetFileNameOpen() common dialog box</span>
00652 <span class="comment">*</span>
00653 <span class="comment">*    COMMENTS:</span>
00654 <span class="comment">*</span>
00655 <span class="comment">*        This function will prompt the user if they are sure they want</span>
00656 <span class="comment">*        to open the file if the OFN_ENABLEHOOK flag is set.</span>
00657 <span class="comment">*</span>
00658 <span class="comment">*        If the current option mode is CUSTOM, the user is allowed to check</span>
00659 <span class="comment">*        a box in the dialog prompting them whether or not they would like</span>
00660 <span class="comment">*        the file created.  If they check this box, the file is created and</span>
00661 <span class="comment">*        the string 'Empty' is written to it.</span>
00662 <span class="comment">*</span>
00663 <span class="comment">*    RETURN VALUES:</span>
00664 <span class="comment">*        TRUE - User chose 'Yes' from the "Are you sure message box".</span>
00665 <span class="comment">*        FALSE - User chose 'No'; return to the dialog box.</span>
00666 <span class="comment">*</span>
00667 <span class="comment">****************************************************************************/</span>
00668 
<a name="l00669"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a64">00669</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a64">FileOpenHookProc</a>(
00670         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
00671         UINT message,             <span class="comment">/* type of message                 */</span>
00672         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
00673         LPARAM lParam)
00674 {
00675 
00676     <span class="keywordtype">int</span> hFile;
00677     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> szTempText[256];
00678     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> szString[256];
00679     OFSTRUCT OfStruct;
00680 
00681     <span class="keywordflow">switch</span> (message)
00682     {
00683 
00684         <span class="keywordflow">case</span> WM_COMMAND:
00685             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
00686             {
00687                 <a class="code" href="../../d5/d9/cltxt_8h.html#a19">GetDlgItemText</a>( hDlg, edt1, szTempText,
00688                         <span class="keyword">sizeof</span>( szTempText ) - 1);
00689 
00690                 <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags &amp; OFN_PATHMUSTEXIST )
00691                 {
00692                     <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( szString, <span class="stringliteral">"Are you sure you want to open %s?"</span>,
00693                         szTempText);
00694                     <span class="keywordflow">if</span> ( MessageBox( hDlg, szString, <span class="stringliteral">"Information"</span>,
00695                         MB_YESNO ) == IDYES )
00696 
00697                         <span class="keywordflow">break</span>;
00698                     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00699                 }
00700 
00701                 <span class="comment">// check to see if the Create File box has been checked</span>
00702                 <span class="keywordflow">if</span> ( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx2),
00703                     BM_GETCHECK, 0, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> )) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> )
00704                 {
00705                     <span class="comment">// if so, create the file</span>
00706                     <span class="keywordflow">if</span> ((hFile = OpenFile(szTempText,
00707                         &amp;OfStruct,
00708                         OF_CREATE)) == -1)
00709                     {
00710                         MessageBox( hDlg,
00711                             <span class="stringliteral">"Directory could not be created."</span>,
00712                             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00713                             MB_OK );
00714                         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00715                     }
00716 
00717                     strcpy(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, <span class="stringliteral">"Empty"</span>);
00718                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
00719                     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>);
00720                     <span class="keywordflow">if</span> (_lwrite( hFile, (LPSTR)&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>[0], <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>)==-1)
00721                         MessageBox( hDlg, <span class="stringliteral">"Error writing file."</span>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, MB_OK );
00722 
00723                     <span class="comment">// close the file</span>
00724                     _lclose( hFile );
00725                 }
00726 
00727             }
00728             <span class="keywordflow">break</span>;
00729     }
00730     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00731 
00732     <span class="comment">// avoid compiler warnings at W3</span>
00733     lParam;
00734 
00735 }
00736 
00737 <span class="comment">/****************************************************************************</span>
00738 <span class="comment">*</span>
00739 <span class="comment">*    FUNCTION: OpenNewFile(HWND)</span>
00740 <span class="comment">*</span>
00741 <span class="comment">*    PURPOSE:  Invokes common dialog function to open a file and opens it.</span>
00742 <span class="comment">*</span>
00743 <span class="comment">*    COMMENTS:</span>
00744 <span class="comment">*</span>
00745 <span class="comment">*        This function initializes the OPENFILENAME structure and calls</span>
00746 <span class="comment">*        the GetOpenFileName() common dialog function.  This function will</span>
00747 <span class="comment">*        work regardless of the mode: standard, using a hook or using a</span>
00748 <span class="comment">*        customized template.</span>
00749 <span class="comment">*</span>
00750 <span class="comment">*    RETURN VALUES:</span>
00751 <span class="comment">*        TRUE - The file was opened successfully and read into the buffer.</span>
00752 <span class="comment">*        FALSE - No files were opened.</span>
00753 <span class="comment">*</span>
00754 <span class="comment">****************************************************************************/</span>
<a name="l00755"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a74">00755</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a74">OpenNewFile</a>( HWND hWnd )
00756 {
00757    strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">szFile</a>, <span class="stringliteral">""</span>);
00758    strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">szFileTitle</a>, <span class="stringliteral">""</span>);
00759 
00760    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lStructSize       = <span class="keyword">sizeof</span>(OPENFILENAME);
00761    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.hwndOwner         = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00762    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.hInstance         = (HANDLE) <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00763    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFilter       = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a5">szFilter</a>;
00764    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrCustomFilter = (LPSTR) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00765    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxCustFilter    = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00766    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFilterIndex      = 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00767    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile         = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">szFile</a>;
00768    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxFile          = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">szFile</a>);
00769    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle    = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">szFileTitle</a>;
00770    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxFileTitle     = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">szFileTitle</a>);
00771    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrInitialDir   = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00772    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrTitle        = <span class="stringliteral">"Open a File"</span>;
00773    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFileOffset       = 0;
00774    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFileExtension    = 0;
00775    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrDefExt       = <span class="stringliteral">"*.icm"</span>;
00776    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lCustData         = 0;
00777 
00778    <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
00779    {
00780         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
00781             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = OFN_SHOWHELP | OFN_PATHMUSTEXIST |
00782                 OFN_FILEMUSTEXIST | OFN_HIDEREADONLY;
00783             <span class="keywordflow">break</span>;
00784 
00785         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
00786             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = OFN_SHOWHELP | OFN_PATHMUSTEXIST |
00787                 OFN_FILEMUSTEXIST | OFN_HIDEREADONLY | OFN_ENABLEHOOK;
00788             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpfnHook = (LPOFNHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a37">FileOpenHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00789             <span class="keywordflow">break</span>;
00790 
00791         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
00792             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = OFN_SHOWHELP | OFN_ENABLEHOOK |
00793                 OFN_HIDEREADONLY | OFN_ENABLETEMPLATE;
00794             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpfnHook = (LPOFNHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a37">FileOpenHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00795             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpTemplateName = (LPSTR)MAKEINTRESOURCE(FILEOPENORD);
00796             <span class="keywordflow">break</span>;
00797    }
00798 
00799    <span class="keywordflow">if</span> (GetOpenFileName(&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>))
00800    {
00801    }
00802    <span class="keywordflow">else</span>
00803    {
00804       <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
00805       <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00806    }
00807    <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00808 }
00809 
00810 <span class="comment">/****************************************************************************</span>
00811 <span class="comment">*</span>
00812 <span class="comment">*    FUNCTION: SaveToFile( HWND )</span>
00813 <span class="comment">*</span>
00814 <span class="comment">*    PURPOSE:  Saves the current buffer to the current file.</span>
00815 <span class="comment">*</span>
00816 <span class="comment">*    COMMENTS:</span>
00817 <span class="comment">*</span>
00818 <span class="comment">*        This function will save the current text buffer into the file</span>
00819 <span class="comment">*        specified from the GetSaveFileName() common dialog function.</span>
00820 <span class="comment">*</span>
00821 <span class="comment">*    RETURN VALUES:</span>
00822 <span class="comment">*        TRUE - The file was saved successfully.</span>
00823 <span class="comment">*        FALSE - The buffer was not saved to a file.</span>
00824 <span class="comment">*</span>
00825 <span class="comment">****************************************************************************/</span>
<a name="l00826"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a75">00826</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a75">SaveToFile</a>( HWND hWnd )
00827 {
00828    <span class="keywordtype">int</span> hFile;
00829    OFSTRUCT OfStruct;
00830    WORD wStyle;
00831    <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> buf[256];
00832 
00833    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags | OFN_FILEMUSTEXIST)
00834         wStyle = OF_READWRITE;
00835    <span class="keywordflow">else</span>
00836         wStyle = OF_READWRITE | OF_CREATE;
00837 
00838    <span class="keywordflow">if</span> ((hFile = OpenFile(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile, &amp;OfStruct,
00839          wStyle)) == -1)
00840    {
00841       <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( buf, <span class="stringliteral">"Could not create file %s"</span>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile );
00842       MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, buf, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, MB_OK );
00843       <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00844    }
00845    <span class="comment">// write it's contents into a file</span>
00846    <span class="keywordflow">if</span> (_lwrite( hFile, (LPSTR)&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>[0], <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a>)==-1)
00847    {
00848       MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, <span class="stringliteral">"Error writing file."</span>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, MB_OK );
00849       <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00850    }
00851 
00852    <span class="comment">// close the file</span>
00853    _lclose( hFile );
00854 
00855    <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( buf, <span class="stringliteral">"%s"</span>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile );
00856    MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, buf, <span class="stringliteral">"File Saved"</span>, MB_OK );
00857    <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00858 }
00859 
00860 
00861 <span class="comment">/****************************************************************************</span>
00862 <span class="comment">*</span>
00863 <span class="comment">*    FUNCTION: FileSaveHookProc(HWND, UINT, WPARAM, LPARAM)</span>
00864 <span class="comment">*</span>
00865 <span class="comment">*    PURPOSE:  Processes messages for FileSave common dialog box</span>
00866 <span class="comment">*</span>
00867 <span class="comment">*    COMMENTS:</span>
00868 <span class="comment">*</span>
00869 <span class="comment">*        This hook procedure prompts the user if they want to save the</span>
00870 <span class="comment">*        current file.  If they choose YES, the file is saved and the dialog</span>
00871 <span class="comment">*        is dismissed.  If they choose NO, they are returned to the</span>
00872 <span class="comment">*        GetSaveFileName() common dialog.</span>
00873 <span class="comment">*</span>
00874 <span class="comment">*        If the current mode calls for a customized template, this function</span>
00875 <span class="comment">*        will test the 'Create File?' checkbox.  If the user choses no, the</span>
00876 <span class="comment">*        OFN_FILEMUSTEXIST flag is set.</span>
00877 <span class="comment">*</span>
00878 <span class="comment">*    RETURN VALUES:</span>
00879 <span class="comment">*        TRUE - User chose 'Yes' from the "Are you sure message box".</span>
00880 <span class="comment">*        FALSE - User chose 'No'; return to the dialog box.</span>
00881 <span class="comment">*</span>
00882 <span class="comment">*</span>
00883 <span class="comment">****************************************************************************/</span>
00884 
<a name="l00885"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a65">00885</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a65">FileSaveHookProc</a>(
00886         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
00887         UINT message,             <span class="comment">/* type of message                 */</span>
00888         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
00889         LPARAM lParam)
00890 {
00891     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> szTempText[256];
00892     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> szString[256];
00893 
00894     <span class="keywordflow">switch</span> (message)
00895     {
00896         <span class="keywordflow">case</span> WM_COMMAND:
00897             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
00898             {
00899                 <a class="code" href="../../d5/d9/cltxt_8h.html#a19">GetDlgItemText</a>( hDlg, edt1, szTempText,
00900                     <span class="keyword">sizeof</span>( szTempText ) - 1);
00901                 <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags &amp; OFN_ENABLETEMPLATE )
00902                 {
00903                     <span class="comment">// check to see if the Create File box has been checked</span>
00904                     <span class="keywordflow">if</span> ( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx2),
00905                         BM_GETCHECK, 0, 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> )) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> )
00906                         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags |= OFN_FILEMUSTEXIST;
00907                     <span class="keywordflow">break</span>;
00908 
00909                 }
00910                 <span class="keywordflow">else</span>
00911                 {
00912                     <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( szString, <span class="stringliteral">"Are you sure you want to save %s?"</span>,
00913                         szTempText);
00914                     <span class="keywordflow">if</span> ( MessageBox( hDlg, szString, <span class="stringliteral">"Information"</span>,
00915                         MB_YESNO ) == IDYES )
00916                         <span class="keywordflow">break</span>;
00917                     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00918                 }
00919 
00920             }
00921             <span class="keywordflow">break</span>;
00922     }
00923     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00924 
00925     <span class="comment">// avoid compiler warnings at W3</span>
00926     lParam;
00927 
00928 }
00929 
00930 <span class="comment">/****************************************************************************</span>
00931 <span class="comment">*</span>
00932 <span class="comment">*    FUNCTION: SaveAs(HWND)</span>
00933 <span class="comment">*</span>
00934 <span class="comment">*    PURPOSE:  Invokes the common dialog function to save the current</span>
00935 <span class="comment">*              buffer to a file.</span>
00936 <span class="comment">*    COMMENTS:</span>
00937 <span class="comment">*</span>
00938 <span class="comment">*        This function initializes the OPENFILENAME structure for any</span>
00939 <span class="comment">*        mode selected by the user: standard, using a hook or using a</span>
00940 <span class="comment">*        customized template.  It then calls the GetSaveFileName()</span>
00941 <span class="comment">*        common dialog function.</span>
00942 <span class="comment">*</span>
00943 <span class="comment">*    RETURN VALUES:</span>
00944 <span class="comment">*        TRUE - The file was saved successfully.</span>
00945 <span class="comment">*        FALSE - The buffer was not saved to a file.</span>
00946 <span class="comment">*</span>
00947 <span class="comment">****************************************************************************/</span>
<a name="l00948"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a76">00948</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a76">SaveAs</a>( HWND hWnd )
00949 {
00950    <span class="keywordtype">int</span>      i;
00951 
00952 <span class="comment">//   strcpy( szFile, "");</span>
00953 <span class="comment">//   strcpy( szFileTitle, "");</span>
00954 
00955    <span class="keywordflow">for</span> ( i = lstrlen(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle); i &gt; 0; i--)
00956    {
00957        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i] == <span class="charliteral">'.'</span>) <span class="keywordflow">break</span>;
00958    }
00959    i ++;
00960    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a25">IDM_CSA</a>)
00961    {
00962         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'C'</span>;
00963         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'S'</span>;
00964         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'A'</span>;
00965         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i] = 0;
00966    }
00967    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a26">IDM_CRD</a>) ||
00968                 (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a28">IDM_PROFCRD</a>))
00969    {
00970         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'C'</span>;
00971         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'R'</span>;
00972         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'D'</span>;
00973         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i] = 0;
00974    }
00975    <span class="keywordflow">else</span>
00976    {
00977         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'I'</span>;
00978         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'N'</span>;
00979         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i++] = <span class="charliteral">'T'</span>;
00980         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle[i] = 0;
00981    }
00982    strcpy(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFileTitle);
00983 
00984    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lStructSize       = <span class="keyword">sizeof</span>(OPENFILENAME);
00985    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.hwndOwner         = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
00986    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.hInstance         = (HANDLE) <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
00987    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFilter       = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a6">szSaveFilter</a>;
00988    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrCustomFilter = (LPSTR) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00989    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxCustFilter    = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00990    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFilterIndex      = 1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00991    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxFile          = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a3">szFile</a>);
00992    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nMaxFileTitle     = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a4">szFileTitle</a>);
00993    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrInitialDir   = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00994    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrTitle        = <span class="stringliteral">"Save File As"</span>;
00995    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFileOffset       = 0;
00996    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.nFileExtension    = 0;
00997    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrDefExt       = <span class="stringliteral">"*.csa"</span>;
00998    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lCustData         = 0;
00999 
01000    <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01001    {
01002         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01003             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
01004             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpfnHook = (LPOFNHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01005             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01006             <span class="keywordflow">break</span>;
01007 
01008         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01009             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = OFN_ENABLEHOOK;
01010             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpfnHook = (LPOFNHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a40">FileSaveHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01011             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01012             <span class="keywordflow">break</span>;
01013 
01014         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01015             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.Flags = OFN_ENABLEHOOK | OFN_ENABLETEMPLATE;
01016             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpfnHook = (LPOFNHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a40">FileSaveHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01017             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpTemplateName = (LPSTR)MAKEINTRESOURCE(FILEOPENORD);
01018             <span class="keywordflow">break</span>;
01019    }
01020 
01021    <span class="keywordflow">if</span> ( GetSaveFileName( &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a> ))
01022    {
01023         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01024    }
01025    <span class="keywordflow">else</span>
01026    {
01027         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01028         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01029    }
01030 
01031    <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01032 }
01033 
01034 
01035 <span class="comment">/****************************************************************************</span>
01036 <span class="comment">*</span>
01037 <span class="comment">*    FUNCTION: ChooseColorHookProc(HWND, UINT, WPARAM, LPARAM)</span>
01038 <span class="comment">*</span>
01039 <span class="comment">*    PURPOSE:  Processes messages for ChooseColor common dialog box</span>
01040 <span class="comment">*</span>
01041 <span class="comment">*    COMMENTS:</span>
01042 <span class="comment">*</span>
01043 <span class="comment">*        This hook procedure simply prompts the user whether or not they</span>
01044 <span class="comment">*        want to change the color.  if they choose YES, the color of the</span>
01045 <span class="comment">*        text will be changed and the dialog will be dismissed.  If they</span>
01046 <span class="comment">*        choose NO, the color will not be changed and the user will be</span>
01047 <span class="comment">*        returned to the dialog</span>
01048 <span class="comment">*</span>
01049 <span class="comment">*    RETURN VALUES:</span>
01050 <span class="comment">*        TRUE - User chose 'Yes' from the "Are you sure message box".</span>
01051 <span class="comment">*        FALSE - User chose 'No'; return to the dialog box.</span>
01052 <span class="comment">*</span>
01053 <span class="comment">****************************************************************************/</span>
01054 
<a name="l01055"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a66">01055</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a66">ChooseColorHookProc</a>(
01056         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01057         UINT message,             <span class="comment">/* type of message                 */</span>
01058         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01059         LPARAM lParam)
01060 {
01061 
01062     <span class="keywordflow">switch</span> (message)
01063     {
01064         <span class="keywordflow">case</span> WM_COMMAND:
01065             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
01066             {
01067                 <span class="keywordflow">if</span> (MessageBox( hDlg, <span class="stringliteral">"Are you sure you want to change the color?"</span>,
01068                     <span class="stringliteral">"Information"</span>, MB_YESNO ) == IDYES )
01069                     <span class="keywordflow">break</span>;
01070                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01071 
01072             }
01073             <span class="keywordflow">break</span>;
01074     }
01075     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01076 
01077     <span class="comment">// avoid compiler warnings at W3</span>
01078     lParam;
01079 
01080 }
01081 
01082 
01083 <span class="comment">/****************************************************************************</span>
01084 <span class="comment">*</span>
01085 <span class="comment">*    FUNCTION: ChooseNewColor(HWND)</span>
01086 <span class="comment">*</span>
01087 <span class="comment">*    PURPOSE:  Invokes common dialog function to chose a new color.</span>
01088 <span class="comment">*</span>
01089 <span class="comment">*    COMMENTS:</span>
01090 <span class="comment">*        This function initializes the CHOOSECOLOR structure for any</span>
01091 <span class="comment">*        mode the user chooses: standard, using a hook or using a</span>
01092 <span class="comment">*        customized template.  It then calls the ChooseColor()</span>
01093 <span class="comment">*        common dialog function.</span>
01094 <span class="comment">*</span>
01095 <span class="comment">*    RETURN VALUES:</span>
01096 <span class="comment">*        TRUE - A new color was chosen.</span>
01097 <span class="comment">*        FALSE - No new color was chosen.</span>
01098 <span class="comment">*</span>
01099 <span class="comment">****************************************************************************/</span>
<a name="l01100"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a79">01100</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a79">ChooseNewColor</a>( HWND hWnd )
01101 {
01102 
01103     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwColor;
01104     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCustClrs[16];
01105     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSetColor = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01106     <span class="keywordtype">int</span> i;
01107 
01108 
01109     <span class="keywordflow">for</span> (i=0; i &lt; 15; i++)
01110         dwCustClrs[i] = RGB( 255, 255, 255);
01111 
01112     dwColor = RGB( 0, 0, 0 );
01113 
01114     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lStructSize = <span class="keyword">sizeof</span>(CHOOSECOLOR);
01115     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
01116     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.hInstance = (HANDLE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
01117     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.rgbResult = dwColor;
01118     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lpCustColors = (LPDWORD)dwCustClrs;
01119     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lCustData = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
01120 
01121     <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01122     {
01123         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01124         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01125             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.Flags = CC_PREVENTFULLOPEN | CC_ENABLEHOOK;
01126             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lpfnHook = (LPCCHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a42">ChooseColorHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01127             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01128             <span class="keywordflow">break</span>;
01129 
01130         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01131             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.Flags = CC_PREVENTFULLOPEN;
01132             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lpfnHook = (LPCCHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01133             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01134             <span class="keywordflow">break</span>;
01135 
01136 
01137    }
01138 
01139    <span class="keywordflow">if</span> ( fSetColor = ChooseColor( &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a> ))
01140    {
01141        <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a17">crColor</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a16">chsclr</a>.rgbResult;
01142        <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01143    }
01144    <span class="keywordflow">else</span>
01145    {
01146        <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01147        <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01148    }
01149 }
01150 
01151 
01152 <span class="comment">/****************************************************************************</span>
01153 <span class="comment">*</span>
01154 <span class="comment">*    FUNCTION: ChooseFontHookProc(HWND, UINT, WPARAM, LPARAM)</span>
01155 <span class="comment">*</span>
01156 <span class="comment">*    PURPOSE:  Processes messages for ChooseFont common dialog box</span>
01157 <span class="comment">*</span>
01158 <span class="comment">*    COMMENTS:</span>
01159 <span class="comment">*</span>
01160 <span class="comment">*        This hook procedure simply prompts the user whether or not they</span>
01161 <span class="comment">*        want to change the font.  if they choose YES, the color of the</span>
01162 <span class="comment">*        font will be changed and the dialog will be dismissed.  If they</span>
01163 <span class="comment">*        choose NO, the font will not be changed and the user will be</span>
01164 <span class="comment">*        returned to the dialog</span>
01165 <span class="comment">*</span>
01166 <span class="comment">*        If the current mode is set to use a customized template, the</span>
01167 <span class="comment">*        color drop down combo box is hidden.</span>
01168 <span class="comment">*</span>
01169 <span class="comment">*    RETURN VALUES:</span>
01170 <span class="comment">*        TRUE - Change the font.</span>
01171 <span class="comment">*        FALSE - Return to the dialog box.</span>
01172 <span class="comment">*</span>
01173 <span class="comment">****************************************************************************/</span>
01174 
<a name="l01175"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a67">01175</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a67">ChooseFontHookProc</a>(
01176         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01177         UINT message,             <span class="comment">/* type of message                 */</span>
01178         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01179         LPARAM lParam)
01180 {
01181 
01182     <span class="keywordflow">switch</span> (message)
01183     {
01184         <span class="keywordflow">case</span> WM_INITDIALOG:
01185             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.Flags &amp; CF_ENABLETEMPLATE)
01186             {
01187                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, stc4), SW_HIDE);
01188                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, cmb4), SW_HIDE);
01189             }
01190             <span class="keywordflow">break</span>;
01191 
01192         <span class="keywordflow">case</span> WM_COMMAND:
01193             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
01194             {
01195                 <span class="keywordflow">if</span> (MessageBox( hDlg, <span class="stringliteral">"Are you sure you want to change the font?"</span>,
01196                     <span class="stringliteral">"Information"</span>, MB_YESNO ) == IDYES )
01197                     <span class="keywordflow">break</span>;
01198                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01199 
01200             }
01201             <span class="keywordflow">break</span>;
01202     }
01203     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01204 
01205     <span class="comment">// avoid compiler warnings at W3</span>
01206     lParam;
01207 
01208 }
01209 
01210 
01211 <span class="comment">/****************************************************************************</span>
01212 <span class="comment">*</span>
01213 <span class="comment">*    FUNCTION: ChooseNewFont(HWND)</span>
01214 <span class="comment">*</span>
01215 <span class="comment">*    PURPOSE:  Invokes common dialog function to chose a new font.</span>
01216 <span class="comment">*</span>
01217 <span class="comment">*    COMMENTS:</span>
01218 <span class="comment">*</span>
01219 <span class="comment">*        This function initializes the CHOOSEFONT structure for any mode</span>
01220 <span class="comment">*        the user chooses: standard, using a hook or using a customized</span>
01221 <span class="comment">*        template.  It then calls the ChooseFont() common dialog function.</span>
01222 <span class="comment">*</span>
01223 <span class="comment">*    RETURN VALUES:</span>
01224 <span class="comment">*        TRUE - A new font was chosen.</span>
01225 <span class="comment">*        FALSE - No new font was chosen.</span>
01226 <span class="comment">*</span>
01227 <span class="comment">****************************************************************************/</span>
<a name="l01228"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a78">01228</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a78">ChooseNewFont</a>( HWND hWnd )
01229 {
01230 
01231    HDC hDC;
01232 
01233    hDC = <a class="code" href="../../d3/d4/w32_2ntuser_2client_2nt6_2pch_8h.html#a1">GetDC</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01234    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.hDC = CreateCompatibleDC( hDC );
01235    <a class="code" href="../../d3/d8/client_8c.html#a45">ReleaseDC</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, hDC );
01236    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lStructSize = <span class="keyword">sizeof</span>(CHOOSEFONT);
01237    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
01238    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpLogFont = &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a18">lf</a>;
01239    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS;
01240    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.rgbColors = RGB(0, 255, 255);
01241    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lCustData = 0;
01242    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.hInstance = (HANDLE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
01243    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpszStyle = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01244    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.nFontType = SCREEN_FONTTYPE;
01245    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.nSizeMin = 0;
01246    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.nSizeMax = 0;
01247 
01248    <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01249    {
01250         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01251             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS;
01252             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpfnHook = (LPCFHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01253             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01254             <span class="keywordflow">break</span>;
01255 
01256         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01257             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS | CF_ENABLEHOOK;
01258             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpfnHook = (LPCFHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a44">ChooseFontHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01259             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01260             <span class="keywordflow">break</span>;
01261 
01262         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01263             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.Flags = CF_SCREENFONTS | CF_EFFECTS | CF_ENABLEHOOK |
01264               CF_ENABLETEMPLATE;
01265             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpfnHook = (LPCFHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a44">ChooseFontHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01266             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a>.lpTemplateName = (LPSTR)MAKEINTRESOURCE(FORMATDLGORD31);
01267             <span class="keywordflow">break</span>;
01268    }
01269 
01270 
01271    <span class="keywordflow">if</span>( ChooseFont( &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a15">chf</a> ) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> )
01272    {
01273         DeleteDC( hDC );
01274         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01275         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01276    }
01277 
01278 
01279    DeleteDC( hDC );
01280 
01281    <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01282 }
01283 
01284 <span class="comment">/****************************************************************************</span>
01285 <span class="comment">*</span>
01286 <span class="comment">*    FUNCTION: PrintSetupHookProc(HWND, UINT, WPARAM, LPARAM)</span>
01287 <span class="comment">*</span>
01288 <span class="comment">*    PURPOSE:  Processes messages for PrintDlg setup common dialog box</span>
01289 <span class="comment">*</span>
01290 <span class="comment">*    COMMENTS:</span>
01291 <span class="comment">*</span>
01292 <span class="comment">*        This function processes the hook and customized template for the</span>
01293 <span class="comment">*        print setup common dialog box.  If the customized template has</span>
01294 <span class="comment">*        been provided, the 'Options' pushbutton is hidden.  If the hook only mode</span>
01295 <span class="comment">*        is chosen, a message box is displayed informing the user that the</span>
01296 <span class="comment">*        hook has been installed.</span>
01297 <span class="comment">*</span>
01298 <span class="comment">*    RETURN VALUES:</span>
01299 <span class="comment">*        TRUE - Continue.</span>
01300 <span class="comment">*        FALSE - Return to the dialog box.</span>
01301 <span class="comment">*</span>
01302 <span class="comment">****************************************************************************/</span>
01303 
<a name="l01304"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a71">01304</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a71">PrintSetupHookProc</a>(
01305         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01306         UINT message,             <span class="comment">/* type of message                 */</span>
01307         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01308         LPARAM lParam)
01309 {
01310 
01311     <span class="keywordflow">switch</span> (message)
01312     {
01313         <span class="keywordflow">case</span> WM_INITDIALOG:
01314             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.Flags &amp; PD_ENABLESETUPTEMPLATE )
01315             {
01316                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, psh1), SW_HIDE );
01317                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01318             }
01319             MessageBox( hDlg,
01320                     <span class="stringliteral">"Hook installed."</span>,
01321                     <span class="stringliteral">"Information"</span>, MB_OK );
01322             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01323     }
01324     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01325 
01326     <span class="comment">// avoid compiler warnings at W3</span>
01327     lParam;
01328     wParam;
01329 }
01330 
01331 
01332 
01333 <span class="comment">/****************************************************************************</span>
01334 <span class="comment">*</span>
01335 <span class="comment">*    FUNCTION: PrintDlgHookProc(HWND, UINT, UINT, LONG)</span>
01336 <span class="comment">*</span>
01337 <span class="comment">*    PURPOSE:  Processes messages for PrintDlg common dialog box</span>
01338 <span class="comment">*</span>
01339 <span class="comment">*    COMMENTS:</span>
01340 <span class="comment">*</span>
01341 <span class="comment">*        This hook procedure simply prompts the user whether or not they</span>
01342 <span class="comment">*        want to print.  if they choose YES, the text buf will be printed</span>
01343 <span class="comment">*        and the dialog will be dismissed.  If they choose NO, the text buf</span>
01344 <span class="comment">*        will not be printeded and the user will be returned to the dialog.</span>
01345 <span class="comment">*</span>
01346 <span class="comment">*        If the current mode is 'custom', the 'Print to file' and 'Collate</span>
01347 <span class="comment">*        Copies' options are hidden.</span>
01348 <span class="comment">*</span>
01349 <span class="comment">*    RETURN VALUES:</span>
01350 <span class="comment">*        TRUE - Continue.</span>
01351 <span class="comment">*        FALSE - Return to the dialog box.</span>
01352 <span class="comment">*</span>
01353 <span class="comment">****************************************************************************/</span>
01354 
<a name="l01355"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a70">01355</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a70">PrintDlgHookProc</a>(
01356         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01357         UINT message,             <span class="comment">/* type of message                 */</span>
01358         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01359         LPARAM lParam)
01360 {
01361 
01362     <span class="keywordflow">switch</span> (message)
01363     {
01364         <span class="keywordflow">case</span> WM_INITDIALOG:
01365             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.Flags &amp; PD_ENABLEPRINTTEMPLATE )
01366             {
01367                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx1), SW_HIDE );
01368                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx2), SW_HIDE );
01369                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01370             }
01371             MessageBox( hDlg,
01372                     <span class="stringliteral">"Hook installed."</span>,
01373                     <span class="stringliteral">"Information"</span>, MB_OK );
01374             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01375 
01376         <span class="keywordflow">case</span> WM_COMMAND:
01377             <span class="keywordflow">if</span> (LOWORD(wParam) == IDOK)
01378             {
01379                 <span class="keywordflow">if</span> (MessageBox( hDlg, <span class="stringliteral">"Are you sure you want to print?"</span>,
01380                     <span class="stringliteral">"Information"</span>, MB_YESNO ) == IDYES )
01381                     <span class="keywordflow">break</span>;
01382                 <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01383 
01384             }
01385             <span class="keywordflow">break</span>;
01386     }
01387     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01388 
01389     <span class="comment">// avoid compiler warnings at W3</span>
01390     lParam;
01391 
01392 }
01393 
01394 
01395 <span class="comment">/****************************************************************************</span>
01396 <span class="comment">*</span>
01397 <span class="comment">*    FUNCTION: PrintFile(HWND)</span>
01398 <span class="comment">*</span>
01399 <span class="comment">*    PURPOSE:  Invokes common dialog function to print.</span>
01400 <span class="comment">*</span>
01401 <span class="comment">*    COMMENTS:</span>
01402 <span class="comment">*</span>
01403 <span class="comment">*        This function initializes the PRINTDLG structure for all modes</span>
01404 <span class="comment">*        possible: standard, using a hook or using a customized template.</span>
01405 <span class="comment">*        When hook mode is chosen, a hook is installed for both the</span>
01406 <span class="comment">*        Print dialog and the Print Setup dialog.  When custom mode is</span>
01407 <span class="comment">*        chosen, the templates are enabled for both the print dialog and</span>
01408 <span class="comment">*        the Print Setup dialog boxes.</span>
01409 <span class="comment">*</span>
01410 <span class="comment">*        If the PrintDlg() common dialog returns TRUE, the current</span>
01411 <span class="comment">*        text buffer is printed out.</span>
01412 <span class="comment">*</span>
01413 <span class="comment">*</span>
01414 <span class="comment">*    RETURN VALUES:</span>
01415 <span class="comment">*        void.</span>
01416 <span class="comment">*</span>
01417 <span class="comment">****************************************************************************/</span>
<a name="l01418"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a80">01418</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a80">PrintFile</a>( HWND hWnd )
01419 {
01420 
01421 
01422     <span class="comment">// initialize PRINTDLG structure</span>
01423     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lStructSize = <span class="keyword">sizeof</span>(PRINTDLG);
01424     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
01425     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevMode = (HANDLE)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01426     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevNames = (HANDLE)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01427     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.nFromPage = 0;
01428     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.nToPage = 0;
01429     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.nMinPage = 0;
01430     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.nMaxPage = 0;
01431     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.nCopies = 0;
01432     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hInstance = (HANDLE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
01433 
01434 
01435     <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01436     {
01437         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01438             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.Flags = PD_RETURNDC | PD_NOPAGENUMS | PD_NOSELECTION | PD_PRINTSETUP;
01439             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnSetupHook = (LPSETUPHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01440             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpSetupTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01441             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnPrintHook = (LPPRINTHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01442             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpPrintTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01443             <span class="keywordflow">break</span>;
01444 
01445         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01446             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.Flags = PD_RETURNDC | PD_NOPAGENUMS | PD_NOSELECTION |
01447                 PD_ENABLEPRINTHOOK | PD_ENABLESETUPHOOK | PD_PRINTSETUP;
01448             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnSetupHook = (LPSETUPHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a46">PrintSetupHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01449             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpSetupTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01450             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnPrintHook = (LPPRINTHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a47">PrintDlgHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01451             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpPrintTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01452             <span class="keywordflow">break</span>;
01453 
01454         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01455             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.Flags = PD_RETURNDC | PD_NOPAGENUMS | PD_NOSELECTION |
01456                 PD_ENABLEPRINTHOOK | PD_ENABLEPRINTTEMPLATE |
01457                 PD_ENABLESETUPHOOK | PD_ENABLESETUPTEMPLATE | PD_PRINTSETUP;
01458             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnSetupHook = (LPSETUPHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a46">PrintSetupHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01459             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpSetupTemplateName = (LPSTR)MAKEINTRESOURCE(PRNSETUPDLGORD);
01460             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpfnPrintHook = (LPPRINTHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a47">PrintDlgHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01461             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.lpPrintTemplateName = (LPSTR)MAKEINTRESOURCE(PRINTDLGORD);
01462             <span class="keywordflow">break</span>;
01463 
01464     }
01465 
01466     <span class="comment">//print a test page if successful</span>
01467     <span class="keywordflow">if</span> (PrintDlg(&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)
01468     {
01469         Escape(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDC, STARTDOC, 8, <span class="stringliteral">"Test-Doc"</span>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01470 
01471         <span class="comment">//Print text</span>
01472         TextOut(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDC, 5, 5, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>));
01473 
01474         Escape(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDC, NEWFRAME, 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01475         Escape(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDC, ENDDOC, 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
01476         DeleteDC(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDC);
01477         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevMode)
01478             GlobalFree(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevMode);
01479         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevNames)
01480             GlobalFree(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>.hDevNames);
01481     }
01482    <span class="keywordflow">else</span>
01483         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01484 }
01485 
01486 
01487 <span class="comment">/****************************************************************************</span>
01488 <span class="comment">*</span>
01489 <span class="comment">*    FUNCTION: ReplaceTextHookProc(HWND, UINT, WPARAM, LPARAM)</span>
01490 <span class="comment">*</span>
01491 <span class="comment">*    PURPOSE:  Processes messages for ReplaceText common dialog box</span>
01492 <span class="comment">*</span>
01493 <span class="comment">*    COMMENTS:</span>
01494 <span class="comment">*</span>
01495 <span class="comment">*        Puts up a message stating that the hook is active if hook</span>
01496 <span class="comment">*        only active.  Otherwise, if template enabled, hides the</span>
01497 <span class="comment">*        Replace All pushbutton, plus the 'Match case' and</span>
01498 <span class="comment">*        'Match whole word' check box options.</span>
01499 <span class="comment">*</span>
01500 <span class="comment">*    RETURN VALUES:</span>
01501 <span class="comment">*        TRUE - Continue.</span>
01502 <span class="comment">*        FALSE - Return to the dialog box.</span>
01503 <span class="comment">*</span>
01504 <span class="comment">****************************************************************************/</span>
01505 
<a name="l01506"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a69">01506</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a69">ReplaceTextHookProc</a>(
01507         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01508         UINT message,             <span class="comment">/* type of message                 */</span>
01509         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01510         LPARAM lParam)
01511 {
01512     <span class="keywordflow">switch</span> (message)
01513     {
01514         <span class="keywordflow">case</span> WM_INITDIALOG:
01515             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags &amp; FR_ENABLETEMPLATE )
01516                 {
01517                     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, psh2), SW_HIDE );
01518                     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx1), SW_HIDE );
01519                     <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>( <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx2), SW_HIDE );
01520                 }
01521             MessageBox( hDlg,
01522                     <span class="stringliteral">"Hook installed."</span>,
01523                     <span class="stringliteral">"Information"</span>, MB_OK );
01524             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01525 
01526 
01527         <span class="keywordflow">default</span>:
01528             <span class="keywordflow">break</span>;
01529     }
01530     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01531 
01532     <span class="comment">// avoid compiler warnings at W3</span>
01533     lParam;
01534     wParam;
01535 }
01536 
01537 <span class="comment">/****************************************************************************</span>
01538 <span class="comment">*</span>
01539 <span class="comment">*    FUNCTION: FindTextHookProc(HWND, UINT, UINT, LONG)</span>
01540 <span class="comment">*</span>
01541 <span class="comment">*    PURPOSE:  Processes messages for FindText common dialog box</span>
01542 <span class="comment">*</span>
01543 <span class="comment">*    COMMENTS:</span>
01544 <span class="comment">*</span>
01545 <span class="comment">*        Puts up a message stating that the hook is active if hook</span>
01546 <span class="comment">*        only enabled.  If custom template, hides the 'Match case'</span>
01547 <span class="comment">*        and 'Match whole word' options, hides the group box 'Direction'</span>
01548 <span class="comment">*        with the radio buttons 'Up' and 'Down'.</span>
01549 <span class="comment">*</span>
01550 <span class="comment">*    RETURN VALUES:</span>
01551 <span class="comment">*        TRUE - Continue.</span>
01552 <span class="comment">*        FALSE - Return to the dialog box.</span>
01553 <span class="comment">*</span>
01554 <span class="comment">****************************************************************************/</span>
01555 
<a name="l01556"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a68">01556</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CALLBACK <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a68">FindTextHookProc</a>(
01557         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01558         UINT message,             <span class="comment">/* type of message                 */</span>
01559         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01560         LPARAM lParam)
01561 {
01562 
01563     <span class="keywordflow">switch</span> (message)
01564     {
01565         <span class="keywordflow">case</span> WM_INITDIALOG:
01566             <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags &amp; FR_ENABLETEMPLATE )
01567             {
01568                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx1), SW_HIDE);
01569                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, grp1), SW_HIDE);
01570                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, chx2), SW_HIDE);
01571                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, rad1), SW_HIDE);
01572                 <a class="code" href="../../d3/d0/user32_8def.html#a32">ShowWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(hDlg, rad2), SW_HIDE);
01573             }
01574             MessageBox( hDlg,
01575                     <span class="stringliteral">"Hook installed."</span>,
01576                     <span class="stringliteral">"Information"</span>, MB_OK );
01577             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01578 
01579 
01580         <span class="keywordflow">default</span>:
01581             <span class="keywordflow">break</span>;
01582     }
01583     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01584 
01585     <span class="comment">// avoid compiler warnings at W3</span>
01586     lParam;
01587     wParam;
01588 }
01589 
01590 
01591 <span class="comment">/****************************************************************************</span>
01592 <span class="comment">*</span>
01593 <span class="comment">*    FUNCTION: CallFindText( HWND )</span>
01594 <span class="comment">*</span>
01595 <span class="comment">*    PURPOSE:  Initializes and calls the FindText()</span>
01596 <span class="comment">*        common dialog.</span>
01597 <span class="comment">*</span>
01598 <span class="comment">*    COMMENTS:</span>
01599 <span class="comment">*</span>
01600 <span class="comment">*        This function initialzes the FINDREPLACE structure for any mode:</span>
01601 <span class="comment">*        standard, using a hook or using a customized template.  It then</span>
01602 <span class="comment">*        calls the FindText() common dialog function.</span>
01603 <span class="comment">*</span>
01604 <span class="comment">*    RETURN VALUES:</span>
01605 <span class="comment">*        void.</span>
01606 <span class="comment">*</span>
01607 <span class="comment">****************************************************************************/</span>
<a name="l01608"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a81">01608</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a81">CallFindText</a>( HWND hWnd )
01609 {
01610 
01611     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lStructSize = <span class="keyword">sizeof</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a> );
01612     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
01613     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.hInstance = (HANDLE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
01614     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpstrFindWhat = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">szFindString</a>;
01615     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpstrReplaceWith = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01616     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.wFindWhatLen = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">szFindString</a>);
01617     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.wReplaceWithLen = 0;
01618     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lCustData = 0;
01619     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
01620 
01621     <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01622     {
01623         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01624             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags =  FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD;
01625             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01626             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01627             <span class="keywordflow">break</span>;
01628 
01629         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01630             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags = FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD |
01631                 FR_ENABLEHOOK;
01632             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a50">FindTextHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01633             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01634             <span class="keywordflow">break</span>;
01635 
01636         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01637             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags = FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD |
01638                  FR_ENABLEHOOK | FR_ENABLETEMPLATE;
01639             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a50">FindTextHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01640             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)MAKEINTRESOURCE(FINDDLGORD);
01641             <span class="keywordflow">break</span>;
01642     }
01643 
01644     <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a> = FindText(&amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01645         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01646 
01647 }
01648 
01649 
01650 <span class="comment">/****************************************************************************</span>
01651 <span class="comment">*</span>
01652 <span class="comment">*    FUNCTION: CallReplaceText( HWND )</span>
01653 <span class="comment">*</span>
01654 <span class="comment">*    PURPOSE:  Initializes and calls the ReplaceText()</span>
01655 <span class="comment">*        common dialog.</span>
01656 <span class="comment">*</span>
01657 <span class="comment">*    COMMENTS:</span>
01658 <span class="comment">*</span>
01659 <span class="comment">*        This function initialzes the FINDREPLACE structure for any mode:</span>
01660 <span class="comment">*        standard, using a hook or using a customized template.  It then</span>
01661 <span class="comment">*        calls the ReplaceText() common dialog function.</span>
01662 <span class="comment">*</span>
01663 <span class="comment">*    RETURN VALUES:</span>
01664 <span class="comment">*        void.</span>
01665 <span class="comment">*</span>
01666 <span class="comment">****************************************************************************/</span>
<a name="l01667"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a82">01667</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a82">CallReplaceText</a>( HWND hWnd )
01668 {
01669     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lStructSize = <span class="keyword">sizeof</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a> );
01670     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.hwndOwner = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>;
01671     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.hInstance = (HANDLE)<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a0">hInst</a>;
01672     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpstrFindWhat = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">szFindString</a>;
01673     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpstrReplaceWith = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a11">szReplaceString</a>;
01674     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.wFindWhatLen = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a10">szFindString</a>);
01675     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.wReplaceWithLen = <span class="keyword">sizeof</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a11">szReplaceString</a> );
01676     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lCustData = 0;
01677     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
01678 
01679     <span class="keywordflow">switch</span>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a19">wMode</a> )
01680     {
01681         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a10">IDM_STANDARD</a>:
01682             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags = FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD;
01683             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)(FARPROC)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01684             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01685             <span class="keywordflow">break</span>;
01686 
01687         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a11">IDM_HOOK</a>:
01688             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags = FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD |
01689                 FR_ENABLEHOOK;
01690             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a49">ReplaceTextHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01691             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01692             <span class="keywordflow">break</span>;
01693 
01694         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a12">IDM_CUSTOM</a>:
01695             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.Flags = FR_NOMATCHCASE | FR_NOUPDOWN | FR_NOWHOLEWORD |
01696                 FR_ENABLEHOOK | FR_ENABLETEMPLATE;
01697             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpfnHook = (LPFRHOOKPROC)MakeProcInstance(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a49">ReplaceTextHookProc</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01698             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a>.lpTemplateName = (LPSTR)MAKEINTRESOURCE(REPLACEDLGORD);
01699             <span class="keywordflow">break</span>;
01700     }
01701 
01702     <span class="keywordflow">if</span> ( (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a25">hDlgFR</a> = ReplaceText( &amp;<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a12">frText</a> )) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> )
01703             <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(CommDlgExtendedError(), <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> );
01704 
01705 }
01706 
01707 <span class="comment">/****************************************************************************</span>
01708 <span class="comment">*</span>
01709 <span class="comment">*    FUNCTION: SearchFile(LPFINDREPLACE)</span>
01710 <span class="comment">*</span>
01711 <span class="comment">*    PURPOSE:  Does the find/replace specified by the Find/ReplaceText</span>
01712 <span class="comment">*        common dialog.</span>
01713 <span class="comment">*</span>
01714 <span class="comment">*    COMMENTS:</span>
01715 <span class="comment">*</span>
01716 <span class="comment">*        This function does the lease necessary to implement find and</span>
01717 <span class="comment">*        replace by calling existing c-runtime functions.  It is in</span>
01718 <span class="comment">*        no way intended to demonstrate either correct or efficient</span>
01719 <span class="comment">*        methods for doing textual search or replacement.</span>
01720 <span class="comment">*</span>
01721 <span class="comment">*    RETURN VALUES:</span>
01722 <span class="comment">*        void.</span>
01723 <span class="comment">*</span>
01724 <span class="comment">****************************************************************************/</span>
<a name="l01725"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a77">01725</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a77">SearchFile</a>( LPFINDREPLACE lpFR )
01726 {
01727 
01728     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Buf[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>];
01729     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *pStr;
01730     <span class="keywordtype">int</span> count, newcount;
01731     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bFoundLast = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01732     
01733 <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; ( FR_FINDNEXT | FR_REPLACE | FR_REPLACEALL ) )
01734     {
01735     memset(Buf, <span class="charliteral">'\0'</span>, <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a> -1);
01736     <span class="keywordflow">if</span> ( bFoundLast )
01737         {
01738         <span class="keywordflow">if</span> ( (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> != <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>) &amp;&amp; (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; FR_FINDNEXT) )
01739             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>++;
01740         bFoundLast = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01741         }
01742 
01743     <span class="keywordflow">if</span> (!*<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> || !(pStr = strstr( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat ) ) )
01744         {
01745         <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( Buf, <span class="stringliteral">"'%s' not found!"</span>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat );
01746         <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
01747         MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;hwndOwner, Buf, <span class="stringliteral">"No luck"</span>, MB_OK | MB_TASKMODAL);
01748         }
01749     <span class="keywordflow">else</span>
01750         {
01751         <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; FR_FINDNEXT )
01752             {
01753             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>( Buf, <span class="stringliteral">"Found Next '%s'!\nSubstring: '%.10s'"</span>, 
01754                      <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat, pStr );
01755             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = pStr;
01756             bFoundLast = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01757             MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;hwndOwner, Buf, <span class="stringliteral">"Success!"</span>, MB_OK | MB_TASKMODAL );
01758             }
01759         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; FR_REPLACE )
01760             {
01761             <span class="comment">// replace string specified in the replace with found string</span>
01762             <span class="comment">// copy up to found string into new buffer</span>
01763             <span class="keywordflow">for</span>( count=0; 
01764                  *pStr &amp;&amp; <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>[count] &amp;&amp; *pStr != <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>[count]; 
01765                  count++);
01766                 strncpy( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, count );
01767             <span class="comment">// concatenate new string</span>
01768             strcat( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrReplaceWith );
01769             <span class="comment">// copy rest of string (less the found string)</span>
01770             newcount = count + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat);
01771             strcat( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>+newcount);
01772             strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, Buf );
01773             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> += count + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrReplaceWith);
01774             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>);
01775             MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;hwndOwner, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, <span class="stringliteral">"Success!"</span>, MB_OK | MB_TASKMODAL );
01776             }
01777         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;Flags &amp; FR_REPLACEALL)
01778             {
01779             <span class="keywordflow">do</span>
01780                 {
01781                 <span class="comment">// replace string specified in the replace with found string</span>
01782                 <span class="comment">// copy up to found string into new buffer</span>
01783                 memset(Buf, <span class="charliteral">'\0'</span>, <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a> -1);
01784                 <span class="keywordflow">for</span>( count=0; 
01785                      *pStr &amp;&amp; <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>[count] &amp;&amp; *pStr != <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>[count]; 
01786                      count++);
01787                      strncpy( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, count );
01788                 <span class="comment">// concatenate new string</span>
01789                 strcat( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrReplaceWith );
01790                 <span class="comment">// copy rest of string (less the found string)</span>
01791                 newcount = count + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat);
01792                 strcat( Buf, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> + newcount);
01793                 strcpy( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, Buf );
01794                 <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> += count + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrReplaceWith);
01795                 }
01796             <span class="keywordflow">while</span> ( *<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> &amp;&amp; 
01797                     (pStr = strstr( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;lpstrFindWhat ) ) );
01798             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a8">dwFileSize</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>);
01799             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a14">lpBufPtr</a> = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>;
01800             MessageBox( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a13">lpFR</a>-&gt;hwndOwner, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a7">FileBuf</a>, 
01801                         <span class="stringliteral">"Success!"</span>, MB_OK | MB_TASKMODAL );
01802             }
01803 
01804         }
01805     }
01806 }
01807 
01808 
01809 <span class="comment">/****************************************************************************</span>
01810 <span class="comment">*</span>
01811 <span class="comment">*    FUNCTION: ProcessCDError(DWORD)</span>
01812 <span class="comment">*</span>
01813 <span class="comment">*    PURPOSE:  Processes errors from the common dialog functions.</span>
01814 <span class="comment">*</span>
01815 <span class="comment">*    COMMENTS:</span>
01816 <span class="comment">*</span>
01817 <span class="comment">*        This function is called whenever a common dialog function</span>
01818 <span class="comment">*        fails.  The CommonDialogExtendedError() value is passed to</span>
01819 <span class="comment">*        the function which maps the error value to a string table.</span>
01820 <span class="comment">*        The string is loaded and displayed for the user.</span>
01821 <span class="comment">*</span>
01822 <span class="comment">*    RETURN VALUES:</span>
01823 <span class="comment">*        void.</span>
01824 <span class="comment">*</span>
01825 <span class="comment">****************************************************************************/</span>
<a name="l01826"></a><a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">01826</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a83">ProcessCDError</a>(DWORD dwErrorCode, HWND hWnd)
01827 {
01828    WORD  wStringID;
01829    <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>  buf[256];
01830 
01831    <span class="keywordflow">switch</span>(dwErrorCode)
01832       {
01833          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a0">CDERR_DIALOGFAILURE</a>:   wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a31">IDS_DIALOGFAILURE</a>;   <span class="keywordflow">break</span>;
01834          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a2">CDERR_STRUCTSIZE</a>:      wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a32">IDS_STRUCTSIZE</a>;      <span class="keywordflow">break</span>;
01835          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a3">CDERR_INITIALIZATION</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a33">IDS_INITIALIZATION</a>;  <span class="keywordflow">break</span>;
01836          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a4">CDERR_NOTEMPLATE</a>:      wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a34">IDS_NOTEMPLATE</a>;      <span class="keywordflow">break</span>;
01837          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a5">CDERR_NOHINSTANCE</a>:     wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a35">IDS_NOHINSTANCE</a>;     <span class="keywordflow">break</span>;
01838          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a6">CDERR_LOADSTRFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a36">IDS_LOADSTRFAILURE</a>;  <span class="keywordflow">break</span>;
01839          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a7">CDERR_FINDRESFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a37">IDS_FINDRESFAILURE</a>;  <span class="keywordflow">break</span>;
01840          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a8">CDERR_LOADRESFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a38">IDS_LOADRESFAILURE</a>;  <span class="keywordflow">break</span>;
01841          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a9">CDERR_LOCKRESFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a39">IDS_LOCKRESFAILURE</a>;  <span class="keywordflow">break</span>;
01842          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a10">CDERR_MEMALLOCFAILURE</a>: wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a40">IDS_MEMALLOCFAILURE</a>; <span class="keywordflow">break</span>;
01843          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a11">CDERR_MEMLOCKFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a41">IDS_MEMLOCKFAILURE</a>;  <span class="keywordflow">break</span>;
01844          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a12">CDERR_NOHOOK</a>:          wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a42">IDS_NOHOOK</a>;          <span class="keywordflow">break</span>;
01845          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a14">PDERR_SETUPFAILURE</a>:    wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a43">IDS_SETUPFAILURE</a>;    <span class="keywordflow">break</span>;
01846          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a15">PDERR_PARSEFAILURE</a>:    wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a44">IDS_PARSEFAILURE</a>;    <span class="keywordflow">break</span>;
01847          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a16">PDERR_RETDEFFAILURE</a>:   wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a45">IDS_RETDEFFAILURE</a>;   <span class="keywordflow">break</span>;
01848          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a17">PDERR_LOADDRVFAILURE</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a46">IDS_LOADDRVFAILURE</a>;  <span class="keywordflow">break</span>;
01849          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a18">PDERR_GETDEVMODEFAIL</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a47">IDS_GETDEVMODEFAIL</a>;  <span class="keywordflow">break</span>;
01850          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a19">PDERR_INITFAILURE</a>:     wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a48">IDS_INITFAILURE</a>;     <span class="keywordflow">break</span>;
01851          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a20">PDERR_NODEVICES</a>:       wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a49">IDS_NODEVICES</a>;       <span class="keywordflow">break</span>;
01852          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a21">PDERR_NODEFAULTPRN</a>:    wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a50">IDS_NODEFAULTPRN</a>;    <span class="keywordflow">break</span>;
01853          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a22">PDERR_DNDMMISMATCH</a>:    wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a51">IDS_DNDMMISMATCH</a>;    <span class="keywordflow">break</span>;
01854          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a23">PDERR_CREATEICFAILURE</a>: wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a52">IDS_CREATEICFAILURE</a>; <span class="keywordflow">break</span>;
01855          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a24">PDERR_PRINTERNOTFOUND</a>: wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a53">IDS_PRINTERNOTFOUND</a>; <span class="keywordflow">break</span>;
01856          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a26">CFERR_NOFONTS</a>:         wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a54">IDS_NOFONTS</a>;         <span class="keywordflow">break</span>;
01857          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a28">FNERR_SUBCLASSFAILURE</a>: wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a55">IDS_SUBCLASSFAILURE</a>; <span class="keywordflow">break</span>;
01858          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a29">FNERR_INVALIDFILENAME</a>: wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a56">IDS_INVALIDFILENAME</a>; <span class="keywordflow">break</span>;
01859          <span class="keywordflow">case</span> <a class="code" href="../../d6/d5/aug98_2test_2cderr_8h.html#a30">FNERR_BUFFERTOOSMALL</a>:  wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a57">IDS_BUFFERTOOSMALL</a>;  <span class="keywordflow">break</span>;
01860 
01861          <span class="keywordflow">case</span> 0:   <span class="comment">//User may have hit CANCEL or we got a *very* random error</span>
01862             <span class="keywordflow">return</span>;
01863 
01864          <span class="keywordflow">default</span>:
01865             wStringID=<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a59">IDS_UNKNOWNERROR</a>;
01866       }
01867 
01868    LoadString(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, wStringID, buf, <span class="keyword">sizeof</span>(buf));
01869    MessageBox(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a>, buf, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, MB_OK);
01870    <span class="keywordflow">return</span>;
01871 }
01872 
01873 <span class="comment">/***********************************************************************/</span>
01874 
<a name="l01875"></a><a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a30">01875</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI <a class="code" href="../../d5/d8/jul98_2test_2main_8c.html#a30">OpenFiles</a>(
01876         HWND hDlg,                <span class="comment">/* window handle of the dialog box */</span>
01877         UINT message,             <span class="comment">/* type of message                 */</span>
01878         WPARAM wParam,            <span class="comment">/* message-specific information    */</span>
01879         LPARAM lParam)
01880 {
01881     <span class="keywordtype">int</span>    Length;
01882     <span class="keywordtype">char</span>   DevProfileName[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>];
01883     <span class="keywordtype">char</span>   TargetProfileName[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>];
01884     <span class="keywordtype">char</span>   OutputFileName[<a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a60">FILE_LEN</a>];
01885     WORD   InpClrSp;
01886 
01887     <span class="keywordflow">switch</span> (message)
01888     {
01889         <span class="keywordflow">case</span> WM_INITDIALOG:                <span class="comment">/* message: initialize dialog box */</span>
01890             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01891 
01892         <span class="keywordflow">case</span> WM_COMMAND:                      <span class="comment">/* message: received a command */</span>
01893             <span class="keywordflow">switch</span> (LOWORD(wParam))
01894             {
01895                 <span class="keywordflow">case</span> <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a3">IDC_BUTTON1</a>: 
01896                     <span class="keywordflow">if</span> ( <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a74">OpenNewFile</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> )
01897                         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a2">IDC_EDIT1</a>, WM_SETTEXT, 0, (<span class="keywordtype">long</span>)(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile)); 
01898                     <span class="keywordflow">break</span>;
01899                 <span class="keywordflow">case</span> <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a6">IDC_BUTTON2</a>:
01900                     <span class="keywordflow">if</span> ( <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a74">OpenNewFile</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> )
01901                         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a4">IDC_EDIT2</a>, WM_SETTEXT, 0, (<span class="keywordtype">long</span>)(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile));
01902                     <span class="keywordflow">break</span>;
01903                 <span class="keywordflow">case</span> <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a7">IDC_BUTTON3</a>:
01904                     <span class="keywordflow">if</span> ( <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a76">SaveAs</a>( <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a29">hWnd</a> ) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> )
01905                         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a5">IDC_EDIT3</a>, WM_SETTEXT, 0, (<span class="keywordtype">long</span>)(<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a1">OpenFileName</a>.lpstrFile));
01906                     <span class="keywordflow">break</span>;
01907                 <span class="keywordflow">case</span> IDOK:
01908                     Length = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a2">IDC_EDIT1</a>, WM_GETTEXTLENGTH, 0, 0);
01909                     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a2">IDC_EDIT1</a>, WM_GETTEXT, Length + 1, (<span class="keywordtype">long</span>)(DevProfileName));
01910                     Length = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a4">IDC_EDIT2</a>, WM_GETTEXTLENGTH, 0, 0);
01911                     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a4">IDC_EDIT2</a>, WM_GETTEXT, Length + 1, (<span class="keywordtype">long</span>)(TargetProfileName));
01912                     Length = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a5">IDC_EDIT3</a>, WM_GETTEXTLENGTH, 0, 0);
01913                     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(hDlg, <a class="code" href="../../d9/d8/ntgdi_2icm_2adobe_2aug98_2test_2resource_8h.html#a5">IDC_EDIT3</a>, WM_GETTEXT, Length + 1, (<span class="keywordtype">long</span>)(OutputFileName));
01914                     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a23">wInpDrvClrSp</a>)
01915                     {
01916                         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a21">IDM_INP_AUTO</a>: InpClrSp = 0; <span class="keywordflow">break</span>;
01917                         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a22">IDM_INP_GRAY</a>: InpClrSp = 1; <span class="keywordflow">break</span>;
01918                         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a23">IDM_INP_RGB</a>:  InpClrSp = 3; <span class="keywordflow">break</span>;
01919                         <span class="keywordflow">case</span> <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a24">IDM_INP_CMYK</a>: InpClrSp = 4; <span class="keywordflow">break</span>;
01920                         <span class="keywordflow">default</span>: InpClrSp = 0; <span class="keywordflow">break</span>;
01921                     }
01922                     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a25">IDM_CSA</a>)
01923                     {
01924                         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a84">ColorSpaceControl</a>(DevProfileName, OutputFileName,
01925                             InpClrSp, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a22">wCSAMode</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01926                     }
01927                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a26">IDM_CRD</a>)
01928                     {
01929                         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a85">CreateCRDControl</a>(DevProfileName, OutputFileName,
01930                             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01931                     }
01932                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a24">wCSAorCRD</a> == <a class="code" href="../../d6/d8/aug98_2test_2main_8h.html#a28">IDM_PROFCRD</a>)
01933                     {
01934                         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a87">CreateProfCRDControl</a>(DevProfileName, 
01935                             TargetProfileName, OutputFileName,
01936                             <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01937                     }
01938                     <span class="keywordflow">else</span> 
01939                     {
01940                         <a class="code" href="../../d8/d8/jul98_2test_2main_8h.html#a86">CreateINTENTControl</a>(DevProfileName, OutputFileName, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>);
01941                     }
01942 
01943                 <span class="keywordflow">case</span> IDCANCEL:
01944                     <a class="code" href="../../d2/d9/dlgend_8c.html#a0">EndDialog</a>(hDlg, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);        <span class="comment">/* Exits the dialog box        */</span>
01945                     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01946             }
01947             <span class="keywordflow">break</span>;
01948     }
01949     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);                           <span class="comment">/* Didn't process a message    */</span>
01950 
01951     <span class="comment">// avoid compiler warnings at W3</span>
01952     lParam;
01953 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:40 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
