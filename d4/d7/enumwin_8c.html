<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: enumwin.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>enumwin.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d5/d6/enumwin_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a0">CHWND_BWLCREATE</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a1">BWLGROW</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a3">InternalBuildHwndList</a> (<a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl, <a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a4">InternalBuildHwndOwnerList</a> (<a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl, <a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndStart, <a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndOwner)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a5">xxxInternalEnumWindow</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwndNext, <a class="el" href="../../d1/d0/inc_2user_8h.html#a959">WNDENUMPROC_PWND</a> lpfn, LPARAM lParam, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a6">BuildHwndList</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, UINT flags, <a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> pti)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a7">ExpandWindowList</a> (<a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> *ppbwl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a8">FreeHwndList</a> (<a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="enumwin.c::BWLGROW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BWLGROW&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00345">345</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="enumwin.c::CHWND_BWLCREATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CHWND_BWLCREATE&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00089">89</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a6" doxytag="enumwin.c::BuildHwndList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> BuildHwndList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pti</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">91</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
References <a class="el" href="../../d4/d1/userk_8h.html#a882">BWL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03637">BWL_ENUMIMELAST</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03635">BWL_ENUMOWNERLIST</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03638">BWL_REMOVEIMECHILD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00089">CHWND_BWLCREATE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00231">gpbwlList</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00347">InternalBuildHwndList()</a>, <a class="el" href="../../d4/d7/enumwin_8c.html#a4">InternalBuildHwndOwnerList()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00591">IS_IME_ENABLED</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00017">pbwlCache</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03620">tagBWL::pbwlNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03622">tagBWL::phwndMax</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03621">tagBWL::phwndNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03623">tagBWL::ptiOwner</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l03624">tagBWL::rghwnd</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00524">_FindWindowEx()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00711">ArrangeWindows()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00299">AssociateInputContextEx()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00927">CascadeWindowsEnum()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00122">DestroyInputContext()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l01120">InitSwitchWndInfo()</a>, <a class="el" href="../../d1/d7/clenum_8c-source.html#l00095">InternalEnumWindows()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08222">NtUserBuildHwndList()</a>, <a class="el" href="../../d7/d3/msgbox_8c-source.html#l01892">StartTaskModalDialog()</a>, <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l00603">UnmaximizeChildWindows()</a>, <a class="el" href="../../d8/d8/icons_8c-source.html#l00031">xxxArrangeIconicWindows()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02375">xxxCheckImeShowStatus()</a>, <a class="el" href="../../d2/d9/kernel_2exitwin_8c-source.html#l00521">xxxClientShutdown()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l00605">xxxDesktopRecalc()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l00846">xxxDWPPrint()</a>, <a class="el" href="../../d0/d2/paint_8c-source.html#l00885">xxxInternalDoSyncPaint()</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00040">xxxInternalEnumWindow()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l00362">xxxMetricsRecalc()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00315">xxxSendBSMtoDesktop()</a>, and <a class="el" href="../../d1/d8/showwin_8c-source.html#l00437">xxxShowOwnedWindows()</a>.
<p>
<pre class="fragment"><div>00095 {
00096     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl;
00097 
00098     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00099 
00100     <span class="keywordflow">if</span> ((pbwl = <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00101 
00102         <span class="comment">/*</span>
00103 <span class="comment">         * We're using the cache now; zero it out.</span>
00104 <span class="comment">         */</span>
00105 <span class="preprocessor">#if DBG</span>
00106 <span class="preprocessor"></span>        pbwlCachePrev = <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a>;
00107 <span class="preprocessor">#endif</span>
00108 <span class="preprocessor"></span>        <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00109 
00110 <span class="preprocessor">#if DBG</span>
00111 <span class="preprocessor"></span>        {
00112             <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwlT;
00113             <span class="comment">/*</span>
00114 <span class="comment">             * pbwlCache shouldn't be in the global linked list.</span>
00115 <span class="comment">             */</span>
00116             <span class="keywordflow">for</span> (pbwlT = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a99">gpbwlList</a>; pbwlT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pbwlT = pbwlT-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o0">pbwlNext</a>) {
00117                 UserAssert(pbwlT != pbwl);
00118             }
00119         }
00120 <span class="preprocessor">#endif</span>
00121 <span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
00122 
00123         <span class="comment">/*</span>
00124 <span class="comment">         * sizeof(BWL) includes the first element of array.</span>
00125 <span class="comment">         */</span>
00126         pbwl = (<a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a>)UserAllocPool(<span class="keyword">sizeof</span>(<a class="code" href="../../d4/d9/structtagBWL.html">BWL</a>) + <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>) * CHWND_BWLCREATE,
00127                 TAG_WINDOWLIST);
00128         <span class="keywordflow">if</span> (pbwl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00129             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00130 
00131         pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a> = &amp;pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>[<a class="code" href="../../d4/d7/enumwin_8c.html#a0">CHWND_BWLCREATE</a> - 1];
00132     }
00133     pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> = pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>;
00134 
00135     <span class="comment">/*</span>
00136 <span class="comment">     * We'll use ptiOwner as temporary storage for the thread we're</span>
00137 <span class="comment">     * scanning for. It will get reset to the proper thing at the bottom</span>
00138 <span class="comment">     * of this routine.</span>
00139 <span class="comment">     */</span>
00140     pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o3">ptiOwner</a> = pti;
00141 
00142 <span class="preprocessor">#ifdef OWNERLIST</span>
00143 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="../../d4/d1/userk_8h.html#a411">BWL_ENUMOWNERLIST</a>) {
00144         pbwl = <a class="code" href="../../d4/d7/enumwin_8c.html#a4">InternalBuildHwndOwnerList</a>(pbwl, pwnd, NULL);
00145     } <span class="keywordflow">else</span> {
00146         pbwl = <a class="code" href="../../d4/d7/enumwin_8c.html#a3">InternalBuildHwndList</a>(pbwl, pwnd, flags);
00147     }
00148 <span class="preprocessor">#else</span>
00149 <span class="preprocessor"></span>    pbwl = <a class="code" href="../../d4/d7/enumwin_8c.html#a3">InternalBuildHwndList</a>(pbwl, pwnd, flags);
00150 <span class="preprocessor">#endif</span>
00151 <span class="preprocessor"></span>
00152     <span class="comment">/*</span>
00153 <span class="comment">     * If phwndNext == phwndMax, it indicates that the pbwl has failed to expand.</span>
00154 <span class="comment">     * The list is no longer valid, so we should just bail.</span>
00155 <span class="comment">     */</span>
00156     <span class="keywordflow">if</span> (pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> &gt;= pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>) {
00157         UserAssert(pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> == pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>);
00158         <span class="comment">/*</span>
00159 <span class="comment">         * Even if we had picked pbwl from the global single cache (pbwlCache),</span>
00160 <span class="comment">         * it should have already been unlinked from the global link list when it was put in the cache.</span>
00161 <span class="comment">         * So we should just free it without manupilating the link pointers.</span>
00162 <span class="comment">         * If we have allocated the pwbl for ourselves, we can simply free it.</span>
00163 <span class="comment">         * In both cases, we should just call UserFreePool().</span>
00164 <span class="comment">         * As the side effect, it may make some room by providing a free pool block.</span>
00165 <span class="comment">         */</span>
00166         UserFreePool(pbwl);
00167         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00168     }
00169 
00170     <span class="comment">/*</span>
00171 <span class="comment">     * Stick in the terminator.</span>
00172 <span class="comment">     */</span>
00173     *pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> = (HWND)1;
00174 
00175 <span class="preprocessor">#ifdef FE_IME</span>
00176 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="../../d4/d1/userk_8h.html#a412">BWL_ENUMIMELAST</a>) {
00177         UserAssert(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>());
00178         <span class="comment">/*</span>
00179 <span class="comment">         * For IME windows.</span>
00180 <span class="comment">         * Rebuild window list for EnumWindows API. Because ACCESS 2.0 assumes</span>
00181 <span class="comment">         * the first window that is called CallBack Functions in the task is</span>
00182 <span class="comment">         * Q-Card Wnd. We should change the order of IME windows</span>
00183 <span class="comment">         */</span>
00184         pbwl = InternalRebuildHwndListForIMEClass(pbwl,
00185                     (flags &amp; BWL_REMOVEIMECHILD) == BWL_REMOVEIMECHILD);
00186     }
00187 <span class="preprocessor">#endif</span>
00188 <span class="preprocessor"></span>
00189     <span class="comment">/*</span>
00190 <span class="comment">     * Finally link this guy into the list.</span>
00191 <span class="comment">     */</span>
00192     pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o3">ptiOwner</a> = <a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>();
00193     pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o0">pbwlNext</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a99">gpbwlList</a>;
00194     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a99">gpbwlList</a> = pbwl;
00195 
00196 
00197     <span class="comment">/*</span>
00198 <span class="comment">     * We should have given out the cache if it was available</span>
00199 <span class="comment">     */</span>
00200     UserAssert(pbwlCache == NULL);
00201 
00202     <span class="keywordflow">return</span> pbwl;
00203 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="enumwin.c::ExpandWindowList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ExpandWindowList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ppbwl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00213">213</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03631">BWL_CHWNDMORE</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03621">tagBWL::phwndNext</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00057">PWND</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00347">InternalBuildHwndList()</a>.
<p>
<pre class="fragment"><div>00215 {
00216     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl;
00217     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwlT;
00218     HWND *phwnd;
00219 
00220     pbwl = *ppbwl;
00221     phwnd = pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a>;
00222 
00223     <span class="comment">/*</span>
00224 <span class="comment">     * Map phwnd to an offset.</span>
00225 <span class="comment">     */</span>
00226     phwnd = (HWND *)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *)phwnd - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *)pbwl);
00227 
00228     <span class="comment">/*</span>
00229 <span class="comment">     * Increase size of BWL by 8 slots.  (8 + 1) is</span>
00230 <span class="comment">     * added since phwnd is "sizeof(HWND)" less</span>
00231 <span class="comment">     * than actual size of handle.</span>
00232 <span class="comment">     */</span>
00233     pbwlT = (<a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a>)UserReAllocPool((HANDLE)pbwl,
00234             PtrToUlong(phwnd) + <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">PWND</a>),
00235             PtrToUlong(phwnd) + (BWL_CHWNDMORE + 1) * <span class="keyword">sizeof</span>(PWND),
00236             TAG_WINDOWLIST);
00237 
00238     <span class="comment">/*</span>
00239 <span class="comment">     * Did alloc succeed?</span>
00240 <span class="comment">     */</span>
00241     <span class="keywordflow">if</span> (pbwlT != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00242         pbwl = pbwlT;                 <span class="comment">/* Yes, use new block. */</span>
00243 
00244     <span class="comment">/*</span>
00245 <span class="comment">     * Map phwnd back into a pointer.</span>
00246 <span class="comment">     */</span>
00247     phwnd = (HWND *)((ULONG_PTR)pbwl + (ULONG_PTR)phwnd);
00248 
00249     <span class="comment">/*</span>
00250 <span class="comment">     * Did ReAlloc() fail?</span>
00251 <span class="comment">     */</span>
00252     <span class="keywordflow">if</span> (pbwlT == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00253         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ExpandWindowList: out of memory."</span>);
00254         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00255     }
00256 
00257     <span class="comment">/*</span>
00258 <span class="comment">     * Reset phwndMax.</span>
00259 <span class="comment">     */</span>
00260     pbwl-&gt;phwndNext = phwnd;
00261     pbwl-&gt;phwndMax = phwnd + <a class="code" href="../../d4/d1/userk_8h.html#a408">BWL_CHWNDMORE</a>;
00262 
00263     *ppbwl = pbwl;
00264 
00265     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00266 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="enumwin.c::FreeHwndList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void FreeHwndList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pbwl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00417">417</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l01833">CheckCritIn</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00231">gpbwlList</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00017">pbwlCache</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03620">tagBWL::pbwlNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03622">tagBWL::phwndMax</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l03624">tagBWL::rghwnd</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/kernel_2winmgr_8c-source.html#l00524">_FindWindowEx()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00299">AssociateInputContextEx()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00122">DestroyInputContext()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l01120">InitSwitchWndInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08222">NtUserBuildHwndList()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l01542">SwitchWndCleanup()</a>, <a class="el" href="../../d8/d8/icons_8c-source.html#l00031">xxxArrangeIconicWindows()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02375">xxxCheckImeShowStatus()</a>, <a class="el" href="../../d2/d9/kernel_2exitwin_8c-source.html#l00521">xxxClientShutdown()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l00605">xxxDesktopRecalc()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02552">xxxDestroyThreadInfo()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l00846">xxxDWPPrint()</a>, <a class="el" href="../../d0/d2/paint_8c-source.html#l00885">xxxInternalDoSyncPaint()</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00040">xxxInternalEnumWindow()</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l00362">xxxMetricsRecalc()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00315">xxxSendBSMtoDesktop()</a>, and <a class="el" href="../../d1/d8/showwin_8c-source.html#l00437">xxxShowOwnedWindows()</a>.
<p>
<pre class="fragment"><div>00419 {
00420     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> *ppbwl;
00421     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwlT;
00422 
00423     <a class="code" href="../../d4/d1/userk_8h.html#a154">CheckCritIn</a>();
00424 
00425     <span class="comment">/*</span>
00426 <span class="comment">     * We should never have an active bwl that is the free cached bwl</span>
00427 <span class="comment">     */</span>
00428     UserAssert(pbwl != pbwlCache);
00429 
00430     <span class="comment">/*</span>
00431 <span class="comment">     * Unlink this bwl from the list.</span>
00432 <span class="comment">     */</span>
00433     <span class="keywordflow">for</span> (ppbwl = &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a99">gpbwlList</a>; *ppbwl != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; ppbwl = &amp;(*ppbwl)-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o0">pbwlNext</a>) {
00434         <span class="keywordflow">if</span> (*ppbwl == pbwl) {
00435             *ppbwl = pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o0">pbwlNext</a>;
00436 
00437             <span class="comment">/*</span>
00438 <span class="comment">             * If the cache is empty or this pbwl is larger than the</span>
00439 <span class="comment">             * cached one, save the pbwl there.</span>
00440 <span class="comment">             */</span>
00441             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00442                 <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> = pbwl;
00443             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a> - pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>) &gt;
00444                        (<a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a>-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a> - <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a>-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>)) {
00445                 pbwlT = <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a>;
00446                 <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> = pbwl;
00447                 UserFreePool((HANDLE)pbwlT);
00448             } <span class="keywordflow">else</span> {
00449                 UserFreePool((HANDLE)pbwl);
00450             }
00451             <span class="keywordflow">return</span>;
00452         }
00453     }
00454 
00455     <span class="comment">/*</span>
00456 <span class="comment">     * Assert if we couldn't find the pbwl in the list...</span>
00457 <span class="comment">     */</span>
00458     UserAssert(FALSE);
00459 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="enumwin.c::InternalBuildHwndList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> InternalBuildHwndList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbwl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00347">347</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l03633">BWL_ENUMCHILDREN</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03634">BWL_ENUMLIST</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00213">ExpandWindowList()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01547">GETPTI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01515">HWq</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03622">tagBWL::phwndMax</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03621">tagBWL::phwndNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03623">tagBWL::ptiOwner</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01746">tagWND::spwndChild</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01744">tagWND::spwndNext</a>.
<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>.
<p>
<pre class="fragment"><div>00351 {
00352     <span class="comment">/*</span>
00353 <span class="comment">     * NOTE: pbwl-&gt;phwndNext is used as a place to keep</span>
00354 <span class="comment">     *       the phwnd across calls to InternalBuildHwndList().</span>
00355 <span class="comment">     *       This is OK since we don't link pbwl into the list</span>
00356 <span class="comment">     *       of pbwl's until after we've finished enumerating windows.</span>
00357 <span class="comment">     */</span>
00358 
00359     <span class="keywordflow">while</span> (pwnd != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00360         <span class="comment">/*</span>
00361 <span class="comment">         * Make sure it matches the thread id, if there is one.</span>
00362 <span class="comment">         */</span>
00363         <span class="keywordflow">if</span> (pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o3">ptiOwner</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o3">ptiOwner</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a455">GETPTI</a>(pwnd)) {
00364             UserAssert(pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> &lt; pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>);
00365             *pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a451">HWq</a>(pwnd);
00366             pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a>++;
00367             <span class="keywordflow">if</span> (pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> == pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>) {
00368 <span class="preprocessor">#if EMULATE_EXPAND_FAILURE</span>
00369 <span class="preprocessor"></span>                <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = 0;
00370                 <span class="keywordflow">if</span> (++<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> % 32 == 0) {
00371                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"InternalBuildHwndList: emulating ExpandWindowList failure."</span>);
00372                     <span class="keywordflow">break</span>;
00373                 }
00374 <span class="preprocessor">#endif</span>
00375 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d7/enumwin_8c.html#a7">ExpandWindowList</a>(&amp;pbwl))
00376                     <span class="keywordflow">break</span>;
00377             }
00378         }
00379 
00380         <span class="comment">/*</span>
00381 <span class="comment">         * Should we step through the Child windows?</span>
00382 <span class="comment">         */</span>
00383         <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="../../d4/d1/userk_8h.html#a409">BWL_ENUMCHILDREN</a>) &amp;&amp; pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o4">spwndChild</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00384             pbwl = <a class="code" href="../../d4/d7/enumwin_8c.html#a3">InternalBuildHwndList</a>(pbwl, pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o4">spwndChild</a>, BWL_ENUMLIST | BWL_ENUMCHILDREN);
00385             <span class="comment">/*</span>
00386 <span class="comment">             * If ExpandWindowList() failed in the recursive call,</span>
00387 <span class="comment">             * we should just bail.</span>
00388 <span class="comment">             */</span>
00389             <span class="keywordflow">if</span> (pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> &gt;= pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>) {
00390                 UserAssert(pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> == pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>);
00391                 RIPMSG1(RIP_WARNING, <span class="stringliteral">"InternalBuildHwndList: failed to expand BWL in enumerating children. pbwl=%#p"</span>, pbwl);
00392                 <span class="keywordflow">break</span>;
00393             }
00394             UserAssert(pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o1">phwndNext</a> &lt; pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o2">phwndMax</a>);
00395         }
00396 
00397         <span class="comment">/*</span>
00398 <span class="comment">         * Are we enumerating only one window?</span>
00399 <span class="comment">         */</span>
00400         <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="../../d4/d1/userk_8h.html#a410">BWL_ENUMLIST</a>))
00401             <span class="keywordflow">break</span>;
00402 
00403         pwnd = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o2">spwndNext</a>;
00404     }
00405 
00406     <span class="keywordflow">return</span> pbwl;
00407 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="enumwin.c::InternalBuildHwndOwnerList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> InternalBuildHwndOwnerList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pbwl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndStart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndOwner</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="enumwin.c::xxxInternalEnumWindow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxInternalEnumWindow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwndNext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a959">WNDENUMPROC_PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00040">40</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00361">CheckLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00417">FreeHwndList()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00194">RevalidateHwnd</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03624">tagBWL::rghwnd</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00363">ThreadLockAlways</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00366">ThreadUnlock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00847">WNDENUMPROC_PWND</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/ntuser_2kernel_2input_8c-source.html#l05671">CancelInputState()</a>, <a class="el" href="../../d4/d5/focusact_8c-source.html#l00472">xxxActivateThisWindow()</a>, <a class="el" href="../../d4/d5/focusact_8c-source.html#l00034">xxxDeactivate()</a>, <a class="el" href="../../d3/d9/kernel_2help_8c-source.html#l00073">xxxHelpLoop()</a>, and <a class="el" href="../../d7/d6/classchg_8c-source.html#l00056">xxxSetClassIcon()</a>.
<p>
<pre class="fragment"><div>00045 {
00046     HWND *phwnd;
00047     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00048     <a class="code" href="../../d4/d9/structtagBWL.html">PBWL</a> pbwl;
00049     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fSuccess;
00050     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlpwnd;
00051 
00052     <a class="code" href="../../d6/d0/usercli_8h.html#a35">CheckLock</a>(pwndNext);
00053 
00054     <span class="keywordflow">if</span> ((pbwl = <a class="code" href="../../d4/d1/userk_8h.html#a1157">BuildHwndList</a>(pwndNext, flags, NULL)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00055         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00056 
00057     fSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00058     <span class="keywordflow">for</span> (phwnd = pbwl-&gt;<a class="code" href="../../d4/d9/structtagBWL.html#o4">rghwnd</a>; *phwnd != (HWND)1; phwnd++) {
00059 
00060         <span class="comment">/*</span>
00061 <span class="comment">         * Lock the window before we pass it off to the app.</span>
00062 <span class="comment">         */</span>
00063         <span class="keywordflow">if</span> ((pwnd = <a class="code" href="../../d6/d0/usercli_8h.html#a21">RevalidateHwnd</a>(*phwnd)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00064 
00065             <span class="comment">/*</span>
00066 <span class="comment">             * Call the application.</span>
00067 <span class="comment">             */</span>
00068             <a class="code" href="../../d6/d0/usercli_8h.html#a37">ThreadLockAlways</a>(pwnd, &amp;tlpwnd);
00069             fSuccess = (*lpfn)(pwnd, lParam);
00070             <a class="code" href="../../d6/d0/usercli_8h.html#a40">ThreadUnlock</a>(&amp;tlpwnd);
00071             <span class="keywordflow">if</span> (!fSuccess)
00072                 <span class="keywordflow">break</span>;
00073         }
00074     }
00075 
00076     <a class="code" href="../../d4/d1/userk_8h.html#a1158">FreeHwndList</a>(pbwl);
00077 
00078     <span class="keywordflow">return</span> fSuccess;
00079 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="enumwin.c::pbwlCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a11">pbwlCache</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00017">17</a> of file <a class="el" href="../../d5/d6/enumwin_8c-source.html">enumwin.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00417">FreeHwndList()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:32 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
