<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: profile.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>profile.h</h1><a href="../../d3/d7/icmui_2profile_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  Header File:  ICC Profile.H</span>
00004 <span class="comment"></span>
00005 <span class="comment">  This defines the C++ class we encapsulate the profile in.  It also defines</span>
00006 <span class="comment">  the base class for device enumeration.  All activity related to the profile,</span>
00007 <span class="comment">  including installations, associations, and so forth, is encapsulated in the</span>
00008 <span class="comment">  CProfile class.  The UI classes themselves never call an ICM API, but are</span>
00009 <span class="comment">  instead concerned with simply handling the interface.</span>
00010 <span class="comment"></span>
00011 <span class="comment">  Copyright (c) 1996 by Microsoft Corporation</span>
00012 <span class="comment"></span>
00013 <span class="comment">  A Pretty Penny Enterprises Production</span>
00014 <span class="comment"></span>
00015 <span class="comment">  Change History:</span>
00016 <span class="comment"></span>
00017 <span class="comment">  10-31-96  A-RobKj (Pretty Penny Enterprises) began encapsulating</span>
00018 <span class="comment">  11-22-96  A-RobKj changed associations from string array to uint array to</span>
00019 <span class="comment">                    facilitate the spec'd device naming conventions, and</span>
00020 <span class="comment">                    filtering of lists for previously installed devices.</span>
00021 <span class="comment"></span>
00022 <span class="comment">  12-04-96  A-RobKj Added the CProfileArray class to make the Device</span>
00023 <span class="comment">                    management UI more efficient.</span>
00024 <span class="comment"></span>
00025 <span class="comment">  12-13-96  A-RobKj Moved the CDeviceList derived classes here, so I can use</span>
00026 <span class="comment">                    them elsewhere.</span>
00027 <span class="comment"></span>
00028 <span class="comment">******************************************************************************/</span>
00029 
00030 <span class="preprocessor">#if !defined(ICC_PROFILE_CLASS)</span>
00031 <span class="preprocessor"></span>
<a name="l00032"></a><a class="code" href="../../d3/d7/icmui_2profile_8h.html#a0">00032</a> <span class="preprocessor">#define ICC_PROFILE_CLASS</span>
00033 <span class="preprocessor"></span>
00034 <span class="preprocessor">#include    "StringAr.H"</span>
00035 <span class="preprocessor">#include    "Dialog.H"</span>
00036 
00037 <span class="comment">//  CDeviceList class</span>
00038 
00039 <span class="comment">/******************************************************************************</span>
00040 <span class="comment"></span>
00041 <span class="comment">  Highlights:</span>
00042 <span class="comment"></span>
00043 <span class="comment">  This is a base class for the enumeration and reporting of Device</span>
00044 <span class="comment">  class-specific information.  The spec is such that a device can be associated</span>
00045 <span class="comment">  with a friendly name, but displayed in the UI with an enhanced name.  Also,</span>
00046 <span class="comment">  the method for enumerating a device can differ from class to class.</span>
00047 <span class="comment"></span>
00048 <span class="comment">  This base class is usable for cases where there is no means of enumerating</span>
00049 <span class="comment">  devices currently.  It reports that there are no devices.</span>
00050 <span class="comment">  To make overrides easier, the default display name returns the friendly name,</span>
00051 <span class="comment">  so derived classes where this is the case do not need to override this</span>
00052 <span class="comment">  method.</span>
00053 <span class="comment"></span>
00054 <span class="comment">******************************************************************************/</span>
00055 
<a name="l00056"></a><a class="code" href="../../d1/d2/classCDeviceList.html">00056</a> <span class="keyword">class </span><a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> { <span class="comment">//  Device-specific information- base class</span>
<a name="l00057"></a><a class="code" href="../../d1/d2/classCDeviceList.html#r0">00057</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a> <a class="code" href="../../d1/d2/classCDeviceList.html#r0">m_csDummy</a>;
00058 
00059 <span class="keyword">public</span>:
<a name="l00060"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a0">00060</a>     <a class="code" href="../../d1/d2/classCDeviceList.html#a0">CDeviceList</a>() {}
<a name="l00061"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a1">00061</a>     <a class="code" href="../../d1/d2/classCDeviceList.html#a1">~CDeviceList</a>() {}
00062 
<a name="l00063"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a2">00063</a>     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span>    <a class="code" href="../../d1/d2/classCDeviceList.html#a2">Count</a>() { <span class="keywordflow">return</span>    0; }
<a name="l00064"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a3">00064</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d1/d2/classCDeviceList.html#a3">DeviceName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d1/d2/classCDeviceList.html#r0">m_csDummy</a>; }
<a name="l00065"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a4">00065</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d1/d2/classCDeviceList.html#a4">DisplayName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> DeviceName(u); }
<a name="l00066"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a5">00066</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d1/d2/classCDeviceList.html#a5">Enumerate</a>() {}
<a name="l00067"></a><a class="code" href="../../d1/d2/classCDeviceList.html#a6">00067</a>     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        <a class="code" href="../../d1/d2/classCDeviceList.html#a6">IsValidDeviceName</a>(LPCTSTR lpstr) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>; }
00068 };
00069 
00070 <span class="comment">//  Device Enumeration classes- these must all derive from CDeviceList</span>
00071 
00072 <span class="comment">//  The CPrinterList class handles printers.  Enumeration is via the Win32</span>
00073 <span class="comment">//  spooler API.</span>
00074 
<a name="l00075"></a><a class="code" href="../../d5/d5/classCPrinterList.html">00075</a> <span class="keyword">class </span><a class="code" href="../../d5/d5/classCPrinterList.html">CPrinterList</a> : <span class="keyword">public</span> <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> {
<a name="l00076"></a><a class="code" href="../../d5/d5/classCPrinterList.html#r0">00076</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d5/d5/classCPrinterList.html#r0">m_csaDeviceNames</a>;
<a name="l00077"></a><a class="code" href="../../d5/d5/classCPrinterList.html#r1">00077</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d5/d5/classCPrinterList.html#r1">m_csaDisplayNames</a>;
00078 
00079 <span class="keyword">public</span>:
<a name="l00080"></a><a class="code" href="../../d5/d5/classCPrinterList.html#a0">00080</a>     <a class="code" href="../../d5/d5/classCPrinterList.html#a0">CPrinterList</a>() {}
<a name="l00081"></a><a class="code" href="../../d5/d5/classCPrinterList.html#a1">00081</a>     <a class="code" href="../../d5/d5/classCPrinterList.html#a1">~CPrinterList</a>() {}
00082 
<a name="l00083"></a><a class="code" href="../../d5/d5/classCPrinterList.html#a2">00083</a>     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span>    <a class="code" href="../../d5/d5/classCPrinterList.html#a2">Count</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d5/d5/classCPrinterList.html#r0">m_csaDeviceNames</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); }
<a name="l00084"></a><a class="code" href="../../d5/d5/classCPrinterList.html#a3">00084</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d5/d5/classCPrinterList.html#a3">DeviceName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d5/d5/classCPrinterList.html#r0">m_csaDeviceNames</a>[u]; }
<a name="l00085"></a><a class="code" href="../../d5/d5/classCPrinterList.html#a4">00085</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d5/d5/classCPrinterList.html#a4">DisplayName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d5/d5/classCPrinterList.html#r1">m_csaDisplayNames</a>[u]; }
00086 
00087     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d5/d5/classCPrinterList.html#a5">Enumerate</a>();
00088     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        IsValidDeviceName(LPCTSTR lpstr);
00089 };
00090 
00091 <span class="comment">//  The CMonitorList class handles monitors.  Enumeration is via a private ICM</span>
00092 <span class="comment">//  API.</span>
00093 
<a name="l00094"></a><a class="code" href="../../d2/d4/classCMonitorList.html">00094</a> <span class="keyword">class </span><a class="code" href="../../d2/d4/classCMonitorList.html">CMonitorList</a> : <span class="keyword">public</span> <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> {
<a name="l00095"></a><a class="code" href="../../d2/d4/classCMonitorList.html#r0">00095</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d2/d4/classCMonitorList.html#r0">m_csaDeviceNames</a>;
<a name="l00096"></a><a class="code" href="../../d2/d4/classCMonitorList.html#r1">00096</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d2/d4/classCMonitorList.html#r1">m_csaDisplayNames</a>;
00097 
<a name="l00098"></a><a class="code" href="../../d2/d4/classCMonitorList.html#r2">00098</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a>         <a class="code" href="../../d2/d4/classCMonitorList.html#r2">m_csPrimaryDeviceName</a>;
00099 
00100 <span class="keyword">public</span>:
<a name="l00101"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a0">00101</a>     <a class="code" href="../../d2/d4/classCMonitorList.html#a0">CMonitorList</a>() {}
<a name="l00102"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a1">00102</a>     <a class="code" href="../../d2/d4/classCMonitorList.html#a1">~CMonitorList</a>() {}
00103 
<a name="l00104"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a2">00104</a>     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span>    <a class="code" href="../../d2/d4/classCMonitorList.html#a2">Count</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d2/d4/classCMonitorList.html#r0">m_csaDeviceNames</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); }
<a name="l00105"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a3">00105</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d2/d4/classCMonitorList.html#a3">DeviceName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d2/d4/classCMonitorList.html#r0">m_csaDeviceNames</a>[u]; }
<a name="l00106"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a4">00106</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d2/d4/classCMonitorList.html#a4">DisplayName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d2/d4/classCMonitorList.html#r1">m_csaDisplayNames</a>[u]; }
00107 
<a name="l00108"></a><a class="code" href="../../d2/d4/classCMonitorList.html#a5">00108</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d2/d4/classCMonitorList.html#a5">PrimaryDeviceName</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d2/d4/classCMonitorList.html#r2">m_csPrimaryDeviceName</a>; }
00109 
00110     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d2/d4/classCMonitorList.html#a6">Enumerate</a>();
00111     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        IsValidDeviceName(LPCTSTR lpstr);
00112 
00113     <span class="keyword">virtual</span> LPCSTR      DeviceNameToDisplayName(LPCTSTR lpstr);
00114 };
00115 
00116 <span class="comment">//  The CScannerList class handles scanners.  Enumeration is via the STI</span>
00117 <span class="comment">//  interface.</span>
00118 
<a name="l00119"></a><a class="code" href="../../d7/d6/classCScannerList.html">00119</a> <span class="keyword">class </span><a class="code" href="../../d7/d6/classCScannerList.html">CScannerList</a> : <span class="keyword">public</span> <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> {
<a name="l00120"></a><a class="code" href="../../d7/d6/classCScannerList.html#r0">00120</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d7/d6/classCScannerList.html#r0">m_csaDeviceNames</a>;
<a name="l00121"></a><a class="code" href="../../d7/d6/classCScannerList.html#r1">00121</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d7/d6/classCScannerList.html#r1">m_csaDisplayNames</a>;
00122 
00123 <span class="keyword">public</span>:
<a name="l00124"></a><a class="code" href="../../d7/d6/classCScannerList.html#a0">00124</a>     <a class="code" href="../../d7/d6/classCScannerList.html#a0">CScannerList</a>() {}
<a name="l00125"></a><a class="code" href="../../d7/d6/classCScannerList.html#a1">00125</a>     <a class="code" href="../../d7/d6/classCScannerList.html#a1">~CScannerList</a>() {}
00126 
<a name="l00127"></a><a class="code" href="../../d7/d6/classCScannerList.html#a2">00127</a>     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span>    <a class="code" href="../../d7/d6/classCScannerList.html#a2">Count</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d7/d6/classCScannerList.html#r0">m_csaDeviceNames</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); }
<a name="l00128"></a><a class="code" href="../../d7/d6/classCScannerList.html#a3">00128</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d7/d6/classCScannerList.html#a3">DeviceName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d7/d6/classCScannerList.html#r0">m_csaDeviceNames</a>[u]; }
<a name="l00129"></a><a class="code" href="../../d7/d6/classCScannerList.html#a4">00129</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d7/d6/classCScannerList.html#a4">DisplayName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d7/d6/classCScannerList.html#r1">m_csaDisplayNames</a>[u]; }
00130 
00131     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d7/d6/classCScannerList.html#a5">Enumerate</a>();
00132     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        IsValidDeviceName(LPCTSTR lpstr);
00133 };
00134 
00135 <span class="comment">//  The CAllDeviceList class shows everything.  We enumerate by combining the</span>
00136 <span class="comment">//  results of enumerating all of the other classes.</span>
00137 
<a name="l00138"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html">00138</a> <span class="keyword">class </span><a class="code" href="../../d7/d1/classCAllDeviceList.html">CAllDeviceList</a> : <span class="keyword">public</span> <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> {
<a name="l00139"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#r0">00139</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d7/d1/classCAllDeviceList.html#r0">m_csaDeviceNames</a>;
<a name="l00140"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#r1">00140</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    <a class="code" href="../../d7/d1/classCAllDeviceList.html#r1">m_csaDisplayNames</a>;
00141 
00142 <span class="keyword">public</span>:
<a name="l00143"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#a0">00143</a>     <a class="code" href="../../d7/d1/classCAllDeviceList.html#a0">CAllDeviceList</a>() {}
<a name="l00144"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#a1">00144</a>     <a class="code" href="../../d7/d1/classCAllDeviceList.html#a1">~CAllDeviceList</a>() {}
00145 
<a name="l00146"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#a2">00146</a>     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span>    <a class="code" href="../../d7/d1/classCAllDeviceList.html#a2">Count</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/classCAllDeviceList.html#r0">m_csaDeviceNames</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); }
<a name="l00147"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#a3">00147</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d7/d1/classCAllDeviceList.html#a3">DeviceName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/classCAllDeviceList.html#r0">m_csaDeviceNames</a>[u]; }
<a name="l00148"></a><a class="code" href="../../d7/d1/classCAllDeviceList.html#a4">00148</a>     <span class="keyword">virtual</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>&amp;    <a class="code" href="../../d7/d1/classCAllDeviceList.html#a4">DisplayName</a>(<span class="keywordtype">unsigned</span> u) { <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/classCAllDeviceList.html#r1">m_csaDisplayNames</a>[u]; }
00149 
00150     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d7/d1/classCAllDeviceList.html#a5">Enumerate</a>();
00151     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        IsValidDeviceName(LPCTSTR lpstr);
00152 };
00153 
00154 <span class="comment">//  CProfile class</span>
00155 
<a name="l00156"></a><a class="code" href="../../d7/d5/classCProfile.html">00156</a> <span class="keyword">class </span><a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> {
00157 
<a name="l00158"></a><a class="code" href="../../d7/d5/classCProfile.html#r0">00158</a>     HPROFILE        <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>;                <span class="comment">//  Profile handle</span>
<a name="l00159"></a><a class="code" href="../../d7/d5/classCProfile.html#r1">00159</a>     PROFILEHEADER   <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>;               <span class="comment">//  Profile header</span>
<a name="l00160"></a><a class="code" href="../../d7/d5/classCProfile.html#r2">00160</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a>         <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>;
<a name="l00161"></a><a class="code" href="../../d7/d5/classCProfile.html#r3">00161</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>            <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a>, <a class="code" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a>, <a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a>,
00162                     <a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>;
<a name="l00163"></a><a class="code" href="../../d7/d5/classCProfile.html#r7">00163</a>     <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a>     *<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>;           <span class="comment">//  Devices of this class</span>
<a name="l00164"></a><a class="code" href="../../d7/d5/classCProfile.html#r8">00164</a>     <a class="code" href="../../d3/d7/classCUintArray.html">CUintArray</a>      <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>;       <span class="comment">//  Associated devices (indices)</span>
<a name="l00165"></a><a class="code" href="../../d7/d5/classCProfile.html#r9">00165</a>     <span class="keywordtype">char</span>            <a class="code" href="../../d7/d5/classCProfile.html#r9">m_acTag</a>[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a> * 2];
00166     <span class="keywordtype">void</span>    <a class="code" href="../../d7/d5/classCProfile.html#d0">InstallCheck</a>();
00167     <span class="keywordtype">void</span>    <a class="code" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a>();
00168     <span class="keywordtype">void</span>    <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00169 
00170 <span class="keyword">public</span>:
00171 
00172     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d5/classCProfile.html#e0">Enumerate</a>(ENUMTYPE&amp; et, <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>&amp; csaList);
00173     <span class="keyword">static</span> <span class="keywordtype">void</span> Enumerate(ENUMTYPE&amp; et, <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>&amp; csaList, <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>&amp; csaDesc);
00174     <span class="keyword">static</span> <span class="keywordtype">void</span> Enumerate(ENUMTYPE&amp; et, <span class="keyword">class</span> <a class="code" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>&amp; cpaList);
00175     <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d1/d7/classCString.html">CString</a>  <a class="code" href="../../d7/d5/classCProfile.html#e3">ColorDirectory</a>();
00176 
00177     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>(LPCTSTR lpstr);
00178     <a class="code" href="../../d7/d5/classCProfile.html#a1">~CProfile</a>();
00179 
00180     <span class="comment">//  Queries</span>
00181 
<a name="l00182"></a><a class="code" href="../../d7/d5/classCProfile.html#a2">00182</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a> <a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a14">NameOnly</a>(); }
<a name="l00183"></a><a class="code" href="../../d7/d5/classCProfile.html#a3">00183</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   <a class="code" href="../../d7/d5/classCProfile.html#a3">GetType</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phClass : 0; }
<a name="l00184"></a><a class="code" href="../../d7/d5/classCProfile.html#a4">00184</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   <a class="code" href="../../d7/d5/classCProfile.html#a4">GetCMM</a>()  { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phCMMType : 0; }
00185 
00186     <span class="comment">// Inquire the color space information from the header</span>
<a name="l00187"></a><a class="code" href="../../d7/d5/classCProfile.html#a5">00187</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   <a class="code" href="../../d7/d5/classCProfile.html#a5">GetColorSpace</a>() {<span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phDataColorSpace : 0;}
00188 
<a name="l00189"></a><a class="code" href="../../d7/d5/classCProfile.html#a6">00189</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>() {
00190         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a>)
00191             <a class="code" href="../../d7/d5/classCProfile.html#d0">InstallCheck</a>();
00192         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a>;
00193     }
<a name="l00194"></a><a class="code" href="../../d7/d5/classCProfile.html#a7">00194</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d7/d5/classCProfile.html#a7">IsValid</a>() {
00195         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bValid = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00196 
00197         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>)
00198             <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a15">IsColorProfileValid</a>(<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>, &amp;bValid);
00199 
00200         <span class="keywordflow">return</span>  bValid;
00201     }
00202 
<a name="l00203"></a><a class="code" href="../../d7/d5/classCProfile.html#a8">00203</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d7/d5/classCProfile.html#a8">DeviceCount</a>() {
00204         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00205           <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00206               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00207           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d6/d0/cmdat_8c.html#a5">Count</a>();
00208         } <span class="keywordflow">else</span> {
00209           <span class="keywordflow">return</span> 0;                           <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00210         }
00211     }
00212 
<a name="l00213"></a><a class="code" href="../../d7/d5/classCProfile.html#a9">00213</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d7/d5/classCProfile.html#a9">AssociationCount</a>() {
00214         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a>)
00215             <a class="code" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a>();
00216         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00217     }
00218 
<a name="l00219"></a><a class="code" href="../../d7/d5/classCProfile.html#a10">00219</a>     LPCTSTR     <a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(<span class="keywordtype">unsigned</span> u) {
00220         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00221           <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00222               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00223           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; DeviceName(u);
00224         } <span class="keywordflow">else</span> {
00225           <span class="keywordflow">return</span> TEXT(<span class="stringliteral">""</span>);                    <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00226         }
00227     }
00228 
<a name="l00229"></a><a class="code" href="../../d7/d5/classCProfile.html#a11">00229</a>     LPCTSTR     <a class="code" href="../../d7/d5/classCProfile.html#a11">DisplayName</a>(<span class="keywordtype">unsigned</span> u) {
00230         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00231           <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00232               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00233           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; DisplayName(u);
00234         } <span class="keywordflow">else</span> {
00235           <span class="keywordflow">return</span> TEXT(<span class="stringliteral">""</span>);                    <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00236         }
00237     }
00238 
<a name="l00239"></a><a class="code" href="../../d7/d5/classCProfile.html#a12">00239</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d7/d5/classCProfile.html#a12">Association</a>(<span class="keywordtype">unsigned</span> u) {
00240         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a>)
00241             <a class="code" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a>();
00242         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>[u];
00243     }
00244 
00245     LPCSTR      TagContents(TAGTYPE tt, <span class="keywordtype">unsigned</span> uOffset = 0);
00246 
00247     <span class="comment">//  Operations</span>
00248 
00249     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d7/d5/classCProfile.html#a14">Install</a>();
00250     <span class="keywordtype">void</span>    Uninstall(BOOL bDelete);
00251     <span class="keywordtype">void</span>    Associate(LPCTSTR lpstrNew);
00252     <span class="keywordtype">void</span>    Dissociate(LPCTSTR lpstrNew);
00253 
00254 };
00255 
00256 <span class="comment">//  CProfileArray class- this is a list of profiles- it is used by the Device</span>
00257 <span class="comment">//  Management UI, so we only construct a CProfile object once per profile.</span>
00258 
<a name="l00259"></a><a class="code" href="../../d8/d5/classCProfileArray.html">00259</a> <span class="keyword">class   </span><a class="code" href="../../d8/d5/classCProfileArray.html">CProfileArray</a> {
<a name="l00260"></a><a class="code" href="../../d8/d5/classCProfileArray.html#r0">00260</a>     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>        *<a class="code" href="../../d8/d5/classCProfileArray.html#r0">m_aStore</a>[20];
<a name="l00261"></a><a class="code" href="../../d8/d5/classCProfileArray.html#r1">00261</a>     <a class="code" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>   *<a class="code" href="../../d8/d5/classCProfileArray.html#r1">m_pcpaNext</a>;
<a name="l00262"></a><a class="code" href="../../d8/d5/classCProfileArray.html#r2">00262</a>     <span class="keywordtype">unsigned</span>        <a class="code" href="../../d8/d5/classCProfileArray.html#r2">m_ucUsed</a>;
00263 
<a name="l00264"></a><a class="code" href="../../d8/d5/classCProfileArray.html#d0">00264</a>     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d5/classCProfileArray.html#d0">ChunkSize</a>()<span class="keyword"> const </span>{
00265         <span class="keywordflow">return</span> <span class="keyword">sizeof</span> <a class="code" href="../../d8/d5/classCProfileArray.html#r0">m_aStore</a> / <span class="keyword">sizeof</span> <a class="code" href="../../d8/d5/classCProfileArray.html#r0">m_aStore</a>[0];
00266     }
00267 
00268     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>    *<a class="code" href="../../d8/d5/classCProfileArray.html#d1">Borrow</a>();
00269 
00270 <span class="keyword">public</span>:
00271 
00272     <a class="code" href="../../d8/d5/classCProfileArray.html#a0">CProfileArray</a>();
00273     <a class="code" href="../../d8/d5/classCProfileArray.html#a1">~CProfileArray</a>();
00274 
<a name="l00275"></a><a class="code" href="../../d8/d5/classCProfileArray.html#a2">00275</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/d5/classCProfileArray.html#r2">m_ucUsed</a>; }
00276 
00277     <span class="comment">//  Add an item</span>
00278     <span class="keywordtype">void</span>        Add(LPCTSTR lpstrNew);
00279 
00280     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>    *operator [](<span class="keywordtype">unsigned</span> u) <span class="keyword">const</span>;
00281 
00282     <span class="keywordtype">void</span>        Remove(<span class="keywordtype">unsigned</span> u);
00283     <span class="keywordtype">void</span>        <a class="code" href="../../d8/d5/classCProfileArray.html#a6">Empty</a>();
00284 };
00285 
00286 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:29 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
