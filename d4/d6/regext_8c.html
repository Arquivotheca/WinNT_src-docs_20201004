<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: regext.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>regext.c File Reference</h1><code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>
<code>#include &lt;windef.h&gt;</code><br>
<code>#include &lt;ntkdexts.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>

<p>
<a href="../../d5/d5/regext_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a13">poolDumpHive</a> (IN <a class="el" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a> <a class="el" href="../../d7/d1/hivemap_8c.html#a0">Hive</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a14">poolDumpMap</a> (IN ULONG Length, IN <a class="el" href="../../d1/d8/struct__HMAP__DIRECTORY.html">PHMAP_DIRECTORY</a> Map)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a15">dumpHiveFromFile</a> (IN FILE *<a class="el" href="../../d1/d9/icmui_8def.html#a0">File</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a16">kcbWorker</a> (IN <a class="el" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">PCM_KEY_CONTROL_BLOCK</a> pKcb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a17">pool</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCurrentPc, PNTKD_EXTENSION_APIS lpExtensionApis, LPSTR lpArgumentString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a18">kcb</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCurrentPc, PNTKD_EXTENSION_APIS lpExtensionApis, LPSTR lpArgumentString)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__HIVE__LIST__ENTRY.html">HIVE_LIST_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a0">HiveList</a> [8]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a1">TotalPages</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a3">TotalKcbs</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a4">TotalKcbName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a5">SavePages</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a6">RestorePages</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>FILE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a7">TempFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PNTKD_OUTPUT_ROUTINE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a8">lpPrint</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PNTKD_GET_EXPRESSION&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PNTKD_GET_SYMBOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a10">lpGetSymbolRoutine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PNTKD_CHECK_CONTROL_C&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a11">lpCheckControlCRoutine</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PNTKD_READ_VIRTUAL_MEMORY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a15" doxytag="regext.c::dumpHiveFromFile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dumpHiveFromFile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN FILE *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>File</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">347</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d2/d8/icmui_8def-source.html#l00004">File</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00122">HBLOCK_SIZE</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00035">TotalPages</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00036">TotalPresentPages</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.
<p>
<pre class="fragment"><div>00353                    :
00354 
00355     Takes a list of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry hives and pages from a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> and
00356     checks to see how many of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pages are in memory.
00357 
00358     The <a class="code" href="../../d8/d0/rtbatcr_8c.html#a8">format</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> as follows
00359        hivename stablelength volatilelength
00360        stable page address
00361        stable page address
00362             .
00363             .
00364             .
00365        <span class="keyword">volatile</span> page address
00366        <span class="keyword">volatile</span> page address
00367             .
00368             .
00369             .
00370        hivename stablelength volatilelength
00371             .
00372             .
00373             .
00374 
00375 
00376 Arguments:
00377 
00378     <a class="code" href="../../d1/d9/icmui_8def.html#a0">File</a> - Supplies a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>.
00379 
00380 Return Value:
00381 
00382     None.
00383 
00384 --*/
00385 
00386 {
00387     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Hivename[33];
00388     ULONG StableLength;
00389     ULONG VolatileLength;
00390     ULONG Page;
00391     ULONG i;
00392     ULONG NumFields;
00393     ULONG Garbage;
00394     ULONG Present;
00395     ULONG Total;
00396     ULONG BytesRead;
00397 
00398     <span class="keywordflow">while</span> (!feof(File)) {
00399         NumFields = fscanf(File,<span class="stringliteral">"%s %d %d\n"</span>,
00400                             Hivename,
00401                             &amp;StableLength,
00402                             &amp;VolatileLength);
00403         <span class="keywordflow">if</span> (NumFields != 3) {
00404             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"fscanf returned %d\n"</span>,NumFields);
00405             <span class="keywordflow">return</span>;
00406         }
00407 
00408         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"\ndumping hive %s\n"</span>,Hivename);
00409         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  Stable Length = %lx\n"</span>,StableLength);
00410         Present = 0;
00411         Total = 0;
00412         <span class="keywordflow">while</span> (StableLength &gt; 0) {
00413             fscanf(File, <span class="stringliteral">"%lx\n"</span>,&amp;Page);
00414             (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(Page,
00415                         &amp;Garbage,
00416                         <span class="keyword">sizeof</span>(ULONG),
00417                         &amp;BytesRead);
00418             <span class="keywordflow">if</span> (BytesRead &gt; 0) {
00419                 ++Present;
00420             }
00421             ++Total;
00422             StableLength -= <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00423         }
00424         <span class="keywordflow">if</span> (Total &gt; 0) {
00425             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  %d/%d stable pages present\n"</span>,
00426                       Present,Total);
00427         }
00428         <a class="code" href="../../d4/d6/regext_8c.html#a1">TotalPages</a> += Total;
00429         <a class="code" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a> += Present;
00430 
00431         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  Volatile Length = %lx\n"</span>,VolatileLength);
00432         Present = 0;
00433         Total = 0;
00434         <span class="keywordflow">while</span> (VolatileLength &gt; 0) {
00435             fscanf(File, <span class="stringliteral">"%lx\n"</span>,&amp;Page);
00436             (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(Page,
00437                         &amp;Garbage,
00438                         <span class="keyword">sizeof</span>(ULONG),
00439                         &amp;BytesRead);
00440             <span class="keywordflow">if</span> (BytesRead &gt; 0) {
00441                 ++Present;
00442             }
00443             ++Total;
00444             VolatileLength -= <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00445         }
00446         <span class="keywordflow">if</span> (Total &gt; 0) {
00447             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  %d/%d volatile pages present\n"</span>,
00448                       Present,Total);
00449         }
00450 
00451         <a class="code" href="../../d4/d6/regext_8c.html#a1">TotalPages</a> += Total;
00452         <a class="code" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a> += Present;
00453     }
00454 
00455 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="regext.c::kcb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void kcb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwCurrentPc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PNTKD_EXTENSION_APIS&nbsp;</td>
          <td class="mdname" nowrap> <em>lpExtensionApis</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpArgumentString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">458</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00048">lpCheckControlCRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00046">lpGetExpressionRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00047">lpGetSymbolRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00039">TotalKcbName</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00038">TotalKcbs</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/cmparse_8c-source.html#l02056">CmpAddInfoAfterParseFailure()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00699">CmpConstructName()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01252">CmpCreateLinkNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01165">CmpCreateRegistryRoot()</a>, <a class="el" href="../../d4/d1/cmparse2_8c-source.html#l00226">CmpDoCreateChild()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l00963">CmpDoOpen()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l01350">CmpInsertKeyHash()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l00145">CmpParseKey()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l00847">CmpQuerySecurityDescriptorInfo()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00807">CmpRemoveFromDelayedClose()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00357">CmpReportNotifyHelper()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00180">CmpSearchForOpenSubKeys()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l00158">CmpSecurityMethod()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00943">EhDeleteValueKey()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00320">EhEnumerateKey()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00396">EhEnumerateValueKey()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00871">EhQueryValueKey()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00515">EhSetValueKey()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>.
<p>
<pre class="fragment"><div>00466                    :
00467 
00468     Walks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a> tree and prints <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> names of keys which have
00469     outstanding kcbs
00470 
00471     Called as:
00472 
00473         !regext.kcb
00474 
00475 Arguments:
00476 
00477     CurrentPc - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current pc at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00478         called.
00479 
00480     lpExtensionApis - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> callable
00481         by <span class="keyword">this</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00482 
00483     lpArgumentString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pattern and expression <span class="keywordflow">for</span> <span class="keyword">this</span>
00484         command.
00485 
00486 Return Value:
00487 
00488     None.
00489 
00490 --*/
00491 
00492 {
00493     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">PCM_KEY_CONTROL_BLOCK</a> pKCB;
00494     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">PCM_KEY_CONTROL_BLOCK</a> Root;
00495     ULONG BytesRead;
00496 
00497     <a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a> = lpExtensionApis-&gt;lpOutputRoutine;
00498     <a class="code" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a> = lpExtensionApis-&gt;lpGetExpressionRoutine;
00499     <a class="code" href="../../d4/d6/regext_8c.html#a10">lpGetSymbolRoutine</a> = lpExtensionApis-&gt;lpGetSymbolRoutine;
00500     <a class="code" href="../../d4/d6/regext_8c.html#a11">lpCheckControlCRoutine</a> = lpExtensionApis-&gt;lpCheckControlCRoutine;
00501     <a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a> = lpExtensionApis-&gt;lpReadVirtualMemRoutine;
00502 
00503     Root = (<a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">PCM_KEY_CONTROL_BLOCK</a>)(<a class="code" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a>)(<span class="stringliteral">"CmpKeyControlBlockRoot"</span>);
00504     <span class="keywordflow">if</span> (Root == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00505         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't find address of CmpKeyControlBlockRoot\n"</span>);
00506         <span class="keywordflow">return</span>;
00507     }
00508     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(Root,
00509                 &amp;pKCB,
00510                 <span class="keyword">sizeof</span>(pKCB),
00511                 &amp;BytesRead);
00512 
00513     <span class="keywordflow">if</span> (BytesRead &lt; <span class="keyword">sizeof</span>(pKCB)) {
00514         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't get pKCB from CmpKeyControlBlockRoot\n"</span>);
00515     }
00516 
00517     <a class="code" href="../../d4/d6/regext_8c.html#a3">TotalKcbs</a> = 0;
00518     <a class="code" href="../../d4/d6/regext_8c.html#a4">TotalKcbName</a> = 0;
00519     <a class="code" href="../../d4/d6/regext_8c.html#a16">kcbWorker</a>(pKCB);
00520 
00521     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"%d KCBs\n"</span>,<a class="code" href="../../d4/d6/regext_8c.html#a3">TotalKcbs</a>);
00522     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"%d total bytes of FullNames\n"</span>,<a class="code" href="../../d4/d6/regext_8c.html#a4">TotalKcbName</a>);
00523 
00524 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="regext.c::kcbWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID kcbWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">PCM_KEY_CONTROL_BLOCK</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pKcb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">527</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d9/d0/cmdata_8h.html#a63">CM_KEY_CONTROL_BLOCK</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00039">TotalKcbName</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00038">TotalKcbs</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>.
<p>
<pre class="fragment"><div>00533                    :
00534 
00535     recursive worker <span class="keywordflow">for</span> walking <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a> tree.
00536 
00537 Arguments:
00538 
00539     pKcb - Supplies pointer to <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.
00540 
00541 Return Value:
00542 
00543     None.
00544 
00545 --*/
00546 
00547 {
00548     <a class="code" href="../../d5/d4/struct__CM__KEY__CONTROL__BLOCK.html">CM_KEY_CONTROL_BLOCK</a> <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>;
00549     ULONG BytesRead;
00550     WCHAR *<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00551 
00552     ++<a class="code" href="../../d4/d6/regext_8c.html#a3">TotalKcbs</a>;
00553     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(pKcb,
00554                 &amp;<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>,
00555                 <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>),
00556                 &amp;BytesRead);
00557     <span class="keywordflow">if</span> (BytesRead &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>)) {
00558         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Can't read kcb at %lx\n"</span>,pKcb);
00559         <span class="keywordflow">return</span>;
00560     }
00561     <a class="code" href="../../d4/d6/regext_8c.html#a4">TotalKcbName</a> += <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length;
00562 
00563     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Left != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00564         <a class="code" href="../../d4/d6/regext_8c.html#a16">kcbWorker</a>(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Left);
00565     }
00566 
00567     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"%d - "</span>,<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.RefCount);
00568 
00569     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = malloc(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length);
00570     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00571         (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Buffer,
00572                     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>,
00573                     <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length,
00574                     &amp;BytesRead);
00575 
00576         <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Length = BytesRead;
00577         <a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName.Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00578 
00579         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">" %wZ\n"</span>,&amp;<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.FullName);
00580         free(Buffer);
00581 
00582     } <span class="keywordflow">else</span> {
00583         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">" ??? \n"</span>);
00584     }
00585 
00586     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Right != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00587         <a class="code" href="../../d4/d6/regext_8c.html#a16">kcbWorker</a>(<a class="code" href="../../d4/d6/regext_8c.html#a18">kcb</a>.Right);
00588     }
00589 
00590 
00591 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="regext.c::pool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID pool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwCurrentPc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PNTKD_EXTENSION_APIS&nbsp;</td>
          <td class="mdname" nowrap> <em>lpExtensionApis</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpArgumentString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">73</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d1/d2/cmp_8h.html#a178">CMHIVE</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">dumpHiveFromFile()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00033">HiveList</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00048">lpCheckControlCRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00046">lpGetExpressionRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00047">lpGetSymbolRoutine</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d2/cmp_8h.html#a188">PHIVE_LIST_ENTRY</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00042">RestorePages</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00041">SavePages</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00043">TempFile</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00035">TotalPages</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00036">TotalPresentPages</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00081                    :
00082 
00083     Goes through all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> paged <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocated to registry space and
00084     determines which pages are present and which are not.
00085 
00086     Called as:
00087 
00088         !regext.pool [s|r]
00089 
00090         s Save list of registry pages to temporary <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>
00091         r Restore list of registry pages from temp. <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>
00092 
00093 Arguments:
00094 
00095     CurrentPc - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current pc at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00096         called.
00097 
00098     lpExtensionApis - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> callable
00099         by <span class="keyword">this</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00100 
00101     lpArgumentString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pattern and expression <span class="keywordflow">for</span> <span class="keyword">this</span>
00102         command.
00103 
00104 Return Value:
00105 
00106     None.
00107 
00108 --*/
00109 
00110 {
00111     PLIST_ENTRY pCmpHiveListHead;
00112     PLIST_ENTRY pNextHiveList;
00113     <a class="code" href="../../d9/d7/struct__HIVE__LIST__ENTRY.html">HIVE_LIST_ENTRY</a> *pHiveListEntry;
00114     ULONG BytesRead;
00115     <a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a> CmHive;
00116 
00117     <a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a> = lpExtensionApis-&gt;lpOutputRoutine;
00118     <a class="code" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a> = lpExtensionApis-&gt;lpGetExpressionRoutine;
00119     <a class="code" href="../../d4/d6/regext_8c.html#a10">lpGetSymbolRoutine</a> = lpExtensionApis-&gt;lpGetSymbolRoutine;
00120     <a class="code" href="../../d4/d6/regext_8c.html#a11">lpCheckControlCRoutine</a> = lpExtensionApis-&gt;lpCheckControlCRoutine;
00121     <a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a> = lpExtensionApis-&gt;lpReadVirtualMemRoutine;
00122 
00123     <span class="keywordflow">if</span> (toupper(lpArgumentString[0])==<span class="charliteral">'S'</span>) {
00124         <a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00125     } <span class="keywordflow">else</span> {
00126         <a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00127     }
00128     <span class="keywordflow">if</span> (toupper(lpArgumentString[0])==<span class="charliteral">'R'</span>) {
00129         <a class="code" href="../../d4/d6/regext_8c.html#a6">RestorePages</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00130     } <span class="keywordflow">else</span> {
00131         <a class="code" href="../../d4/d6/regext_8c.html#a6">RestorePages</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00132     }
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">// Go get the hivelist.</span>
00136     <span class="comment">//</span>
00137     memset(HiveList,0,<span class="keyword">sizeof</span>(HiveList));
00138     pHiveListEntry = (<a class="code" href="../../d9/d7/struct__HIVE__LIST__ENTRY.html">PHIVE_LIST_ENTRY</a>)(<a class="code" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a>)(<span class="stringliteral">"CmpMachineHiveList"</span>);
00139     <span class="keywordflow">if</span> (pHiveListEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00140         (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(pHiveListEntry,
00141                     <a class="code" href="../../d4/d6/regext_8c.html#a0">HiveList</a>,
00142                     <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/regext_8c.html#a0">HiveList</a>),
00143                     &amp;BytesRead);
00144     }
00145 
00146     <span class="comment">//</span>
00147     <span class="comment">// First go and get the hivelisthead</span>
00148     <span class="comment">//</span>
00149     pCmpHiveListHead = (PLIST_ENTRY)(<a class="code" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a>)(<span class="stringliteral">"CmpHiveListHead"</span>);
00150     <span class="keywordflow">if</span> (pCmpHiveListHead==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00151         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"CmpHiveListHead couldn't be read\n"</span>);
00152         <span class="keywordflow">return</span>;
00153     }
00154 
00155     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(&amp;pCmpHiveListHead-&gt;Flink,
00156                 &amp;pNextHiveList,
00157                 <span class="keyword">sizeof</span>(pNextHiveList),
00158                 &amp;BytesRead);
00159     <span class="keywordflow">if</span> (BytesRead != <span class="keyword">sizeof</span>(pNextHiveList)) {
00160         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't read first Flink (%lx) of CmpHiveList\n"</span>,
00161                   &amp;pCmpHiveListHead-&gt;Flink);
00162         <span class="keywordflow">return</span>;
00163     }
00164 
00165     <a class="code" href="../../d4/d6/regext_8c.html#a1">TotalPages</a> = <a class="code" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a> = 0;
00166 
00167     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a>) {
00168         <a class="code" href="../../d4/d6/regext_8c.html#a7">TempFile</a> = fopen(<span class="stringliteral">"regext.dat"</span>,<span class="stringliteral">"w+"</span>);
00169         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a7">TempFile</a>==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00170             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't create regext.dat for write\n"</span>);
00171             <span class="keywordflow">return</span>;
00172         }
00173     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a6">RestorePages</a>) {
00174         <a class="code" href="../../d4/d6/regext_8c.html#a7">TempFile</a> = fopen(<span class="stringliteral">"regext.dat"</span>,<span class="stringliteral">"r"</span>);
00175         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a7">TempFile</a>==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00176             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't open regext.dat for read\n"</span>);
00177             <span class="keywordflow">return</span>;
00178         }
00179     }
00180 
00181     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a6">RestorePages</a>) {
00182         <a class="code" href="../../d4/d6/regext_8c.html#a15">dumpHiveFromFile</a>(TempFile);
00183     } <span class="keywordflow">else</span> {
00184         <span class="keywordflow">while</span> (pNextHiveList != pCmpHiveListHead) {
00185             CmHive = CONTAINING_RECORD(pNextHiveList, <a class="code" href="../../d9/d6/struct__CMHIVE.html">CMHIVE</a>, HiveList);
00186             <a class="code" href="../../d4/d6/regext_8c.html#a13">poolDumpHive</a>(CmHive);
00187 
00188             (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(&amp;pNextHiveList-&gt;Flink,
00189                         &amp;pNextHiveList,
00190                         <span class="keyword">sizeof</span>(pNextHiveList),
00191                         &amp;BytesRead);
00192             <span class="keywordflow">if</span> (BytesRead != <span class="keyword">sizeof</span>(pNextHiveList)) {
00193                 (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Couldn't read Flink (%lx) of %lx\n"</span>,
00194                           &amp;pCmpHiveListHead-&gt;Flink,pNextHiveList);
00195                 <span class="keywordflow">break</span>;
00196             }
00197 
00198         }
00199     }
00200 
00201     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Total pages present = %d / %d\n"</span>,
00202               <a class="code" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a>,
00203               <a class="code" href="../../d4/d6/regext_8c.html#a1">TotalPages</a>);
00204 
00205     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a> || <a class="code" href="../../d4/d6/regext_8c.html#a6">RestorePages</a>) {
00206         fclose(TempFile);
00207     }
00208 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="regext.c::poolDumpHive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void poolDumpHive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Hive</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">211</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d3/d1/rtload_8c-source.html#l00047">FileName</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00331">HBASE_NAME_ALLOC</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00041">SavePages</a>, <a class="el" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00043">TempFile</a>, and <a class="el" href="../../d0/d1/hivedata_8h.html#a77a76">Volatile</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.
<p>
<pre class="fragment"><div>00214 {
00215     <a class="code" href="../../d9/d6/struct__CMHIVE.html">CMHIVE</a> CmHive;
00216     ULONG BytesRead;
00217     WCHAR <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a30">HBASE_NAME_ALLOC</a>/2 + 1];
00218     ULONG i;
00219 
00220     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"\ndumping hive at %lx "</span>,pHive);
00221     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(pHive,
00222                 &amp;CmHive,
00223                 <span class="keyword">sizeof</span>(CmHive),
00224                 &amp;BytesRead);
00225 
00226     <span class="keywordflow">if</span> (BytesRead &lt; <span class="keyword">sizeof</span>(CmHive)) {
00227         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"\tRead %lx bytes from %lx\n"</span>,BytesRead,pHive);
00228         <span class="keywordflow">return</span>;
00229     }
00230 
00231     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(&amp;CmHive.Hive.BaseBlock-&gt;FileName,
00232                 <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>,
00233                 <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>),
00234                 &amp;BytesRead);
00235 
00236     <span class="keywordflow">if</span> (BytesRead &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>)) {
00237         wcscpy(FileName, L<span class="stringliteral">"UNKNOWN"</span>);
00238     } <span class="keywordflow">else</span> {
00239         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>[0]==<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>) {
00240             wcscpy(FileName, L<span class="stringliteral">"NONAME"</span>);
00241         } <span class="keywordflow">else</span> {
00242             <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a30">HBASE_NAME_ALLOC</a>/2]=<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00243         }
00244     }
00245 
00246     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"(%ws)\n"</span>,<a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>);
00247 
00248     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  %d KCBs open\n"</span>,CmHive.KcbCount);
00249     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  Stable Length = %lx\n"</span>,CmHive.Hive.Storage[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a75">Stable</a>].Length);
00250     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a>) {
00251         fprintf(TempFile,
00252                 <span class="stringliteral">"%ws %d %d\n"</span>,
00253                 FileName,
00254                 CmHive.Hive.Storage[Stable].Length,
00255                 CmHive.Hive.Storage[Volatile].Length);
00256     }
00257     <a class="code" href="../../d4/d6/regext_8c.html#a14">poolDumpMap</a>(CmHive.Hive.Storage[Stable].Length,
00258                 CmHive.Hive.Storage[Stable].Map);
00259 
00260     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  Volatile Length = %lx\n"</span>,CmHive.Hive.Storage[<a class="code" href="../../d0/d1/hivedata_8h.html#a77a76">Volatile</a>].Length);
00261     <a class="code" href="../../d4/d6/regext_8c.html#a14">poolDumpMap</a>(CmHive.Hive.Storage[Volatile].Length,
00262                 CmHive.Hive.Storage[Volatile].Map);
00263 
00264 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="regext.c::poolDumpMap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID poolDumpMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d8/struct__HMAP__DIRECTORY.html">PHMAP_DIRECTORY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Map</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">267</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
References <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00417">_HMAP_ENTRY::BlockAddress</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00122">HBLOCK_SIZE</a>, <a class="el" href="../../d0/d1/hivedata_8h.html#a61">HMAP_DIRECTORY</a>, <a class="el" href="../../d0/d1/hivedata_8h.html#a57">HMAP_ENTRY</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00132">HTABLE_SLOTS</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">lpPrint</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">lpReadMem</a>, <a class="el" href="../../d0/d1/hivedata_8h.html#a60">PHMAP_TABLE</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00041">SavePages</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00439">_HMAP_TABLE::Table</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00043">TempFile</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00035">TotalPages</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00036">TotalPresentPages</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>.
<p>
<pre class="fragment"><div>00271 {
00272     ULONG Tables;
00273     ULONG MapSlots;
00274     ULONG i;
00275     ULONG BytesRead;
00276     <a class="code" href="../../d1/d8/struct__HMAP__DIRECTORY.html">HMAP_DIRECTORY</a> MapDirectory;
00277     <a class="code" href="../../d3/d8/struct__HMAP__TABLE.html">PHMAP_TABLE</a> MapTable;
00278     <a class="code" href="../../d2/d8/struct__HMAP__ENTRY.html">HMAP_ENTRY</a> MapEntry;
00279     ULONG Garbage;
00280     ULONG Present=0;
00281 
00282     <span class="keywordflow">if</span> (Length==0) {
00283         <span class="keywordflow">return</span>;
00284     }
00285 
00286     MapSlots = Length / <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00287     Tables = 1+ ((MapSlots-1) / <a class="code" href="../../d0/d1/hivedata_8h.html#a17">HTABLE_SLOTS</a>);
00288 
00289     <span class="comment">//</span>
00290     <span class="comment">// read in map directory</span>
00291     <span class="comment">//</span>
00292     (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(Map,
00293              &amp;MapDirectory,
00294              Tables * <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/struct__HMAP__TABLE.html">PHMAP_TABLE</a>),
00295              &amp;BytesRead);
00296     <span class="keywordflow">if</span> (BytesRead &lt; (Tables * <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/struct__HMAP__TABLE.html">PHMAP_TABLE</a>))) {
00297         (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"Only read %lx/%lx bytes from %lx\n"</span>,
00298                   BytesRead,
00299                   Tables * <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/struct__HMAP__TABLE.html">PHMAP_TABLE</a>),
00300                   Map);
00301         <span class="keywordflow">return</span>;
00302 
00303     }
00304 
00305     <span class="comment">//</span>
00306     <span class="comment">// check out each map entry</span>
00307     <span class="comment">//</span>
00308     <span class="keywordflow">for</span> (i=0; i&lt;MapSlots; i++) {
00309 
00310         MapTable = MapDirectory.Directory[i/<a class="code" href="../../d0/d1/hivedata_8h.html#a17">HTABLE_SLOTS</a>];
00311 
00312         (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(&amp;(MapTable-&gt;<a class="code" href="../../d3/d8/struct__HMAP__TABLE.html#o0">Table</a>[i%<a class="code" href="../../d0/d1/hivedata_8h.html#a17">HTABLE_SLOTS</a>]),
00313                     &amp;MapEntry,
00314                     <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/struct__HMAP__ENTRY.html">HMAP_ENTRY</a>),
00315                     &amp;BytesRead);
00316         <span class="keywordflow">if</span> (BytesRead &lt; <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d8/struct__HMAP__ENTRY.html">HMAP_ENTRY</a>)) {
00317             (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  can't read HMAP_ENTRY at %lx\n"</span>,
00318                       &amp;(MapTable-&gt;<a class="code" href="../../d3/d8/struct__HMAP__TABLE.html#o0">Table</a>[i%<a class="code" href="../../d0/d1/hivedata_8h.html#a17">HTABLE_SLOTS</a>]));
00319         }
00320 
00321         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/regext_8c.html#a5">SavePages</a>) {
00322             fprintf(TempFile, <span class="stringliteral">"%lx\n"</span>,MapEntry.<a class="code" href="../../d2/d8/struct__HMAP__ENTRY.html#o0">BlockAddress</a>);
00323 
00324         }
00325 
00326         <span class="comment">//</span>
00327         <span class="comment">// probe the HBLOCK</span>
00328         <span class="comment">//</span>
00329         (<a class="code" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>)(MapEntry.<a class="code" href="../../d2/d8/struct__HMAP__ENTRY.html#o0">BlockAddress</a>,
00330                     &amp;Garbage,
00331                     <span class="keyword">sizeof</span>(ULONG),
00332                     &amp;BytesRead);
00333         <span class="keywordflow">if</span> (BytesRead &gt; 0) {
00334             ++Present;
00335         }
00336     }
00337     (<a class="code" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>)(<span class="stringliteral">"  %d/%d pages present\n"</span>,
00338               Present,
00339               MapSlots);
00340 
00341     <a class="code" href="../../d4/d6/regext_8c.html#a1">TotalPages</a> += MapSlots;
00342     <a class="code" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a> += Present;
00343 
00344 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="regext.c::HiveList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__HIVE__LIST__ENTRY.html">HIVE_LIST_ENTRY</a> <a class="el" href="../../d4/d6/regext_8c.html#a0">HiveList</a>[8]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00033">33</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/cminit_8c-source.html#l00667">CmpDestroyHive()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02195">CmpDoFlushAll()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01235">CmpFlushNotify()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01378">CmpNotifyChangeKey()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00731">CmpRefreshHive()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00357">CmpReportNotifyHelper()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="regext.c::lpCheckControlCRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PNTKD_CHECK_CONTROL_C <a class="el" href="../../d4/d6/regext_8c.html#a11">lpCheckControlCRoutine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00048">48</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="regext.c::lpGetExpressionRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PNTKD_GET_EXPRESSION <a class="el" href="../../d4/d6/regext_8c.html#a9">lpGetExpressionRoutine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00046">46</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="regext.c::lpGetSymbolRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PNTKD_GET_SYMBOL <a class="el" href="../../d4/d6/regext_8c.html#a10">lpGetSymbolRoutine</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00047">47</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="regext.c::lpPrint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PNTKD_OUTPUT_ROUTINE <a class="el" href="../../d4/d6/regext_8c.html#a8">lpPrint</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00045">45</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">dumpHiveFromFile()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="regext.c::lpReadMem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PNTKD_READ_VIRTUAL_MEMORY <a class="el" href="../../d4/d6/regext_8c.html#a12">lpReadMem</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00049">49</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">dumpHiveFromFile()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="regext.c::RestorePages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d4/d6/regext_8c.html#a6">RestorePages</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00042">42</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="regext.c::SavePages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d4/d6/regext_8c.html#a5">SavePages</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00041">41</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="regext.c::TempFile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> FILE* <a class="el" href="../../d4/d6/regext_8c.html#a7">TempFile</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00043">43</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00211">poolDumpHive()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="regext.c::TotalKcbName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d6/regext_8c.html#a4">TotalKcbName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00039">39</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="regext.c::TotalKcbs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d6/regext_8c.html#a3">TotalKcbs</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00038">38</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00458">kcb()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00527">kcbWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="regext.c::TotalPages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d6/regext_8c.html#a1">TotalPages</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00035">35</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">dumpHiveFromFile()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l01582">MmInitializeMemoryLimits()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="regext.c::TotalPresentPages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d6/regext_8c.html#a2">TotalPresentPages</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/regext_8c-source.html#l00036">36</a> of file <a class="el" href="../../d5/d5/regext_8c-source.html">regext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/regext_8c-source.html#l00347">dumpHiveFromFile()</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00073">pool()</a>, and <a class="el" href="../../d5/d5/regext_8c-source.html#l00267">poolDumpMap()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
