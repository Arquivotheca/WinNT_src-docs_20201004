<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kdinit.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>kdinit.c File Reference</h1><code>#include "<a class="el" href="../../d1/d6/kdp_8h-source.html">kdp.h</a>"</code><br>

<p>
<a href="../../d5/d5/kdinit_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a0">BAUD_OPTION</a>&nbsp;&nbsp;&nbsp;"BAUDRATE"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a1">PORT_OPTION</a>&nbsp;&nbsp;&nbsp;"DEBUGPORT"</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a2">KdInitSystem</a> (IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock OPTIONAL, BOOLEAN StopInDebugger)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a3">KdRegisterDebuggerDataBlock</a> (IN ULONG Tag, IN PDBGKD_DEBUG_DATA_HEADER DataHeader, IN ULONG <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a4">KdDeregisterDebuggerDataBlock</a> (IN PDBGKD_DEBUG_DATA_HEADER DataHeader)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d6/kdinit_8c.html#a5">KdLogDbgPrint</a> (IN PSTRING <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="kdinit.c::BAUD_OPTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BAUD_OPTION&nbsp;&nbsp;&nbsp;"BAUDRATE"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00027">27</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="kdinit.c::PORT_OPTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PORT_OPTION&nbsp;&nbsp;&nbsp;"DEBUGPORT"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00028">28</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="kdinit.c::KdDeregisterDebuggerDataBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdDeregisterDebuggerDataBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PDBGKD_DEBUG_DATA_HEADER&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DataHeader</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00328">328</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
References <a class="el" href="../../d4/d2/dumpuser_8c-source.html#l00048">Header</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00279">KdpDataSpinLock</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00280">KdpDebuggerDataListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock()</a>, and <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00094">List</a>.
<p>
<pre class="fragment"><div>00333                    :
00334 
00335     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to deregister a data block previously
00336     registered with <a class="code" href="../../d7/d3/kd_8h.html#a26">KdRegisterDebuggerDataBlock</a>.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> block <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00337     found in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed.
00338 
00339 Arguments:
00340 
00341     DataHeader - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data block which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00342                 to be removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list.
00343 
00344 Return Value:
00345 
00346     None
00347 
00348 --*/
00349 
00350 {
00351     KIRQL OldIrql;
00352     PLIST_ENTRY <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>;
00353     PDBGKD_DEBUG_DATA_HEADER <a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>;
00354 
00355     <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a>(&amp;KdpDataSpinLock, &amp;OldIrql);
00356 
00357     <span class="comment">//</span>
00358     <span class="comment">// Make sure the data block is on our list before removing it.</span>
00359     <span class="comment">//</span>
00360 
00361     <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>.Flink;
00362 
00363     <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> != &amp;<a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>) {
00364 
00365         <a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a> = CONTAINING_RECORD(List, DBGKD_DEBUG_DATA_HEADER, List);
00366         <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>-&gt;Flink;
00367 
00368         <span class="keywordflow">if</span> (DataHeader == <a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>) {
00369             RemoveEntryList(&amp;DataHeader-&gt;List);
00370             <span class="keywordflow">break</span>;
00371         }
00372     }
00373 
00374     <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a>(&amp;KdpDataSpinLock, OldIrql);
00375 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="kdinit.c::KdInitSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdInitSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> LoaderBlock&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StopInDebugger</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">36</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
References <a class="el" href="../../d2/d6/4_2kdp_8h-source.html#l00173">_BREAKPOINT_ENTRY::Address</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00027">BAUD_OPTION</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00115">_DEBUG_PARAMETERS::BaudRate</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00114">_DEBUG_PARAMETERS::CommunicationPort</a>, <a class="el" href="../../d2/d6/4_2kdp_8h-source.html#l00172">_BREAKPOINT_ENTRY::DirectoryTableBase</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01961">ExInitializeWorkItem</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/4_2kdp_8h-source.html#l00171">_BREAKPOINT_ENTRY::Flags</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00106">KdDebuggerDataBlock</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00134">KdDebuggerEnabled</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00142">KdDebugParameters</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00082">KDP_BREAKPOINT_VALUE</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00263">KdpBreakpointInstruction</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00201">KdpBreakpointTable</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00280">KdpDebuggerDataListHead</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00299">KdpDebuggerStructuresInitialized</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00206">KdPerformanceCounterRate</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00066">KdPitchDebugger</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00264">KdpNextPacketIdToSend</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00266">KdpNtosImageBase</a>, <a class="el" href="../../d2/d7/hal_8h.html#a199">KdPortInitialize()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00300">KdpOweBreakpoint</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00265">KdpPacketIdExpected</a>, <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html#l00386">KdpStub()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02318">KdpSwitchProcessor()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00290">KdpTimeSlipDpc</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00494">KdpTimeSlipDpcRoutine()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00292">KdpTimeSlipTimer</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00291">KdpTimeSlipWorkItem</a>, <a class="el" href="../../d8/d7/alpha_2kdtrap_8c-source.html#l00028">KdpTrap()</a>, <a class="el" href="../../d6/d5/4_2kdinit_8c-source.html#l00287">KdRegisterDebuggerDataBlock()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00207">KdTimerStart</a>, <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00039">KeInitializeDpc()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">KeInitializeTimer()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a205">KeQueryPerformanceCounter()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02809">KeUserCallbackDispatcher</a>, <a class="el" href="../../d1/d6/kdp_8h-source.html#l00437">KiDebugRoutine</a>, <a class="el" href="../../d1/d6/kdp_8h-source.html#l00438">KiDebugSwitchRoutine</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00028">PORT_OPTION</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00043                    :
00044 
00045     This routine initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> portable kernel debugger.
00046 
00047 Arguments:
00048 
00049     LoaderBlock - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">LOADER_PARAMETER_BLOCK</a> passed
00050         in from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OS Loader.
00051 
00052     StopInDebugger - Supplies a <span class="keywordtype">boolean</span> value that determines whether a
00053         debug message and breakpoint are generated.
00054 
00055 Return Value:
00056 
00057     None.
00058 
00059 --*/
00060 
00061 {
00062 
00063     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00064     BOOLEAN Initialize;
00065     PCHAR Options;
00066     PCHAR BaudOption;
00067     PCHAR PortOption;
00068 
00069     <span class="comment">//</span>
00070     <span class="comment">// If kernel debugger is already initialized, then return.</span>
00071     <span class="comment">//</span>
00072 
00073     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00074         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00075     }
00076 
00077     <a class="code" href="../../d0/d7/kdp_8h.html#a24">KiDebugRoutine</a> = <a class="code" href="../../d7/d8/alpha_2kdtrap_8c.html#a2">KdpStub</a>;
00078 
00079     <span class="comment">//</span>
00080     <span class="comment">// Determine whether or not the debugger should be enabled.</span>
00081     <span class="comment">//</span>
00082     <span class="comment">// Note that if LoaderBlock == NULL, then KdInitSystem was called</span>
00083     <span class="comment">// from BugCheck code. For this case the debugger is always enabled</span>
00084     <span class="comment">// to report the bugcheck if possible.</span>
00085     <span class="comment">//</span>
00086 
00087     <span class="keywordflow">if</span> (LoaderBlock != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00088 
00089         <a class="code" href="../../d8/d5/kddata_8c.html#a94">KdpNtosImageBase</a> =  CONTAINING_RECORD(
00090                                     (LoaderBlock-&gt;LoadOrderListHead.Flink),
00091                                     LDR_DATA_TABLE_ENTRY,
00092                                     InLoadOrderLinks)-&gt;DllBase;
00093 
00094         <span class="comment">//</span>
00095         <span class="comment">// Initialize the debugger data block list when called at startup time.</span>
00096         <span class="comment">//</span>
00097 
00098         InitializeListHead(&amp;KdpDebuggerDataListHead);
00099 
00100         <span class="comment">//</span>
00101         <span class="comment">// Fill in and register the debugger's debugger data block.</span>
00102         <span class="comment">// Most fields are already initialized, some fields will not be</span>
00103         <span class="comment">// filled in until later.</span>
00104         <span class="comment">//</span>
00105 
00106         <a class="code" href="../../d8/d5/kddata_8c.html#a50">KdDebuggerDataBlock</a>.KernBase = (ULONG_PTR) <a class="code" href="../../d8/d5/kddata_8c.html#a94">KdpNtosImageBase</a>;
00107         <a class="code" href="../../d8/d5/kddata_8c.html#a50">KdDebuggerDataBlock</a>.KeUserCallbackDispatcher = (ULONG_PTR) <a class="code" href="../../d4/d9/ke_8h.html#a149">KeUserCallbackDispatcher</a>;
00108 
00109         <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a5">KdRegisterDebuggerDataBlock</a>(KDBG_TAG,
00110                                     &amp;<a class="code" href="../../d8/d5/kddata_8c.html#a50">KdDebuggerDataBlock</a>.Header,
00111                                     <span class="keyword">sizeof</span>(KdDebuggerDataBlock));
00112 
00113         <span class="keywordflow">if</span> (LoaderBlock-&gt;LoadOptions != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00114             Options = LoaderBlock-&gt;LoadOptions;
00115             _strupr(Options);
00116 
00117             <span class="comment">//</span>
00118             <span class="comment">// If any of the port option, baud option, or debug is specified,</span>
00119             <span class="comment">// then enable the debugger unless it is explictly disabled.</span>
00120             <span class="comment">//</span>
00121 
00122             Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00123             PortOption = strstr(Options, PORT_OPTION);
00124             BaudOption = strstr(Options, BAUD_OPTION);
00125             <span class="keywordflow">if</span> ((PortOption == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (BaudOption == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00126                 <span class="keywordflow">if</span> (strstr(Options, <span class="stringliteral">"DEBUG"</span>) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00127                     Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00128                 }
00129 
00130             } <span class="keywordflow">else</span> {
00131                 <span class="keywordflow">if</span> (PortOption) {
00132                     PortOption = strstr(PortOption, <span class="stringliteral">"COM"</span>);
00133                     <span class="keywordflow">if</span> (PortOption) {
00134                         <a class="code" href="../../d7/d3/kd_8h.html#a14">KdDebugParameters</a>.<a class="code" href="../../d0/d2/struct__DEBUG__PARAMETERS.html#o0">CommunicationPort</a> =
00135                                                      atol(PortOption + 3);
00136                     }
00137                 }
00138 
00139                 <span class="keywordflow">if</span> (BaudOption) {
00140                     BaudOption += <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(BAUD_OPTION);
00141                     <span class="keywordflow">while</span> (*BaudOption == <span class="charliteral">' '</span>) {
00142                         BaudOption++;
00143                     }
00144 
00145                     <span class="keywordflow">if</span> (*BaudOption != <span class="charliteral">'\0'</span>) {
00146                         <a class="code" href="../../d7/d3/kd_8h.html#a14">KdDebugParameters</a>.<a class="code" href="../../d0/d2/struct__DEBUG__PARAMETERS.html#o1">BaudRate</a> = atol(BaudOption + 1);
00147                     }
00148                 }
00149             }
00150 
00151             <span class="comment">//</span>
00152             <span class="comment">// If the debugger is explicitly disabled, then set to NODEBUG.</span>
00153             <span class="comment">//</span>
00154 
00155             <span class="keywordflow">if</span> (strstr(Options, <span class="stringliteral">"NODEBUG"</span>)) {
00156                 Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00157                 <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00158             }
00159 
00160             <span class="keywordflow">if</span> (strstr(Options, <span class="stringliteral">"CRASHDEBUG"</span>)) {
00161                 Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00162                 <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00163             }
00164 
00165         } <span class="keywordflow">else</span> {
00166 
00167             <span class="comment">//</span>
00168             <span class="comment">// If the load options are not specified, then set to NODEBUG.</span>
00169             <span class="comment">//</span>
00170 
00171             <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00172             Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00173         }
00174 
00175     } <span class="keywordflow">else</span> {
00176         Initialize = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00177     }
00178 
00179     <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d7/hal_8h.html#a199">KdPortInitialize</a>(&amp;KdDebugParameters, LoaderBlock, Initialize) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
00180         (Initialize == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00181         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00182     }
00183 
00184     <span class="comment">//</span>
00185     <span class="comment">// Set address of kernel debugger trap routine.</span>
00186     <span class="comment">//</span>
00187 
00188     <a class="code" href="../../d0/d7/kdp_8h.html#a24">KiDebugRoutine</a> = <a class="code" href="../../d7/d8/alpha_2kdtrap_8c.html#a0">KdpTrap</a>;
00189 
00190     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d5/kddata_8c.html#a107">KdpDebuggerStructuresInitialized</a>) {
00191 
00192         <a class="code" href="../../d0/d7/kdp_8h.html#a25">KiDebugSwitchRoutine</a> = <a class="code" href="../../d8/d3/kdapi_8c.html#a30">KdpSwitchProcessor</a>;
00193         <a class="code" href="../../d8/d5/kddata_8c.html#a91">KdpBreakpointInstruction</a> = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a6">KDP_BREAKPOINT_VALUE</a>;
00194         <a class="code" href="../../d8/d5/kddata_8c.html#a108">KdpOweBreakpoint</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00195 
00196         <span class="comment">//</span>
00197         <span class="comment">// Initialize the breakpoint table.</span>
00198         <span class="comment">//</span>
00199 
00200         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; BREAKPOINT_TABLE_SIZE; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00201             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o0">Flags</a> = 0;
00202             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o2">Address</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00203             <a class="code" href="../../d8/d5/kddata_8c.html#a51">KdpBreakpointTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d3/d5/struct__BREAKPOINT__ENTRY.html#o1">DirectoryTableBase</a> = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00204         }
00205 
00206         <span class="comment">//</span>
00207         <span class="comment">// Initialize TimeSlip</span>
00208         <span class="comment">//</span>
00209         <a class="code" href="../../d4/d1/dpcobj_8c.html#a1">KeInitializeDpc</a>(&amp;KdpTimeSlipDpc, KdpTimeSlipDpcRoutine, NULL);
00210         <a class="code" href="../../d3/d2/timerobj_8c.html#a1">KeInitializeTimer</a>(&amp;KdpTimeSlipTimer);
00211         <a class="code" href="../../d5/d8/ex_8h.html#a55">ExInitializeWorkItem</a>(&amp;KdpTimeSlipWorkItem, KdpTimeSlipWork, NULL);
00212 
00213         <a class="code" href="../../d8/d5/kddata_8c.html#a107">KdpDebuggerStructuresInitialized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> ;
00214     }
00215 
00216     <span class="comment">//</span>
00217     <span class="comment">//  Initialize timer facility - HACKHACK</span>
00218     <span class="comment">//</span>
00219 
00220     <a class="code" href="../../d2/d7/hal_8h.html#a205">KeQueryPerformanceCounter</a>(&amp;KdPerformanceCounterRate);
00221     <a class="code" href="../../d8/d5/kddata_8c.html#a56">KdTimerStart</a>.HighPart = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00222     <a class="code" href="../../d8/d5/kddata_8c.html#a56">KdTimerStart</a>.LowPart = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00223 
00224     <span class="comment">//</span>
00225     <span class="comment">// Initialize ID for NEXT packet to send and Expect ID of next incoming</span>
00226     <span class="comment">// packet.</span>
00227     <span class="comment">//</span>
00228 
00229     <a class="code" href="../../d8/d5/kddata_8c.html#a92">KdpNextPacketIdToSend</a> = INITIAL_PACKET_ID | SYNC_PACKET_ID;
00230     <a class="code" href="../../d8/d5/kddata_8c.html#a93">KdpPacketIdExpected</a> = INITIAL_PACKET_ID;
00231 
00232     <span class="comment">//</span>
00233     <span class="comment">// Mark debugger enabled.</span>
00234     <span class="comment">//</span>
00235     <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00236     <a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00237     SharedUserData-&gt;KdDebuggerEnabled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00238 
00239     <span class="comment">//</span>
00240     <span class="comment">// If requested, stop in the kernel debugger.</span>
00241     <span class="comment">//</span>
00242 
00243     <span class="keywordflow">if</span> (StopInDebugger) {
00244         DbgBreakPoint();
00245     }
00246 
00247     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00248 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="kdinit.c::KdLogDbgPrint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KdLogDbgPrint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSTRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>String</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00379">379</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d9/d5/kdmove_8c-source.html#l00031">KdpMoveMemory()</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00104">KdpPrintSpinLock</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00203">KDPRINTBUFFERSIZE</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00101">KdPrintCircularBuffer</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00103">KdPrintRolloverCount</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00102">KdPrintWritePointer</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a155">KiTryToAcquireSpinLock()</a>, and <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>.
<p>
<pre class="fragment"><div>00382 {
00383     KIRQL OldIrql;
00384     ULONG Length;
00385     ULONG LengthCopied;
00386 
00387     <span class="keywordflow">for</span> (; ;) {
00388         <span class="keywordflow">if</span> (KeTestSpinLock (&amp;KdpPrintSpinLock)) {
00389             <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a> (HIGH_LEVEL, &amp;OldIrql);
00390             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/ki_8h.html#a155">KiTryToAcquireSpinLock</a>(&amp;KdpPrintSpinLock)) {
00391                 <span class="keywordflow">break</span>;          <span class="comment">// got the lock</span>
00392             }
00393             <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00394         }
00395     }
00396 
00397     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>) {
00398         Length = <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Length;
00399         <span class="comment">//</span>
00400         <span class="comment">// truncate ridiculous strings</span>
00401         <span class="comment">//</span>
00402         <span class="keywordflow">if</span> (Length &gt; <a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>) {
00403             Length = <a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>;
00404         }
00405 
00406         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> + Length &lt;= <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>+<a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>) {
00407             LengthCopied = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(KdPrintWritePointer, <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Buffer, Length);
00408             <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> += LengthCopied;
00409             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> &gt;= <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>+<a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>) {
00410                 <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>;
00411                 <a class="code" href="../../d8/d5/kddata_8c.html#a48">KdPrintRolloverCount</a>++;
00412             }
00413         } <span class="keywordflow">else</span> {
00414             ULONG First = (ULONG)(<a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a> + <a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a> - <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a>);
00415             LengthCopied = <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(KdPrintWritePointer,
00416                                          <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Buffer,
00417                                          First);
00418             <span class="keywordflow">if</span> (LengthCopied == First) {
00419                 LengthCopied += <a class="code" href="../../d1/d7/4_2kdp_8h.html#a110">KdpMoveMemory</a>(KdPrintCircularBuffer,
00420                                               <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>-&gt;Buffer + First,
00421                                               Length - First);
00422             }
00423             <span class="keywordflow">if</span> (LengthCopied &gt; First) {
00424                 <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a> + LengthCopied - First;
00425                 <a class="code" href="../../d8/d5/kddata_8c.html#a48">KdPrintRolloverCount</a>++;
00426             } <span class="keywordflow">else</span> {
00427                 <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> += LengthCopied;
00428                 <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> &gt;= <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>+<a class="code" href="../../d7/d3/kd_8h.html#a6">KDPRINTBUFFERSIZE</a>) {
00429                     <a class="code" href="../../d8/d5/kddata_8c.html#a47">KdPrintWritePointer</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a46">KdPrintCircularBuffer</a>;
00430                     <a class="code" href="../../d8/d5/kddata_8c.html#a48">KdPrintRolloverCount</a>++;
00431                 }
00432             }
00433         }
00434     }
00435 
00436     KiReleaseSpinLock(&amp;KdpPrintSpinLock);
00437     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00438 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="kdinit.c::KdRegisterDebuggerDataBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KdRegisterDebuggerDataBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PDBGKD_DEBUG_DATA_HEADER&nbsp;</td>
          <td class="mdname" nowrap> <em>DataHeader</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00252">252</a> of file <a class="el" href="../../d5/d5/kdinit_8c-source.html">kdinit.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d2/dumpuser_8c-source.html#l00048">Header</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00279">KdpDataSpinLock</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00280">KdpDebuggerDataListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock()</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00094">List</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00259                    :
00260 
00261     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called by a component or driver to <span class="keyword">register</span> a
00262     debugger data block.  The data block <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> accessible to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00263     kernel debugger, thus providing a reliable method of exposing
00264     random data to debugger extensions.
00265 
00266 Arguments:
00267 
00268     Tag - Supplies a unique 4 byte tag which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to identify <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00269             data block.
00270 
00271     DataHeader - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debugger data block header.
00272             The OwnerTag field must contain a unique value, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>
00273             field must contain <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data block, including <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00274             header.  If <span class="keyword">this</span> block <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already present, or there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00275             already a block with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same value <span class="keywordflow">for</span> OwnerTag, <span class="keyword">this</span> one
00276             will not be inserted.  If <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> incorrect, <span class="keyword">this</span> code will
00277             not notice, but <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> usermode side of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> debugger might not
00278             function correctly.
00279 
00280     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data block, including <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> header.
00281 
00282 Return Value:
00283 
00284     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> block was added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> not.
00285 
00286 --*/
00287 {
00288     KIRQL OldIrql;
00289     PLIST_ENTRY <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>;
00290     PDBGKD_DEBUG_DATA_HEADER <a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>;
00291 
00292     <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a>(&amp;KdpDataSpinLock, &amp;OldIrql);
00293 
00294     <span class="comment">//</span>
00295     <span class="comment">// Look for a record with the same tag or address</span>
00296     <span class="comment">//</span>
00297 
00298     <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> = <a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>.Flink;
00299 
00300     <span class="keywordflow">while</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> != &amp;<a class="code" href="../../d8/d5/kddata_8c.html#a97">KdpDebuggerDataListHead</a>) {
00301 
00302         <a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a> = CONTAINING_RECORD(List, DBGKD_DEBUG_DATA_HEADER, List);
00303 
00304         <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a12">List</a>-&gt;Flink;
00305 
00306         <span class="keywordflow">if</span> ((<a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a> == DataHeader) || (<a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>-&gt;OwnerTag == Tag)) {
00307             <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a>(&amp;KdpDataSpinLock, OldIrql);
00308             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00309         }
00310     }
00311 
00312     <span class="comment">//</span>
00313     <span class="comment">// It wasn't already there, so add it.</span>
00314     <span class="comment">//</span>
00315 
00316     DataHeader-&gt;OwnerTag = Tag;
00317     DataHeader-&gt;Size = <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00318 
00319     InsertTailList(&amp;KdpDebuggerDataListHead, &amp;DataHeader-&gt;List);
00320 
00321     <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a>(&amp;KdpDataSpinLock, OldIrql);
00322 
00323     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00324 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:26 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
