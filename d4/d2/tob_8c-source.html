<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tob.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tob.c</h1><a href="../../d3/d3/tob_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    tex.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Test program for the OB subcomponent of the NTOS project</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Steve Wood (stevewo) 31-Mar-1989</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#include "<a class="code" href="../../d5/d1/obp_8h.html">obp.h</a>"</span>
00022 
<a name="l00023"></a><a class="code" href="../../d3/d3/tob_8c.html#a0">00023</a> GENERIC_MAPPING <a class="code" href="../../d3/d3/tob_8c.html#a0">MyGenericMapping</a> = {
00024     STANDARD_RIGHTS_READ,
00025     STANDARD_RIGHTS_WRITE,
00026     STANDARD_RIGHTS_EXECUTE,
00027     STANDARD_RIGHTS_READ |
00028         STANDARD_RIGHTS_WRITE |
00029         STANDARD_RIGHTS_EXECUTE
00030 };
00031 
<a name="l00032"></a><a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html">00032</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html">_OBJECTTYPEA</a> {
<a name="l00033"></a><a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o0">00033</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>  <a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o0">Event</a>;
<a name="l00034"></a><a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o1">00034</a>     ULONG   <a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o1">TypeALength</a>;
<a name="l00035"></a><a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o2">00035</a>     ULONG   <a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o2">Stuff</a>[ 4 ];
00036 } <a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html">OBJECTTYPEA</a>, *<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html">POBJECTTYPEA</a>;
00037 
00038 
<a name="l00039"></a><a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html">00039</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html">_OBJECTTYPEB</a> {
<a name="l00040"></a><a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o0">00040</a>     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a> <a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o0">Semaphore</a>;
<a name="l00041"></a><a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o1">00041</a>     ULONG   <a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o1">TypeBLength</a>;
<a name="l00042"></a><a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o2">00042</a>     ULONG   <a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o2">Stuff</a>[ 16 ];
00043 } <a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html">OBJECTTYPEB</a>, *<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html">POBJECTTYPEB</a>;
00044 
<a name="l00045"></a><a class="code" href="../../d3/d3/tob_8c.html#a5">00045</a> OBJECT_ATTRIBUTES    <a class="code" href="../../d3/d3/tob_8c.html#a5">DirectoryObjA</a>;
<a name="l00046"></a><a class="code" href="../../d3/d3/tob_8c.html#a6">00046</a> OBJECT_ATTRIBUTES    <a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>;
<a name="l00047"></a><a class="code" href="../../d3/d3/tob_8c.html#a7">00047</a> OBJECT_ATTRIBUTES    <a class="code" href="../../d3/d3/tob_8c.html#a7">ObjectBObjA</a>;
<a name="l00048"></a><a class="code" href="../../d3/d3/tob_8c.html#a8">00048</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a8">DirectoryName</a>;
<a name="l00049"></a><a class="code" href="../../d3/d3/tob_8c.html#a9">00049</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a9">ObjectAName</a>;
<a name="l00050"></a><a class="code" href="../../d3/d3/tob_8c.html#a10">00050</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a10">ObjectBName</a>;
<a name="l00051"></a><a class="code" href="../../d3/d3/tob_8c.html#a11">00051</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>;
<a name="l00052"></a><a class="code" href="../../d3/d3/tob_8c.html#a12">00052</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>;
<a name="l00053"></a><a class="code" href="../../d3/d3/tob_8c.html#a13">00053</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a13">ObjectTypeAName</a>;
<a name="l00054"></a><a class="code" href="../../d3/d3/tob_8c.html#a14">00054</a> STRING  <a class="code" href="../../d3/d3/tob_8c.html#a14">ObjectTypeBName</a>;
<a name="l00055"></a><a class="code" href="../../d3/d3/tob_8c.html#a15">00055</a> <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>    <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>;
<a name="l00056"></a><a class="code" href="../../d3/d3/tob_8c.html#a16">00056</a> <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>    <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>;
<a name="l00057"></a><a class="code" href="../../d3/d3/tob_8c.html#a17">00057</a> PVOID   <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>;
<a name="l00058"></a><a class="code" href="../../d3/d3/tob_8c.html#a18">00058</a> PVOID   <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>;
<a name="l00059"></a><a class="code" href="../../d3/d3/tob_8c.html#a19">00059</a> PVOID   <a class="code" href="../../d3/d3/tob_8c.html#a19">ObjectBodyA1</a>;
<a name="l00060"></a><a class="code" href="../../d3/d3/tob_8c.html#a20">00060</a> PVOID   <a class="code" href="../../d3/d3/tob_8c.html#a20">ObjectBodyA2</a>;
<a name="l00061"></a><a class="code" href="../../d3/d3/tob_8c.html#a21">00061</a> <a class="code" href="../../d3/d3/tob_8c.html#a2">POBJECTTYPEA</a> <a class="code" href="../../d3/d3/tob_8c.html#a21">ObjectA</a>;
<a name="l00062"></a><a class="code" href="../../d3/d3/tob_8c.html#a22">00062</a> <a class="code" href="../../d3/d3/tob_8c.html#a4">POBJECTTYPEB</a> <a class="code" href="../../d3/d3/tob_8c.html#a22">ObjectB</a>;
<a name="l00063"></a><a class="code" href="../../d3/d3/tob_8c.html#a23">00063</a> HANDLE  <a class="code" href="../../d3/d3/tob_8c.html#a23">DirectoryHandle</a>;
<a name="l00064"></a><a class="code" href="../../d3/d3/tob_8c.html#a24">00064</a> HANDLE  <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>;
<a name="l00065"></a><a class="code" href="../../d3/d3/tob_8c.html#a25">00065</a> HANDLE  <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>;
<a name="l00066"></a><a class="code" href="../../d3/d3/tob_8c.html#a26">00066</a> HANDLE  <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>;
<a name="l00067"></a><a class="code" href="../../d3/d3/tob_8c.html#a27">00067</a> HANDLE  <a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a>;
00068 
00069 
00070 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00071"></a><a class="code" href="../../d3/d3/tob_8c.html#a29">00071</a> <a class="code" href="../../d3/d3/tob_8c.html#a29">DumpAProc</a>(
00072     IN PVOID Object,
00073     IN <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">POB_DUMP_CONTROL</a> Control OPTIONAL
00074     )
00075 {
00076     <a class="code" href="../../d3/d3/tob_8c.html#a2">POBJECTTYPEA</a> p = (<a class="code" href="../../d3/d3/tob_8c.html#a2">POBJECTTYPEA</a>)Object;
00077     ULONG i;
00078 
00079     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"DumpAProc: %lx\n"</span>, p );
00080     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Length: %ld\n"</span>, p-&gt;<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o1">TypeALength</a> );
00081     <span class="keywordflow">for</span> (i=0; i&lt;4; i++) {
00082         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Stuff[%ld]: %ld\n"</span>, i, p-&gt;<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o2">Stuff</a>[i] );
00083         }
00084 }
00085 
<a name="l00086"></a><a class="code" href="../../d3/d3/tob_8c.html#a28">00086</a> <span class="keywordtype">char</span> *<a class="code" href="../../d3/d3/tob_8c.html#a28">OpenReasonStrings</a>[] = {
00087     <span class="stringliteral">"ObCreateHandle"</span>,
00088     <span class="stringliteral">"ObOpenHandle"</span>,
00089     <span class="stringliteral">"ObDuplicateHandle"</span>,
00090     <span class="stringliteral">"ObInheritHandle"</span>
00091 };
00092 
00093 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00094"></a><a class="code" href="../../d3/d3/tob_8c.html#a30">00094</a> <a class="code" href="../../d3/d3/tob_8c.html#a30">OpenAProc</a>(
00095     IN OB_OPEN_REASON OpenReason,
00096     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process OPTIONAL,
00097     IN PVOID Object,
00098     IN ACCESS_MASK GrantedAccess,
00099     IN ULONG HandleCount
00100     )
00101 {
00102     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"OpenAProc: OpenReason = %s  Process: %lx  \n"</span>,
00103              <a class="code" href="../../d3/d3/tob_8c.html#a28">OpenReasonStrings</a>[ OpenReason ], Process );
00104     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Object: %lx  Access: %lx  Count: %lu\n"</span>,
00105              Object, GrantedAccess, HandleCount );
00106 }
00107 
00108 
00109 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00110"></a><a class="code" href="../../d3/d3/tob_8c.html#a31">00110</a> <a class="code" href="../../d3/d3/tob_8c.html#a31">CloseAProc</a>(
00111     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process OPTIONAL,
00112     IN PVOID Object,
00113     IN ACCESS_MASK GrantedAccess,
00114     IN ULONG ProcessHandleCount,
00115     IN ULONG SystemHandleCount
00116     )
00117 {
00118     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"CloseAProc: Process: %lx  \n"</span>, Process );
00119     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Object: %lx  Access: %lx  ProcessHandleCount: %lu  SystemHandleCount: %lu\n"</span>,
00120              Object, GrantedAccess, ProcessHandleCount, SystemHandleCount );
00121 }
00122 
00123 
00124 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00125"></a><a class="code" href="../../d3/d3/tob_8c.html#a32">00125</a> <a class="code" href="../../d3/d3/tob_8c.html#a32">DeleteAProc</a>(
00126     IN PVOID Object
00127     )
00128 {
00129     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"DeleteAProc: %lx\n"</span>, Object );
00130 }
00131 
00132 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00133"></a><a class="code" href="../../d3/d3/tob_8c.html#a33">00133</a> <a class="code" href="../../d3/d3/tob_8c.html#a33">ParseAProc</a>(
00134     IN PVOID ParseObject,
00135     IN ULONG DesiredAccess,
00136     IN KPROCESSOR_MODE AccessMode,
00137     IN ULONG Attributes,
00138     IN OUT PSTRING CompleteName,
00139     IN OUT PSTRING RemainingName,
00140     IN OUT PVOID Context OPTIONAL,
00141     OUT PVOID *Object
00142     )
00143 {
00144     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"ParseAProc: %lx\n"</span>, ParseObject );
00145     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    CompleteName:  %.*s\n"</span>, CompleteName-&gt;Length,
00146                                          CompleteName-&gt;Buffer );
00147     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    RemainingName: %.*s\n"</span>, RemainingName-&gt;Length,
00148                                          RemainingName-&gt;Buffer );
00149     <a class="code" href="../../d7/d1/obref_8c.html#a6">ObReferenceObjectByPointer</a>(
00150         ParseObject,
00151         DesiredAccess,
00152         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00153         AccessMode
00154         );
00155 
00156     *Object = ParseObject;
00157     <span class="keywordflow">return</span>( STATUS_SUCCESS );
00158 }
00159 
00160 
00161 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00162"></a><a class="code" href="../../d3/d3/tob_8c.html#a34">00162</a> <a class="code" href="../../d3/d3/tob_8c.html#a34">DumpBProc</a>(
00163     IN PVOID Object,
00164     IN <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">POB_DUMP_CONTROL</a> Control OPTIONAL
00165     )
00166 {
00167     <a class="code" href="../../d3/d3/tob_8c.html#a4">POBJECTTYPEB</a> p = (<a class="code" href="../../d3/d3/tob_8c.html#a4">POBJECTTYPEB</a>)Object;
00168     ULONG i;
00169 
00170     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"DumpBProc: %lx\n"</span>, p );
00171     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Length: %ld\n"</span>, p-&gt;<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o1">TypeBLength</a> );
00172     <span class="keywordflow">for</span> (i=0; i&lt;16; i++) {
00173         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"    Stuff[%ld]: %ld\n"</span>, i, p-&gt;<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o2">Stuff</a>[i] );
00174         }
00175 }
00176 
00177 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00178"></a><a class="code" href="../../d3/d3/tob_8c.html#a35">00178</a> <a class="code" href="../../d3/d3/tob_8c.html#a35">DeleteBProc</a>(
00179     IN PVOID Object
00180     )
00181 {
00182     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"DeleteBProc: %lx\n"</span>, Object );
00183 }
00184 
00185 
00186 BOOLEAN
<a name="l00187"></a><a class="code" href="../../d3/d3/tob_8c.html#a36">00187</a> <a class="code" href="../../d3/d3/tob_8c.html#a36">obtest</a>( <span class="keywordtype">void</span> )
00188 {
00189     ULONG i;
00190     HANDLE Handles[ 2 ];
00191     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00192     <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">OBJECT_TYPE_INITIALIZER</a> ObjectTypeInitializer;
00193 
00194     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00195 
00196     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a13">ObjectTypeAName</a>, <span class="stringliteral">"ObjectTypeA"</span> );
00197     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a14">ObjectTypeBName</a>, <span class="stringliteral">"ObjectTypeB"</span> );
00198 
00199     RtlZeroMemory( &amp;ObjectTypeInitializer, <span class="keyword">sizeof</span>( ObjectTypeInitializer ) );
00200     ObjectTypeInitializer.Length = <span class="keyword">sizeof</span>( ObjectTypeInitializer );
00201     ObjectTypeInitializer.ValidAccessMask = -1;
00202 
00203     ObjectTypeInitializer.PoolType = <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>;
00204     ObjectTypeInitializer.MaintainHandleCount = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00205     ObjectTypeInitializer.DumpProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a29">DumpAProc</a>;
00206     ObjectTypeInitializer.OpenProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a30">OpenAProc</a>;
00207     ObjectTypeInitializer.CloseProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a31">CloseAProc</a>;
00208     ObjectTypeInitializer.DeleteProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a32">DeleteAProc</a>;
00209     ObjectTypeInitializer.ParseProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a33">ParseAProc</a>;
00210     <a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(
00211         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a13">ObjectTypeAName</a>,
00212         &amp;ObjectTypeInitializer,
00213         (PSECURITY_DESCRIPTOR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00214         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>
00215         );
00216 
00217     ObjectTypeInitializer.PoolType = <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>;
00218     ObjectTypeInitializer.MaintainHandleCount = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00219     ObjectTypeInitializer.GenericMapping = <a class="code" href="../../d3/d3/tob_8c.html#a0">MyGenericMapping</a>;
00220     ObjectTypeInitializer.DumpProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a34">DumpBProc</a>;
00221     ObjectTypeInitializer.OpenProcedure = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00222     ObjectTypeInitializer.CloseProcedure = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00223     ObjectTypeInitializer.DeleteProcedure = <a class="code" href="../../d3/d3/tob_8c.html#a35">DeleteBProc</a>;
00224     ObjectTypeInitializer.ParseProcedure = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00225     <a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(
00226         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a14">ObjectTypeBName</a>,
00227         &amp;ObjectTypeInitializer,
00228         (PSECURITY_DESCRIPTOR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00229         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>
00230         );
00231 
00232     ObpDumpTypes( <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00233 
00234     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a8">DirectoryName</a>, <span class="stringliteral">"\\MyObjects"</span> );
00235     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a5">DirectoryObjA</a>,
00236                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a8">DirectoryName</a>,
00237                                 OBJ_PERMANENT |
00238                                 OBJ_CASE_INSENSITIVE,
00239                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00240                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00241                               );
00242     <a class="code" href="../../d8/d0/obdir_8c.html#a0">NtCreateDirectoryObject</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a23">DirectoryHandle</a>,
00243                              0,
00244                              &amp;<a class="code" href="../../d3/d3/tob_8c.html#a5">DirectoryObjA</a>
00245                            );
00246     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a23">DirectoryHandle</a> );
00247 
00248     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a9">ObjectAName</a>, <span class="stringliteral">"\\myobjects\\ObjectA"</span> );
00249     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00250                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a9">ObjectAName</a>,
00251                                 OBJ_CASE_INSENSITIVE,
00252                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00253                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00254                               );
00255 
00256     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a10">ObjectBName</a>, <span class="stringliteral">"\\myobjects\\ObjectB"</span> );
00257     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a7">ObjectBObjA</a>,
00258                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a10">ObjectBName</a>,
00259                                 OBJ_CASE_INSENSITIVE,
00260                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00261                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00262                               );
00263 
00264     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d0/obcreate_8c.html#a5">ObCreateObject</a>(
00265         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00266         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00267         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00268         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00269         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00270         (ULONG)<span class="keyword">sizeof</span>( <a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html">OBJECTTYPEA</a> ),
00271         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00272         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00273         (PVOID *)&amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>
00274         );
00275 
00276     <a class="code" href="../../d3/d3/tob_8c.html#a21">ObjectA</a> = (<a class="code" href="../../d3/d3/tob_8c.html#a2">POBJECTTYPEA</a>)<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>;
00277     <a class="code" href="../../d3/d3/tob_8c.html#a21">ObjectA</a>-&gt;<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o1">TypeALength</a> = <span class="keyword">sizeof</span>( *ObjectA );
00278     <span class="keywordflow">for</span> (i=0; i&lt;4; i++) {
00279         <a class="code" href="../../d3/d3/tob_8c.html#a21">ObjectA</a>-&gt;<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o2">Stuff</a>[i] = i+1;
00280         }
00281     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a21">ObjectA</a>-&gt;<a class="code" href="../../d6/d6/struct__OBJECTTYPEA.html#o0">Event</a>, NotificationEvent, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00282 
00283     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d0/obcreate_8c.html#a5">ObCreateObject</a>(
00284         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00285         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00286         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a7">ObjectBObjA</a>,
00287         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00288         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00289         (ULONG)<span class="keyword">sizeof</span>( <a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html">OBJECTTYPEB</a> ),
00290         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00291         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00292         (PVOID *)&amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>
00293         );
00294 
00295     <a class="code" href="../../d3/d3/tob_8c.html#a22">ObjectB</a> = (<a class="code" href="../../d3/d3/tob_8c.html#a4">POBJECTTYPEB</a>)<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>;
00296     <a class="code" href="../../d3/d3/tob_8c.html#a22">ObjectB</a>-&gt;<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o1">TypeBLength</a> = <span class="keyword">sizeof</span>( *ObjectB );
00297     <span class="keywordflow">for</span> (i=0; i&lt;16; i++) {
00298         <a class="code" href="../../d3/d3/tob_8c.html#a22">ObjectB</a>-&gt;<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o2">Stuff</a>[i] = i+1;
00299         }
00300     <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a> ( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a22">ObjectB</a>-&gt;<a class="code" href="../../d7/d6/struct__OBJECTTYPEB.html#o0">Semaphore</a>, 2<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>, 2<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> );
00301 
00302     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d1/obinsert_8c.html#a0">ObInsertObject</a>(
00303         <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00304         SYNCHRONIZE | 0x3,
00305         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00306         1,
00307         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00308         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>
00309         );
00310 
00311     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Status: %lx  ObjectBodyA: %lx  ObjectHandleA1: %lx\n"</span>,
00312              <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>, <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>, <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>
00313            );
00314 
00315     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d1/obinsert_8c.html#a0">ObInsertObject</a>(
00316         <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00317         SYNCHRONIZE | 0x1,
00318         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00319         1,
00320         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00321         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>
00322         );
00323 
00324     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Status: %lx  ObjectBodyB: %lx  ObjectHandleB1: %lx\n"</span>,
00325              <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>, <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>, <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>
00326            );
00327 
00328     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00329 
00330     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a9">ObjectAName</a>, <span class="stringliteral">"\\MyObjects\\ObjectA"</span> );
00331     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00332                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a9">ObjectAName</a>,
00333                                 OBJ_OPENIF,
00334                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00335                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00336                               );
00337 
00338     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d0/obcreate_8c.html#a5">ObCreateObject</a>(
00339         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00340         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00341         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00342         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00343         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00344         (ULONG)<span class="keyword">sizeof</span>( <a class="code" href="../../d3/d3/tob_8c.html#a1">OBJECTTYPEA</a> ),
00345         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00346         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00347         (PVOID *)&amp;<a class="code" href="../../d3/d3/tob_8c.html#a19">ObjectBodyA1</a>
00348         );
00349 
00350 
00351     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d1/obinsert_8c.html#a0">ObInsertObject</a>(
00352         <a class="code" href="../../d3/d3/tob_8c.html#a19">ObjectBodyA1</a>,
00353         SYNCHRONIZE | 0x3,
00354         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00355         1,
00356         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a20">ObjectBodyA2</a>,
00357         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>
00358         );
00359 
00360     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Status: %lx  ObjectBodyA1: %lx  ObjectBodyA2: %lx  ObjectHandleA2: %lx\n"</span>,
00361              <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>, <a class="code" href="../../d3/d3/tob_8c.html#a19">ObjectBodyA1</a>, <a class="code" href="../../d3/d3/tob_8c.html#a20">ObjectBodyA2</a>, <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>
00362            );
00363 
00364     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00365     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a> );
00366     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a20">ObjectBodyA2</a> );    <span class="comment">// ObInsertObject,ObjectPointerBias</span>
00367 
00368     <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00369     Handles[ 0 ] = <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>;
00370     Handles[ 1 ] = <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>;
00371     <a class="code" href="../../d1/d2/obwait_8c.html#a5">NtWaitForMultipleObjects</a>( 2, Handles, WaitAny, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00372 
00373     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00374         <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>,
00375         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00376         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00377         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00378         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00379         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00380         );
00381 
00382     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00383         <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>,
00384         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00385         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00386         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00387         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00388         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00389         );
00390     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>, <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );
00391 
00392     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>, <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00393 
00394     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00395 
00396     <a class="code" href="../../d7/d1/obref_8c.html#a6">ObReferenceObjectByPointer</a>(
00397         <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00398         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00399         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00400         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>
00401         );
00402 
00403     <a class="code" href="../../d7/d1/obref_8c.html#a6">ObReferenceObjectByPointer</a>(
00404         <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00405         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00406         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00407         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>
00408         );
00409 
00410     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00411 
00412     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>, <span class="stringliteral">"\\MyObjects\\ObjectA"</span> );
00413     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>, <span class="stringliteral">"\\MyObjects\\ObjectB"</span> );
00414     <a class="code" href="../../d7/d1/obref_8c.html#a5">ObReferenceObjectByName</a>(
00415         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>,
00416         OBJ_CASE_INSENSITIVE,
00417         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00418         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00419         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00420         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00421         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>
00422         );
00423 
00424     <a class="code" href="../../d7/d1/obref_8c.html#a5">ObReferenceObjectByName</a>(
00425         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>,
00426         OBJ_CASE_INSENSITIVE,
00427         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00428         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00429         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00430         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00431         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>
00432         );
00433 
00434     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Name %s = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>.Buffer,
00435             <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );
00436 
00437     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Name %s = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>.Buffer,
00438             <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00439 
00440     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00441 
00442     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObInsertObject,ObjectPointerBias</span>
00443     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00444 
00445     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObReferenceObjectByHandle</span>
00446     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00447 
00448     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObReferenceObjectByPointer</span>
00449     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00450 
00451     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObReferenceObjectByName</span>
00452     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00453 
00454     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00455 
00456     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00457                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>,
00458                                 OBJ_CASE_INSENSITIVE,
00459                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00460                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00461                               );
00462     <a class="code" href="../../d7/d1/obref_8c.html#a2">ObOpenObjectByName</a>(
00463         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a6">ObjectAObjA</a>,
00464         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00465         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00466         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00467         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00468         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00469         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>
00470         );
00471 
00472     InitializeObjectAttributes( &amp;<a class="code" href="../../d3/d3/tob_8c.html#a7">ObjectBObjA</a>,
00473                                 &amp;<a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>,
00474                                 OBJ_CASE_INSENSITIVE,
00475                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00476                                 <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00477                               );
00478     <a class="code" href="../../d7/d1/obref_8c.html#a2">ObOpenObjectByName</a>(
00479         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a7">ObjectBObjA</a>,
00480         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00481         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00482         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00483         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00484         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00485         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a>
00486         );
00487 
00488     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Open Object Name %s = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a11">ObjectAPathName</a>.Buffer,
00489             <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a> );
00490 
00491     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Open Object Name %s = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a12">ObjectBPathName</a>.Buffer,
00492             <a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a> );
00493 
00494     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00495 
00496     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a> );
00497     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a> );
00498 
00499     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00500 
00501     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00502         <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>,
00503         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00504         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00505         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00506         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00507         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00508         );
00509 
00510     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00511         <a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a>,
00512         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00513         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00514         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00515         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00516         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00517         );
00518     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a>, <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );
00519 
00520     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a>, <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00521 
00522     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00523 
00524     <a class="code" href="../../d7/d1/obref_8c.html#a3">ObOpenObjectByPointer</a>(
00525         <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00526         OBJ_CASE_INSENSITIVE,
00527         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00528         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00529         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00530         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00531         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>
00532         );
00533 
00534     <a class="code" href="../../d7/d1/obref_8c.html#a3">ObOpenObjectByPointer</a>(
00535         <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00536         OBJ_CASE_INSENSITIVE,
00537         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00538         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00539         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00540         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00541         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>
00542         );
00543 
00544     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Open Object Pointer %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00545             <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a> );
00546 
00547     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Open Object Pointer %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00548             <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a> );
00549 
00550     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00551 
00552     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00553         <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>,
00554         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00555         <a class="code" href="../../d3/d3/tob_8c.html#a15">ObjectTypeA</a>,
00556         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00557         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a>,
00558         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00559         );
00560 
00561     <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(
00562         <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>,
00563         0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
00564         <a class="code" href="../../d3/d3/tob_8c.html#a16">ObjectTypeB</a>,
00565         <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>,
00566         &amp;<a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a>,
00567         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00568         );
00569     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a>, <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );
00570 
00571     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"Reference Handle %lx = %lx\n"</span>, <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a>, <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00572 
00573     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00574 
00575     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObReferenceObjectByHandle</span>
00576     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00577 
00578     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a17">ObjectBodyA</a> );     <span class="comment">// ObReferenceObjectByHandle</span>
00579     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>( <a class="code" href="../../d3/d3/tob_8c.html#a18">ObjectBodyB</a> );
00580 
00581     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a24">ObjectHandleA1</a> );
00582     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a25">ObjectHandleB1</a> );
00583 
00584     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a26">ObjectHandleA2</a> );
00585     <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( <a class="code" href="../../d3/d3/tob_8c.html#a27">ObjectHandleB2</a> );
00586 
00587     ObpDumpObjectTable( <a class="code" href="../../d5/d1/obp_8h.html#a12">ObpGetObjectTable</a>(), <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
00588 
00589     <a class="code" href="../../d4/d0/tex_8c.html#a2">TestFunction</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00590 
00591     <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00592 }
00593 
00594 
00595 <span class="keywordtype">int</span>
00596 _CDECL
<a name="l00597"></a><a class="code" href="../../d3/d3/tob_8c.html#a37">00597</a> <a class="code" href="../../d2/d5/editreg_8c.html#a87">main</a>(
00598     <span class="keywordtype">int</span> argc,
00599     <span class="keywordtype">char</span> *argv[]
00600     )
00601 {
00602 <span class="preprocessor">#ifdef SIMULATOR</span>
00603 <span class="preprocessor"></span>    <span class="keyword">extern</span> ULONG <a class="code" href="../../d2/d1/mm_8h.html#a136">MmNumberOfPhysicalPages</a>;
00604     <span class="keywordtype">char</span> *s;
00605 
00606     <span class="keywordflow">while</span> (--argc) {
00607         s = *++argv;
00608         <span class="keywordflow">if</span> (*s == <span class="charliteral">'-'</span>) {
00609             s++;
00610             <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">'0'</span> &amp;&amp; *s &lt;= <span class="charliteral">'9'</span>) {
00611                 <a class="code" href="../../d2/d1/mm_8h.html#a136">MmNumberOfPhysicalPages</a> = atol( s );
00612                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with %d pages of physical memory.\n"</span>,
00613                           <a class="code" href="../../d2/d1/mm_8h.html#a136">MmNumberOfPhysicalPages</a>
00614                         );
00615                 }
00616             <span class="keywordflow">else</span>
00617             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"SCR"</span> )) {
00618                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_SCREEN;
00619                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with Screen device driver.\n"</span> );
00620                 }
00621             <span class="keywordflow">else</span>
00622             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"MOU"</span> )) {
00623                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_MOUSE;
00624                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with Mouse device driver.\n"</span> );
00625                 }
00626             <span class="keywordflow">else</span>
00627             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"KBD"</span> )) {
00628                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_KEYBOARD;
00629                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with Keyboard device driver.\n"</span> );
00630                 }
00631             <span class="keywordflow">else</span>
00632             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"RAW"</span> )) {
00633                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_RAWFS;
00634                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with RAW File System driver.\n"</span> );
00635                 }
00636             <span class="keywordflow">else</span>
00637             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"FAT"</span> )) {
00638                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_FATFS;
00639                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured with FAT File System driver.\n"</span> );
00640                 }
00641             <span class="keywordflow">else</span>
00642             <span class="keywordflow">if</span> (!strcmp( s, <span class="stringliteral">"SVR"</span> )) {
00643                 <a class="code" href="../../d7/d2/tmcb_8c.html#a0">IoInitIncludeDevices</a> |= IOINIT_DDFS |
00644                                         IOINIT_FATFS |
00645                                         IOINIT_SERVER_FSD |
00646                                         IOINIT_SERVER_LOOPBACK |
00647                                         IOINIT_NBF;
00648                 <span class="keywordflow">if</span> ( <a class="code" href="../../d2/d1/mm_8h.html#a136">MmNumberOfPhysicalPages</a> &lt; 512 ) {
00649                     <a class="code" href="../../d2/d1/mm_8h.html#a136">MmNumberOfPhysicalPages</a> = 512;
00650                 }
00651                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Configured for LAN Manager server.\n"</span> );
00652                 }
00653             <span class="keywordflow">else</span> {
00654                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"INIT: Invalid switch - %s\n"</span>, s );
00655                 }
00656             }
00657         <span class="keywordflow">else</span> {
00658             <span class="keywordflow">break</span>;
00659             }
00660         }
00661 
00662 <span class="preprocessor">#endif // SIMULATOR</span>
00663 <span class="preprocessor"></span>    <a class="code" href="../../d4/d0/tex_8c.html#a2">TestFunction</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00664     <a class="code" href="../../d8/d1/init_8h.html#a22">KiSystemStartup</a>();
00665     <span class="keywordflow">return</span>( 0 );
00666 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:00 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
