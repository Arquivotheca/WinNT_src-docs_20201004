<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: hsz.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>hsz.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d5/d1/hsz_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a0">DdeCreateStringHandleA</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, LPCSTR psz, int iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a1">DdeCreateStringHandleW</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, LPCWSTR psz, int iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a2">InternalDdeCreateStringHandle</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, PVOID psz, int iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a3">DdeQueryStringA</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz, LPSTR psz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchMax, <a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a> iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a4">DdeQueryStringW</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz, LPWSTR psz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchMax, <a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a> iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a5">InternalDdeQueryString</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz, PVOID psz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbMax, <a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a> iCodePage)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a6">DdeFreeStringHandle</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a7">DdeKeepStringHandle</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a8">DdeCmpStringHandles</a> (HSZ hsz1, HSZ hsz2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a> (HSZ hsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a10">MakeInstSpecificAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, HWND hwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a11">ParseInstSpecificAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *plaNormal)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a13">GlobalToLocalAtom</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> ga)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> ga)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a> (<a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> la)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a8" doxytag="hsz.c::DdeCmpStringHandles" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int DdeCmpStringHandles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00317">317</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
<pre class="fragment"><div>00320 {
00321     <span class="keywordflow">if</span> (hsz2 &gt; hsz1) {
00322         <span class="keywordflow">return</span> (-1);
00323     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hsz2 &lt; hsz1) {
00324         <span class="keywordflow">return</span> (1);
00325     } <span class="keywordflow">else</span> {
00326         <span class="keywordflow">return</span> (0);
00327     }
00328 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="hsz.c::DdeCreateStringHandleA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HSZ DdeCreateStringHandleA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00024">24</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>.
<p>
<pre class="fragment"><div>00028 {
00029     <span class="keywordflow">if</span> (iCodePage == 0) {
00030         iCodePage = CP_WINANSI;
00031     }
00032     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a2">InternalDdeCreateStringHandle</a>(idInst, (PVOID)psz, iCodePage));
00033 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="hsz.c::DdeCreateStringHandleW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HSZ DdeCreateStringHandleW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00036">36</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">InternalDdeCreateStringHandle()</a>.
<p>
<pre class="fragment"><div>00040 {
00041     <span class="keywordflow">if</span> (iCodePage == 0) {
00042         iCodePage = CP_WINUNICODE;
00043     }
00044     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a2">InternalDdeCreateStringHandle</a>(idInst, (PVOID)psz, iCodePage));
00045 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="hsz.c::DdeFreeStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DdeFreeStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">227</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00029">MONHSZ</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
<pre class="fragment"><div>00230 {
00231     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00232     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00233 
00234     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00235 
00236     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00237     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00238         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00239         <span class="keywordflow">goto</span> Exit;
00240     }
00241 
00242     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hsz) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00243         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00244         <span class="keywordflow">goto</span> Exit;
00245     }
00246 
00247     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a3">MONHSZ</a>(pcii, hsz, MH_DELETE);
00248     fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00249     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz) != 0) {
00250         <span class="keywordflow">if</span> (DeleteAtom(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz))) {
00251             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00252             fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00253         }
00254     }
00255 
00256 Exit:
00257     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00258     <span class="keywordflow">return</span> (fRet);
00259 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="hsz.c::DdeKeepStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DdeKeepStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">272</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00029">MONHSZ</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
<pre class="fragment"><div>00275 {
00276     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00277     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00278 
00279     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00280 
00281     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00282     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00283         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00284         <span class="keywordflow">goto</span> Exit;
00285     }
00286 
00287     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hsz) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00288         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00289         <span class="keywordflow">goto</span> Exit;
00290     }
00291 
00292     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz) == 0) {
00293         fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00294         <span class="keywordflow">goto</span> Exit;
00295     }
00296     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a3">MONHSZ</a>(pcii, hsz, MH_KEEP);
00297     fRet = <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz)) ? <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00298 
00299 Exit:
00300     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00301     <span class="keywordflow">return</span> (fRet);
00302 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="hsz.c::DdeQueryStringA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> DdeQueryStringA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00113">113</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>.
<p>
<pre class="fragment"><div>00119 {
00120     <span class="keywordflow">if</span> (iCodePage == 0) {
00121         iCodePage = CP_WINANSI;
00122     }
00123     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a5">InternalDdeQueryString</a>(idInst, hsz, psz, cchMax, iCodePage));
00124 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="hsz.c::DdeQueryStringW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> DdeQueryStringW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00127">127</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>.
<p>
<pre class="fragment"><div>00133 {
00134     <span class="keywordflow">if</span> (iCodePage == 0) {
00135         iCodePage = CP_WINUNICODE;
00136     }
00137     <span class="keywordflow">return</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a5">InternalDdeQueryString</a>(idInst, hsz, psz, cchMax * <span class="keyword">sizeof</span>(WCHAR), iCodePage));
00138 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="hsz.c::GlobalToLocalAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> GlobalToLocalAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ga</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00464">464</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00719">ClRespUnadviseAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00362">ClSpontAdviseData()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00470">SvRespAdviseDataAck()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00112">SvSpontAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01042">SvSpontPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01207">SvSpontRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00640">SvSpontUnadvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01624">TransactionComplete()</a>.
<p>
<pre class="fragment"><div>00466 {
00467     WCHAR sz[256];
00468 
00469     <span class="keywordflow">if</span> (ga == 0) {
00470         <span class="keywordflow">return</span> (0);
00471     }
00472     <span class="keywordflow">if</span> (GlobalGetAtomName((ATOM)ga, sz, 256) == 0) {
00473         RIPMSG0(RIP_WARNING, <span class="stringliteral">"GlobalToLocalAtom out of memory"</span>);
00474         <span class="keywordflow">return</span> (0);
00475     }
00476     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)AddAtom(sz));
00477 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="hsz.c::IncGlobalAtomCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> IncGlobalAtomCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ga</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">490</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01012">ClStartPoke()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01176">ClStartRequest()</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00561">ClStartUnadvise()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d0/d6/register_8c-source.html#l00030">SendRegisterMessageToClass()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00263">SvStartAdviseUpdate()</a>.
<p>
<pre class="fragment"><div>00492 {
00493     WCHAR sz[256];
00494 
00495     <span class="keywordflow">if</span> (ga == 0) {
00496         <span class="keywordflow">return</span> (0);
00497     }
00498     <span class="keywordflow">if</span> (GlobalGetAtomName(ga, sz, 256) == 0) {
00499         RIPMSG0(RIP_WARNING, <span class="stringliteral">"IncGlobalAtomCount out of memory"</span>);
00500         <span class="keywordflow">return</span> (0);
00501     }
00502     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)GlobalAddAtom(sz));
00503 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="hsz.c::IncLocalAtomCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> IncLocalAtomCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>la</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">516</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/util_8c-source.html#l00023">AddLink()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00518 {
00519     WCHAR sz[256];
00520 
00521     <span class="keywordflow">if</span> (la == 0) {
00522         <span class="keywordflow">return</span> (0);
00523     }
00524     <span class="keywordflow">if</span> (GetAtomName(la, sz, 256) == 0) {
00525         RIPMSG0(RIP_WARNING, <span class="stringliteral">"IncLocalAtomCount out of memory"</span>);
00526         <span class="keywordflow">return</span> (0);
00527     }
00528     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>)AddAtom(sz));
00529 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="hsz.c::InternalDdeCreateStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HSZ InternalDdeCreateStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00049">49</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00029">MONHSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00024">DdeCreateStringHandleA()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00036">DdeCreateStringHandleW()</a>.
<p>
<pre class="fragment"><div>00053 {
00054     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00055     HSZ hszRet = 0;
00056     <span class="keywordtype">int</span> cb;
00057     WCHAR szw[256];
00058 
00059     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00060 
00061     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00062     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00063         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00064         <span class="keywordflow">goto</span> Exit;
00065     }
00066 
00067     <span class="keywordflow">switch</span> (iCodePage) {
00068     <span class="keywordflow">case</span> CP_WINANSI:
00069         <span class="keywordflow">if</span> (*(LPSTR)psz == <span class="charliteral">'\0'</span>) {
00070             <span class="keywordflow">goto</span> Exit;
00071         }
00072         hszRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(AddAtomA((LPSTR)psz));
00073         <span class="keywordflow">break</span>;
00074 
00075     <span class="keywordflow">default</span>:
00076 
00077         <span class="comment">/*</span>
00078 <span class="comment">         * Convert psz to unicode and fall through.</span>
00079 <span class="comment">         */</span>
00080         cb = <span class="keyword">sizeof</span>(szw) /  <span class="keyword">sizeof</span>(WCHAR);
00081 <span class="preprocessor">#ifdef LATER</span>
00082 <span class="preprocessor"></span>        MultiByteToWideChar((UINT)iCodePage, MB_PRECOMPOSED,
00083                             (LPSTR)psz, -1, szw, cb);
00084 <span class="preprocessor">#endif</span>
00085 <span class="preprocessor"></span>        psz = &amp;szw[0];
00086 
00087 
00088     <span class="keywordflow">case</span> CP_WINUNICODE:
00089         <span class="keywordflow">if</span> (*(LPWSTR)psz == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>) {
00090             <span class="keywordflow">goto</span> Exit;
00091         }
00092         hszRet = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(AddAtomW((LPWSTR)psz));
00093         <span class="keywordflow">break</span>;
00094     }
00095     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a3">MONHSZ</a>(pcii, hszRet, MH_CREATE);
00096 
00097 Exit:
00098     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00099     <span class="keywordflow">return</span> (hszRet);
00100 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="hsz.c::InternalDdeQueryString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> InternalDdeQueryString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>psz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/bench_8h.html#a7">INT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>iCodePage</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">141</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00113">DdeQueryStringA()</a>, and <a class="el" href="../../d5/d1/hsz_8c-source.html#l00127">DdeQueryStringW()</a>.
<p>
<pre class="fragment"><div>00147 {
00148     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00149     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwRet = 0;
00150     WCHAR szw[256];
00151 <span class="comment">// BOOL fDefUsed; // LATER</span>
00152 
00153     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00154 
00155     pcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>((HANDLE)LongToHandle( idInst ));
00156     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00157         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00158         <span class="keywordflow">goto</span> Exit;
00159     }
00160 
00161     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hsz) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00162         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00163         <span class="keywordflow">goto</span> Exit;
00164     }
00165 
00166     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz) == 0) {
00167         <span class="keywordflow">if</span> (iCodePage == CP_WINUNICODE) {
00168             <span class="keywordflow">if</span> (psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00169                 *(LPWSTR)psz = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\0'</span>;
00170             }
00171             dwRet = <span class="keyword">sizeof</span>(WCHAR);
00172             <span class="keywordflow">goto</span> Exit;
00173         } <span class="keywordflow">else</span> {
00174             <span class="keywordflow">if</span> (psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00175                 *(LPSTR)psz = <span class="charliteral">'\0'</span>;
00176             }
00177             dwRet = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>);
00178             <span class="keywordflow">goto</span> Exit;
00179         }
00180     }
00181 
00182     <span class="keywordflow">if</span> (psz == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00183         cbMax = <span class="keyword">sizeof</span>(szw);
00184         psz = (PVOID)szw;
00185     }
00186 
00187     <span class="keywordflow">switch</span> (iCodePage) {
00188     <span class="keywordflow">case</span> CP_WINANSI:
00189         dwRet = GetAtomNameA(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), psz, cbMax);
00190         <span class="keywordflow">break</span>;
00191 
00192     <span class="keywordflow">default</span>:
00193         dwRet = GetAtomNameW(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), (LPWSTR)psz, cbMax / <span class="keyword">sizeof</span>(WCHAR));
00194         <span class="keywordflow">if</span> (iCodePage != CP_WINUNICODE) {
00195 
00196             <span class="comment">/*</span>
00197 <span class="comment">             * convert psz to the appropriate codepage and count the</span>
00198 <span class="comment">             * characters(ie BYTES for DBCS!) to alter dwRet.</span>
00199 <span class="comment">             */</span>
00200 <span class="preprocessor">#ifdef LATER</span>
00201 <span class="preprocessor"></span>            <span class="comment">// Does this routine work in place? (i.e. input and output buffer the same).</span>
00202             WideCharToMultiByte((UINT)iCodePage, 0, szw,
00203                     <span class="keyword">sizeof</span>(szw) /  <span class="keyword">sizeof</span>(WCHAR),
00204                     (LPSTR)psz, cbMax, NULL, &amp;fDefUsed);
00205 <span class="preprocessor">#endif</span>
00206 <span class="preprocessor"></span>            dwRet = cbMax + 1;
00207         }
00208         <span class="keywordflow">break</span>;
00209     }
00210 
00211 Exit:
00212     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00213     <span class="keywordflow">return</span> (dwRet);
00214 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="hsz.c::LocalToGlobalAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> LocalToGlobalAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>la</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">438</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>, and <a class="el" href="../../d1/d0/xact_8c-source.html#l00611">UpdateLinkIfChanged()</a>.
<p>
<pre class="fragment"><div>00440 {
00441     WCHAR sz[256];
00442 
00443     <span class="keywordflow">if</span> (la == 0) {
00444         <span class="keywordflow">return</span> (0);
00445     }
00446     <span class="keywordflow">if</span> (GetAtomName((ATOM)la, sz, 256) == 0) {
00447         RIPMSG0(RIP_WARNING, <span class="stringliteral">"LocalToGlobalAtom out of memory"</span>);
00448         <span class="keywordflow">return</span> (0);
00449     }
00450     <span class="keywordflow">return</span> ((<a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>)GlobalAddAtom(sz));
00451 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="hsz.c::MakeInstSpecificAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> MakeInstSpecificAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwnd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00367">367</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, and <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/register_8c-source.html#l00090">ProcessRegistrationMessage()</a>.
<p>
<pre class="fragment"><div>00370 {
00371     WCHAR sz[256];
00372     LPWSTR psz;
00373 
00374     <span class="keywordflow">if</span> (GetAtomName(la, sz, 256) == 0) {
00375         <span class="keywordflow">return</span> (0);
00376     }
00377 <span class="preprocessor">#ifdef UNICODE</span>
00378 <span class="preprocessor"></span>    psz = sz + wcslen(sz);
00379 <span class="preprocessor">#else</span>
00380 <span class="preprocessor"></span>    psz = sz + <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(sz);
00381 <span class="preprocessor">#endif</span>
00382 <span class="preprocessor"></span>    wsprintf(psz, TEXT(<span class="stringliteral">"(%#p)"</span>), hwnd);
00383     la = AddAtom(sz);
00384     <span class="keywordflow">return</span> (la);
00385 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="hsz.c::ParseInstSpecificAtom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND ParseInstSpecificAtom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>plaNormal</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00398">398</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.
<p>
<pre class="fragment"><div>00401 {
00402     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> sz[256];
00403     LPSTR pszHwnd;
00404     HWND hwnd;
00405 
00406     <span class="comment">/*</span>
00407 <span class="comment">     * LATER- NEED TO MAKE THIS UNICODE BASED WHEN WE GET A SCANF WE CAN USE</span>
00408 <span class="comment">     */</span>
00409     <span class="keywordflow">if</span> (GetAtomNameA(la, sz, 256) == 0) {
00410         <span class="keywordflow">return</span> (0);
00411     }
00412     pszHwnd = strrchr(sz, <span class="charliteral">'('</span>);
00413     <span class="keywordflow">if</span> (pszHwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00414         <span class="keywordflow">return</span> (0);
00415     }
00416     <span class="keywordflow">if</span> (sscanf(pszHwnd, <span class="stringliteral">"(%#p)"</span>, &amp;hwnd) != 1) {
00417         <span class="keywordflow">return</span> (0);
00418     }
00419     <span class="keywordflow">if</span> (plaNormal != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00420         *pszHwnd = <span class="charliteral">'\0'</span>;
00421         *plaNormal = AddAtomA(sz);
00422     }
00423     <span class="keywordflow">return</span> (hwnd);
00424 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="hsz.c::ValidateHSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> ValidateHSZ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSZ&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">340</a> of file <a class="el" href="../../d5/d1/hsz_8c-source.html">hsz.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00067">HSZT_INST_SPECIFIC</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00066">HSZT_NORMAL</a>.
<p>
Referenced by <a class="el" href="../../d5/d1/hsz_8c-source.html#l00227">DdeFreeStringHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00272">DdeKeepStringHandle()</a>, <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00273">DdeNameService()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00141">InternalDdeQueryString()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.
<p>
<pre class="fragment"><div>00342 {
00343     <span class="keywordflow">if</span> (hsz == 0) {
00344         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a11">HSZT_NORMAL</a>);
00345     }
00346     <span class="keywordflow">if</span> (LOWORD((ULONG_PTR)hsz) &lt; 0xC000) {
00347         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>);
00348     }
00349     <span class="keywordflow">if</span> (HIWORD((ULONG_PTR)hsz) == 0) {
00350         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a11">HSZT_NORMAL</a>);
00351     }
00352     <span class="keywordflow">if</span> (HIWORD((ULONG_PTR)hsz) == 1) {
00353         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a12">HSZT_INST_SPECIFIC</a>);
00354     }
00355     <span class="keywordflow">return</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>);
00356 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:06 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
