<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tprefix.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tprefix.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include "nt.h"</code><br>
<code>#include "ntrtl.h"</code><br>

<p>
<a href="../../d5/d3/tprefix_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">_PREFIX_NODE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a0">BUFFER_LENGTH</a>&nbsp;&nbsp;&nbsp;8192</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a1">PREFIXES</a>&nbsp;&nbsp;&nbsp;512</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">_PREFIX_NODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a7">PREFIX_NODE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a8">PPREFIX_NODE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a11">RtlRandom</a> (IN OUT PULONG <a class="el" href="../../d1/d1/theap_8c.html#a17">Seed</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a> (IN ULONG MaxNameLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a13">main</a> (int argc, char *argv[])</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a2">Seed</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSZ&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a5">Buffer</a> [BUFFER_LENGTH]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a> [PREFIXES]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PREFIX_TABLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="tprefix.c::BUFFER_LENGTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BUFFER_LENGTH&nbsp;&nbsp;&nbsp;8192          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00067">67</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="tprefix.c::PREFIXES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PREFIXES&nbsp;&nbsp;&nbsp;512          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00083">83</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a8" doxytag="tprefix.c::PPREFIX_NODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>* <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PPREFIX_NODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00081">81</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="tprefix.c::PREFIX_NODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">_PREFIX_NODE</a>  <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a12" doxytag="tprefix.c::AnotherPrefix" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSZ AnotherPrefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>MaxNameLength</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">282</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
References <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00039">Alphabet</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00035">AlphabetLength</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d6/d9/pnpeisa_8c-source.html#l00036">BUFFER_LENGTH</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00070">NextBufferChar</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00072">RtlRandom()</a>, and <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00032">Seed</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.
<p>
<pre class="fragment"><div>00283 {
00284     ULONG AlphabetPosition;
00285 
00286     ULONG NameLength;
00287     ULONG IndividualNameLength;
00288 
00289     ULONG StartBufferPosition;
00290     ULONG i;
00291     ULONG j;
00292 
00293     <span class="comment">//</span>
00294     <span class="comment">//  Check if there is enough room for another name</span>
00295     <span class="comment">//</span>
00296 
00297     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a> &gt; (<a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">BUFFER_LENGTH</a> - (MaxNameLength * 4))) {
00298         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00299     }
00300 
00301     <span class="comment">//</span>
00302     <span class="comment">//  Where in the alphabet soup we start</span>
00303     <span class="comment">//</span>
00304 
00305     AlphabetPosition = <a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;Seed) % <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>;
00306 
00307     <span class="comment">//</span>
00308     <span class="comment">//  How many names we want in our prefix</span>
00309     <span class="comment">//</span>
00310 
00311     NameLength = (<a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;Seed) % MaxNameLength) + 1;
00312 
00313     <span class="comment">//</span>
00314     <span class="comment">//  Compute each name</span>
00315     <span class="comment">//</span>
00316 
00317     StartBufferPosition = <a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>;
00318 
00319     <span class="keywordflow">for</span> (i = 0; i &lt; NameLength; i += 1) {
00320 
00321         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <span class="charliteral">'\\'</span>;
00322 
00323         IndividualNameLength = (<a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;Seed) % 3) + 1;
00324 
00325         <span class="keywordflow">for</span> (j = 0; j &lt; IndividualNameLength; j += 1) {
00326 
00327             <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <a class="code" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a>[AlphabetPosition];
00328             AlphabetPosition = (AlphabetPosition + 1) % <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>;
00329 
00330         }
00331 
00332     }
00333 
00334     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <span class="charliteral">'\0'</span>;
00335 
00336     <span class="keywordflow">return</span> &amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[StartBufferPosition];
00337 
00338 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="tprefix.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">90</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
References <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00039">Alphabet</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00035">AlphabetLength</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">AnotherPrefix()</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00070">NextBufferChar</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00572">PfxFindPrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00106">PfxInitialize()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00144">PfxInsertPrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00406">PfxRemovePrefix()</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00081">PPREFIX_NODE</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00083">PREFIXES</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00085">Prefixes</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00087">PrefixTable</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00032">Seed</a>, <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00079">_PREFIX_NODE::String</a>, <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00094 {
00095     ULONG i;
00096     PSZ Psz;
00097 
00098     PPREFIX_TABLE_ENTRY PfxEntry;
00099     <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PPREFIX_NODE</a> PfxNode;
00100 
00101     STRING <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>;
00102 
00103     <span class="comment">//</span>
00104     <span class="comment">//  We're starting the test</span>
00105     <span class="comment">//</span>
00106 
00107     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Start Prefix Test\n"</span>);
00108 
00109     <span class="comment">//</span>
00110     <span class="comment">//  Calculate the alphabet size for use by AnotherPrefix</span>
00111     <span class="comment">//</span>
00112 
00113     <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(Alphabet);
00114 
00115     <span class="comment">//</span>
00116     <span class="comment">//  Initialize the prefix table</span>
00117     <span class="comment">//</span>
00118 
00119     <a class="code" href="../../d4/d4/prefix_8c.html#a16">PfxInitialize</a>(&amp;PrefixTable);
00120 
00121     <span class="comment">//</span>
00122     <span class="comment">//  Insert the root prefix</span>
00123     <span class="comment">//</span>
00124 
00125     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;Prefixes[i].String, <span class="stringliteral">"\\"</span> );
00126     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/prefix_8c.html#a17">PfxInsertPrefix</a>( &amp;PrefixTable,
00127                          &amp;Prefixes[0].String,
00128                          &amp;Prefixes[0].PfxEntry )) {
00129         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Insert root prefix\n"</span>);
00130     } <span class="keywordflow">else</span> {
00131         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"error inserting root prefix\n"</span>);
00132     }
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">//  Insert prefixes</span>
00136     <span class="comment">//</span>
00137 
00138     <a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a> = 0;
00139 
00140     <span class="keywordflow">for</span> (i = 1, Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(3);
00141          (i &lt; <a class="code" href="../../d4/d4/tprefix_8c.html#a1">PREFIXES</a>) &amp;&amp; (Psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00142          i += 1, Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(3)) {
00143 
00144         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"[0x%x] = "</span>, i);
00145         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\"%s\""</span>, Psz);
00146 
00147         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;Prefixes[i].String, Psz);
00148 
00149         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/prefix_8c.html#a17">PfxInsertPrefix</a>( &amp;PrefixTable,
00150                              &amp;Prefixes[i].String,
00151                              &amp;Prefixes[i].PfxEntry )) {
00152 
00153             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" inserted in table\n"</span>);
00154 
00155         } <span class="keywordflow">else</span> {
00156 
00157             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" already in table\n"</span>);
00158 
00159         }
00160 
00161     }
00162 
00163     <span class="comment">//</span>
00164     <span class="comment">//  Enumerate the prefix table</span>
00165     <span class="comment">//</span>
00166 
00167     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Enumerate Prefix Table the first time\n"</span>);
00168 
00169     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;PrefixTable, TRUE);
00170          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00171          PfxEntry = PfxNextPrefix(&amp;PrefixTable, FALSE)) {
00172 
00173         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00174 
00175         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00176 
00177     }
00178 
00179     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Start Prefix search 0x%x\n"</span>, NextBufferChar);
00180 
00181     <span class="comment">//</span>
00182     <span class="comment">//  Search for prefixes</span>
00183     <span class="comment">//</span>
00184 
00185     <span class="keywordflow">for</span> (Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(4); Psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(4)) {
00186 
00187         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"0x%x "</span>, NextBufferChar);
00188 
00189         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;String, Psz);
00190 
00191         PfxEntry = <a class="code" href="../../d4/d4/prefix_8c.html#a19">PfxFindPrefix</a>( &amp;PrefixTable, &amp;String, FALSE );
00192 
00193         <span class="keywordflow">if</span> (PfxEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00194 
00195             PfxEntry = <a class="code" href="../../d4/d4/prefix_8c.html#a19">PfxFindPrefix</a>( &amp;PrefixTable, &amp;String, TRUE );
00196 
00197             <span class="keywordflow">if</span> (PfxEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00198 
00199                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Not found      \"%s\"\n"</span>, Psz);
00200 
00201                 NOTHING;
00202 
00203             } <span class="keywordflow">else</span> {
00204 
00205                 PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00206 
00207                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Case blind     \"%s\" is \"%s\"\n"</span>, Psz, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00208 
00209                 <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;PrefixTable, PfxEntry );
00210 
00211             }
00212 
00213         } <span class="keywordflow">else</span> {
00214 
00215             PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00216 
00217             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(    <span class="stringliteral">"Case sensitive \"%s\" is \"%s\"\n"</span>, Psz, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00218 
00219             <span class="keywordflow">if</span> (PfxNode != &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[0]) {
00220 
00221                 <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;PrefixTable, PfxEntry );
00222 
00223             }
00224 
00225         }
00226 
00227     }
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">//  Enumerate the prefix table</span>
00231     <span class="comment">//</span>
00232 
00233     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Enumerate Prefix Table a second time\n"</span>);
00234 
00235     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;PrefixTable, TRUE);
00236          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00237          PfxEntry = PfxNextPrefix(&amp;PrefixTable, FALSE)) {
00238 
00239         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00240 
00241         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00242 
00243     }
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">//  Now enumerate and zero out the table</span>
00247     <span class="comment">//</span>
00248 
00249     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;PrefixTable, TRUE);
00250          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00251          PfxEntry = PfxNextPrefix(&amp;PrefixTable, FALSE)) {
00252 
00253         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00254 
00255         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Delete %s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00256 
00257         <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;PrefixTable, PfxEntry );
00258 
00259     }
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">//  Enumerate again but this time the table should be empty</span>
00263     <span class="comment">//</span>
00264 
00265     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;PrefixTable, TRUE);
00266          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00267          PfxEntry = PfxNextPrefix(&amp;PrefixTable, FALSE)) {
00268 
00269         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00270 
00271         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"This Node should be gone \"%s\"\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00272 
00273     }
00274 
00275     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"End PrefixTest()\n"</span>);
00276 
00277     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00278 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="tprefix.c::RtlRandom" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlRandom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Seed</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00072">72</a> of file <a class="el" href="../../d7/d3/rtl_2random_8c-source.html">rtl/random.c</a>.
<p>
<pre class="fragment"><div>00078                    :
00079 
00080     An every better random number generator based on MacLaren and Marsaglia.
00081 
00082 Arguments:
00083 
00084     <a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> random number generator seed.
00085 
00086 Return Value:
00087 
00088     ULONG - returns a random number uniformly distributed over [0..MAXLONG]
00089 
00090 --*/
00091 
00092 {
00093     ULONG X;
00094     ULONG Y;
00095     ULONG j;
00096     ULONG Result;
00097 
00098     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00099 
00100     X = <a class="code" href="../../d6/d4/rtl_2random_8c.html#a3">UniformMacro</a>(Seed);
00101     Y = <a class="code" href="../../d6/d4/rtl_2random_8c.html#a3">UniformMacro</a>(Seed);
00102 
00103     j = Y % 128;
00104 
00105     Result = <a class="code" href="../../d6/d4/rtl_2random_8c.html#a4">RtlpRandomConstantVector</a>[j];
00106 
00107     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a4">RtlpRandomConstantVector</a>[j] = X;
00108 
00109     <span class="keywordflow">return</span> Result;
00110 
00111 }
}
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="tprefix.c::Alphabet" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSZ <a class="el" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> <span class="stringliteral">"\</span>
<span class="stringliteral">Aa\</span>
<span class="stringliteral">BBbb\</span>
<span class="stringliteral">CCCccc\</span>
<span class="stringliteral">DDDDdddd\</span>
<span class="stringliteral">EEEEEeeeee\</span>
<span class="stringliteral">FFFFFFffffff\</span>
<span class="stringliteral">GGGGGGGggggggg\</span>
<span class="stringliteral">HHHHHHHHhhhhhhhh\</span>
<span class="stringliteral">IIIIIIIIIiiiiiiiii\</span>
<span class="stringliteral">JJJJJJJJJJjjjjjjjjjj\</span>
<span class="stringliteral">KKKKKKKKKKKkkkkkkkkkkk\</span>
<span class="stringliteral">LLLLLLLLLLLLllllllllllll\</span>
<span class="stringliteral">MMMMMMMMMMMMMmmmmmmmmmmmmm\</span>
<span class="stringliteral">NNNNNNNNNNNNNNnnnnnnnnnnnnnn\</span>
<span class="stringliteral">OOOOOOOOOOOOOOOooooooooooooooo\</span>
<span class="stringliteral">PPPPPPPPPPPPPPPPpppppppppppppppp\</span>
<span class="stringliteral">QQQQQQQQQQQQQQQQQqqqqqqqqqqqqqqqqq\</span>
<span class="stringliteral">RRRRRRRRRRRRRRRRRRrrrrrrrrrrrrrrrrrr\</span>
<span class="stringliteral">SSSSSSSSSSSSSSSSSSSsssssssssssssssssss\</span>
<span class="stringliteral">TTTTTTTTTTTTTTTTTTTTtttttttttttttttttttt\</span>
<span class="stringliteral">UUUUUUUUUUUUUUUUUUUUUuuuuuuuuuuuuuuuuuuuuu\</span>
<span class="stringliteral">VVVVVVVVVVVVVVVVVVVVVVvvvvvvvvvvvvvvvvvvvvvv\</span>
<span class="stringliteral">WWWWWWWWWWWWWWWWWWWWWWWwwwwwwwwwwwwwwwwwwwwwww\</span>
<span class="stringliteral">XXXXXXXXXXXXXXXXXXXXXXXXxxxxxxxxxxxxxxxxxxxxxxxx\</span>
<span class="stringliteral">YYYYYYYYYYYYYYYYYYYYYYYYYyyyyyyyyyyyyyyyyyyyyyyyyy\</span>
<span class="stringliteral">ZZZZZZZZZZZZZZZZZZZZZZZZZZzzzzzzzzzzzzzzzzzzzzzzzzzz"</span>
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00039">39</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">AnotherPrefix()</a>, and <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="tprefix.c::AlphabetLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00035">35</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">AnotherPrefix()</a>, and <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="tprefix.c::Buffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d1/bench_8h.html#a8">CHAR</a> <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>[BUFFER_LENGTH]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00069">69</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="tprefix.c::NextBufferChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a> = 0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00070">70</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">AnotherPrefix()</a>, and <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="tprefix.c::Prefixes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a> <a class="el" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[PREFIXES]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00085">85</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="tprefix.c::PrefixTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PREFIX_TABLE <a class="el" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00087">87</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00090">main()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00572">PfxFindPrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00106">PfxInitialize()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00144">PfxInsertPrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l01705">RtlFindUnicodePrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l01043">RtlInitializeUnicodePrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l01080">RtlInsertUnicodePrefix()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l01959">RtlNextUnicodePrefix()</a>, and <a class="el" href="../../d5/d3/prefix_8c-source.html#l01393">RtlRemoveUnicodePrefix()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="tprefix.c::Seed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d1/d1/theap_8c.html#a17">Seed</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00032">32</a> of file <a class="el" href="../../d5/d3/tprefix_8c-source.html">tprefix.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/tprefix_8c-source.html#l00282">AnotherPrefix()</a>, <a class="el" href="../../d2/d5/fmtexp_8c-source.html#l00190">ComputeNewSerialNumber()</a>, <a class="el" href="../../d2/d0/theap_8c-source.html#l00077">main()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00532">NtSetUuidSeed()</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00072">RtlRandom()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00520">RtlRunDecodeUnicodeString()</a>, and <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00037">RtlUniform()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
