<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ke.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ke.h File Reference</h1>
<p>
<a href="../../d5/d8/ke_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">_KTHREAD_SWITCH_COUNTERS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d6/struct__DISPATCHER__HEADER.html">_DISPATCHER_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">_KSERVICE_TABLE_DESCRIPTOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">_KBUGCHECK_CALLBACK_RECORD</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a0">CLOCK_QUANTUM_DECREMENT</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a1">WAIT_QUANTUM_DECREMENT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a2">READY_SKIP_QUANTUM</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>&nbsp;&nbsp;&nbsp;(READY_SKIP_QUANTUM * CLOCK_QUANTUM_DECREMENT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a4">ROUND_TRIP_DECREMENT_COUNT</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a5">BASE_PRIORITY_THRESHOLD</a>&nbsp;&nbsp;&nbsp;NORMAL_BASE_PRIORITY</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a6">THREAD_WAIT_OBJECTS</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a7">EVENT_WAIT_BLOCK</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a8">SEMAPHORE_WAIT_BLOCK</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a9">TIMER_WAIT_BLOCK</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a10">TIMER_TABLE_SIZE</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a11">KeGetCurrentApcEnvironment</a>()&nbsp;&nbsp;&nbsp;KeGetCurrentThread()-&gt;ApcStateIndex</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a12">DISPATCHER_OBJECT_TYPE_MASK</a>&nbsp;&nbsp;&nbsp;0x7</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a13">NUMBER_SERVICE_TABLES</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a14">SERVICE_NUMBER_MASK</a>&nbsp;&nbsp;&nbsp;((1 &lt;&lt; 12) -  1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a15">SERVICE_TABLE_SHIFT</a>&nbsp;&nbsp;&nbsp;(12 - 4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a16">SERVICE_TABLE_MASK</a>&nbsp;&nbsp;&nbsp;(((1 &lt;&lt; 2) - 1) &lt;&lt; 4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a17">SERVICE_TABLE_TEST</a>&nbsp;&nbsp;&nbsp;(WIN32K_SERVICE_INDEX &lt;&lt; 4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a18">LISTEN_CHANNEL</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a19">MESSAGE_CHANNEL</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(_Event, _Type, _State)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a21">KeClearEvent</a>(Event)&nbsp;&nbsp;&nbsp;(Event)-&gt;<a class="el" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>.SignalState = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a22">KeSetHighEventPair</a>(EventPair, Increment, Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a23">KeSetLowEventPair</a>(EventPair, Increment, Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a24">KeReadStateMutex</a>(Mutex)&nbsp;&nbsp;&nbsp;KeReadStateMutant(Mutex)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a25">KeIsAttachedProcess</a>()&nbsp;&nbsp;&nbsp;(KeGetCurrentThread()-&gt;ApcStateIndex == AttachedApcEnvironment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a26">KeTerminateProcess</a>(Process)&nbsp;&nbsp;&nbsp;(Process)-&gt;StackCount += 1;</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a27">KiLeaveCriticalRegion</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>()&nbsp;&nbsp;&nbsp;KeGetCurrentThread()-&gt;KernelApcDisable -= 1;</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>()&nbsp;&nbsp;&nbsp;KiLeaveCriticalRegion()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a30">KeSetHighWaitLowEventPair</a>(EventPair, WaitMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a31">KeSetLowWaitHighEventPair</a>(EventPair, WaitMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a32">KeWaitForHighEventPair</a>(EventPair, WaitMode, Alertable, TimeOut)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a33">KeWaitForLowEventPair</a>(EventPair, WaitMode, Alertable, TimeOut)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a34">KeWaitForMutexObject</a>&nbsp;&nbsp;&nbsp;KeWaitForSingleObject</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a35">_DECL_HAL_KE_IMPORT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(OldIrql)&nbsp;&nbsp;&nbsp;*(OldIrql) = KeAcquireSpinLockRaiseToSynch(&amp;<a class="el" href="../../d0/d0/ki_8h.html#a43">KiDispatcherLock</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a>(SpinLock, OldIrql)&nbsp;&nbsp;&nbsp;*(OldIrql) = KeAcquireSpinLockRaiseToDpc(SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a38">KeInitializeCallbackRecord</a>(CallbackRecord)&nbsp;&nbsp;&nbsp;(CallbackRecord)-&gt;State = BufferEmpty</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a39">KeFindFirstSetRightMember</a>(Set)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a40">DMA_READ_DCACHE_INVALIDATE</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a41">DMA_READ_ICACHE_INVALIDATE</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a42">DMA_WRITE_DCACHE_SNOOP</a>&nbsp;&nbsp;&nbsp;0x4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a43">SYSTEM_SERVICE_INDEX</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a44">WIN32K_SERVICE_INDEX</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a45">IIS_SERVICE_INDEX</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">_KTHREAD_SWITCH_COUNTERS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a46">KTHREAD_SWITCH_COUNTERS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">_KTHREAD_SWITCH_COUNTERS</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a47">PKTHREAD_SWITCH_COUNTERS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a402">_KOBJECTS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a48">KOBJECTS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a403">_KAPC_ENVIRONMENT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a49">KAPC_ENVIRONMENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a404">_KINTERRUPT_MODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a50">KINTERRUPT_MODE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a405">_KPROCESS_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a51">KPROCESS_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a406">_KTHREAD_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a52">KTHREAD_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a407">_KWAIT_REASON</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a54">KAPC_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a55">PKAPC_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a56">PRKAPC_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d6/struct__DISPATCHER__HEADER.html">_DISPATCHER_HEADER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a57">DISPATCHER_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a58">KPAGE_FRAME</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a59">KWAIT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a60">PKWAIT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a61">PRKWAIT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">_KSERVICE_TABLE_DESCRIPTOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a62">KSERVICE_TABLE_DESCRIPTOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">_KSERVICE_TABLE_DESCRIPTOR</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a63">PKSERVICE_TABLE_DESCRIPTOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a64">PKDEBUG_ROUTINE</a> )(IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame, IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> PreviousMode, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a65">PKDEBUG_SWITCH_ROUTINE</a> )(IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN BOOLEAN SecondChance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a> )(IN PVOID StartContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a67">PKSYSTEM_ROUTINE</a> )(IN <a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a> StartRoutine OPTIONAL, IN PVOID StartContext OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a68">KDEVICE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a69">PKDEVICE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a70">PRKDEVICE_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a71">KDEVICE_QUEUE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a72">PKDEVICE_QUEUE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a73">PRKDEVICE_QUEUE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a74">KEVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a75">PKEVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a76">PRKEVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a77">KEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a78">PKEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a79">PRKEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a80">PKSERVICE_ROUTINE</a> )(IN struct <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a> *Interrupt, IN PVOID ServiceContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a81">KINTERRUPT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a82">PKINTERRUPT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a> *RESTRICTED_POINTER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a83">PRKINTERRUPT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a84">KMUTANT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a85">PKMUTANT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a86">PRKMUTANT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a87">KMUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a88">PKMUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a89">PRKMUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a90">KQUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a91">PKQUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a92">PRKQUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a93">KSEMAPHORE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a94">PKSEMAPHORE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a95">PRKSEMAPHORE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a96">KTIMER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a97">PKTIMER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a98">PRKTIMER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a99">KTHREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a100">PKTHREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a101">PRKTHREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a102">KPROCESS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a103">PKPROCESS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a104">PRKPROCESS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a105">KPROFILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a106">PKPROFILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a107">PRKPROFILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a409">_ECHANNEL_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a108">ECHANNEL_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a109">ECHANNEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a110">PECHANNEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a111">PRECHANNEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a410">_KBUGCHECK_BUFFER_DUMP_STATE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a112">KBUGCHECK_BUFFER_DUMP_STATE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a113">PKBUGCHECK_CALLBACK_ROUTINE</a> )(IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">_KBUGCHECK_CALLBACK_RECORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a114">KBUGCHECK_CALLBACK_RECORD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">_KBUGCHECK_CALLBACK_RECORD</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a115">PKBUGCHECK_CALLBACK_RECORD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef PCHAR(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a116">PKE_BUGCHECK_UNICODE_TO_ANSI</a> )(IN PUNICODE_STRING UnicodeString, OUT PCHAR AnsiBuffer, IN ULONG MaxAnsiLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a117">PGDI_BATCHFLUSH_ROUTINE</a> )(VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a119">PFIRMWARE_REENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(FASTCALL *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a120">PSWAP_CONTEXT_NOTIFY_ROUTINE</a> )(IN HANDLE OldThreadId, IN HANDLE NewThreadId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef LOGICAL(FASTCALL *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a121">PTHREAD_SELECT_NOTIFY_ROUTINE</a> )(IN HANDLE ThreadId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(FASTCALL *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a122">PTIME_UPDATE_NOTIFY_ROUTINE</a> )(IN HANDLE ThreadId, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> Mode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a412">_MEMORY_CACHING_TYPE_ORIG</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a155">MEMORY_CACHING_TYPE_ORIG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a413">_MEMORY_CACHING_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a156">MEMORY_CACHING_TYPE</a></td></tr>

<tr><td colspan=2><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a402">_KOBJECTS</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a157">EventNotificationObject</a> =  0, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a158">EventSynchronizationObject</a> =  1, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a> =  2, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a> =  3, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a> =  4, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a162">SemaphoreObject</a> =  5, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a> =  6, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a164">Spare1Object</a> =  7, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a165">TimerNotificationObject</a> =  8, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a166">TimerSynchronizationObject</a> =  9, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a167">Spare2Object</a> =  10, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a168">Spare3Object</a> =  11, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a169">Spare4Object</a> =  12, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a170">Spare5Object</a> =  13, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a171">Spare6Object</a> =  14, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a172">Spare7Object</a> =  15, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a173">Spare8Object</a> =  16, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a174">Spare9Object</a> =  17, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a175">ApcObject</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a176">DpcObject</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a402a177">DeviceQueueObject</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a179">InterruptObject</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a402a180">ProfileObject</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a403">_KAPC_ENVIRONMENT</a> { <a class="el" href="../../d4/d9/ke_8h.html#a403a181">OriginalApcEnvironment</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a403a182">AttachedApcEnvironment</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a403a183">CurrentApcEnvironment</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a404">_KINTERRUPT_MODE</a> { <a class="el" href="../../d4/d9/ke_8h.html#a404a184">LevelSensitive</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a404a185">Latched</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a405">_KPROCESS_STATE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a405a186">ProcessInMemory</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a405a187">ProcessOutOfMemory</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a405a189">ProcessInSwap</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a405a190">ProcessOutSwap</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a406">_KTHREAD_STATE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a406a193">Running</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a406a195">Terminated</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a406a197">Transition</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a407">_KWAIT_REASON</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a198">Executive</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a199">FreePage</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a200">PageIn</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a201">PoolAllocation</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a202">DelayExecution</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a203">Suspended</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a204">UserRequest</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a205">WrExecutive</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a206">WrFreePage</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a207">WrPageIn</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a208">WrPoolAllocation</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a209">WrDelayExecution</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a210">WrSuspended</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a211">WrUserRequest</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a212">WrEventPair</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a213">WrQueue</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a214">WrLpcReceive</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a215">WrLpcReply</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a216">WrVirtualMemory</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a217">WrPageOut</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a218">WrRendezvous</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a219">Spare2</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a220">Spare3</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a221">Spare4</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a407a222">Spare5</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a223">Spare6</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a224">WrKernel</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a407a225">MaximumWaitReason</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a> { <a class="el" href="../../d4/d9/ke_8h.html#a408a226">ContinueError</a> =  FALSE, 
<a class="el" href="../../d4/d9/ke_8h.html#a408a227">ContinueSuccess</a> =  TRUE, 
<a class="el" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a408a229">ContinueNextProcessor</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a409">_ECHANNEL_STATE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a409a230">ClientIdle</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a409a231">ClientSendWaitReply</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a409a232">ClientShutdown</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a409a233">ServerIdle</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a409a234">ServerReceiveMessage</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a409a235">ServerShutdown</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a410">_KBUGCHECK_BUFFER_DUMP_STATE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a410a238">BufferStarted</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a410a239">BufferFinished</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a410a240">BufferIncomplete</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a411a241">HalHaltRoutine</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a411a242">HalPowerDownRoutine</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a411a243">HalRestartRoutine</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a411a244">HalRebootRoutine</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a411a245">HalInteractiveModeRoutine</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a411a246">HalMaximumRoutine</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a412">_MEMORY_CACHING_TYPE_ORIG</a> { <a class="el" href="../../d4/d9/ke_8h.html#a412a247">MmFrameBufferCached</a> =  2
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a413">_MEMORY_CACHING_TYPE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a413a248">MmNonCached</a> =  FALSE, 
<a class="el" href="../../d4/d9/ke_8h.html#a413a249">MmCached</a> =  TRUE, 
<a class="el" href="../../d4/d9/ke_8h.html#a413a250">MmWriteCombined</a> =  MmFrameBufferCached, 
<a class="el" href="../../d4/d9/ke_8h.html#a413a251">MmHardwareCoherentCached</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d4/d9/ke_8h.html#a413a252">MmNonCachedUnordered</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a413a253">MmUSWCCached</a>, 
<a class="el" href="../../d4/d9/ke_8h.html#a413a254">MmMaximumCacheType</a>
<br>
 }</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a255">KeInitializeApc</a> (IN <a class="el" href="../../d1/d5/struct__KAPC.html">PRKAPC</a> Apc, IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread, IN <a class="el" href="../../d4/d9/ke_8h.html#a49">KAPC_ENVIRONMENT</a> Environment, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a42">PKKERNEL_ROUTINE</a> KernelRoutine, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a43">PKRUNDOWN_ROUTINE</a> RundownRoutine OPTIONAL, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a41">PKNORMAL_ROUTINE</a> NormalRoutine OPTIONAL, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ProcessorMode OPTIONAL, IN PVOID NormalContext OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PLIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a256">KeFlushQueueApc</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ProcessorMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a257">KeInsertQueueApc</a> (IN <a class="el" href="../../d1/d5/struct__KAPC.html">PRKAPC</a> Apc, IN PVOID SystemArgument1, IN PVOID SystemArgument2, IN KPRIORITY Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a258">KeRemoveQueueApc</a> (IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a259">KeInitializeDpc</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a> Dpc, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a49">PKDEFERRED_ROUTINE</a> DeferredRoutine, IN PVOID DeferredContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a260">KeInsertQueueDpc</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a> Dpc, IN PVOID SystemArgument1, IN PVOID SystemArgument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a261">KeRemoveQueueDpc</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a> Dpc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a262">KeSetImportanceDpc</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a> Dpc, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a50">KDPC_IMPORTANCE</a> Importance)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a263">KeSetTargetProcessorDpc</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a> Dpc, IN CCHAR Number)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a264">KeInitializeDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a265">KeInsertDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue, IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> DeviceQueueEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a266">KeInsertByKeyDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue, IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> DeviceQueueEntry, IN ULONG SortKey)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a267">KeRemoveDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a268">KeRemoveByKeyDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue, IN ULONG SortKey)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a269">KeRemoveEntryDeviceQueue</a> (IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a> DeviceQueue, IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> DeviceQueueEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a270">KeInitializeInterrupt</a> (IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interrupt, IN <a class="el" href="../../d4/d9/ke_8h.html#a80">PKSERVICE_ROUTINE</a> ServiceRoutine, IN PVOID ServiceContext, IN PKSPIN_LOCK SpinLock OPTIONAL, IN ULONG Vector, IN KIRQL Irql, IN KIRQL SynchronizeIrql, IN <a class="el" href="../../d4/d9/ke_8h.html#a50">KINTERRUPT_MODE</a> InterruptMode, IN BOOLEAN ShareVector, IN CCHAR ProcessorNumber, IN BOOLEAN FloatingSave)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a271">KeConnectInterrupt</a> (IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interrupt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a272">KeDisconnectInterrupt</a> (IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interrupt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a273">KeSynchronizeExecution</a> (IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interrupt, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a44">PKSYNCHRONIZE_ROUTINE</a> SynchronizeRoutine, IN PVOID SynchronizeContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a274">KeInitializeProfile</a> (IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a> Profile, IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process OPTIONAL, IN PVOID RangeBase, IN SIZE_T RangeSize, IN ULONG BucketSize, IN ULONG Segment, IN KPROFILE_SOURCE ProfileSource, IN KAFFINITY Affinity)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a275">KeStartProfile</a> (IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a> Profile, IN PULONG <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a276">KeStopProfile</a> (IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a> Profile)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a277">KeSetIntervalProfile</a> (IN ULONG Interval, IN KPROFILE_SOURCE Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a278">KeQueryIntervalProfile</a> (IN KPROFILE_SOURCE Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a279">KePulseEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN KPRIORITY Increment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a280">KeReadStateEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a281">KeResetEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a282">KeSetEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN KPRIORITY Increment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a283">KeSetEventBoostPriority</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a> Event, IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *Thread OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a284">KeInitializeEventPair</a> (IN <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PKEVENT_PAIR</a> EventPair)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a285">KeInitializeMutant</a> (IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a> Mutant, IN BOOLEAN InitialOwner)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a286">KeReadStateMutant</a> (IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a287">KeReleaseMutant</a> (IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a> Mutant, IN KPRIORITY Increment, IN BOOLEAN Abandoned, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a288">KeInitializeMutex</a> (IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTEX</a> Mutex, IN ULONG Level)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a289">KeReleaseMutex</a> (IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTEX</a> Mutex, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a290">KeInitializeQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue, IN ULONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a> OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a291">KeReadStateQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a292">KeInsertQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue, IN PLIST_ENTRY Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a293">KeInsertHeadQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue, IN PLIST_ENTRY Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PLIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a294">KeRemoveQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> WaitMode, IN PLARGE_INTEGER Timeout OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PLIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a295">KeRundownQueue</a> (IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a296">KeInitializeSemaphore</a> (IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a> Semaphore, IN LONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a>, IN LONG Limit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a297">KeReadStateSemaphore</a> (IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a> Semaphore)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a298">KeReleaseSemaphore</a> (IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a> Semaphore, IN KPRIORITY Increment, IN LONG Adjustment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a299">KeInitializeProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> Process, IN KPRIORITY Priority, IN KAFFINITY Affinity, IN ULONG_PTR DirectoryTableBase[2], IN BOOLEAN Enable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LOGICAL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a300">KeForceAttachProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a301">KeAttachProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a302">KeDetachProcess</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a303">KeStackAttachProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> PROCESS, OUT <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PRKAPC_STATE</a> ApcState)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a304">KeUnstackDetachProcess</a> (IN <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PRKAPC_STATE</a> ApcState)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a305">KeReadStateProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a306">KeSetAutoAlignmentProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> Process, IN BOOLEAN Enable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a307">KeSetProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a> Process, IN KPRIORITY Increment, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KPRIORITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a308">KeSetPriorityProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process, IN KPRIORITY BasePriority)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LOGICAL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a309">KeSetDisableQuantumProcess</a> (IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process, IN LOGICAL Disable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a310">KeInitializeThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN PVOID KernelStack, IN <a class="el" href="../../d4/d9/ke_8h.html#a67">PKSYSTEM_ROUTINE</a> SystemRoutine, IN <a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a> StartRoutine OPTIONAL, IN PVOID StartContext OPTIONAL, IN PCONTEXT ContextFrame OPTIONAL, IN PVOID Teb OPTIONAL, IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a311">KeAlertThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ProcessorMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a312">KeAlertResumeThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a313">KeBoostCurrentThread</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a314">KeBoostPriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN KPRIORITY Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KAFFINITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a315">KeConfineThread</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a316">KeDelayExecutionThread</a> (IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> WaitMode, IN BOOLEAN Alertable, IN PLARGE_INTEGER Interval)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a317">KeDisableApcQueuingThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a318">KeEnableApcQueuingThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LOGICAL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a319">KeSetDisableBoostThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN LOGICAL Disable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a320">KeForceResumeThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a321">KeFreezeAllThreads</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a322">KeQueryAutoAlignmentThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a323">KeQueryBasePriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KPRIORITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a324">KeQueryPriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a325">KeReadStateThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a326">KeReadyThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a327">KeResumeThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a328">KeRevertToUserAffinityThread</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a329">KeRundownThread</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KAFFINITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a330">KeSetAffinityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN KAFFINITY Affinity)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a331">KeSetSystemAffinityThread</a> (IN KAFFINITY Affinity)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a332">KeSetAutoAlignmentThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN BOOLEAN Enable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a333">KeSetBasePriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN LONG Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI CCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a334">KeSetIdealProcessorThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN CCHAR Processor)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a335">KeSetKernelStackSwapEnable</a> (IN BOOLEAN Enable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KPRIORITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a336">KeSetPriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread, IN KPRIORITY Priority)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a337">KeSuspendThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a338">KeTerminateThread</a> (IN KPRIORITY Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a339">KeTestAlertThread</a> (IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a340">KeThawAllThreads</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a341">KeInitializeTimer</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a342">KeInitializeTimerEx</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer, IN TIMER_TYPE Type)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a343">KeCancelTimer</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a344">KeReadStateTimer</a> (<a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a345">KeSetTimer</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer, IN LARGE_INTEGER DueTime, IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a346">KeSetTimerEx</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer, IN LARGE_INTEGER DueTime, IN LONG Period OPTIONAL, IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a347">KeCheckForTimer</a> (IN PVOID p, IN ULONG <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a348">KeClearTimer</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONGLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a349">KeQueryTimerDueTime</a> (IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a350">KiSetServerWaitClientEvent</a> (IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> SeverEvent, IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> ClientEvent, IN ULONG WaitMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a351">KeWaitForMultipleObjects</a> (IN ULONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a>, IN PVOID Object[], IN WAIT_TYPE WaitType, IN <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a> WaitReason, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> WaitMode, IN BOOLEAN Alertable, IN PLARGE_INTEGER Timeout OPTIONAL, IN <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> WaitBlockArray OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a352">KeWaitForSingleObject</a> (IN PVOID Object, IN <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a> WaitReason, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> WaitMode, IN BOOLEAN Alertable, IN PLARGE_INTEGER Timeout OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a353">KiSetPriorityThread</a> (IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread, IN KPRIORITY Priority)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a> (IN PKSPIN_LOCK SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KIRQL FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a355">KeAcquireSpinLockRaiseToSynch</a> (IN PKSPIN_LOCK SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a356">KeAcquireSpinLockAtDpcLevel</a> (IN PKSPIN_LOCK SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a357">KeReleaseSpinLockFromDpcLevel</a> (IN PKSPIN_LOCK SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KIRQL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a358">KeAcquireSpinLockRaiseToDpc</a> (IN PKSPIN_LOCK SpinLock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a359">KeReleaseSpinLock</a> (IN PKSPIN_LOCK SpinLock, IN KIRQL NewIrql)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a360">KeTryToAcquireSpinLock</a> (IN PKSPIN_LOCK SpinLock, OUT PKIRQL OldIrql)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a361">KeInitSystem</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a362">KeGetBugMessageText</a> (IN ULONG MessageId, IN PANSI_STRING ReturnedString OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI DECLSPEC_NORETURN <br>
VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a363">KeBugCheck</a> (IN ULONG BugCheckCode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI DECLSPEC_NORETURN <br>
VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a364">KeBugCheckEx</a> (IN ULONG BugCheckCode, IN ULONG_PTR BugCheckParameter1, IN ULONG_PTR BugCheckParameter2, IN ULONG_PTR BugCheckParameter3, IN ULONG_PTR BugCheckParameter4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a365">KeDeregisterBugCheckCallback</a> (IN <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">PKBUGCHECK_CALLBACK_RECORD</a> CallbackRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a366">KeRegisterBugCheckCallback</a> (IN <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">PKBUGCHECK_CALLBACK_RECORD</a> CallbackRecord, IN <a class="el" href="../../d4/d9/ke_8h.html#a113">PKBUGCHECK_CALLBACK_ROUTINE</a> CallbackRoutine, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG Length, IN PUCHAR Component)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a367">KeEnterKernelDebugger</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a368">KeDumpMachineState</a> (IN PKPROCESSOR_STATE ProcessorState, IN PCHAR <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN PULONG_PTR BugCheckParameters, IN ULONG NumberOfParameters, IN <a class="el" href="../../d4/d9/ke_8h.html#a116">PKE_BUGCHECK_UNICODE_TO_ANSI</a> UnicodeToAnsiRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a369">KeContextFromKframes</a> (IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame, IN OUT PCONTEXT ContextFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a370">KeContextToKframes</a> (IN OUT PKTRAP_FRAME TrapFrame, IN OUT PKEXCEPTION_FRAME ExceptionFrame, IN PCONTEXT ContextFrame, IN ULONG ContextFlags, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> PreviousMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a371">KeSaveStateForHibernate</a> (IN PKPROCESSOR_STATE ProcessorState)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a372">KeCopyTrapDispatcher</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a373">KeInvalidAccessAllowed</a> (IN PVOID TrapInformation OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a375">KeFlushEntireTb</a> (IN BOOLEAN Invalid, IN BOOLEAN AllProcessors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a376">KeFlushMultipleTb</a> (IN ULONG Number, IN PVOID *Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcesors, IN PHARDWARE_PTE *PtePointer OPTIONAL, IN HARDWARE_PTE PteValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HARDWARE_PTE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a377">KeFlushSingleTb</a> (IN PVOID Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcesors, IN PHARDWARE_PTE PtePointer, IN HARDWARE_PTE PteValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a378">KeFreezeExecution</a> (IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a379">KeSwitchFrozenProcessor</a> (IN ULONG ProcessorNumber)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a380">KeGetNonVolatileContextPointers</a> (IN PKNONVOLATILE_CONTEXT_POINTERS NonVolatileContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a381">KeSetDmaIoCoherency</a> (IN ULONG Attributes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a382">KeSetSystemTime</a> (IN PLARGE_INTEGER NewTime, OUT PLARGE_INTEGER OldTime, IN BOOLEAN AdjustInterruptTime, IN PLARGE_INTEGER HalTimeToSet OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a383">KeAddSystemServiceTable</a> (IN PULONG_PTR Base, IN PULONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a> OPTIONAL, IN ULONG Limit, IN PUCHAR Number, IN ULONG <a class="el" href="../../d7/d0/cmdat2_8c.html#a27">Index</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONGLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a384">KeQueryInterruptTime</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a385">KeQuerySystemTime</a> (OUT PLARGE_INTEGER CurrentTime)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a386">KeQueryTimeIncrement</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KAFFINITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a387">KeQueryActiveProcessors</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a388">KeSetTimeIncrement</a> (IN ULONG MaximumIncrement, IN ULONG MimimumIncrement)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a389">KeThawExecution</a> (IN BOOLEAN Enable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a390">KeReturnToFirmware</a> (IN <a class="el" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a> Routine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a391">KeStartAllProcessors</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a392">KeBalanceSetManager</a> (IN PVOID Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a393">KeSwapProcessOrStack</a> (IN PVOID Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a394">KeUserModeCallback</a> (IN ULONG ApiNumber, IN PVOID InputBuffer, IN ULONG InputLength, OUT PVOID *OutputBuffer, OUT PULONG OutputLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a395">KeSwitchKernelStack</a> (IN PVOID StackBase, IN PVOID StackLimit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a396">KeRaiseUserException</a> (IN NTSTATUS ExceptionCode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a397">KeFindConfigurationEntry</a> (IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> Child, IN <a class="el" href="../../d1/d9/arc_8h.html#a54">CONFIGURATION_CLASS</a> Class, IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a> Type, IN PULONG <a class="el" href="../../d3/d0/user32_8def.html#a52">Key</a> OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a398">KeFindConfigurationNextEntry</a> (IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> Child, IN <a class="el" href="../../d1/d9/arc_8h.html#a54">CONFIGURATION_CLASS</a> Class, IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a> Type, IN PULONG <a class="el" href="../../d3/d0/user32_8def.html#a52">Key</a> OPTIONAL, IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> *Resume)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a399">KeSetSwapContextNotifyRoutine</a> (IN <a class="el" href="../../d4/d9/ke_8h.html#a120">PSWAP_CONTEXT_NOTIFY_ROUTINE</a> NotifyRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a400">KeSetThreadSelectNotifyRoutine</a> (IN <a class="el" href="../../d4/d9/ke_8h.html#a121">PTHREAD_SELECT_NOTIFY_ROUTINE</a> NotifyRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a401">KeSetTimeUpdateNotifyRoutine</a> (IN <a class="el" href="../../d4/d9/ke_8h.html#a122">PTIME_UPDATE_NOTIFY_ROUTINE</a> NotifyRoutine)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>KAFFINITY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a124">KeBootTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONGLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a125">KeBootTimeBias</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONGLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a126">KeInterruptTimeBias</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a127">KeBugCheckCallbackListHead</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a128">KeBugCheckCallbackLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/ke_8h.html#a117">PGDI_BATCHFLUSH_ROUTINE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a129">KeGdiFlushUserBatch</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a131">KeMaximumIncrement</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a132">KeMinimumIncrement</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a134">KeProcessorArchitecture</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a135">KeProcessorLevel</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a136">KeProcessorRevision</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a137">KeFeatureBits</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a138">KiFindFirstSetRight</a> [256]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PKPRCB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a140">KiStackProtectTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">KTHREAD_SWITCH_COUNTERS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a141">KeThreadSwitchCounters</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a142">KeRegisteredProcessors</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a143">KeLicensedProcessors</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a144">KeServiceCountTable</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">KSERVICE_TABLE_DESCRIPTOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a> [NUMBER_SERVICE_TABLES]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">KSERVICE_TABLE_DESCRIPTOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a> [NUMBER_SERVICE_TABLES]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>volatile KSYSTEM_TIME&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a147">KeTickCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a148">KeUserApcDispatcher</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a149">KeUserCallbackDispatcher</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a150">KeUserExceptionDispatcher</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a151">KeRaiseUserExceptionDispatcher</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a152">KeTimeAdjustment</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a153">KeTimeIncrement</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/ke_8h.html#a154">KeTimeSynchronization</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a35" doxytag="ke.h::_DECL_HAL_KE_IMPORT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define _DECL_HAL_KE_IMPORT          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01793">1793</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ke.h::BASE_PRIORITY_THRESHOLD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BASE_PRIORITY_THRESHOLD&nbsp;&nbsp;&nbsp;NORMAL_BASE_PRIORITY          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00076">76</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ke.h::CLOCK_QUANTUM_DECREMENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLOCK_QUANTUM_DECREMENT&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00028">28</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/clock_8c-source.html#l00208">KeUpdateRunTime()</a>, <a class="el" href="../../d2/d8/clock_8c-source.html#l00332">KiDecrementQuantum()</a>, and <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ke.h::DISPATCHER_OBJECT_TYPE_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DISPATCHER_OBJECT_TYPE_MASK&nbsp;&nbsp;&nbsp;0x7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00120">120</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ke.h::DMA_READ_DCACHE_INVALIDATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DMA_READ_DCACHE_INVALIDATE&nbsp;&nbsp;&nbsp;0x1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02496">2496</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00374">KeFlushIoBuffers()</a>, and <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ke.h::DMA_READ_ICACHE_INVALIDATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DMA_READ_ICACHE_INVALIDATE&nbsp;&nbsp;&nbsp;0x2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02497">2497</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00374">KeFlushIoBuffers()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ke.h::DMA_WRITE_DCACHE_SNOOP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DMA_WRITE_DCACHE_SNOOP&nbsp;&nbsp;&nbsp;0x4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02498">2498</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00374">KeFlushIoBuffers()</a>, and <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ke.h::EVENT_WAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EVENT_WAIT_BLOCK&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00082">82</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ke.h::IIS_SERVICE_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IIS_SERVICE_INDEX&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02547">2547</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ke.h::KeAcquireSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeAcquireSpinLock          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SpinLock,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OldIrql&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;*(OldIrql) = KeAcquireSpinLockRaiseToDpc(SpinLock)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">2007</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00970">ExFreePool()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00190">ExLockPool()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00563">ExNotifyCallback()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00378">ExRegisterCallback()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00479">ExUnregisterCallback()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00328">KdDeregisterDebuggerDataBlock()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00252">KdRegisterDebuggerDataBlock()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00453">KdUpdateTimeSlipEvent()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00526">KeRestoreMtrr()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00576">KeSetPhysicalCacheTypeRange()</a>, <a class="el" href="../../d2/d4/ia64_2flush_8c-source.html#l00276">KeSweepDcache()</a>, <a class="el" href="../../d2/d4/ia64_2flush_8c-source.html#l00143">KeSweepIcache()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00168">KiAmdK6InitializeMTRR()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00294">KiAmdK6MtrrSetMemoryType()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00250">MemPrint()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00492">MemPrintFlush()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00862">MemPrintWriteCompleteApc()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00598">MemPrintWriteThread()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00203">PspDeleteVdmObjects()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00091">RtlAcquireRemoveLockEx()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00204">RtlReleaseRemoveLock()</a>, <a class="el" href="../../d3/d8/workque_8c-source.html#l00316">UdfAddToWorkque()</a>, <a class="el" href="../../d1/d7/fspdisp_8c-source.html#l00038">UdfFspDispatch()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01709">VdmpDelayIntApcRoutine()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01583">VdmpDelayIntDpcRoutine()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02365">VerifierKeAcquireSpinLock()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ke.h::KeClearEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeClearEvent          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Event&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(Event)-&gt;<a class="el" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>.SignalState = 0</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01072">1072</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l01458">ClearQueueServerEvent()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00479">ExUnregisterCallback()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12535">IoCancelFileOpen()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00036">IopCloseFile()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00417">IopDeleteFile()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00725">IopLockDeviceRemovalRelations()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00917">IopProcessRelation()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05397">IopQueryXxxInformation()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00207">IopRequestDeviceAction()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04508">IopWaitForBootDevicesStarted()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09835">IoSetInformation()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00551">LfsFlushLfcb()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l01424">MiCreateImageFileMap()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02715">MiEmptyAllWorkingSets()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00941">MiEnsureAvailablePageOrWait()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03701">MiGatherPagefilePages()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02377">MiGetEventCounter()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04152">MiGetInPageSupportBlock()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05287">MiMakeOutswappedPageResident()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04239">MiMappedPageWriter()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02831">MiModifiedPageWriterWorker()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00126">NtClearEvent()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00386">NtFlushBuffersFile()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00035">NtLockFile()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00821">NtNotifyChangeDirectoryFile()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00037">NtQueryVolumeInformationFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00492">NtSetVolumeInformationFile()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00458">NtUnlockFile()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01740">UdfWaitSync()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, and <a class="el" href="../../d7/d8/taskman_8c-source.html#l00252">xxxSleepTask()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ke.h::KeEnterCriticalRegion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeEnterCriticalRegion          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;KeGetCurrentThread()-&gt;KernelApcDisable -= 1;</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">1598</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00044">CmpLockRegistry()</a>, <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00081">CmpLockRegistryExclusive()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00798">EnterCrit()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00142">EnterMediaCrit()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00038">EnterPowerCrit()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00833">EnterSharedCrit()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01315">ExChangeHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">ExCreateHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">ExDestroyHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">ExUuidCreate()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00579">FsRecLoadFileSystem()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00373">IoGetDeviceProperty()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03624">IoOpenDeviceInterfaceRegistryKey()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07141">IopAllocateBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l00720">IopAllocateResources()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05453">IopDeleteLegacyKey()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03708">IopDeviceInterfaceKeysFromSymbolicLink()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09866">IopDoDeferredSetInterfaceState()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02779">IopDriverLoadingFailed()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01411">IopGetDriverDeviceList()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00680">IopGetRootDevices()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l02009">IopIsFirmwareDisabled()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06180">IopLegacyResourceAllocation()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07717">IopQueryConflictList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05215">IopRebalance()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03929">IopRegisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l00263">IopReleaseDeviceResources()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00877">IopSetDeviceSecurityDescriptors()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01931">IopWriteAllocatedResourcesToRegistry()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01548">IoReportDetectedDevice()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03563">IoSetDeviceInterfaceState()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00757">KeFreezeAllThreads()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07239">LeaveMouseCrit()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01181">LpcRequestPort()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02149">MiCheckControlAreaStatus()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02809">MiCheckPurgeAndUpMapCount()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01544">MiDereferenceSession()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00068">MiDispatchFault()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02735">MiEnablePagingTheExecutive()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02474">MiFindInitializationCode()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06991">MiLookupDataTableEntry()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00153">MiMapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00868">MiResolveTransitionFault()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01274">MmCopyToCachedPage()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06797">MmGetSectionRange()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04046">MmGetVerifierInformation()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06864">MmLockPagableDataSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06284">MmLockPagableSectionByHandle()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01548">MmPurgeSection()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l00974">MmSessionCreate()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01093">MmSessionDelete()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04226">MmSetVerifierInformation()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02881">NtLoadKey2()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03336">NtReplaceKey()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02358">NtTerminateJobObject()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07905">NtUserUserHandleGrantAccess()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01234">ObFindHandleForObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01022">ObKillProcess()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00914">ObpAcquireDescriptorCacheReadLock()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00886">ObpAcquireDescriptorCacheWriteLock()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l01319">ObQueryObjectAuditingByHandle()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02823">PsChangeJobMemoryUsage()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00608">PspExitProcessFromJob()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00579">PspRemoveProcessFromJob()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02901">PsReportProcessMemoryLimitViolation()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02882">xxxUserProcessCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ke.h::KeFindFirstSetRightMember" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeFindFirstSetRightMember          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Set&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>((Set &amp; 0xFF) ? <a class="code" href="../../d8/d0/hivecell_8c.html#a5">KiFindFirstSetRight</a>[Set &amp; 0xFF] : \
    ((Set &amp; 0xFF00) ? <a class="code" href="../../d8/d0/hivecell_8c.html#a5">KiFindFirstSetRight</a>[(Set &gt;&gt; 8) &amp; 0xFF] + 8 : \
    ((Set &amp; 0xFF0000) ? <a class="code" href="../../d8/d0/hivecell_8c.html#a5">KiFindFirstSetRight</a>[(Set &gt;&gt; 16) &amp; 0xFF] + 16 : \
                           <a class="code" href="../../d8/d0/hivecell_8c.html#a5">KiFindFirstSetRight</a>[Set &gt;&gt; 24] + 24 )))
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02293">2293</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00055">KeFreezeExecution()</a>, <a class="el" href="../../d0/d8/i386_2gdtsup_8c-source.html#l00117">KeI386SetGdtSelector()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00391">KeThawExecution()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00644">KiFlushForwardProgressTbBuffer()</a>, and <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00595">KiInvalidateForwardProgressTbBuffer()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ke.h::KeGetCurrentApcEnvironment" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeGetCurrentApcEnvironment          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;KeGetCurrentThread()-&gt;ApcStateIndex</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00100">100</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07444">IoInitializeIrp()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ke.h::KeInitializeCallbackRecord" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeInitializeCallbackRecord          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CallbackRecord&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(CallbackRecord)-&gt;State = BufferEmpty</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02187">2187</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ke.h::KeInitializeEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeInitializeEvent          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">_Event,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>_Type,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>_State&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(_Event)-&gt;Header.Type = (UCHAR)_Type;                   \
    (_Event)-&gt;Header.Size =  <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>) / <span class="keyword">sizeof</span>(LONG); \
    (_Event)-&gt;Header.SignalState = _State;                  \
    InitializeListHead(&amp;(_Event)-&gt;<a class="code" href="../../d3/d3/dumpuser_8c.html#a17">Header</a>.WaitListHead)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01066">1066</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00192">ArbInitializeArbiterInstance()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01790">CcCanIWrite()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l02717">CcSetValidData()</a>, <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00158">CcWaitForCurrentLazyWriterActivity()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01062">CcWaitOnActiveCount()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02952">CcZeroData()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03883">CmpAllocatePostBlock()</a>, <a class="el" href="../../d5/d7/ex_8c-source.html#l00346">CreateKernelEvent()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00067">DriverEntry()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00172">ExInitializeResource()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00410">ExpAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00101">ExpInitializeCallbacks()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00273">ExReinitializeResourceLite()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00703">FsRecGetDeviceSectors()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00800">FsRecGetDeviceSectorSize()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00907">FsRecReadBlock()</a>, <a class="el" href="../../d8/d0/faulttol_8c-source.html#l00031">FsRtlBalanceReads()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02691">FsRtlGetFileSize()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02864">FsRtlSetFileSize()</a>, <a class="el" href="../../d8/d0/faulttol_8c-source.html#l00096">FsRtlSyncVolumes()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03025">FsRtlWaitOnIrp()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00162">GetDeviceChangeInfo()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01022">HalpEnableAutomaticDriveLetterAssignment()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03735">HalpGetFullGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01171">HalpIsOldStyleFloppy()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00851">HalpNextMountLetter()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00792">HalpQueryDriveLayout()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00706">HalpQueryPartitionType()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01078">HalpSetMountLetter()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12535">IoCancelFileOpen()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04073">IoCreateDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05378">IoCreateStreamFileObject()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05535">IoCreateStreamFileObjectLite()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01300">IoFreeDumpStack()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11641">IoGetBootDiskInformation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l08307">IoGetDmaAdapter()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00061">IoInitializeRemoveLockEx()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d5/d6/devnode_8c-source.html#l00056">IopAllocateDeviceNode()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00036">IopCloseFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00657">IopCompleteUnloadOrDelete()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l01047">IopCreateArcNames()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00417">IopDeleteFile()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l03255">IopFilterResourceRequirementsCall()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02256">IopGetFileName()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02718">IopGetSetObjectId()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02851">IopGetVolumeId()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00093">IopInitializePlugPlayServices()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04077">IopLoadFileSystemDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09221">IoPnPDeliverServicePowerNotification()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05397">IopQueryXxxInformation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06672">IopRequestHwProfileChangeNotification()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06716">IopSetRemoteLink()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00381">IopSynchronousCall()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06017">IoReportTargetDeviceChange()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09835">IoSetInformation()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01291">IoSynchronousInvalidateDeviceRelations()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11389">IoVerifyVolume()</a>, <a class="el" href="../../d8/d3/flunkirp_8c-source.html#l01531">IovpThrowBogusSynchronousIrp()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00096">KeInitializeEventPair()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00454">KeSetAutoAlignmentThread()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00041">LfsAllocateLfcb()</a>, <a class="el" href="../../d8/d7/sysinit_8c-source.html#l00040">LfsInitializeLogFileService()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00136">LpcpCreatePort()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00287">LpcpInitializePortZone()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00124">MemPrintInitialize()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00259">MiAdjustWorkingSetManagerParameters()</a>, <a class="el" href="../../d7/d0/mmquota_8c-source.html#l00191">MiChargeCommitment()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00166">MiCheckPageFilePath()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l01424">MiCreateImageFileMap()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01544">MiDereferenceSession()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02377">MiGetEventCounter()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04152">MiGetInPageSupportBlock()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05287">MiMakeOutswappedPageResident()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04239">MiMappedPageWriter()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02669">MiModifiedPageWriter()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00386">NtFlushBuffersFile()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00037">NtQueryVolumeInformationFile()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00492">NtSetVolumeInformationFile()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00458">NtUnlockFile()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>, <a class="el" href="../../d4/d2/tob_8c-source.html#l00187">obtest()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00076">QueuePowerRequest()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00050">RtlAllocateRemoveLock()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00580">RtlVolumeDeviceToDosName()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d8/d4/udfs_2read_8c-source.html#l00068">UdfCommonRead()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l00573">UdfPerformDevIoCtrl()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00194">UdfPnpQueryRemove()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00350">UdfPnpRemove()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00500">UdfPnpSurpriseRemove()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l00685">UdfReadSectors()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00190">xHalExamineMBR()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00382">xHalGetPartialGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03486">xHalIoClearPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01739">xHalIoReadPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02879">xHalIoWritePartitionTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ke.h::KeIsAttachedProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeIsAttachedProcess          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(KeGetCurrentThread()-&gt;ApcStateIndex == AttachedApcEnvironment)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01302">1302</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/acceschk_8c-source.html#l00042">MiAccessCheck()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ke.h::KeLeaveCriticalRegion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeLeaveCriticalRegion          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;KiLeaveCriticalRegion()</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">1628</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00116">CmpUnlockRegistry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01315">ExChangeHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">ExCreateHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">ExDestroyHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">ExUuidCreate()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00579">FsRecLoadFileSystem()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00373">IoGetDeviceProperty()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03624">IoOpenDeviceInterfaceRegistryKey()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07141">IopAllocateBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l00720">IopAllocateResources()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05453">IopDeleteLegacyKey()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03708">IopDeviceInterfaceKeysFromSymbolicLink()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09866">IopDoDeferredSetInterfaceState()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02779">IopDriverLoadingFailed()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01411">IopGetDriverDeviceList()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00680">IopGetRootDevices()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l02009">IopIsFirmwareDisabled()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06180">IopLegacyResourceAllocation()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07717">IopQueryConflictList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05215">IopRebalance()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03929">IopRegisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l00263">IopReleaseDeviceResources()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00877">IopSetDeviceSecurityDescriptors()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01931">IopWriteAllocatedResourcesToRegistry()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01548">IoReportDetectedDevice()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03563">IoSetDeviceInterfaceState()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l02190">KeThawAllThreads()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00846">LeaveCrit()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00147">LeaveMediaCrit()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00043">LeavePowerCrit()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01181">LpcRequestPort()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02149">MiCheckControlAreaStatus()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02809">MiCheckPurgeAndUpMapCount()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01544">MiDereferenceSession()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00068">MiDispatchFault()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02735">MiEnablePagingTheExecutive()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02474">MiFindInitializationCode()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06991">MiLookupDataTableEntry()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00153">MiMapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00868">MiResolveTransitionFault()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01274">MmCopyToCachedPage()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06797">MmGetSectionRange()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04046">MmGetVerifierInformation()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06864">MmLockPagableDataSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06284">MmLockPagableSectionByHandle()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01548">MmPurgeSection()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l00974">MmSessionCreate()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01093">MmSessionDelete()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04226">MmSetVerifierInformation()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02881">NtLoadKey2()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03336">NtReplaceKey()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d3/d2/dbgctrl_8c-source.html#l00036">NtSystemDebugControl()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02358">NtTerminateJobObject()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07905">NtUserUserHandleGrantAccess()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01234">ObFindHandleForObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01022">ObKillProcess()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00942">ObpReleaseDescriptorCacheLock()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l01319">ObQueryObjectAuditingByHandle()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02823">PsChangeJobMemoryUsage()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00608">PspExitProcessFromJob()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00579">PspRemoveProcessFromJob()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02901">PsReportProcessMemoryLimitViolation()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l02250">PsUnlockProcess()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02882">xxxUserProcessCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ke.h::KeReadStateMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeReadStateMutex          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Mutex&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;KeReadStateMutant(Mutex)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01171">1171</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ke.h::KeSetHighEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeSetHighEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Increment,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Wait&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d4/d9/ke_8h.html#a282">KeSetEvent</a>(&amp;((EventPair)-&gt;EventHigh),              \
               Increment,                              \
               Wait)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01124">1124</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00651">NtSetHighEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ke.h::KeSetHighWaitLowEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeSetHighWaitLowEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WaitMode&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d4/d9/ke_8h.html#a350">KiSetServerWaitClientEvent</a>(&amp;((EventPair)-&gt;EventHigh),               \
                               &amp;((EventPair)-&gt;EventLow),                \
                               WaitMode)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01720">1720</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00532">NtSetHighWaitLowEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ke.h::KeSetLowEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeSetLowEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Increment,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Wait&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d4/d9/ke_8h.html#a282">KeSetEvent</a>(&amp;((EventPair)-&gt;EventLow),               \
               Increment,                              \
               Wait)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01129">1129</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00592">NtSetLowEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ke.h::KeSetLowWaitHighEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeSetLowWaitHighEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WaitMode&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d4/d9/ke_8h.html#a350">KiSetServerWaitClientEvent</a>(&amp;((EventPair)-&gt;EventLow),                \
                               &amp;((EventPair)-&gt;EventHigh),               \
                               WaitMode)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01725">1725</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00472">NtSetLowWaitHighEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ke.h::KeTerminateProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeTerminateProcess          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Process&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(Process)-&gt;StackCount += 1;</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01335">1335</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ke.h::KeWaitForHighEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeWaitForHighEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WaitMode,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Alertable,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>TimeOut&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d6/d3/cmwraper_8c.html#a20">KeWaitForSingleObject</a>(&amp;((EventPair)-&gt;EventHigh),                    \
                          WrEventPair,                                  \
                          WaitMode,                                     \
                          Alertable,                                    \
                          TimeOut)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01730">1730</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00412">NtWaitHighEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ke.h::KeWaitForLowEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeWaitForLowEventPair          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">EventPair,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WaitMode,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Alertable,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>TimeOut&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d6/d3/cmwraper_8c.html#a20">KeWaitForSingleObject</a>(&amp;((EventPair)-&gt;EventLow),                     \
                          WrEventPair,                                  \
                          WaitMode,                                     \
                          Alertable,                                    \
                          TimeOut)
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01737">1737</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00352">NtWaitLowEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ke.h::KeWaitForMutexObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KeWaitForMutexObject&nbsp;&nbsp;&nbsp;KeWaitForSingleObject          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01746">1746</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ke.h::KiLeaveCriticalRegion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KiLeaveCriticalRegion          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                       \
    <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;                                                    \
    Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();                                      \
    <span class="keywordflow">if</span> (((*((<span class="keyword">volatile</span> ULONG *)&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o30">KernelApcDisable</a>) += 1) == 0) &amp;&amp; \
        (((<span class="keyword">volatile</span> LIST_ENTRY *)&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[<a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>])-&gt;Flink != \
         &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[<a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>])) {                  \
        Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;                       \
        <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(APC_LEVEL);                          \
    }                                                                   \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01537">1537</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00080">KeLeaveCriticalRegion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ke.h::KiLockDispatcherDatabase" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KiLockDispatcherDatabase          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OldIrql&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;*(OldIrql) = KeAcquireSpinLockRaiseToSynch(&amp;<a class="el" href="../../d0/d0/ki_8h.html#a43">KiDispatcherLock</a>)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">1907</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l01097">ExpCheckForWorker()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02506">ExpWaitForResource()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01437">Ke386VdmClearApcObject()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01257">Ke386VdmInsertQueueApc()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00365">KeAlertResumeThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00281">KeAlertThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00166">KeAttachProcess()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00413">KeAttachSessionSpace()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00154">KeBoostCurrentThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00459">KeBoostPriorityThread()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00157">KeCancelTimer()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00467">KeCheckForTimer()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00515">KeConfineThread()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00154">KeConnectInterrupt()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00140">KeDelayExecutionThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00405">KeDetachProcess()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00543">KeDetachSessionSpace()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00574">KeDisableApcQueuingThread()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00364">KeDisableSessionSharing()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00298">KeDisconnectInterrupt()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00631">KeEnableApcQueuingThread()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00315">KeEnableSessionSharing()</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00138">KeFlushQueueApc()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00228">KeForceAttachProcess()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00688">KeForceResumeThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00757">KeFreezeAllThreads()</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00040">KeInitializeMutant()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00181">KeInsertHeadQueue()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00124">KeInsertQueue()</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00217">KeInsertQueueApc()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00167">KePulseEvent()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00904">KeQueryBasePriorityThread()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00410">KeQueryTimerDueTime()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01025">KeReadyThread()</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00178">KeReleaseMutant()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00238">KeRemoveQueue()</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00291">KeRemoveQueueApc()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00285">KeResetEvent()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01079">KeResumeThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">KeRevertToUserAffinityThread()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00570">KeRundownQueue()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01218">KeRundownThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01302">KeSetAffinityThread()</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00208">KeSetAutoAlignmentProcess()</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00269">KeSetAutoAlignmentThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01532">KeSetBasePriorityThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01674">KeSetDisableBoostThread()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00458">KeSetEventBoostPriority()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01735">KeSetIdealProcessorThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00738">KeSetPriorityProcess()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">KeSetPriorityThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00656">KeSetProcess()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00285">KeSetTimerEx()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00324">KeStackAttachProcess()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01912">KeSuspendThread()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00322">KeSwapProcessOrStack()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">KeTerminateThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l02121">KeTestAlertThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l02190">KeThawAllThreads()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00512">KeUnstackDetachProcess()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00431">KiInSwapKernelStacks()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00483">KiInSwapProcesses()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00544">KiOutSwapKernelStacks()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00644">KiOutSwapProcesses()</a>, <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00043">KiQuantumEnd()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00732">KiScanReadyQueues()</a>, <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00217">KiTimerExpiration()</a>, <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00333">KiTimerListExpire()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00525">NtReplyWaitSendChannel()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00807">NtSendWaitReplyChannel()</a>, <a class="el" href="../../d7/d0/yield_8c-source.html#l00029">NtYieldExecution()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00057">PspReaper()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ke.h::LISTEN_CHANNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LISTEN_CHANNEL&nbsp;&nbsp;&nbsp;0x1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00802">802</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ke.h::MESSAGE_CHANNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MESSAGE_CHANNEL&nbsp;&nbsp;&nbsp;0x2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00803">803</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ke.h::NUMBER_SERVICE_TABLES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NUMBER_SERVICE_TABLES&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00301">301</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00815">KeAddSystemServiceTable()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ke.h::READY_SKIP_QUANTUM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define READY_SKIP_QUANTUM&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00035">35</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00095">KiFindReadyThread()</a>, and <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ke.h::ROUND_TRIP_DECREMENT_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ROUND_TRIP_DECREMENT_COUNT&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00042">42</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02453">ExpBoostOwnerThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00154">KeBoostCurrentThread()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00732">KiScanReadyQueues()</a>, and <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ke.h::SEMAPHORE_WAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SEMAPHORE_WAIT_BLOCK&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00083">83</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ke.h::SERVICE_NUMBER_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SERVICE_NUMBER_MASK&nbsp;&nbsp;&nbsp;((1 &lt;&lt; 12) -  1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00302">302</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ke.h::SERVICE_TABLE_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SERVICE_TABLE_MASK&nbsp;&nbsp;&nbsp;(((1 &lt;&lt; 2) - 1) &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00313">313</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ke.h::SERVICE_TABLE_SHIFT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SERVICE_TABLE_SHIFT&nbsp;&nbsp;&nbsp;(12 - 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00312">312</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ke.h::SERVICE_TABLE_TEST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SERVICE_TABLE_TEST&nbsp;&nbsp;&nbsp;(WIN32K_SERVICE_INDEX &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00314">314</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ke.h::SYSTEM_SERVICE_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SYSTEM_SERVICE_INDEX&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02545">2545</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ke.h::THREAD_QUANTUM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define THREAD_QUANTUM&nbsp;&nbsp;&nbsp;(READY_SKIP_QUANTUM * CLOCK_QUANTUM_DECREMENT)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00036">36</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/procobj_8c-source.html#l00063">KeInitializeProcess()</a>, <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00878">PsChangeQuantumTable()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ke.h::THREAD_WAIT_OBJECTS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define THREAD_WAIT_OBJECTS&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00079">79</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, and <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ke.h::TIMER_TABLE_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TIMER_TABLE_SIZE&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00094">94</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00467">KeCheckForTimer()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, <a class="el" href="../../d2/d8/clock_8c-source.html#l00038">KiChkTimerExpireSysDpc()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, and <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00217">KiTimerExpiration()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ke.h::TIMER_WAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TIMER_WAIT_BLOCK&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00084">84</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/wait_8c-source.html#l00140">KeDelayExecutionThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, and <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ke.h::WAIT_QUANTUM_DECREMENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WAIT_QUANTUM_DECREMENT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00029">29</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d6/wait_8c-source.html#l00079">KiAdjustQuantumThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, and <a class="el" href="../../d5/d0/genmips_8c-source.html#l00130">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ke.h::WIN32K_SERVICE_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WIN32K_SERVICE_INDEX&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02546">2546</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a57" doxytag="ke.h::DISPATCHER_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d6/struct__DISPATCHER__HEADER.html">_DISPATCHER_HEADER</a>  <a class="el" href="../../d1/d6/struct__DISPATCHER__HEADER.html">DISPATCHER_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="ke.h::ECHANNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a>  <a class="el" href="../../d9/d1/struct__ECHANNEL.html">ECHANNEL</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="ke.h::ECHANNEL_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a409">_ECHANNEL_STATE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a108">ECHANNEL_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a118" doxytag="ke.h::FIRMWARE_REENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a>  <a class="el" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00499">KeReturnToFirmware()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ke.h::KAPC_ENVIRONMENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a403">_KAPC_ENVIRONMENT</a>  <a class="el" href="../../d4/d9/ke_8h.html#a49">KAPC_ENVIRONMENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00039">KeInitializeApc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ke.h::KAPC_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a>  <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">KAPC_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a112" doxytag="ke.h::KBUGCHECK_BUFFER_DUMP_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a410">_KBUGCHECK_BUFFER_DUMP_STATE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a112">KBUGCHECK_BUFFER_DUMP_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a114" doxytag="ke.h::KBUGCHECK_CALLBACK_RECORD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">_KBUGCHECK_CALLBACK_RECORD</a>  <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">KBUGCHECK_CALLBACK_RECORD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01207">KiScanBugCheckCallbackList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="ke.h::KDEVICE_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a>  <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">KDEVICE_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00040">KeInitializeDeviceQueue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="ke.h::KDEVICE_QUEUE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a>  <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">KDEVICE_QUEUE_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00145">KeInsertByKeyDeviceQueue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="ke.h::KEVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a>  <a class="el" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="ke.h::KEVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a>  <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">KEVENT_PAIR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00096">KeInitializeEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="ke.h::KINTERRUPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a>  <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ke.h::KINTERRUPT_MODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a404">_KINTERRUPT_MODE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a50">KINTERRUPT_MODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="ke.h::KMUTANT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>  <a class="el" href="../../d3/d7/struct__KMUTANT.html">KMUTANT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="ke.h::KMUTEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>  <a class="el" href="../../d3/d7/struct__KMUTANT.html">KMUTEX</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ke.h::KOBJECTS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a402">_KOBJECTS</a>  <a class="el" href="../../d4/d9/ke_8h.html#a48">KOBJECTS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ke.h::KPAGE_FRAME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef ULONG <a class="el" href="../../d4/d9/ke_8h.html#a58">KPAGE_FRAME</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00272">272</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="ke.h::KPROCESS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a>  <a class="el" href="../../d5/d7/struct__KPROCESS.html">KPROCESS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ke.h::KPROCESS_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a405">_KPROCESS_STATE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a51">KPROCESS_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="ke.h::KPROFILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a>  <a class="el" href="../../d6/d7/struct__KPROFILE.html">KPROFILE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/clock_8c-source.html#l00449">KiProcessProfileList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a90" doxytag="ke.h::KQUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a>  <a class="el" href="../../d7/d7/struct__KQUEUE.html">KQUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d3/complete_8c-source.html#l00051">NtCreateIoCompletion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="ke.h::KSEMAPHORE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a>  <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ke.h::KSERVICE_TABLE_DESCRIPTOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">_KSERVICE_TABLE_DESCRIPTOR</a>  <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">KSERVICE_TABLE_DESCRIPTOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="ke.h::KTHREAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a>  <a class="el" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ke.h::KTHREAD_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a406">_KTHREAD_STATE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a52">KTHREAD_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ke.h::KTHREAD_SWITCH_COUNTERS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">_KTHREAD_SWITCH_COUNTERS</a>  <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">KTHREAD_SWITCH_COUNTERS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="ke.h::KTIMER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a>  <a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ke.h::KWAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a>  <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ke.h::KWAIT_REASON" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a407">_KWAIT_REASON</a>  <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, and <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00163">KeWaitForSingleObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a156" doxytag="ke.h::MEMORY_CACHING_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a413">_MEMORY_CACHING_TYPE</a>  <a class="el" href="../../d4/d9/ke_8h.html#a156">MEMORY_CACHING_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d1/mm_2ia64_2initia64_8c-source.html#l02042">MiSweepCacheMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a155" doxytag="ke.h::MEMORY_CACHING_TYPE_ORIG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a412">_MEMORY_CACHING_TYPE_ORIG</a>  <a class="el" href="../../d4/d9/ke_8h.html#a155">MEMORY_CACHING_TYPE_ORIG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a110" doxytag="ke.h::PECHANNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a> * <a class="el" href="../../d9/d1/struct__ECHANNEL.html">PECHANNEL</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a119" doxytag="ke.h::PFIRMWARE_REENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a> * <a class="el" href="../../d4/d9/ke_8h.html#a119">PFIRMWARE_REENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a117" doxytag="ke.h::PGDI_BATCHFLUSH_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d4/d9/ke_8h.html#a117">PGDI_BATCHFLUSH_ROUTINE</a>)(VOID)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02275">2275</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03855">PsEstablishWin32Callouts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ke.h::PKAPC_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a> * <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PKAPC_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00291">KeRemoveQueueApc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a115" doxytag="ke.h::PKBUGCHECK_CALLBACK_RECORD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">_KBUGCHECK_CALLBACK_RECORD</a> * <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">PKBUGCHECK_CALLBACK_RECORD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01064">KeDeregisterBugCheckCallback()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a113" doxytag="ke.h::PKBUGCHECK_CALLBACK_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d4/d9/ke_8h.html#a113">PKBUGCHECK_CALLBACK_ROUTINE</a>)(IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG Length)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02149">2149</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01123">KeRegisterBugCheckCallback()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="ke.h::PKDEBUG_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d4/d9/ke_8h.html#a64">PKDEBUG_ROUTINE</a>)(IN PKTRAP_FRAME TrapFrame, IN PKEXCEPTION_FRAME ExceptionFrame, IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> PreviousMode, IN BOOLEAN SecondChance)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00336">336</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="ke.h::PKDEBUG_SWITCH_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d4/d9/ke_8h.html#a65">PKDEBUG_SWITCH_ROUTINE</a>)(IN PEXCEPTION_RECORD ExceptionRecord, IN PCONTEXT ContextRecord, IN BOOLEAN SecondChance)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00347">347</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="ke.h::PKDEVICE_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a> * <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00040">KeInitializeDeviceQueue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="ke.h::PKDEVICE_QUEUE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a> * <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00083">KeInsertDeviceQueue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a116" doxytag="ke.h::PKE_BUGCHECK_UNICODE_TO_ANSI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef PCHAR(* <a class="el" href="../../d4/d9/ke_8h.html#a116">PKE_BUGCHECK_UNICODE_TO_ANSI</a>)(IN PUNICODE_STRING UnicodeString, OUT PCHAR AnsiBuffer, IN ULONG MaxAnsiLength)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02216">2216</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00317">KiDumpParameterImages()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="ke.h::PKEVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a> * <a class="el" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="ke.h::PKEVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a> * <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PKEVENT_PAIR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00096">KeInitializeEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="ke.h::PKINTERRUPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a>* <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00477">477</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00032">KeInitializeInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="ke.h::PKMUTANT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a> * <a class="el" href="../../d3/d7/struct__KMUTANT.html">PKMUTANT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="ke.h::PKMUTEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a> * <a class="el" href="../../d3/d7/struct__KMUTANT.html">PKMUTEX</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00155">KeReleaseMutex()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="ke.h::PKPROCESS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> * <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="ke.h::PKPROFILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a> * <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/clock_8c-source.html#l00449">KiProcessProfileList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="ke.h::PKQUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a> * <a class="el" href="../../d7/d7/struct__KQUEUE.html">PKQUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="ke.h::PKSEMAPHORE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a> * <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PKSEMAPHORE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="ke.h::PKSERVICE_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d4/d9/ke_8h.html#a80">PKSERVICE_ROUTINE</a>)(IN struct <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a> *Interrupt, IN PVOID ServiceContext)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00440">440</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00032">KeInitializeInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="ke.h::PKSERVICE_TABLE_DESCRIPTOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">_KSERVICE_TABLE_DESCRIPTOR</a> * <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">PKSERVICE_TABLE_DESCRIPTOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="ke.h::PKSTART_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a>)(IN PVOID StartContext)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00367">367</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00175">PsCreateSystemThread()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00140">xxxInitInput()</a>, and <a class="el" href="../../d9/d7/winsta_8c-source.html#l00026">xxxInitTerminal()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="ke.h::PKSYSTEM_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d4/d9/ke_8h.html#a67">PKSYSTEM_ROUTINE</a>)(IN <a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a> StartRoutine OPTIONAL, IN PVOID StartContext OPTIONAL)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00379">379</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00057">KiInitializeContextThread()</a>, and <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="ke.h::PKTHREAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> * <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ke.h::PKTHREAD_SWITCH_COUNTERS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">_KTHREAD_SWITCH_COUNTERS</a> * <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">PKTHREAD_SWITCH_COUNTERS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="ke.h::PKTIMER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a> * <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/clock_8c-source.html#l00038">KiChkTimerExpireSysDpc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="ke.h::PKWAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a> * <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a111" doxytag="ke.h::PRECHANNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d1/struct__ECHANNEL.html">_ECHANNEL</a>  <a class="el" href="../../d9/d1/struct__ECHANNEL.html">PRECHANNEL</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ke.h::PRKAPC_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">_KAPC_STATE</a>  <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PRKAPC_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="ke.h::PRKDEVICE_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">_KDEVICE_QUEUE</a>  <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PRKDEVICE_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="ke.h::PRKDEVICE_QUEUE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">_KDEVICE_QUEUE_ENTRY</a>  <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PRKDEVICE_QUEUE_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="ke.h::PRKEVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d6/struct__KEVENT.html">_KEVENT</a>  <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00053">KeInitializeEvent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="ke.h::PRKEVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">_KEVENT_PAIR</a>  <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PRKEVENT_PAIR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="ke.h::PRKINTERRUPT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">_KINTERRUPT</a> * RESTRICTED_POINTER <a class="el" href="../../d4/d9/ke_8h.html#a83">PRKINTERRUPT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00477">477</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="ke.h::PRKMUTANT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>  <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="ke.h::PRKMUTEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d7/struct__KMUTANT.html">_KMUTANT</a>  <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTEX</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="ke.h::PRKPROCESS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a>  <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="ke.h::PRKPROFILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__KPROFILE.html">_KPROFILE</a>  <a class="el" href="../../d6/d7/struct__KPROFILE.html">PRKPROFILE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="ke.h::PRKQUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d7/struct__KQUEUE.html">_KQUEUE</a>  <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="ke.h::PRKSEMAPHORE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">_KSEMAPHORE</a>  <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="ke.h::PRKTHREAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a>  <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="ke.h::PRKTIMER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/struct__KTIMER.html">_KTIMER</a>  <a class="el" href="../../d3/d8/struct__KTIMER.html">PRKTIMER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="ke.h::PRKWAIT_BLOCK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">_KWAIT_BLOCK</a>  <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PRKWAIT_BLOCK</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a120" doxytag="ke.h::PSWAP_CONTEXT_NOTIFY_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(FASTCALL * <a class="el" href="../../d4/d9/ke_8h.html#a120">PSWAP_CONTEXT_NOTIFY_ROUTINE</a>)(IN HANDLE OldThreadId, IN HANDLE NewThreadId)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02713">2713</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a121" doxytag="ke.h::PTHREAD_SELECT_NOTIFY_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef LOGICAL(FASTCALL * <a class="el" href="../../d4/d9/ke_8h.html#a121">PTHREAD_SELECT_NOTIFY_ROUTINE</a>)(IN HANDLE ThreadId)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02731">2731</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a122" doxytag="ke.h::PTIME_UPDATE_NOTIFY_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(FASTCALL * <a class="el" href="../../d4/d9/ke_8h.html#a122">PTIME_UPDATE_NOTIFY_ROUTINE</a>)(IN HANDLE ThreadId, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> Mode)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02748">2748</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="a409" doxytag="ke.h::_ECHANNEL_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a409">_ECHANNEL_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a409a230" doxytag="ClientIdle" ></a>ClientIdle</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a409a231" doxytag="ClientSendWaitReply" ></a>ClientSendWaitReply</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a409a232" doxytag="ClientShutdown" ></a>ClientShutdown</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a409a233" doxytag="ServerIdle" ></a>ServerIdle</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a409a234" doxytag="ServerReceiveMessage" ></a>ServerReceiveMessage</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a409a235" doxytag="ServerShutdown" ></a>ServerShutdown</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00805">805</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00805                              {
00806     <a class="code" href="../../d4/d9/ke_8h.html#a409a230">ClientIdle</a>,
00807     <a class="code" href="../../d4/d9/ke_8h.html#a409a231">ClientSendWaitReply</a>,
00808     <a class="code" href="../../d4/d9/ke_8h.html#a409a232">ClientShutdown</a>,
00809     <a class="code" href="../../d4/d9/ke_8h.html#a409a233">ServerIdle</a>,
00810     <a class="code" href="../../d4/d9/ke_8h.html#a409a234">ServerReceiveMessage</a>,
00811     <a class="code" href="../../d4/d9/ke_8h.html#a409a235">ServerShutdown</a>
00812 } <a class="code" href="../../d4/d9/ke_8h.html#a108">ECHANNEL_STATE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a411" doxytag="ke.h::_FIRMWARE_REENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a411">_FIRMWARE_REENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a411a241" doxytag="HalHaltRoutine" ></a>HalHaltRoutine</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a411a242" doxytag="HalPowerDownRoutine" ></a>HalPowerDownRoutine</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a411a243" doxytag="HalRestartRoutine" ></a>HalRestartRoutine</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a411a244" doxytag="HalRebootRoutine" ></a>HalRebootRoutine</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a411a245" doxytag="HalInteractiveModeRoutine" ></a>HalInteractiveModeRoutine</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a411a246" doxytag="HalMaximumRoutine" ></a>HalMaximumRoutine</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02611">2611</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>02611                                {
02612     <a class="code" href="../../d4/d9/ke_8h.html#a411a241">HalHaltRoutine</a>,
02613     <a class="code" href="../../d4/d9/ke_8h.html#a411a242">HalPowerDownRoutine</a>,
02614     <a class="code" href="../../d4/d9/ke_8h.html#a411a243">HalRestartRoutine</a>,
02615     <a class="code" href="../../d4/d9/ke_8h.html#a411a244">HalRebootRoutine</a>,
02616     <a class="code" href="../../d4/d9/ke_8h.html#a411a245">HalInteractiveModeRoutine</a>,
02617     <a class="code" href="../../d4/d9/ke_8h.html#a411a246">HalMaximumRoutine</a>
02618 } <a class="code" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a>, *<a class="code" href="../../d4/d9/ke_8h.html#a119">PFIRMWARE_REENTRY</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a403" doxytag="ke.h::_KAPC_ENVIRONMENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a403">_KAPC_ENVIRONMENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a403a181" doxytag="OriginalApcEnvironment" ></a>OriginalApcEnvironment</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a403a182" doxytag="AttachedApcEnvironment" ></a>AttachedApcEnvironment</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a403a183" doxytag="CurrentApcEnvironment" ></a>CurrentApcEnvironment</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00153">153</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00153                                {
00154     <a class="code" href="../../d4/d9/ke_8h.html#a403a181">OriginalApcEnvironment</a>,
00155     <a class="code" href="../../d4/d9/ke_8h.html#a403a182">AttachedApcEnvironment</a>,
00156     <a class="code" href="../../d4/d9/ke_8h.html#a403a183">CurrentApcEnvironment</a>
00157     } <a class="code" href="../../d4/d9/ke_8h.html#a49">KAPC_ENVIRONMENT</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a410" doxytag="ke.h::_KBUGCHECK_BUFFER_DUMP_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a410">_KBUGCHECK_BUFFER_DUMP_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a410a236" doxytag="BufferEmpty" ></a>BufferEmpty</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a410a237" doxytag="BufferInserted" ></a>BufferInserted</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a410a238" doxytag="BufferStarted" ></a>BufferStarted</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a410a239" doxytag="BufferFinished" ></a>BufferFinished</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a410a240" doxytag="BufferIncomplete" ></a>BufferIncomplete</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02139">2139</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>02139                                           {
02140     <a class="code" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>,
02141     <a class="code" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>,
02142     <a class="code" href="../../d4/d9/ke_8h.html#a410a238">BufferStarted</a>,
02143     <a class="code" href="../../d4/d9/ke_8h.html#a410a239">BufferFinished</a>,
02144     <a class="code" href="../../d4/d9/ke_8h.html#a410a240">BufferIncomplete</a>
02145 } <a class="code" href="../../d4/d9/ke_8h.html#a112">KBUGCHECK_BUFFER_DUMP_STATE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a404" doxytag="ke.h::_KINTERRUPT_MODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a404">_KINTERRUPT_MODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a404a184" doxytag="LevelSensitive" ></a>LevelSensitive</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a404a185" doxytag="Latched" ></a>Latched</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00165">165</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00165                               {
00166     <a class="code" href="../../d4/d9/ke_8h.html#a404a184">LevelSensitive</a>,
00167     <a class="code" href="../../d4/d9/ke_8h.html#a404a185">Latched</a>
00168     } <a class="code" href="../../d4/d9/ke_8h.html#a50">KINTERRUPT_MODE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a402" doxytag="ke.h::_KOBJECTS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a402">_KOBJECTS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a402a157" doxytag="EventNotificationObject" ></a>EventNotificationObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a158" doxytag="EventSynchronizationObject" ></a>EventSynchronizationObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a159" doxytag="MutantObject" ></a>MutantObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a160" doxytag="ProcessObject" ></a>ProcessObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a161" doxytag="QueueObject" ></a>QueueObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a162" doxytag="SemaphoreObject" ></a>SemaphoreObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a163" doxytag="ThreadObject" ></a>ThreadObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a164" doxytag="Spare1Object" ></a>Spare1Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a165" doxytag="TimerNotificationObject" ></a>TimerNotificationObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a166" doxytag="TimerSynchronizationObject" ></a>TimerSynchronizationObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a167" doxytag="Spare2Object" ></a>Spare2Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a168" doxytag="Spare3Object" ></a>Spare3Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a169" doxytag="Spare4Object" ></a>Spare4Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a170" doxytag="Spare5Object" ></a>Spare5Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a171" doxytag="Spare6Object" ></a>Spare6Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a172" doxytag="Spare7Object" ></a>Spare7Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a173" doxytag="Spare8Object" ></a>Spare8Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a174" doxytag="Spare9Object" ></a>Spare9Object</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a175" doxytag="ApcObject" ></a>ApcObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a176" doxytag="DpcObject" ></a>DpcObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a177" doxytag="DeviceQueueObject" ></a>DeviceQueueObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a178" doxytag="EventPairObject" ></a>EventPairObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a179" doxytag="InterruptObject" ></a>InterruptObject</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a402a180" doxytag="ProfileObject" ></a>ProfileObject</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00122">122</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00122                        {
00123     <a class="code" href="../../d4/d9/ke_8h.html#a402a157">EventNotificationObject</a> = 0,
00124     <a class="code" href="../../d4/d9/ke_8h.html#a402a158">EventSynchronizationObject</a> = 1,
00125     <a class="code" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a> = 2,
00126     <a class="code" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a> = 3,
00127     <a class="code" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a> = 4,
00128     <a class="code" href="../../d4/d9/ke_8h.html#a402a162">SemaphoreObject</a> = 5,
00129     <a class="code" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a> = 6,
00130     <a class="code" href="../../d4/d9/ke_8h.html#a402a164">Spare1Object</a> = 7,
00131     <a class="code" href="../../d4/d9/ke_8h.html#a402a165">TimerNotificationObject</a> = 8,
00132     <a class="code" href="../../d4/d9/ke_8h.html#a402a166">TimerSynchronizationObject</a> = 9,
00133     <a class="code" href="../../d4/d9/ke_8h.html#a402a167">Spare2Object</a> = 10,
00134     <a class="code" href="../../d4/d9/ke_8h.html#a402a168">Spare3Object</a> = 11,
00135     <a class="code" href="../../d4/d9/ke_8h.html#a402a169">Spare4Object</a> = 12,
00136     <a class="code" href="../../d4/d9/ke_8h.html#a402a170">Spare5Object</a> = 13,
00137     <a class="code" href="../../d4/d9/ke_8h.html#a402a171">Spare6Object</a> = 14,
00138     <a class="code" href="../../d4/d9/ke_8h.html#a402a172">Spare7Object</a> = 15,
00139     <a class="code" href="../../d4/d9/ke_8h.html#a402a173">Spare8Object</a> = 16,
00140     <a class="code" href="../../d4/d9/ke_8h.html#a402a174">Spare9Object</a> = 17,
00141     <a class="code" href="../../d4/d9/ke_8h.html#a402a175">ApcObject</a>,
00142     <a class="code" href="../../d4/d9/ke_8h.html#a402a176">DpcObject</a>,
00143     <a class="code" href="../../d4/d9/ke_8h.html#a402a177">DeviceQueueObject</a>,
00144     <a class="code" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>,
00145     <a class="code" href="../../d4/d9/ke_8h.html#a402a179">InterruptObject</a>,
00146     <a class="code" href="../../d4/d9/ke_8h.html#a402a180">ProfileObject</a>
00147     } <a class="code" href="../../d4/d9/ke_8h.html#a48">KOBJECTS</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a405" doxytag="ke.h::_KPROCESS_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a405">_KPROCESS_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a405a186" doxytag="ProcessInMemory" ></a>ProcessInMemory</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a405a187" doxytag="ProcessOutOfMemory" ></a>ProcessOutOfMemory</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a405a188" doxytag="ProcessInTransition" ></a>ProcessInTransition</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a405a189" doxytag="ProcessInSwap" ></a>ProcessInSwap</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a405a190" doxytag="ProcessOutSwap" ></a>ProcessOutSwap</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00176">176</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00176                              {
00177     <a class="code" href="../../d4/d9/ke_8h.html#a405a186">ProcessInMemory</a>,
00178     <a class="code" href="../../d4/d9/ke_8h.html#a405a187">ProcessOutOfMemory</a>,
00179     <a class="code" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>,
00180     <a class="code" href="../../d4/d9/ke_8h.html#a405a189">ProcessInSwap</a>,
00181     <a class="code" href="../../d4/d9/ke_8h.html#a405a190">ProcessOutSwap</a>
00182     } <a class="code" href="../../d4/d9/ke_8h.html#a51">KPROCESS_STATE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a406" doxytag="ke.h::_KTHREAD_STATE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a406">_KTHREAD_STATE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a406a191" doxytag="Initialized" ></a>Initialized</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a192" doxytag="Ready" ></a>Ready</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a193" doxytag="Running" ></a>Running</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a194" doxytag="Standby" ></a>Standby</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a195" doxytag="Terminated" ></a>Terminated</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a196" doxytag="Waiting" ></a>Waiting</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a406a197" doxytag="Transition" ></a>Transition</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00188">188</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00188                             {
00189     <a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>,
00190     <a class="code" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>,
00191     <a class="code" href="../../d4/d9/ke_8h.html#a406a193">Running</a>,
00192     <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>,
00193     <a class="code" href="../../d4/d9/ke_8h.html#a406a195">Terminated</a>,
00194     <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>,
00195     <a class="code" href="../../d4/d9/ke_8h.html#a406a197">Transition</a>
00196     } <a class="code" href="../../d4/d9/ke_8h.html#a52">KTHREAD_STATE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a407" doxytag="ke.h::_KWAIT_REASON" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a407">_KWAIT_REASON</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a407a198" doxytag="Executive" ></a>Executive</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a199" doxytag="FreePage" ></a>FreePage</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a200" doxytag="PageIn" ></a>PageIn</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a201" doxytag="PoolAllocation" ></a>PoolAllocation</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a202" doxytag="DelayExecution" ></a>DelayExecution</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a203" doxytag="Suspended" ></a>Suspended</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a204" doxytag="UserRequest" ></a>UserRequest</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a205" doxytag="WrExecutive" ></a>WrExecutive</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a206" doxytag="WrFreePage" ></a>WrFreePage</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a207" doxytag="WrPageIn" ></a>WrPageIn</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a208" doxytag="WrPoolAllocation" ></a>WrPoolAllocation</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a209" doxytag="WrDelayExecution" ></a>WrDelayExecution</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a210" doxytag="WrSuspended" ></a>WrSuspended</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a211" doxytag="WrUserRequest" ></a>WrUserRequest</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a212" doxytag="WrEventPair" ></a>WrEventPair</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a213" doxytag="WrQueue" ></a>WrQueue</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a214" doxytag="WrLpcReceive" ></a>WrLpcReceive</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a215" doxytag="WrLpcReply" ></a>WrLpcReply</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a216" doxytag="WrVirtualMemory" ></a>WrVirtualMemory</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a217" doxytag="WrPageOut" ></a>WrPageOut</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a218" doxytag="WrRendezvous" ></a>WrRendezvous</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a219" doxytag="Spare2" ></a>Spare2</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a220" doxytag="Spare3" ></a>Spare3</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a221" doxytag="Spare4" ></a>Spare4</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a222" doxytag="Spare5" ></a>Spare5</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a223" doxytag="Spare6" ></a>Spare6</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a224" doxytag="WrKernel" ></a>WrKernel</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a407a225" doxytag="MaximumWaitReason" ></a>MaximumWaitReason</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00203">203</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>00203                            {
00204     <a class="code" href="../../d6/d7/halmips_8h.html#a455">Executive</a>,
00205     <a class="code" href="../../d4/d9/ke_8h.html#a407a199">FreePage</a>,
00206     <a class="code" href="../../d4/d9/ke_8h.html#a407a200">PageIn</a>,
00207     <a class="code" href="../../d4/d9/ke_8h.html#a407a201">PoolAllocation</a>,
00208     <a class="code" href="../../d4/d9/ke_8h.html#a407a202">DelayExecution</a>,
00209     <a class="code" href="../../d4/d9/ke_8h.html#a407a203">Suspended</a>,
00210     <a class="code" href="../../d4/d9/ke_8h.html#a407a204">UserRequest</a>,
00211     <a class="code" href="../../d6/d7/halmips_8h.html#a0">WrExecutive</a>,
00212     <a class="code" href="../../d4/d9/ke_8h.html#a407a206">WrFreePage</a>,
00213     <a class="code" href="../../d4/d9/ke_8h.html#a407a207">WrPageIn</a>,
00214     <a class="code" href="../../d4/d9/ke_8h.html#a407a208">WrPoolAllocation</a>,
00215     <a class="code" href="../../d4/d9/ke_8h.html#a407a209">WrDelayExecution</a>,
00216     <a class="code" href="../../d4/d9/ke_8h.html#a407a210">WrSuspended</a>,
00217     <a class="code" href="../../d4/d9/ke_8h.html#a407a211">WrUserRequest</a>,
00218     <a class="code" href="../../d4/d9/ke_8h.html#a407a212">WrEventPair</a>,
00219     <a class="code" href="../../d4/d9/ke_8h.html#a407a213">WrQueue</a>,
00220     <a class="code" href="../../d4/d9/ke_8h.html#a407a214">WrLpcReceive</a>,
00221     <a class="code" href="../../d4/d9/ke_8h.html#a407a215">WrLpcReply</a>,
00222     <a class="code" href="../../d4/d9/ke_8h.html#a407a216">WrVirtualMemory</a>,
00223     <a class="code" href="../../d4/d9/ke_8h.html#a407a217">WrPageOut</a>,
00224     <a class="code" href="../../d4/d9/ke_8h.html#a407a218">WrRendezvous</a>,
00225     <a class="code" href="../../d4/d9/ke_8h.html#a407a219">Spare2</a>,
00226     <a class="code" href="../../d4/d9/ke_8h.html#a407a220">Spare3</a>,
00227     <a class="code" href="../../d4/d9/ke_8h.html#a407a221">Spare4</a>,
00228     <a class="code" href="../../d4/d9/ke_8h.html#a407a222">Spare5</a>,
00229     <a class="code" href="../../d4/d9/ke_8h.html#a407a223">Spare6</a>,
00230     <a class="code" href="../../d4/d9/ke_8h.html#a407a224">WrKernel</a>,
00231     <a class="code" href="../../d4/d9/ke_8h.html#a407a225">MaximumWaitReason</a>
00232     } <a class="code" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a413" doxytag="ke.h::_MEMORY_CACHING_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a413">_MEMORY_CACHING_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a413a248" doxytag="MmNonCached" ></a>MmNonCached</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a249" doxytag="MmCached" ></a>MmCached</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a250" doxytag="MmWriteCombined" ></a>MmWriteCombined</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a251" doxytag="MmHardwareCoherentCached" ></a>MmHardwareCoherentCached</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a252" doxytag="MmNonCachedUnordered" ></a>MmNonCachedUnordered</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a253" doxytag="MmUSWCCached" ></a>MmUSWCCached</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a413a254" doxytag="MmMaximumCacheType" ></a>MmMaximumCacheType</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02824">2824</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>02824                                   {
02825     <a class="code" href="../../d4/d9/ke_8h.html#a413a248">MmNonCached</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>,
02826     <a class="code" href="../../d4/d9/ke_8h.html#a413a249">MmCached</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
02827     <a class="code" href="../../d4/d9/ke_8h.html#a413a250">MmWriteCombined</a> = <a class="code" href="../../d4/d9/ke_8h.html#a412a247">MmFrameBufferCached</a>,
02828     <a class="code" href="../../d4/d9/ke_8h.html#a413a251">MmHardwareCoherentCached</a>,
02829     <a class="code" href="../../d4/d9/ke_8h.html#a413a252">MmNonCachedUnordered</a>,       <span class="comment">// IA64</span>
02830     <a class="code" href="../../d4/d9/ke_8h.html#a413a253">MmUSWCCached</a>,
02831     <a class="code" href="../../d4/d9/ke_8h.html#a413a254">MmMaximumCacheType</a>
02832 } <a class="code" href="../../d4/d9/ke_8h.html#a156">MEMORY_CACHING_TYPE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a412" doxytag="ke.h::_MEMORY_CACHING_TYPE_ORIG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a412">_MEMORY_CACHING_TYPE_ORIG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a412a247" doxytag="MmFrameBufferCached" ></a>MmFrameBufferCached</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02820">2820</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
<pre class="fragment"><div>02820                                        {
02821     <a class="code" href="../../d4/d9/ke_8h.html#a412a247">MmFrameBufferCached</a> = 2
02822 } <a class="code" href="../../d4/d9/ke_8h.html#a155">MEMORY_CACHING_TYPE_ORIG</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a408" doxytag="ke.h::KCONTINUE_STATUS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a408a226" doxytag="ContinueError" ></a>ContinueError</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a408a227" doxytag="ContinueSuccess" ></a>ContinueSuccess</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a408a228" doxytag="ContinueProcessorReselected" ></a>ContinueProcessorReselected</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a408a229" doxytag="ContinueNextProcessor" ></a>ContinueNextProcessor</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l00353">353</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02351">KdpReportExceptionStateChange()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02434">KdpReportLoadSymbolsStateChange()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>, and <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00220">KiFreezeTargetExecution()</a>.
<p>
<pre class="fragment"><div>00353              {
00354     <a class="code" href="../../d4/d9/ke_8h.html#a408a226">ContinueError</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>,
00355     <a class="code" href="../../d4/d9/ke_8h.html#a408a227">ContinueSuccess</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
00356     <a class="code" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>,
00357     <a class="code" href="../../d4/d9/ke_8h.html#a408a229">ContinueNextProcessor</a>
00358 } <a class="code" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a>;
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a356" doxytag="ke.h::KeAcquireSpinLockAtDpcLevel" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeAcquireSpinLockAtDpcLevel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SpinLock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a358" doxytag="ke.h::KeAcquireSpinLockRaiseToDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KIRQL KeAcquireSpinLockRaiseToDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SpinLock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a355" doxytag="ke.h::KeAcquireSpinLockRaiseToSynch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KIRQL FASTCALL KeAcquireSpinLockRaiseToSynch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SpinLock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a383" doxytag="ke.h::KeAddSystemServiceTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeAddSystemServiceTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>Base</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Index</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00815">815</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00319">_KSERVICE_TABLE_DESCRIPTOR::Base</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00320">_KSERVICE_TABLE_DESCRIPTOR::Count</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02794">KeServiceDescriptorTable</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02795">KeServiceDescriptorTableShadow</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00321">_KSERVICE_TABLE_DESCRIPTOR::Limit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00325">_KSERVICE_TABLE_DESCRIPTOR::Number</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00301">NUMBER_SERVICE_TABLES</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00825                    :
00826 
00827     This function allows <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller to add a system service table
00828     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system
00829 
00830 Arguments:
00831 
00832     Base - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system service table dispatch
00833         table.
00834 
00835     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - Supplies an optional pointer to a table of per system service
00836         counters.
00837 
00838     Limit - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> service table. Services greater
00839         than or equal to <span class="keyword">this</span> limit will fail.
00840 
00841     Arguments - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> argument count table.
00842 
00843     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - Supplies index of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> service table.
00844 
00845 Return Value:
00846 
00847     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> - The operation was successful.
00848 
00849     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> - <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation failed. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> service table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already bound to
00850         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified location, or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified index <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> larger than
00851         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum allowed index.
00852 
00853 --*/
00854 
00855 {
00856 
00857     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00858 
00859     <span class="comment">//</span>
00860     <span class="comment">// If a system service table is already defined for the specified</span>
00861     <span class="comment">// index, then return FALSE. Otherwise, establish the new system</span>
00862     <span class="comment">// service table.</span>
00863     <span class="comment">//</span>
00864 
00865     <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt; <a class="code" href="../../d4/d9/ke_8h.html#a13">NUMBER_SERVICE_TABLES</a> - 1) ||
00866         (<a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o0">Base</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) ||
00867         (<a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o0">Base</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00868         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00869 
00870     } <span class="keywordflow">else</span> {
00871 
00872         <span class="comment">//</span>
00873         <span class="comment">// If the service table index is equal to the Win32 table, then</span>
00874         <span class="comment">// only update the shadow system service table. Otherwise, both</span>
00875         <span class="comment">// the shadow and static system service tables are updated.</span>
00876         <span class="comment">//</span>
00877 
00878         <a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o0">Base</a> = Base;
00879         <a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o1">Count</a> = <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00880         <a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o2">Limit</a> = Limit;
00881 <span class="preprocessor">#if defined(_IA64_)</span>
00882 <span class="preprocessor"></span>
00883             <span class="comment">//</span>
00884             <span class="comment">// The global pointer associated with the table base is</span>
00885             <span class="comment">// placed just before the service table.</span>
00886             <span class="comment">//</span>
00887 
00888             <a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].TableBaseGpOffset = 
00889                 (LONG)(*(Base-1) - (ULONG_PTR)Base);
00890 <span class="preprocessor">#endif</span>
00891 <span class="preprocessor"></span>        <a class="code" href="../../d4/d9/ke_8h.html#a146">KeServiceDescriptorTableShadow</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o3">Number</a> = Number;
00892         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> != 1) {
00893             <a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o0">Base</a> = Base;
00894             <a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o1">Count</a> = <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00895             <a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o2">Limit</a> = Limit;
00896 <span class="preprocessor">#if defined(_IA64_)</span>
00897 <span class="preprocessor"></span>            <a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].TableBaseGpOffset = 
00898                 (LONG)(*(Base-1) - (ULONG_PTR)Base);
00899 <span class="preprocessor">#endif</span>
00900 <span class="preprocessor"></span>            <a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html#o3">Number</a> = Number;
00901         }
00902 
00903         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00904     }
00905 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a312" doxytag="ke.h::KeAlertResumeThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KeAlertResumeThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00365">365</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d1/d9/ki_8h-source.html#l00035">ALERT_INCREMENT</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00267">NtAlertResumeThread()</a>.
<p>
<pre class="fragment"><div>00371                    :
00372 
00373     This function attempts to alert a thread in kernel mode and cause its
00374     execution to be continued <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> currently in an alertable Wait state.
00375     In addition, a resume operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00376 
00377 Arguments:
00378 
00379     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00380 
00381 Return Value:
00382 
00383     The previous suspend count.
00384 
00385 --*/
00386 
00387 {
00388 
00389     ULONG OldCount;
00390     KIRQL OldIrql;
00391 
00392     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00393     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00394 
00395     <span class="comment">//</span>
00396     <span class="comment">// Raise IRQL to dispatcher level, lock dispatcher database, and lock</span>
00397     <span class="comment">// APC queue.</span>
00398     <span class="comment">//</span>
00399 
00400     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00401     KiAcquireSpinLock(&amp;Thread-&gt;ApcQueueLock);
00402 
00403     <span class="comment">//</span>
00404     <span class="comment">// If the kernel mode alerted state is FALSE, then attempt to alert</span>
00405     <span class="comment">// the thread for kernel mode.</span>
00406     <span class="comment">//</span>
00407 
00408     <span class="keywordflow">if</span> (Thread-&gt;Alerted[<a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>] == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00409 
00410         <span class="comment">//</span>
00411         <span class="comment">// If the thread is currently in a Wait state and the Wait is alertable,</span>
00412         <span class="comment">// then the thread is unwaited with a status of "alerted". Else set the</span>
00413         <span class="comment">// kernel mode alerted variable.</span>
00414         <span class="comment">//</span>
00415 
00416         <span class="keywordflow">if</span> ((Thread-&gt;State == <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>) &amp;&amp; (Thread-&gt;Alertable == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)) {
00417             <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(Thread, STATUS_ALERTED, ALERT_INCREMENT);
00418 
00419         } <span class="keywordflow">else</span> {
00420             Thread-&gt;Alerted[<a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00421         }
00422     }
00423 
00424     <span class="comment">//</span>
00425     <span class="comment">// Capture the current suspend count.</span>
00426     <span class="comment">//</span>
00427 
00428     OldCount = Thread-&gt;SuspendCount;
00429 
00430     <span class="comment">//</span>
00431     <span class="comment">// If the thread is currently suspended, then decrement its suspend count.</span>
00432     <span class="comment">//</span>
00433 
00434     <span class="keywordflow">if</span> (OldCount != 0) {
00435         Thread-&gt;SuspendCount -= 1;
00436 
00437         <span class="comment">//</span>
00438         <span class="comment">// If the resultant suspend count is zero and the freeze count is</span>
00439         <span class="comment">// zero, then resume the thread by releasing its suspend semaphore.</span>
00440         <span class="comment">//</span>
00441 
00442         <span class="keywordflow">if</span> ((Thread-&gt;SuspendCount == 0) &amp;&amp; (Thread-&gt;FreezeCount == 0)) {
00443             Thread-&gt;SuspendSemaphore.Header.SignalState += 1;
00444             <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;Thread-&gt;SuspendSemaphore, RESUME_INCREMENT);
00445         }
00446     }
00447 
00448     <span class="comment">//</span>
00449     <span class="comment">// Unlock APC queue, unlock dispatcher database, lower IRQL to its</span>
00450     <span class="comment">// previous value, and return the previous suspend count.</span>
00451     <span class="comment">//</span>
00452 
00453     KiReleaseSpinLock(&amp;Thread-&gt;ApcQueueLock);
00454     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00455     <span class="keywordflow">return</span> OldCount;
00456 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a311" doxytag="ke.h::KeAlertThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeAlertThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessorMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00281">281</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d1/d9/ki_8h-source.html#l00035">ALERT_INCREMENT</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00214">NtAlertThread()</a>.
<p>
<pre class="fragment"><div>00288                    :
00289 
00290     This function attempts to alert a thread and cause its execution to
00291     be continued <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> currently in an alertable Wait state. Otherwise
00292     <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> just sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> alerted variable <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified processor mode.
00293 
00294 Arguments:
00295 
00296     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00297 
00298     AlertMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode <span class="keywordflow">for</span> which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00299         to be alerted.
00300 
00301 Return Value:
00302 
00303     The previous state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> alerted variable <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified processor
00304     mode.
00305 
00306 --*/
00307 
00308 {
00309 
00310     BOOLEAN Alerted;
00311     KIRQL OldIrql;
00312 
00313     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00314     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00315 
00316     <span class="comment">//</span>
00317     <span class="comment">// Raise IRQL to dispatcher level, lock dispatcher database, and lock</span>
00318     <span class="comment">// APC queue.</span>
00319     <span class="comment">//</span>
00320 
00321     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00322     KiAcquireSpinLock(&amp;Thread-&gt;ApcQueueLock);
00323 
00324     <span class="comment">//</span>
00325     <span class="comment">// Capture the current state of the alerted variable for the specified</span>
00326     <span class="comment">// processor mode.</span>
00327     <span class="comment">//</span>
00328 
00329     Alerted = Thread-&gt;Alerted[AlertMode];
00330 
00331     <span class="comment">//</span>
00332     <span class="comment">// If the alerted state for the specified processor mode is Not-Alerted,</span>
00333     <span class="comment">// then attempt to alert the thread.</span>
00334     <span class="comment">//</span>
00335 
00336     <span class="keywordflow">if</span> (Alerted == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00337 
00338         <span class="comment">//</span>
00339         <span class="comment">// If the thread is currently in a Wait state, the Wait is alertable,</span>
00340         <span class="comment">// and the specified processor mode is less than or equal to the Wait</span>
00341         <span class="comment">// mode, then the thread is unwaited with a status of "alerted".</span>
00342         <span class="comment">//</span>
00343 
00344         <span class="keywordflow">if</span> ((Thread-&gt;State == <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>) &amp;&amp; (Thread-&gt;Alertable == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) &amp;&amp;
00345             (AlertMode &lt;= Thread-&gt;WaitMode)) {
00346             <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(Thread, STATUS_ALERTED, ALERT_INCREMENT);
00347 
00348         } <span class="keywordflow">else</span> {
00349             Thread-&gt;Alerted[AlertMode] = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00350         }
00351     }
00352 
00353     <span class="comment">//</span>
00354     <span class="comment">// Unlock APC queue, unlock dispatcher database, lower IRQL to its</span>
00355     <span class="comment">// previous value, and return the previous alerted state for the</span>
00356     <span class="comment">// specified mode.</span>
00357     <span class="comment">//</span>
00358 
00359     KiReleaseSpinLock(&amp;Thread-&gt;ApcQueueLock);
00360     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00361     <span class="keywordflow">return</span> Alerted;
00362 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a301" doxytag="ke.h::KeAttachProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeAttachProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Process</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00166">166</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00658">_KTHREAD::ApcStateIndex</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00955">KiAttachProcess()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00656">_KTHREAD::SavedApcState</a>.
<p>
Referenced by <a class="el" href="../../d7/d6/winable2_8c-source.html#l00778">_GetComboBoxInfo()</a>, <a class="el" href="../../d7/d6/winable2_8c-source.html#l00946">_GetListBoxInfo()</a>, <a class="el" href="../../d2/d1/hooks_8c-source.html#l00986">CheckWHFBits()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00529">MiDoMappedCopy()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02788">MiEmptyAllWorkingSetsWorker()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00890">MiGetWorkingSetInfo()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l01474">MiLoadImageSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l02386">MmAssignProcessToJob()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04314">MmCreateTeb()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04843">MmDeleteTeb()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00297">MmFlushVirtualMemory()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00753">MmMapViewOfSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00813">MmProbeAndLockProcessPages()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07311">MmSetBankedSection()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05567">MmSetMemoryPriorityProcess()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00090">MmUnmapViewOfSection()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d6/d4/flushbuf_8c-source.html#l00142">NtFlushInstructionCache()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01483">PsAssignImpersonationToken()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00907">SepRmCallLsa()</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00322">SetProcessFlags()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01879">SmbTraceDisconnect()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02375">xxxCheckImeShowStatus()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01654">xxxCreateDisconnectDesktop()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00243">xxxCreateWindowStation()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l04211">xxxGetThreadDesktop()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00749">xxxImmActivateAndUnloadThreadsLayout()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l01329">xxxMinMaximize()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02544">xxxNotifyImeShowStatus()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02461">xxxSendMessageToUI()</a>, and <a class="el" href="../../d2/d1/hooks_8c-source.html#l00576">zzzSetWindowsHookEx()</a>.
<p>
<pre class="fragment"><div>00172                    :
00173 
00174     This function attaches a thread to a target process' address space
00175     <span class="keywordflow">if</span>, and <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> <span class="keywordflow">if</span>, there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not already a process attached.
00176 
00177 Arguments:
00178 
00179     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00180 
00181 Return Value:
00182 
00183     None.
00184 
00185 --*/
00186 
00187 {
00188 
00189     KIRQL OldIrql;
00190     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00191 
00192     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00193     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00194 
00195     <span class="comment">//</span>
00196     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00197     <span class="comment">//</span>
00198 
00199     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00200     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00201 
00202     <span class="comment">//</span>
00203     <span class="comment">// If the target process is the current process, then return immediately.</span>
00204     <span class="comment">// Otherwise, check whether there is a process address space attached or</span>
00205     <span class="comment">// the thread is executing a DPC. If either condition is true, then call</span>
00206     <span class="comment">// bug check. Otherwise, attach the target process.</span>
00207     <span class="comment">//</span>
00208 
00209     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a> == Process) {
00210         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00211 
00212     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> != 0) ||
00213                (KeIsExecutingDpc() != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00214         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(INVALID_PROCESS_ATTACH_ATTEMPT,
00215                      (ULONG_PTR)Process,
00216                      (ULONG_PTR)Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>,
00217                      (ULONG)Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a>,
00218                      (ULONG)KeIsExecutingDpc());
00219 
00220     } <span class="keywordflow">else</span> {
00221         <a class="code" href="../../d3/d5/procobj_8c.html#a13">KiAttachProcess</a>(Thread, Process, OldIrql, &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>);
00222     }
00223 
00224     <span class="keywordflow">return</span>;
00225 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a392" doxytag="ke.h::KeBalanceSetManager" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeBalanceSetManager           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">142</a> of file <a class="el" href="../../d0/d0/balmgr_8c-source.html">balmgr.c</a>.
<p>
References <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00089">ExAdjustLookasideDepth()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00098">EXECUTION_TIME_LIMITS_PERIOD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00623">Executive</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">KeInitializeTimer()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">KeSetPriorityThread()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00243">KeSetTimer()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00732">KiScanReadyQueues()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00139">KiStackOutSwapRequest</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02783">KiStackProtectTime</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00421">KiSwapEvent</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a59">KWAIT_BLOCK</a>, <a class="el" href="../../d9/d0/balmgr_8c.html#a26a18">MaximumObject</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l03073">MmQuerySystemSize()</a>, <a class="el" href="../../d2/d1/mm_8h.html#a343a165">MmSmallSystem</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00418">MmWorkingSetManagerEvent</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00069">PERIODIC_INTERVAL</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00083">SMALL_SYSTEM_STACK_PROTECT_TIME</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00084">STACK_PROTECT_TIME</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00085">STACK_SCAN_PERIOD</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d1/d9/worker_8c.html#a31a18">TimerExpiration</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d9/d0/balmgr_8c.html#a26a17">WorkingSetManagerEvent</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>.
<p>
<pre class="fragment"><div>00148                    :
00149 
00150     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> startup code <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> balance set manager. The
00151     balance set manager thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> created during system initialization
00152     and begins execution in <span class="keyword">this</span> function.
00153 
00154 Arguments:
00155 
00156     Context - Supplies a pointer to an arbitrary data structure (NULL).
00157 
00158 Return Value:
00159 
00160     None.
00161 
00162 --*/
00163 
00164 {
00165 
00166     LARGE_INTEGER DueTime;
00167     <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a> PeriodTimer;
00168     KIRQL OldIrql;
00169     ULONG StackScanPeriod;
00170     ULONG ExecutionTimeLimitPeriod;
00171     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00172     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a> WaitBlockArray[<a class="code" href="../../d9/d0/balmgr_8c.html#a26a18">MaximumObject</a>];
00173     PVOID WaitObjects[<a class="code" href="../../d9/d0/balmgr_8c.html#a26a18">MaximumObject</a>];
00174 
00175     <span class="comment">//</span>
00176     <span class="comment">// Raise the thread priority to the lowest realtime level.</span>
00177     <span class="comment">//</span>
00178 
00179     <a class="code" href="../../d9/d1/thredobj_8c.html#a24">KeSetPriorityThread</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>(), LOW_REALTIME_PRIORITY);
00180 
00181     <span class="comment">//</span>
00182     <span class="comment">// Initialize the periodic timer, set it to expire one period from</span>
00183     <span class="comment">// now, and set the stack scan period.</span>
00184     <span class="comment">//</span>
00185 
00186     <a class="code" href="../../d3/d2/timerobj_8c.html#a1">KeInitializeTimer</a>(&amp;PeriodTimer);
00187     DueTime.QuadPart = - <a class="code" href="../../d9/d0/balmgr_8c.html#a1">PERIODIC_INTERVAL</a>;
00188     <a class="code" href="../../d3/d2/timerobj_8c.html#a6">KeSetTimer</a>(&amp;PeriodTimer, DueTime, NULL);
00189     StackScanPeriod = <a class="code" href="../../d9/d0/balmgr_8c.html#a5">STACK_SCAN_PERIOD</a>;
00190     ExecutionTimeLimitPeriod = <a class="code" href="../../d9/d0/balmgr_8c.html#a11">EXECUTION_TIME_LIMITS_PERIOD</a>;
00191     <span class="comment">//</span>
00192     <span class="comment">// Compute the stack protect time based on the system size.</span>
00193     <span class="comment">//</span>
00194 
00195     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d1/mminit_8c.html#a57">MmQuerySystemSize</a>() == <a class="code" href="../../d2/d1/mm_8h.html#a343a165">MmSmallSystem</a>) {
00196         <a class="code" href="../../d4/d9/ke_8h.html#a140">KiStackProtectTime</a> = <a class="code" href="../../d9/d0/balmgr_8c.html#a3">SMALL_SYSTEM_STACK_PROTECT_TIME</a>;
00197 
00198     } <span class="keywordflow">else</span> {
00199         <a class="code" href="../../d4/d9/ke_8h.html#a140">KiStackProtectTime</a> = <a class="code" href="../../d9/d0/balmgr_8c.html#a4">STACK_PROTECT_TIME</a>;
00200     }
00201 
00202     <span class="comment">//</span>
00203     <span class="comment">// Initialize the wait objects array.</span>
00204     <span class="comment">//</span>
00205 
00206     WaitObjects[<a class="code" href="../../d1/d9/worker_8c.html#a31a18">TimerExpiration</a>] = (PVOID)&amp;PeriodTimer;
00207     WaitObjects[<a class="code" href="../../d9/d0/balmgr_8c.html#a26a17">WorkingSetManagerEvent</a>] = (PVOID)&amp;<a class="code" href="../../d2/d1/mm_8h.html#a139">MmWorkingSetManagerEvent</a>;
00208 
00209     <span class="comment">//</span>
00210     <span class="comment">// Loop forever processing balance set manager events.</span>
00211     <span class="comment">//</span>
00212 
00213     <span class="keywordflow">do</span> {
00214 
00215         <span class="comment">//</span>
00216         <span class="comment">// Wait for a memory management memory low event, a swap event,</span>
00217         <span class="comment">// or the expiration of the period timout rate that the balance</span>
00218         <span class="comment">// set manager runs at.</span>
00219         <span class="comment">//</span>
00220 
00221         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d7/wait_8c.html#a3">KeWaitForMultipleObjects</a>(MaximumObject,
00222                                           &amp;WaitObjects[0],
00223                                           WaitAny,
00224                                           Executive,
00225                                           KernelMode,
00226                                           FALSE,
00227                                           NULL,
00228                                           &amp;WaitBlockArray[0]);
00229 
00230         <span class="comment">//</span>
00231         <span class="comment">// Switch on the wait status.</span>
00232         <span class="comment">//</span>
00233 
00234         <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>) {
00235 
00236             <span class="comment">//</span>
00237             <span class="comment">// Periodic timer expiration.</span>
00238             <span class="comment">//</span>
00239 
00240         <span class="keywordflow">case</span> <a class="code" href="../../d1/d9/worker_8c.html#a31a18">TimerExpiration</a>:
00241 
00242             <span class="comment">//</span>
00243             <span class="comment">// Attempt to initiate outswaping of kernel stacks.</span>
00244             <span class="comment">//</span>
00245 
00246             StackScanPeriod -= 1;
00247             <span class="keywordflow">if</span> (StackScanPeriod == 0) {
00248                 StackScanPeriod = <a class="code" href="../../d9/d0/balmgr_8c.html#a5">STACK_SCAN_PERIOD</a>;
00249                 <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00250                 <span class="keywordflow">if</span> (<a class="code" href="../../d9/d0/balmgr_8c.html#a15">KiStackOutSwapRequest</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00251                     <a class="code" href="../../d9/d0/balmgr_8c.html#a15">KiStackOutSwapRequest</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00252                     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00253                     <a class="code" href="../../d2/d8/eventobj_8c.html#a8">KeSetEvent</a>(&amp;KiSwapEvent, 0, FALSE);
00254 
00255                 } <span class="keywordflow">else</span> {
00256                     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00257                 }
00258             }
00259 
00260             <span class="comment">//</span>
00261             <span class="comment">// Adjust the depth of lookaside lists.</span>
00262             <span class="comment">//</span>
00263 
00264             <a class="code" href="../../d5/d8/ex_8h.html#a245">ExAdjustLookasideDepth</a>();
00265 
00266             <span class="comment">//</span>
00267             <span class="comment">// Scan ready queues and boost thread priorities as appropriate.</span>
00268             <span class="comment">//</span>
00269 
00270             <a class="code" href="../../d9/d0/balmgr_8c.html#a23">KiScanReadyQueues</a>();
00271 
00272             <span class="comment">//</span>
00273             <span class="comment">// Execute the virtual memory working set manager.</span>
00274             <span class="comment">//</span>
00275 
00276             <a class="code" href="../../d5/d0/wsmanage_8c.html#a41">MmWorkingSetManager</a>();
00277 
00278             <span class="comment">//</span>
00279             <span class="comment">// Enforce execution time limits</span>
00280             <span class="comment">//</span>
00281 
00282             ExecutionTimeLimitPeriod -= 1;
00283             <span class="keywordflow">if</span> (ExecutionTimeLimitPeriod == 0) {
00284                 ExecutionTimeLimitPeriod = <a class="code" href="../../d9/d0/balmgr_8c.html#a11">EXECUTION_TIME_LIMITS_PERIOD</a>;
00285                 <a class="code" href="../../d1/d1/psjob_8c.html#a16">PsEnforceExecutionTimeLimits</a>();
00286                 }
00287 
00288             <span class="comment">//</span>
00289             <span class="comment">// Set the timer to expire at the next periodic interval.</span>
00290             <span class="comment">//</span>
00291 
00292             <a class="code" href="../../d3/d2/timerobj_8c.html#a6">KeSetTimer</a>(&amp;PeriodTimer, DueTime, NULL);
00293             <span class="keywordflow">break</span>;
00294 
00295             <span class="comment">//</span>
00296             <span class="comment">// Working set manager event.</span>
00297             <span class="comment">//</span>
00298 
00299         <span class="keywordflow">case</span> <a class="code" href="../../d9/d0/balmgr_8c.html#a26a17">WorkingSetManagerEvent</a>:
00300 
00301             <span class="comment">//</span>
00302             <span class="comment">// Call the working set manager to trim working sets.</span>
00303             <span class="comment">//</span>
00304 
00305             <a class="code" href="../../d5/d0/wsmanage_8c.html#a41">MmWorkingSetManager</a>();
00306             <span class="keywordflow">break</span>;
00307 
00308             <span class="comment">//</span>
00309             <span class="comment">// Illegal return status.</span>
00310             <span class="comment">//</span>
00311 
00312         <span class="keywordflow">default</span>:
00313             KdPrint((<span class="stringliteral">"BALMGR: Illegal wait status, %lx =\n"</span>, Status));
00314             <span class="keywordflow">break</span>;
00315         }
00316 
00317     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00318     <span class="keywordflow">return</span>;
00319 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a313" doxytag="ke.h::KeBoostCurrentThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeBoostCurrentThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00154">154</a> of file <a class="el" href="../../d3/d6/waitsup_8c-source.html">waitsup.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00590">_KTHREAD::BasePriority</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00591">_KTHREAD::DecrementCount</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">KeSetPriorityThread()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00574">_KTHREAD::Priority</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00592">_KTHREAD::PriorityDecrement</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00593">_KTHREAD::Quantum</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00042">ROUND_TRIP_DECREMENT_COUNT</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>.
<p>
<pre class="fragment"><div>00160                    :
00161 
00162     This function boosts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread <span class="keywordflow">for</span> one quantum,
00163     then reduce <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread priority to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread.
00164 
00165 Arguments:
00166 
00167     None.
00168 
00169 Return Value:
00170 
00171     None.
00172 
00173 --*/
00174 
00175 {
00176 
00177     KIRQL OldIrql;
00178     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00179 
00180     <span class="comment">//</span>
00181     <span class="comment">// Get current thread address, raise IRQL to synchronization level, and</span>
00182     <span class="comment">// lock the dispatcher database</span>
00183     <span class="comment">//</span>
00184 
00185     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00186 
00187 redoboost:
00188     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00189 
00190     <span class="comment">//</span>
00191     <span class="comment">// If a priority boost is not already active for the current thread</span>
00192     <span class="comment">// and the thread priority is less than 14, then boost the thread</span>
00193     <span class="comment">// priority to 14 and give the thread a large quantum. Otherwise,</span>
00194     <span class="comment">// if a priority boost is active, then decrement the round trip</span>
00195     <span class="comment">// count. If the count goes to zero, then release the dispatcher</span>
00196     <span class="comment">// database lock, lower the thread priority to the base priority,</span>
00197     <span class="comment">// and then attempt to boost the priority again. This will give</span>
00198     <span class="comment">// other threads a chance to run. If the count does not reach zero,</span>
00199     <span class="comment">// then give the thread another large qunatum.</span>
00200     <span class="comment">//</span>
00201     <span class="comment">// If the thread priority is above 14, then no boost is applied.</span>
00202     <span class="comment">//</span>
00203 
00204     <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> == 0) &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o13">Priority</a> &lt; 14)) {
00205         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> = 14 - Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a>;
00206         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o25">DecrementCount</a> = <a class="code" href="../../d4/d9/ke_8h.html#a4">ROUND_TRIP_DECREMENT_COUNT</a>;
00207         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o13">Priority</a> = 14;
00208         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a> * 2;
00209 
00210     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> != 0) {
00211         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o25">DecrementCount</a> -= 1;
00212         <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o25">DecrementCount</a> == 0) {
00213             <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00214             <a class="code" href="../../d9/d1/thredobj_8c.html#a24">KeSetPriorityThread</a>(Thread, Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a>);
00215             <span class="keywordflow">goto</span> redoboost;
00216 
00217         } <span class="keywordflow">else</span> {
00218             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a> * 2;
00219         }
00220     }
00221 
00222     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00223     <span class="keywordflow">return</span>;
00224 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a314" doxytag="ke.h::KeBoostPriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeBoostPriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00459">459</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00179">KiBoostPriorityThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00463">ExpWaitForResourceDdk()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00477">VdmDispatchInterrupts()</a>.
<p>
<pre class="fragment"><div>00466                    :
00467 
00468     This function boosts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread <span class="keyword">using</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00469     same algorithm used when a thread gets a boost from a wait operation.
00470 
00471 Arguments:
00472 
00473     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00474 
00475     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied to
00476         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread's priority.
00477 
00478 Return Value:
00479 
00480     None.
00481 
00482 --*/
00483 
00484 {
00485 
00486     KIRQL OldIrql;
00487 
00488     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00489 
00490     <span class="comment">//</span>
00491     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00492     <span class="comment">//</span>
00493 
00494     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00495 
00496     <span class="comment">//</span>
00497     <span class="comment">// If the thread does not run at a realtime priority level, then boost</span>
00498     <span class="comment">// the thread priority.</span>
00499     <span class="comment">//</span>
00500 
00501     <span class="keywordflow">if</span> (Thread-&gt;Priority &lt; LOW_REALTIME_PRIORITY) {
00502         <a class="code" href="../../d0/d0/ki_8h.html#a14">KiBoostPriorityThread</a>(Thread, Increment);
00503     }
00504 
00505     <span class="comment">//</span>
00506     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00507     <span class="comment">// value.</span>
00508     <span class="comment">//</span>
00509 
00510     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00511     <span class="keywordflow">return</span>;
00512 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a363" doxytag="ke.h::KeBugCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI DECLSPEC_NORETURN VOID NTAPI KeBugCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>BugCheckCode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00218">218</a> of file <a class="el" href="../../d7/d2/cmwraper_8c-source.html">cmwraper.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/poolhack_8c-source.html#l01400">CheckPool()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00413">ExAllocatePool()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00694">ExAllocatePoolWithQuota()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00970">ExFreePool()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00325">InitializePool()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l01804">IoBuildPartialMdl()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l01546">IopAssignNetworkDriveLetter()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00405">KeDetachProcess()</a>, <a class="el" href="../../d1/d2/ppc_2initkr_8c-source.html#l00653">KePhase0DeleteIoMap()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01302">KeSetAffinityThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00512">KeUnstackDetachProcess()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00090">Ki386CheckDivideByZeroTrap()</a>, <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00124">KiDataBusError()</a>, <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00115">KiEspToTrapFrame()</a>, <a class="el" href="../../d5/d3/i386_2intobj_8c-source.html#l00558">KiGetVectorInfo()</a>, <a class="el" href="../../d8/d2/i386init_8c-source.html#l00067">KiInitializeGDT()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00216">KiInstructionBusError()</a>, <a class="el" href="../../d1/d1/alpha_2buserror_8c-source.html#l00031">KiMachineCheck()</a>, <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00056">KiMemoryFault()</a>, <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00906">KiSystemServiceHandler()</a>, <a class="el" href="../../d8/d0/lbcbsup_8c-source.html#l00311">LfsGetLbcb()</a>, <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00153">MiMapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00035">MiMapPageInHyperSpace()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00313">MiMapPageToZeroInHyperSpace()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00138">PsInitSystem()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00631">PspExitNormalApc()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01920">PspSystemThreadStartup()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01438">PspThreadDelete()</a>, <a class="el" href="../../d1/d5/semethod_8c-source.html#l00195">SeDefaultObjectMethod()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00041">SeInitSystem()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00153">SepAuditFailed()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00384">SepDeReferenceLogonSession()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>.
<p>
<pre class="fragment"><div>00221 {
00222     printf(<span class="stringliteral">"BugCheck: code = %08lx\n"</span>, BugCheckCode);
00223     <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00224 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a364" doxytag="ke.h::KeBugCheckEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI DECLSPEC_NORETURN VOID KeBugCheckEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckParameter1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckParameter2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckParameter3</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckParameter4</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">428</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00014">DATA_BUS_ERROR</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00037">ExPoolCodeEnd</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00036">ExPoolCodeStart</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a411a244">HalRebootRoutine</a>, <a class="el" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d1/d0/inbv_8h-source.html#l00034">INBV_DISPLAY_STRING_FILTER</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a4">InbvAcquireDisplayOwnership()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a17">InbvEnableDisplayString()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a3">InbvInstallDisplayStringFilter()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a18">InbvIsBootDriverInstalled()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a6">InbvResetDisplay()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a26">InbvSetScrollRegion()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a27">InbvSetTextColor()</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a8">InbvSolidColorFill()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01519">IoWriteCrashDump()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00281">IPI_FREEZE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00024">IRQL_NOT_LESS_OR_EQUAL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00248">IS_SYSTEM_ADDRESS</a>, <a class="el" href="../../d9/d4/kddata_8c-source.html#l00106">KdDebuggerDataBlock</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00134">KdDebuggerEnabled</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00133">KdDebuggerNotPresent</a>, <a class="el" href="../../d6/d5/4_2kdinit_8c-source.html#l00072">KdInitSystem()</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00066">KdPitchDebugger</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00024">KeBugCheckCount</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00160">KeBugCheckUnicodeToAnsi()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00097">KeGetBugMessageText()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00023">KiBugCheckData</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00184">KiBugCheckDebugBreak()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00094">KiBugCheckDriver</a>, <a class="el" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00317">KiDumpParameterImages()</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00064">KiHardwareTrigger</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00253">KiIpiSend()</a>, <a class="el" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader()</a>, <a class="el" href="../../d6/d0/xxmpipi_8c-source.html#l00124">KiSaveProcessorControlState()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01207">KiScanBugCheckCallbackList()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00025">KMODE_EXCEPTION_NOT_HANDLED</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l05146">MmIsHydraAddress()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l05177">MmIsSpecialPoolAddressFree()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02836">MmLocateUnloadedDriver()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00039">MmPoolCodeEnd</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00038">MmPoolCodeStart</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00041">MmPteCodeEnd</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00040">MmPteCodeStart</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00425">POWER_FAILURE_SIMULATE</a>, <a class="el" href="../../d6/d9/heappage_8c.html#a68">sprintf()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00562">_KTHREAD::Teb</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00035">UNEXPECTED_KERNEL_MODE_TRAP</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03778">CmBootLastKnownGood()</a>, <a class="el" href="../../d6/d9/cmcontrl_8c-source.html#l00050">CmGetSystemControlValues()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02169">CmGetSystemDriverList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00081">CmpCheckLockExceptionFilter()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l01227">CmpHiveRootSecurityDescriptor()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l01512">CmpInitializeCache()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02022">CmpInitializeSystemHive()</a>, <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00265">CmpReleaseGlobalQuota()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l00158">CmpSecurityMethod()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01985">DrvDriverFailure()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03828">ExAllocatePoolSanityChecks()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03892">ExFreePoolSanityChecks()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d7/d5/ex_2region_8c-source.html#l00024">ExInitializeRegion()</a>, <a class="el" href="../../d7/d5/ex_2region_8c-source.html#l00110">ExInterlockedExtendRegion()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l01097">ExpCheckForWorker()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00345">FsRtlWorkerThread()</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l01584">HvRefreshHive()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00677">InitializePool()</a>, <a class="el" href="../../d8/d8/assign_8c-source.html#l00394">IoAssignResources()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00048">IoBuildPoDeviceNotifyList()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l02149">IoCancelIrp()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d5/d6/devnode_8c-source.html#l00297">IopDestroyDeviceNode()</a>, <a class="el" href="../../d2/d4/ioassert_8c-source.html#l00960">IopDriverCorrectnessThrowBugCheck()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01163">IopEnumerateDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l02063">IopfCallDriver()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02327">IopInitializeBootDrivers()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03479">IopMarkBootPartition()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00917">IopProcessRelation()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d2/d7/report_8c-source.html#l00297">IoReportResourceForDetection()</a>, <a class="el" href="../../d2/d7/report_8c-source.html#l00379">IoReportResourceUsage()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00455">IovBuildAsynchronousFsdRequest()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00486">IovBuildDeviceIoControlRequest()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00248">IovCallDriver()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00297">IovCompleteRequest()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00206">IovFreeIrpPrivate()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00524">IovInitializeTimer()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00542">IovpCompleteRequest()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l01159">IovSpecialIrpCallDriver()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l03007">KdpCauseBugCheck()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00166">KeAttachProcess()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d2/d1/mips_2buserror_8c-source.html#l00029">KeBusError()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00467">KeCheckForTimer()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00228">KeForceAttachProcess()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00238">KeRemoveQueue()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01218">KeRundownThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00324">KeStackAttachProcess()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02283">KfSanityCheckLowerIrql()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02233">KfSanityCheckRaiseIrql()</a>, <a class="el" href="../../d7/d6/apcsup_8c-source.html#l00030">KiDeliverApc()</a>, <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>, <a class="el" href="../../d1/d8/ia64_2exceptn_8c-source.html#l00098">KiEmulateFloat()</a>, <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00438">KiGeneralExceptions()</a>, <a class="el" href="../../d1/d3/ia32trap_8c-source.html#l00417">KiIA32ExceptionNoDevice()</a>, <a class="el" href="../../d1/d3/ia32trap_8c-source.html#l00938">KiIA32ExceptionPanic()</a>, <a class="el" href="../../d1/d3/ia32trap_8c-source.html#l00355">KiIA32InterceptInstruction()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00056">KiMemoryFault()</a>, <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00590">KiNatExceptions()</a>, <a class="el" href="../../d0/d4/intsupc_8c-source.html#l00159">KiRequestSoftwareInterrupt()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00879">MiAddMdlTracker()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00807">MiAllocatePoolPages()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03472">MiAllocateSpecialPool()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04116">MiCheckSessionPoolAllocations()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d7/d1/mm_2ia64_2initia64_8c-source.html#l02185">MiConvertToLoaderVirtual()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l01745">MiDecrementCloneBlockReference()</a>, <a class="el" href="../../d7/d4/pfndec_8c-source.html#l00167">MiDecrementReferenceCount()</a>, <a class="el" href="../../d7/d4/pfndec_8c-source.html#l00030">MiDecrementShareCount()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l00506">MiDeletePte()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04950">MiDeleteSystemPagableVm()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l03974">MiEliminateWorkingSetEntry()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00941">MiEnsureAvailablePageOrWait()</a>, <a class="el" href="../../d7/d1/mm_2ia64_2initia64_8c-source.html#l00225">MiEnsureAvailablePagesInFreeDescriptor()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01041">MiFreeMdlTracker()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l01778">MiFreePoolPages()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04071">MiFreeSessionSpaceMap()</a>, <a class="el" href="../../d7/d1/mm_2ia64_2initia64_8c-source.html#l00139">MiGetNextPhysicalPage()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l02204">MiHandleForkTransitionPte()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03764">MiInitializeCopyOnWritePfn()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03398">MiInitializePfn()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03523">MiInitializeReadInProgressPfn()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l03650">MiInitializeTransitionPfn()</a>, <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00059">MiInsertPageInList()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00388">MiInsertStandbyListAtFront()</a>, <a class="el" href="../../d8/d9/wstree_8c-source.html#l00248">MiLocateWsle()</a>, <a class="el" href="../../d8/d9/wstree_8c-source.html#l00765">MiLookupWsleHashIndex()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05287">MiMakeOutswappedPageResident()</a>, <a class="el" href="../../d1/d1/mmsup_8c-source.html#l00764">MiMakeSystemAddressValid()</a>, <a class="el" href="../../d1/d1/mmsup_8c-source.html#l00996">MiMakeSystemAddressValidPfn()</a>, <a class="el" href="../../d1/d1/mmsup_8c-source.html#l00916">MiMakeSystemAddressValidPfnSystemWs()</a>, <a class="el" href="../../d1/d1/mmsup_8c-source.html#l00837">MiMakeSystemAddressValidPfnWs()</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l01354">MiReleaseSystemPtes()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03893">MiRemoveFromSystemSpace()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l01567">MiRemovePageByColor()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00521">MiRemovePageFromList()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01675">MiRemovePteTracker()</a>, <a class="el" href="../../d8/d9/wstree_8c-source.html#l00464">MiRemoveWsle()</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l00524">MiReserveSystemPtes()</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l00843">MiReserveSystemPtes2()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l01989">MiResolveMappedFileFault()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00667">MiUnlinkPageFromList()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03625">MiVerifyingDriverUnloading()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l02335">MiWaitForInPageComplete()</a>, <a class="el" href="../../d5/d0/mmfault_8c-source.html#l00041">MmAccessFault()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02005">MmFreeLoaderBlock()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03742">MmFreeSpecialPool()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l03445">MmInPageKernelStack()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06864">MmLockPagableDataSection()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l00063">MmMapViewInSystemCache()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01548">MmPurgeSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01833">MmUnlockCachedPage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01347">MmUnlockPages()</a>, <a class="el" href="../../d8/d0/zeropage_8c-source.html#l00029">MmZeroPageThread()</a>, <a class="el" href="../../d4/d0/iniaxp64_8c-source.html#l00046">MxGetNextPage()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02713">NtUserInitialize()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00745">PspInitializeSystemDll()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01895">PspUnhandledExceptionInSystemThread()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02815">VerifierExAcquireFastMutex()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02841">VerifierExAcquireFastMutexUnsafe()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02182">VerifierExAcquireResourceExclusive()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02870">VerifierExReleaseFastMutex()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02899">VerifierExReleaseFastMutexUnsafe()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02208">VerifierExReleaseResource()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02789">VerifierExTryToAcquireFastMutex()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01976">VerifierFreeTrackedPool()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02406">VerifierKeReleaseSpinLock()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00662">VerifierMapIoSpace()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00688">VerifierMapLockedPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00751">VerifierMapLockedPagesSpecifyCache()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00537">VerifierProbeAndLockPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00563">VerifierProbeAndLockProcessPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00593">VerifierProbeAndLockSelectedPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02160">VerifierSetEvent()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00829">VerifierUnlockPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00906">VerifierUnmapIoSpace()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00874">VerifierUnmapLockedPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01447">ViReleasePoolAllocation()</a>, <a class="el" href="../../d6/d6/halfnc_8c-source.html#l00884">xHalAssignSlotResources()</a>, and <a class="el" href="../../d6/d6/halfnc_8c-source.html#l00866">xHalTranslateBusAddress()</a>.
<p>
<pre class="fragment"><div>00438                    :
00439 
00440     This function crashes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system in a controlled manner.
00441 
00442 Arguments:
00443 
00444     BugCheckCode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bug check.
00445 
00446     BugCheckParameter1-4 - Supplies additional bug check information
00447 
00448 Return Value:
00449 
00450     None.
00451 
00452 --*/
00453 
00454 {
00455     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[100];
00456     ULONG_PTR BugCheckParameters[4];
00457     CONTEXT ContextSave;
00458     ULONG PssMessage;
00459     PCHAR HardErrorCaption;
00460     PCHAR HardErrorMessage;
00461     KIRQL OldIrql;
00462     PKTRAP_FRAME TrapInformation;
00463     PVOID ExecutionAddress;
00464     PVOID ImageBase;
00465     PVOID VirtualAddress;
00466     PLDR_DATA_TABLE_ENTRY DataTableEntry;
00467     UCHAR AnsiBuffer[32];
00468     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00469     BOOLEAN InKernelOrHal;
00470     BOOLEAN DontCare;
00471 
00472 <span class="preprocessor">#if !defined(NT_UP)</span>
00473 <span class="preprocessor"></span>
00474     ULONG TargetSet;
00475 
00476 <span class="preprocessor">#endif</span>
00477 <span class="preprocessor"></span>    BOOLEAN hardErrorCalled;
00478 
00479     <span class="comment">//</span>
00480     <span class="comment">// Try to simulate a power failure for Cluster testing</span>
00481     <span class="comment">//</span>
00482 
00483     <span class="keywordflow">if</span> (BugCheckCode == <a class="code" href="../../d9/d1/bugcheck_8c.html#a1">POWER_FAILURE_SIMULATE</a>) {
00484         <a class="code" href="../../d9/d1/bugcheck_8c.html#a12">KiScanBugCheckCallbackList</a>();
00485         <a class="code" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware</a>(HalRebootRoutine);
00486     }
00487 
00488     <span class="comment">//</span>
00489     <span class="comment">// Capture the callers context as closely as possible into the debugger's</span>
00490     <span class="comment">// processor state area of the Prcb.</span>
00491     <span class="comment">//</span>
00492     <span class="comment">// N.B. There may be some prologue code that shuffles registers such that</span>
00493     <span class="comment">//      they get destroyed.</span>
00494     <span class="comment">//</span>
00495 
00496 <span class="preprocessor">#if defined(i386)</span>
00497 <span class="preprocessor"></span>    KiSetHardwareTrigger();
00498 <span class="preprocessor">#else</span>
00499 <span class="preprocessor"></span>    <a class="code" href="../../d4/d4/alpha_2splocks_8c.html#a12">KiHardwareTrigger</a> = 1;
00500 <span class="preprocessor">#endif</span>
00501 <span class="preprocessor"></span>
00502     RtlCaptureContext(&amp;<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;ProcessorState.ContextFrame);
00503     <a class="code" href="../../d9/d6/ppc_2ipi_8c.html#a1">KiSaveProcessorControlState</a>(&amp;<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;ProcessorState);
00504 
00505     <span class="comment">//</span>
00506     <span class="comment">// This is necessary on machines where the virtual unwind that happens</span>
00507     <span class="comment">// during KeDumpMachineState() destroys the context record.</span>
00508     <span class="comment">//</span>
00509 
00510     ContextSave = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;ProcessorState.ContextFrame;
00511 
00512     <span class="comment">//</span>
00513     <span class="comment">// If we are called by hard error then we don't want to dump the</span>
00514     <span class="comment">// processor state on the machine.</span>
00515     <span class="comment">//</span>
00516     <span class="comment">// We know that we are called by hard error because the bug check</span>
00517     <span class="comment">// code will be FATAL_UNHANDLED_HARD_ERROR.  If this is so then the</span>
00518     <span class="comment">// error status passed to harderr is the first parameter, and a pointer</span>
00519     <span class="comment">// to the parameter array from hard error is passed as the second</span>
00520     <span class="comment">// argument.</span>
00521     <span class="comment">//</span>
00522     <span class="comment">// The third argument is the OemCaption to be printed.</span>
00523     <span class="comment">// The last argument is the OemMessage to be printed.</span>
00524     <span class="comment">//</span>
00525 
00526     <span class="keywordflow">if</span> (BugCheckCode == FATAL_UNHANDLED_HARD_ERROR) {
00527 
00528         PULONG_PTR parameterArray;
00529 
00530         hardErrorCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00531 
00532         HardErrorCaption = (PCHAR)BugCheckParameter3;
00533         HardErrorMessage = (PCHAR)BugCheckParameter4;
00534         parameterArray = (PULONG_PTR)BugCheckParameter2;
00535         BugCheckCode = (ULONG)BugCheckParameter1;
00536         BugCheckParameter1 = parameterArray[0];
00537         BugCheckParameter2 = parameterArray[1];
00538         BugCheckParameter3 = parameterArray[2];
00539         BugCheckParameter4 = parameterArray[3];
00540 
00541     } <span class="keywordflow">else</span> {
00542 
00543         hardErrorCalled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00544 
00545         <span class="keywordflow">switch</span> (BugCheckCode) {
00546 
00547             <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a12">IRQL_NOT_LESS_OR_EQUAL</a>:
00548 
00549                 ExecutionAddress = (PVOID)BugCheckParameter4;
00550 
00551                 <span class="keywordflow">if</span> (ExecutionAddress &gt;= <a class="code" href="../../d9/d1/bugcheck_8c.html#a3">ExPoolCodeStart</a> &amp;&amp; ExecutionAddress &lt; <a class="code" href="../../d9/d1/bugcheck_8c.html#a4">ExPoolCodeEnd</a>) {
00552                     BugCheckCode = DRIVER_CORRUPTED_EXPOOL;
00553                 }
00554                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ExecutionAddress &gt;= <a class="code" href="../../d9/d1/bugcheck_8c.html#a5">MmPoolCodeStart</a> &amp;&amp; ExecutionAddress &lt; <a class="code" href="../../d9/d1/bugcheck_8c.html#a6">MmPoolCodeEnd</a>) {
00555                     BugCheckCode = DRIVER_CORRUPTED_MMPOOL;
00556                 }
00557                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ExecutionAddress &gt;= <a class="code" href="../../d9/d1/bugcheck_8c.html#a7">MmPteCodeStart</a> &amp;&amp; ExecutionAddress &lt; <a class="code" href="../../d9/d1/bugcheck_8c.html#a8">MmPteCodeEnd</a>) {
00558                     BugCheckCode = DRIVER_CORRUPTED_SYSPTES;
00559                 }
00560                 <span class="keywordflow">else</span> {
00561                     ImageBase = <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (ExecutionAddress,
00562                                                   &amp;DataTableEntry,
00563                                                   FALSE,
00564                                                   &amp;InKernelOrHal);
00565                     <span class="keywordflow">if</span> (InKernelOrHal == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00566 
00567                         <span class="comment">//</span>
00568                         <span class="comment">// The kernel faulted at raised IRQL.  Quite often this</span>
00569                         <span class="comment">// is a driver that has unloaded without deleting its</span>
00570                         <span class="comment">// lookaside lists or other resources.  Or its resources</span>
00571                         <span class="comment">// are marked pagable and shouldn't be.  Detect both</span>
00572                         <span class="comment">// cases here and identify the offending driver</span>
00573                         <span class="comment">// whenever possible.</span>
00574                         <span class="comment">//</span>
00575 
00576                         VirtualAddress = (PVOID)BugCheckParameter1;
00577 
00578                         ImageBase = <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (VirtualAddress,
00579                                                       &amp;DataTableEntry,
00580                                                       TRUE,
00581                                                       &amp;InKernelOrHal);
00582 
00583                         <span class="keywordflow">if</span> (ImageBase != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00584                             <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = &amp;DataTableEntry-&gt;BaseDllName;
00585                             BugCheckCode = DRIVER_PORTION_MUST_BE_NONPAGED;
00586                         }
00587                         <span class="keywordflow">else</span> {
00588                             <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = <a class="code" href="../../d8/d8/sysload_8c.html#a58">MmLocateUnloadedDriver</a> (VirtualAddress);
00589                             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00590                                 BugCheckCode = SYSTEM_SCAN_AT_RAISED_IRQL_CAUGHT_IMPROPER_DRIVER_UNLOAD;
00591                             }
00592                         }
00593                     }
00594                     <span class="keywordflow">else</span> {
00595                         BugCheckCode = DRIVER_IRQL_NOT_LESS_OR_EQUAL;
00596                     }
00597                 }
00598                 <span class="keywordflow">break</span>;
00599 
00600             <span class="keywordflow">case</span> ATTEMPTED_WRITE_TO_READONLY_MEMORY:
00601 
00602                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00603                 TrapInformation = (PKTRAP_FRAME)BugCheckParameter3;
00604 
00605                 <span class="comment">//</span>
00606                 <span class="comment">// Extract the execution address from the trap frame to</span>
00607                 <span class="comment">// identify the component.</span>
00608                 <span class="comment">//</span>
00609 
00610                 <span class="keywordflow">if</span> (TrapInformation != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00611                     ExecutionAddress = (PVOID)PROGRAM_COUNTER (TrapInformation);
00612                     ImageBase = <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (ExecutionAddress,
00613                                                   &amp;DataTableEntry,
00614                                                   TRUE,
00615                                                   &amp;InKernelOrHal);
00616 
00617                     <span class="keywordflow">if</span> (ImageBase != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00618                         <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = &amp;DataTableEntry-&gt;BaseDllName;
00619                     }
00620                 }
00621 
00622                 <span class="keywordflow">break</span>;
00623 
00624             <span class="keywordflow">case</span> DRIVER_LEFT_LOCKED_PAGES_IN_PROCESS:
00625 
00626                 ExecutionAddress = (PVOID)BugCheckParameter1;
00627 
00628                 ImageBase = <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (ExecutionAddress,
00629                                               &amp;DataTableEntry,
00630                                               TRUE,
00631                                               &amp;InKernelOrHal);
00632 
00633                 <span class="keywordflow">if</span> (ImageBase != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00634                     <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = &amp;DataTableEntry-&gt;BaseDllName;
00635                 }
00636                 <span class="keywordflow">else</span> {
00637                     <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = <a class="code" href="../../d8/d8/sysload_8c.html#a58">MmLocateUnloadedDriver</a> (ExecutionAddress);
00638                 }
00639 
00640                 BugCheckParameter4 = (ULONG_PTR)<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a>;
00641 
00642                 <span class="keywordflow">break</span>;
00643 
00644             <span class="keywordflow">case</span> DRIVER_USED_EXCESSIVE_PTES:
00645 
00646                 DataTableEntry = (PLDR_DATA_TABLE_ENTRY)BugCheckParameter1;
00647                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = &amp;DataTableEntry-&gt;BaseDllName;
00648 
00649                 <span class="keywordflow">break</span>;
00650 
00651             <span class="keywordflow">case</span> PAGE_FAULT_IN_NONPAGED_AREA:
00652 
00653                 ExecutionAddress = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00654                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00655 
00656                 VirtualAddress = (PVOID)BugCheckParameter1;
00657 
00658                 TrapInformation = (PKTRAP_FRAME)BugCheckParameter3;
00659 
00660                 <span class="comment">//</span>
00661                 <span class="comment">// Extract the execution address from the trap frame to</span>
00662                 <span class="comment">// identify the component.</span>
00663                 <span class="comment">//</span>
00664 
00665                 <span class="keywordflow">if</span> (TrapInformation != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00666 
00667                     ExecutionAddress = (PVOID)PROGRAM_COUNTER (TrapInformation);
00668                     BugCheckParameter3 = (ULONG_PTR)ExecutionAddress;
00669 
00670                     <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (ExecutionAddress,
00671                                       &amp;DataTableEntry,
00672                                       FALSE,
00673                                       &amp;InKernelOrHal);
00674 
00675                     ImageBase = <a class="code" href="../../d8/d0/ppc_2dmpstate_8c.html#a4">KiPcToFileHeader</a> (ExecutionAddress,
00676                                                   &amp;DataTableEntry,
00677                                                   TRUE,
00678                                                   &amp;DontCare);
00679 
00680                     <span class="keywordflow">if</span> (ImageBase != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00681                         <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = &amp;DataTableEntry-&gt;BaseDllName;
00682                     }
00683                 }
00684                 <span class="keywordflow">else</span> {
00685 
00686                     <span class="comment">//</span>
00687                     <span class="comment">// No trap frame, so no execution address either.</span>
00688                     <span class="comment">//</span>
00689 
00690                     BugCheckParameter3 = 0;
00691                 }
00692 
00693                 Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00694 
00695                 <span class="keywordflow">if</span> ((VirtualAddress &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp;
00696                     (VirtualAddress &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
00697 
00698                     <span class="comment">//</span>
00699                     <span class="comment">// Update the bugcheck number so the administrator gets</span>
00700                     <span class="comment">// useful feedback that enabling special pool has enabled</span>
00701                     <span class="comment">// the system to locate the corruptor.</span>
00702                     <span class="comment">//</span>
00703 
00704                     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6/allocpag_8c.html#a66">MmIsSpecialPoolAddressFree</a> (VirtualAddress) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00705                         <span class="keywordflow">if</span> (InKernelOrHal == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00706                             BugCheckCode = PAGE_FAULT_IN_FREED_SPECIAL_POOL;
00707                         }
00708                         <span class="keywordflow">else</span> {
00709                             BugCheckCode = DRIVER_PAGE_FAULT_IN_FREED_SPECIAL_POOL;
00710                         }
00711                     }
00712                     <span class="keywordflow">else</span> {
00713                         <span class="keywordflow">if</span> (InKernelOrHal == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00714                             BugCheckCode = PAGE_FAULT_BEYOND_END_OF_ALLOCATION;
00715                         }
00716                         <span class="keywordflow">else</span> {
00717                             BugCheckCode = DRIVER_PAGE_FAULT_BEYOND_END_OF_ALLOCATION;
00718                         }
00719                     }
00720                 }
00721                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ExecutionAddress == VirtualAddress) &amp;&amp;
00722                         (<a class="code" href="../../d1/d6/allocpag_8c.html#a65">MmIsHydraAddress</a> (VirtualAddress) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) &amp;&amp;
00723                         ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o4">Teb</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (<a class="code" href="../../d2/d1/mm_8h.html#a10">IS_SYSTEM_ADDRESS</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o4">Teb</a>)))) {
00724                     <span class="comment">//</span>
00725                     <span class="comment">// This is a driver reference to session space from a</span>
00726                     <span class="comment">// worker thread.  Since the system process has no session</span>
00727                     <span class="comment">// space this is illegal and the driver must be fixed.</span>
00728                     <span class="comment">//</span>
00729 
00730                     BugCheckCode = TERMINAL_SERVER_DRIVER_MADE_INCORRECT_MEMORY_REFERENCE;
00731                 }
00732                 <span class="keywordflow">else</span> {
00733                     <a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> = <a class="code" href="../../d8/d8/sysload_8c.html#a58">MmLocateUnloadedDriver</a> (VirtualAddress);
00734                     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00735                         BugCheckCode = DRIVER_UNLOADED_WITHOUT_CANCELLING_PENDING_OPERATIONS;
00736                     }
00737                 }
00738 
00739                 <span class="keywordflow">break</span>;
00740 
00741             <span class="keywordflow">default</span>:
00742                 <span class="keywordflow">break</span>;
00743         }
00744     }
00745 
00746     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00747         <a class="code" href="../../d9/d1/bugcheck_8c.html#a15">KeBugCheckUnicodeToAnsi</a> (KiBugCheckDriver,
00748                                  AnsiBuffer,
00749                                  <span class="keyword">sizeof</span> (AnsiBuffer));
00750     }
00751 
00752     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a2">KiBugCheckData</a>[0] = BugCheckCode;
00753     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a2">KiBugCheckData</a>[1] = BugCheckParameter1;
00754     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a2">KiBugCheckData</a>[2] = BugCheckParameter2;
00755     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a2">KiBugCheckData</a>[3] = BugCheckParameter3;
00756     <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a2">KiBugCheckData</a>[4] = BugCheckParameter4;
00757 
00758     BugCheckParameters[0] = BugCheckParameter1;
00759     BugCheckParameters[1] = BugCheckParameter2;
00760     BugCheckParameters[2] = BugCheckParameter3;
00761     BugCheckParameters[3] = BugCheckParameter4;
00762 
00763     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> ) {
00764         <a class="code" href="../../d8/d5/kddata_8c.html#a50">KdDebuggerDataBlock</a>.SavedContext = (ULONG_PTR) &amp;ContextSave;
00765     }
00766 
00767     <span class="comment">//</span>
00768     <span class="comment">// If the user manually crashed the machine, skips the DbgPrints and</span>
00769     <span class="comment">// go to the crashdump.</span>
00770     <span class="comment">// Trying to do DbgPrint causes us to reeeter the debugger which causes</span>
00771     <span class="comment">// some problems.</span>
00772     <span class="comment">//</span>
00773     <span class="comment">// Otherwise, if the debugger is enabled, print out the information and</span>
00774     <span class="comment">// stop.</span>
00775     <span class="comment">//</span>
00776 
00777     <span class="keywordflow">if</span> ((BugCheckCode != MANUALLY_INITIATED_CRASH) &amp;&amp;
00778         (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a>)) {
00779 
00780         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n*** Fatal System Error: 0x%08lx\n"</span>
00781                  <span class="stringliteral">"                       (0x%p,0x%p,0x%p,0x%p)\n\n"</span>,
00782                  BugCheckCode,
00783                  BugCheckParameter1,
00784                  BugCheckParameter2,
00785                  BugCheckParameter3,
00786                  BugCheckParameter4);
00787 
00788         <span class="comment">//</span>
00789         <span class="comment">// If the debugger is not actually connected, or the user manually</span>
00790         <span class="comment">// crashed the machine by typing .crash in the debugger, proceed to</span>
00791         <span class="comment">// "blue screen" the system.</span>
00792         <span class="comment">//</span>
00793         <span class="comment">// The call to DbgPrint above will have set the state of</span>
00794         <span class="comment">// KdDebuggerNotPresent if the debugger has become disconnected</span>
00795         <span class="comment">// since the system was booted.</span>
00796         <span class="comment">//</span>
00797 
00798         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a12">KdDebuggerNotPresent</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00799 
00800             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00801                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"The %s driver may be at fault.\n"</span>, AnsiBuffer);
00802             }
00803 
00804             <span class="keywordflow">if</span> (hardErrorCalled != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00805                 <span class="keywordflow">if</span> (HardErrorCaption) {
00806                     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(HardErrorCaption);
00807                 }
00808                 <span class="keywordflow">if</span> (HardErrorMessage) {
00809                     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(HardErrorMessage);
00810                 }
00811             }
00812 
00813             <a class="code" href="../../d9/d1/bugcheck_8c.html#a16">KiBugCheckDebugBreak</a> (DBG_STATUS_BUGCHECK_FIRST);
00814         }
00815     }
00816 
00817     <span class="comment">//</span>
00818     <span class="comment">// Freeze execution of the system by disabling interrupts and looping.</span>
00819     <span class="comment">//</span>
00820 
00821     <a class="code" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts</a>();
00822     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
00823 
00824     <span class="comment">//</span>
00825     <span class="comment">// Don't attempt to display message more than once.</span>
00826     <span class="comment">//</span>
00827 
00828     <span class="keywordflow">if</span> (InterlockedDecrement (&amp;KeBugCheckCount) == 0) {
00829 
00830 <span class="preprocessor">#if !defined(NT_UP)</span>
00831 <span class="preprocessor"></span>
00832         <span class="comment">//</span>
00833         <span class="comment">// Attempt to get the other processors frozen now, but don't wait</span>
00834         <span class="comment">// for them to freeze (in case someone is stuck).</span>
00835         <span class="comment">//</span>
00836 
00837         TargetSet = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a> &amp; ~<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;SetMember;
00838         <span class="keywordflow">if</span> (TargetSet != 0) {
00839             <a class="code" href="../../d0/d0/ki_8h.html#a90">KiIpiSend</a>((KAFFINITY) TargetSet, IPI_FREEZE);
00840 
00841             <span class="comment">//</span>
00842             <span class="comment">// Give the other processors one second to flush their data caches.</span>
00843             <span class="comment">//</span>
00844             <span class="comment">// N.B. This cannot be synchronized since the reason for the bug</span>
00845             <span class="comment">//      may be one of the other processors failed.</span>
00846             <span class="comment">//</span>
00847 
00848             <a class="code" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor</a>(1000 * 1000);
00849         }
00850 
00851 <span class="preprocessor">#endif</span>
00852 <span class="preprocessor"></span>
00853         <span class="comment">//</span>
00854         <span class="comment">// Enable InbvDisplayString calls to make it through to bootvid driver.</span>
00855         <span class="comment">//</span>
00856 
00857         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1/inbv_8h.html#a18">InbvIsBootDriverInstalled</a>()) {
00858 
00859             <a class="code" href="../../d0/d1/inbv_8h.html#a4">InbvAcquireDisplayOwnership</a>();
00860 
00861             <a class="code" href="../../d0/d1/inbv_8h.html#a6">InbvResetDisplay</a>();
00862             <a class="code" href="../../d0/d1/inbv_8h.html#a8">InbvSolidColorFill</a>(0,0,639,479,4); <span class="comment">// make the screen blue</span>
00863             <a class="code" href="../../d0/d1/inbv_8h.html#a27">InbvSetTextColor</a>(15);
00864             <a class="code" href="../../d0/d1/inbv_8h.html#a3">InbvInstallDisplayStringFilter</a>((INBV_DISPLAY_STRING_FILTER)NULL);
00865             <a class="code" href="../../d0/d1/inbv_8h.html#a17">InbvEnableDisplayString</a>(TRUE);     <span class="comment">// enable display string</span>
00866             <a class="code" href="../../d0/d1/inbv_8h.html#a26">InbvSetScrollRegion</a>(0,0,639,479);  <span class="comment">// set to use entire screen</span>
00867         }
00868 
00869         <span class="keywordflow">if</span> (!hardErrorCalled) {
00870             <a class="code" href="../../d6/d9/heappage_8c.html#a68">sprintf</a>((<span class="keywordtype">char</span> *)Buffer,
00871                     <span class="stringliteral">"\n*** STOP: 0x%08lX (0x%p,0x%p,0x%p,0x%p)\n"</span>,
00872                     BugCheckCode,
00873                     BugCheckParameter1,
00874                     BugCheckParameter2,
00875                     BugCheckParameter3,
00876                     BugCheckParameter4
00877                     );
00878             <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>((<span class="keywordtype">char</span> *)Buffer);
00879 
00880             <a class="code" href="../../d9/d1/bugcheck_8c.html#a14">KeGetBugMessageText</a>(BugCheckCode, NULL);
00881             <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(<span class="stringliteral">"\n"</span>);
00882 
00883             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d1/bugcheck_8c.html#a11">KiBugCheckDriver</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00884 
00885                 <span class="comment">//</span>
00886                 <span class="comment">// Output the driver name.</span>
00887                 <span class="comment">//</span>
00888 
00889                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a14">KeGetBugMessageText</a>(BUGCODE_ID_DRIVER, NULL);
00890                 <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(AnsiBuffer);
00891                 <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(<span class="stringliteral">"\n"</span>);
00892             }
00893 
00894         } <span class="keywordflow">else</span> {
00895             <span class="keywordflow">if</span> (HardErrorCaption) {
00896                 <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(HardErrorCaption);
00897             }
00898             <span class="keywordflow">if</span> (HardErrorMessage) {
00899                 <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(HardErrorMessage);
00900             }
00901         }
00902 
00903         <span class="comment">//</span>
00904         <span class="comment">// Process the bug check callback list.</span>
00905         <span class="comment">//</span>
00906 
00907         <a class="code" href="../../d9/d1/bugcheck_8c.html#a12">KiScanBugCheckCallbackList</a>();
00908 
00909         <span class="comment">//</span>
00910         <span class="comment">// If the debugger is not enabled, then dump the machine state and</span>
00911         <span class="comment">// attempt to enable the debugger.</span>
00912         <span class="comment">//</span>
00913 
00914         <span class="keywordflow">if</span> (!hardErrorCalled) {
00915 
00916             <a class="code" href="../../d9/d1/bugcheck_8c.html#a18">KiDumpParameterImages</a>(
00917                 (<span class="keywordtype">char</span> *)Buffer,
00918                 BugCheckParameters,
00919                 4,
00920                 KeBugCheckUnicodeToAnsi);
00921 
00922         }
00923 
00924         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> &amp;&amp; <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> ) {
00925             <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a4">KdInitSystem</a>(NULL, FALSE);
00926 
00927         } <span class="keywordflow">else</span> {
00928             <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(<span class="stringliteral">"\n"</span>);
00929         }
00930 
00931         <span class="comment">//</span>
00932         <span class="comment">// Write a crash dump and optionally reboot if the system has been</span>
00933         <span class="comment">// so configured.</span>
00934         <span class="comment">//</span>
00935 
00936         <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;ProcessorState.ContextFrame = ContextSave;
00937 
00938         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d3/dumpctl_8c.html#a43">IoWriteCrashDump</a>(BugCheckCode,
00939                               BugCheckParameter1,
00940                               BugCheckParameter2,
00941                               BugCheckParameter3,
00942                               BugCheckParameter4,
00943                               &amp;ContextSave
00944                               )) {
00945             <span class="comment">//</span>
00946             <span class="comment">// If no crashdump take, display the PSS message.</span>
00947             <span class="comment">//</span>
00948 
00949             <span class="keywordflow">switch</span> ( BugCheckCode ) {
00950 
00951                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a12">IRQL_NOT_LESS_OR_EQUAL</a>:
00952                 <span class="keywordflow">case</span> DRIVER_IRQL_NOT_LESS_OR_EQUAL:
00953                 <span class="keywordflow">case</span> DRIVER_CORRUPTED_EXPOOL:
00954                 <span class="keywordflow">case</span> DRIVER_CORRUPTED_MMPOOL:
00955                 <span class="keywordflow">case</span> DRIVER_PORTION_MUST_BE_NONPAGED:
00956                 <span class="keywordflow">case</span> SYSTEM_SCAN_AT_RAISED_IRQL_CAUGHT_IMPROPER_DRIVER_UNLOAD:
00957                     PssMessage = BUGCODE_PSS_MESSAGE_A;
00958                     <span class="keywordflow">break</span>;
00959 
00960                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a13">KMODE_EXCEPTION_NOT_HANDLED</a>:
00961                     PssMessage = BUGCODE_PSS_MESSAGE_1E;
00962                     <span class="keywordflow">break</span>;
00963 
00964                 <span class="keywordflow">case</span> FAT_FILE_SYSTEM:
00965                 <span class="keywordflow">case</span> NTFS_FILE_SYSTEM:
00966                     PssMessage = BUGCODE_PSS_MESSAGE_23;
00967                     <span class="keywordflow">break</span>;
00968 
00969                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a2">DATA_BUS_ERROR</a>:
00970                     PssMessage = BUGCODE_PSS_MESSAGE_2E;
00971                     <span class="keywordflow">break</span>;
00972 
00973                 <span class="keywordflow">case</span> NO_MORE_SYSTEM_PTES:
00974                     PssMessage = BUGCODE_PSS_MESSAGE_3F;
00975                     <span class="keywordflow">break</span>;
00976 
00977                 <span class="keywordflow">case</span> INACCESSIBLE_BOOT_DEVICE:
00978                     PssMessage = BUGCODE_PSS_MESSAGE_7B;
00979                     <span class="keywordflow">break</span>;
00980 
00981                 <span class="keywordflow">case</span> <a class="code" href="../../d6/d7/halmips_8h.html#a23">UNEXPECTED_KERNEL_MODE_TRAP</a>:
00982                     PssMessage = BUGCODE_PSS_MESSAGE_7F;
00983                     <span class="keywordflow">break</span>;
00984 
00985                 <span class="keywordflow">case</span> STATUS_SYSTEM_IMAGE_BAD_SIGNATURE:
00986                     PssMessage = BUGCODE_PSS_MESSAGE_SIGNATURE;
00987                     <span class="keywordflow">break</span>;
00988 
00989                 <span class="keywordflow">case</span> ACPI_BIOS_ERROR:
00990                     PssMessage = BUGCODE_PSS_MESSAGE_A5;
00991                     <span class="keywordflow">break</span>;
00992 
00993                 <span class="keywordflow">case</span> ACPI_BIOS_FATAL_ERROR:
00994                     PssMessage = ACPI_BIOS_FATAL_ERROR;
00995                     <span class="keywordflow">break</span>;
00996 
00997                 <span class="keywordflow">default</span>:
00998                     PssMessage = BUGCODE_PSS_MESSAGE;
00999                     <span class="keywordflow">break</span>;
01000                 }
01001 
01002             <a class="code" href="../../d9/d1/bugcheck_8c.html#a14">KeGetBugMessageText</a>(PssMessage, NULL);
01003         }
01004     }
01005 
01006     <span class="comment">//</span>
01007     <span class="comment">// Attempt to enter the kernel debugger.</span>
01008     <span class="comment">//</span>
01009 
01010     <a class="code" href="../../d9/d1/bugcheck_8c.html#a16">KiBugCheckDebugBreak</a> (DBG_STATUS_BUGCHECK_SECOND);
01011     <span class="keywordflow">return</span>;
01012 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a343" doxytag="ke.h::KeCancelTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeCancelTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PKTIMER</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00157">157</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00037">ASSERT_TIMER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00755">KiRemoveTreeTimer</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l00232">ExpDeleteTimer()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00346">ExTimerRundown()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00679">NtCancelTimer()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.
<p>
<pre class="fragment"><div>00163                    :
00164 
00165     This function cancels a timer that was previously set to expire at
00166     a specified time. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not currently set, then no operation
00167     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Canceling a timer does not set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer to
00168     Signaled.
00169 
00170 Arguments:
00171 
00172     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00173 
00174 Return Value:
00175 
00176     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified timer was
00177     currently set. Else a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00178 
00179 --*/
00180 
00181 {
00182 
00183     BOOLEAN Inserted;
00184     KIRQL OldIrql;
00185 
00186     <a class="code" href="../../d3/d2/timerobj_8c.html#a0">ASSERT_TIMER</a>(Timer);
00187     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// Raise IRQL to dispatcher level, lock the dispatcher database, and</span>
00191     <span class="comment">// capture the timer inserted status. If the timer is currently set,</span>
00192     <span class="comment">// then remove it from the timer list.</span>
00193     <span class="comment">//</span>
00194 
00195     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00196     Inserted = Timer-&gt;Header.Inserted;
00197     <span class="keywordflow">if</span> (Inserted != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00198         <a class="code" href="../../d0/d0/ki_8h.html#a22">KiRemoveTreeTimer</a>(Timer);
00199     }
00200 
00201     <span class="comment">//</span>
00202     <span class="comment">// Unlock the dispatcher database, lower IRQL to its previous value, and</span>
00203     <span class="comment">// return boolean value that signifies whether the timer was set of not.</span>
00204     <span class="comment">//</span>
00205 
00206     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00207     <span class="keywordflow">return</span> Inserted;
00208 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a347" doxytag="ke.h::KeCheckForTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID KeCheckForTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00467">467</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00278">BlockSize</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00336">_KDPC::DeferredRoutine</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00525">_KTIMER::Dpc</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00050">End</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00059">KiTimerTableListHead</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00049">Start</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00094">TIMER_TABLE_SIZE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03892">ExFreePoolSanityChecks()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03020">VerifierKeInitializeTimerEx()</a>.
<p>
<pre class="fragment"><div>00473                    :
00474 
00475     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used <span class="keywordflow">for</span> debugging by checking all timers
00476     to see <span class="keywordflow">if</span> any <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> memory block passed.  If so, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00477     system stops at a debug breakpoint.
00478 
00479 Arguments:
00480 
00481     MemoryBlock - Base address to check <span class="keywordflow">for</span> timer
00482 
00483     <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> - <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a> (in bytes) to check in memory block
00484 
00485 Return Value:
00486 
00487     The address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> currently active timer.
00488 
00489 --*/
00490 {
00491     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00492     PLIST_ENTRY ListHead;
00493     PLIST_ENTRY NextEntry;
00494     KIRQL OldIrql;
00495     <a class="code" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer;
00496     PUCHAR Address;
00497     PUCHAR <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a>;
00498     PUCHAR <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>;
00499 
00500     <span class="comment">//</span>
00501     <span class="comment">// Compute the ending memory location.</span>
00502     <span class="comment">//</span>
00503 
00504     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> = (PUCHAR)BlockStart;
00505     <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a> = <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> + <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>;
00506 
00507     <span class="comment">//</span>
00508     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00509     <span class="comment">//</span>
00510 
00511     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00512 
00513     <span class="comment">//</span>
00514     <span class="comment">// Run the entire timer database and check for any timers in</span>
00515     <span class="comment">// the memory block</span>
00516     <span class="comment">//</span>
00517 
00518     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0;
00519     <span class="keywordflow">do</span> {
00520         ListHead = &amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a3">KiTimerTableListHead</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00521         NextEntry = ListHead-&gt;Flink;
00522         <span class="keywordflow">while</span> (NextEntry != ListHead) {
00523             Timer = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>, TimerListEntry);
00524             Address = (PUCHAR)Timer;
00525             NextEntry = NextEntry-&gt;Flink;
00526 
00527             <span class="comment">//</span>
00528             <span class="comment">// Check this timer object is not in the range.</span>
00529             <span class="comment">// In each of the following, we check that the object</span>
00530             <span class="comment">// does not overlap the range, for example, if the timer</span>
00531             <span class="comment">// object (in this first check), starts one dword before</span>
00532             <span class="comment">// the range being checked, we have an overlap and should</span>
00533             <span class="comment">// stop.</span>
00534             <span class="comment">//</span>
00535 
00536             <span class="keywordflow">if</span> ((Address &gt; (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>))) &amp;&amp;
00537                 (Address &lt; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>)) {
00538                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(TIMER_OR_DPC_INVALID,
00539                              0x0,
00540                              (ULONG_PTR)Address,
00541                              (ULONG_PTR)Start,
00542                              (ULONG_PTR)End);
00543             }
00544 
00545             <span class="keywordflow">if</span> (Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o3">Dpc</a>) {
00546 
00547                 <span class="comment">//</span>
00548                 <span class="comment">// Check the timer's DPC object isn't in the range.</span>
00549                 <span class="comment">//</span>
00550 
00551                 Address = (PUCHAR)Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o3">Dpc</a>;
00552                 <span class="keywordflow">if</span> ((Address &gt; (<a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> - <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6/struct__KDPC.html">KDPC</a>))) &amp;&amp;
00553                     (Address &lt; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>)) {
00554                     <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(TIMER_OR_DPC_INVALID,
00555                                  0x1,
00556                                  (ULONG_PTR)Address,
00557                                  (ULONG_PTR)Start,
00558                                  (ULONG_PTR)End);
00559                 }
00560 
00561                 <span class="comment">//</span>
00562                 <span class="comment">// Check the timer's DPC routine is not in the range.</span>
00563                 <span class="comment">//</span>
00564 
00565                 Address = (PUCHAR)Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o3">Dpc</a>-&gt;<a class="code" href="../../d1/d6/struct__KDPC.html#o4">DeferredRoutine</a>;
00566                 <span class="keywordflow">if</span> (Address &gt;= <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a18">Start</a> &amp;&amp; Address &lt; <a class="code" href="../../d9/d1/config_2i386_2init386_8c.html#a19">End</a>) {
00567                     <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(TIMER_OR_DPC_INVALID,
00568                                  0x2,
00569                                  (ULONG_PTR)Address,
00570                                  (ULONG_PTR)Start,
00571                                  (ULONG_PTR)End);
00572                 }
00573             }
00574         }
00575 
00576         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1;
00577     } <span class="keywordflow">while</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; <a class="code" href="../../d4/d9/ke_8h.html#a10">TIMER_TABLE_SIZE</a>);
00578 
00579 
00580     <span class="comment">//</span>
00581     <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous value</span>
00582     <span class="comment">//</span>
00583 
00584     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00585     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00586 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a348" doxytag="ke.h::KeClearTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeClearTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Timer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00124">124</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00037">ASSERT_TIMER</a>.
<p>
<pre class="fragment"><div>00130                    :
00131 
00132     This function clears <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an timer object.
00133 
00134 Arguments:
00135 
00136     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00137 
00138 Return Value:
00139 
00140     None.
00141 
00142 --*/
00143 
00144 {
00145 
00146     <a class="code" href="../../d3/d2/timerobj_8c.html#a0">ASSERT_TIMER</a>(Timer);
00147 
00148     <span class="comment">//</span>
00149     <span class="comment">// Clear signal state of timer object.</span>
00150     <span class="comment">//</span>
00151 
00152     Timer-&gt;Header.SignalState = 0;
00153     <span class="keywordflow">return</span>;
00154 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a315" doxytag="ke.h::KeConfineThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KAFFINITY KeConfineThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00515">515</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00622">_KTHREAD::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00626">_KTHREAD::NextProcessor</a>.
<p>
<pre class="fragment"><div>00521                    :
00522 
00523     This function confines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
00524     processor.
00525 
00526 Arguments:
00527 
00528     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00529 
00530 Return Value:
00531 
00532     The previous affinity value.
00533 
00534 --*/
00535 
00536 {
00537 
00538     KAFFINITY Affinity;
00539     KIRQL OldIrql;
00540     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00541 
00542     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00543 
00544     <span class="comment">//</span>
00545     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00546     <span class="comment">//</span>
00547 
00548     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00549     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00550 
00551     <span class="comment">//</span>
00552     <span class="comment">// Capture the current affinity and compute new affinity value by</span>
00553     <span class="comment">// shifting a one bit left by the current processor number.</span>
00554     <span class="comment">//</span>
00555 
00556     Affinity = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a>;
00557     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a> = (KAFFINITY)(1 &lt;&lt; Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o45">NextProcessor</a>);
00558 
00559     <span class="comment">//</span>
00560     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00561     <span class="comment">// value.</span>
00562     <span class="comment">//</span>
00563 
00564     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00565 
00566     <span class="comment">//</span>
00567     <span class="comment">// Return the previous affinity value.</span>
00568     <span class="comment">//</span>
00569 
00570     <span class="keywordflow">return</span> Affinity;
00571 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a271" doxytag="ke.h::KeConnectInterrupt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeConnectInterrupt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Interrupt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00154">154</a> of file <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html">alpha/intobj.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00463">_KINTERRUPT::DispatchAddress</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00474">_KINTERRUPT::DispatchCode</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a179">HalEnableSystemInterrupt()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00457">_KINTERRUPT::InterruptListEntry</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">KeRevertToUserAffinityThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a113">KiFloatingDispatch()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a126">KiInterruptDispatchRaise()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a127">KiInterruptDispatchSame()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00471">_KINTERRUPT::Mode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00470">_KINTERRUPT::ShareVector</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00092">SYNCH_LEVEL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03665">IoConnectInterrupt()</a>.
<p>
<pre class="fragment"><div>00160                    :
00161 
00162     This function connects an interrupt object to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt vector
00163     specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already
00164     connected, or an attempt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to connect to an interrupt that cannot
00165     be connected, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Else <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00166     interrupt object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> connected to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt vector, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> connected
00167     state <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, and <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00168 
00169 Arguments:
00170 
00171     Interrupt - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> interrupt.
00172 
00173 Return Value:
00174 
00175     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already connected or an attempt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to
00176     connect to an interrupt vector that cannot be connected, then a value
00177     of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Else a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00178 
00179 --*/
00180 
00181 {
00182 
00183     BOOLEAN Connected;
00184     <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interruptx;
00185     KIRQL Irql;
00186     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> Number;
00187     KIRQL OldIrql;
00188     ULONG Vector;
00189 
00190     <span class="comment">//</span>
00191     <span class="comment">// If the interrupt object is already connected, the interrupt vector</span>
00192     <span class="comment">// number is invalid, an attempt is being made to connect to a vector</span>
00193     <span class="comment">// that cannot be connected, the interrupt request level is invalid,</span>
00194     <span class="comment">// the processor number is invalid, of the interrupt vector is less</span>
00195     <span class="comment">// than or equal to the highest level and it not equal to the specified</span>
00196     <span class="comment">// IRQL, then do not connect the interrupt object. Else connect interrupt</span>
00197     <span class="comment">// object to the specified vector and establish the proper interrupt</span>
00198     <span class="comment">// dispatcher.</span>
00199     <span class="comment">//</span>
00200 
00201     Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00202     Irql = Interrupt-&gt;Irql;
00203     Number = Interrupt-&gt;Number;
00204     Vector = Interrupt-&gt;Vector;
00205     <span class="keywordflow">if</span> (((Vector &gt;= MAXIMUM_VECTOR) || (Irql &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a57">HIGH_LEVEL</a>) ||
00206        ((Vector &lt;= <a class="code" href="../../d6/d7/halmips_8h.html#a57">HIGH_LEVEL</a>) &amp;&amp;
00207        (((1 &lt;&lt; Vector &amp; PCR-&gt;ReservedVectors) != 0))) ||
00208        (Number &gt;= <a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>)) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00209 
00210         <span class="comment">//</span>
00211         <span class="comment">// Set system affinity to the specified processor.</span>
00212         <span class="comment">//</span>
00213 
00214         <a class="code" href="../../d9/d1/thredobj_8c.html#a19">KeSetSystemAffinityThread</a>((KAFFINITY)(1 &lt;&lt; Number));
00215 
00216         <span class="comment">//</span>
00217         <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00218         <span class="comment">//</span>
00219 
00220         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00221 
00222         <span class="comment">//</span>
00223         <span class="comment">// If the specified interrupt vector is not connected, then</span>
00224         <span class="comment">// connect the interrupt vector to the interrupt object dispatch</span>
00225         <span class="comment">// code, establish the dispatcher address, and set the new</span>
00226         <span class="comment">// interrupt mode and enable masks. Else if the interrupt is</span>
00227         <span class="comment">// already chained, then add the new interrupt object at the end</span>
00228         <span class="comment">// of the chain. If the interrupt vector is not chained, then</span>
00229         <span class="comment">// start a chain with the previous interrupt object at the front</span>
00230         <span class="comment">// of the chain. The interrupt mode of all interrupt objects in</span>
00231         <span class="comment">// a chain must be the same.</span>
00232         <span class="comment">//</span>
00233 
00234         <span class="keywordflow">if</span> (Interrupt-&gt;Connected == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00235             <span class="keywordflow">if</span> ( PCR-&gt;InterruptRoutine[Vector] ==
00236                  (PKINTERRUPT_ROUTINE)(&amp;KxUnexpectedInterrupt.DispatchCode) ) {
00237                 Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00238                 Interrupt-&gt;Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00239                 <span class="keywordflow">if</span> (Interrupt-&gt;FloatingSave) {
00240                     Interrupt-&gt;DispatchAddress = <a class="code" href="../../d0/d0/ki_8h.html#a113">KiFloatingDispatch</a>;
00241 
00242                 } <span class="keywordflow">else</span> {
00243                     <span class="keywordflow">if</span> (Interrupt-&gt;Irql == Interrupt-&gt;SynchronizeIrql) {
00244                         Interrupt-&gt;DispatchAddress =
00245                                     (PKINTERRUPT_ROUTINE)<a class="code" href="../../d0/d0/ki_8h.html#a127">KiInterruptDispatchSame</a>;
00246                     } <span class="keywordflow">else</span> {
00247                         Interrupt-&gt;DispatchAddress =
00248                                     (PKINTERRUPT_ROUTINE)<a class="code" href="../../d0/d0/ki_8h.html#a126">KiInterruptDispatchRaise</a>;
00249                     }
00250                 }
00251 
00252                 PCR-&gt;InterruptRoutine[Vector] =
00253                             (PKINTERRUPT_ROUTINE)(&amp;Interrupt-&gt;DispatchCode);
00254 
00255                 <a class="code" href="../../d2/d7/hal_8h.html#a179">HalEnableSystemInterrupt</a>(Vector, Irql, Interrupt-&gt;Mode);
00256 
00257             } <span class="keywordflow">else</span> {
00258                 Interruptx = CONTAINING_RECORD(PCR-&gt;InterruptRoutine[Vector],
00259                                                <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>,
00260                                                DispatchCode[0]);
00261 
00262                 <span class="keywordflow">if</span> (Interrupt-&gt;Mode == Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o16">Mode</a>) {
00263                     Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00264                     Interrupt-&gt;Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00265                     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (Irql &lt;= KiSynchIrql);
00266                     <span class="keywordflow">if</span> (Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> != <a class="code" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch</a>) {
00267                         InitializeListHead(&amp;Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o2">InterruptListEntry</a>);
00268                         Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> = <a class="code" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch</a>;
00269                     }
00270 
00271                     InsertTailList(&amp;Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o2">InterruptListEntry</a>,
00272                                    &amp;Interrupt-&gt;InterruptListEntry);
00273                 }
00274             }
00275         }
00276 
00277         <span class="comment">//</span>
00278         <span class="comment">// Unlock dispatcher database and lower IRQL to its previous value.</span>
00279         <span class="comment">//</span>
00280 
00281         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00282 
00283         <span class="comment">//</span>
00284         <span class="comment">// Set system affinity back to the original value.</span>
00285         <span class="comment">//</span>
00286 
00287         <a class="code" href="../../d9/d1/thredobj_8c.html#a16">KeRevertToUserAffinityThread</a>();
00288     }
00289 
00290     <span class="comment">//</span>
00291     <span class="comment">// Return whether interrupt was connected to the specified vector.</span>
00292     <span class="comment">//</span>
00293 
00294     <span class="keywordflow">return</span> Connected;
00295 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a369" doxytag="ke.h::KeContextFromKframes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeContextFromKframes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextFrame</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00104">104</a> of file <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html">alpha/exceptn.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00240">CONTEXT_CONTROL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00241">CONTEXT_FLOATING_POINT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00242">CONTEXT_INTEGER</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, and <a class="el" href="../../d3/d8/ppc_2exceptn_8c-source.html#l00078">KiBreakPoints</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00457">Ke386SetIOPL()</a>, <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>, <a class="el" href="../../d8/d6/alpha_2apcuser_8c-source.html#l00033">KiInitializeUserApc()</a>, <a class="el" href="../../d9/d5/alpha_2ipi_8c-source.html#l00081">KiSaveProcessorState()</a>, and <a class="el" href="../../d4/d9/psctx386_8c-source.html#l00046">PspGetContext()</a>.
<p>
<pre class="fragment"><div>00112                    :
00113 
00114     This routine moves <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selected contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified trap and exception
00115     frames into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified context frame according to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified context
00116     flags.
00117 
00118 Arguments:
00119 
00120     TrapFrame - Supplies a pointer to a trap frame from which <span class="keyword">volatile</span> context
00121         should be copied into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context record.
00122 
00123     ExceptionFrame - Supplies a pointer to an exception frame from which context
00124         should be copied into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context record.
00125 
00126     ContextFrame - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context frame that receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00127         context copied from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap and exception frames.
00128 
00129 Return Value:
00130 
00131     None.
00132 
00133 --*/
00134 
00135 {
00136 
00137     <span class="comment">//</span>
00138     <span class="comment">// Set control information if specified.</span>
00139     <span class="comment">//</span>
00140 
00141     <span class="keywordflow">if</span> ((ContextFrame-&gt;ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a153">CONTEXT_CONTROL</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a153">CONTEXT_CONTROL</a>) {
00142 
00143         <span class="comment">//</span>
00144         <span class="comment">// Set integer register gp, ra, sp, FIR, and PSR from trap frame.</span>
00145         <span class="comment">//</span>
00146 
00147         ContextFrame-&gt;IntGp = TrapFrame-&gt;IntGp;
00148         ContextFrame-&gt;IntSp = TrapFrame-&gt;IntSp;
00149         ContextFrame-&gt;IntRa = TrapFrame-&gt;IntRa;
00150         ContextFrame-&gt;Fir = TrapFrame-&gt;Fir;
00151         ContextFrame-&gt;Psr = TrapFrame-&gt;Psr;
00152     }
00153 
00154     <span class="comment">//</span>
00155     <span class="comment">// Set integer register contents if specified.</span>
00156     <span class="comment">//</span>
00157 
00158     <span class="keywordflow">if</span> ((ContextFrame-&gt;ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a155">CONTEXT_INTEGER</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a155">CONTEXT_INTEGER</a>) {
00159 
00160         <span class="comment">//</span>
00161         <span class="comment">// Set volatile integer registers v0 and t0 - t7 from trap frame.</span>
00162         <span class="comment">//</span>
00163 
00164         ContextFrame-&gt;IntV0 = TrapFrame-&gt;IntV0;
00165         ContextFrame-&gt;IntT0 = TrapFrame-&gt;IntT0;
00166         ContextFrame-&gt;IntT1 = TrapFrame-&gt;IntT1;
00167         ContextFrame-&gt;IntT2 = TrapFrame-&gt;IntT2;
00168         ContextFrame-&gt;IntT3 = TrapFrame-&gt;IntT3;
00169         ContextFrame-&gt;IntT4 = TrapFrame-&gt;IntT4;
00170         ContextFrame-&gt;IntT5 = TrapFrame-&gt;IntT5;
00171         ContextFrame-&gt;IntT6 = TrapFrame-&gt;IntT6;
00172         ContextFrame-&gt;IntT7 = TrapFrame-&gt;IntT7;
00173 
00174         <span class="comment">//</span>
00175         <span class="comment">// Set nonvolatile integer registers s0 - s5 from exception frame.</span>
00176         <span class="comment">//</span>
00177 
00178         ContextFrame-&gt;IntS0 = ExceptionFrame-&gt;IntS0;
00179         ContextFrame-&gt;IntS1 = ExceptionFrame-&gt;IntS1;
00180         ContextFrame-&gt;IntS2 = ExceptionFrame-&gt;IntS2;
00181         ContextFrame-&gt;IntS3 = ExceptionFrame-&gt;IntS3;
00182         ContextFrame-&gt;IntS4 = ExceptionFrame-&gt;IntS4;
00183         ContextFrame-&gt;IntS5 = ExceptionFrame-&gt;IntS5;
00184 
00185         <span class="comment">//</span>
00186         <span class="comment">// Set volatile integer registers a0 - a5, and t8 - t11 from trap</span>
00187         <span class="comment">// frame.</span>
00188         <span class="comment">//</span>
00189 
00190         ContextFrame-&gt;IntA0 = TrapFrame-&gt;IntA0;
00191         ContextFrame-&gt;IntA1 = TrapFrame-&gt;IntA1;
00192         ContextFrame-&gt;IntA2 = TrapFrame-&gt;IntA2;
00193         ContextFrame-&gt;IntA3 = TrapFrame-&gt;IntA3;
00194         ContextFrame-&gt;IntA4 = TrapFrame-&gt;IntA4;
00195         ContextFrame-&gt;IntA5 = TrapFrame-&gt;IntA5;
00196 
00197         ContextFrame-&gt;IntT8 = TrapFrame-&gt;IntT8;
00198         ContextFrame-&gt;IntT9 = TrapFrame-&gt;IntT9;
00199         ContextFrame-&gt;IntT10 = TrapFrame-&gt;IntT10;
00200         ContextFrame-&gt;IntT11 = TrapFrame-&gt;IntT11;
00201 
00202         <span class="comment">//</span>
00203         <span class="comment">// Set volatile integer registers fp, t12 and at from trap frame.</span>
00204         <span class="comment">// Set integer register zero.</span>
00205         <span class="comment">//</span>
00206 
00207         ContextFrame-&gt;IntFp = TrapFrame-&gt;IntFp;
00208         ContextFrame-&gt;IntT12 = TrapFrame-&gt;IntT12;
00209         ContextFrame-&gt;IntAt = TrapFrame-&gt;IntAt;
00210         ContextFrame-&gt;IntZero = 0;
00211     }
00212 
00213     <span class="comment">//</span>
00214     <span class="comment">// Set floating register contents if specified.</span>
00215     <span class="comment">//</span>
00216 
00217     <span class="keywordflow">if</span> ((ContextFrame-&gt;ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a154">CONTEXT_FLOATING_POINT</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a154">CONTEXT_FLOATING_POINT</a>) {
00218 
00219         <span class="comment">//</span>
00220         <span class="comment">// Set volatile floating registers f0 - f1 from trap frame.</span>
00221         <span class="comment">// Set volatile floating registers f10 - f30 from trap frame.</span>
00222         <span class="comment">// Set floating zero register f31 to 0.</span>
00223         <span class="comment">//</span>
00224 
00225         ContextFrame-&gt;FltF0 = TrapFrame-&gt;FltF0;
00226         ContextFrame-&gt;FltF1 = TrapFrame-&gt;FltF1;
00227         RtlMoveMemory(&amp;ContextFrame-&gt;FltF10, &amp;TrapFrame-&gt;FltF10,
00228                       <span class="keyword">sizeof</span>(ULONGLONG) * 21);
00229         ContextFrame-&gt;FltF31 = 0;
00230 
00231         <span class="comment">//</span>
00232         <span class="comment">// Set nonvolatile floating registers f2 - f9 from exception frame.</span>
00233         <span class="comment">//</span>
00234 
00235         ContextFrame-&gt;FltF2 = ExceptionFrame-&gt;FltF2;
00236         ContextFrame-&gt;FltF3 = ExceptionFrame-&gt;FltF3;
00237         ContextFrame-&gt;FltF4 = ExceptionFrame-&gt;FltF4;
00238         ContextFrame-&gt;FltF5 = ExceptionFrame-&gt;FltF5;
00239         ContextFrame-&gt;FltF6 = ExceptionFrame-&gt;FltF6;
00240         ContextFrame-&gt;FltF7 = ExceptionFrame-&gt;FltF7;
00241         ContextFrame-&gt;FltF8 = ExceptionFrame-&gt;FltF8;
00242         ContextFrame-&gt;FltF9 = ExceptionFrame-&gt;FltF9;
00243 
00244         <span class="comment">//</span>
00245         <span class="comment">// Set floating point control register from trap frame.</span>
00246         <span class="comment">// Clear software floating point control register in context frame</span>
00247         <span class="comment">// (if necessary, it can be set to the proper value by the caller).</span>
00248         <span class="comment">//</span>
00249 
00250         ContextFrame-&gt;Fpcr = TrapFrame-&gt;Fpcr;
00251         ContextFrame-&gt;SoftFpcr = 0;
00252     }
00253 
00254     <span class="keywordflow">return</span>;
00255 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a370" doxytag="ke.h::KeContextToKframes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeContextToKframes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PreviousMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00258">258</a> of file <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html">alpha/exceptn.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00240">CONTEXT_CONTROL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00241">CONTEXT_FLOATING_POINT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00242">CONTEXT_INTEGER</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00068">KeGetPcr</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00457">Ke386SetIOPL()</a>, <a class="el" href="../../d6/d3/raisexcp_8c-source.html#l00099">KiContinue()</a>, <a class="el" href="../../d6/d3/raisexcp_8c-source.html#l00037">KiContinuePreviousModeUser()</a>, <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00057">KiInitializeContextThread()</a>, <a class="el" href="../../d6/d3/raisexcp_8c-source.html#l00208">KiRaiseException()</a>, <a class="el" href="../../d9/d5/alpha_2ipi_8c-source.html#l00031">KiRestoreProcessorState()</a>, and <a class="el" href="../../d4/d9/psctx386_8c-source.html#l00088">PspSetContext()</a>.
<p>
<pre class="fragment"><div>00268                    :
00269 
00270     This routine moves <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selected contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified context frame into
00271     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified trap and exception frames according to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified context
00272     flags.
00273 
00274 Arguments:
00275 
00276     TrapFrame - Supplies a pointer to a trap frame that receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">volatile</span>
00277         context from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context record.
00278 
00279     ExceptionFrame - Supplies a pointer to an exception frame that receives
00280         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> nonvolatile context from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context record.
00281 
00282     ContextFrame - Supplies a pointer to a context frame that contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00283         context that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be copied into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap and exception frames.
00284 
00285     ContextFlags - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> set of flags that specify which parts of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00286         context frame are to be copied into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap and exception frames.
00287 
00288     PreviousMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode <span class="keywordflow">for</span> which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap and exception
00289         frames are being built.
00290 
00291 Return Value:
00292 
00293     None.
00294 
00295 --*/
00296 
00297 {
00298 
00299     <span class="comment">//</span>
00300     <span class="comment">// Set control information if specified.</span>
00301     <span class="comment">//</span>
00302 
00303     <span class="keywordflow">if</span> ((ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a153">CONTEXT_CONTROL</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a153">CONTEXT_CONTROL</a>) {
00304 
00305         <span class="comment">//</span>
00306         <span class="comment">// Set integer register gp, sp, ra, FIR, and PSR in trap frame.</span>
00307         <span class="comment">//</span>
00308 
00309         TrapFrame-&gt;IntGp = ContextFrame-&gt;IntGp;
00310         TrapFrame-&gt;IntSp = ContextFrame-&gt;IntSp;
00311         TrapFrame-&gt;IntRa = ContextFrame-&gt;IntRa;
00312         TrapFrame-&gt;Fir = ContextFrame-&gt;Fir;
00313         TrapFrame-&gt;Psr = SANITIZE_PSR(ContextFrame-&gt;Psr, PreviousMode);
00314     }
00315 
00316     <span class="comment">//</span>
00317     <span class="comment">// Set integer register contents if specified.</span>
00318     <span class="comment">//</span>
00319 
00320     <span class="keywordflow">if</span> ((ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a155">CONTEXT_INTEGER</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a155">CONTEXT_INTEGER</a>) {
00321 
00322         <span class="comment">//</span>
00323         <span class="comment">// Set volatile integer registers v0 and t0 - t7 in trap frame.</span>
00324         <span class="comment">//</span>
00325 
00326         TrapFrame-&gt;IntV0 = ContextFrame-&gt;IntV0;
00327         TrapFrame-&gt;IntT0 = ContextFrame-&gt;IntT0;
00328         TrapFrame-&gt;IntT1 = ContextFrame-&gt;IntT1;
00329         TrapFrame-&gt;IntT2 = ContextFrame-&gt;IntT2;
00330         TrapFrame-&gt;IntT3 = ContextFrame-&gt;IntT3;
00331         TrapFrame-&gt;IntT4 = ContextFrame-&gt;IntT4;
00332         TrapFrame-&gt;IntT5 = ContextFrame-&gt;IntT5;
00333         TrapFrame-&gt;IntT6 = ContextFrame-&gt;IntT6;
00334         TrapFrame-&gt;IntT7 = ContextFrame-&gt;IntT7;
00335 
00336         <span class="comment">//</span>
00337         <span class="comment">// Set nonvolatile integer registers s0 - s5 in exception frame.</span>
00338         <span class="comment">//</span>
00339 
00340         ExceptionFrame-&gt;IntS0 = ContextFrame-&gt;IntS0;
00341         ExceptionFrame-&gt;IntS1 = ContextFrame-&gt;IntS1;
00342         ExceptionFrame-&gt;IntS2 = ContextFrame-&gt;IntS2;
00343         ExceptionFrame-&gt;IntS3 = ContextFrame-&gt;IntS3;
00344         ExceptionFrame-&gt;IntS4 = ContextFrame-&gt;IntS4;
00345         ExceptionFrame-&gt;IntS5 = ContextFrame-&gt;IntS5;
00346 
00347         <span class="comment">//</span>
00348         <span class="comment">// Set volatile integer registers a0 - a5, and t8 - t11 in trap frame.</span>
00349         <span class="comment">//</span>
00350 
00351         TrapFrame-&gt;IntA0 = ContextFrame-&gt;IntA0;
00352         TrapFrame-&gt;IntA1 = ContextFrame-&gt;IntA1;
00353         TrapFrame-&gt;IntA2 = ContextFrame-&gt;IntA2;
00354         TrapFrame-&gt;IntA3 = ContextFrame-&gt;IntA3;
00355         TrapFrame-&gt;IntA4 = ContextFrame-&gt;IntA4;
00356         TrapFrame-&gt;IntA5 = ContextFrame-&gt;IntA5;
00357 
00358         TrapFrame-&gt;IntT8 = ContextFrame-&gt;IntT8;
00359         TrapFrame-&gt;IntT9 = ContextFrame-&gt;IntT9;
00360         TrapFrame-&gt;IntT10 = ContextFrame-&gt;IntT10;
00361         TrapFrame-&gt;IntT11 = ContextFrame-&gt;IntT11;
00362 
00363         <span class="comment">//</span>
00364         <span class="comment">// Set volatile integer registers fp, t12 and at in trap frame.</span>
00365         <span class="comment">//</span>
00366 
00367         TrapFrame-&gt;IntFp = ContextFrame-&gt;IntFp;
00368         TrapFrame-&gt;IntT12 = ContextFrame-&gt;IntT12;
00369         TrapFrame-&gt;IntAt = ContextFrame-&gt;IntAt;
00370     }
00371 
00372     <span class="comment">//</span>
00373     <span class="comment">// Set floating register contents if specified.</span>
00374     <span class="comment">//</span>
00375 
00376     <span class="keywordflow">if</span> ((ContextFlags &amp; <a class="code" href="../../d6/d7/halmips_8h.html#a154">CONTEXT_FLOATING_POINT</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a154">CONTEXT_FLOATING_POINT</a>) {
00377 
00378         <span class="comment">//</span>
00379         <span class="comment">// Set volatile floating registers f0 - f1 in trap frame.</span>
00380         <span class="comment">// Set volatile floating registers f10 - f30 in trap frame.</span>
00381         <span class="comment">//</span>
00382 
00383         TrapFrame-&gt;FltF0 = ContextFrame-&gt;FltF0;
00384         TrapFrame-&gt;FltF1 = ContextFrame-&gt;FltF1;
00385         RtlMoveMemory(&amp;TrapFrame-&gt;FltF10, &amp;ContextFrame-&gt;FltF10,
00386                       <span class="keyword">sizeof</span>(ULONGLONG) * 21);
00387 
00388         <span class="comment">//</span>
00389         <span class="comment">// Set nonvolatile floating registers f2 - f9 in exception frame.</span>
00390         <span class="comment">//</span>
00391 
00392         ExceptionFrame-&gt;FltF2 = ContextFrame-&gt;FltF2;
00393         ExceptionFrame-&gt;FltF3 = ContextFrame-&gt;FltF3;
00394         ExceptionFrame-&gt;FltF4 = ContextFrame-&gt;FltF4;
00395         ExceptionFrame-&gt;FltF5 = ContextFrame-&gt;FltF5;
00396         ExceptionFrame-&gt;FltF6 = ContextFrame-&gt;FltF6;
00397         ExceptionFrame-&gt;FltF7 = ContextFrame-&gt;FltF7;
00398         ExceptionFrame-&gt;FltF8 = ContextFrame-&gt;FltF8;
00399         ExceptionFrame-&gt;FltF9 = ContextFrame-&gt;FltF9;
00400 
00401         <span class="comment">//</span>
00402         <span class="comment">// Set floating point control register in trap frame.</span>
00403         <span class="comment">//</span>
00404 
00405         TrapFrame-&gt;Fpcr = ContextFrame-&gt;Fpcr;
00406     }
00407 
00408     <span class="keywordflow">return</span>;
00409 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a372" doxytag="ke.h::KeCopyTrapDispatcher" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeCopyTrapDispatcher           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a316" doxytag="ke.h::KeDelayExecutionThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS KeDelayExecutionThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Alertable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Interval</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/wait_8c-source.html#l00140">140</a> of file <a class="el" href="../../d2/d6/wait_8c-source.html">wait.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00657">_KTHREAD::Alertable</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00590">_KTHREAD::BasePriority</a>, <a class="el" href="../../d4/d9/ke_8h.html#a407a202">DelayExecution</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00523">_KTIMER::DueTime</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00649">KiActivateWaiterQueue()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01175">KiComputeWaitInterval()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00095">KiFindReadyThread()</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00042">KiInsertTreeTimer()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00225">KiInsertWaitList</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00270">KiReadyThread()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">KiSetPriorityThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a138">KiSwapThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00626">_KTHREAD::NextProcessor</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00283">_KWAIT_BLOCK::NextWaitBlock</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00623">_KTHREAD::Preempted</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00574">_KTHREAD::Priority</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00592">_KTHREAD::PriorityDecrement</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00593">_KTHREAD::Quantum</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00612">_KTHREAD::Queue</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00057">TestForAlertPending</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00614">_KTHREAD::Timer</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00084">TIMER_WAIT_BLOCK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00594">_KTHREAD::WaitBlock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00587">_KTHREAD::WaitBlockList</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00280">_KWAIT_BLOCK::WaitListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00584">_KTHREAD::WaitMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00586">_KTHREAD::WaitReason</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00582">_KTHREAD::WaitStatus</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00589">_KTHREAD::WaitTime</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l02331">CcPurgeCacheSection()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l02242">IoCancelThreadIo()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00417">IopCancelAlertedRequest()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00770">IopStartNetworkForRemoteBoot()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00492">MemPrintFlush()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00598">MemPrintWriteThread()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04107">MiAllocateContiguousMemory()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02149">MiCheckControlAreaStatus()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l01218">MiCheckSystemTrimEndCriteria()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00068">MiDispatchFault()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l04726">MiEmptyWorkingSet()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04870">MiFlushAllPages()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05287">MiMakeOutswappedPageResident()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02669">MiModifiedPageWriter()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02831">MiModifiedPageWriterWorker()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00541">MiPurgeImageSection()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02748">MiRemoveUnusedSegments()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l01446">MiResolveProtoPteFault()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02234">MiWriteComplete()</a>, <a class="el" href="../../d5/d0/mmfault_8c-source.html#l00041">MmAccessFault()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01274">MmCopyToCachedPage()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00668">MmFlushSection()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00297">MmFlushVirtualMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07930">MmGatherMemoryForHibernate()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00437">MmRemovePhysicalMemory()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00049">NtCancelIoFile()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00134">NtCreateSection()</a>, <a class="el" href="../../d8/d5/delay_8c-source.html#l00033">NtDelayExecution()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01567">Reader()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01646">ReaderTurnedWriter()</a>, <a class="el" href="../../d1/d0/base_8c-source.html#l00102">UserBeep()</a>, <a class="el" href="../../d1/d0/base_8c-source.html#l00083">UserSleep()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01606">Writer()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.
<p>
<pre class="fragment"><div>00148                    :
00149 
00150     This function delays <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00151     interval of time.
00152 
00153 Arguments:
00154 
00155     WaitMode  - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode in which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> delay <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00156 
00157     Alertable - Supplies a <span class="keywordtype">boolean</span> value that specifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> delay
00158         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> alertable.
00159 
00160     Interval - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> absolute or relative time over which
00161         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> delay <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00162 
00163 Return Value:
00164 
00165     The wait completion status. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_SUCCESS <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span>
00166     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> delay occurred. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_ALERTED <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait
00167     was aborted to deliver an alert to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of
00168     STATUS_USER_APC <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait was aborted to deliver a user
00169     APC to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread.
00170 
00171 --*/
00172 
00173 {
00174 
00175     LARGE_INTEGER DueTime;
00176     LARGE_INTEGER NewTime;
00177     PLARGE_INTEGER OriginalTime;
00178     PKPRCB Prcb;
00179     KPRIORITY Priority;
00180     <a class="code" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue;
00181     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00182     <a class="code" href="../../d3/d8/struct__KTIMER.html">PRKTIMER</a> Timer;
00183     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> WaitBlock;
00184     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> WaitStatus;
00185 
00186     <span class="comment">//</span>
00187     <span class="comment">// If the dispatcher database lock is not already held, then set the wait</span>
00188     <span class="comment">// IRQL and lock the dispatcher database. Else set boolean wait variable</span>
00189     <span class="comment">// to FALSE.</span>
00190     <span class="comment">//</span>
00191 
00192     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00193     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a>) {
00194         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00195 
00196     } <span class="keywordflow">else</span> {
00197         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00198     }
00199 
00200     <span class="comment">//</span>
00201     <span class="comment">// Start of delay loop.</span>
00202     <span class="comment">//</span>
00203     <span class="comment">// Note this loop is repeated if a kernel APC is delivered in the middle</span>
00204     <span class="comment">// of the delay or a kernel APC is pending on the first attempt through</span>
00205     <span class="comment">// the loop.</span>
00206     <span class="comment">//</span>
00207 
00208     OriginalTime = Interval;
00209     WaitBlock = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[<a class="code" href="../../d4/d9/ke_8h.html#a9">TIMER_WAIT_BLOCK</a>];
00210     <span class="keywordflow">do</span> {
00211 
00212         <span class="comment">//</span>
00213         <span class="comment">// Test to determine if a kernel APC is pending.</span>
00214         <span class="comment">//</span>
00215         <span class="comment">// If a kernel APC is pending and the previous IRQL was less than</span>
00216         <span class="comment">// APC_LEVEL, then a kernel APC was queued by another processor just</span>
00217         <span class="comment">// after IRQL was raised to DISPATCH_LEVEL, but before the dispatcher</span>
00218         <span class="comment">// database was locked.</span>
00219         <span class="comment">//</span>
00220         <span class="comment">// N.B. that this can only happen in a multiprocessor system.</span>
00221         <span class="comment">//</span>
00222 
00223         <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>)) {
00224 
00225             <span class="comment">//</span>
00226             <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00227             <span class="comment">// value. An APC interrupt will immediately occur which will result</span>
00228             <span class="comment">// in the delivery of the kernel APC if possible.</span>
00229             <span class="comment">//</span>
00230 
00231             <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00232 
00233         } <span class="keywordflow">else</span> {
00234 
00235             <span class="comment">//</span>
00236             <span class="comment">// Test for alert pending.</span>
00237             <span class="comment">//</span>
00238 
00239             <a class="code" href="../../d1/d7/wait_8c.html#a0">TestForAlertPending</a>(Alertable);
00240 
00241             <span class="comment">//</span>
00242             <span class="comment">// Initialize wait block, insert wait block in timer wait list,</span>
00243             <span class="comment">// insert timer in timer queue, put thread in wait state, select</span>
00244             <span class="comment">// next thread to execute, and context switch to next thread.</span>
00245             <span class="comment">//</span>
00246             <span class="comment">// N.B. The timer wait block is initialized when the respective</span>
00247             <span class="comment">//      thread is initialized. Thus the constant fields are not</span>
00248             <span class="comment">//      reinitialized. These include the wait object, wait key,</span>
00249             <span class="comment">//      wait type, and the wait list entry link pointers.</span>
00250             <span class="comment">//</span>
00251 
00252             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o21">WaitBlockList</a> = WaitBlock;
00253             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o16">WaitStatus</a> = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)0;
00254             Timer = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o39">Timer</a>;
00255             WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = WaitBlock;
00256             Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>.Flink = &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>;
00257             Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>.Blink = &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>;
00258 
00259             <span class="comment">//</span>
00260             <span class="comment">// If the timer is inserted in the timer tree, then place the</span>
00261             <span class="comment">// current thread in a wait state. Otherwise, attempt to force</span>
00262             <span class="comment">// the current thread to yield the processor to another thread.</span>
00263             <span class="comment">//</span>
00264 
00265             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/timersup_8c.html#a1">KiInsertTreeTimer</a>(Timer, *Interval) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00266 
00267                 <span class="comment">//</span>
00268                 <span class="comment">// If the thread is not a realtime thread, then drop the</span>
00269                 <span class="comment">// thread priority to the base priority.</span>
00270                 <span class="comment">//</span>
00271 
00272                 Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00273                 Priority = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o13">Priority</a>;
00274                 <span class="keywordflow">if</span> (Priority &lt; LOW_REALTIME_PRIORITY) {
00275                     <span class="keywordflow">if</span> (Priority != Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a>) {
00276                         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> = 0;
00277                         <a class="code" href="../../d0/d2/thredsup_8c.html#a5">KiSetPriorityThread</a>(Thread, Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a>);
00278                     }
00279                 }
00280 
00281                 <span class="comment">//</span>
00282                 <span class="comment">// If a new thread has not been selected, the attempt to round</span>
00283                 <span class="comment">// robin the thread with other threads at the same priority.</span>
00284                 <span class="comment">//</span>
00285 
00286                 <span class="keywordflow">if</span> (Prcb-&gt;NextThread == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00287                     Prcb-&gt;NextThread = <a class="code" href="../../d0/d2/thredsup_8c.html#a2">KiFindReadyThread</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o45">NextProcessor</a>,
00288                                                          Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o13">Priority</a>);
00289                 }
00290 
00291                 <span class="comment">//</span>
00292                 <span class="comment">// If a new thread has been selected for execution, then</span>
00293                 <span class="comment">// switch immediately to the selected thread.</span>
00294                 <span class="comment">//</span>
00295 
00296                 <span class="keywordflow">if</span> (Prcb-&gt;NextThread != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00297 
00298                     <span class="comment">//</span>
00299                     <span class="comment">// Give the current thread a new qunatum and switch</span>
00300                     <span class="comment">// context to selected thread.</span>
00301                     <span class="comment">//</span>
00302                     <span class="comment">// N.B. Control is returned at the original IRQL.</span>
00303                     <span class="comment">//</span>
00304 
00305                     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o42">Preempted</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00306                     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a>;
00307 
00308                     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt;= DISPATCH_LEVEL);
00309 
00310                     <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
00311                     WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)<a class="code" href="../../d0/d0/ki_8h.html#a138">KiSwapThread</a>();
00312                     <span class="keywordflow">goto</span> WaitComplete;
00313 
00314                 } <span class="keywordflow">else</span> {
00315                     WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)STATUS_SUCCESS;
00316                     <span class="keywordflow">break</span>;
00317                 }
00318             }
00319 
00320             DueTime.QuadPart = Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o1">DueTime</a>.QuadPart;
00321 
00322             <span class="comment">//</span>
00323             <span class="comment">// If the current thread is processing a queue entry, then attempt</span>
00324             <span class="comment">// to activate another thread that is blocked on the queue object.</span>
00325             <span class="comment">//</span>
00326 
00327             Queue = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a>;
00328             <span class="keywordflow">if</span> (Queue != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00329                 <a class="code" href="../../d8/d3/queueobj_8c.html#a7">KiActivateWaiterQueue</a>(Queue);
00330             }
00331 
00332             <span class="comment">//</span>
00333             <span class="comment">// Set the thread wait parameters, set the thread dispatcher state</span>
00334             <span class="comment">// to Waiting, and insert the thread in the wait list.</span>
00335             <span class="comment">//</span>
00336 
00337             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o57">Alertable</a> = Alertable;
00338             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o18">WaitMode</a> = WaitMode;
00339             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o20">WaitReason</a> = <a class="code" href="../../d4/d9/ke_8h.html#a407a202">DelayExecution</a>;
00340             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o23">WaitTime</a>= KiQueryLowTickCount();
00341             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>;
00342             <a class="code" href="../../d0/d0/ki_8h.html#a15">KiInsertWaitList</a>(WaitMode, Thread);
00343 
00344             <span class="comment">//</span>
00345             <span class="comment">// Switch context to selected thread.</span>
00346             <span class="comment">//</span>
00347             <span class="comment">// N.B. Control is returned at the original IRQL.</span>
00348             <span class="comment">//</span>
00349 
00350             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt;= DISPATCH_LEVEL);
00351 
00352             WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)<a class="code" href="../../d0/d0/ki_8h.html#a138">KiSwapThread</a>();
00353 
00354             <span class="comment">//</span>
00355             <span class="comment">// If the thread was not awakened to deliver a kernel mode APC,</span>
00356             <span class="comment">// then return the wait status.</span>
00357             <span class="comment">//</span>
00358 
00359         WaitComplete:
00360             <span class="keywordflow">if</span> (WaitStatus != STATUS_KERNEL_APC) {
00361                 <span class="keywordflow">if</span> (WaitStatus == STATUS_TIMEOUT) {
00362                     WaitStatus = STATUS_SUCCESS;
00363                 }
00364 
00365                 <span class="keywordflow">return</span> WaitStatus;
00366             }
00367 
00368             <span class="comment">//</span>
00369             <span class="comment">// Reduce the time remaining before the time delay expires.</span>
00370             <span class="comment">//</span>
00371 
00372             Interval = <a class="code" href="../../d1/d7/wait_8c.html#a6">KiComputeWaitInterval</a>(OriginalTime,
00373                                              &amp;DueTime,
00374                                              &amp;NewTime);
00375         }
00376 
00377         <span class="comment">//</span>
00378         <span class="comment">// Raise IRQL to DISPATCH_LEVEL and lock the dispatcher database.</span>
00379         <span class="comment">//</span>
00380 
00381         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00382     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00383 
00384     <span class="comment">//</span>
00385     <span class="comment">// The thread is alerted or a user APC should be delivered. Unlock the</span>
00386     <span class="comment">// dispatcher database, lower IRQL to its previous value, and return the</span>
00387     <span class="comment">// wait status.</span>
00388     <span class="comment">//</span>
00389 
00390     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00391     <span class="keywordflow">return</span> WaitStatus;
00392 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a365" doxytag="ke.h::KeDeregisterBugCheckCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeDeregisterBugCheckCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">PKBUGCHECK_CALLBACK_RECORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CallbackRecord</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01064">1064</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>, <a class="el" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02771">KeBugCheckCallbackLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a115">PKBUGCHECK_CALLBACK_RECORD</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01070                    :
01071 
01072     This function deregisters a bug check callback record.
01073 
01074 Arguments:
01075 
01076     CallbackRecord - Supplies a pointer to a bug check callback record.
01077 
01078 Return Value:
01079 
01080     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified bug check callback record <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully deregistered,
01081     then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01082 
01083 --*/
01084 
01085 {
01086 
01087     BOOLEAN Deregister;
01088     KIRQL OldIrql;
01089 
01090     <span class="comment">//</span>
01091     <span class="comment">// Raise IRQL to HIGH_LEVEL and acquire the bug check callback list</span>
01092     <span class="comment">// spinlock.</span>
01093     <span class="comment">//</span>
01094 
01095     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
01096     KiAcquireSpinLock(&amp;KeBugCheckCallbackLock);
01097 
01098     <span class="comment">//</span>
01099     <span class="comment">// If the specified callback record is currently registered, then</span>
01100     <span class="comment">// deregister the callback record.</span>
01101     <span class="comment">//</span>
01102 
01103     Deregister = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01104     <span class="keywordflow">if</span> (CallbackRecord-&gt;State == <a class="code" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>) {
01105         CallbackRecord-&gt;State = <a class="code" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>;
01106         RemoveEntryList(&amp;CallbackRecord-&gt;Entry);
01107         Deregister = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01108     }
01109 
01110     <span class="comment">//</span>
01111     <span class="comment">// Release the bug check callback spinlock, lower IRQL to its previous</span>
01112     <span class="comment">// value, and return whether the callback record was successfully</span>
01113     <span class="comment">// deregistered.</span>
01114     <span class="comment">//</span>
01115 
01116     KiReleaseSpinLock(&amp;KeBugCheckCallbackLock);
01117     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
01118     <span class="keywordflow">return</span> Deregister;
01119 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a302" doxytag="ke.h::KeDetachProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeDetachProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00405">405</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00243">_KAPC_STATE::ApcListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00658">_KTHREAD::ApcStateIndex</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00638">_KTHREAD::ApcStatePointer</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00036">BALANCE_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00413">_KEVENT::Header</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00245">_KAPC_STATE::KernelApcInProgress</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l01092">KiMoveApcState()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00435">KiProcessOutSwapListHead</a>, <a class="el" href="../../d0/d4/intsupc_8c-source.html#l00159">KiRequestSoftwareInterrupt()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00421">KiSwapEvent</a>, <a class="el" href="../../d0/d0/ki_8h.html#a137">KiSwapProcess()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00656">_KTHREAD::SavedApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00767">_KPROCESS::StackCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00771">_KPROCESS::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00763">_KPROCESS::SwapListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00764">_KPROCESS::ThreadListHead</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>.
<p>
Referenced by <a class="el" href="../../d7/d6/winable2_8c-source.html#l00778">_GetComboBoxInfo()</a>, <a class="el" href="../../d7/d6/winable2_8c-source.html#l00946">_GetListBoxInfo()</a>, <a class="el" href="../../d2/d1/hooks_8c-source.html#l00986">CheckWHFBits()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04202">MiCreatePebOrTeb()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00529">MiDoMappedCopy()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02788">MiEmptyAllWorkingSetsWorker()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00890">MiGetWorkingSetInfo()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l01474">MiLoadImageSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l02386">MmAssignProcessToJob()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04314">MmCreateTeb()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04843">MmDeleteTeb()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00297">MmFlushVirtualMemory()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00753">MmMapViewOfSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00813">MmProbeAndLockProcessPages()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07311">MmSetBankedSection()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05567">MmSetMemoryPriorityProcess()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00090">MmUnmapViewOfSection()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d6/d4/flushbuf_8c-source.html#l00142">NtFlushInstructionCache()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01483">PsAssignImpersonationToken()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00907">SepRmCallLsa()</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00322">SetProcessFlags()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01879">SmbTraceDisconnect()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02375">xxxCheckImeShowStatus()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01654">xxxCreateDisconnectDesktop()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00243">xxxCreateWindowStation()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l04211">xxxGetThreadDesktop()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00749">xxxImmActivateAndUnloadThreadsLayout()</a>, <a class="el" href="../../d5/d8/minmax_8c-source.html#l01329">xxxMinMaximize()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02544">xxxNotifyImeShowStatus()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02461">xxxSendMessageToUI()</a>, and <a class="el" href="../../d2/d1/hooks_8c-source.html#l00576">zzzSetWindowsHookEx()</a>.
<p>
<pre class="fragment"><div>00411                    :
00412 
00413     This function detaches a thread from another process' address space.
00414 
00415 Arguments:
00416 
00417     None.
00418 
00419 Return Value:
00420 
00421     None.
00422 
00423 --*/
00424 
00425 {
00426 
00427     KIRQL OldIrql;
00428     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00429     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00430 
00431     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00432 
00433     <span class="comment">//</span>
00434     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00435     <span class="comment">//</span>
00436 
00437     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00438     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00439 
00440     <span class="comment">//</span>
00441     <span class="comment">// If the current thread is attached to another process, then detach</span>
00442     <span class="comment">// it.</span>
00443     <span class="comment">//</span>
00444 
00445     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> != 0) {
00446 
00447         <span class="comment">//</span>
00448         <span class="comment">// Check if a kernel APC is in progress, the kernel APC queue is</span>
00449         <span class="comment">// not empty, or the user APC queue is not empty. If any of these</span>
00450         <span class="comment">// conditions are true, then call bug check.</span>
00451         <span class="comment">//</span>
00452 
00453 <span class="preprocessor">#if DBG</span>
00454 <span class="preprocessor"></span>
00455         <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o2">KernelApcInProgress</a>) ||
00456             (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[KernelMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
00457             (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[UserMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00458             <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(INVALID_PROCESS_DETACH_ATTEMPT);
00459         }
00460 
00461 <span class="preprocessor">#endif</span>
00462 <span class="preprocessor"></span>
00463         <span class="comment">//</span>
00464         <span class="comment">// Unbias current process stack count and check if the process should</span>
00465         <span class="comment">// be swapped out of memory.</span>
00466         <span class="comment">//</span>
00467 
00468         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00469         Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> -= 1;
00470         <span class="keywordflow">if</span> ((Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> == 0) &amp;&amp;
00471             (IsListEmpty(&amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00472             Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o15">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>;
00473             InsertTailList(&amp;KiProcessOutSwapListHead, &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o7">SwapListEntry</a>);
00474             <a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> = 1;
00475             <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00476                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;KiSwapEvent, BALANCE_INCREMENT);
00477             }
00478         }
00479 
00480         <span class="comment">//</span>
00481         <span class="comment">// Restore APC state and check whether the kernel APC queue contains</span>
00482         <span class="comment">// an entry. If the kernel APC queue contains an entry then set kernel</span>
00483         <span class="comment">// APC pending and request a software interrupt at APC_LEVEL.</span>
00484         <span class="comment">//</span>
00485 
00486         <a class="code" href="../../d3/d5/procobj_8c.html#a2">KiMoveApcState</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>, &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>);
00487         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a> = (<a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00488         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o49">ApcStatePointer</a>[0] = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>;
00489         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o49">ApcStatePointer</a>[1] = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>;
00490         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> = 0;
00491         <span class="keywordflow">if</span> (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[KernelMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00492             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00493             <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(APC_LEVEL);
00494         }
00495 
00496         <span class="comment">//</span>
00497         <span class="comment">// Swap the address space back to the parent process.</span>
00498         <span class="comment">//</span>
00499 
00500         <a class="code" href="../../d0/d0/ki_8h.html#a137">KiSwapProcess</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>, Process);
00501     }
00502 
00503     <span class="comment">//</span>
00504     <span class="comment">// Lower IRQL to its previous value and return.</span>
00505     <span class="comment">//</span>
00506 
00507     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00508     <span class="keywordflow">return</span>;
00509 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a317" doxytag="ke.h::KeDisableApcQueuingThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeDisableApcQueuingThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00574">574</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.
<p>
<pre class="fragment"><div>00580                    :
00581 
00582     This function disables <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queuing of APC's to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00583 
00584 Arguments:
00585 
00586     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00587 
00588 Return Value:
00589 
00590     The previous value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC queuing state variable.
00591 
00592 --*/
00593 
00594 {
00595 
00596     BOOLEAN ApcQueueable;
00597     KIRQL OldIrql;
00598 
00599     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00600     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00601 
00602     <span class="comment">//</span>
00603     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00604     <span class="comment">//</span>
00605 
00606     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00607 
00608     <span class="comment">//</span>
00609     <span class="comment">// Capture the current state of the APC queueable state variable and</span>
00610     <span class="comment">// set its state to FALSE.</span>
00611     <span class="comment">//</span>
00612 
00613     ApcQueueable = Thread-&gt;ApcQueueable;
00614     Thread-&gt;ApcQueueable = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00615 
00616     <span class="comment">//</span>
00617     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00618     <span class="comment">// value.</span>
00619     <span class="comment">//</span>
00620 
00621     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00622 
00623     <span class="comment">//</span>
00624     <span class="comment">// Return the previous APC queueable state.</span>
00625     <span class="comment">//</span>
00626 
00627     <span class="keywordflow">return</span> ApcQueueable;
00628 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a272" doxytag="ke.h::KeDisconnectInterrupt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeDisconnectInterrupt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Interrupt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00298">298</a> of file <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html">alpha/intobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00463">_KINTERRUPT::DispatchAddress</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00474">_KINTERRUPT::DispatchCode</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a178">HalDisableSystemInterrupt()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00457">_KINTERRUPT::InterruptListEntry</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">KeRevertToUserAffinityThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d4/d4/ppc_2flush_8c-source.html#l00356">KeSweepIcache()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a113">KiFloatingDispatch()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a126">KiInterruptDispatchRaise()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a127">KiInterruptDispatchSame()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00092">SYNCH_LEVEL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06364">IoDisconnectInterrupt()</a>, and <a class="el" href="../../d5/d3/i386_2intobj_8c-source.html#l00224">KeConnectInterrupt()</a>.
<p>
<pre class="fragment"><div>00304                    :
00305 
00306     This function disconnects an interrupt object from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt vector
00307     specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not
00308     connected, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Else <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified interrupt
00309     object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disconnected from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt vector, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> connected state <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00310     set to <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, and <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00311 
00312 Arguments:
00313 
00314     Interrupt - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> interrupt.
00315 
00316 Return Value:
00317 
00318     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not connected, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00319     returned. Else a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00320 
00321 --*/
00322 
00323 {
00324 
00325     BOOLEAN Connected;
00326     <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interruptx;
00327     <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a> Interrupty;
00328     KIRQL Irql;
00329     KIRQL OldIrql;
00330     ULONG Vector;
00331 
00332     <span class="comment">//</span>
00333     <span class="comment">// Set system affinity to the specified processor.</span>
00334     <span class="comment">//</span>
00335 
00336     <a class="code" href="../../d9/d1/thredobj_8c.html#a19">KeSetSystemAffinityThread</a>((KAFFINITY)(1 &lt;&lt; Interrupt-&gt;Number));
00337 
00338     <span class="comment">//</span>
00339     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00340     <span class="comment">//</span>
00341 
00342     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00343 
00344     <span class="comment">//</span>
00345     <span class="comment">// If the interrupt object is connected, then disconnect it from the</span>
00346     <span class="comment">// specified vector.</span>
00347     <span class="comment">//</span>
00348 
00349     Connected = Interrupt-&gt;Connected;
00350     <span class="keywordflow">if</span> (Connected != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00351         Irql = Interrupt-&gt;Irql;
00352         Vector = Interrupt-&gt;Vector;
00353 
00354         <span class="comment">//</span>
00355         <span class="comment">// If the specified interrupt vector is not connected to the chained</span>
00356         <span class="comment">// interrupt dispatcher, then disconnect it by setting its dispatch</span>
00357         <span class="comment">// address to the unexpected interrupt routine. Else remove the</span>
00358         <span class="comment">// interrupt object from the interrupt chain. If there is only</span>
00359         <span class="comment">// one entry remaining in the list, then reestablish the dispatch</span>
00360         <span class="comment">// address.</span>
00361         <span class="comment">//</span>
00362 
00363         Interruptx = CONTAINING_RECORD(PCR-&gt;InterruptRoutine[Vector],
00364                                        <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>,
00365                                        DispatchCode[0]);
00366 
00367         <span class="keywordflow">if</span> (Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> == <a class="code" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch</a>) {
00368             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (Irql &lt;= KiSynchIrql);
00369             <span class="keywordflow">if</span> (Interrupt == Interruptx) {
00370                 Interruptx = CONTAINING_RECORD(Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o2">InterruptListEntry</a>.Flink,
00371                                                <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>, InterruptListEntry);
00372                 Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> = <a class="code" href="../../d0/d0/ki_8h.html#a100">KiChainedDispatch</a>;
00373                 PCR-&gt;InterruptRoutine[Vector] =
00374                                 (PKINTERRUPT_ROUTINE)(&amp;Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o19">DispatchCode</a>);
00375 
00376             }
00377 
00378             RemoveEntryList(&amp;Interrupt-&gt;InterruptListEntry);
00379             Interrupty = CONTAINING_RECORD(Interruptx-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o2">InterruptListEntry</a>.Flink,
00380                                            <a class="code" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>,
00381                                            InterruptListEntry);
00382 
00383             <span class="keywordflow">if</span> (Interruptx == Interrupty) {
00384                 <span class="keywordflow">if</span> (Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o12">FloatingSave</a>) {
00385                     Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> = <a class="code" href="../../d0/d0/ki_8h.html#a113">KiFloatingDispatch</a>;
00386 
00387                 } <span class="keywordflow">else</span> {
00388                     <span class="keywordflow">if</span> (Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o10">Irql</a> == Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o11">SynchronizeIrql</a>) {
00389                         Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> =
00390                                     (PKINTERRUPT_ROUTINE)<a class="code" href="../../d0/d0/ki_8h.html#a127">KiInterruptDispatchSame</a>;
00391 
00392                     } <span class="keywordflow">else</span> {
00393                         Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o8">DispatchAddress</a> =
00394                                     (PKINTERRUPT_ROUTINE)<a class="code" href="../../d0/d0/ki_8h.html#a126">KiInterruptDispatchRaise</a>;
00395                     }
00396                 }
00397 
00398                 PCR-&gt;InterruptRoutine[Vector] =
00399                                (PKINTERRUPT_ROUTINE)(&amp;Interrupty-&gt;<a class="code" href="../../d0/d7/struct__KINTERRUPT.html#o19">DispatchCode</a>);
00400 
00401                 }
00402 
00403         } <span class="keywordflow">else</span> {
00404             <a class="code" href="../../d2/d7/hal_8h.html#a178">HalDisableSystemInterrupt</a>(Vector, Irql);
00405             PCR-&gt;InterruptRoutine[Vector] =
00406                 (PKINTERRUPT_ROUTINE)(&amp;KxUnexpectedInterrupt.DispatchCode);
00407         }
00408 
00409         <a class="code" href="../../d3/d5/ppc_2flush_8c.html#a7">KeSweepIcache</a>(TRUE);
00410         Interrupt-&gt;Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00411     }
00412 
00413     <span class="comment">//</span>
00414     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous value.</span>
00415     <span class="comment">//</span>
00416 
00417     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00418 
00419     <span class="comment">//</span>
00420     <span class="comment">// Set system affinity back to the original value.</span>
00421     <span class="comment">//</span>
00422 
00423     <a class="code" href="../../d9/d1/thredobj_8c.html#a16">KeRevertToUserAffinityThread</a>();
00424 
00425     <span class="comment">//</span>
00426     <span class="comment">// Return whether interrupt was disconnected from the specified vector.</span>
00427     <span class="comment">//</span>
00428 
00429     <span class="keywordflow">return</span> Connected;
00430 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a368" doxytag="ke.h::KeDumpMachineState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeDumpMachineState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKPROCESSOR_STATE&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessorState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>BugCheckParameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfParameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a116">PKE_BUGCHECK_UNICODE_TO_ANSI</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>UnicodeToAnsiRoutine</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a318" doxytag="ke.h::KeEnableApcQueuingThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeEnableApcQueuingThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PKTHREAD</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00631">631</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.
<p>
<pre class="fragment"><div>00637                    :
00638 
00639     This function enables <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queuing of APC's to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00640 
00641 Arguments:
00642 
00643     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00644 
00645 Return Value:
00646 
00647     The previous value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC queuing state variable.
00648 
00649 --*/
00650 
00651 {
00652 
00653     BOOLEAN ApcQueueable;
00654     KIRQL OldIrql;
00655 
00656     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00657     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00658 
00659     <span class="comment">//</span>
00660     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00661     <span class="comment">//</span>
00662 
00663     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00664 
00665     <span class="comment">//</span>
00666     <span class="comment">// Capture the current state of the APC queueable state variable and</span>
00667     <span class="comment">// set its state to TRUE.</span>
00668     <span class="comment">//</span>
00669 
00670     ApcQueueable = Thread-&gt;ApcQueueable;
00671     Thread-&gt;ApcQueueable = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00672 
00673     <span class="comment">//</span>
00674     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00675     <span class="comment">// value.</span>
00676     <span class="comment">//</span>
00677 
00678     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00679 
00680     <span class="comment">//</span>
00681     <span class="comment">// Return previous APC queueable state.</span>
00682     <span class="comment">//</span>
00683 
00684     <span class="keywordflow">return</span> ApcQueueable;
00685 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a367" doxytag="ke.h::KeEnterKernelDebugger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeEnterKernelDebugger           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01015">1015</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00134">KdDebuggerEnabled</a>, <a class="el" href="../../d6/d5/4_2kdinit_8c-source.html#l00072">KdInitSystem()</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00066">KdPitchDebugger</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00024">KeBugCheckCount</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00184">KiBugCheckDebugBreak()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts()</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00064">KiHardwareTrigger</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>01021                    :
01022 
01023     This function crashes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system in a controlled manner attempting
01024     to invoke <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel debugger.
01025 
01026 Arguments:
01027 
01028     None.
01029 
01030 Return Value:
01031 
01032     None.
01033 
01034 --*/
01035 
01036 {
01037 
01038 <span class="preprocessor">#if !defined(i386)</span>
01039 <span class="preprocessor"></span>    KIRQL OldIrql;
01040 <span class="preprocessor">#endif</span>
01041 <span class="preprocessor"></span>
01042     <span class="comment">//</span>
01043     <span class="comment">// Freeze execution of the system by disabling interrupts and looping.</span>
01044     <span class="comment">//</span>
01045 
01046     <a class="code" href="../../d4/d4/alpha_2splocks_8c.html#a12">KiHardwareTrigger</a> = 1;
01047     <a class="code" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts</a>();
01048 <span class="preprocessor">#if !defined(i386)</span>
01049 <span class="preprocessor"></span>    <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
01050 <span class="preprocessor">#endif</span>
01051 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (InterlockedDecrement (&amp;KeBugCheckCount) == 0) {
01052         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/kd_8h.html#a13">KdDebuggerEnabled</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01053             <span class="keywordflow">if</span> ( <a class="code" href="../../d7/d3/kd_8h.html#a7">KdPitchDebugger</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> ) {
01054                 <a class="code" href="../../d5/d6/4_2kdinit_8c.html#a4">KdInitSystem</a>(NULL, FALSE);
01055             }
01056         }
01057     }
01058 
01059     <a class="code" href="../../d9/d1/bugcheck_8c.html#a16">KiBugCheckDebugBreak</a> (DBG_STATUS_FATAL);
01060 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a397" doxytag="ke.h::KeFindConfigurationEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> KeFindConfigurationEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Child</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a54">CONFIGURATION_CLASS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Class</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG <a class="el" href="../../d3/d0/user32_8def.html#a52">Key</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/config_8c-source.html#l00034">34</a> of file <a class="el" href="../../d0/d4/config_8c-source.html">config.c</a>.
<p>
References <a class="el" href="../../d0/d4/config_8c-source.html#l00062">KeFindConfigurationNextEntry()</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00417">Key</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00087">CmpInitializeHardwareConfiguration()</a>.
<p>
<pre class="fragment"><div>00042                    :
00043 
00044     This function search <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified configuration tree and returns a
00045     pointer to an entry that matches <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <span class="keyword">class</span>, <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>, and key
00046     parameters.
00047 
00048     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same as KeFindConfurationEntryNext expect
00049     that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> search <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first entry
00050 
00051     N.B. This routine can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called during system initialization.
00052 
00053 --*/
00054 {
00055     <a class="code" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> Resume;
00056 
00057     Resume = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00058     <span class="keywordflow">return</span> <a class="code" href="../../d9/d4/config_8c.html#a1">KeFindConfigurationNextEntry</a> (Child, Class, Type, Key, &amp;Resume);
00059 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a398" doxytag="ke.h::KeFindConfigurationNextEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> KeFindConfigurationNextEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Child</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a54">CONFIGURATION_CLASS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Class</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG <a class="el" href="../../d3/d0/user32_8def.html#a52">Key</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Resume</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/config_8c-source.html#l00062">62</a> of file <a class="el" href="../../d0/d4/config_8c-source.html">config.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l01628">_CONFIGURATION_COMPONENT_DATA::Child</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00279">_CONFIGURATION_COMPONENT::Class</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01630">_CONFIGURATION_COMPONENT_DATA::ComponentEntry</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00417">Key</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00284">_CONFIGURATION_COMPONENT::Key</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01629">_CONFIGURATION_COMPONENT_DATA::Sibling</a>, and <a class="el" href="../../d2/d8/arc_8h-source.html#l00280">_CONFIGURATION_COMPONENT::Type</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/config_8c-source.html#l00034">KeFindConfigurationEntry()</a>.
<p>
<pre class="fragment"><div>00072                    :
00073 
00074     This function search <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified configuration tree and returns a
00075     pointer to an entry that matches <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <span class="keyword">class</span>, <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>, and key
00076     parameters.
00077 
00078     N.B. This routine can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called during system initialization.
00079 
00080 Arguments:
00081 
00082     Child - Supplies an optional pointer to an NT configuration component.
00083 
00084     Class - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> configuration <span class="keyword">class </span>of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry to locate.
00085 
00086     Type - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> configuration <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry to locate.
00087 
00088     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a> - Supplies a pointer to an optional key value to use in locating
00089         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry.
00090 
00091     Resume - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> last returned entry for which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> search
00092         should resume from.
00093 
00094 Return Value:
00095 
00096     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> located, then a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> configuration
00097     entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value. Otherwise, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00098 
00099 --*/
00100 
00101 {
00102 
00103     <a class="code" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> Entry;
00104     ULONG MatchKey;
00105     ULONG MatchMask;
00106     <a class="code" href="../../d5/d8/struct__CONFIGURATION__COMPONENT__DATA.html">PCONFIGURATION_COMPONENT_DATA</a> Sibling;
00107 
00108     <span class="comment">//</span>
00109     <span class="comment">// Initialize the match key and mask based on whether the optional key</span>
00110     <span class="comment">// value is specified.</span>
00111     <span class="comment">//</span>
00112 
00113     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Key)) {
00114         MatchMask = 0xffffffff;
00115         MatchKey = *<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a>;
00116 
00117     } <span class="keywordflow">else</span> {
00118         MatchMask = 0;
00119         MatchKey = 0;
00120     }
00121 
00122     <span class="comment">//</span>
00123     <span class="comment">// Search specified configuration tree for an entry that matches the</span>
00124     <span class="comment">// the specified class, type, and key.</span>
00125     <span class="comment">//</span>
00126 
00127     <span class="keywordflow">while</span> (Child != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00128         <span class="keywordflow">if</span> (*Resume) {
00129             <span class="comment">//</span>
00130             <span class="comment">// If resume location found, clear resume location and continue</span>
00131             <span class="comment">// search with next entry</span>
00132             <span class="comment">//</span>
00133 
00134             <span class="keywordflow">if</span> (Child == *Resume) {
00135                 *Resume = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00136             }
00137         } <span class="keywordflow">else</span> {
00138 
00139             <span class="comment">//</span>
00140             <span class="comment">// If the class, type, and key match, then return a pointer to</span>
00141             <span class="comment">// the child entry.</span>
00142             <span class="comment">//</span>
00143 
00144             <span class="keywordflow">if</span> ((Child-&gt;ComponentEntry.Class == Class) &amp;&amp;
00145                 (Child-&gt;ComponentEntry.Type == Type) &amp;&amp;
00146                 ((Child-&gt;ComponentEntry.Key &amp; MatchMask) == MatchKey)) {
00147                 <span class="keywordflow">return</span> Child;
00148             }
00149         }
00150 
00151         <span class="comment">//</span>
00152         <span class="comment">// If the child has a sibling list, then search the sibling list</span>
00153         <span class="comment">// for an entry that matches the specified class, type, and key.</span>
00154         <span class="comment">//</span>
00155 
00156         Sibling = Child-&gt;Sibling;
00157         <span class="keywordflow">while</span> (Sibling != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00158             <span class="keywordflow">if</span> (*Resume) {
00159                 <span class="comment">//</span>
00160                 <span class="comment">// If resume location found, clear resume location and continue</span>
00161                 <span class="comment">// search with next entry</span>
00162                 <span class="comment">//</span>
00163 
00164                 <span class="keywordflow">if</span> (Sibling == *Resume) {
00165                     *Resume = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00166                 }
00167             } <span class="keywordflow">else</span> {
00168 
00169                 <span class="comment">//</span>
00170                 <span class="comment">// If the class, type, and key match, then return a pointer to</span>
00171                 <span class="comment">// the child entry.</span>
00172                 <span class="comment">//</span>
00173 
00174                 <span class="keywordflow">if</span> ((Sibling-&gt;ComponentEntry.Class == Class) &amp;&amp;
00175                     (Sibling-&gt;ComponentEntry.Type == Type) &amp;&amp;
00176                     ((Sibling-&gt;ComponentEntry.Key &amp; MatchMask) == MatchKey)) {
00177                     <span class="keywordflow">return</span> Sibling;
00178                 }
00179             }
00180 
00181             <span class="comment">//</span>
00182             <span class="comment">// If the sibling has a child tree, then search the child tree</span>
00183             <span class="comment">// for an entry that matches the specified class, type, and key.</span>
00184             <span class="comment">//</span>
00185 
00186             <span class="keywordflow">if</span> (Sibling-&gt;Child != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00187                Entry = <a class="code" href="../../d9/d4/config_8c.html#a1">KeFindConfigurationNextEntry</a> (
00188                                 Sibling-&gt;Child,
00189                                 Class,
00190                                 Type,
00191                                 Key,
00192                                 Resume
00193                                 );
00194 
00195                <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00196                    <span class="keywordflow">return</span> Entry;
00197                }
00198             }
00199 
00200             Sibling = Sibling-&gt;Sibling;
00201         }
00202 
00203         Child = Child-&gt;Child;
00204     }
00205 
00206     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00207 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a374" doxytag="ke.h::KeFlushCurrentTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeFlushCurrentTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d8/mips_2kdtrap_8c-source.html#l00079">KdpTrap()</a>, <a class="el" href="../../d9/d4/i386_2flushtb_8c-source.html#l00094">KeFlushEntireTb()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00391">KeThawExecution()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00203">KiFlushEntireTbTarget()</a>, <a class="el" href="../../d9/d4/i386_2flushtb_8c-source.html#l00202">KiFlushTargetEntireTb()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00220">KiFreezeTargetExecution()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00733">KiGetNewRid()</a>, <a class="el" href="../../d1/d2/ppc_2initkr_8c-source.html#l00082">KiInitializeKernel()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00122">KiSyncNewRegionId()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00041">KiSyncNewRegionIdTarget()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00468">KiSyncSessionTarget()</a>, <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>, and <a class="el" href="../../d9/d7/sysload_8c-source.html#l06495">MmMakeKernelResourceSectionWritable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a375" doxytag="ke.h::KeFlushEntireTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeFlushEntireTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00086">86</a> of file <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html">alpha/flushtb.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00303">IPI_INSTRUMENT_COUNT</a>, <a class="el" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00092">SYNCH_LEVEL</a>.
<p>
Referenced by <a class="el" href="../../d9/d1/pagfault_8c-source.html#l02880">MiCheckVirtualAddress()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l02341">MiDownShareCountFlushEntireTb()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l01160">MiFlushPteList()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l02488">MiFlushUserPhysicalPteList()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04374">MiHandleBankedSection()</a>, <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l01440">MiMapBBTMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02785">MiMapLockedPagesInUserSpace()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00035">MiMapPageInHyperSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02395">MiMapSinglePage()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01028">MiMapViewOfPhysicalSection()</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l01354">MiReleaseSystemPtes()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00265">MiRemoveMappedView()</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l00524">MiReserveSystemPtes()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l01989">MiResolveMappedFileFault()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05581">MmAllocateNonCachedMemory()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02005">MmFreeLoaderBlock()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03415">MmMapIoSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02058">MmMapLockedPagesSpecifyCache()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05161">MmMapUserAddressesToPage()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l00063">MmMapViewInSystemCache()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l03180">MmOutPageKernelStack()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05920">MmSetAddressRangeModified()</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l07311">MmSetBankedSection()</a>.
<p>
<pre class="fragment"><div>00093                    :
00094 
00095     This function flushes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entire <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer (TB) on all
00096     processors that are currently running threads which are children
00097     of the current process or flushes the entire translation buffer
00098     on all processors in the host configuration.
00099 
00100 Arguments:
00101 
00102     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies the reason for
00103         flushing the translation buffer.
00104 
00105     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00106         translation buffers are to be flushed.
00107 
00108 Return Value:
00109 
00110     None.
00111 
00112 --*/
00113 
00114 {
00115 
00116     KIRQL OldIrql;
00117     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00118     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00119     KAFFINITY TargetProcessors;
00120 
00121     <span class="comment">//</span>
00122     <span class="comment">// Compute the target set of processors, disable context switching,</span>
00123     <span class="comment">// and send the flush entire parameters to the target processors,</span>
00124     <span class="comment">// if any, for execution.</span>
00125     <span class="comment">//</span>
00126 
00127 <span class="preprocessor">#if defined(NT_UP)</span>
00128 <span class="preprocessor"></span>
00129     __tbia();
00130 
00131 <span class="preprocessor">#else</span>
00132 <span class="preprocessor"></span>
00133     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00134         OldIrql = KeRaiseIrqlToSynchLevel();
00135         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00136 
00137     } <span class="keywordflow">else</span> {
00138         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00139         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00140         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00141         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00142         <span class="keywordflow">if</span> (TargetProcessors != Process-&gt;RunOnProcessors) {
00143             Process-&gt;ProcessSequence = KiMasterSequence - 1;
00144         }
00145     }
00146 
00147     TargetProcessors &amp;= PCR-&gt;NotMember;
00148     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00149         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00150                         KiFlushEntireTbTarget,
00151                         NULL,
00152                         NULL,
00153                         NULL);
00154     }
00155 
00156     <a class="code" href="../../d0/d0/ki_8h.html#a21">IPI_INSTRUMENT_COUNT</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number, FlushEntireTb);
00157 
00158     <span class="comment">//</span>
00159     <span class="comment">// Flush TB on current processor.</span>
00160     <span class="comment">//</span>
00161 
00162     <span class="comment">// KeFlushCurrentTb();</span>
00163     __tbia();
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">// Wait until all target processors have finished.</span>
00167     <span class="comment">//</span>
00168 
00169     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00170         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00171     }
00172 
00173     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00174         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00175     } <span class="keywordflow">else</span> {
00176         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00177     }
00178 
00179 <span class="preprocessor">#endif</span>
00180 <span class="preprocessor"></span>
00181     <span class="keywordflow">return</span>;
00182 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a376" doxytag="ke.h::KeFlushMultipleTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeFlushMultipleTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcesors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE *PtePointer&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00231">231</a> of file <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html">alpha/flushtb.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00303">IPI_INSTRUMENT_COUNT</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
Referenced by <a class="el" href="../../d9/d5/deleteva_8c-source.html#l01160">MiFlushPteList()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l02488">MiFlushUserPhysicalPteList()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l03180">MmOutPageKernelStack()</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l05920">MmSetAddressRangeModified()</a>.
<p>
<pre class="fragment"><div>00242                    :
00243 
00244     This function flushes multiple entries from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00245     on all processors that are currently running threads which are
00246     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a multiple entries from
00247     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00248 
00249 Arguments:
00250 
00251     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of TB entries to flush.
00252 
00253     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a pointer to an array of <span class="keyword">virtual</span> addresses that
00254         are within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pages whose <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entries are to be
00255         flushed.
00256 
00257     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00258         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00259 
00260     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00261         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00262 
00263     PtePointer - Supplies an optional pointer to an array of pointers to
00264        page table entries that receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry
00265        value.
00266 
00267     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00268 
00269 Return Value:
00270 
00271     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00272     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00273 
00274 --*/
00275 
00276 {
00277 
00278     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00279     KIRQL OldIrql;
00280     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00281     KAFFINITY TargetProcessors;
00282     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00283 
00284     <span class="comment">//</span>
00285     <span class="comment">// Compute the target set of processors and send the flush multiple</span>
00286     <span class="comment">// parameters to the target processors, if any, for execution.</span>
00287     <span class="comment">//</span>
00288 
00289     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00290         OldIrql = KeRaiseIrqlToSynchLevel();
00291         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00292 
00293     } <span class="keywordflow">else</span> {
00294         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00295         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00296         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00297         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00298         <span class="keywordflow">if</span> (TargetProcessors != Process-&gt;RunOnProcessors) {
00299             Process-&gt;ProcessSequence = KiMasterSequence - 1;
00300         }
00301     }
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">// If a page table entry address address is specified, then set the</span>
00305     <span class="comment">// specified page table entries to the specific value.</span>
00306     <span class="comment">//</span>
00307 
00308     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(PtePointer)) {
00309         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00310             *PtePointer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = PteValue;
00311         }
00312     }
00313 
00314     TargetProcessors &amp;= PCR-&gt;NotMember;
00315     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00316         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00317                         KiFlushMultipleTbTarget,
00318                         ULongToPtr(Number),
00319                         (PVOID)Virtual,
00320                         NULL);
00321     }
00322 
00323     <a class="code" href="../../d0/d0/ki_8h.html#a21">IPI_INSTRUMENT_COUNT</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number, FlushMultipleTb);
00324 
00325     <span class="comment">//</span>
00326     <span class="comment">// Flush the specified entries from the TB on the current processor.</span>
00327     <span class="comment">//</span>
00328 
00329     <a class="code" href="../../d0/d0/ki_8h.html#a115">KiFlushMultipleTb</a>(Invalid, &amp;Virtual[0], Number);
00330 
00331     <span class="comment">//</span>
00332     <span class="comment">// Wait until all target processors have finished.</span>
00333     <span class="comment">//</span>
00334 
00335     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00336         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00337     }
00338 
00339     <span class="comment">//</span>
00340     <span class="comment">// If the context swap lock was acquired, release it.</span>
00341     <span class="comment">//</span>
00342     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00343         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00344 
00345     } <span class="keywordflow">else</span> {
00346         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00347     }
00348 
00349     <span class="keywordflow">return</span>;
00350 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a256" doxytag="ke.h::KeFlushQueueApc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PLIST_ENTRY KeFlushQueueApc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessorMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00138">138</a> of file <a class="el" href="../../d6/d6/apcobj_8c-source.html">apcobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00254">_KAPC::Inserted</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d9/ntosdef_8h.html#a47">PKAPC</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.
<p>
<pre class="fragment"><div>00145                    :
00146 
00147     This function flushes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC queue selected by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified processor
00148     mode <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread. An APC queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> flushed by removing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00149     listhead from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list, scanning <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC entries in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list, setting
00150     their inserted variables to <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, and then returning <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00151     doubly linked list as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00152 
00153 Arguments:
00154 
00155     Thread - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00156 
00157     ApcMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC queue that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to
00158         be flushed.
00159 
00160 Return Value:
00161 
00162     The address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list of APC objects that were flushed
00163     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified APC queue.
00164 
00165 --*/
00166 
00167 {
00168 
00169     <a class="code" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc;
00170     PLIST_ENTRY FirstEntry;
00171     PLIST_ENTRY NextEntry;
00172     KIRQL OldIrql;
00173 
00174     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00175 
00176     <span class="comment">//</span>
00177     <span class="comment">// Raise IRQL to dispatcher level, lock dispatcher database, and</span>
00178     <span class="comment">// lock the APC queue.</span>
00179     <span class="comment">//</span>
00180 
00181     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00182     KiAcquireSpinLock(&amp;Thread-&gt;ApcQueueLock);
00183 
00184     <span class="comment">//</span>
00185     <span class="comment">// Get address of first APC in the list and check if the list is</span>
00186     <span class="comment">// empty or contains entries that should be flushed. If entries</span>
00187     <span class="comment">// should be flushed, then scan the list of APC objects and set their</span>
00188     <span class="comment">// inserted state to FALSE.</span>
00189     <span class="comment">//</span>
00190 
00191     FirstEntry = Thread-&gt;ApcState.ApcListHead[ApcMode].Flink;
00192     <span class="keywordflow">if</span> (FirstEntry == &amp;Thread-&gt;ApcState.ApcListHead[ApcMode]) {
00193         FirstEntry = (PLIST_ENTRY)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00194 
00195     } <span class="keywordflow">else</span> {
00196         RemoveEntryList(&amp;Thread-&gt;ApcState.ApcListHead[ApcMode]);
00197         NextEntry = FirstEntry;
00198         <span class="keywordflow">do</span> {
00199             Apc = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d1/d5/struct__KAPC.html">KAPC</a>, ApcListEntry);
00200             Apc-&gt;<a class="code" href="../../d1/d5/struct__KAPC.html#o13">Inserted</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00201             NextEntry = NextEntry-&gt;Flink;
00202         } <span class="keywordflow">while</span> (NextEntry != FirstEntry);
00203     }
00204 
00205     <span class="comment">//</span>
00206     <span class="comment">// Unlock the APC queue, unlock the dispatcher database, lower IRQL to</span>
00207     <span class="comment">// its previous value, and return address of first entry in list of APC</span>
00208     <span class="comment">// objects that were flushed.</span>
00209     <span class="comment">//</span>
00210 
00211     KiReleaseSpinLock(&amp;Thread-&gt;ApcQueueLock);
00212     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00213     <span class="keywordflow">return</span> FirstEntry;
00214 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a377" doxytag="ke.h::KeFlushSingleTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HARDWARE_PTE KeFlushSingleTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcesors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PtePointer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00420">420</a> of file <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html">alpha/flushtb.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00303">IPI_INSTRUMENT_COUNT</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01119">KiFlushSingleCallData</a>, <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00054">RECORD_CALL_DATA</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/i386_2flushtb_8c-source.html#l00747">Ki386UseSynchronousTbFlush()</a>, <a class="el" href="../../d4/d9/wrtfault_8c-source.html#l00025">MiCopyOnWrite()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l00506">MiDeletePte()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l03974">MiEliminateWorkingSetEntry()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02944">MiEnablePagingOfDriverAtInit()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l02281">MiFlushDirtyBitsToPfn()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l01160">MiFlushPteList()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l02079">MiFlushTbAndCapture()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l02488">MiFlushUserPhysicalPteList()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00708">MiFreeNonPagedPool()</a>, <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00313">MiMapPageToZeroInHyperSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02395">MiMapSinglePage()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00150">MiProtectFreeNonPagedPool()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l05278">MiProtectSpecialPool()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l01953">MiResetVirtualMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03060">MiSetPageModified()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02309">MiSetPagingOfDriver()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l05448">MiSetSystemCodeProtection()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00243">MiUnmapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03253">MiUnmapLockedPagesInUserSpace()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03742">MmFreeSpecialPool()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05161">MmMapUserAddressesToPage()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00437">MmRemovePhysicalMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05920">MmSetAddressRangeModified()</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l04027">MmSetPageProtection()</a>.
<p>
<pre class="fragment"><div>00430                    :
00431 
00432     This function flushes a single entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00433     on all processors that are currently running threads which are
00434     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a single entry from
00435     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00436 
00437 Arguments:
00438 
00439     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a <span class="keyword">virtual</span> address that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page whose
00440         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be flushed.
00441 
00442     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00443         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00444 
00445     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00446         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00447 
00448     PtePointer - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page table entry which
00449         receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified value.
00450 
00451     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00452 
00453 Return Value:
00454 
00455     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00456     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00457 
00458 --*/
00459 
00460 {
00461 
00462     KIRQL OldIrql;
00463     HARDWARE_PTE OldPte;
00464     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00465     KAFFINITY TargetProcessors;
00466     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00467 
00468     <span class="comment">//</span>
00469     <span class="comment">// Compute the target set of processors and send the flush single</span>
00470     <span class="comment">// paramters to the target processors, if any, for execution.</span>
00471     <span class="comment">//</span>
00472 
00473     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00474         OldIrql = KeRaiseIrqlToSynchLevel();
00475         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00476 
00477     } <span class="keywordflow">else</span> {
00478         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00479         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00480         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00481         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00482         <span class="keywordflow">if</span> (TargetProcessors != Process-&gt;RunOnProcessors) {
00483             Process-&gt;ProcessSequence = KiMasterSequence - 1;
00484         }
00485     }
00486 
00487     <span class="comment">//</span>
00488     <span class="comment">// Capture the previous contents of the page table entry and set the</span>
00489     <span class="comment">// page table entry to the new value.</span>
00490     <span class="comment">//</span>
00491 
00492     OldPte = *PtePointer;
00493     *PtePointer = PteValue;
00494     TargetProcessors &amp;= PCR-&gt;NotMember;
00495     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00496         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00497                         KiFlushSingleTbTarget,
00498                         (PVOID)Virtual,
00499                         NULL,
00500                         NULL);
00501     }
00502 
00503     <a class="code" href="../../d0/d0/ki_8h.html#a21">IPI_INSTRUMENT_COUNT</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number, FlushSingleTb);
00504 
00505     <span class="comment">//</span>
00506     <span class="comment">// Flush the specified entry from the TB on the current processor.</span>
00507     <span class="comment">//</span>
00508 
00509 <span class="comment">//    KiFlushSingleTb(Invalid, Virtual);</span>
00510     __tbis(Virtual);
00511 
00512     <span class="comment">//</span>
00513     <span class="comment">// Wait until all target processors have finished.</span>
00514     <span class="comment">//</span>
00515 
00516     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00517         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00518     }
00519 
00520     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00521         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00522 
00523     } <span class="keywordflow">else</span> {
00524         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00525     }
00526 
00527     <span class="comment">//</span>
00528     <span class="comment">// return the previous page table entry value.</span>
00529     <span class="comment">//</span>
00530 
00531     <span class="keywordflow">return</span> OldPte;
00532 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a300" doxytag="ke.h::KeForceAttachProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LOGICAL KeForceAttachProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Process</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a320" doxytag="ke.h::KeForceResumeThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KeForceResumeThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00688">688</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, and <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00227">NtTerminateProcess()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00461">NtTerminateThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00631">PspExitNormalApc()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00384">PspTerminateProcess()</a>.
<p>
<pre class="fragment"><div>00694                    :
00695 
00696     This function forces resumption of thread execution <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00697     suspended. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not suspended, then no operation
00698     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed.
00699 
00700 Arguments:
00701 
00702     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00703 
00704 Return Value:
00705 
00706     The sum of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous suspend count and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> freeze count.
00707 
00708 --*/
00709 
00710 {
00711 
00712     ULONG OldCount;
00713     KIRQL OldIrql;
00714 
00715     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00716     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00717 
00718     <span class="comment">//</span>
00719     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00720     <span class="comment">//</span>
00721 
00722     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00723 
00724     <span class="comment">//</span>
00725     <span class="comment">// Capture the current suspend count.</span>
00726     <span class="comment">//</span>
00727 
00728     OldCount = Thread-&gt;SuspendCount + Thread-&gt;FreezeCount;
00729 
00730     <span class="comment">//</span>
00731     <span class="comment">// If the thread is currently suspended, then force resumption of</span>
00732     <span class="comment">// thread execution.</span>
00733     <span class="comment">//</span>
00734 
00735     <span class="keywordflow">if</span> (OldCount != 0) {
00736         Thread-&gt;FreezeCount = 0;
00737         Thread-&gt;SuspendCount = 0;
00738         Thread-&gt;SuspendSemaphore.Header.SignalState += 1;
00739         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;Thread-&gt;SuspendSemaphore, RESUME_INCREMENT);
00740     }
00741 
00742     <span class="comment">//</span>
00743     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00744     <span class="comment">// value.</span>
00745     <span class="comment">//</span>
00746 
00747     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00748 
00749     <span class="comment">//</span>
00750     <span class="comment">// Return the previous suspend count.</span>
00751     <span class="comment">//</span>
00752 
00753     <span class="keywordflow">return</span> OldCount;
00754 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a321" doxytag="ke.h::KeFreezeAllThreads" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeFreezeAllThreads           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00757">757</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00679">_KTHREAD::FreezeCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00512">_KSEMAPHORE::Header</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d7/d6/apcsup_8c-source.html#l00223">KiInsertQueueApc()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00668">_KTHREAD::SuspendApc</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00680">_KTHREAD::SuspendCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00669">_KTHREAD::SuspendSemaphore</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00453">_ETHREAD::ThreadListEntry</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00764">_KPROCESS::ThreadListHead</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00036">DbgkpSuspendProcess()</a>.
<p>
<pre class="fragment"><div>00763                    :
00764 
00765     This function suspends <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of all thread in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
00766     process except <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> freeze count overflows
00767     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum suspend count, then a condition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
00768 
00769 Arguments:
00770 
00771     None.
00772 
00773 Return Value:
00774 
00775     None.
00776 
00777 --*/
00778 
00779 {
00780 
00781     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> CurrentThread;
00782     PLIST_ENTRY ListHead;
00783     PLIST_ENTRY NextEntry;
00784     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00785     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00786     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> EThread;
00787     ULONG OldCount;
00788     KIRQL OldIrql;
00789 
00790     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00791 
00792     <span class="comment">//</span>
00793     <span class="comment">// Get the address of the current thread object, the current process</span>
00794     <span class="comment">// object, raise IRQL to dispatch level, lock dispatcher database,</span>
00795     <span class="comment">// and freeze the execution of all threads in the process except the</span>
00796     <span class="comment">// current thread.</span>
00797     <span class="comment">//</span>
00798 
00799     CurrentThread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00800     Process = CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00801     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00802 
00803     <span class="comment">//</span>
00804     <span class="comment">// If the freeze count of the current thread is not zero, then there</span>
00805     <span class="comment">// is another thread that is trying to freeze this thread. Unlock the</span>
00806     <span class="comment">// dispatcher, lower IRQL to its previous value, allow the suspend</span>
00807     <span class="comment">// APC to occur, then raise IRQL to dispatch level, lock the dispatcher</span>
00808     <span class="comment">// database, and try again.</span>
00809     <span class="comment">//</span>
00810 
00811     <span class="keywordflow">while</span> (CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a> != 0) {
00812         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00813         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00814     }
00815 
00816     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
00817 
00818     <span class="comment">//</span>
00819     <span class="comment">// Freeze all threads except the current thread.</span>
00820     <span class="comment">//</span>
00821 
00822     ListHead = &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>;
00823     NextEntry = ListHead-&gt;Flink;
00824     <span class="keywordflow">do</span> {
00825 
00826         <span class="comment">//</span>
00827         <span class="comment">// Get the address of the next thread and suspend it if it is</span>
00828         <span class="comment">// not the current thread.</span>
00829         <span class="comment">//</span>
00830 
00831         Thread = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>, ThreadListEntry);
00832         <span class="keywordflow">if</span> (Thread != CurrentThread) {
00833 
00834             EThread = (<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>) Thread;
00835             <span class="keywordflow">if</span> ( EThread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o37">ThreadListEntry</a>.Flink == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ) {
00836                 ;
00837             } <span class="keywordflow">else</span> {
00838 
00839                 <span class="comment">//</span>
00840                 <span class="comment">// Increment the freeze count. If the thread was not previously</span>
00841                 <span class="comment">// suspended, then queue the thread's suspend APC.</span>
00842                 <span class="comment">//</span>
00843 
00844                 OldCount = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a>;
00845 
00846                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OldCount != MAXIMUM_SUSPEND_COUNT);
00847 
00848                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a> += 1;
00849                 <span class="keywordflow">if</span> ((OldCount == 0) &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o66">SuspendCount</a> == 0)) {
00850                     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/ki_8h.html#a123">KiInsertQueueApc</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o62">SuspendApc</a>, RESUME_INCREMENT) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00851                         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o63">SuspendSemaphore</a>.<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> -= 1;
00852                     }
00853                 }
00854             }
00855         }
00856         NextEntry = NextEntry-&gt;Flink;
00857     } <span class="keywordflow">while</span> (NextEntry != ListHead);
00858 
00859     <span class="comment">//</span>
00860     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00861     <span class="comment">// value.</span>
00862     <span class="comment">//</span>
00863 
00864     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00865     <span class="keywordflow">return</span>;
00866 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a378" doxytag="ke.h::KeFreezeExecution" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeFreezeExecution           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKTRAP_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>TrapFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEXCEPTION_FRAME&nbsp;</td>
          <td class="mdname" nowrap> <em>ExceptionFrame</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00055">55</a> of file <a class="el" href="../../d0/d4/ke_2debug_8c-source.html">ke/debug.c</a>.
<p>
References <a class="el" href="../../d1/d9/ki_8h-source.html#l00058">ClearMember</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00039">FREEZE_ACTIVE</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00040">FREEZE_BACKUP</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00042">FREEZE_FROZEN</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00036">FREEZE_OWNER</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00041">FREEZE_SKIPPED_PROCESSOR</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00030">FrozenState</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00281">IPI_FREEZE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02293">KeFindFirstSetRightMember</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts()</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00062">KiFreezeExecutionLock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00389">KiFreezeFlag</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00063">KiFreezeLockBackup</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00049">KiFreezeOwner</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00253">KiIpiSend()</a>, <a class="el" href="../../d0/d6/ppc_2ipi_8c-source.html#l00156">KiIpiServiceRoutine()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00046">KiOldIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d0/d0/ki_8h.html#a107">KiRestoreInterrupts()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a155">KiTryToAcquireSpinLock()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00034">TARGET_FROZEN</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00303">KdEnterDebugger()</a>.
<p>
<pre class="fragment"><div>00062                    :
00063 
00064     This function freezes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of all other processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host
00065     configuration and then returns to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
00066 
00067 Arguments:
00068 
00069     TrapFrame - Supplies a pointer to a trap frame that describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00070         trap.
00071 
00072     ExceptionFrame - Supplies a pointer to an exception frame that
00073         describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap.
00074 
00075 Return Value:
00076 
00077     Previous interrupt enable.
00078 
00079 --*/
00080 
00081 {
00082 
00083     BOOLEAN Enable;
00084 
00085 <span class="preprocessor">#if !defined(NT_UP)</span>
00086 <span class="preprocessor"></span>
00087     BOOLEAN Flag;
00088     PKPRCB Prcb;
00089     ULONG TargetSet;
00090     ULONG BitNumber;
00091     KIRQL OldIrql;
00092 
00093 <span class="preprocessor">#if IDBG</span>
00094 <span class="preprocessor"></span>
00095     ULONG <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> = 30000;
00096 
00097 <span class="preprocessor">#endif</span>
00098 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00099 <span class="preprocessor"></span>
00100     <span class="comment">//</span>
00101     <span class="comment">// Disable interrupts.</span>
00102     <span class="comment">//</span>
00103 
00104     Enable = <a class="code" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts</a>();
00105     <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a> = <a class="code" href="../../d7/d3/kd_8h.html#a5">FREEZE_FROZEN</a>;
00106 
00107 <span class="preprocessor">#if !defined(NT_UP)</span>
00108 <span class="preprocessor"></span>    <span class="comment">//</span>
00109     <span class="comment">// Raise IRQL to HIGH_LEVEL.</span>
00110     <span class="comment">//</span>
00111 
00112     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
00113 
00114     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d4/ke_2debug_8c.html#a1">FrozenState</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;IpiFrozen) == <a class="code" href="../../d9/d4/ke_2debug_8c.html#a5">FREEZE_OWNER</a>) {
00115         <span class="comment">//</span>
00116         <span class="comment">// This processor already owns the freeze lock.</span>
00117         <span class="comment">// Return without trying to re-acquire lock or without</span>
00118         <span class="comment">// trying to IPI the other processors again</span>
00119         <span class="comment">//</span>
00120 
00121         <span class="keywordflow">return</span> Enable;
00122     }
00123 
00124 
00125     <span class="comment">//</span>
00126     <span class="comment">// Try to acquire the KiFreezeExecutionLock before sending the request.</span>
00127     <span class="comment">// To prevent deadlock from occurring, we need to accept and process</span>
00128     <span class="comment">// incoming FreexeExecution requests while we are waiting to acquire</span>
00129     <span class="comment">// the FreezeExecutionFlag.</span>
00130     <span class="comment">//</span>
00131 
00132     <span class="keywordflow">while</span> (<a class="code" href="../../d0/d0/ki_8h.html#a155">KiTryToAcquireSpinLock</a> (&amp;KiFreezeExecutionLock) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00133 
00134         <span class="comment">//</span>
00135         <span class="comment">// FreezeExecutionLock is busy.  Another processor may be trying</span>
00136         <span class="comment">// to IPI us - go service any IPI.</span>
00137         <span class="comment">//</span>
00138 
00139         <a class="code" href="../../d0/d0/ki_8h.html#a107">KiRestoreInterrupts</a>(Enable);
00140         Flag = <a class="code" href="../../d9/d6/ppc_2ipi_8c.html#a4">KiIpiServiceRoutine</a>((PVOID)TrapFrame, (PVOID)ExceptionFrame);
00141         <a class="code" href="../../d0/d0/ki_8h.html#a106">KiDisableInterrupts</a>();
00142 
00143 <span class="preprocessor">#if IDBG</span>
00144 <span class="preprocessor"></span>
00145         <span class="keywordflow">if</span> (Flag != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00146             <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> = 30000;
00147             <span class="keywordflow">continue</span>;
00148         }
00149 
00150         <a class="code" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor</a> (100);
00151         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>--) {
00152             <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> = 30000;
00153             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/ki_8h.html#a155">KiTryToAcquireSpinLock</a> (&amp;KiFreezeLockBackup) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00154                 <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a> |= <a class="code" href="../../d7/d3/kd_8h.html#a3">FREEZE_BACKUP</a>;
00155                 <span class="keywordflow">break</span>;
00156             }
00157         }
00158 
00159 <span class="preprocessor">#endif</span>
00160 <span class="preprocessor"></span>
00161     }
00162 
00163     <span class="comment">//</span>
00164     <span class="comment">// After acquiring the lock flag, we send Freeze request to each processor</span>
00165     <span class="comment">// in the system (other than us) and wait for it to become frozen.</span>
00166     <span class="comment">//</span>
00167 
00168     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();  <span class="comment">// Do this after spinlock is acquired.</span>
00169     TargetSet = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a> &amp; ~(1 &lt;&lt; Prcb-&gt;Number);
00170     <span class="keywordflow">if</span> (TargetSet) {
00171 
00172 <span class="preprocessor">#if IDBG</span>
00173 <span class="preprocessor"></span>        <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> = 400;
00174 <span class="preprocessor">#endif</span>
00175 <span class="preprocessor"></span>
00176         <a class="code" href="../../d9/d4/ke_2debug_8c.html#a8">KiFreezeOwner</a> = Prcb;
00177         Prcb-&gt;IpiFrozen = <a class="code" href="../../d9/d4/ke_2debug_8c.html#a5">FREEZE_OWNER</a> | <a class="code" href="../../d9/d4/ke_2debug_8c.html#a6">FREEZE_ACTIVE</a>;
00178         Prcb-&gt;SkipTick  = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00179         <a class="code" href="../../d0/d0/ki_8h.html#a90">KiIpiSend</a>((KAFFINITY) TargetSet, IPI_FREEZE);
00180 
00181         <span class="keywordflow">while</span> (TargetSet != 0) {
00182             BitNumber = <a class="code" href="../../d4/d9/ke_8h.html#a39">KeFindFirstSetRightMember</a>(TargetSet);
00183             <a class="code" href="../../d0/d0/ki_8h.html#a6">ClearMember</a>(BitNumber, TargetSet);
00184             Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[BitNumber];
00185 
00186 <span class="preprocessor">#if IDBG</span>
00187 <span class="preprocessor"></span>
00188             <span class="keywordflow">while</span> (Prcb-&gt;IpiFrozen != <a class="code" href="../../d9/d4/ke_2debug_8c.html#a3">TARGET_FROZEN</a>) {
00189                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> == 0) {
00190                     <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a> |= <a class="code" href="../../d7/d3/kd_8h.html#a4">FREEZE_SKIPPED_PROCESSOR</a>;
00191                     <span class="keywordflow">break</span>;
00192                 }
00193 
00194                 <a class="code" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor</a> (10000);
00195                 <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>--;
00196             }
00197 
00198 <span class="preprocessor">#else</span>
00199 <span class="preprocessor"></span>
00200             <span class="keywordflow">while</span> (Prcb-&gt;IpiFrozen != <a class="code" href="../../d9/d4/ke_2debug_8c.html#a3">TARGET_FROZEN</a>) {
00201                 KeYieldProcessor();
00202             }
00203 <span class="preprocessor">#endif</span>
00204 <span class="preprocessor"></span>
00205         }
00206     }
00207 
00208     <span class="comment">//</span>
00209     <span class="comment">// Save the old IRQL and return whether interrupts were previous enabled.</span>
00210     <span class="comment">//</span>
00211 
00212     <a class="code" href="../../d9/d4/ke_2debug_8c.html#a7">KiOldIrql</a> = OldIrql;
00213 
00214 <span class="preprocessor">#endif      // !defined(NT_UP)</span>
00215 <span class="preprocessor"></span>
00216     <span class="keywordflow">return</span> Enable;
00217 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a362" doxytag="ke.h::KeGetBugMessageText" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeGetBugMessageText           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PANSI_STRING ReturnedString&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00097">97</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06495">MmMakeKernelResourceSectionWritable()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>.
<p>
<pre class="fragment"><div>00101 {
00102     ULONG   i;
00103     PUCHAR  s;
00104     PMESSAGE_RESOURCE_BLOCK MessageBlock;
00105     PUCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00106     BOOLEAN Result;
00107 
00108     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00109     <span class="keywordflow">try</span> {
00110         <span class="keywordflow">if</span> (KiBugCodeMessages != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00111             <a class="code" href="../../d8/d8/sysload_8c.html#a65">MmMakeKernelResourceSectionWritable</a> ();
00112             MessageBlock = &amp;KiBugCodeMessages-&gt;Blocks[0];
00113             <span class="keywordflow">for</span> (i = KiBugCodeMessages-&gt;NumberOfBlocks; i; i -= 1) {
00114                 <span class="keywordflow">if</span> (MessageId &gt;= MessageBlock-&gt;LowId &amp;&amp;
00115                     MessageId &lt;= MessageBlock-&gt;HighId) {
00116 
00117                     s = (PCHAR)KiBugCodeMessages + MessageBlock-&gt;OffsetToEntries;
00118                     <span class="keywordflow">for</span> (i = MessageId - MessageBlock-&gt;LowId; i; i -= 1) {
00119                         s += ((PMESSAGE_RESOURCE_ENTRY)s)-&gt;Length;
00120                     }
00121 
00122                     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> = ((PMESSAGE_RESOURCE_ENTRY)s)-&gt;Text;
00123 
00124                     i = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(Buffer) - 1;
00125                     <span class="keywordflow">while</span> (i &gt; 0 &amp;&amp; (<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i] == <span class="charliteral">'\n'</span>  ||
00126                                      <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i] == <span class="charliteral">'\r'</span>  ||
00127                                      <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i] == 0
00128                                     )
00129                           ) {
00130                         <span class="keywordflow">if</span> (!ARGUMENT_PRESENT( ReturnedString )) {
00131                             <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i] = 0;
00132                         }
00133                         i -= 1;
00134                     }
00135 
00136                     <span class="keywordflow">if</span> (!ARGUMENT_PRESENT( ReturnedString )) {
00137                         <a class="code" href="../../d0/d1/inbv_8h.html#a9">InbvDisplayString</a>(Buffer);
00138                         }
00139                     <span class="keywordflow">else</span> {
00140                         ReturnedString-&gt;Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00141                         ReturnedString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(i+1);
00142                         ReturnedString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(i+1);
00143                     }
00144                     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00145                     <span class="keywordflow">break</span>;
00146                 }
00147                 MessageBlock += 1;
00148             }
00149         }
00150     } except ( EXCEPTION_EXECUTE_HANDLER ) {
00151         ;
00152     }
00153 
00154     <span class="keywordflow">return</span> Result;
00155 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a380" doxytag="ke.h::KeGetNonVolatileContextPointers" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeGetNonVolatileContextPointers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKNONVOLATILE_CONTEXT_POINTERS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>NonVolatileContext</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a255" doxytag="ke.h::KeInitializeApc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeApc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__KAPC.html">PRKAPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Apc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a49">KAPC_ENVIRONMENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Environment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a42">PKKERNEL_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>KernelRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a43">PKRUNDOWN_ROUTINE</a> RundownRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a41">PKNORMAL_ROUTINE</a> NormalRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ProcessorMode&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID NormalContext&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a264" doxytag="ke.h::KeInitializeDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DeviceQueue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00040">40</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a402a177">DeviceQueueObject</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a68">KDEVICE_QUEUE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a69">PKDEVICE_QUEUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03917">IoCreateController()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04073">IoCreateDevice()</a>.
<p>
<pre class="fragment"><div>00046                    :
00047 
00048     This function initializes a kernel device queue object.
00049 
00050 Arguments:
00051 
00052     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device
00053         queue.
00054 
00055     SpinLock - Supplies a pointer to an executive spin lock.
00056 
00057 Return Value:
00058 
00059     None.
00060 
00061 --*/
00062 
00063 {
00064 
00065     <span class="comment">//</span>
00066     <span class="comment">// Initialize standard control object header.</span>
00067     <span class="comment">//</span>
00068 
00069     DeviceQueue-&gt;Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a177">DeviceQueueObject</a>;
00070     DeviceQueue-&gt;Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d5/struct__KDEVICE__QUEUE.html">KDEVICE_QUEUE</a>);
00071 
00072     <span class="comment">//</span>
00073     <span class="comment">// Initialize the device queue list head, spin lock, and busy indicator.</span>
00074     <span class="comment">//</span>
00075 
00076     InitializeListHead(&amp;DeviceQueue-&gt;DeviceListHead);
00077     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;DeviceQueue-&gt;Lock);
00078     DeviceQueue-&gt;Busy = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00079     <span class="keywordflow">return</span>;
00080 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a259" doxytag="ke.h::KeInitializeDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a49">PKDEFERRED_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeferredRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>DeferredContext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00039">39</a> of file <a class="el" href="../../d5/d0/dpcobj_8c-source.html">dpcobj.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a402a176">DpcObject</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a77a73">MediumImportance</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00266">PKDEFERRED_ROUTINE</a>, and <a class="el" href="../../d0/d9/ntosdef_8h.html#a53">PRKDPC</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00760">IopErrorLogQueueRequest()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03270">MiInitializeSpecialPoolCriteria()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.
<p>
<pre class="fragment"><div>00047                    :
00048 
00049     This function initializes a kernel DPC object. The deferred routine
00050     and context parameter are stored in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object.
00051 
00052 Arguments:
00053 
00054     Dpc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00055 
00056     DeferredRoutine - Supplies a pointer to a function that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called when
00057         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current processor's DPC queue.
00058 
00059     DeferredContext - Supplies a pointer to an arbitrary data structure which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00060         to be passed to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DeferredRoutine parameter.
00061 
00062 Return Value:
00063 
00064     None.
00065 
00066 --*/
00067 
00068 {
00069 
00070     <span class="comment">//</span>
00071     <span class="comment">// Initialize standard control object header.</span>
00072     <span class="comment">//</span>
00073 
00074     Dpc-&gt;Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a176">DpcObject</a>;
00075     Dpc-&gt;Number = 0;
00076     Dpc-&gt;Importance = <a class="code" href="../../d0/d9/ntosdef_8h.html#a77a73">MediumImportance</a>;
00077 
00078     <span class="comment">//</span>
00079     <span class="comment">// Initialize deferred routine address and deferred context parameter.</span>
00080     <span class="comment">//</span>
00081 
00082     Dpc-&gt;DeferredRoutine = DeferredRoutine;
00083     Dpc-&gt;DeferredContext = DeferredContext;
00084     Dpc-&gt;Lock = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00085     <span class="keywordflow">return</span>;
00086 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a284" doxytag="ke.h::KeInitializeEventPair" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeEventPair           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d6/struct__KEVENT__PAIR.html">PKEVENT_PAIR</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>EventPair</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00096">96</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01066">KeInitializeEvent</a>, <a class="el" href="../../d4/d9/ke_8h.html#a77">KEVENT_PAIR</a>, <a class="el" href="../../d4/d9/ke_8h.html#a78">PKEVENT_PAIR</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>.
<p>
<pre class="fragment"><div>00102                    :
00103 
00104     This function initializes a kernel event pair object. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> kernel event
00105     pair object contains two separate synchronization event objects that
00106     are used to provide a fast interprocess synchronization capability.
00107 
00108 Arguments:
00109 
00110     EventPair - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event pair.
00111 
00112 Return Value:
00113 
00114     None.
00115 
00116 --*/
00117 
00118 {
00119 
00120     <span class="comment">//</span>
00121     <span class="comment">// Initialize the type and size of the event pair object and initialize</span>
00122     <span class="comment">// the two event object as synchronization events with an initial state</span>
00123     <span class="comment">// of FALSE.</span>
00124     <span class="comment">//</span>
00125 
00126     EventPair-&gt;Type = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d4/d9/ke_8h.html#a402a178">EventPairObject</a>;
00127     EventPair-&gt;Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d6/struct__KEVENT__PAIR.html">KEVENT_PAIR</a>);
00128     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(&amp;EventPair-&gt;EventLow, SynchronizationEvent, FALSE);
00129     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(&amp;EventPair-&gt;EventHigh, SynchronizationEvent, FALSE);
00130     <span class="keywordflow">return</span>;
00131 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a270" doxytag="ke.h::KeInitializeInterrupt" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeInterrupt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Interrupt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a80">PKSERVICE_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ServiceRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>ServiceContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK SpinLock&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Vector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KIRQL&nbsp;</td>
          <td class="mdname" nowrap> <em>Irql</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KIRQL&nbsp;</td>
          <td class="mdname" nowrap> <em>SynchronizeIrql</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a50">KINTERRUPT_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>InterruptMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>ShareVector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessorNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>FloatingSave</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00032">32</a> of file <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html">alpha/intobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a402a179">InterruptObject</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03665">IoConnectInterrupt()</a>.
<p>
<pre class="fragment"><div>00048                    :
00049 
00050     This function initializes a kernel interrupt object. The service routine,
00051     service context, spin lock, vector, IRQL, Synchronized IRQL, and floating
00052     context save flag are initialized.
00053 
00054 Arguments:
00055 
00056     Interrupt - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> interrupt.
00057 
00058     ServiceRoutine - Supplies a pointer to a function that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00059         executed when an interrupt occurs via <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified interrupt
00060         vector.
00061 
00062     ServiceContext - Supplies a pointer to an arbitrary data structure which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00063         to be passed to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ServiceRoutine parameter.
00064 
00065     SpinLock - Supplies an optional pointer to an executive spin lock.
00066 
00067     Vector - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> index of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Interrupt Dispatch Table
00068         that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be associated with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ServiceRoutine function.
00069 
00070     Irql - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupting source.
00071 
00072     SynchronizeIrql - The request priority that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt should be
00073         <span class="keyword">synchronized</span> with.
00074 
00075     InterruptMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mode of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> interrupt; <a class="code" href="../../d4/d9/ke_8h.html#a404a184">LevelSensitive</a> or
00076         <a class="code" href="../../d4/d9/ke_8h.html#a404a185">Latched</a>.
00077 
00078     ShareVector - Supplies a <span class="keywordtype">boolean</span> value that specifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00079         vector can be shared with other interrupt objects or not.  If <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>
00080         then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> vector may not be shared, <span class="keywordflow">if</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> may be.
00081         <a class="code" href="../../d4/d9/ke_8h.html#a404a185">Latched</a>.
00082 
00083     ProcessorNumber - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor to which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00084         interrupt will be connected.
00085 
00086     FloatingSave - Supplies a <span class="keywordtype">boolean</span> value that determines whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00087         floating point registers and pipe line are to be saved before calling
00088         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ServiceRoutine function.
00089 
00090 Return Value:
00091 
00092     None.
00093 
00094 --*/
00095 
00096 {
00097 
00098     LONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00099 
00100     <span class="comment">//</span>
00101     <span class="comment">// Initialize standard control object header.</span>
00102     <span class="comment">//</span>
00103 
00104     Interrupt-&gt;Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a179">InterruptObject</a>;
00105     Interrupt-&gt;Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d7/struct__KINTERRUPT.html">KINTERRUPT</a>);
00106 
00107     <span class="comment">//</span>
00108     <span class="comment">// Initialize the address of the service routine, the service context,</span>
00109     <span class="comment">// the address of the spin lock, the address of the actual spin lock</span>
00110     <span class="comment">// that will be used, the vector number, the IRQL of the interrupting</span>
00111     <span class="comment">// source, the Synchronized IRQL of the interrupt object, the interrupt</span>
00112     <span class="comment">// mode, the processor number, and the floating context save flag.</span>
00113     <span class="comment">//</span>
00114 
00115     Interrupt-&gt;ServiceRoutine = ServiceRoutine;
00116     Interrupt-&gt;ServiceContext = ServiceContext;
00117 
00118     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(SpinLock)) {
00119         Interrupt-&gt;ActualLock = SpinLock;
00120     } <span class="keywordflow">else</span> {
00121         Interrupt-&gt;SpinLock = 0;
00122         Interrupt-&gt;ActualLock = &amp;Interrupt-&gt;SpinLock;
00123     }
00124 
00125     Interrupt-&gt;Vector = Vector;
00126     Interrupt-&gt;Irql = Irql;
00127     Interrupt-&gt;SynchronizeIrql = SynchronizeIrql;
00128     Interrupt-&gt;Mode = InterruptMode;
00129     Interrupt-&gt;ShareVector = ShareVector;
00130     Interrupt-&gt;Number = ProcessorNumber;
00131     Interrupt-&gt;FloatingSave = FloatingSave;
00132 
00133     <span class="comment">//</span>
00134     <span class="comment">// Copy the interrupt dispatch code template into the interrupt object</span>
00135     <span class="comment">// and flush the dcache on all processors that the current thread can</span>
00136     <span class="comment">// run on to ensure that the code is actually in memory.</span>
00137     <span class="comment">//</span>
00138 
00139     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DISPATCH_LENGTH; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00140         Interrupt-&gt;DispatchCode[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = KiInterruptTemplate[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00141     }
00142 
00143     <a class="code" href="../../d3/d5/ppc_2flush_8c.html#a7">KeSweepIcache</a>(FALSE);
00144 
00145     <span class="comment">//</span>
00146     <span class="comment">// Set the connected state of the interrupt object to FALSE.</span>
00147     <span class="comment">//</span>
00148 
00149     Interrupt-&gt;Connected = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00150     <span class="keywordflow">return</span>;
00151 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a285" doxytag="ke.h::KeInitializeMutant" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeMutant           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Mutant</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>InitialOwner</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00040">40</a> of file <a class="el" href="../../d4/d4/mutntobj_8c-source.html">mutntobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00546">_KTHREAD::MutantListHead</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00156">NtCreateMutant()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.
<p>
<pre class="fragment"><div>00047                    :
00048 
00049     This function initializes a kernel mutant object.
00050 
00051 Arguments:
00052 
00053     Mutant - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> mutant.
00054 
00055     InitialOwner - Supplies a <span class="keywordtype">boolean</span> value that determines whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00056         current thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial owner of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant object.
00057 
00058 Return Value:
00059 
00060     None.
00061 
00062 --*/
00063 
00064 {
00065 
00066     PLIST_ENTRY ListEntry;
00067     KIRQL OldIrql;
00068     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00069 
00070     <span class="comment">//</span>
00071     <span class="comment">// Initialize standard dispatcher object header, set the owner thread to</span>
00072     <span class="comment">// NULL, set the abandoned state to FALSE, and set the APC disable count</span>
00073     <span class="comment">// to zero (this is the only thing that distinguishes a mutex from a mutant).</span>
00074     <span class="comment">//</span>
00075 
00076     Mutant-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>;
00077     Mutant-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d7/struct__KMUTANT.html">KMUTANT</a>) / <span class="keyword">sizeof</span>(LONG);
00078     <span class="keywordflow">if</span> (InitialOwner == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00079         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00080         Mutant-&gt;Header.SignalState = 0;
00081         Mutant-&gt;OwnerThread = Thread;
00082         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00083         ListEntry = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o1">MutantListHead</a>.Blink;
00084         InsertHeadList(ListEntry, &amp;Mutant-&gt;MutantListEntry);
00085         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00086 
00087     } <span class="keywordflow">else</span> {
00088         Mutant-&gt;Header.SignalState = 1;
00089         Mutant-&gt;OwnerThread = (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00090     }
00091 
00092     InitializeListHead(&amp;Mutant-&gt;Header.WaitListHead);
00093     Mutant-&gt;Abandoned = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00094     Mutant-&gt;ApcDisable = 0;
00095     <span class="keywordflow">return</span>;
00096 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a288" doxytag="ke.h::KeInitializeMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeMutex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTEX</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Mutex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Level</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a299" doxytag="ke.h::KeInitializeProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KAFFINITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Affinity</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>DirectoryTableBase</em>[2], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Enable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00063">63</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a405a186">ProcessInMemory</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00036">THREAD_QUANTUM</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>.
<p>
<pre class="fragment"><div>00073                    :
00074 
00075     This function initializes a kernel process object. The base priority,
00076     affinity, and page frame numbers <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process page table directory
00077     and hyper space are stored in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process object.
00078 
00079     N.B. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> zeroed.
00080 
00081 Arguments:
00082 
00083     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00084 
00085     BasePriority - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00086 
00087     Affinity - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> set of processors on which children threads
00088         of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process can execute.
00089 
00090     DirectoryTableBase - Supplies a pointer to an array whose fist element
00091         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be loaded into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d5/editreg_8c.html#a68">Directory</a> Table Base
00092         <span class="keyword">register</span> when a child thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> dispatched <span class="keywordflow">for</span> execution and whose
00093         second element contains <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page table entry that maps hyper space.
00094 
00095     Enable - Supplies a <span class="keywordtype">boolean</span> value that determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">default</span>
00096         handling of data alignment exceptions <span class="keywordflow">for</span> child threads. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value
00097         of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> causes all data alignment exceptions to be automatically
00098         handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> causes all data alignment
00099         exceptions to be actually raised as exceptions.
00100 
00101 Return Value:
00102 
00103     None.
00104 
00105 --*/
00106 
00107 {
00108 
00109     <span class="comment">//</span>
00110     <span class="comment">// Initialize the standard dispatcher object header and set the initial</span>
00111     <span class="comment">// signal state of the process object.</span>
00112     <span class="comment">//</span>
00113 
00114     Process-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a160">ProcessObject</a>;
00115     Process-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d7/struct__KPROCESS.html">KPROCESS</a>) / <span class="keyword">sizeof</span>(LONG);
00116     InitializeListHead(&amp;Process-&gt;Header.WaitListHead);
00117 
00118     <span class="comment">//</span>
00119     <span class="comment">// Initialize the base priority, affinity, directory table base values,</span>
00120     <span class="comment">// autoalignment, and stack count.</span>
00121     <span class="comment">//</span>
00122     <span class="comment">// N.B. The distinguished value MAXSHORT is used to signify that no</span>
00123     <span class="comment">//      threads have been created for the process.</span>
00124     <span class="comment">//</span>
00125 
00126     Process-&gt;BasePriority = (SCHAR)BasePriority;
00127     Process-&gt;Affinity = Affinity;
00128     Process-&gt;AutoAlignment = Enable;
00129     Process-&gt;DirectoryTableBase[0] = DirectoryTableBase[0];
00130     Process-&gt;DirectoryTableBase[1] = DirectoryTableBase[1];
00131     Process-&gt;StackCount = MAXSHORT;
00132 
00133     <span class="comment">//</span>
00134     <span class="comment">// Initialize the stack count, profile listhead, ready queue list head,</span>
00135     <span class="comment">// accumulated runtime, process quantum, thread quantum, and thread list</span>
00136     <span class="comment">// head.</span>
00137     <span class="comment">//</span>
00138 
00139     InitializeListHead(&amp;Process-&gt;ProfileListHead);
00140     InitializeListHead(&amp;Process-&gt;ReadyListHead);
00141     InitializeListHead(&amp;Process-&gt;ThreadListHead);
00142     Process-&gt;ThreadQuantum = <a class="code" href="../../d4/d9/ke_8h.html#a3">THREAD_QUANTUM</a>;
00143 
00144     <span class="comment">//</span>
00145     <span class="comment">// Initialize the process state and set the thread processor selection</span>
00146     <span class="comment">// seed.</span>
00147     <span class="comment">//</span>
00148 
00149     Process-&gt;State = <a class="code" href="../../d4/d9/ke_8h.html#a405a186">ProcessInMemory</a>;
00150     Process-&gt;ThreadSeed = (UCHAR)KiQueryLowTickCount();
00151 
00152     <span class="comment">//</span>
00153     <span class="comment">// Initialize IopmBase and Iopl flag for this process (i386 only)</span>
00154     <span class="comment">//</span>
00155 
00156 <span class="preprocessor">#ifdef i386</span>
00157 <span class="preprocessor"></span>
00158     Process-&gt;IopmOffset = KiComputeIopmOffset(IO_ACCESS_MAP_NONE);
00159 
00160 <span class="preprocessor">#endif</span>
00161 <span class="preprocessor"></span>
00162     <span class="keywordflow">return</span>;
00163 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a274" doxytag="ke.h::KeInitializeProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Profile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>RangeSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BucketSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Segment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPROFILE_SOURCE&nbsp;</td>
          <td class="mdname" nowrap> <em>ProfileSource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KAFFINITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Affinity</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/profobj_8c-source.html#l00069">69</a> of file <a class="el" href="../../d1/d7/profobj_8c-source.html">profobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a402a180">ProfileObject</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00517">NtStartProfile()</a>.
<p>
<pre class="fragment"><div>00082                    :
00083 
00084     This function initializes a kernel profile object. The process,
00085     address range, bucket size, and buffer are set. The profile <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00086     set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> stopped state.
00087 
00088 Arguments:
00089 
00090     Profile - Supplies a pointer to <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> profile.
00091 
00092     Process - Supplies an optional pointer to a process object that
00093         describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address space to profile. If not specified,
00094         then all address spaces are included in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile.
00095 
00096     RangeBase - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first byte of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address
00097         range <span class="keywordflow">for</span> which profiling information <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be collected.
00098 
00099     RangeSize - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address range <span class="keywordflow">for</span> which profiling
00100         information <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be collected.  The RangeBase and RangeSize
00101         parameters are interpreted such that RangeBase &lt;= address &lt;
00102         RangeBase + RangeSize generates a profile hit.
00103 
00104     BucketSize - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> log base 2 of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of a profiling bucket.
00105         Thus, BucketSize = 2 yields 4-byte buckets, BucketSize = 7 yields
00106         128-byte buckets.
00107 
00108     Segment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> non-Flat code segment to profile.  If <span class="keyword">this</span>
00109         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> zero, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> flat profiling <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done.  This will <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a>
00110         be non-zero on an x86 machine.
00111 
00112     ProfileSource - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile interrupt source.
00113 
00114     ProfileAffinity - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> set of processor to count hits <span class="keywordflow">for</span>.
00115 
00116 Return Value:
00117 
00118     None.
00119 
00120 --*/
00121 
00122 {
00123 
00124 <span class="preprocessor">#if !defined(i386)</span>
00125 <span class="preprocessor"></span>
00126     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Segment == 0);
00127 
00128 <span class="preprocessor">#endif</span>
00129 <span class="preprocessor"></span>
00130     <span class="comment">//</span>
00131     <span class="comment">// Initialize the standard control object header.</span>
00132     <span class="comment">//</span>
00133 
00134     Profile-&gt;Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a180">ProfileObject</a>;
00135     Profile-&gt;Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d7/struct__KPROFILE.html">KPROFILE</a>);
00136 
00137     <span class="comment">//</span>
00138     <span class="comment">// Initialize the process address space, range base, range limit,</span>
00139     <span class="comment">// bucket shift count, and set started FALSE.</span>
00140     <span class="comment">//</span>
00141 
00142     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Process)) {
00143         Profile-&gt;Process = Process;
00144 
00145     } <span class="keywordflow">else</span> {
00146         Profile-&gt;Process = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00147     }
00148 
00149     Profile-&gt;RangeBase = RangeBase;
00150     Profile-&gt;RangeLimit = (PUCHAR)RangeBase + RangeSize;
00151     Profile-&gt;BucketShift = BucketSize - 2;
00152     Profile-&gt;Started = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00153     Profile-&gt;Segment = Segment;
00154     Profile-&gt;Source = (CSHORT)ProfileSource;
00155     Profile-&gt;Affinity = ProfileAffinity &amp; <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00156     <span class="keywordflow">if</span> (Profile-&gt;Affinity == 0) {
00157         Profile-&gt;Affinity = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00158     }
00159     <span class="keywordflow">return</span>;
00160 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a290" doxytag="ke.h::KeInitializeQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Queue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG <a class="el" href="../../d6/d0/cmdat_8c.html#a5">Count</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00036">36</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00099">FsRtlInitializeWorkerThread()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00051">NtCreateIoCompletion()</a>.
<p>
<pre class="fragment"><div>00043                    :
00044 
00045     This function initializes a kernel queue object.
00046 
00047 Arguments:
00048 
00049     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00050 
00051     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target maximum number of threads that should
00052         be concurrently active. If <span class="keyword">this</span> parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not specified,
00053         then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of processors <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.
00054 
00055 Return Value:
00056 
00057     None.
00058 
00059 --*/
00060 
00061 {
00062 
00063     <span class="comment">//</span>
00064     <span class="comment">// Initialize standard dispatcher object header and set initial</span>
00065     <span class="comment">// state of queue object.</span>
00066     <span class="comment">//</span>
00067 
00068     Queue-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a>;
00069     Queue-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d7/struct__KQUEUE.html">KQUEUE</a>) / <span class="keyword">sizeof</span>(LONG);
00070     Queue-&gt;Header.SignalState = 0;
00071     InitializeListHead(&amp;Queue-&gt;Header.WaitListHead);
00072 
00073     <span class="comment">//</span>
00074     <span class="comment">// Initialize queue listhead, the thread list head, the current number</span>
00075     <span class="comment">// of threads, and the target maximum number of threads.</span>
00076     <span class="comment">//</span>
00077 
00078     InitializeListHead(&amp;Queue-&gt;EntryListHead);
00079     InitializeListHead(&amp;Queue-&gt;ThreadListHead);
00080     Queue-&gt;CurrentCount = 0;
00081     <span class="keywordflow">if</span> (ARGUMENT_PRESENT((PVOID)(ULONG_PTR)Count)) {
00082         Queue-&gt;MaximumCount = <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00083 
00084     } <span class="keywordflow">else</span> {
00085         Queue-&gt;MaximumCount = <a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>;
00086     }
00087 
00088     <span class="keywordflow">return</span>;
00089 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a296" doxytag="ke.h::KeInitializeSemaphore" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeSemaphore           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Semaphore</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">39</a> of file <a class="el" href="../../d2/d5/semphobj_8c-source.html">semphobj.c</a>.
<p>
References <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a402a162">SemaphoreObject</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01706">DoResourceTest()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00762">ExAcquireResourceSharedLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01014">ExAcquireSharedStarveExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01165">ExAcquireSharedWaitForExclusive()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00172">ExInitializeResource()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00273">ExReinitializeResourceLite()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00215">FsRtlInitSystem()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00325">InitializePool()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00037">LpcpInitializePortQueue()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00123">NtCreateSemaphore()</a>, <a class="el" href="../../d4/d2/tob_8c-source.html#l00187">obtest()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, and <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>.
<p>
<pre class="fragment"><div>00047                    :
00048 
00049     This function initializes a kernel semaphore object. The initial
00050     count and limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> object are set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified values.
00051 
00052 Arguments:
00053 
00054     Semaphore - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
00055         semaphore.
00056 
00057     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial count value to be assigned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00058         semaphore.
00059 
00060     Limit - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum count value that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> semaphore
00061         can attain.
00062 
00063 Return Value:
00064 
00065     None.
00066 
00067 --*/
00068 
00069 {
00070 
00071     <span class="comment">//</span>
00072     <span class="comment">// Initialize standard dispatcher object header and set initial</span>
00073     <span class="comment">// count and maximum count values.</span>
00074     <span class="comment">//</span>
00075 
00076     Semaphore-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a162">SemaphoreObject</a>;
00077     Semaphore-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>) / <span class="keyword">sizeof</span>(LONG);
00078     Semaphore-&gt;Header.SignalState = <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>;
00079     InitializeListHead(&amp;Semaphore-&gt;Header.WaitListHead);
00080     Semaphore-&gt;Limit = Limit;
00081     <span class="keywordflow">return</span>;
00082 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a354" doxytag="ke.h::KeInitializeSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI KeInitializeSpinLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SpinLock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00188">CcInitializeVacbs()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00222">ExCreateCallback()</a>, <a class="el" href="../../d5/d4/logger_8c-source.html#l00030">ExCreateDebugLog()</a>, <a class="el" href="../../d0/d4/callperf_8c-source.html#l00028">ExInitializeCallData()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00408">ExInitializeNPagedLookasideList()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00172">ExInitializeResource()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00209">ExInitializeResourceLite()</a>, <a class="el" href="../../d1/d7/luid_8c-source.html#l00037">ExLuidInitialization()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00150">ExpResourceInitialization()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00281">ExpTimerInitialization()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00273">ExReinitializeResourceLite()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00888">FsRtlPrivateInitializeFileLock()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00677">InitializePool()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00038">IoErrInitSystem()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00061">IoInitializeRemoveLockEx()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00093">IopInitializePlugPlayServices()</a>, <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00091">IoVerifierInit()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00122">IovpTrackingDataCreateAndLock()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00089">IovpTrackingDataInit()</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00040">KeInitializeDeviceQueue()</a>, <a class="el" href="../../d5/d3/i386_2intobj_8c-source.html#l00086">KeInitializeInterrupt()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00168">KiAmdK6InitializeMTRR()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00124">MemPrintInitialize()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03121">MiInitializeDriverVerifierList()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01595">MiInitializeIoTrackers()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06591">MiInitializeLoadedModuleList()</a>, <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l00394">MiSessionCreateInternal()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00190">MmCreateProcessAddressSpace()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00050">RtlAllocateRemoveLock()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l01444">UdfMountVolume()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03047">ViInitializeEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a310" doxytag="ke.h::KeInitializeThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeInitializeThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>KernelStack</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a67">PKSYSTEM_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a66">PKSTART_ROUTINE</a> StartRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID StartContext&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT ContextFrame&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID Teb&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">43</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00039">KeInitializeApc()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">KeInitializeTimer()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02794">KeServiceDescriptorTable</a>, <a class="el" href="../../d9/d0/ppc_2thredini_8c-source.html#l00045">KiInitializeContextThread()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a135">KiSuspendNop()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00770">KiSuspendThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00282">_KWAIT_BLOCK::Object</a>, <a class="el" href="../../d4/d9/ke_8h.html#a403a181">OriginalApcEnvironment</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00204">PKKERNEL_ROUTINE</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00214">PKRUNDOWN_ROUTINE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00079">THREAD_WAIT_OBJECTS</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00084">TIMER_WAIT_BLOCK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00280">_KWAIT_BLOCK::WaitListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.
<p>
<pre class="fragment"><div>00056                    :
00057 
00058     This function initializes a thread object. The priority, affinity,
00059     and initial quantum are taken from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parent process object. The
00060     thread object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread list <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00061     parent process.
00062 
00063     N.B. This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> carefully written so that <span class="keywordflow">if</span> an access violation
00064         occurs <span class="keywordflow">while</span> reading <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified context frame, then no kernel
00065         data structures will have been modified. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> responsibility
00066         of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller to handle <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception and provide necessary clean
00067         up.
00068 
00069     N.B. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> zeroed.
00070 
00071 Arguments:
00072 
00073     Thread - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00074 
00075     KernelStack - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base of a kernel stack on which
00076         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context frame <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be constructed.
00077 
00078     SystemRoutine - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system function that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00079         called when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> first scheduled <span class="keywordflow">for</span> execution.
00080 
00081     StartRoutine - Supplies an optional pointer to a function that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00082         called after <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system has finished initializing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread. This
00083         parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a system thread and will
00084         execute totally in kernel mode.
00085 
00086     StartContext - Supplies an optional pointer to an arbitrary data structure
00087         which will be passed to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> StartRoutine as a parameter. This
00088         parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a system thread and will
00089         execute totally in kernel mode.
00090 
00091     ContextFrame - Supplies an optional pointer a context frame which contains
00092         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial user mode state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread. This parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified
00093         <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a user thread and will execute in user mode. If <span class="keyword">this</span>
00094         parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not specified, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Teb parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> ignored.
00095 
00096     Teb - Supplies an optional pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user mode thread environment
00097         block. This parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a user thread and
00098         will execute in user mode. This parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> ignored <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ContextFrame
00099         parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not specified.
00100 
00101     Process - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00102 
00103 Return Value:
00104 
00105     None.
00106 
00107 --*/
00108 
00109 {
00110 
00111     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00112     KIRQL OldIrql;
00113     <a class="code" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer;
00114     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> WaitBlock;
00115 
00116     <span class="comment">//</span>
00117     <span class="comment">// Initialize the standard dispatcher object header and set the initial</span>
00118     <span class="comment">// state of the thread object.</span>
00119     <span class="comment">//</span>
00120 
00121     Thread-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a163">ThreadObject</a>;
00122     Thread-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>) / <span class="keyword">sizeof</span>(LONG);
00123     InitializeListHead(&amp;Thread-&gt;Header.WaitListHead);
00124 
00125     <span class="comment">//</span>
00126     <span class="comment">// Initialize the owned mutant listhead.</span>
00127     <span class="comment">//</span>
00128 
00129     InitializeListHead(&amp;Thread-&gt;MutantListHead);
00130 
00131     <span class="comment">//</span>
00132     <span class="comment">// Initialize the thread field of all builtin wait blocks.</span>
00133     <span class="comment">//</span>
00134 
00135     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; (<a class="code" href="../../d4/d9/ke_8h.html#a6">THREAD_WAIT_OBJECTS</a> + 1); <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00136         Thread-&gt;WaitBlock[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].Thread = Thread;
00137     }
00138 
00139     <span class="comment">//</span>
00140     <span class="comment">// Initialize the alerted, preempted, debugactive, autoalignment,</span>
00141     <span class="comment">// kernel stack resident, enable kernel stack swap, and process</span>
00142     <span class="comment">// ready queue boolean values.</span>
00143     <span class="comment">//</span>
00144     <span class="comment">// N.B. Only nonzero values are initialized.</span>
00145     <span class="comment">//</span>
00146 
00147     Thread-&gt;AutoAlignment = Process-&gt;AutoAlignment;
00148     Thread-&gt;EnableStackSwap = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00149     Thread-&gt;KernelStackResident = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00150 
00151     <span class="comment">//</span>
00152     <span class="comment">// Set the system service table pointer to the address of the static</span>
00153     <span class="comment">// system service descriptor table. If the thread is later converted</span>
00154     <span class="comment">// to a Win32 thread this pointer will be change to a pointer to the</span>
00155     <span class="comment">// shadow system service descriptor table.</span>
00156     <span class="comment">//</span>
00157 
00158     Thread-&gt;ServiceTable = (PVOID)&amp;<a class="code" href="../../d4/d9/ke_8h.html#a145">KeServiceDescriptorTable</a>[0];
00159 
00160     <span class="comment">//</span>
00161     <span class="comment">// Initialize the APC state pointers, the current APC state, the saved</span>
00162     <span class="comment">// APC state, and enable APC queuing.</span>
00163     <span class="comment">//</span>
00164 
00165     Thread-&gt;ApcStatePointer[0] = &amp;Thread-&gt;ApcState;
00166     Thread-&gt;ApcStatePointer[1] = &amp;Thread-&gt;SavedApcState;
00167     InitializeListHead(&amp;Thread-&gt;ApcState.ApcListHead[KernelMode]);
00168     InitializeListHead(&amp;Thread-&gt;ApcState.ApcListHead[UserMode]);
00169     Thread-&gt;ApcState.Process = Process;
00170     Thread-&gt;ApcQueueable = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00171 
00172     <span class="comment">//</span>
00173     <span class="comment">// Initialize the kernel mode suspend APC and the suspend semaphore object.</span>
00174     <span class="comment">// and the builtin wait timeout timer object.</span>
00175     <span class="comment">//</span>
00176 
00177     <a class="code" href="../../d5/d7/apcobj_8c.html#a1">KeInitializeApc</a>(&amp;Thread-&gt;SuspendApc,
00178                     Thread,
00179                     OriginalApcEnvironment,
00180                     (PKKERNEL_ROUTINE)KiSuspendNop,
00181                     (PKRUNDOWN_ROUTINE)NULL,
00182                     KiSuspendThread,
00183                     KernelMode,
00184                     NULL);
00185 
00186     <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(&amp;Thread-&gt;SuspendSemaphore, 0L, 2L);
00187 
00188     <span class="comment">//</span>
00189     <span class="comment">// Initialize the builtin timer trimer wait wait block.</span>
00190     <span class="comment">//</span>
00191     <span class="comment">// N.B. This is the only time the wait block is initialized sincs this</span>
00192     <span class="comment">//      information is constant.</span>
00193     <span class="comment">//</span>
00194 
00195     Timer = &amp;Thread-&gt;Timer;
00196     <a class="code" href="../../d3/d2/timerobj_8c.html#a1">KeInitializeTimer</a>(Timer);
00197     WaitBlock = &amp;Thread-&gt;WaitBlock[<a class="code" href="../../d4/d9/ke_8h.html#a9">TIMER_WAIT_BLOCK</a>];
00198     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o2">Object</a> = Timer;
00199     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a> = (CSHORT)STATUS_TIMEOUT;
00200     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> = WaitAny;
00201     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>.Flink = &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>;
00202     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>.Blink = &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>;
00203 
00204     <span class="comment">//</span>
00205     <span class="comment">// Initialize the APC queue spinlock.</span>
00206     <span class="comment">//</span>
00207 
00208     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;Thread-&gt;ApcQueueLock);
00209 
00210     <span class="comment">//</span>
00211     <span class="comment">// Initialize the Thread Environment Block (TEB) pointer (can be NULL).</span>
00212     <span class="comment">//</span>
00213 
00214     Thread-&gt;Teb = Teb;
00215 
00216     <span class="comment">//</span>
00217     <span class="comment">// Set the initial kernel stack and the initial thread context.</span>
00218     <span class="comment">//</span>
00219 
00220     Thread-&gt;InitialStack = KernelStack;
00221     Thread-&gt;StackBase = KernelStack;
00222     Thread-&gt;StackLimit = (PVOID)((ULONG_PTR)KernelStack - KERNEL_STACK_SIZE);
00223     <a class="code" href="../../d8/d1/ppc_2thredini_8c.html#a2">KiInitializeContextThread</a>(Thread,
00224                               SystemRoutine,
00225                               StartRoutine,
00226                               StartContext,
00227                               ContextFrame);
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">// Set the base thread priority, the thread priority, the thread affinity,</span>
00231     <span class="comment">// the thread quantum, and the scheduling state.</span>
00232     <span class="comment">//</span>
00233 
00234     Thread-&gt;BasePriority = Process-&gt;BasePriority;
00235     Thread-&gt;Priority = Thread-&gt;BasePriority;
00236     Thread-&gt;Affinity = Process-&gt;Affinity;
00237     Thread-&gt;UserAffinity = Process-&gt;Affinity;
00238     Thread-&gt;SystemAffinityActive = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00239     Thread-&gt;Quantum = Process-&gt;ThreadQuantum;
00240     Thread-&gt;State = <a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>;
00241     Thread-&gt;DisableBoost = Process-&gt;DisableBoost;
00242 
00243 <span class="preprocessor">#ifdef i386</span>
00244 <span class="preprocessor"></span>
00245     Thread-&gt;Iopl = Process-&gt;Iopl;
00246 
00247 <span class="preprocessor">#endif</span>
00248 <span class="preprocessor"></span>
00249     <span class="comment">//</span>
00250     <span class="comment">// Lock the dispatcher database, insert the thread in the process</span>
00251     <span class="comment">// thread list, increment the kernel stack count, and unlock the</span>
00252     <span class="comment">// dispatcher database.</span>
00253     <span class="comment">//</span>
00254     <span class="comment">// N.B. The distinguished value MAXSHORT is used to signify that no</span>
00255     <span class="comment">//      threads have been created for a process.</span>
00256     <span class="comment">//</span>
00257 
00258     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00259     InsertTailList(&amp;Process-&gt;ThreadListHead, &amp;Thread-&gt;ThreadListEntry);
00260     <span class="keywordflow">if</span> (Process-&gt;StackCount == MAXSHORT) {
00261         Process-&gt;StackCount = 1;
00262 
00263     } <span class="keywordflow">else</span> {
00264         Process-&gt;StackCount += 1;
00265     }
00266 
00267     <span class="comment">//</span>
00268     <span class="comment">// Initialize the ideal processor number for the thread.</span>
00269     <span class="comment">//</span>
00270     <span class="comment">//  N.B. This must be done under the dispatcher lock to prevent byte</span>
00271     <span class="comment">//      granularity problems on Alpha.</span>
00272     <span class="comment">//</span>
00273 
00274     Process-&gt;ThreadSeed += 1;
00275     Thread-&gt;IdealProcessor = (UCHAR)(Process-&gt;ThreadSeed % <a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>);
00276     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00277     <span class="keywordflow">return</span>;
00278 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a341" doxytag="ke.h::KeInitializeTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Timer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">43</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00075">KeInitializeTimerEx()</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00431">ExpWorkerThreadBalanceManager()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00760">IopErrorLogQueueRequest()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03270">MiInitializeSpecialPoolCriteria()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.
<p>
<pre class="fragment"><div>00049                    :
00050 
00051     This function initializes a kernel timer object.
00052 
00053 Arguments:
00054 
00055     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00056 
00057 Return Value:
00058 
00059     None.
00060 
00061 --*/
00062 
00063 {
00064 
00065     <span class="comment">//</span>
00066     <span class="comment">// Initialize extended timer object with a type of notification and a</span>
00067     <span class="comment">// period of zero.</span>
00068     <span class="comment">//</span>
00069 
00070     <a class="code" href="../../d3/d2/timerobj_8c.html#a2">KeInitializeTimerEx</a>(Timer, NotificationTimer);
00071     <span class="keywordflow">return</span>;
00072 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a342" doxytag="ke.h::KeInitializeTimerEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeInitializeTimerEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Timer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN TIMER_TYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00075">75</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a402a165">TimerNotificationObject</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">KeInitializeTimer()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03020">VerifierKeInitializeTimerEx()</a>.
<p>
<pre class="fragment"><div>00082                    :
00083 
00084     This function initializes an extended kernel timer object.
00085 
00086 Arguments:
00087 
00088     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00089 
00090     Type - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of timer object; NotificationTimer or
00091         SynchronizationTimer;
00092 
00093 Return Value:
00094 
00095     None.
00096 
00097 --*/
00098 
00099 {
00100     <span class="comment">//</span>
00101     <span class="comment">// Initialize standard dispatcher object header and set initial</span>
00102     <span class="comment">// state of timer.</span>
00103     <span class="comment">//</span>
00104 
00105     Timer-&gt;Header.Type = <a class="code" href="../../d4/d9/ke_8h.html#a402a165">TimerNotificationObject</a> + Type;
00106     Timer-&gt;Header.Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00107     Timer-&gt;Header.Size = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>) / <span class="keyword">sizeof</span>(LONG);
00108     Timer-&gt;Header.SignalState = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00109 
00110 <span class="preprocessor">#if DBG</span>
00111 <span class="preprocessor"></span>
00112     Timer-&gt;TimerListEntry.Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00113     Timer-&gt;TimerListEntry.Blink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00114 
00115 <span class="preprocessor">#endif</span>
00116 <span class="preprocessor"></span>
00117     InitializeListHead(&amp;Timer-&gt;Header.WaitListHead);
00118     Timer-&gt;DueTime.QuadPart = 0;
00119     Timer-&gt;Period = 0;
00120     <span class="keywordflow">return</span>;
00121 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a361" doxytag="ke.h::KeInitSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeInitSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00041">41</a> of file <a class="el" href="../../d3/d9/kiinit_8c-source.html">kiinit.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>, <a class="el" href="../../d0/d0/ki_8h.html#a87">KiChannelInitialization()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a120">KiInitMachineDependent()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00047                    :
00048 
00049     This function initializes executive structures implemented by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00050     kernel.
00051 
00052     N.B. This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> called during phase 1 initialization.
00053 
00054 Arguments:
00055 
00056     None.
00057 
00058 Return Value:
00059 
00060     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> initialization <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successful. Otherwise,
00061     a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00062 
00063 --*/
00064 
00065 {
00066 
00067     BOOLEAN <a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00068 
00069     <span class="comment">//</span>
00070     <span class="comment">// Initialize the executive objects.</span>
00071     <span class="comment">//</span>
00072 
00073 <span class="preprocessor">#if 0</span>
00074 <span class="preprocessor"></span>
00075     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a> = <a class="code" href="../../d0/d0/ki_8h.html#a87">KiChannelInitialization</a>()) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00076         KdPrint((<span class="stringliteral">"Kernel: Channel initialization failed\n"</span>));
00077     }
00078 
00079 <span class="preprocessor">#endif</span>
00080 <span class="preprocessor"></span>
00081 <span class="preprocessor">#if defined(i386)</span>
00082 <span class="preprocessor"></span>
00083     <span class="comment">//</span>
00084     <span class="comment">// Perform platform dependent initialization.</span>
00085     <span class="comment">//</span>
00086 
00087     <a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a> = <a class="code" href="../../d0/d0/ki_8h.html#a120">KiInitMachineDependent</a>();
00088 
00089 <span class="preprocessor">#endif</span>
00090 <span class="preprocessor"></span>
00091 
00092     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a191">Initialized</a>;
00093 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a266" doxytag="ke.h::KeInsertByKeyDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeInsertByKeyDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueueEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SortKey</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00145">145</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00034">ASSERT_DEVICE_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a71">KDEVICE_QUEUE_ENTRY</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00403">_KDEVICE_QUEUE_ENTRY::SortKey</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10735">IoStartPacket()</a>.
<p>
<pre class="fragment"><div>00153                    :
00154 
00155     This function inserts a device queue entry into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified device
00156     queue according to a sort key. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not busy, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00157     set busy and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not placed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue. Otherwise
00158     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue at a position such
00159     that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified sort key <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> greater than or equal to its predecessor
00160     and less than its successor.
00161 
00162     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called from <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00163 
00164 Arguments:
00165 
00166     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device queue.
00167 
00168     DeviceQueueEntry - Supplies a pointer to a device queue entry.
00169 
00170     SortKey - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sort key by which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> position to insert <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device
00171         queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be determined.
00172 
00173 Return Value:
00174 
00175     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not busy, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise a
00176     value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00177 
00178 --*/
00179 
00180 {
00181 
00182     BOOLEAN Inserted;
00183     PLIST_ENTRY NextEntry;
00184     <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> QueueEntry;
00185 
00186     <a class="code" href="../../d7/d7/devquobj_8c.html#a0">ASSERT_DEVICE_QUEUE</a>(DeviceQueue);
00187     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// Lock specified device queue.</span>
00191     <span class="comment">//</span>
00192 
00193     KiAcquireSpinLock(&amp;DeviceQueue-&gt;Lock);
00194 
00195     <span class="comment">//</span>
00196     <span class="comment">// Insert the specified device queue entry in the device queue at the</span>
00197     <span class="comment">// position specified by the sort key if the device queue is busy.</span>
00198     <span class="comment">// Otherwise set the device queue busy an don't insert the device queue</span>
00199     <span class="comment">// entry.</span>
00200     <span class="comment">//</span>
00201 
00202     DeviceQueueEntry-&gt;SortKey = SortKey;
00203     <span class="keywordflow">if</span> (DeviceQueue-&gt;Busy == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00204         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00205         NextEntry = DeviceQueue-&gt;DeviceListHead.Flink;
00206         <span class="keywordflow">while</span> (NextEntry != &amp;DeviceQueue-&gt;DeviceListHead) {
00207             QueueEntry = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">KDEVICE_QUEUE_ENTRY</a>,
00208                                            DeviceListEntry);
00209             <span class="keywordflow">if</span> (SortKey &lt; QueueEntry-&gt;<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html#o1">SortKey</a>) {
00210                 <span class="keywordflow">break</span>;
00211             }
00212             NextEntry = NextEntry-&gt;Flink;
00213         }
00214         NextEntry = NextEntry-&gt;Blink;
00215         InsertHeadList(NextEntry, &amp;DeviceQueueEntry-&gt;DeviceListEntry);
00216     } <span class="keywordflow">else</span> {
00217         DeviceQueue-&gt;Busy = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00218         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00219     }
00220     DeviceQueueEntry-&gt;Inserted = Inserted;
00221     KiReleaseSpinLock(&amp;DeviceQueue-&gt;Lock);
00222     <span class="keywordflow">return</span> Inserted;
00223 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a265" doxytag="ke.h::KeInsertDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeInsertDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueueEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00083">83</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00034">ASSERT_DEVICE_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a72">PKDEVICE_QUEUE_ENTRY</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00240">IoAllocateController()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10735">IoStartPacket()</a>.
<p>
<pre class="fragment"><div>00090                    :
00091 
00092     This function inserts a device queue entry at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tail of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00093     device queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not busy, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set busy and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry
00094     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not placed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed
00095     at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue.
00096 
00097     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called from <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00098 
00099 Arguments:
00100 
00101     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device queue.
00102 
00103     DeviceQueueEntry - Supplies a pointer to a device queue entry.
00104 
00105 Return Value:
00106 
00107     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not busy, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise a
00108     value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00109 
00110 --*/
00111 
00112 {
00113 
00114     BOOLEAN Inserted;
00115 
00116     <a class="code" href="../../d7/d7/devquobj_8c.html#a0">ASSERT_DEVICE_QUEUE</a>(DeviceQueue);
00117     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00118 
00119     <span class="comment">//</span>
00120     <span class="comment">// Lock specified device queue.</span>
00121     <span class="comment">//</span>
00122 
00123     KiAcquireSpinLock(&amp;DeviceQueue-&gt;Lock);
00124 
00125     <span class="comment">//</span>
00126     <span class="comment">// Insert the specified device queue entry at the end of the device queue</span>
00127     <span class="comment">// if the device queue is busy. Otherwise set the device queue busy and</span>
00128     <span class="comment">// don't insert the device queue entry.</span>
00129     <span class="comment">//</span>
00130 
00131     <span class="keywordflow">if</span> (DeviceQueue-&gt;Busy == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00132         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00133         InsertTailList(&amp;DeviceQueue-&gt;DeviceListHead,
00134                        &amp;DeviceQueueEntry-&gt;DeviceListEntry);
00135     } <span class="keywordflow">else</span> {
00136         DeviceQueue-&gt;Busy = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00137         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00138     }
00139     DeviceQueueEntry-&gt;Inserted = Inserted;
00140     KiReleaseSpinLock(&amp;DeviceQueue-&gt;Lock);
00141     <span class="keywordflow">return</span> Inserted;
00142 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a293" doxytag="ke.h::KeInsertHeadQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeInsertHeadQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Queue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00181">181</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00033">ASSERT_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00710">KiInsertQueue()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00188                    :
00189 
00190     This function inserts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue object entry
00191     list and attempts to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait of a single waiter.
00192 
00193     N.B. The wait discipline <span class="keywordflow">for</span> Queue object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> LIFO.
00194 
00195 Arguments:
00196 
00197     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> Queue.
00198 
00199     Entry - Supplies a pointer to a list entry that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00200         queue object entry list.
00201 
00202 Return Value:
00203 
00204     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Queue object.
00205 
00206 --*/
00207 
00208 {
00209 
00210     KIRQL OldIrql;
00211     LONG OldState;
00212 
00213     <a class="code" href="../../d8/d3/queueobj_8c.html#a0">ASSERT_QUEUE</a>(Queue);
00214     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00215 
00216     <span class="comment">//</span>
00217     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00218     <span class="comment">//</span>
00219 
00220     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00221 
00222     <span class="comment">//</span>
00223     <span class="comment">// Insert the specified entry in the queue object entry list.</span>
00224     <span class="comment">//</span>
00225 
00226     OldState = <a class="code" href="../../d8/d3/queueobj_8c.html#a8">KiInsertQueue</a>(Queue, Entry, TRUE);
00227 
00228     <span class="comment">//</span>
00229     <span class="comment">// Unlock the dispather database, lower IRQL to the previous level, and</span>
00230     <span class="comment">// return signal state of Queue object.</span>
00231     <span class="comment">//</span>
00232 
00233     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00234     <span class="keywordflow">return</span> OldState;
00235 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a292" doxytag="ke.h::KeInsertQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeInsertQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Queue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00124">124</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00033">ASSERT_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00710">KiInsertQueue()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">ExQueueWorkItem()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00215">FsRtlpPostStackOverflow()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01019">IopCompleteRequest()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00671">IoSetIoCompletion()</a>.
<p>
<pre class="fragment"><div>00131                    :
00132 
00133     This function inserts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue object entry
00134     list and attempts to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait of a single waiter.
00135 
00136     N.B. The wait discipline <span class="keywordflow">for</span> Queue object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> LIFO.
00137 
00138 Arguments:
00139 
00140     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> Queue.
00141 
00142     Entry - Supplies a pointer to a list entry that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00143         queue object entry list.
00144 
00145 Return Value:
00146 
00147     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Queue object.
00148 
00149 --*/
00150 
00151 {
00152 
00153     KIRQL OldIrql;
00154     LONG OldState;
00155 
00156     <a class="code" href="../../d8/d3/queueobj_8c.html#a0">ASSERT_QUEUE</a>(Queue);
00157     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00158 
00159     <span class="comment">//</span>
00160     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00161     <span class="comment">//</span>
00162 
00163     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">// Insert the specified entry in the queue object entry list.</span>
00167     <span class="comment">//</span>
00168 
00169     OldState = <a class="code" href="../../d8/d3/queueobj_8c.html#a8">KiInsertQueue</a>(Queue, Entry, FALSE);
00170 
00171     <span class="comment">//</span>
00172     <span class="comment">// Unlock the dispather database, lower IRQL to the previous level, and</span>
00173     <span class="comment">// return signal state of Queue object.</span>
00174     <span class="comment">//</span>
00175 
00176     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00177     <span class="keywordflow">return</span> OldState;
00178 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a257" doxytag="ke.h::KeInsertQueueApc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeInsertQueueApc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__KAPC.html">PRKAPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Apc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00217">217</a> of file <a class="el" href="../../d6/d6/apcobj_8c-source.html">apcobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00659">_KTHREAD::ApcQueueable</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00033">ASSERT_APC</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d7/d6/apcsup_8c-source.html#l00223">KiInsertQueueApc()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00166">ExpTimerDpcRoutine()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01019">IopCompleteRequest()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08769">IoRaiseHardError()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00454">KeSetAutoAlignmentThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00056">NtQueueApcThread()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00631">PspExitNormalApc()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00160">PspTerminateThreadByPointer()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01800">PspUserThreadStartup()</a>.
<p>
<pre class="fragment"><div>00226                    :
00227 
00228     This function inserts an APC object into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC queue specifed by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00229     thread and processor mode fields of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object
00230     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already in an APC queue or APC queuing <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disabled, then no operation
00231     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified queue
00232     and appropriate scheduling decisions are <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a>.
00233 
00234 Arguments:
00235 
00236     Apc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> APC.
00237 
00238     SystemArgument1, SystemArgument2 - Supply a set of two arguments that
00239         contain untyped data provided by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> executive.
00240 
00241     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied <span class="keywordflow">if</span>
00242         queuing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC causes a thread wait to be satisfied.
00243 
00244 Return Value:
00245 
00246     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already in an APC queue or APC queuing <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disabled,
00247     then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00248 
00249 --*/
00250 
00251 {
00252 
00253     BOOLEAN Inserted;
00254     KIRQL OldIrql;
00255     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00256 
00257     <a class="code" href="../../d5/d7/apcobj_8c.html#a0">ASSERT_APC</a>(Apc);
00258     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00259 
00260     <span class="comment">//</span>
00261     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00262     <span class="comment">//</span>
00263 
00264     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00265 
00266     <span class="comment">//</span>
00267     <span class="comment">// If APC queuing is disabled, then set inserted to FALSE. Else save</span>
00268     <span class="comment">// system parameter values in APC object, and attempt to queue APC.</span>
00269     <span class="comment">//</span>
00270 
00271     Thread = Apc-&gt;Thread;
00272     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o59">ApcQueueable</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00273         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00274 
00275     } <span class="keywordflow">else</span> {
00276         Apc-&gt;SystemArgument1 = SystemArgument1;
00277         Apc-&gt;SystemArgument2 = SystemArgument2;
00278         Inserted = <a class="code" href="../../d0/d0/ki_8h.html#a123">KiInsertQueueApc</a>(Apc, Increment);
00279     }
00280 
00281     <span class="comment">//</span>
00282     <span class="comment">// Unlock the dispatcher database, lower IRQL to its previous value,</span>
00283     <span class="comment">// and return whether APC object was inserted in APC queue.</span>
00284     <span class="comment">//</span>
00285 
00286     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00287     <span class="keywordflow">return</span> Inserted;
00288 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a260" doxytag="ke.h::KeInsertQueueDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeInsertQueueDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00089">89</a> of file <a class="el" href="../../d5/d0/dpcobj_8c-source.html">dpcobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00034">ASSERT_DPC</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a77a74">HighImportance</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00280">IPI_DPC</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00253">KiIpiSend()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d0/d4/intsupc_8c-source.html#l00159">KiRequestSoftwareInterrupt()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a77a72">LowImportance</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l01420">MAXIMUM_PROCESSORS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00381">KdExitDebugger()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00285">KeSetTimerEx()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, and <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00333">KiTimerListExpire()</a>.
<p>
<pre class="fragment"><div>00097                    :
00098 
00099     This function inserts a DPC object into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object
00100     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue, then no operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Otherwise,
00101     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue and a dispatch interrupt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00102     requested.
00103 
00104 Arguments:
00105 
00106     Dpc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00107 
00108     SystemArgument1, SystemArgument2  - Supply a set of two arguments that
00109         contain untyped data provided by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> executive.
00110 
00111 Return Value:
00112 
00113     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> already in a DPC queue, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00114     returned. Otherwise a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00115 
00116 --*/
00117 
00118 {
00119 
00120     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00121     PKSPIN_LOCK <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>;
00122     KIRQL OldIrql;
00123     PKPRCB Prcb;
00124     ULONG Processor;
00125 
00126     <a class="code" href="../../d4/d1/dpcobj_8c.html#a0">ASSERT_DPC</a>(Dpc);
00127 
00128     <span class="comment">//</span>
00129     <span class="comment">// Disable interrupts.</span>
00130     <span class="comment">//</span>
00131 
00132     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">// Acquire the DPC queue lock for the specified target processor.</span>
00136     <span class="comment">//</span>
00137 
00138 <span class="preprocessor">#if !defined(NT_UP)</span>
00139 <span class="preprocessor"></span>
00140     <span class="keywordflow">if</span> (Dpc-&gt;Number &gt;= <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a>) {
00141         Processor = Dpc-&gt;Number - <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a>;
00142         Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[Processor];
00143 
00144     } <span class="keywordflow">else</span> {
00145         Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00146     }
00147 
00148     KiAcquireSpinLock(&amp;Prcb-&gt;DpcLock);
00149 
00150 <span class="preprocessor">#else</span>
00151 <span class="preprocessor"></span>
00152     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00153 
00154 <span class="preprocessor">#endif</span>
00155 <span class="preprocessor"></span>
00156     <span class="comment">//</span>
00157     <span class="comment">// If the DPC object is not in a DPC queue, then store the system</span>
00158     <span class="comment">// arguments, insert the DPC object in the DPC queue, increment the</span>
00159     <span class="comment">// number of DPCs queued to the target processor, increment the DPC</span>
00160     <span class="comment">// queue depth, set the address of the DPC target DPC spinlock, and</span>
00161     <span class="comment">// request a dispatch interrupt if appropriate.</span>
00162     <span class="comment">//</span>
00163 
00164     <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> = InterlockedCompareExchangePointer(&amp;Dpc-&gt;Lock, &amp;Prcb-&gt;DpcLock, NULL)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00165         Prcb-&gt;DpcCount += 1;
00166         Prcb-&gt;DpcQueueDepth += 1;
00167         Dpc-&gt;SystemArgument1 = SystemArgument1;
00168         Dpc-&gt;SystemArgument2 = SystemArgument2;
00169 
00170         <span class="comment">//</span>
00171         <span class="comment">// If the DPC is of high importance, then insert the DPC at the</span>
00172         <span class="comment">// head of the DPC queue. Otherwise, insert the DPC at the end</span>
00173         <span class="comment">// of the DPC queue.</span>
00174         <span class="comment">//</span>
00175 
00176         <span class="keywordflow">if</span> (Dpc-&gt;Importance == <a class="code" href="../../d0/d9/ntosdef_8h.html#a77a74">HighImportance</a>) {
00177             InsertHeadList(&amp;Prcb-&gt;DpcListHead, &amp;Dpc-&gt;DpcListEntry);
00178 
00179         } <span class="keywordflow">else</span> {
00180             InsertTailList(&amp;Prcb-&gt;DpcListHead, &amp;Dpc-&gt;DpcListEntry);
00181         }
00182         <span class="comment">//</span>
00183         <span class="comment">// A memory barrier is required here to synchronize with retire DPC</span>
00184         <span class="comment">// list, which clears DpcRoutineActive and DpcInterruptRequested</span>
00185         <span class="comment">// without owning the dispatcher lock.</span>
00186         <span class="comment">//</span>
00187 
00188 <span class="preprocessor">#if defined(_ALPHA_) &amp;&amp; !defined(NT_UP)</span>
00189 <span class="preprocessor"></span>
00190         __MB();
00191 
00192 <span class="preprocessor">#endif</span>
00193 <span class="preprocessor"></span>
00194         <span class="comment">//</span>
00195         <span class="comment">// If a DPC routine is not active on the target processor, then</span>
00196         <span class="comment">// request a dispatch interrupt if appropriate.</span>
00197         <span class="comment">//</span>
00198 
00199         <span class="keywordflow">if</span> ((Prcb-&gt;DpcRoutineActive == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) &amp;&amp;
00200             (Prcb-&gt;DpcInterruptRequested == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00201 
00202             <span class="comment">//</span>
00203             <span class="comment">// Request a dispatch interrupt on the current processor if</span>
00204             <span class="comment">// the DPC is not of low importance, the length of the DPC</span>
00205             <span class="comment">// queue has exceeded the maximum threshold, or if the DPC</span>
00206             <span class="comment">// request rate is below the minimum threshold.</span>
00207             <span class="comment">//</span>
00208 
00209 <span class="preprocessor">#if defined(NT_UP)</span>
00210 <span class="preprocessor"></span>
00211             <span class="keywordflow">if</span> ((Dpc-&gt;Importance != <a class="code" href="../../d0/d9/ntosdef_8h.html#a77a72">LowImportance</a>) ||
00212                 (Prcb-&gt;DpcQueueDepth &gt;= Prcb-&gt;MaximumDpcQueueDepth) ||
00213                 (Prcb-&gt;DpcRequestRate &lt; Prcb-&gt;MinimumDpcRate)) {
00214                 Prcb-&gt;DpcInterruptRequested = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00215                 <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(DISPATCH_LEVEL);
00216             }
00217 
00218             <span class="comment">//</span>
00219             <span class="comment">// If the DPC is being queued to another processor and the</span>
00220             <span class="comment">// DPC is of high importance, or the length of the other</span>
00221             <span class="comment">// processor's DPC queue has exceeded the maximum threshold,</span>
00222             <span class="comment">// then request a dispatch interrupt.</span>
00223             <span class="comment">//</span>
00224 
00225 <span class="preprocessor">#else</span>
00226 <span class="preprocessor"></span>
00227             <span class="keywordflow">if</span> (Prcb != <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()) {
00228                 <span class="keywordflow">if</span> (((Dpc-&gt;Importance == <a class="code" href="../../d0/d9/ntosdef_8h.html#a77a74">HighImportance</a>) ||
00229                      (Prcb-&gt;DpcQueueDepth &gt;= Prcb-&gt;MaximumDpcQueueDepth))) {
00230                     Prcb-&gt;DpcInterruptRequested = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00231                     <a class="code" href="../../d0/d0/ki_8h.html#a90">KiIpiSend</a>((KAFFINITY)(1 &lt;&lt; Processor), IPI_DPC);
00232                 }
00233 
00234             } <span class="keywordflow">else</span> {
00235 
00236                 <span class="comment">//</span>
00237                 <span class="comment">// Request a dispatch interrupt on the current processor if</span>
00238                 <span class="comment">// the DPC is not of low importance, the length of the DPC</span>
00239                 <span class="comment">// queue has exceeded the maximum threshold, or if the DPC</span>
00240                 <span class="comment">// request rate is below the minimum threshold.</span>
00241                 <span class="comment">//</span>
00242 
00243                 <span class="keywordflow">if</span> ((Dpc-&gt;Importance != <a class="code" href="../../d0/d9/ntosdef_8h.html#a77a72">LowImportance</a>) ||
00244                     (Prcb-&gt;DpcQueueDepth &gt;= Prcb-&gt;MaximumDpcQueueDepth) ||
00245                     (Prcb-&gt;DpcRequestRate &lt; Prcb-&gt;MinimumDpcRate)) {
00246                     Prcb-&gt;DpcInterruptRequested = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00247                     <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(DISPATCH_LEVEL);
00248                 }
00249             }
00250 
00251 <span class="preprocessor">#endif</span>
00252 <span class="preprocessor"></span>
00253         }
00254      }
00255 
00256      <span class="comment">//</span>
00257      <span class="comment">// Release the DPC lock, enable interrupts, and return whether the</span>
00258      <span class="comment">// DPC was queued or not.</span>
00259      <span class="comment">//</span>
00260 
00261 <span class="preprocessor">#if !defined(NT_UP)</span>
00262 <span class="preprocessor"></span>
00263      KiReleaseSpinLock(&amp;Prcb-&gt;DpcLock);
00264 
00265 <span class="preprocessor">#endif</span>
00266 <span class="preprocessor"></span>
00267      <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00268      <span class="keywordflow">return</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00269 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a373" doxytag="ke.h::KeInvalidAccessAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN FASTCALL KeInvalidAccessAllowed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID TrapInformation&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>OPTIONAL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d4/ia64_2trapc_8c-source.html#l00056">KiMemoryFault()</a>, and <a class="el" href="../../d5/d0/mmfault_8c-source.html#l00041">MmAccessFault()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a279" doxytag="ke.h::KePulseEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KePulseEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00167">167</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00243">MiUnmapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02234">MiWriteComplete()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06284">MmLockPagableSectionByHandle()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07065">MmUnlockPagableImageSection()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00412">NtPulseEvent()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l03358">xxxSwitchDesktop()</a>.
<p>
<pre class="fragment"><div>00175                    :
00176 
00177     This function atomically sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to
00178     Signaled, attempts to satisfy as many Waits as possible, and then resets
00179     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object to Not-Signaled. The previous signal
00180     state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00181 
00182 Arguments:
00183 
00184     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00185 
00186     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00187        <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event causes a Wait to be satisfied.
00188 
00189     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00190        <a class="code" href="../../d4/d9/ke_8h.html#a279">KePulseEvent</a> will be immediately followed by a call to one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00191        kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00192 
00193 Return Value:
00194 
00195     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00196 
00197 --*/
00198 
00199 {
00200 
00201     KIRQL OldIrql;
00202     LONG OldState;
00203     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00204 
00205     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00206     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00207 
00208     <span class="comment">//</span>
00209     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00210     <span class="comment">//</span>
00211 
00212     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00213 
00214     <span class="comment">//</span>
00215     <span class="comment">// If the current state of the event object is Not-Signaled and</span>
00216     <span class="comment">// the wait queue is not empty, then set the state of the event</span>
00217     <span class="comment">// to Signaled, satisfy as many Waits as possible, and then reset</span>
00218     <span class="comment">// the state of the event to Not-Signaled.</span>
00219     <span class="comment">//</span>
00220 
00221     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00222     <span class="keywordflow">if</span> ((OldState == 0) &amp;&amp; (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00223         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00224         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Event, Increment);
00225     }
00226 
00227     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 0;
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00231     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00232     <span class="comment">// release the dispatcher database lock and lower IRQL to the</span>
00233     <span class="comment">// previous value.</span>
00234     <span class="comment">//</span>
00235 
00236     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00237         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00238         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00239         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00240 
00241     } <span class="keywordflow">else</span> {
00242        <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00243     }
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">// Return previous signal state of event object.</span>
00247     <span class="comment">//</span>
00248 
00249     <span class="keywordflow">return</span> OldState;
00250 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a387" doxytag="ke.h::KeQueryActiveProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KAFFINITY KeQueryActiveProcessors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l01004">1004</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>01009                    :
01010 
01011     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current set of active processors
01012     in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
01013 
01014 Arguments:
01015 
01016     None.
01017 
01018 Return Value:
01019 
01020     KAFFINITY bitmask representing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> set of active processors
01021 
01022 --*/
01023 
01024 {
01025     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01026 
01027     <span class="keywordflow">return</span>(<a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>);
01028 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a322" doxytag="ke.h::KeQueryAutoAlignmentThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeQueryAutoAlignmentThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00869">869</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>.
<p>
<pre class="fragment"><div>00875                    :
00876 
00877     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data alignment handling mode <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00878     thread.
00879 
00880 Arguments:
00881 
00882     None.
00883 
00884 Return Value:
00885 
00886     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> data alignment exceptions are being
00887     automatically handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>
00888     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00889 
00890 --*/
00891 
00892 {
00893 
00894     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00895 
00896     <span class="comment">//</span>
00897     <span class="comment">// Return the data alignment handling mode for the thread.</span>
00898     <span class="comment">//</span>
00899 
00900     <span class="keywordflow">return</span> Thread-&gt;AutoAlignment;
00901 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a323" doxytag="ke.h::KeQueryBasePriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeQueryBasePriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00904">904</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00768">_KPROCESS::BasePriority</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>.
<p>
<pre class="fragment"><div>00910                    :
00911 
00912     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority increment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00913     thread.
00914 
00915 Arguments:
00916 
00917     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00918 
00919 Return Value:
00920 
00921     The base priority increment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00922 
00923 --*/
00924 
00925 {
00926 
00927     LONG <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00928     KIRQL OldIrql;
00929     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00930 
00931     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00932     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00933 
00934     <span class="comment">//</span>
00935     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00936     <span class="comment">//</span>
00937 
00938     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00939 
00940     <span class="comment">//</span>
00941     <span class="comment">// If priority saturation occured the last time the thread base priority</span>
00942     <span class="comment">// was set, then return the saturation increment value. Otherwise, compute</span>
00943     <span class="comment">// the increment value as the difference between the thread base priority</span>
00944     <span class="comment">// and the process base priority.</span>
00945     <span class="comment">//</span>
00946 
00947     Process = Thread-&gt;ApcStatePointer[0]-&gt;Process;
00948     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = Thread-&gt;BasePriority - Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o12">BasePriority</a>;
00949     <span class="keywordflow">if</span> (Thread-&gt;Saturation != 0) {
00950         <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = ((HIGH_PRIORITY + 1) / 2) * Thread-&gt;Saturation;
00951     }
00952 
00953     <span class="comment">//</span>
00954     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00955     <span class="comment">// value.</span>
00956     <span class="comment">//</span>
00957 
00958     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00959 
00960     <span class="comment">//</span>
00961     <span class="comment">// Return the previous thread base priority increment.</span>
00962     <span class="comment">//</span>
00963 
00964     <span class="keywordflow">return</span> <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00965 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a384" doxytag="ke.h::KeQueryInterruptTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONGLONG KeQueryInterruptTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00122">122</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l01212">ExGetNextWakeTime()</a>, and <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>.
<p>
<pre class="fragment"><div>00128                    :
00129 
00130     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current interrupt time by determining when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00131     time <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stable and then returning its value.
00132 
00133 Arguments:
00134 
00135     CurrentTime - Supplies a pointer to a variable that will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00136         current system time.
00137 
00138 Return Value:
00139 
00140     None.
00141 
00142 --*/
00143 
00144 {
00145 
00146     LARGE_INTEGER CurrentTime;
00147 
00148     KiQueryInterruptTime(&amp;CurrentTime);
00149     <span class="keywordflow">return</span> CurrentTime.QuadPart;
00150 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a278" doxytag="ke.h::KeQueryIntervalProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KeQueryIntervalProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN KPROFILE_SOURCE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Source</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/profobj_8c-source.html#l00163">163</a> of file <a class="el" href="../../d1/d7/profobj_8c-source.html">profobj.c</a>.
<p>
References <a class="el" href="../../d2/d7/hal_8h.html#a108">HAL_PROFILE_SOURCE_INFORMATION</a>, <a class="el" href="../../d2/d7/hal_8h.html#a237a143">HalProfileSourceInformation</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01542">HalQuerySystemInformation</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01627">_HAL_PROFILE_SOURCE_INFORMATION::Interval</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00465">KiProfileAlignmentFixupInterval</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00478">KiProfileInterval</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01625">_HAL_PROFILE_SOURCE_INFORMATION::Source</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d3/d6/hal_8h-source.html#l01626">_HAL_PROFILE_SOURCE_INFORMATION::Supported</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00788">NtQueryIntervalProfile()</a>.
<p>
<pre class="fragment"><div>00169                    :
00170 
00171     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile sample interval <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00172     currently <span class="keyword">using</span>.
00173 
00174 Arguments:
00175 
00176     ProfileSource - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile source to be queried.
00177 
00178 Return Value:
00179 
00180     Sample interval in units of 100ns.
00181 
00182 --*/
00183 
00184 {
00185 
00186     <a class="code" href="../../d2/d3/struct__HAL__PROFILE__SOURCE__INFORMATION.html">HAL_PROFILE_SOURCE_INFORMATION</a> ProfileSourceInfo;
00187     ULONG ReturnedLength;
00188     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00189 
00190     <span class="keywordflow">if</span> (ProfileSource == ProfileTime) {
00191 
00192         <span class="comment">//</span>
00193         <span class="comment">// Return the current sampling interval in 100ns units.</span>
00194         <span class="comment">//</span>
00195 
00196         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9/kernldat_8c.html#a55">KiProfileInterval</a>;
00197 
00198     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ProfileSource == ProfileAlignmentFixup) {
00199         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9/kernldat_8c.html#a53">KiProfileAlignmentFixupInterval</a>;
00200 
00201     } <span class="keywordflow">else</span> {
00202 
00203         <span class="comment">//</span>
00204         <span class="comment">// The HAL is responsible for tracking this profile interval.</span>
00205         <span class="comment">//</span>
00206 
00207         ProfileSourceInfo.<a class="code" href="../../d2/d3/struct__HAL__PROFILE__SOURCE__INFORMATION.html#o0">Source</a> = ProfileSource;
00208         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d7/hal_8h.html#a20">HalQuerySystemInformation</a>(HalProfileSourceInformation,
00209                                            <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d3/struct__HAL__PROFILE__SOURCE__INFORMATION.html">HAL_PROFILE_SOURCE_INFORMATION</a>),
00210                                            &amp;ProfileSourceInfo,
00211                                            &amp;ReturnedLength);
00212 
00213         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) &amp;&amp; ProfileSourceInfo.<a class="code" href="../../d2/d3/struct__HAL__PROFILE__SOURCE__INFORMATION.html#o1">Supported</a>) {
00214             <span class="keywordflow">return</span> ProfileSourceInfo.<a class="code" href="../../d2/d3/struct__HAL__PROFILE__SOURCE__INFORMATION.html#o2">Interval</a>;
00215 
00216         } <span class="keywordflow">else</span> {
00217             <span class="keywordflow">return</span> 0;
00218         }
00219     }
00220 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a324" doxytag="ke.h::KeQueryPriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KPRIORITY KeQueryPriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00968">968</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
<pre class="fragment"><div>00974                    :
00975 
00976     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00977 
00978 Arguments:
00979 
00980     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00981 
00982 Return Value:
00983 
00984     The current priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
00985 
00986 --*/
00987 
00988 {
00989     <span class="keywordflow">return</span> Thread-&gt;Priority;
00990 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a385" doxytag="ke.h::KeQuerySystemTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeQuerySystemTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CurrentTime</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00242">242</a> of file <a class="el" href="../../d7/d2/cmwraper_8c-source.html">cmwraper.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l01059">CheckAppStarting()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00092">CmDeleteValueKey()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01252">CmpCreateLinkNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01328">CmpCreateRootNode()</a>, <a class="el" href="../../d4/d1/cmparse2_8c-source.html#l00226">CmpDoCreateChild()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l00397">CmpSetSecurityDescriptorInfo()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01087">CmSetValueKey()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00528">DbgkExitProcess()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00625">EhCreateChild()</a>, <a class="el" href="../../d5/d4/logger_8c-source.html#l00106">ExDebugLogEvent()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l01212">ExGetNextWakeTime()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00378">ExpAllocateUuids()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00349">ExpRaiseHardError()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00340">ExpUuidInitialization()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00584">FsRtlAddToTunnelCache()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l01281">FsRtlPruneTunnelCache()</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l01025">HvpWriteLog()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00612">IoepFireWMIEvent()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l03084">IopAssign()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02812">IopInitializeBuiltinDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l00493">IovpCallDriver1()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l00150">LfsInitializeLogFile()</a>, <a class="el" href="../../d8/d7/sysinit_8c-source.html#l00040">LfsInitializeLogFileService()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l01534">LfsRestartLogFile()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l00254">MiDoReplacement()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03270">MiInitializeSpecialPoolCriteria()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02465">MiRearrangeWorkingSetExpansionList()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02740">MiRememberUnloadedDriver()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l02551">MiSessionOutSwapProcess()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00052">NtCreateSymbolicLinkObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00227">NtTerminateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01168">ViInjectResourceFailure()</a>.
<p>
<pre class="fragment"><div>00245 {
00246     NtQuerySystemTime(SystemTime);
00247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a386" doxytag="ke.h::KeQueryTimeIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG KeQueryTimeIncrement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00211">211</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l02774">KeMaximumIncrement</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>.
<p>
<pre class="fragment"><div>00217                    :
00218 
00219     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time increment value in 100ns units. This
00220     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system time at each interval clock
00221     interrupt.
00222 
00223 Arguments:
00224 
00225     None.
00226 
00227 Return Value:
00228 
00229     The time increment value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00230 
00231 --*/
00232 
00233 {
00234 
00235     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a131">KeMaximumIncrement</a>;
00236 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a349" doxytag="ke.h::KeQueryTimerDueTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONGLONG KeQueryTimerDueTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Timer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00410">410</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00037">ASSERT_TIMER</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l01212">ExGetNextWakeTime()</a>.
<p>
<pre class="fragment"><div>00416                    :
00417 
00418     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> InterruptTime at which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00419     pending.   0 <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not pending.
00420 
00421     N.B. This function may <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system sleep code.
00422 
00423 Arguments:
00424 
00425     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00426 
00427 Return Value:
00428 
00429     Returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> amount of time remaining on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer, or 0 <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00430     timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not pending.
00431 
00432 --*/
00433 
00434 {
00435 
00436     KIRQL OldIrql;
00437     LARGE_INTEGER InterruptTime;
00438     ULONGLONG DueTime;
00439 
00440     <a class="code" href="../../d3/d2/timerobj_8c.html#a0">ASSERT_TIMER</a>(Timer);
00441 
00442     <span class="comment">//</span>
00443     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00444     <span class="comment">//</span>
00445 
00446     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00447 
00448     <span class="comment">//</span>
00449     <span class="comment">// If the timer is currently pending, compute its due time</span>
00450     <span class="comment">//</span>
00451 
00452     DueTime = 0;
00453     <span class="keywordflow">if</span> (Timer-&gt;Header.Inserted) {
00454         DueTime = Timer-&gt;DueTime.QuadPart;
00455     }
00456 
00457     <span class="comment">//</span>
00458     <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00459     <span class="comment">// value, and return the due time</span>
00460     <span class="comment">//</span>
00461 
00462     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00463     <span class="keywordflow">return</span> DueTime;
00464 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a396" doxytag="ke.h::KeRaiseUserException" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeRaiseUserException           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN NTSTATUS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ExceptionCode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l01024">1024</a> of file <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html">alpha/exceptn.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02811">KeRaiseUserExceptionDispatcher</a>, and <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, and <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>.
<p>
<pre class="fragment"><div>01030                    :
01031 
01032     This function causes an exception to be raised in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> calling thread's user-mode
01033     context. It does <span class="keyword">this</span> by editing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> trap frame <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel was entered with to
01034     point to trampoline code that raises <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested exception.
01035 
01036 Arguments:
01037 
01038     ExceptionCode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> status value to be used as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception
01039         code <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be raised.
01040 
01041 Return Value:
01042 
01043     The status value that should be returned by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
01044 
01045 --*/
01046 
01047 {
01048 
01049     PKTRAP_FRAME TrapFrame;
01050 
01051     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetPreviousMode() == UserMode);
01052 
01053     TrapFrame = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;TrapFrame;
01054 
01055     TrapFrame-&gt;Fir = (ULONGLONG)(LONG_PTR)<a class="code" href="../../d4/d9/ke_8h.html#a151">KeRaiseUserExceptionDispatcher</a>;
01056     <span class="keywordflow">return</span>(ExceptionCode);
01057 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a280" doxytag="ke.h::KeReadStateEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReadStateEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Event</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00253">253</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, and <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/internal_8c-source.html#l00417">IopCancelAlertedRequest()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01506">IopConnectLinkTrackingPort()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, and <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>.
<p>
<pre class="fragment"><div>00259                    :
00260 
00261     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of an event object.
00262 
00263 Arguments:
00264 
00265     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00266 
00267 Return Value:
00268 
00269     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00270 
00271 --*/
00272 
00273 {
00274 
00275     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00276 
00277     <span class="comment">//</span>
00278     <span class="comment">// Return current signal state of event object.</span>
00279     <span class="comment">//</span>
00280 
00281     <span class="keywordflow">return</span> <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00282 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a286" doxytag="ke.h::KeReadStateMutant" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeReadStateMutant           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PRKMUTANT</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00146">146</a> of file <a class="el" href="../../d4/d4/mutntobj_8c-source.html">mutntobj.c</a>.
<p>
References <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00035">ASSERT_MUTANT</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/mutant_8c-source.html#l00380">NtQueryMutant()</a>.
<p>
<pre class="fragment"><div>00152                    :
00153 
00154     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of a mutant object.
00155 
00156 Arguments:
00157 
00158     Mutant - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> mutant.
00159 
00160 Return Value:
00161 
00162     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant object.
00163 
00164 --*/
00165 
00166 {
00167 
00168     <a class="code" href="../../d3/d5/mutntobj_8c.html#a0">ASSERT_MUTANT</a>(Mutant);
00169 
00170     <span class="comment">//</span>
00171     <span class="comment">// Return current signal state of mutant object.</span>
00172     <span class="comment">//</span>
00173 
00174     <span class="keywordflow">return</span> Mutant-&gt;Header.SignalState;
00175 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a305" doxytag="ke.h::KeReadStateProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeReadStateProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Process</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00624">624</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>.
<p>
<pre class="fragment"><div>00630                    :
00631 
00632     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of a process object.
00633 
00634 Arguments:
00635 
00636     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00637 
00638 Return Value:
00639 
00640     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process object.
00641 
00642 --*/
00643 
00644 {
00645 
00646     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00647 
00648     <span class="comment">//</span>
00649     <span class="comment">// Return current signal state of process object.</span>
00650     <span class="comment">//</span>
00651 
00652     <span class="keywordflow">return</span> Process-&gt;Header.SignalState;
00653 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a291" doxytag="ke.h::KeReadStateQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReadStateQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Queue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00092">92</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00033">ASSERT_QUEUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00853">ExpDetectWorkerThreadDeadlock()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00282">NtQueryIoCompletion()</a>.
<p>
<pre class="fragment"><div>00098                    :
00099 
00100     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of a Queue object.
00101 
00102 Arguments:
00103 
00104     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> Queue.
00105 
00106 Return Value:
00107 
00108     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Queue object.
00109 
00110 --*/
00111 
00112 {
00113 
00114     <a class="code" href="../../d8/d3/queueobj_8c.html#a0">ASSERT_QUEUE</a>(Queue);
00115 
00116     <span class="comment">//</span>
00117     <span class="comment">// Return current signal state of Queue object.</span>
00118     <span class="comment">//</span>
00119 
00120     <span class="keywordflow">return</span> Queue-&gt;Header.SignalState;
00121 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a297" doxytag="ke.h::KeReadStateSemaphore" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReadStateSemaphore           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Semaphore</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00085">85</a> of file <a class="el" href="../../d2/d5/semphobj_8c-source.html">semphobj.c</a>.
<p>
References <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00033">ASSERT_SEMAPHORE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00104">LpcpDestroyPortQueue()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00360">NtQuerySemaphore()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00375">NtReplyWaitReplyPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, and <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>.
<p>
<pre class="fragment"><div>00091                    :
00092 
00093     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of a semaphore object.
00094 
00095 Arguments:
00096 
00097     Semaphore - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
00098         semaphore.
00099 
00100 Return Value:
00101 
00102     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> semaphore object.
00103 
00104 --*/
00105 
00106 {
00107 
00108     <a class="code" href="../../d1/d6/semphobj_8c.html#a0">ASSERT_SEMAPHORE</a>( Semaphore );
00109 
00110     <span class="comment">//</span>
00111     <span class="comment">// Return current signal state of semaphore object.</span>
00112     <span class="comment">//</span>
00113 
00114     <span class="keywordflow">return</span> Semaphore-&gt;Header.SignalState;
00115 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a325" doxytag="ke.h::KeReadStateThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeReadStateThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00993">993</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>.
<p>
<pre class="fragment"><div>00999                    :
01000 
01001     This function reads <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current signal state of a thread object.
01002 
01003 Arguments:
01004 
01005     Thread - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01006 
01007 Return Value:
01008 
01009     The current signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread object.
01010 
01011 --*/
01012 
01013 {
01014 
01015     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01016 
01017     <span class="comment">//</span>
01018     <span class="comment">// Return current signal state of thread object.</span>
01019     <span class="comment">//</span>
01020 
01021     <span class="keywordflow">return</span> (BOOLEAN)Thread-&gt;Header.SignalState;
01022 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a344" doxytag="ke.h::KeReadStateTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeReadStateTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Timer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a326" doxytag="ke.h::KeReadyThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeReadyThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01025">1025</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00270">KiReadyThread()</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.
<p>
<pre class="fragment"><div>01031                    :
01032 
01033     This function readies a thread <span class="keywordflow">for</span> execution. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread's process
01034     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> currently not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> balance set, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01035     thread's process' ready queue. Else <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> higher priority than
01036     another thread that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> currently running on a processor then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread
01037     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> selected <span class="keywordflow">for</span> execution on that processor. Else <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> inserted
01038     in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> dispatcher ready queue selected by its priority.
01039 
01040 Arguments:
01041 
01042     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01043 
01044 Return Value:
01045 
01046     None.
01047 
01048 --*/
01049 
01050 {
01051 
01052     KIRQL OldIrql;
01053 
01054     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01055     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01056 
01057     <span class="comment">//</span>
01058     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01059     <span class="comment">//</span>
01060 
01061     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01062 
01063     <span class="comment">//</span>
01064     <span class="comment">// Ready the specified thread for execution.</span>
01065     <span class="comment">//</span>
01066 
01067     <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
01068 
01069     <span class="comment">//</span>
01070     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01071     <span class="comment">// value.</span>
01072     <span class="comment">//</span>
01073 
01074     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01075     <span class="keywordflow">return</span>;
01076 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a366" doxytag="ke.h::KeRegisterBugCheckCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeRegisterBugCheckCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d5/struct__KBUGCHECK__CALLBACK__RECORD.html">PKBUGCHECK_CALLBACK_RECORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackRecord</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a113">PKBUGCHECK_CALLBACK_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Component</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01123">1123</a> of file <a class="el" href="../../d0/d1/bugcheck_8c-source.html">bugcheck.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>, <a class="el" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02770">KeBugCheckCallbackListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02771">KeBugCheckCallbackLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02149">PKBUGCHECK_CALLBACK_ROUTINE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01133                    :
01134 
01135     This function registers a bug check callback record. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system
01136     crashes, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified function will be called during bug check
01137     processing so <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> may dump additional state in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified bug check
01138     buffer.
01139 
01140     N.B. Bug check callback <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a> are called in reverse order of
01141          registration, i.e., in LIFO order.
01142 
01143 Arguments:
01144 
01145     CallbackRecord - Supplies a pointer to a callback record.
01146 
01147     CallbackRoutine - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback routine.
01148 
01149     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bug check buffer.
01150 
01151     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> bug check buffer in bytes.
01152 
01153     Component - Supplies a pointer to a zero terminated component
01154         identifier.
01155 
01156 Return Value:
01157 
01158     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified bug check callback record <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully registered,
01159     then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01160 
01161 --*/
01162 
01163 {
01164 
01165     BOOLEAN Inserted;
01166     KIRQL OldIrql;
01167 
01168     <span class="comment">//</span>
01169     <span class="comment">// Raise IRQL to HIGH_LEVEL and acquire the bug check callback list</span>
01170     <span class="comment">// spinlock.</span>
01171     <span class="comment">//</span>
01172 
01173     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql);
01174     KiAcquireSpinLock(&amp;KeBugCheckCallbackLock);
01175 
01176     <span class="comment">//</span>
01177     <span class="comment">// If the specified callback record is currently not registered, then</span>
01178     <span class="comment">// register the callback record.</span>
01179     <span class="comment">//</span>
01180 
01181     Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01182     <span class="keywordflow">if</span> (CallbackRecord-&gt;State == <a class="code" href="../../d4/d9/ke_8h.html#a410a236">BufferEmpty</a>) {
01183         CallbackRecord-&gt;CallbackRoutine = CallbackRoutine;
01184         CallbackRecord-&gt;Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
01185         CallbackRecord-&gt;Length = Length;
01186         CallbackRecord-&gt;Component = Component;
01187         CallbackRecord-&gt;Checksum =
01188             ((ULONG_PTR)CallbackRoutine + (ULONG_PTR)<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> + Length + (ULONG_PTR)Component);
01189 
01190         CallbackRecord-&gt;State = <a class="code" href="../../d4/d9/ke_8h.html#a410a237">BufferInserted</a>;
01191         InsertHeadList(&amp;KeBugCheckCallbackListHead, &amp;CallbackRecord-&gt;Entry);
01192         Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01193     }
01194 
01195     <span class="comment">//</span>
01196     <span class="comment">// Release the bug check callback spinlock, lower IRQL to its previous</span>
01197     <span class="comment">// value, and return whether the callback record was successfully</span>
01198     <span class="comment">// registered.</span>
01199     <span class="comment">//</span>
01200 
01201     KiReleaseSpinLock(&amp;KeBugCheckCallbackLock);
01202     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
01203     <span class="keywordflow">return</span> Inserted;
01204 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a287" doxytag="ke.h::KeReleaseMutant" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReleaseMutant           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTANT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Mutant</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Abandoned</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00178">178</a> of file <a class="el" href="../../d4/d4/mutntobj_8c-source.html">mutntobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00243">_KAPC_STATE::ApcListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00035">ASSERT_MUTANT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00596">_KTHREAD::KernelApcDisable</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d4/intsupc_8c-source.html#l00159">KiRequestSoftwareInterrupt()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/mutant_8c-source.html#l00057">ExpDeleteMutant()</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00310">KeReleaseMutex()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04046">MmGetVerifierInformation()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04226">MmSetVerifierInformation()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00521">NtReleaseMutant()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01234">ObFindHandleForObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l01022">ObKillProcess()</a>.
<p>
<pre class="fragment"><div>00187                    :
00188 
00189     This function releases a mutant object by incrementing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant
00190     count. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resultant value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one, then an attempt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to
00191     satisfy as many Waits as possible. The previous signal state of
00192     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Abandoned
00193     parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released by settings
00194     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state to one.
00195 
00196 Arguments:
00197 
00198     Mutant - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> mutant.
00199 
00200     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00201         <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event causes a Wait to be satisfied.
00202 
00203     Abandoned - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00204         mutant object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> being abandoned.
00205 
00206     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00207         <a class="code" href="../../d4/d9/ke_8h.html#a287">KeReleaseMutant</a> will be immediately followed by a call to one
00208         of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00209 
00210 Return Value:
00211 
00212     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mutant object.
00213 
00214 --*/
00215 
00216 {
00217 
00218     KIRQL OldIrql;
00219     LONG OldState;
00220     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00221 
00222 
00223     <a class="code" href="../../d3/d5/mutntobj_8c.html#a0">ASSERT_MUTANT</a>(Mutant);
00224     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00225 
00226     <span class="comment">//</span>
00227     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00228     <span class="comment">//</span>
00229 
00230     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00231 
00232     <span class="comment">//</span>
00233     <span class="comment">// Capture the current signal state of the mutant object.</span>
00234     <span class="comment">//</span>
00235 
00236     OldState = Mutant-&gt;Header.SignalState;
00237 
00238     <span class="comment">//</span>
00239     <span class="comment">// If the Abandoned parameter is TRUE, then force the release of the</span>
00240     <span class="comment">// mutant object by setting its ownership count to one and setting its</span>
00241     <span class="comment">// abandoned state to TRUE. Otherwise increment mutant ownership count.</span>
00242     <span class="comment">// If the result count is one, then remove the mutant object from the</span>
00243     <span class="comment">// thread's owned mutant list, set the owner thread to NULL, and attempt</span>
00244     <span class="comment">// to satisfy a Wait for the mutant object if the mutant object wait</span>
00245     <span class="comment">// list is not empty.</span>
00246     <span class="comment">//</span>
00247 
00248     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00249     <span class="keywordflow">if</span> (Abandoned != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00250         Mutant-&gt;Header.SignalState = 1;
00251         Mutant-&gt;Abandoned = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00252 
00253     } <span class="keywordflow">else</span> {
00254 
00255         <span class="comment">//</span>
00256         <span class="comment">// If the Mutant object is not owned by the current thread, then</span>
00257         <span class="comment">// unlock the dispatcher data base and raise an exception. Otherwise</span>
00258         <span class="comment">// increment the ownership count.</span>
00259         <span class="comment">//</span>
00260 
00261         <span class="keywordflow">if</span> (Mutant-&gt;OwnerThread != Thread) {
00262             <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00263             <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(Mutant-&gt;Abandoned ?
00264                           STATUS_ABANDONED : STATUS_MUTANT_NOT_OWNED);
00265         }
00266 
00267         Mutant-&gt;Header.SignalState += 1;
00268     }
00269 
00270     <span class="keywordflow">if</span> (Mutant-&gt;Header.SignalState == 1) {
00271         <span class="keywordflow">if</span> (OldState &lt;= 0) {
00272             RemoveEntryList(&amp;Mutant-&gt;MutantListEntry);
00273             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o30">KernelApcDisable</a> += Mutant-&gt;ApcDisable;
00274             <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o30">KernelApcDisable</a> == 0) &amp;&amp;
00275                 (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[KernelMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00276                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00277                 <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(APC_LEVEL);
00278             }
00279         }
00280 
00281         Mutant-&gt;OwnerThread = (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00282         <span class="keywordflow">if</span> (IsListEmpty(&amp;Mutant-&gt;Header.WaitListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00283             <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Mutant, Increment);
00284         }
00285     }
00286 
00287     <span class="comment">//</span>
00288     <span class="comment">// If the value of the Wait argument is TRUE, then return to</span>
00289     <span class="comment">// caller with IRQL raised and the dispatcher database locked.</span>
00290     <span class="comment">// Else release the dispatcher database lock and lower IRQL to</span>
00291     <span class="comment">// its previous value.</span>
00292     <span class="comment">//</span>
00293 
00294     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00295         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00296         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00297 
00298     } <span class="keywordflow">else</span> {
00299         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00300     }
00301 
00302     <span class="comment">//</span>
00303     <span class="comment">// Return previous signal state of mutant object.</span>
00304     <span class="comment">//</span>
00305 
00306     <span class="keywordflow">return</span> OldState;
00307 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a289" doxytag="ke.h::KeReleaseMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReleaseMutex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d7/struct__KMUTANT.html">PRKMUTEX</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Mutex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a298" doxytag="ke.h::KeReleaseSemaphore" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeReleaseSemaphore           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d7/struct__KSEMAPHORE.html">PRKSEMAPHORE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Semaphore</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Adjustment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">118</a> of file <a class="el" href="../../d2/d5/semphobj_8c-source.html">semphobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00033">ASSERT_SEMAPHORE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00413">ExAllocatePool()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01942">ExConvertExclusiveToSharedLite()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00970">ExFreePool()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01607">ExReleaseResourceForThreadLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00418">FsRtlDeregisterUncProvider()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00247">FsRtlRegisterUncProvider()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07141">IopAllocateBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l00720">IopAllocateResources()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00572">IopHardwareProfileCancelRemovedDock()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00666">IopHardwareProfileCancelTransition()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00465">IopHardwareProfileCommitRemovedDock()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00370">IopHardwareProfileCommitStartedDock()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06180">IopLegacyResourceAllocation()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07717">IopQueryConflictList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05215">IopRebalance()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00104">LpcpDestroyPortQueue()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01181">LpcRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d7/d0/mmquota_8c-source.html#l00329">MiChargeCommitmentCantExpand()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02059">MiCheckForControlAreaDeletion()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01864">MiContractPagingFiles()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04911">MiIssuePageExtendRequest()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l05023">MiIssuePageExtendRequestNoWait()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00836">NtCompleteConnectPort()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00494">NtReleaseSemaphore()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00044">NtReplyPort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00375">NtReplyWaitReplyPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01567">Reader()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01646">ReaderTurnedWriter()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, and <a class="el" href="../../d5/d9/tex_8c-source.html#l01606">Writer()</a>.
<p>
<pre class="fragment"><div>00127                    :
00128 
00129     This function releases a semaphore by adding <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified adjustment
00130     value to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current semaphore count and attempts to satisfy as many
00131     Waits as possible. The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> semaphore object
00132     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00133 
00134 Arguments:
00135 
00136     Semaphore - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
00137         semaphore.
00138 
00139     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00140         <span class="keywordflow">if</span> releasing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> semaphore causes a Wait to be satisfied.
00141 
00142     Adjustment - Supplies value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
00143         semaphore count.
00144 
00145     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00146         <a class="code" href="../../d4/d9/ke_8h.html#a298">KeReleaseSemaphore</a> will be immediately followed by a call to one
00147         of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00148 
00149 Return Value:
00150 
00151     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> semaphore object.
00152 
00153 --*/
00154 
00155 {
00156 
00157     LONG NewState;
00158     KIRQL OldIrql;
00159     LONG OldState;
00160     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00161 
00162     <a class="code" href="../../d1/d6/semphobj_8c.html#a0">ASSERT_SEMAPHORE</a>( Semaphore );
00163     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00167     <span class="comment">//</span>
00168 
00169     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00170 
00171     <span class="comment">//</span>
00172     <span class="comment">// Capture the current signal state of the semaphore object and</span>
00173     <span class="comment">// compute the new count value.</span>
00174     <span class="comment">//</span>
00175 
00176     OldState = Semaphore-&gt;Header.SignalState;
00177     NewState = OldState + Adjustment;
00178 
00179     <span class="comment">//</span>
00180     <span class="comment">// If the new state value is greater than the limit or a carry occurs,</span>
00181     <span class="comment">// then unlock the dispatcher database, and raise an exception.</span>
00182     <span class="comment">//</span>
00183 
00184     <span class="keywordflow">if</span> ((NewState &gt; Semaphore-&gt;Limit) || (NewState &lt; OldState)) {
00185         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00186         <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_SEMAPHORE_LIMIT_EXCEEDED);
00187     }
00188 
00189     <span class="comment">//</span>
00190     <span class="comment">// Set the new signal state of the semaphore object and set the wait</span>
00191     <span class="comment">// next value. If the previous signal state was Not-Signaled (i.e.</span>
00192     <span class="comment">// the count was zero), and the wait queue is not empty, then attempt</span>
00193     <span class="comment">// to satisfy as many Waits as possible.</span>
00194     <span class="comment">//</span>
00195 
00196     Semaphore-&gt;Header.SignalState = NewState;
00197     <span class="keywordflow">if</span> ((OldState == 0) &amp;&amp; (IsListEmpty(&amp;Semaphore-&gt;Header.WaitListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00198         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Semaphore, Increment);
00199     }
00200 
00201     <span class="comment">//</span>
00202     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00203     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00204     <span class="comment">// release the dispatcher database lock and lower IRQL to its</span>
00205     <span class="comment">// previous value.</span>
00206     <span class="comment">//</span>
00207 
00208     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00209         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00210         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00211         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00212 
00213     } <span class="keywordflow">else</span> {
00214         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00215     }
00216 
00217     <span class="comment">//</span>
00218     <span class="comment">// Return previous signal state of sempahore object.</span>
00219     <span class="comment">//</span>
00220 
00221     <span class="keywordflow">return</span> OldState;
00222 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a359" doxytag="ke.h::KeReleaseSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeReleaseSpinLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>SpinLock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KIRQL&nbsp;</td>
          <td class="mdname" nowrap> <em>NewIrql</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a357" doxytag="ke.h::KeReleaseSpinLockFromDpcLevel" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeReleaseSpinLockFromDpcLevel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SpinLock</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a268" doxytag="ke.h::KeRemoveByKeyDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> KeRemoveByKeyDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SortKey</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00294">294</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00034">ASSERT_DEVICE_QUEUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00402">_KDEVICE_QUEUE_ENTRY::DeviceListEntry</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00404">_KDEVICE_QUEUE_ENTRY::Inserted</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00403">_KDEVICE_QUEUE_ENTRY::SortKey</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10649">IoStartNextPacketByKey()</a>.
<p>
<pre class="fragment"><div>00301                    :
00302 
00303     This function removes an entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified device
00304     queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set Not-Busy
00305     and a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> an entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed
00306     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of device queue entry
00307     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> search <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first entry which has a value
00308     greater than or equal to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> SortKey.  If no such entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> found then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00309     first entry of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00310 
00311     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called from <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00312 
00313 Arguments:
00314 
00315     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device queue.
00316 
00317     SortKey - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sort key by which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> position to remove <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device
00318         queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be determined.
00319 
00320 Return Value:
00321 
00322     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty. Otherwise a
00323     pointer to a device queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00324 
00325 --*/
00326 
00327 {
00328 
00329     <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> DeviceQueueEntry;
00330     PLIST_ENTRY NextEntry;
00331 
00332     <a class="code" href="../../d7/d7/devquobj_8c.html#a0">ASSERT_DEVICE_QUEUE</a>(DeviceQueue);
00333     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00334 
00335     <span class="comment">//</span>
00336     <span class="comment">// Lock specified device queue.</span>
00337     <span class="comment">//</span>
00338 
00339     KiAcquireSpinLock(&amp;DeviceQueue-&gt;Lock);
00340 
00341     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(DeviceQueue-&gt;Busy == TRUE);
00342 
00343     <span class="comment">//</span>
00344     <span class="comment">// If the device queue is not empty, then remove the first entry from</span>
00345     <span class="comment">// the queue. Otherwise set the device queue not busy.</span>
00346     <span class="comment">//</span>
00347 
00348     <span class="keywordflow">if</span> (IsListEmpty(&amp;DeviceQueue-&gt;DeviceListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00349         DeviceQueue-&gt;Busy = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00350         DeviceQueueEntry = (<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00351     } <span class="keywordflow">else</span> {
00352         NextEntry = DeviceQueue-&gt;DeviceListHead.Flink;
00353         <span class="keywordflow">while</span> (NextEntry != &amp;DeviceQueue-&gt;DeviceListHead) {
00354             DeviceQueueEntry = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">KDEVICE_QUEUE_ENTRY</a>,
00355                                            DeviceListEntry);
00356             <span class="keywordflow">if</span> (SortKey &lt;= DeviceQueueEntry-&gt;<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html#o1">SortKey</a>) {
00357                 <span class="keywordflow">break</span>;
00358             }
00359             NextEntry = NextEntry-&gt;Flink;
00360         }
00361 
00362         <span class="keywordflow">if</span> (NextEntry != &amp;DeviceQueue-&gt;DeviceListHead) {
00363             RemoveEntryList(&amp;DeviceQueueEntry-&gt;<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html#o0">DeviceListEntry</a>);
00364 
00365         } <span class="keywordflow">else</span> {
00366             NextEntry = RemoveHeadList(&amp;DeviceQueue-&gt;DeviceListHead);
00367             DeviceQueueEntry = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">KDEVICE_QUEUE_ENTRY</a>,
00368                                              DeviceListEntry);
00369         }
00370 
00371         DeviceQueueEntry-&gt;<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html#o2">Inserted</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00372     }
00373 
00374     <span class="comment">//</span>
00375     <span class="comment">// Release device queue spin lock and return address of device queue</span>
00376     <span class="comment">// entry.</span>
00377     <span class="comment">//</span>
00378 
00379     KiReleaseSpinLock(&amp;DeviceQueue-&gt;Lock);
00380     <span class="keywordflow">return</span> DeviceQueueEntry;
00381 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a267" doxytag="ke.h::KeRemoveDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> KeRemoveDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DeviceQueue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00226">226</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00034">ASSERT_DEVICE_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00404">_KDEVICE_QUEUE_ENTRY::Inserted</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06574">IoFreeController()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10564">IoStartNextPacket()</a>.
<p>
<pre class="fragment"><div>00232                    :
00233 
00234     This function removes an entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> head of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified device
00235     queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set Not-Busy
00236     and a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed
00237     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> head of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of device queue entry
00238     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00239 
00240     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called from <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>.
00241 
00242 Arguments:
00243 
00244     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device queue.
00245 
00246 Return Value:
00247 
00248     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty. Otherwise a
00249     pointer to a device queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00250 
00251 --*/
00252 
00253 {
00254 
00255     <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a> DeviceQueueEntry;
00256     PLIST_ENTRY NextEntry;
00257 
00258     <a class="code" href="../../d7/d7/devquobj_8c.html#a0">ASSERT_DEVICE_QUEUE</a>(DeviceQueue);
00259     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">// Lock specified device queue.</span>
00263     <span class="comment">//</span>
00264 
00265     KiAcquireSpinLock(&amp;DeviceQueue-&gt;Lock);
00266 
00267     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(DeviceQueue-&gt;Busy == TRUE);
00268 
00269     <span class="comment">//</span>
00270     <span class="comment">// If the device queue is not empty, then remove the first entry from</span>
00271     <span class="comment">// the queue. Otherwise set the device queue not busy.</span>
00272     <span class="comment">//</span>
00273 
00274     <span class="keywordflow">if</span> (IsListEmpty(&amp;DeviceQueue-&gt;DeviceListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00275         DeviceQueue-&gt;Busy = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00276         DeviceQueueEntry = (<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00277     } <span class="keywordflow">else</span> {
00278         NextEntry = RemoveHeadList(&amp;DeviceQueue-&gt;DeviceListHead);
00279         DeviceQueueEntry = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">KDEVICE_QUEUE_ENTRY</a>,
00280                                              DeviceListEntry);
00281         DeviceQueueEntry-&gt;<a class="code" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html#o2">Inserted</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00282     }
00283 
00284     <span class="comment">//</span>
00285     <span class="comment">// Release device queue spin lock and return address of device queue</span>
00286     <span class="comment">// entry.</span>
00287     <span class="comment">//</span>
00288 
00289     KiReleaseSpinLock(&amp;DeviceQueue-&gt;Lock);
00290     <span class="keywordflow">return</span> DeviceQueueEntry;
00291 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a269" doxytag="ke.h::KeRemoveEntryDeviceQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeRemoveEntryDeviceQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d5/struct__KDEVICE__QUEUE.html">PKDEVICE_QUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/struct__KDEVICE__QUEUE__ENTRY.html">PKDEVICE_QUEUE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceQueueEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00384">384</a> of file <a class="el" href="../../d8/d6/devquobj_8c-source.html">devquobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d6/devquobj_8c-source.html#l00034">ASSERT_DEVICE_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00391                    :
00392 
00393     This function removes a specified entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified device
00394     queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue, then no
00395     operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified device queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00396     removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue and its inserted status <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.
00397 
00398 Arguments:
00399 
00400     DeviceQueue - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> device queue.
00401 
00402     DeviceQueueEntry - Supplies a pointer to a device queue entry which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to
00403         be removed from its device queue.
00404 
00405 Return Value:
00406 
00407     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device queue entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from its
00408     device queue. Otherwise a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00409 
00410 --*/
00411 
00412 {
00413 
00414     KIRQL OldIrql;
00415     BOOLEAN Removed;
00416 
00417     <a class="code" href="../../d7/d7/devquobj_8c.html#a0">ASSERT_DEVICE_QUEUE</a>(DeviceQueue);
00418     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00419 
00420     <span class="comment">//</span>
00421     <span class="comment">// Raise IRQL to dispatcher level and lock specified device queue.</span>
00422     <span class="comment">//</span>
00423 
00424     ExAcquireSpinLock(&amp;DeviceQueue-&gt;Lock, &amp;OldIrql);
00425 
00426     <span class="comment">//</span>
00427     <span class="comment">// If the device queue entry is not in a device queue, then no operation</span>
00428     <span class="comment">// is performed. Otherwise remove the specified device queue entry from its</span>
00429     <span class="comment">// device queue.</span>
00430     <span class="comment">//</span>
00431 
00432     Removed = DeviceQueueEntry-&gt;Inserted;
00433     <span class="keywordflow">if</span> (Removed == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00434         DeviceQueueEntry-&gt;Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00435         RemoveEntryList(&amp;DeviceQueueEntry-&gt;DeviceListEntry);
00436     }
00437 
00438     <span class="comment">//</span>
00439     <span class="comment">// Unlock specified device queue, lower IRQL to its previous level, and</span>
00440     <span class="comment">// return whether the device queue entry was removed from its queue.</span>
00441     <span class="comment">//</span>
00442 
00443     ExReleaseSpinLock(&amp;DeviceQueue-&gt;Lock, OldIrql);
00444     <span class="keywordflow">return</span> Removed;
00445 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a294" doxytag="ke.h::KeRemoveQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PLIST_ENTRY KeRemoveQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Queue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER Timeout&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00238">238</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00657">_KTHREAD::Alertable</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00033">ASSERT_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00523">_KTIMER::DueTime</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00086">ExWorkerQueue</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00649">KiActivateWaiterQueue()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01175">KiComputeWaitInterval()</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00042">KiInsertTreeTimer()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00225">KiInsertWaitList</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a138">KiSwapThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00283">_KWAIT_BLOCK::NextWaitBlock</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00282">_KWAIT_BLOCK::Object</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00612">_KTHREAD::Queue</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00615">_KTHREAD::QueueListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00281">_KWAIT_BLOCK::Thread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00614">_KTHREAD::Timer</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00247">_KAPC_STATE::UserApcPending</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00594">_KTHREAD::WaitBlock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00587">_KTHREAD::WaitBlockList</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00280">_KWAIT_BLOCK::WaitListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00584">_KTHREAD::WaitMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00586">_KTHREAD::WaitReason</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00582">_KTHREAD::WaitStatus</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00589">_KTHREAD::WaitTime</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a407a213">WrQueue</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00345">FsRtlWorkerThread()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00485">NtRemoveIoCompletion()</a>.
<p>
<pre class="fragment"><div>00246                    :
00247 
00248     This function removes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Queue object entry
00249     list. If no list entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> available, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> calling thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00250     put in a wait state.
00251 
00252     N.B. The wait discipline <span class="keywordflow">for</span> Queue object LIFO.
00253 
00254 Arguments:
00255 
00256     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> Queue.
00257 
00258     WaitMode  - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode in which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00259 
00260     Timeout - Supplies a pointer to an optional absolute of relative time over
00261         which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00262 
00263 Return Value:
00264 
00265     The address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Queue object entry list or
00266     STATUS_TIMEOUT.
00267 
00268     N.B. These values can easily be distinguished by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> fact that all
00269          addresses in kernel mode have <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> order bit set.
00270 
00271 --*/
00272 
00273 {
00274 
00275     LARGE_INTEGER DueTime;
00276     PLIST_ENTRY Entry;
00277     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> NextThread;
00278     LARGE_INTEGER NewTime;
00279     KIRQL OldIrql;
00280     <a class="code" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> OldQueue;
00281     PLARGE_INTEGER OriginalTime;
00282     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00283     <a class="code" href="../../d3/d8/struct__KTIMER.html">PRKTIMER</a> Timer;
00284     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PRKWAIT_BLOCK</a> WaitBlock;
00285     LONG_PTR WaitStatus;
00286 
00287     <a class="code" href="../../d8/d3/queueobj_8c.html#a0">ASSERT_QUEUE</a>(Queue);
00288     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00289 
00290     <span class="comment">//</span>
00291     <span class="comment">// If the dispatcher database lock is not already held, then set the wait</span>
00292     <span class="comment">// IRQL and lock the dispatcher database. Else set boolean wait variable</span>
00293     <span class="comment">// to FALSE.</span>
00294     <span class="comment">//</span>
00295 
00296     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00297     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a>) {
00298         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00299 
00300     } <span class="keywordflow">else</span> {
00301         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00302         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00303     }
00304 
00305     <span class="comment">//</span>
00306     <span class="comment">// Check if the thread is currently processing a queue entry and whether</span>
00307     <span class="comment">// the new queue is the same as the old queue.</span>
00308     <span class="comment">//</span>
00309 
00310     OldQueue = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a>;
00311     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a> = Queue;
00312     <span class="keywordflow">if</span> (Queue != OldQueue) {
00313 
00314         <span class="comment">//</span>
00315         <span class="comment">// If the thread was previously associated with a queue, then remove</span>
00316         <span class="comment">// the thread from the old queue object thread list and attempt to</span>
00317         <span class="comment">// activate another thread.</span>
00318         <span class="comment">//</span>
00319 
00320         Entry = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o40">QueueListEntry</a>;
00321         <span class="keywordflow">if</span> (OldQueue != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00322             RemoveEntryList(Entry);
00323             <a class="code" href="../../d8/d3/queueobj_8c.html#a7">KiActivateWaiterQueue</a>(OldQueue);
00324         }
00325 
00326         <span class="comment">//</span>
00327         <span class="comment">// Insert thread in the thread list of the new queue that the thread</span>
00328         <span class="comment">// will be associate with.</span>
00329         <span class="comment">//</span>
00330 
00331         InsertTailList(&amp;Queue-&gt;ThreadListHead, Entry);
00332 
00333     } <span class="keywordflow">else</span> {
00334 
00335         <span class="comment">//</span>
00336         <span class="comment">// The previous and current queue are the same queue - decrement the</span>
00337         <span class="comment">// current number of threads.</span>
00338         <span class="comment">//</span>
00339 
00340         Queue-&gt;CurrentCount -= 1;
00341     }
00342 
00343     <span class="comment">//</span>
00344     <span class="comment">//</span>
00345     <span class="comment">// Start of wait loop.</span>
00346     <span class="comment">//</span>
00347     <span class="comment">//</span>
00348     <span class="comment">// Note this loop is repeated if a kernel APC is delivered in the</span>
00349     <span class="comment">// middle of the wait or a kernel APC is pending on the first attempt</span>
00350     <span class="comment">// through the loop.</span>
00351     <span class="comment">//</span>
00352     <span class="comment">// If the Queue object entry list is not empty, then remove the next</span>
00353     <span class="comment">// entry from the Queue object entry list. Otherwise, wait for an entry</span>
00354     <span class="comment">// to be inserted in the queue.</span>
00355     <span class="comment">//</span>
00356 
00357     OriginalTime = Timeout;
00358     <span class="keywordflow">do</span> {
00359 
00360         <span class="comment">//</span>
00361         <span class="comment">// Check if there is a queue entry available and the current</span>
00362         <span class="comment">// number of active threads is less than target maximum number</span>
00363         <span class="comment">// of threads.</span>
00364         <span class="comment">//</span>
00365 
00366         Entry = Queue-&gt;EntryListHead.Flink;
00367         <span class="keywordflow">if</span> ((Entry != &amp;Queue-&gt;EntryListHead) &amp;&amp;
00368             (Queue-&gt;CurrentCount &lt; Queue-&gt;MaximumCount)) {
00369 
00370             <span class="comment">//</span>
00371             <span class="comment">// Decrement the number of entires in the Queue object entry list,</span>
00372             <span class="comment">// increment the number of active threads, remove the next entry</span>
00373             <span class="comment">// rom the list, and set the forward link to NULL.</span>
00374             <span class="comment">//</span>
00375 
00376             Queue-&gt;Header.SignalState -= 1;
00377             Queue-&gt;CurrentCount += 1;
00378             <span class="keywordflow">if</span> ((Entry-&gt;Flink == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (Entry-&gt;Blink == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00379                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(INVALID_WORK_QUEUE_ITEM,
00380                              (ULONG_PTR)Entry,
00381                              (ULONG_PTR)Queue,
00382                              (ULONG_PTR)&amp;ExWorkerQueue[0],
00383                              (ULONG_PTR)((<a class="code" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">PWORK_QUEUE_ITEM</a>)Entry)-&gt;WorkerRoutine);
00384             }
00385 
00386             RemoveEntryList(Entry);
00387             Entry-&gt;Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00388             <span class="keywordflow">break</span>;
00389 
00390         } <span class="keywordflow">else</span> {
00391 
00392             <span class="comment">//</span>
00393             <span class="comment">// Set address of wait block list in thread object.</span>
00394             <span class="comment">//</span>
00395 
00396             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o21">WaitBlockList</a> = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[0];
00397 
00398             <span class="comment">//</span>
00399             <span class="comment">// Test to determine if a kernel APC is pending.</span>
00400             <span class="comment">//</span>
00401             <span class="comment">// If a kernel APC is pending and the previous IRQL was less than</span>
00402             <span class="comment">// APC_LEVEL, then a kernel APC was queued by another processor</span>
00403             <span class="comment">// just after IRQL was raised to DISPATCH_LEVEL, but before the</span>
00404             <span class="comment">// dispatcher database was locked.</span>
00405             <span class="comment">//</span>
00406             <span class="comment">// N.B. that this can only happen in a multiprocessor system.</span>
00407             <span class="comment">//</span>
00408 
00409             <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>)) {
00410 
00411                 <span class="comment">//</span>
00412                 <span class="comment">// Increment the current thread count, unlock the dispatcher</span>
00413                 <span class="comment">// database, and lower IRQL to previous value. An APC interrupt</span>
00414                 <span class="comment">// will immediately occur which will result in the delivery of</span>
00415                 <span class="comment">// the kernel APC if possible.</span>
00416                 <span class="comment">//</span>
00417 
00418                 Queue-&gt;CurrentCount += 1;
00419                 <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00420 
00421             } <span class="keywordflow">else</span> {
00422 
00423                 <span class="comment">//</span>
00424                 <span class="comment">// Test if a user APC is pending.</span>
00425                 <span class="comment">//</span>
00426 
00427                 <span class="keywordflow">if</span> ((WaitMode != <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>) &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o4">UserApcPending</a>)) {
00428                     Entry = (PLIST_ENTRY)ULongToPtr(STATUS_USER_APC);
00429                     Queue-&gt;CurrentCount += 1;
00430                     <span class="keywordflow">break</span>;
00431                 }
00432 
00433                 <span class="comment">//</span>
00434                 <span class="comment">// Construct a wait block and check to determine if the wait</span>
00435                 <span class="comment">// is already satisfied. If the wait is satisfied, then perform</span>
00436                 <span class="comment">// wait completion and return. Else put current thread in a</span>
00437                 <span class="comment">// wait state if an explicit timeout value of zero is not</span>
00438                 <span class="comment">// specified.</span>
00439                 <span class="comment">//</span>
00440 
00441                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o16">WaitStatus</a> = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)0;
00442                 WaitBlock = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[0];
00443                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o2">Object</a> = (PVOID)Queue;
00444                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a> = (CSHORT)(STATUS_SUCCESS);
00445                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> = WaitAny;
00446                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o1">Thread</a> = Thread;
00447 
00448                 <span class="comment">//</span>
00449                 <span class="comment">// Check to determine if a timeout value is specified.</span>
00450                 <span class="comment">//</span>
00451 
00452                 <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Timeout)) {
00453 
00454                     <span class="comment">//</span>
00455                     <span class="comment">// If the timeout value is zero, then return immediately</span>
00456                     <span class="comment">// without waiting.</span>
00457                     <span class="comment">//</span>
00458 
00459                     <span class="keywordflow">if</span> (!(Timeout-&gt;LowPart | Timeout-&gt;HighPart)) {
00460                         Entry = (PLIST_ENTRY)ULongToPtr(STATUS_TIMEOUT);
00461                         Queue-&gt;CurrentCount += 1;
00462                         <span class="keywordflow">break</span>;
00463                     }
00464 
00465                     <span class="comment">//</span>
00466                     <span class="comment">// Initialize a wait block for the thread specific timer,</span>
00467                     <span class="comment">// insert wait block in timer wait list, insert the timer</span>
00468                     <span class="comment">// in the timer tree.</span>
00469                     <span class="comment">//</span>
00470 
00471                     Timer = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o39">Timer</a>;
00472                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[1];
00473                     WaitBlock = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[1];
00474                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o2">Object</a> = (PVOID)Timer;
00475                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a> = (CSHORT)(STATUS_TIMEOUT);
00476                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> = WaitAny;
00477                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o1">Thread</a> = Thread;
00478                     Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>.Flink = &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>;
00479                     Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>.Blink = &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>;
00480                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>.Flink = &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>;
00481                     WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>.Blink = &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>;
00482                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/timersup_8c.html#a1">KiInsertTreeTimer</a>(Timer, *Timeout) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00483                         Entry = (PLIST_ENTRY)ULongToPtr(STATUS_TIMEOUT);
00484                         Queue-&gt;CurrentCount += 1;
00485                         <span class="keywordflow">break</span>;
00486                     }
00487 
00488                     DueTime.QuadPart = Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o1">DueTime</a>.QuadPart;
00489                 }
00490 
00491                 <span class="comment">//</span>
00492                 <span class="comment">// Close up the circular list of wait control blocks.</span>
00493                 <span class="comment">//</span>
00494 
00495                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[0];
00496 
00497                 <span class="comment">//</span>
00498                 <span class="comment">// Insert wait block in object wait list.</span>
00499                 <span class="comment">//</span>
00500 
00501                 WaitBlock = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[0];
00502                 InsertTailList(&amp;Queue-&gt;Header.WaitListHead, &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>);
00503 
00504                 <span class="comment">//</span>
00505                 <span class="comment">// Set the thread wait parameters, set the thread dispatcher</span>
00506                 <span class="comment">// state to Waiting, and insert the thread in the wait list.</span>
00507                 <span class="comment">//</span>
00508 
00509                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o57">Alertable</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00510                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o18">WaitMode</a> = WaitMode;
00511                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o20">WaitReason</a> = <a class="code" href="../../d4/d9/ke_8h.html#a407a213">WrQueue</a>;
00512                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o23">WaitTime</a> = KiQueryLowTickCount();
00513                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>;
00514                 <a class="code" href="../../d0/d0/ki_8h.html#a15">KiInsertWaitList</a>(WaitMode, Thread);
00515 
00516                 <span class="comment">//</span>
00517                 <span class="comment">// Switch context to selected thread.</span>
00518                 <span class="comment">//</span>
00519                 <span class="comment">// Control is returned at the original IRQL.</span>
00520                 <span class="comment">//</span>
00521 
00522                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt;= DISPATCH_LEVEL);
00523 
00524                 WaitStatus = <a class="code" href="../../d0/d0/ki_8h.html#a138">KiSwapThread</a>();
00525 
00526                 <span class="comment">//</span>
00527                 <span class="comment">// If the thread was not awakened to deliver a kernel mode APC,</span>
00528                 <span class="comment">// then return wait status.</span>
00529                 <span class="comment">//</span>
00530 
00531                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o20">WaitReason</a> = 0;
00532                 <span class="keywordflow">if</span> (WaitStatus != STATUS_KERNEL_APC) {
00533                     <span class="keywordflow">return</span> (PLIST_ENTRY)WaitStatus;
00534                 }
00535 
00536                 <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Timeout)) {
00537 
00538                     <span class="comment">//</span>
00539                     <span class="comment">// Reduce the amount of time remaining before timeout occurs.</span>
00540                     <span class="comment">//</span>
00541 
00542                     Timeout = <a class="code" href="../../d1/d7/wait_8c.html#a6">KiComputeWaitInterval</a>(OriginalTime,
00543                                                     &amp;DueTime,
00544                                                     &amp;NewTime);
00545                 }
00546             }
00547 
00548             <span class="comment">//</span>
00549             <span class="comment">// Raise IRQL to DISPATCH_LEVEL, lock the dispatcher database,</span>
00550             <span class="comment">// and decrement the count of active threads.</span>
00551             <span class="comment">//</span>
00552 
00553             <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00554             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00555             Queue-&gt;CurrentCount -= 1;
00556         }
00557 
00558     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00559 
00560     <span class="comment">//</span>
00561     <span class="comment">// Unlock the dispatcher database and return the list entry address or a</span>
00562     <span class="comment">// status of timeout.</span>
00563     <span class="comment">//</span>
00564 
00565     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00566     <span class="keywordflow">return</span> Entry;
00567 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a258" doxytag="ke.h::KeRemoveQueueApc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeRemoveQueueApc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Apc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00291">291</a> of file <a class="el" href="../../d6/d6/apcobj_8c-source.html">apcobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00243">_KAPC_STATE::ApcListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00613">_KTHREAD::ApcQueueLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00638">_KTHREAD::ApcStatePointer</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d6/apcobj_8c-source.html#l00033">ASSERT_APC</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a55">PKAPC_STATE</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00247">_KAPC_STATE::UserApcPending</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01028">CmNotifyRunDown()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00346">ExTimerRundown()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00679">NtCancelTimer()</a>, and <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>.
<p>
<pre class="fragment"><div>00297                    :
00298 
00299     This function removes an APC object from an APC queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object
00300     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in an APC queue, then no operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Otherwise <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00301     APC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from its current queue and its inserted state <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00302     set <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.
00303 
00304 Arguments:
00305 
00306     Apc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> APC.
00307 
00308 Return Value:
00309 
00310     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> APC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in an APC queue, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00311     Otherwise a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00312 
00313 --*/
00314 
00315 {
00316 
00317     <a class="code" href="../../d3/d5/struct__KAPC__STATE.html">PKAPC_STATE</a> ApcState;
00318     BOOLEAN Inserted;
00319     KIRQL OldIrql;
00320     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00321 
00322     <a class="code" href="../../d5/d7/apcobj_8c.html#a0">ASSERT_APC</a>(Apc);
00323     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00324 
00325     <span class="comment">//</span>
00326     <span class="comment">// Raise IRQL to dispatcher level, lock dispatcher database, and</span>
00327     <span class="comment">// lock the APC queue.</span>
00328     <span class="comment">//</span>
00329 
00330     Thread = Apc-&gt;Thread;
00331     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00332     KiAcquireSpinLock(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o38">ApcQueueLock</a>);
00333 
00334     <span class="comment">//</span>
00335     <span class="comment">// If the APC object is in an APC queue, then remove it from the queue</span>
00336     <span class="comment">// and set its inserted state to FALSE. If the queue becomes empty, set</span>
00337     <span class="comment">// the APC pending state to FALSE.</span>
00338     <span class="comment">//</span>
00339 
00340     Inserted = Apc-&gt;Inserted;
00341     <span class="keywordflow">if</span> (Inserted != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00342         Apc-&gt;Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00343         ApcState = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o49">ApcStatePointer</a>[Apc-&gt;ApcStateIndex];
00344         RemoveEntryList(&amp;Apc-&gt;ApcListEntry);
00345         <span class="keywordflow">if</span> (IsListEmpty(&amp;ApcState-&gt;<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[Apc-&gt;ApcMode]) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00346             <span class="keywordflow">if</span> (Apc-&gt;ApcMode == <a class="code" href="../../d6/d7/halmips_8h.html#a456">KernelMode</a>) {
00347                 ApcState-&gt;<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00348 
00349             } <span class="keywordflow">else</span> {
00350                 ApcState-&gt;<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o4">UserApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00351             }
00352         }
00353     }
00354 
00355     <span class="comment">//</span>
00356     <span class="comment">// Unlock the APC queue, unlock the dispatcher database, lower IRQL to</span>
00357     <span class="comment">// its previous value, and return whether an APC object was removed from</span>
00358     <span class="comment">// the APC queue.</span>
00359     <span class="comment">//</span>
00360 
00361     KiReleaseSpinLock(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o38">ApcQueueLock</a>);
00362     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00363     <span class="keywordflow">return</span> Inserted;
00364 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a261" doxytag="ke.h::KeRemoveQueueDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeRemoveQueueDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Dpc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00272">272</a> of file <a class="el" href="../../d5/d0/dpcobj_8c-source.html">dpcobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00034">ASSERT_DPC</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l00346">ExTimerRundown()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00679">NtCancelTimer()</a>, and <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>.
<p>
<pre class="fragment"><div>00278                    :
00279 
00280     This function removes a DPC object from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object
00281     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue, then no operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed. Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00282     DPC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue and its inserted state <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set
00283     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.
00284 
00285 Arguments:
00286 
00287     Dpc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00288 
00289 Return Value:
00290 
00291     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC queue, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00292     returned. Otherwise a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00293 
00294 --*/
00295 
00296 {
00297 
00298     PKSPIN_LOCK <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>;
00299     PKPRCB Prcb;
00300 
00301     <a class="code" href="../../d4/d1/dpcobj_8c.html#a0">ASSERT_DPC</a>(Dpc);
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">// If the DPC object is in the DPC queue, then remove it from the queue</span>
00305     <span class="comment">// and set its inserted state to FALSE.</span>
00306     <span class="comment">//</span>
00307 
00308     _disable();
00309     <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> = Dpc-&gt;Lock;
00310     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00311 
00312         <span class="comment">//</span>
00313         <span class="comment">// Acquire the DPC lock of the target processor.</span>
00314         <span class="comment">//</span>
00315 
00316 <span class="preprocessor">#if !defined(NT_UP)</span>
00317 <span class="preprocessor"></span>
00318         KiAcquireSpinLock(Lock);
00319 
00320 <span class="preprocessor">#endif</span>
00321 <span class="preprocessor"></span>
00322         <span class="comment">//</span>
00323         <span class="comment">// If the specified DPC is still in the DPC queue, then remove</span>
00324         <span class="comment">// it.</span>
00325         <span class="comment">//</span>
00326         <span class="comment">// N.B. It is possible for specified DPC to be removed from the</span>
00327         <span class="comment">//      specified DPC queue before the DPC lock is obtained.</span>
00328         <span class="comment">//</span>
00329         <span class="comment">//</span>
00330 
00331         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> == Dpc-&gt;Lock) {
00332             Prcb = CONTAINING_RECORD(Lock, KPRCB, DpcLock);
00333             Prcb-&gt;DpcQueueDepth -= 1;
00334             RemoveEntryList(&amp;Dpc-&gt;DpcListEntry);
00335 
00336 <span class="preprocessor">#if defined(_ALPHA_) &amp;&amp; !defined(NT_UP)</span>
00337 <span class="preprocessor"></span>
00338             __MB();
00339 
00340 <span class="preprocessor">#endif</span>
00341 <span class="preprocessor"></span>
00342             Dpc-&gt;Lock = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00343         }
00344 
00345         <span class="comment">//</span>
00346         <span class="comment">// Release the DPC lock of the target processor.</span>
00347         <span class="comment">//</span>
00348 
00349 <span class="preprocessor">#if !defined(NT_UP)</span>
00350 <span class="preprocessor"></span>
00351         KiReleaseSpinLock(Lock);
00352 
00353 <span class="preprocessor">#endif</span>
00354 <span class="preprocessor"></span>
00355     }
00356 
00357     <span class="comment">//</span>
00358     <span class="comment">// Enable interrupts and return whether the DPC was removed from a DPC</span>
00359     <span class="comment">// queue.</span>
00360     <span class="comment">//</span>
00361 
00362     _enable();
00363     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00364 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a281" doxytag="ke.h::KeResetEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeResetEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Event</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00285">285</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00648">NtResetEvent()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02425">SmbTraceToClient()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>.
<p>
<pre class="fragment"><div>00291                    :
00292 
00293     This function resets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to
00294     Not-Signaled. The previous state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00295     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00296 
00297 Arguments:
00298 
00299     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00300 
00301 Return Value:
00302 
00303     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00304 
00305 --*/
00306 
00307 {
00308 
00309     KIRQL OldIrql;
00310     LONG OldState;
00311 
00312     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00313     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00314 
00315     <span class="comment">//</span>
00316     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00317     <span class="comment">//</span>
00318 
00319     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00320 
00321     <span class="comment">//</span>
00322     <span class="comment">// Capture the current signal state of event object and then reset</span>
00323     <span class="comment">// the state of the event object to Not-Signaled.</span>
00324     <span class="comment">//</span>
00325 
00326     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00327     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 0;
00328 
00329     <span class="comment">//</span>
00330     <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00331     <span class="comment">// value.</span>
00332 
00333     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00334 
00335     <span class="comment">//</span>
00336     <span class="comment">// Return previous signal state of event object.</span>
00337     <span class="comment">//</span>
00338 
00339     <span class="keywordflow">return</span> OldState;
00340 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a327" doxytag="ke.h::KeResumeThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KeResumeThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Thread</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01079">1079</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, and <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00138">NtResumeThread()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.
<p>
<pre class="fragment"><div>01085                    :
01086 
01087     This function resumes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of a suspended thread. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01088     specified thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not suspended, then no operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed.
01089 
01090 Arguments:
01091 
01092     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01093 
01094 Return Value:
01095 
01096     The previous suspend count.
01097 
01098 --*/
01099 
01100 {
01101 
01102     ULONG OldCount;
01103     KIRQL OldIrql;
01104 
01105     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01106     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01107 
01108     <span class="comment">//</span>
01109     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01110     <span class="comment">//</span>
01111 
01112     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01113 
01114     <span class="comment">//</span>
01115     <span class="comment">// Capture the current suspend count.</span>
01116     <span class="comment">//</span>
01117 
01118     OldCount = Thread-&gt;SuspendCount;
01119 
01120     <span class="comment">//</span>
01121     <span class="comment">// If the thread is currently suspended, then decrement its suspend count.</span>
01122     <span class="comment">//</span>
01123 
01124     <span class="keywordflow">if</span> (OldCount != 0) {
01125         Thread-&gt;SuspendCount -= 1;
01126 
01127         <span class="comment">//</span>
01128         <span class="comment">// If the resultant suspend count is zero and the freeze count is</span>
01129         <span class="comment">// zero, then resume the thread by releasing its suspend semaphore.</span>
01130         <span class="comment">//</span>
01131 
01132         <span class="keywordflow">if</span> ((Thread-&gt;SuspendCount == 0) &amp;&amp; (Thread-&gt;FreezeCount == 0)) {
01133             Thread-&gt;SuspendSemaphore.Header.SignalState += 1;
01134             <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;Thread-&gt;SuspendSemaphore, RESUME_INCREMENT);
01135         }
01136     }
01137 
01138     <span class="comment">//</span>
01139     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01140     <span class="comment">// value.</span>
01141     <span class="comment">//</span>
01142 
01143     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01144 
01145     <span class="comment">//</span>
01146     <span class="comment">// Return the previous suspend count.</span>
01147     <span class="comment">//</span>
01148 
01149     <span class="keywordflow">return</span> OldCount;
01150 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a390" doxytag="ke.h::KeReturnToFirmware" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeReturnToFirmware           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Routine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00499">499</a> of file <a class="el" href="../../d0/d4/ke_2debug_8c-source.html">ke/debug.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a118">FIRMWARE_REENTRY</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware()</a>.
<p>
Referenced by <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01519">IoWriteCrashDump()</a>.
<p>
<pre class="fragment"><div>00505                    :
00506 
00507     This routine will thaw all other processors in an MP environment to cause
00508     them to <span class="keywordflow">return</span> to <span class="keywordflow">do</span> a <span class="keywordflow">return</span> to firmware with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> supplied parameter.
00509 
00510     It will then call <a class="code" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware</a> itself.
00511 
00512     N.B. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that we are in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> environment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel debugger
00513     or a crash dump.
00514 
00515 
00516 Arguments:
00517 
00518     Routine - What to invoke on <span class="keywordflow">return</span> to firmware.
00519 
00520 Return Value:
00521 
00522     None.
00523 
00524 --*/
00525 
00526 {
00527 
00528     <span class="comment">//</span>
00529     <span class="comment">// Just get the interface in now.  When intel and kenr come up with the</span>
00530     <span class="comment">// right stuff we can fill this in.</span>
00531     <span class="comment">//</span>
00532 
00533     <a class="code" href="../../d2/d7/hal_8h.html#a177">HalReturnToFirmware</a>(Routine);
00534 
00535 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a328" doxytag="ke.h::KeRevertToUserAffinityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeRevertToUserAffinityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">1153</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00622">_KTHREAD::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00479">KiSelectNextThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00598">_KTHREAD::SystemAffinityActive</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00597">_KTHREAD::UserAffinity</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01986">CmpConfigureProcessors()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00060">Ke386CallBios()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00154">KeConnectInterrupt()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00298">KeDisconnectInterrupt()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.
<p>
<pre class="fragment"><div>01159                    :
01160 
01161     This function setss <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> affinity of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread to its user
01162     affinity.
01163 
01164 Arguments:
01165 
01166     None.
01167 
01168 Return Value:
01169 
01170     None.
01171 
01172 --*/
01173 
01174 {
01175 
01176     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> CurrentThread;
01177     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> NextThread;
01178     KIRQL OldIrql;
01179     PKPRCB Prcb;
01180 
01181     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01182     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;SystemAffinityActive != FALSE);
01183 
01184     <span class="comment">//</span>
01185     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01186     <span class="comment">//</span>
01187 
01188     CurrentThread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
01189     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01190 
01191     <span class="comment">//</span>
01192     <span class="comment">// Set the current affinity to the user affinity.</span>
01193     <span class="comment">//</span>
01194     <span class="comment">// If the current processor is not in the new affinity set and another</span>
01195     <span class="comment">// thread has not already been selected for execution on the current</span>
01196     <span class="comment">// processor, then select a new thread for the current processor.</span>
01197     <span class="comment">//</span>
01198 
01199     CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a> = CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o31">UserAffinity</a>;
01200     CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o32">SystemAffinityActive</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01201     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01202     <span class="keywordflow">if</span> (((Prcb-&gt;SetMember &amp; CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a>) == 0) &amp;&amp;
01203         (Prcb-&gt;NextThread == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
01204         NextThread = <a class="code" href="../../d0/d2/thredsup_8c.html#a4">KiSelectNextThread</a>(CurrentThread);
01205         NextThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
01206         Prcb-&gt;NextThread = NextThread;
01207     }
01208 
01209     <span class="comment">//</span>
01210     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous value.</span>
01211     <span class="comment">//</span>
01212 
01213     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01214     <span class="keywordflow">return</span>;
01215 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a295" doxytag="ke.h::KeRundownQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PLIST_ENTRY KeRundownQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Queue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00570">570</a> of file <a class="el" href="../../d9/d2/queueobj_8c-source.html">queueobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00033">ASSERT_QUEUE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00612">_KTHREAD::Queue</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/complete_8c-source.html#l00864">IopDeleteIoCompletion()</a>.
<p>
<pre class="fragment"><div>00576                    :
00577 
00578     This function runs down <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified queue by removing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> listhead
00579     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue list, removing any associated threads from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread
00580     list, and returning <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first entry.
00581 
00582 
00583 Arguments:
00584 
00585     Queue - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> Queue.
00586 
00587 Return Value:
00588 
00589     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue list <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not empty, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first entry in
00590     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value. Otherwise, a value of <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00591     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00592 
00593 --*/
00594 
00595 {
00596 
00597     PLIST_ENTRY Entry;
00598     PLIST_ENTRY FirstEntry;
00599     KIRQL OldIrql;
00600     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00601 
00602     <a class="code" href="../../d8/d3/queueobj_8c.html#a0">ASSERT_QUEUE</a>(Queue);
00603     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00604 
00605     <span class="comment">//</span>
00606     <span class="comment">// Raise IRQL to dispatch level and lock the dispatcher database.</span>
00607     <span class="comment">//</span>
00608 
00609     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00610 
00611     <span class="comment">//</span>
00612     <span class="comment">// Get the address of the first entry in the queue and check if the</span>
00613     <span class="comment">// list is empty or contains entries that should be flushed. If there</span>
00614     <span class="comment">// are no entries in the list, then set the return value to NULL.</span>
00615     <span class="comment">// Otherwise, set the return value to the address of the first list</span>
00616     <span class="comment">// entry and remove the listhead from the list.</span>
00617     <span class="comment">//</span>
00618 
00619     FirstEntry = Queue-&gt;EntryListHead.Flink;
00620     <span class="keywordflow">if</span> (FirstEntry == &amp;Queue-&gt;EntryListHead) {
00621         FirstEntry = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00622 
00623     } <span class="keywordflow">else</span> {
00624         RemoveEntryList(&amp;Queue-&gt;EntryListHead);
00625     }
00626 
00627     <span class="comment">//</span>
00628     <span class="comment">// Remove all associated threads from the thread list of the queue.</span>
00629     <span class="comment">//</span>
00630 
00631     <span class="keywordflow">while</span> (Queue-&gt;ThreadListHead.Flink != &amp;Queue-&gt;ThreadListHead) {
00632         Entry = Queue-&gt;ThreadListHead.Flink;
00633         Thread = CONTAINING_RECORD(Entry, <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>, QueueListEntry);
00634         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00635         RemoveEntryList(Entry);
00636     }
00637 
00638     <span class="comment">//</span>
00639     <span class="comment">// Unlock the dispatcher database, lower IRQL to its previous level,</span>
00640     <span class="comment">// and return the function value.</span>
00641     <span class="comment">//</span>
00642 
00643     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00644     <span class="keywordflow">return</span> FirstEntry;
00645 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a329" doxytag="ke.h::KeRundownThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeRundownThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a371" doxytag="ke.h::KeSaveStateForHibernate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID __cdecl KeSaveStateForHibernate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKPROCESSOR_STATE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ProcessorState</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00542">542</a> of file <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html">ke/i386/misc.c</a>.
<p>
<pre class="fragment"><div>00547                    :
00548 
00549     Saves all processor-specific state that must be preserved
00550     across an S4 state (hibernation).
00551 
00552     N.B. #pragma surrounding <span class="keyword">this</span> function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> required in order
00553          to create <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame pointer than RtlCaptureContext relies
00554          on.
00555     N.B. _CRTAPI1 (__cdecl) decoration is also required so that
00556          RtlCaptureContext can compute the correct ESP.
00557 
00558 Arguments:
00559 
00560     ProcessorState - Supplies the KPROCESSOR_STATE where the
00561         current CPU's state is to be saved.
00562 
00563 Return Value:
00564 
00565     None.
00566 
00567 --*/
00568 
00569 {
00570     RtlCaptureContext(&amp;ProcessorState-&gt;ContextFrame);
00571     <a class="code" href="../../d9/d6/ppc_2ipi_8c.html#a1">KiSaveProcessorControlState</a>(ProcessorState);
00572 }
<span class="preprocessor">#pragma optimize( "y", off )    // disable frame pointer omission (FPO)</span>
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a330" doxytag="ke.h::KeSetAffinityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KAFFINITY KeSetAffinityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KAFFINITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Affinity</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01302">1302</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00766">_KPROCESS::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00058">ClearMember</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00021">INVALID_AFFINITY_SET</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00036">KiDispatcherReadyListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00052">KiReadySummary</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00270">KiReadyThread()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00782">KiRequestDispatchInterrupt</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00479">KiSelectNextThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a193">Running</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, and <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>.
<p>
<pre class="fragment"><div>01309                    :
01310 
01311     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> affinity of a specified thread to a <span class="keyword">new</span>
01312     value. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> affinity <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not a proper subset of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parent
01313     process affinity, or <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> null, then an error condition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
01314     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> running on, or about to run on, a
01315     processor <span class="keywordflow">for</span> which <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no longer able to run, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target
01316     processor <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> rescheduled. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in a ready
01317     state and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parent process ready queue, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01318     rereadied to reevaluate any additional processors <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> may run on.
01319 
01320 Arguments:
01321 
01322     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01323 
01324     Affinity - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> of set of processors on which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread
01325         can run.
01326 
01327 Return Value:
01328 
01329     The previous affinity of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
01330 
01331 --*/
01332 
01333 {
01334 
01335     KAFFINITY OldAffinity;
01336     KIRQL OldIrql;
01337     PKPRCB Prcb;
01338     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
01339     ULONG Processor;
01340     KPRIORITY ThreadPriority;
01341     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread1;
01342 
01343     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01344     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01345 
01346     <span class="comment">//</span>
01347     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01348     <span class="comment">//</span>
01349 
01350     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01351 
01352     <span class="comment">//</span>
01353     <span class="comment">// Capture the current affinity of the specified thread and get address</span>
01354     <span class="comment">// of parent process object;</span>
01355     <span class="comment">//</span>
01356 
01357     OldAffinity = Thread-&gt;UserAffinity;
01358     Process = Thread-&gt;ApcStatePointer[0]-&gt;Process;
01359 
01360     <span class="comment">//</span>
01361     <span class="comment">// If new affinity is not a proper subset of the parent process affinity,</span>
01362     <span class="comment">// or the new affinity is null, then bugcheck.</span>
01363     <span class="comment">//</span>
01364 
01365     <span class="keywordflow">if</span> (((Affinity &amp; Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o10">Affinity</a>) != (Affinity)) || (!Affinity)) {
01366         <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(INVALID_AFFINITY_SET);
01367     }
01368 
01369     <span class="comment">//</span>
01370     <span class="comment">// Set the thread user affinity to the specified value.</span>
01371     <span class="comment">//</span>
01372     <span class="comment">// If the thread is not current executing with system affinity active,</span>
01373     <span class="comment">// then set the thread current affinity and switch on the thread state.</span>
01374     <span class="comment">//</span>
01375 
01376     Thread-&gt;UserAffinity = Affinity;
01377     <span class="keywordflow">if</span> (Thread-&gt;SystemAffinityActive == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01378         Thread-&gt;Affinity = Affinity;
01379         <span class="keywordflow">switch</span> (Thread-&gt;State) {
01380 
01381             <span class="comment">//</span>
01382             <span class="comment">// Ready State.</span>
01383             <span class="comment">//</span>
01384             <span class="comment">// If the thread is not in the process ready queue, then remove</span>
01385             <span class="comment">// it from its current dispatcher ready queue and reready it for</span>
01386             <span class="comment">// execution.</span>
01387             <span class="comment">//</span>
01388 
01389         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>:
01390             <span class="keywordflow">if</span> (Thread-&gt;ProcessReadyQueue == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01391                 RemoveEntryList(&amp;Thread-&gt;WaitListEntry);
01392                 ThreadPriority = Thread-&gt;Priority;
01393                 <span class="keywordflow">if</span> (IsListEmpty(&amp;KiDispatcherReadyListHead[ThreadPriority]) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01394                     <a class="code" href="../../d0/d0/ki_8h.html#a6">ClearMember</a>(ThreadPriority, KiReadySummary);
01395                 }
01396 
01397                 <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
01398             }
01399 
01400             <span class="keywordflow">break</span>;
01401 
01402             <span class="comment">//</span>
01403             <span class="comment">// Standby State.</span>
01404             <span class="comment">//</span>
01405             <span class="comment">// If the target processor is not in the new affinity set, then</span>
01406             <span class="comment">// set the next thread to null for the target processor, select</span>
01407             <span class="comment">// a new thread to run on the target processor, and reready the</span>
01408             <span class="comment">// thread for execution.</span>
01409             <span class="comment">//</span>
01410 
01411         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>:
01412             Processor = Thread-&gt;NextProcessor;
01413             Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[Processor];
01414             <span class="keywordflow">if</span> ((Prcb-&gt;SetMember &amp; Affinity) == 0) {
01415                 Prcb-&gt;NextThread = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01416                 Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a4">KiSelectNextThread</a>(Thread);
01417                 Thread1-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
01418                 Prcb-&gt;NextThread = Thread1;
01419                 <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
01420             }
01421 
01422             <span class="keywordflow">break</span>;
01423 
01424             <span class="comment">//</span>
01425             <span class="comment">// Running State.</span>
01426             <span class="comment">//</span>
01427             <span class="comment">// If the target processor is not in the new affinity set and</span>
01428             <span class="comment">// another thread has not already been selected for execution</span>
01429             <span class="comment">// on the target processor, then select a new thread for the</span>
01430             <span class="comment">// target processor, and cause the target processor to be</span>
01431             <span class="comment">// redispatched.</span>
01432             <span class="comment">//</span>
01433 
01434         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a193">Running</a>:
01435             Processor = Thread-&gt;NextProcessor;
01436             Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[Processor];
01437             <span class="keywordflow">if</span> (((Prcb-&gt;SetMember &amp; Affinity) == 0) &amp;&amp;
01438                 (Prcb-&gt;NextThread == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
01439                 Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a4">KiSelectNextThread</a>(Thread);
01440                 Thread1-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
01441                 Prcb-&gt;NextThread = Thread1;
01442                 <a class="code" href="../../d0/d0/ki_8h.html#a24">KiRequestDispatchInterrupt</a>(Processor);
01443             }
01444 
01445             <span class="keywordflow">break</span>;
01446 
01447             <span class="comment">//</span>
01448             <span class="comment">// Initialized, Terminated, Waiting, Transition case - For these</span>
01449             <span class="comment">// states it is sufficient to just set the new thread affinity.</span>
01450             <span class="comment">//</span>
01451 
01452         <span class="keywordflow">default</span>:
01453             <span class="keywordflow">break</span>;
01454         }
01455     }
01456 
01457     <span class="comment">//</span>
01458     <span class="comment">// Unlock dispatcher database, lower IRQL to its previous value, and</span>
01459     <span class="comment">// return the previous user affinity.</span>
01460     <span class="comment">//</span>
01461 
01462     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01463     <span class="keywordflow">return</span> OldAffinity;
01464 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a306" doxytag="ke.h::KeSetAutoAlignmentProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeSetAutoAlignmentProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Enable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/ia64_2thredini_8c-source.html#l00224">224</a> of file <a class="el" href="../../d7/d0/ia64_2thredini_8c-source.html">ia64/thredini.c</a>.
<p>
<pre class="fragment"><div>00231                    :
00232 
00233     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data alignment handling mode <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00234     process and returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous data alignment handling mode.
00235 
00236 Arguments:
00237 
00238     Process  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00239 
00240     Enable - Supplies a <span class="keywordtype">boolean</span> value that determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handling of data
00241         alignment exceptions <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> causes all
00242         data alignment exceptions to be automatically handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel.
00243         <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> causes all data alignment exceptions to be actually
00244         raised as exceptions.
00245 
00246 Return Value:
00247 
00248     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> data alignment exceptions were
00249     previously automatically handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel. Otherwise, a value
00250     of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00251 
00252 --*/
00253 
00254 {
00255 
00256     KIRQL OldIrql;
00257     BOOLEAN Previous;
00258 
00259     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00263     <span class="comment">//</span>
00264 
00265     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00266 
00267     <span class="comment">//</span>
00268     <span class="comment">// Capture the previous data alignment handling mode and set the</span>
00269     <span class="comment">// specified data alignment mode.</span>
00270     <span class="comment">//</span>
00271 
00272     Previous = Process-&gt;AutoAlignment;
00273     Process-&gt;AutoAlignment = Enable;
00274 
00275     <span class="comment">//</span>
00276     <span class="comment">// Unlock dispatcher database, lower IRQL to its previous value, and</span>
00277     <span class="comment">// return the previous data alignment mode.</span>
00278     <span class="comment">//</span>
00279 
00280     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00281     <span class="keywordflow">return</span> Previous;
00282 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a332" doxytag="ke.h::KeSetAutoAlignmentThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeSetAutoAlignmentThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Enable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00269">269</a> of file <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html">alpha/thredini.c</a>.
<p>
References <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.
<p>
<pre class="fragment"><div>00276                    :
00277 
00278     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> data alignment handling mode <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00279     thread and returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous data alignment handling mode.
00280 
00281 Arguments:
00282 
00283     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00284 
00285     Enable - Supplies a <span class="keywordtype">boolean</span> value that determines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handling of data
00286         alignment exceptions <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> causes all
00287         data alignment exceptions to be automatically handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel.
00288         <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> causes all data alignment exceptions to be actually
00289         raised as exceptions.
00290 
00291 Return Value:
00292 
00293     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> data alignment exceptions were
00294     previously automatically handled by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel. Otherwise, a value
00295     of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00296 
00297 --*/
00298 
00299 {
00300 
00301     KIRQL OldIrql;
00302     BOOLEAN Previous;
00303 
00304     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
00305 
00306     <span class="comment">//</span>
00307     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00308     <span class="comment">//</span>
00309 
00310     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00311 
00312     <span class="comment">//</span>
00313     <span class="comment">// Capture the previous data alignment handling mode and set the</span>
00314     <span class="comment">// specified data alignment mode.</span>
00315     <span class="comment">//</span>
00316 
00317     Previous = Thread-&gt;AutoAlignment;
00318     Thread-&gt;AutoAlignment = Enable;
00319 
00320     <span class="comment">//</span>
00321     <span class="comment">// Unlock dispatcher database, lower IRQL to its previous value, and</span>
00322     <span class="comment">// return the previous data alignment mode.</span>
00323     <span class="comment">//</span>
00324 
00325     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00326     <span class="keywordflow">return</span> Previous;
00327 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a333" doxytag="ke.h::KeSetBasePriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeSetBasePriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01532">1532</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02354">abs</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00768">_KPROCESS::BasePriority</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">KiSetPriorityThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00971">ExpCreateWorkerThread()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00431">ExpWorkerThreadBalanceManager()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.
<p>
<pre class="fragment"><div>01539                    :
01540 
01541     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread to a
01542     <span class="keyword">new</span> value.  The <span class="keyword">new</span> base priority <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process base
01543     priority plus <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> increment.
01544 
01545 Arguments:
01546 
01547     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01548 
01549     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority increment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> subject thread.
01550 
01551         N.B. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> absolute value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> increment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> such that saturation
01552              of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> forced, then subsequent changes to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01553              parent process base priority will not change <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority
01554              of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread.
01555 
01556 Return Value:
01557 
01558     The previous base priority increment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
01559 
01560 --*/
01561 
01562 {
01563 
01564     KPRIORITY NewBase;
01565     KPRIORITY NewPriority;
01566     KPRIORITY OldBase;
01567     LONG OldIncrement;
01568     KIRQL OldIrql;
01569     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
01570 
01571     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01572     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01573 
01574     <span class="comment">//</span>
01575     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01576     <span class="comment">//</span>
01577 
01578     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01579 
01580     <span class="comment">//</span>
01581     <span class="comment">// Capture the base priority of the specified thread and determine</span>
01582     <span class="comment">// whether saturation if being forced.</span>
01583     <span class="comment">//</span>
01584 
01585     Process = Thread-&gt;ApcStatePointer[0]-&gt;Process;
01586     OldBase = Thread-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o12">BasePriority</a>;
01587     OldIncrement = OldBase - Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o12">BasePriority</a>;
01588     <span class="keywordflow">if</span> (Thread-&gt;Saturation != 0) {
01589         OldIncrement = ((HIGH_PRIORITY + 1) / 2) * Thread-&gt;Saturation;
01590     }
01591 
01592     Thread-&gt;Saturation = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01593     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a259">abs</a>(Increment) &gt;= (HIGH_PRIORITY + 1) / 2) {
01594         Thread-&gt;Saturation = (<a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> &gt; 0) ? 1 : -1;
01595     }
01596 
01597     <span class="comment">//</span>
01598     <span class="comment">// Set the base priority of the specified thread. If the thread's process</span>
01599     <span class="comment">// is in the realtime class, then limit the change to the realtime class.</span>
01600     <span class="comment">// Otherwise, limit the change to the variable class.</span>
01601     <span class="comment">//</span>
01602 
01603     NewBase = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o12">BasePriority</a> + <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
01604     <span class="keywordflow">if</span> (Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o12">BasePriority</a> &gt;= LOW_REALTIME_PRIORITY) {
01605         <span class="keywordflow">if</span> (NewBase &lt; LOW_REALTIME_PRIORITY) {
01606             NewBase = LOW_REALTIME_PRIORITY;
01607 
01608         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewBase &gt; HIGH_PRIORITY) {
01609             NewBase = HIGH_PRIORITY;
01610         }
01611 
01612         <span class="comment">//</span>
01613         <span class="comment">// Set the new priority of the thread to the new base priority.</span>
01614         <span class="comment">//</span>
01615 
01616         NewPriority = NewBase;
01617 
01618     } <span class="keywordflow">else</span> {
01619         <span class="keywordflow">if</span> (NewBase &gt;= LOW_REALTIME_PRIORITY) {
01620             NewBase = LOW_REALTIME_PRIORITY - 1;
01621 
01622         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewBase &lt;= LOW_PRIORITY) {
01623             NewBase = 1;
01624         }
01625 
01626         <span class="comment">//</span>
01627         <span class="comment">// Compute the new thread priority. If the new priority is outside</span>
01628         <span class="comment">// the variable class, then set the new priority to the highest</span>
01629         <span class="comment">// variable priority.</span>
01630         <span class="comment">//</span>
01631 
01632         <span class="keywordflow">if</span> (Thread-&gt;Saturation != 0) {
01633             NewPriority = NewBase;
01634 
01635         } <span class="keywordflow">else</span> {
01636             NewPriority = Thread-&gt;Priority +
01637                             (NewBase - OldBase) - Thread-&gt;PriorityDecrement;
01638 
01639             <span class="keywordflow">if</span> (NewPriority &gt;= LOW_REALTIME_PRIORITY) {
01640                 NewPriority = LOW_REALTIME_PRIORITY - 1;
01641             }
01642         }
01643     }
01644 
01645     <span class="comment">//</span>
01646     <span class="comment">// Set the new base priority and clear the priority decrement. If the</span>
01647     <span class="comment">// new priority is not equal to the old priority, then set the new thread</span>
01648     <span class="comment">// priority.</span>
01649     <span class="comment">//</span>
01650 
01651     Thread-&gt;BasePriority = (SCHAR)NewBase;
01652     Thread-&gt;DecrementCount = 0;
01653     Thread-&gt;PriorityDecrement = 0;
01654     <span class="keywordflow">if</span> (NewPriority != Thread-&gt;Priority) {
01655         Thread-&gt;Quantum = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a>;
01656         <a class="code" href="../../d0/d2/thredsup_8c.html#a5">KiSetPriorityThread</a>(Thread, NewPriority);
01657     }
01658 
01659     <span class="comment">//</span>
01660     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01661     <span class="comment">// value.</span>
01662     <span class="comment">//</span>
01663 
01664     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01665 
01666     <span class="comment">//</span>
01667     <span class="comment">// Return the previous thread base priority.</span>
01668     <span class="comment">//</span>
01669 
01670     <span class="keywordflow">return</span> OldIncrement;
01671 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a319" doxytag="ke.h::KeSetDisableBoostThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LOGICAL KeSetDisableBoostThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LOGICAL&nbsp;</td>
          <td class="mdname" nowrap> <em>Disable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01674">1674</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, and <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.
<p>
<pre class="fragment"><div>01681                    :
01682 
01683     This function disables priority boosts <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
01684 
01685 Arguments:
01686 
01687     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01688 
01689     Disable - Supplies a logical value that determines whether priority
01690         boosts <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread are disabled or enabled.
01691 
01692 Return Value:
01693 
01694     The previous value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disable boost state variable.
01695 
01696 --*/
01697 
01698 {
01699 
01700     LOGICAL DisableBoost;
01701     KIRQL OldIrql;
01702 
01703     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01704     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01705 
01706     <span class="comment">//</span>
01707     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01708     <span class="comment">//</span>
01709 
01710     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01711 
01712     <span class="comment">//</span>
01713     <span class="comment">// Capture the current state of the disable boost variable and set its</span>
01714     <span class="comment">// state to TRUE.</span>
01715     <span class="comment">//</span>
01716 
01717     DisableBoost = Thread-&gt;DisableBoost;
01718     Thread-&gt;DisableBoost = (BOOLEAN)Disable;
01719 
01720     <span class="comment">//</span>
01721     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01722     <span class="comment">// value.</span>
01723     <span class="comment">//</span>
01724 
01725     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01726 
01727     <span class="comment">//</span>
01728     <span class="comment">// Return the previous disable boost state.</span>
01729     <span class="comment">//</span>
01730 
01731     <span class="keywordflow">return</span> DisableBoost;
01732 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a309" doxytag="ke.h::KeSetDisableQuantumProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LOGICAL KeSetDisableQuantumProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LOGICAL&nbsp;</td>
          <td class="mdname" nowrap> <em>Disable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00907">907</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>.
<p>
Referenced by <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>.
<p>
<pre class="fragment"><div>00914                    :
00915 
00916     This function disables quantum runout <span class="keywordflow">for</span> realtime threads in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00917     specified process.
00918 
00919 Arguments:
00920 
00921     Process  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00922 
00923     Disable - Supplies a logical value that determines whether quantum
00924         runout <span class="keywordflow">for</span> realtime threads in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified process are disabled
00925         or enabled.
00926 
00927 Return Value:
00928 
00929     The previous value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disable quantum state variable.
00930 
00931 --*/
00932 
00933 {
00934 
00935     LOGICAL DisableQuantum;
00936 
00937     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00938 
00939     <span class="comment">//</span>
00940     <span class="comment">// Capture the current state of the disable boost variable and set its</span>
00941     <span class="comment">// state to TRUE.</span>
00942     <span class="comment">//</span>
00943 
00944     DisableQuantum = Process-&gt;DisableQuantum;
00945     Process-&gt;DisableQuantum = (BOOLEAN)Disable;
00946 
00947     <span class="comment">//</span>
00948     <span class="comment">// Return the previous disable quantum state.</span>
00949     <span class="comment">//</span>
00950 
00951     <span class="keywordflow">return</span> DisableQuantum;
00952 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a381" doxytag="ke.h::KeSetDmaIoCoherency" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeSetDmaIoCoherency           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Attributes</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00239">239</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00301">KiDmaIoCoherency</a>.
<p>
<pre class="fragment"><div>00245                    :
00246 
00247     This function sets (enables/disables) DMA I/O coherency with data
00248     caches.
00249 
00250 Arguments:
00251 
00252     Attributes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> set of DMA I/O coherency attributes <span class="keywordflow">for</span>
00253         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host system.
00254 
00255 Return Value:
00256 
00257     None.
00258 
00259 --*/
00260 
00261 {
00262 
00263     <a class="code" href="../../d5/d9/kernldat_8c.html#a34">KiDmaIoCoherency</a> = Attributes;
00264 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a282" doxytag="ke.h::KeSetEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONG KeSetEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">343</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00034">ASSERT_EVENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01138">KiSetEventCallData</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00054">RECORD_CALL_DATA</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00281">_KWAIT_BLOCK::Thread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/power_8c-source.html#l00058">CancelPowerRequest()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01517">CcDeleteSharedCacheMap()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00862">CcFreeVirtualAddress()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00401">CcGetVacbMiss()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l02099">CcPostDeferredWrites()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01164">CcUninitializeCacheMap()</a>, <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00738">CcWorkerThread()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01028">CmNotifyRunDown()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00804">CmpPostApc()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00922">CmpPostApcRunDown()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02478">DestroyDesktop()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00129">DestroyTask()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00248">DeviceCDROMNotify()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00563">ExNotifyCallback()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">ExQueueWorkItem()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00313">FreeDeviceInfo()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00745">FreeWindowStation()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00579">FsRecLoadFileSystem()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03241">FsRtlCompletionRoutinePriv()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00114">IoAcquireRemoveLockEx()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00181">IopAcquireFileObjectLock()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01019">IopCompleteRequest()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01506">IopConnectLinkTrackingPort()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01250">IopInvalidateRelationsInList()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04169">IopLoadUnloadDriver()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00725">IopLockDeviceRemovalRelations()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01080">IopLockMountedDeviceForRemove()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00821">IopProcessStartDevices()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00912">IopProcessStartDevicesWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l04667">IopQueryRebalanceWorker()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l07272">IopTrackLink()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01233">IopUnlockMountedDeviceForRemove()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00422">IopWarmEjectDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00244">IoReleaseRemoveLockEx()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11389">IoVerifyVolume()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01126">KiSetServerWaitClientEvent()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00551">LfsFlushLfcb()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00642">LpcpFreeToPortZone()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01181">LpcRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00250">MemPrint()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00492">MemPrintFlush()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00807">MiAllocatePoolPages()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00996">MiCheckAndSetSystemTrimCriteria()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01823">MiCheckControlArea()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01338">MiCrashDumpWorker()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l00068">MiDispatchFault()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02715">MiEmptyAllWorkingSets()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02788">MiEmptyAllWorkingSetsWorker()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04870">MiFlushAllPages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03198">MiGatherMappedPages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03701">MiGatherPagefilePages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04607">MiInsertPageFileInList()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00059">MiInsertPageInList()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00388">MiInsertStandbyListAtFront()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02782">MiModifiedPageWriterTimerDispatch()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00336">MiObtainFreePages()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00191">MiSegmentDelete()</a>, <a class="el" href="../../d9/d5/deleteva_8c-source.html#l01098">MiUpdateModifiedWriterMdls()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02234">MiWriteComplete()</a>, <a class="el" href="../../d2/d4/mapcache_8c-source.html#l01274">MmCopyToCachedPage()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00362">MmCopyVirtualMemory()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00589">MmResourcesAvailable()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00035">NtLockFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01191">ProcessDeviceChanges()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d8/d9/psctxppc_8c-source.html#l00386">PspGetSetContextApc()</a>, <a class="el" href="../../d4/d9/psctx386_8c-source.html#l00131">PspGetSetContextSpecialApc()</a>, <a class="el" href="../../d5/d9/psctxalp_8c-source.html#l00349">PspGetSetContextSpecialApcMain()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l02250">PsUnlockProcess()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00925">QueueMouseEvent()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00076">QueuePowerRequest()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01535">RequestDeviceChange()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00091">RtlAcquireRemoveLockEx()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00204">RtlReleaseRemoveLock()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04578">SetWakeBit()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01949">SmbTraceEmptyQueue()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01779">UdfMultiSyncCompletionRoutine()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00710">UdfPnpCompletionRoutine()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01980">UdfSingleSyncCompletionRoutine()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00608">UserPowerStateCallout()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00408">VdmpQueueIntNormalRoutine()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02160">VerifierSetEvent()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00030">WakeWowTask()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00472">xxxButtonEvent()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01797">xxxCreateDesktop()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00114">xxxDesktopThread()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05238">xxxGetInputEvent()</a>, <a class="el" href="../../d7/d8/taskman_8c-source.html#l00252">xxxSleepTask()</a>, and <a class="el" href="../../d8/d1/power_8c-source.html#l00684">xxxUserPowerCalloutWorker()</a>.
<p>
<pre class="fragment"><div>00351                    :
00352 
00353     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object to Signaled
00354     and attempts to satisfy as many Waits as possible. The previous
00355     signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00356 
00357 Arguments:
00358 
00359     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00360 
00361     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00362        <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event causes a Wait to be satisfied.
00363 
00364     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00365        <a class="code" href="../../d4/d9/ke_8h.html#a279">KePulseEvent</a> will be immediately followed by a call to one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00366        kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00367 
00368 Return Value:
00369 
00370     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> event object.
00371 
00372 --*/
00373 
00374 {
00375 
00376     KIRQL OldIrql;
00377     LONG OldState;
00378     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00379     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PRKWAIT_BLOCK</a> WaitBlock;
00380 
00381     <a class="code" href="../../d2/d8/eventobj_8c.html#a0">ASSERT_EVENT</a>(Event);
00382     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00383 
00384     <span class="comment">//</span>
00385     <span class="comment">// Collect call data.</span>
00386     <span class="comment">//</span>
00387 
00388 <span class="preprocessor">#if defined(_COLLECT_SET_EVENT_CALLDATA_)</span>
00389 <span class="preprocessor"></span>
00390     <a class="code" href="../../d5/d8/ex_8h.html#a1">RECORD_CALL_DATA</a>(&amp;KiSetEventCallData);
00391 
00392 <span class="preprocessor">#endif</span>
00393 <span class="preprocessor"></span>
00394     <span class="comment">//</span>
00395     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00396     <span class="comment">//</span>
00397 
00398     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00399 
00400     <span class="comment">//</span>
00401     <span class="comment">// If the wait list is empty, then set the state of the event to signaled.</span>
00402     <span class="comment">// Otherwise, check if the wait can be satisfied immediately.</span>
00403     <span class="comment">//</span>
00404 
00405     OldState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState;
00406     <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00407         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00408 
00409     } <span class="keywordflow">else</span> {
00410 
00411         <span class="comment">//</span>
00412         <span class="comment">// If the event is a notification event or the wait is not a wait any,</span>
00413         <span class="comment">// then set the state of the event to signaled and attempt to satisfy</span>
00414         <span class="comment">// as many waits as possible. Otherwise, the wait can be satisfied by</span>
00415         <span class="comment">// directly unwaiting the thread.</span>
00416         <span class="comment">//</span>
00417 
00418         WaitBlock = CONTAINING_RECORD(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead.Flink,
00419                                       <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a>,
00420                                       WaitListEntry);
00421 
00422         <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Type == NotificationEvent) ||
00423             (WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> != WaitAny)) {
00424             <span class="keywordflow">if</span> (OldState == 0) {
00425                 <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00426                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Event, Increment);
00427             }
00428 
00429         } <span class="keywordflow">else</span> {
00430             <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o1">Thread</a>, (NTSTATUS)WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a>, Increment);
00431         }
00432     }
00433 
00434     <span class="comment">//</span>
00435     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00436     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00437     <span class="comment">// release the dispatcher database lock and lower IRQL to its</span>
00438     <span class="comment">// previous value.</span>
00439     <span class="comment">//</span>
00440 
00441     <span class="keywordflow">if</span> (Wait != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00442        Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00443        Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00444        Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00445 
00446     } <span class="keywordflow">else</span> {
00447        <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00448     }
00449 
00450     <span class="comment">//</span>
00451     <span class="comment">// Return previous signal state of event object.</span>
00452     <span class="comment">//</span>
00453 
00454     <span class="keywordflow">return</span> OldState;
00455 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a283" doxytag="ke.h::KeSetEventBoostPriority" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetEventBoostPriority           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PRKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *Thread&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00458">458</a> of file <a class="el" href="../../d3/d7/eventobj_8c-source.html">eventobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00034">EVENT_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00031">KiUnwaitThread()</a>, <a class="el" href="../../d9/d9/cmdat3_8c-source.html#l00108">MmProductType</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00593">_KTHREAD::Quantum</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01607">ExReleaseResourceForThreadLite()</a>, and <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>.
<p>
<pre class="fragment"><div>00465                    :
00466 
00467     This function conditionally sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of an event object
00468     to Signaled, and attempts to unwait <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first waiter, and optionally
00469     returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unwatied thread.
00470 
00471     N.B. This function can <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> be called with synchronization events
00472          and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> primarily <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> purpose of implementing fast mutexes.
00473          It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> waiter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> NEVER waiting on multiple
00474          objects.
00475 
00476 Arguments:
00477 
00478     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
00479 
00480     Thread - Supplies an optional pointer to a variable that receives
00481         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> awakened.
00482 
00483 Return Value:
00484 
00485     None.
00486 
00487 --*/
00488 
00489 {
00490 
00491     KPRIORITY <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a>;
00492     KIRQL OldIrql;
00493     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> WaitThread;
00494 
00495     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.Type == SynchronizationEvent);
00496     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00497 
00498     <span class="comment">//</span>
00499     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00500     <span class="comment">//</span>
00501 
00502     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00503 
00504     <span class="comment">//</span>
00505     <span class="comment">// If the the wait list is not empty, then satisfy the wait of the</span>
00506     <span class="comment">// first thread in the wait list. Otherwise, set the signal state</span>
00507     <span class="comment">// of the event object.</span>
00508     <span class="comment">//</span>
00509     <span class="comment">// N.B. This function is only called for fast mutexes and exclusive</span>
00510     <span class="comment">//      access to resources. All waits MUST be wait for single object.</span>
00511     <span class="comment">//</span>
00512 
00513     <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00514         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.SignalState = 1;
00515 
00516     } <span class="keywordflow">else</span> {
00517 
00518         <span class="comment">//</span>
00519         <span class="comment">// Get the address of the waiting thread.</span>
00520         <span class="comment">//</span>
00521 
00522         WaitThread = CONTAINING_RECORD(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>-&gt;Header.WaitListHead.Flink,
00523                                        <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">KWAIT_BLOCK</a>,
00524                                        WaitListEntry)-&gt;Thread;
00525 
00526         <span class="comment">//</span>
00527         <span class="comment">// If specified, return the address of the thread that is awakened.</span>
00528         <span class="comment">//</span>
00529 
00530         <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Thread)) {
00531             *Thread = WaitThread;
00532         }
00533 
00534         <span class="comment">//</span>
00535         <span class="comment">// Give the new owner of the resource/fast mutex (the only callers) a</span>
00536         <span class="comment">// full quantum, and unwait the thread with a standard event increment</span>
00537         <span class="comment">// unless the system is a server system, in which case no boost if given.</span>
00538         <span class="comment">//</span>
00539 
00540         WaitThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = WaitThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a>;
00541         <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = 0;
00542         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/cmdat3_8c.html#a52">MmProductType</a> == 0) {
00543             <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> = <a class="code" href="../../d7/d8/exboosts_8h.html#a0">EVENT_INCREMENT</a>;
00544         }
00545 
00546         <a class="code" href="../../d2/d7/waitsup_8c.html#a0">KiUnwaitThread</a>(WaitThread, STATUS_SUCCESS, Increment);
00547     }
00548 
00549     <span class="comment">//</span>
00550     <span class="comment">// Unlock dispatcher database lock and lower IRQL to its previous</span>
00551     <span class="comment">// value.</span>
00552     <span class="comment">//</span>
00553 
00554     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00555     <span class="keywordflow">return</span>;
00556 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a334" doxytag="ke.h::KeSetIdealProcessorThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI CCHAR KeSetIdealProcessorThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Processor</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01735">1735</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l01420">MAXIMUM_PROCESSORS</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00772">_KPROCESS::ThreadSeed</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.
<p>
<pre class="fragment"><div>01742                    :
01743 
01744     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ideal processor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread execution.
01745 
01746 Arguments:
01747 
01748     Thread - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread whose ideal processor number <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01749         set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specfied value.
01750 
01751     Processor - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ideal processor (the distinguished
01752         value MAXIMUM_PROCESSORS indicates that there is no ideal processor).
01753 
01754 Return Value:
01755 
01756     The previous ideal processor number.
01757 
01758 --*/
01759 
01760 {
01761 
01762     CCHAR OldProcessor;
01763     KIRQL OldIrql;
01764     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
01765 
01766     <span class="comment">//</span>
01767     <span class="comment">// Capture the previous ideal processor value, set the new ideal</span>
01768     <span class="comment">// processor value, and return the old ideal processor value for the</span>
01769     <span class="comment">// current thread;</span>
01770     <span class="comment">//</span>
01771     <span class="comment">// Note that this is done under the dispatcher lock in order to</span>
01772     <span class="comment">// synchronize the updates with the other fields that share the</span>
01773     <span class="comment">// same DWORD. Otherwise there is a granularity problem on Alpha.</span>
01774     <span class="comment">//</span>
01775 
01776     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Processor &lt;= MAXIMUM_PROCESSORS);
01777 
01778     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01779     OldProcessor = Thread-&gt;IdealProcessor;
01780     <span class="keywordflow">if</span> (Processor &lt; <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a>) {
01781         Thread-&gt;IdealProcessor = Processor;
01782 
01783     } <span class="keywordflow">else</span> {
01784         Process = Thread-&gt;ApcState.Process;
01785         Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o16">ThreadSeed</a> += 1;
01786         Thread-&gt;IdealProcessor = (UCHAR)(Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o16">ThreadSeed</a> % <a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>);
01787     }
01788 
01789     <span class="comment">//</span>
01790     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01791     <span class="comment">// value.</span>
01792     <span class="comment">//</span>
01793 
01794     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01795     <span class="keywordflow">return</span> OldProcessor;
01796 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a262" doxytag="ke.h::KeSetImportanceDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeSetImportanceDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a50">KDPC_IMPORTANCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Importance</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00367">367</a> of file <a class="el" href="../../d5/d0/dpcobj_8c-source.html">dpcobj.c</a>.
<p>
References <a class="el" href="../../d0/d9/ntosdef_8h.html#a50">KDPC_IMPORTANCE</a>.
<p>
<pre class="fragment"><div>00374                    :
00375 
00376     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> importance of a DPC.
00377 
00378 Arguments:
00379 
00380     Dpc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00381 
00382     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> importance of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC.
00383 
00384 Return Value:
00385 
00386     None.
00387 
00388 --*/
00389 
00390 {
00391 
00392     <span class="comment">//</span>
00393     <span class="comment">// Set the importance of the DPC.</span>
00394     <span class="comment">//</span>
00395 
00396     Dpc-&gt;Importance = (UCHAR)Importance;
00397     <span class="keywordflow">return</span>;
00398 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a277" doxytag="ke.h::KeSetIntervalProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetIntervalProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Interval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPROFILE_SOURCE&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/profobj_8c-source.html#l00223">223</a> of file <a class="el" href="../../d1/d7/profobj_8c-source.html">profobj.c</a>.
<p>
References <a class="el" href="../../d2/d7/hal_8h.html#a110">HAL_PROFILE_SOURCE_INTERVAL</a>, <a class="el" href="../../d2/d7/hal_8h.html#a238a153">HalProfileSourceInterval</a>, <a class="el" href="../../d2/d7/hal_8h.html#a172">HalSetProfileInterval()</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01543">HalSetSystemInformation</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01633">_HAL_PROFILE_SOURCE_INTERVAL::Interval</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00040">KiIpiGenericCall()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00465">KiProfileAlignmentFixupInterval</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00478">KiProfileInterval</a>, and <a class="el" href="../../d3/d6/hal_8h-source.html#l01632">_HAL_PROFILE_SOURCE_INTERVAL::Source</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00757">NtSetIntervalProfile()</a>.
<p>
<pre class="fragment"><div>00230                    :
00231 
00232     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile sampling interval. The interval <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in
00233     100ns units. The interval will actually be set to some value in a set
00234     of preset values (at least on pc based hardware), <span class="keyword">using</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> one closest
00235     to what <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user asked <span class="keywordflow">for</span>.
00236 
00237 Arguments:
00238 
00239     Interval - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sampling interval in 100ns units.
00240 
00241 Return Value:
00242 
00243     None.
00244 
00245 --*/
00246 
00247 {
00248 
00249     <a class="code" href="../../d3/d3/struct__HAL__PROFILE__SOURCE__INTERVAL.html">HAL_PROFILE_SOURCE_INTERVAL</a> ProfileSourceInterval;
00250 
00251     <span class="keywordflow">if</span> (Source == ProfileTime) {
00252 
00253         <span class="comment">//</span>
00254         <span class="comment">// If the specified sampling interval is less than the minimum</span>
00255         <span class="comment">// sampling interval, then set the sampling interval to the minimum</span>
00256         <span class="comment">// sampling interval.</span>
00257         <span class="comment">//</span>
00258 
00259         <span class="keywordflow">if</span> (Interval &lt; MINIMUM_PROFILE_INTERVAL) {
00260             Interval = MINIMUM_PROFILE_INTERVAL;
00261         }
00262 
00263         <span class="comment">//</span>
00264         <span class="comment">// Set the sampling interval.</span>
00265         <span class="comment">//</span>
00266 
00267         <a class="code" href="../../d5/d9/kernldat_8c.html#a55">KiProfileInterval</a> = (ULONG)<a class="code" href="../../d2/d1/xipi_8c.html#a1">KiIpiGenericCall</a>(HalSetProfileInterval, Interval);
00268 
00269     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Source == ProfileAlignmentFixup) {
00270         <a class="code" href="../../d5/d9/kernldat_8c.html#a53">KiProfileAlignmentFixupInterval</a> = Interval;
00271 
00272     } <span class="keywordflow">else</span> {
00273 
00274         <span class="comment">//</span>
00275         <span class="comment">// The HAL is responsible for setting this profile interval.</span>
00276         <span class="comment">//</span>
00277 
00278         ProfileSourceInterval.<a class="code" href="../../d3/d3/struct__HAL__PROFILE__SOURCE__INTERVAL.html#o0">Source</a> = Source;
00279         ProfileSourceInterval.<a class="code" href="../../d3/d3/struct__HAL__PROFILE__SOURCE__INTERVAL.html#o1">Interval</a> = Interval;
00280         <a class="code" href="../../d2/d7/hal_8h.html#a21">HalSetSystemInformation</a>(HalProfileSourceInterval,
00281                                 <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d3/struct__HAL__PROFILE__SOURCE__INTERVAL.html">HAL_PROFILE_SOURCE_INTERVAL</a>),
00282                                 &amp;ProfileSourceInterval);
00283     }
00284 
00285     <span class="keywordflow">return</span>;
00286 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a335" doxytag="ke.h::KeSetKernelStackSwapEnable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeSetKernelStackSwapEnable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Enable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01799">1799</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00640">_KTHREAD::EnableStackSwap</a>, and <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02552">xxxDestroyThreadInfo()</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l01296">xxxInterSendMsgEx()</a>.
<p>
<pre class="fragment"><div>01805                    :
01806 
01807     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel stack swap enable value <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
01808     thread and returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old swap enable value.
01809 
01810 Arguments:
01811 
01812     Enable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> kernel stack swap enable value.
01813 
01814 Return Value:
01815 
01816     The previous kernel stack swap enable value.
01817 
01818 --*/
01819 
01820 {
01821 
01822     BOOLEAN OldState;
01823     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
01824 
01825     <span class="comment">//</span>
01826     <span class="comment">// Capture the previous kernel stack swap enable value, set the new</span>
01827     <span class="comment">// swap enable value, and return the old swap enable value for the</span>
01828     <span class="comment">// current thread;</span>
01829     <span class="comment">//</span>
01830 
01831     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
01832     OldState = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o51">EnableStackSwap</a>;
01833     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o51">EnableStackSwap</a> = Enable;
01834     <span class="keywordflow">return</span> OldState;
01835 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a308" doxytag="ke.h::KeSetPriorityProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KPRIORITY KeSetPriorityProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>BasePriority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00738">738</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00590">_KTHREAD::BasePriority</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00591">_KTHREAD::DecrementCount</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">KiSetPriorityThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00592">_KTHREAD::PriorityDecrement</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00593">_KTHREAD::Quantum</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00573">_KTHREAD::Saturation</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03916">PsSetProcessPriorityByClass()</a>.
<p>
<pre class="fragment"><div>00745                    :
00746 
00747     This function set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base priority of a process to a <span class="keyword">new</span> value
00748     and adjusts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority and base priority of all child threads
00749     as appropriate.
00750 
00751 Arguments:
00752 
00753     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00754 
00755     NewBase - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> base priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00756 
00757 Return Value:
00758 
00759     The previous base priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.
00760 
00761 --*/
00762 
00763 {
00764 
00765     KPRIORITY Adjustment;
00766     PLIST_ENTRY NextEntry;
00767     KPRIORITY NewPriority;
00768     KIRQL OldIrql;
00769     KPRIORITY OldBase;
00770     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00771 
00772     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00773     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00774 
00775     <span class="comment">//</span>
00776     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00777     <span class="comment">//</span>
00778 
00779     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00780 
00781     <span class="comment">//</span>
00782     <span class="comment">// Save the current process base priority, set the new process base</span>
00783     <span class="comment">// priority, compute the adjustment value, and adjust the priority</span>
00784     <span class="comment">// and base priority of all child threads as appropriate.</span>
00785     <span class="comment">//</span>
00786 
00787     OldBase = Process-&gt;BasePriority;
00788     Process-&gt;BasePriority = (SCHAR)NewBase;
00789     Adjustment = NewBase - OldBase;
00790     NextEntry = Process-&gt;ThreadListHead.Flink;
00791     <span class="keywordflow">if</span> (NewBase &gt;= LOW_REALTIME_PRIORITY) {
00792         <span class="keywordflow">while</span> (NextEntry != &amp;Process-&gt;ThreadListHead) {
00793             Thread = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>, ThreadListEntry);
00794 
00795             <span class="comment">//</span>
00796             <span class="comment">// Compute the new base priority of the thread.</span>
00797             <span class="comment">//</span>
00798 
00799             NewPriority = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a> + Adjustment;
00800 
00801             <span class="comment">//</span>
00802             <span class="comment">// If the new base priority is outside the realtime class,</span>
00803             <span class="comment">// then limit the change to the realtime class.</span>
00804             <span class="comment">//</span>
00805 
00806             <span class="keywordflow">if</span> (NewPriority &lt; LOW_REALTIME_PRIORITY) {
00807                 NewPriority = LOW_REALTIME_PRIORITY;
00808 
00809             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewPriority &gt; HIGH_PRIORITY) {
00810                 NewPriority = HIGH_PRIORITY;
00811             }
00812 
00813             <span class="comment">//</span>
00814             <span class="comment">// Set the base priority and the current priority of the</span>
00815             <span class="comment">// thread to the appropriate value.</span>
00816             <span class="comment">//</span>
00817             <span class="comment">// N.B. If priority saturation occured the last time the thread</span>
00818             <span class="comment">//      base priority was set and the new process base priority</span>
00819             <span class="comment">//      is not crossing from variable to realtime, then it is not</span>
00820             <span class="comment">//      necessary to change the thread priority.</span>
00821             <span class="comment">//</span>
00822 
00823             <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> == 0) || (OldBase &lt; LOW_REALTIME_PRIORITY)) {
00824                 <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> &gt; 0) {
00825                     NewPriority = HIGH_PRIORITY;
00826 
00827                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> &lt; 0) {
00828                     NewPriority = LOW_REALTIME_PRIORITY;
00829                 }
00830 
00831                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a> = (SCHAR)NewPriority;
00832                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = Process-&gt;ThreadQuantum;
00833                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o25">DecrementCount</a> = 0;
00834                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> = 0;
00835                 <a class="code" href="../../d0/d2/thredsup_8c.html#a5">KiSetPriorityThread</a>(Thread, NewPriority);
00836             }
00837 
00838             NextEntry = NextEntry-&gt;Flink;
00839         }
00840 
00841     } <span class="keywordflow">else</span> {
00842         <span class="keywordflow">while</span> (NextEntry != &amp;Process-&gt;ThreadListHead) {
00843             Thread = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>, ThreadListEntry);
00844 
00845             <span class="comment">//</span>
00846             <span class="comment">// Compute the new base priority of the thread.</span>
00847             <span class="comment">//</span>
00848 
00849             NewPriority = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a> + Adjustment;
00850 
00851             <span class="comment">//</span>
00852             <span class="comment">// If the new base priority is outside the variable class,</span>
00853             <span class="comment">// then limit the change to the variable class.</span>
00854             <span class="comment">//</span>
00855 
00856             <span class="keywordflow">if</span> (NewPriority &gt;= LOW_REALTIME_PRIORITY) {
00857                 NewPriority = LOW_REALTIME_PRIORITY - 1;
00858 
00859             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewPriority &lt;= LOW_PRIORITY) {
00860                 NewPriority = 1;
00861             }
00862 
00863             <span class="comment">//</span>
00864             <span class="comment">// Set the base priority and the current priority of the</span>
00865             <span class="comment">// thread to the computed value and reset the thread quantum.</span>
00866             <span class="comment">//</span>
00867             <span class="comment">// N.B. If priority saturation occured the last time the thread</span>
00868             <span class="comment">//      base priority was set and the new process base priority</span>
00869             <span class="comment">//      is not crossing from realtime to variable, then it is not</span>
00870             <span class="comment">//      necessary to change the thread priority.</span>
00871             <span class="comment">//</span>
00872 
00873             <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> == 0) || (OldBase &gt;= LOW_REALTIME_PRIORITY)) {
00874                 <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> &gt; 0) {
00875                     NewPriority = LOW_REALTIME_PRIORITY - 1;
00876 
00877                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o12">Saturation</a> &lt; 0) {
00878                     NewPriority = 1;
00879                 }
00880 
00881                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o24">BasePriority</a> = (SCHAR)NewPriority;
00882                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o27">Quantum</a> = Process-&gt;ThreadQuantum;
00883                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o25">DecrementCount</a> = 0;
00884                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o26">PriorityDecrement</a> = 0;
00885                 <a class="code" href="../../d0/d2/thredsup_8c.html#a5">KiSetPriorityThread</a>(Thread, NewPriority);
00886             }
00887 
00888             NextEntry = NextEntry-&gt;Flink;
00889         }
00890     }
00891 
00892     <span class="comment">//</span>
00893     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
00894     <span class="comment">// value.</span>
00895     <span class="comment">//</span>
00896 
00897     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00898 
00899     <span class="comment">//</span>
00900     <span class="comment">// Return previous process base priority</span>
00901     <span class="comment">//</span>
00902 
00903     <span class="keywordflow">return</span> OldBase;
00904 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a336" doxytag="ke.h::KeSetPriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KPRIORITY KeSetPriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Priority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">1838</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">KiSetPriorityThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00769">_KPROCESS::ThreadQuantum</a>.
<p>
Referenced by <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00345">FsRtlWorkerThread()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00154">KeBoostCurrentThread()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00322">KeSwapProcessOrStack()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04239">MiMappedPageWriter()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02669">MiModifiedPageWriter()</a>, <a class="el" href="../../d8/d0/zeropage_8c-source.html#l00029">MmZeroPageThread()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, and <a class="el" href="../../d2/d1/hooks_8c-source.html#l00576">zzzSetWindowsHookEx()</a>.
<p>
<pre class="fragment"><div>01845                    :
01846 
01847     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread to a <span class="keyword">new</span> value.
01848     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> thread priority <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> lower than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old thread priority, then
01849     resecheduling may take place <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> currently running on, or
01850     about to run on, a processor.
01851 
01852 Arguments:
01853 
01854     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01855 
01856     Priority - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> subject thread.
01857 
01858 Return Value:
01859 
01860     The previous priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread.
01861 
01862 --*/
01863 
01864 {
01865 
01866     KIRQL OldIrql;
01867     KPRIORITY OldPriority;
01868     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
01869 
01870     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01871     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01872     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(((Priority != 0) || (Thread-&gt;BasePriority == 0)) &amp;&amp;
01873            (Priority &lt;= HIGH_PRIORITY));
01874 
01875     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
01876 
01877     <span class="comment">//</span>
01878     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01879     <span class="comment">//</span>
01880 
01881     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01882 
01883     <span class="comment">//</span>
01884     <span class="comment">// Capture the current thread priority, set the thread priority to the</span>
01885     <span class="comment">// the new value, and replenish the thread quantum. It is assumed that</span>
01886     <span class="comment">// the priority would not be set unless the thread had already lost it</span>
01887     <span class="comment">// initial quantum.</span>
01888     <span class="comment">//</span>
01889 
01890     OldPriority = Thread-&gt;Priority;
01891     Process = Thread-&gt;ApcStatePointer[0]-&gt;Process;
01892     Thread-&gt;Quantum = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o13">ThreadQuantum</a>;
01893     Thread-&gt;DecrementCount = 0;
01894     Thread-&gt;PriorityDecrement = 0;
01895     <a class="code" href="../../d0/d2/thredsup_8c.html#a5">KiSetPriorityThread</a>(Thread, Priority);
01896 
01897     <span class="comment">//</span>
01898     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01899     <span class="comment">// value.</span>
01900     <span class="comment">//</span>
01901 
01902     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01903 
01904     <span class="comment">//</span>
01905     <span class="comment">// Return the previous thread priority.</span>
01906     <span class="comment">//</span>
01907 
01908     <span class="keywordflow">return</span> OldPriority;
01909 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a307" doxytag="ke.h::KeSetProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG KeSetProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00656">656</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01232">PspExitProcess()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.
<p>
<pre class="fragment"><div>00664                    :
00665 
00666     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> signal state of a proces object to Signaled
00667     and attempts to satisfy as many Waits as possible. The previous
00668     signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00669 
00670 Arguments:
00671 
00672     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00673 
00674     <a class="code" href="../../d6/d4/rtl_2random_8c.html#a1">Increment</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority increment that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be applied
00675        <span class="keywordflow">if</span> setting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process causes a Wait to be satisfied.
00676 
00677     Wait - Supplies a <span class="keywordtype">boolean</span> value that signifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to
00678        <a class="code" href="../../d4/d9/ke_8h.html#a307">KeSetProcess</a> will be immediately followed by a call to one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00679        kernel Wait <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a>.
00680 
00681 Return Value:
00682 
00683     The previous signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process object.
00684 
00685 --*/
00686 
00687 {
00688 
00689     KIRQL OldIrql;
00690     LONG OldState;
00691     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00692 
00693     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00694     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00695 
00696     <span class="comment">//</span>
00697     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00698     <span class="comment">//</span>
00699 
00700     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00701 
00702     <span class="comment">//</span>
00703     <span class="comment">// If the previous state of the process object is Not-Signaled and</span>
00704     <span class="comment">// the wait queue is not empty, then satisfy as many Waits as</span>
00705     <span class="comment">// possible.</span>
00706     <span class="comment">//</span>
00707 
00708     OldState = Process-&gt;Header.SignalState;
00709     Process-&gt;Header.SignalState = 1;
00710     <span class="keywordflow">if</span> ((OldState == 0) &amp;&amp; (!IsListEmpty(&amp;Process-&gt;Header.WaitListHead))) {
00711         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Process, Increment);
00712     }
00713 
00714     <span class="comment">//</span>
00715     <span class="comment">// If the value of the Wait argument is TRUE, then return to the</span>
00716     <span class="comment">// caller with IRQL raised and the dispatcher database locked. Else</span>
00717     <span class="comment">// release the dispatcher database lock and lower IRQL to its</span>
00718     <span class="comment">// previous value.</span>
00719     <span class="comment">//</span>
00720 
00721     <span class="keywordflow">if</span> (Wait) {
00722         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00723         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = Wait;
00724         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> = OldIrql;
00725 
00726     } <span class="keywordflow">else</span> {
00727         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00728     }
00729 
00730     <span class="comment">//</span>
00731     <span class="comment">// Return previous signal state of process object.</span>
00732     <span class="comment">//</span>
00733 
00734     <span class="keywordflow">return</span> OldState;
00735 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a399" doxytag="ke.h::KeSetSwapContextNotifyRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL KeSetSwapContextNotifyRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/ke_8h.html#a120">PSWAP_CONTEXT_NOTIFY_ROUTINE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>NotifyRoutine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00909">909</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00066">KiSwapContextNotifyRoutine</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>00914                    :
00915 
00916     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a callout routine which will be called
00917     at each context swtich.
00918 
00919 Arguments:
00920 
00921     NotifyRoutine - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> swap context notify callout
00922         routine.
00923 
00924 Return Value:
00925 
00926     None.
00927 
00928 --*/
00929 
00930 {
00931 
00932     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00933 
00934     <a class="code" href="../../d5/d9/kernldat_8c.html#a4">KiSwapContextNotifyRoutine</a> = NotifyRoutine;
00935     <span class="keywordflow">return</span>;
00936 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a331" doxytag="ke.h::KeSetSystemAffinityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetSystemAffinityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN KAFFINITY&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Affinity</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">1467</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00622">_KTHREAD::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00479">KiSelectNextThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00598">_KTHREAD::SystemAffinityActive</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01986">CmpConfigureProcessors()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00060">Ke386CallBios()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00154">KeConnectInterrupt()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00298">KeDisconnectInterrupt()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.
<p>
<pre class="fragment"><div>01473                    :
01474 
01475     This function set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system affinity of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread.
01476 
01477 Arguments:
01478 
01479     Affinity - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> of set of processors on which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread
01480         can run.
01481 
01482 Return Value:
01483 
01484     None.
01485 
01486 --*/
01487 
01488 {
01489 
01490     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> CurrentThread;
01491     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> NextThread;
01492     KIRQL OldIrql;
01493     PKPRCB Prcb;
01494 
01495     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01496     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((Affinity &amp; KeActiveProcessors) != 0);
01497 
01498     <span class="comment">//</span>
01499     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01500     <span class="comment">//</span>
01501 
01502     CurrentThread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
01503     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01504 
01505     <span class="comment">//</span>
01506     <span class="comment">// Set the current affinity to the specified affinity.</span>
01507     <span class="comment">//</span>
01508     <span class="comment">// If the current processor is not in the new affinity set and another</span>
01509     <span class="comment">// thread has not already been selected for execution on the current</span>
01510     <span class="comment">// processor, then select a new thread for the current processor.</span>
01511     <span class="comment">//</span>
01512 
01513     CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a> = Affinity;
01514     CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o32">SystemAffinityActive</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01515     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01516     <span class="keywordflow">if</span> (((Prcb-&gt;SetMember &amp; CurrentThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o41">Affinity</a>) == 0) &amp;&amp;
01517         (Prcb-&gt;NextThread == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
01518         NextThread = <a class="code" href="../../d0/d2/thredsup_8c.html#a4">KiSelectNextThread</a>(CurrentThread);
01519         NextThread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
01520         Prcb-&gt;NextThread = NextThread;
01521     }
01522 
01523     <span class="comment">//</span>
01524     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous value.</span>
01525     <span class="comment">//</span>
01526 
01527     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01528     <span class="keywordflow">return</span>;
01529 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a382" doxytag="ke.h::KeSetSystemTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSetSystemTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>NewTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>OldTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AdjustInterruptTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER HalTimeToSet&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">335</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00259">_DISPATCHER_HEADER::Absolute</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00523">_KTIMER::DueTime</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a176">HalSetRealTimeClock()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00091">HIGH_LEVEL</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00261">_DISPATCHER_HEADER::Inserted</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02767">KeBootTime</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02768">KeBootTimeBias</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">KeRevertToUserAffinityThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00544">KiAdjustInterruptTime()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00121">KiReinsertTreeTimer()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00755">KiRemoveTreeTimer</a>, <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00333">KiTimerListExpire()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00059">KiTimerTableListHead</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d1/d2/po_8h.html#a64">PoNotifySystemTimeSet()</a>, <a class="el" href="../../d2/d1/time_8c-source.html#l00508">RtlTimeToTimeFields()</a>, <a class="el" href="../../d7/d5/ttime_8c-source.html#l00046">TimeFields</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00094">TIMER_TABLE_SIZE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00524">_KTIMER::TimerListEntry</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00344                    :
00345 
00346     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system time to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified value and updates
00347     timer queue entries to reflect <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> difference between <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old system
00348     time and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> system time.
00349 
00350 Arguments:
00351 
00352     NewTime - Supplies a pointer to a variable that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> system
00353         time.
00354 
00355     OldTime - Supplies a pointer to a variable that will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous
00356         system time.
00357 
00358     AdjustInterruptTime - If <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> amount of time being adjusted <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00359         also applied to InterruptTime and <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a7">TickCount</a>.
00360 
00361     HalTimeToSet - Supplies an optional time that <span class="keywordflow">if</span> specified <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be used
00362         to set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> realtime clock.
00363 
00364 Return Value:
00365 
00366     None.
00367 
00368 --*/
00369 
00370 {
00371 
00372     LIST_ENTRY AbsoluteListHead;
00373     LIST_ENTRY ExpiredListHead;
00374     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00375     PLIST_ENTRY ListHead;
00376     PLIST_ENTRY NextEntry;
00377     KIRQL OldIrql1;
00378     KIRQL OldIrql2;
00379     LARGE_INTEGER TimeDelta;
00380     TIME_FIELDS <a class="code" href="../../d6/d6/ttime_8c.html#a13">TimeFields</a>;
00381     <a class="code" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> Timer;
00382 
00383     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt; DISPATCH_LEVEL);
00384 
00385     <span class="comment">//</span>
00386     <span class="comment">// If a realtime clock value is specified, then convert the time value</span>
00387     <span class="comment">// to time fields.</span>
00388     <span class="comment">//</span>
00389 
00390     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(HalTimeToSet)) {
00391         <a class="code" href="../../d1/d2/time_8c.html#a26">RtlTimeToTimeFields</a>(HalTimeToSet, &amp;TimeFields);
00392     }
00393 
00394     <span class="comment">//</span>
00395     <span class="comment">// Set affinity to the processor that keeps the system time, raise IRQL</span>
00396     <span class="comment">// to dispatcher level and lock the dispatcher database, then raise IRQL</span>
00397     <span class="comment">// to HIGH_LEVEL to synchronize with the clock interrupt routine.</span>
00398     <span class="comment">//</span>
00399 
00400     <a class="code" href="../../d9/d1/thredobj_8c.html#a19">KeSetSystemAffinityThread</a>((KAFFINITY)1);
00401     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql1);
00402     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(HIGH_LEVEL, &amp;OldIrql2);
00403 
00404     <span class="comment">//</span>
00405     <span class="comment">// Save the previous system time, set the new system time, and set</span>
00406     <span class="comment">// the realtime clock, if a time value is specified.</span>
00407     <span class="comment">//</span>
00408 
00409     KiQuerySystemTime(OldTime);
00410 
00411 <span class="preprocessor">#if defined(_WIN64)</span>
00412 <span class="preprocessor"></span>
00413     SharedUserData-&gt;SystemHigh2Time = NewTime-&gt;HighPart;
00414     SharedUserData-&gt;SystemLowTime = NewTime-&gt;LowPart;
00415     SharedUserData-&gt;SystemHigh1Time = NewTime-&gt;HighPart;
00416 
00417 <span class="preprocessor">#elif defined(ALPHA)</span>
00418 <span class="preprocessor"></span>
00419     SharedUserData-&gt;SystemTime = *(PULONGLONG)NewTime;
00420 
00421 <span class="preprocessor">#else</span>
00422 <span class="preprocessor"></span>
00423     SharedUserData-&gt;SystemTime.High2Time = NewTime-&gt;HighPart;
00424     SharedUserData-&gt;SystemTime.LowPart   = NewTime-&gt;LowPart;
00425     SharedUserData-&gt;SystemTime.High1Time = NewTime-&gt;HighPart;
00426 
00427 <span class="preprocessor">#endif // defined(ALPHA) || defined(_IA64_)</span>
00428 <span class="preprocessor"></span>
00429     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(HalTimeToSet)) {
00430         <a class="code" href="../../d2/d7/hal_8h.html#a176">HalSetRealTimeClock</a>(&amp;TimeFields);
00431     }
00432 
00433     <span class="comment">//</span>
00434     <span class="comment">// Compute the difference between the previous system time and the new</span>
00435     <span class="comment">// system time.</span>
00436     <span class="comment">//</span>
00437 
00438     TimeDelta.QuadPart = NewTime-&gt;QuadPart - OldTime-&gt;QuadPart;
00439 
00440     <span class="comment">//</span>
00441     <span class="comment">// Update the boot time to reflect the delta. This keeps time based</span>
00442     <span class="comment">// on boot time constant</span>
00443     <span class="comment">//</span>
00444 
00445     <a class="code" href="../../d4/d9/ke_8h.html#a124">KeBootTime</a>.QuadPart = <a class="code" href="../../d4/d9/ke_8h.html#a124">KeBootTime</a>.QuadPart + TimeDelta.QuadPart;
00446 
00447     <span class="comment">//</span>
00448     <span class="comment">// Track the overall bias applied to the boot time.</span>
00449     <span class="comment">//</span>
00450 
00451     <a class="code" href="../../d4/d9/ke_8h.html#a125">KeBootTimeBias</a> = <a class="code" href="../../d4/d9/ke_8h.html#a125">KeBootTimeBias</a> + TimeDelta.QuadPart;
00452 
00453     <span class="comment">//</span>
00454     <span class="comment">// Lower IRQL to dispatch level and if needed adjust the physical</span>
00455     <span class="comment">// system interrupt time.</span>
00456     <span class="comment">//</span>
00457 
00458     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql2);
00459     <span class="keywordflow">if</span> (AdjustInterruptTime) {
00460 
00461         <span class="comment">//</span>
00462         <span class="comment">// Adjust the physical time of the system</span>
00463         <span class="comment">//</span>
00464 
00465         AdjustInterruptTime = <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a8">KiAdjustInterruptTime</a> (TimeDelta.QuadPart);
00466     }
00467 
00468     <span class="comment">//</span>
00469     <span class="comment">// If the physical interrupt time of the system was not adjusted,</span>
00470     <span class="comment">// recompute any absolute timers in the system for the new</span>
00471     <span class="comment">// system time.</span>
00472     <span class="comment">//</span>
00473 
00474     <span class="keywordflow">if</span> (!AdjustInterruptTime) {
00475 
00476         <span class="comment">//</span>
00477         <span class="comment">// Remove all absolute timers from the timer queue so their due time</span>
00478         <span class="comment">// can be recomputed.</span>
00479         <span class="comment">//</span>
00480 
00481         InitializeListHead(&amp;AbsoluteListHead);
00482         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; <a class="code" href="../../d4/d9/ke_8h.html#a10">TIMER_TABLE_SIZE</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00483             ListHead = &amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a3">KiTimerTableListHead</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00484             NextEntry = ListHead-&gt;Flink;
00485             <span class="keywordflow">while</span> (NextEntry != ListHead) {
00486                 Timer = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>, TimerListEntry);
00487                 NextEntry = NextEntry-&gt;Flink;
00488                 <span class="keywordflow">if</span> (Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o1">Absolute</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00489                     RemoveEntryList(&amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o2">TimerListEntry</a>);
00490                     InsertTailList(&amp;AbsoluteListHead, &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o2">TimerListEntry</a>);
00491                 }
00492             }
00493         }
00494 
00495         <span class="comment">//</span>
00496         <span class="comment">// Recompute the due time and reinsert all absolute timers in the timer</span>
00497         <span class="comment">// tree. If a timer has already expired, then insert the timer in the</span>
00498         <span class="comment">// expired timer list.</span>
00499         <span class="comment">//</span>
00500 
00501         InitializeListHead(&amp;ExpiredListHead);
00502         <span class="keywordflow">while</span> (AbsoluteListHead.Flink != &amp;AbsoluteListHead) {
00503             Timer = CONTAINING_RECORD(AbsoluteListHead.Flink, <a class="code" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>, TimerListEntry);
00504             <a class="code" href="../../d0/d0/ki_8h.html#a22">KiRemoveTreeTimer</a>(Timer);
00505             Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o1">DueTime</a>.QuadPart -= TimeDelta.QuadPart;
00506             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/timersup_8c.html#a2">KiReinsertTreeTimer</a>(Timer, Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o1">DueTime</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00507                 Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o3">Inserted</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00508                 InsertTailList(&amp;ExpiredListHead, &amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o2">TimerListEntry</a>);
00509             }
00510         }
00511 
00512         <span class="comment">//</span>
00513         <span class="comment">// If any of the attempts to reinsert a timer failed, then timers have</span>
00514         <span class="comment">// already expired and must be processed.</span>
00515         <span class="comment">//</span>
00516         <span class="comment">// N.B. The following function returns with the dispatcher database</span>
00517         <span class="comment">//      unlocked.</span>
00518         <span class="comment">//</span>
00519 
00520         <a class="code" href="../../d0/d0/ki_8h.html#a141">KiTimerListExpire</a>(&amp;ExpiredListHead, OldIrql1);
00521 
00522     } <span class="keywordflow">else</span> {
00523 
00524         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql1);
00525 
00526     }
00527 
00528 
00529     <span class="comment">//</span>
00530     <span class="comment">// Set affinity back to its original value.</span>
00531     <span class="comment">//</span>
00532 
00533     <a class="code" href="../../d9/d1/thredobj_8c.html#a16">KeRevertToUserAffinityThread</a>();
00534 
00535     <span class="comment">//</span>
00536     <span class="comment">// Notify other components that the system time has been set</span>
00537     <span class="comment">//</span>
00538 
00539     <a class="code" href="../../d1/d2/po_8h.html#a64">PoNotifySystemTimeSet</a>();
00540     <span class="keywordflow">return</span>;
00541 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a263" doxytag="ke.h::KeSetTargetProcessorDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeSetTargetProcessorDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PRKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00401">401</a> of file <a class="el" href="../../d5/d0/dpcobj_8c-source.html">dpcobj.c</a>.
<p>
References <a class="el" href="../../d0/d5/ndismain_8h-source.html#l01420">MAXIMUM_PROCESSORS</a>.
<p>
<pre class="fragment"><div>00408                    :
00409 
00410     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor number to which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> targeted.
00411 
00412 Arguments:
00413 
00414     Dpc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00415 
00416     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target processor number.
00417 
00418 Return Value:
00419 
00420     None.
00421 
00422 --*/
00423 
00424 {
00425 
00426     <span class="comment">//</span>
00427     <span class="comment">// Set target processor number.</span>
00428     <span class="comment">//</span>
00429     <span class="comment">// The target processor number if biased by the maximum number of</span>
00430     <span class="comment">// processors that are supported.</span>
00431     <span class="comment">//</span>
00432 
00433     Dpc-&gt;Number = <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a> + Number;
00434     <span class="keywordflow">return</span>;
00435 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a400" doxytag="ke.h::KeSetThreadSelectNotifyRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL KeSetThreadSelectNotifyRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/ke_8h.html#a121">PTHREAD_SELECT_NOTIFY_ROUTINE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>NotifyRoutine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00940">940</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00074">KiThreadSelectNotifyRoutine</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>00946                    :
00947 
00948     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a callout routine which will be called
00949     when a thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> being selected <span class="keywordflow">for</span> execution.
00950 
00951 Arguments:
00952 
00953     NotifyRoutine - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread select notify callout
00954         routine.
00955 
00956 Return Value:
00957 
00958     None.
00959 
00960 --*/
00961 
00962 {
00963 
00964     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00965 
00966     <a class="code" href="../../d5/d9/kernldat_8c.html#a5">KiThreadSelectNotifyRoutine</a> = NotifyRoutine;
00967     <span class="keywordflow">return</span>;
00968 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a388" doxytag="ke.h::KeSetTimeIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeSetTimeIncrement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MaximumIncrement</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MimimumIncrement</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00779">779</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l02774">KeMaximumIncrement</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02775">KeMinimumIncrement</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02812">KeTimeAdjustment</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02813">KeTimeIncrement</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01139">KiTickOffset</a>, and <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>.
<p>
<pre class="fragment"><div>00786                    :
00787 
00788     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time increment value in 100ns units. This
00789     value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> added to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system time at each interval clock interrupt.
00790 
00791 Arguments:
00792 
00793     MaximumIncrement - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum time between clock interrupts
00794         in 100ns units supported by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host <a class="code" href="../../d0/d2/genxx_8h.html#a21">HAL</a>.
00795 
00796     MinimumIncrement - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d4/mrcf_8c.html#a3">minimum</a> time between clock interrupts
00797         in 100ns units supported by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host <a class="code" href="../../d0/d2/genxx_8h.html#a21">HAL</a>.
00798 
00799 Return Value:
00800 
00801     None.
00802 
00803 --*/
00804 
00805 {
00806 
00807     <a class="code" href="../../d4/d9/ke_8h.html#a131">KeMaximumIncrement</a> = MaximumIncrement;
00808     <a class="code" href="../../d4/d9/ke_8h.html#a132">KeMinimumIncrement</a> = <a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>(MinimumIncrement, 10 * 1000);
00809     <a class="code" href="../../d4/d9/ke_8h.html#a152">KeTimeAdjustment</a> = MaximumIncrement;
00810     <a class="code" href="../../d4/d9/ke_8h.html#a153">KeTimeIncrement</a> = MaximumIncrement;
00811     <a class="code" href="../../d0/d0/ki_8h.html#a66">KiTickOffset</a> = MaximumIncrement;
00812 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a345" doxytag="ke.h::KeSetTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeSetTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Timer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>DueTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00243">243</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00285">KeSetTimerEx()</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/copysup_8c-source.html#l01790">CcCanIWrite()</a>, <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00049">CcScheduleLazyWriteScan()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">CmpLazyFlush()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00431">ExpWorkerThreadBalanceManager()</a>, <a class="el" href="../../d5/d1/timers_8c-source.html#l00225">InternalSetTimer()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00760">IopErrorLogQueueRequest()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d5/d1/timers_8c-source.html#l00746">TimersProc()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.
<p>
<pre class="fragment"><div>00251                    :
00252 
00253     This function sets a timer to expire at a specified time. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00254     already set, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> implicitly canceled before <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to expire at
00255     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified time. Setting a timer causes its due time to be computed,
00256     its state to be set to Not-Signaled, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer object itself to be
00257     inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer list.
00258 
00259 Arguments:
00260 
00261     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00262 
00263     DueTime - Supplies an absolute or relative time at which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer
00264         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to expire.
00265 
00266     Dpc - Supplies an optional pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00267 
00268 Return Value:
00269 
00270     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified timer was
00271     currently set. Else a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00272 
00273 --*/
00274 
00275 {
00276 
00277     <span class="comment">//</span>
00278     <span class="comment">// Set the timer with a period of zero.</span>
00279     <span class="comment">//</span>
00280 
00281     <span class="keywordflow">return</span> <a class="code" href="../../d3/d2/timerobj_8c.html#a7">KeSetTimerEx</a>(Timer, DueTime, 0, Dpc);
00282 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a346" doxytag="ke.h::KeSetTimerEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeSetTimerEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Timer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>DueTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LONG Period&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00285">285</a> of file <a class="el" href="../../d4/d1/timerobj_8c-source.html">timerobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00037">ASSERT_TIMER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00525">_KTIMER::Dpc</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00089">KeInsertQueueDpc()</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00042">KiInsertTreeTimer()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00755">KiRemoveTreeTimer</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00526">_KTIMER::Period</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00038">TIMER_EXPIRE_INCREMENT</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00243">KeSetTimer()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03270">MiInitializeSpecialPoolCriteria()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00059">MiInsertPageInList()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02831">MiModifiedPageWriterWorker()</a>, and <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>.
<p>
<pre class="fragment"><div>00294                    :
00295 
00296     This function sets a timer to expire at a specified time. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00297     already set, then <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> implicitly canceled before <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to expire at
00298     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified time. Setting a timer causes its due time to be computed,
00299     its state to be set to Not-Signaled, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer object itself to be
00300     inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer list.
00301 
00302 Arguments:
00303 
00304     Timer - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> timer.
00305 
00306     DueTime - Supplies an absolute or relative time at which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer
00307         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to expire.
00308 
00309     Period - Supplies an optional period <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timer in milliseconds.
00310 
00311     Dpc - Supplies an optional pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> DPC.
00312 
00313 Return Value:
00314 
00315     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified timer was
00316     currently set. Else a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00317 
00318 --*/
00319 
00320 {
00321 
00322     BOOLEAN Inserted;
00323     LARGE_INTEGER Interval;
00324     KIRQL OldIrql;
00325     LARGE_INTEGER SystemTime;
00326 
00327     <a class="code" href="../../d3/d2/timerobj_8c.html#a0">ASSERT_TIMER</a>(Timer);
00328     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00329 
00330     <span class="comment">//</span>
00331     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00332     <span class="comment">//</span>
00333 
00334     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00335 
00336     <span class="comment">//</span>
00337     <span class="comment">// Capture the timer inserted status and if the timer is currently</span>
00338     <span class="comment">// set, then remove it from the timer list.</span>
00339     <span class="comment">//</span>
00340 
00341     Inserted = Timer-&gt;Header.Inserted;
00342     <span class="keywordflow">if</span> (Inserted != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00343         <a class="code" href="../../d0/d0/ki_8h.html#a22">KiRemoveTreeTimer</a>(Timer);
00344     }
00345 
00346     <span class="comment">//</span>
00347     <span class="comment">// Clear the signal state, set the period, set the DPC address, and</span>
00348     <span class="comment">// insert the timer in the timer tree. If the timer is not inserted</span>
00349     <span class="comment">// in the timer tree, then it has already expired and as many waiters</span>
00350     <span class="comment">// as possible should be continued, and a DPC, if specified should be</span>
00351     <span class="comment">// queued.</span>
00352     <span class="comment">//</span>
00353     <span class="comment">// N.B. The signal state must be cleared in case the period is not</span>
00354     <span class="comment">//      zero.</span>
00355     <span class="comment">//</span>
00356 
00357     Timer-&gt;Header.SignalState = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00358     Timer-&gt;Dpc = Dpc;
00359     Timer-&gt;Period = Period;
00360     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/timersup_8c.html#a1">KiInsertTreeTimer</a>((<a class="code" href="../../d3/d8/struct__KTIMER.html">PRKTIMER</a>)Timer, DueTime) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00361         <span class="keywordflow">if</span> (IsListEmpty(&amp;Timer-&gt;Header.WaitListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00362             <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(Timer, TIMER_EXPIRE_INCREMENT);
00363         }
00364 
00365         <span class="comment">//</span>
00366         <span class="comment">// If a DPC is specfied, then call the DPC routine.</span>
00367         <span class="comment">//</span>
00368 
00369         <span class="keywordflow">if</span> (Dpc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00370             KiQuerySystemTime(&amp;SystemTime);
00371             <a class="code" href="../../d4/d1/dpcobj_8c.html#a2">KeInsertQueueDpc</a>(Timer-&gt;Dpc,
00372                              ULongToPtr(SystemTime.LowPart),
00373                              ULongToPtr(SystemTime.HighPart));
00374         }
00375 
00376         <span class="comment">//</span>
00377         <span class="comment">// If the timer is periodic, then compute the next interval time</span>
00378         <span class="comment">// and reinsert the timer in the timer tree.</span>
00379         <span class="comment">//</span>
00380         <span class="comment">// N.B. Even though the timer insertion is relative, it can still</span>
00381         <span class="comment">//      fail if the period of the timer elapses in between computing</span>
00382         <span class="comment">//      the time and inserting the timer in the table. If this happens,</span>
00383         <span class="comment">//      try again.</span>
00384         <span class="comment">//</span>
00385 
00386         <span class="keywordflow">if</span> (Period != 0) {
00387             Interval.QuadPart = Int32x32To64(Timer-&gt;Period, - 10 * 1000);
00388             <span class="keywordflow">while</span> (!<a class="code" href="../../d5/d2/timersup_8c.html#a1">KiInsertTreeTimer</a>(Timer, Interval)) {
00389                 ; 
00390             }
00391         }
00392     }
00393 
00394     <span class="comment">//</span>
00395     <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00396     <span class="comment">// value.</span>
00397     <span class="comment">//</span>
00398 
00399     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00400 
00401     <span class="comment">//</span>
00402     <span class="comment">// Return boolean value that signifies whether the timer was set of</span>
00403     <span class="comment">// not.</span>
00404     <span class="comment">//</span>
00405 
00406     <span class="keywordflow">return</span> Inserted;
00407 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a401" doxytag="ke.h::KeSetTimeUpdateNotifyRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL KeSetTimeUpdateNotifyRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/ke_8h.html#a122">PTIME_UPDATE_NOTIFY_ROUTINE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>NotifyRoutine</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00972">972</a> of file <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html">ke/miscc.c</a>.
<p>
References <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00082">KiTimeUpdateNotifyRoutine</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>00978                    :
00979 
00980     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a callout routine which will be called
00981     each time <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> runtime <span class="keywordflow">for</span> a thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> updated.
00982 
00983 Arguments:
00984 
00985     RoutineNotify - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> time update notify callout
00986         routine.
00987 
00988 Return Value:
00989 
00990     None.
00991 
00992 --*/
00993 
00994 {
00995 
00996     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00997 
00998     <a class="code" href="../../d5/d9/kernldat_8c.html#a6">KiTimeUpdateNotifyRoutine</a> = NotifyRoutine;
00999     <span class="keywordflow">return</span>;
01000 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a303" doxytag="ke.h::KeStackAttachProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeStackAttachProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PROCESS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PRKAPC_STATE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ApcState</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00324">324</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00658">_KTHREAD::ApcStateIndex</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00048">ASSERT_PROCESS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00955">KiAttachProcess()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00656">_KTHREAD::SavedApcState</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02160">ObpCreateHandle()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02507">ObpCreateUnnamedHandle()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>.
<p>
<pre class="fragment"><div>00331                    :
00332 
00333     This function attaches a thread to a target process' address space
00334     and returns information about a previous attached process.
00335 
00336 Arguments:
00337 
00338     Process - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> process.
00339 
00340 Return Value:
00341 
00342     None.
00343 
00344 --*/
00345 
00346 {
00347 
00348     KIRQL OldIrql;
00349     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00350 
00351     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a0">ASSERT_PROCESS</a>(Process);
00352     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00353 
00354     <span class="comment">//</span>
00355     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00356     <span class="comment">//</span>
00357 
00358     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00359     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00360 
00361     <span class="comment">//</span>
00362     <span class="comment">// If the current thread is executing a DPC, then bug check.</span>
00363     <span class="comment">//</span>
00364 
00365     <span class="keywordflow">if</span> (KeIsExecutingDpc() != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00366         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(INVALID_PROCESS_ATTACH_ATTEMPT,
00367                      (ULONG_PTR)Process,
00368                      (ULONG_PTR)Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>,
00369                      (ULONG)Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a>,
00370                      (ULONG)KeIsExecutingDpc());
00371     }
00372 
00373     <span class="comment">//</span>
00374     <span class="comment">// If the target process is not the current process, then attach the target</span>
00375     <span class="comment">// process. Otherwise, return a distinguished process value to indicate that</span>
00376     <span class="comment">// an attach was not performed.</span>
00377     <span class="comment">//</span>
00378 
00379     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a> == Process) {
00380         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00381         ApcState-&gt;Process = (<a class="code" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>)1;
00382 
00383     } <span class="keywordflow">else</span> {
00384 
00385         <span class="comment">//</span>
00386         <span class="comment">// If the current thread is attached to a process, then save the current</span>
00387         <span class="comment">// APC state in the callers APC state structure. Otherwise, save the</span>
00388         <span class="comment">// current APC state in the saved APC state structure, and return a NULL</span>
00389         <span class="comment">// process pointer.</span>
00390         <span class="comment">//</span>
00391 
00392         <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> != 0) {
00393             <a class="code" href="../../d3/d5/procobj_8c.html#a13">KiAttachProcess</a>(Thread, Process, OldIrql, ApcState);
00394 
00395         } <span class="keywordflow">else</span> {
00396             <a class="code" href="../../d3/d5/procobj_8c.html#a13">KiAttachProcess</a>(Thread, Process, OldIrql, &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>);
00397             ApcState-&gt;Process = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00398         }
00399     }
00400 
00401     <span class="keywordflow">return</span>;
00402 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a391" doxytag="ke.h::KeStartAllProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeStartAllProcessors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00078">78</a> of file <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html">alpha/allproc.c</a>.
<p>
References <a class="el" href="../../d2/d8/arc_8h-source.html#l01701">_MEMORY_ALLOCATION_DESCRIPTOR::BasePage</a>, <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00043">BLOCK1_SIZE</a>, <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00044">BLOCK2_SIZE</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l00869">_BOOT_STATUS::BootFinished</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01359">_RESTART_BLOCK::BootStatus</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a197">HalStartNextProcessor()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02773">KeLoaderBlock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02788">KeRegisteredProcessors</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01847">_LOADER_PARAMETER_BLOCK::KernelStack</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00544">KiAdjustInterruptTime()</a>, <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00068">KiBarrierWait</a>, <a class="el" href="../../d9/d5/ppc_2allproc_8c-source.html#l00058">KiFreePcrPagesDescriptor</a>, <a class="el" href="../../d4/d6/alpha_2allproc_8c.html#a6">KiStartProcessor()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00591">KSEG0_BASE</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01699">_MEMORY_ALLOCATION_DESCRIPTOR::ListEntry</a>, <a class="el" href="../../d1/d9/arc_8h.html#a320a261">LoaderOsloaderHeap</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l01420">MAXIMUM_PROCESSORS</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01845">_LOADER_PARAMETER_BLOCK::MemoryDescriptorListHead</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01700">_MEMORY_ALLOCATION_DESCRIPTOR::MemoryType</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00600">PAGE_SHIFT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01702">_MEMORY_ALLOCATION_DESCRIPTOR::PageCount</a>, <a class="el" href="../../d1/d9/arc_8h.html#a124">PMEMORY_ALLOCATION_DESCRIPTOR</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01848">_LOADER_PARAMETER_BLOCK::Prcb</a>, <a class="el" href="../../d7/d9/hive_8h-source.html#l00049">ROUND_UP</a>, <a class="el" href="../../d2/d8/arc_8h-source.html#l01850">_LOADER_PARAMETER_BLOCK::Thread</a>, and <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">_LOADER_PARAMETER_BLOCK::u</a>.
<p>
<pre class="fragment"><div>00084                    :
00085 
00086     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called during phase 1 initialization on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> master boot
00087     processor to start all of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other registered processors.
00088 
00089 Arguments:
00090 
00091     None.
00092 
00093 Return Value:
00094 
00095     None.
00096 
00097 --*/
00098 
00099 {
00100 
00101     ULONG_PTR MemoryBlock1;
00102     ULONG_PTR MemoryBlock2;
00103     ULONG Number;
00104     ULONG PcrPage;
00105     PKPRCB Prcb;
00106     KPROCESSOR_STATE ProcessorState;
00107     <span class="keyword">struct </span><a class="code" href="../../d5/d4/struct__RESTART__BLOCK.html">_RESTART_BLOCK</a> *RestartBlock;
00108     BOOLEAN Started;
00109     LOGICAL SpecialPoolState;
00110 
00111 <span class="preprocessor">#if !defined(NT_UP)</span>
00112 <span class="preprocessor"></span>
00113     <span class="comment">//</span>
00114     <span class="comment">// If the registered number of processors is greater than the maximum</span>
00115     <span class="comment">// number of processors supported, then only allow the maximum number</span>
00116     <span class="comment">// of supported processors.</span>
00117     <span class="comment">//</span>
00118 
00119     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/ke_8h.html#a142">KeRegisteredProcessors</a> &gt; <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a>) {
00120         <a class="code" href="../../d4/d9/ke_8h.html#a142">KeRegisteredProcessors</a> = <a class="code" href="../../d9/d5/ndismain_8h.html#a183">MAXIMUM_PROCESSORS</a>;
00121     }
00122 
00123     <span class="comment">//</span>
00124     <span class="comment">// Initialize the processor state that will be used to start each of</span>
00125     <span class="comment">// processors. Each processor starts in the system initialization code</span>
00126     <span class="comment">// with address of the loader parameter block as an argument.</span>
00127     <span class="comment">//</span>
00128 
00129     RtlZeroMemory(&amp;ProcessorState, <span class="keyword">sizeof</span>(KPROCESSOR_STATE));
00130     ProcessorState.ContextFrame.IntA0 = (ULONGLONG)(LONG_PTR)<a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>;
00131     ProcessorState.ContextFrame.Fir = (ULONGLONG)(LONG_PTR)<a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a6">KiStartProcessor</a>;
00132     Number = 1;
00133     <span class="keywordflow">while</span> (Number &lt; <a class="code" href="../../d4/d9/ke_8h.html#a142">KeRegisteredProcessors</a>) {
00134 
00135         <span class="comment">//</span>
00136         <span class="comment">// Allocate a DPC stack, an idle thread kernel stack, a panic</span>
00137         <span class="comment">// stack, a PCR page, a processor block, and an executive thread</span>
00138         <span class="comment">// object. If the allocation fails or the allocation cannot be</span>
00139         <span class="comment">// made from unmapped nonpaged pool, then stop starting processors.</span>
00140         <span class="comment">//</span>
00141         <span class="comment">// Disable any special pooling that the user may have set in the</span>
00142         <span class="comment">// registry as the next couple of allocations must come from KSEG0.</span>
00143         <span class="comment">//</span>
00144 
00145         SpecialPoolState = <a class="code" href="../../d1/d6/allocpag_8c.html#a39">MmSetSpecialPool</a>(FALSE);
00146         MemoryBlock1 = (ULONG_PTR)<a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(NonPagedPool, BLOCK1_SIZE);
00147         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a3">IS_KSEG_ADDRESS</a>(MemoryBlock1) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00148             <a class="code" href="../../d1/d6/allocpag_8c.html#a39">MmSetSpecialPool</a>(SpecialPoolState);
00149             <span class="keywordflow">if</span> ((PVOID)MemoryBlock1 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00150                 <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>((PVOID)MemoryBlock1);
00151             }
00152 
00153             <span class="keywordflow">break</span>;
00154         }
00155 
00156         MemoryBlock2 = (ULONG_PTR)<a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(NonPagedPool, BLOCK2_SIZE);
00157         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a3">IS_KSEG_ADDRESS</a>(MemoryBlock2) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00158             <a class="code" href="../../d1/d6/allocpag_8c.html#a39">MmSetSpecialPool</a>(SpecialPoolState);
00159             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>((PVOID)MemoryBlock1);
00160             <span class="keywordflow">if</span> ((PVOID)MemoryBlock2 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00161                 <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>((PVOID)MemoryBlock2);
00162             }
00163 
00164             <span class="keywordflow">break</span>;
00165         }
00166 
00167         <a class="code" href="../../d1/d6/allocpag_8c.html#a39">MmSetSpecialPool</a>(SpecialPoolState);
00168 
00169         <span class="comment">//</span>
00170         <span class="comment">// Zero both blocks of allocated memory.</span>
00171         <span class="comment">//</span>
00172 
00173         RtlZeroMemory((PVOID)MemoryBlock1, BLOCK1_SIZE);
00174         RtlZeroMemory((PVOID)MemoryBlock2, BLOCK2_SIZE);
00175 
00176         <span class="comment">//</span>
00177         <span class="comment">// Set address of interrupt stack in loader parameter block.</span>
00178         <span class="comment">//</span>
00179 
00180         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">u</a>.Alpha.PanicStack =
00181                         <a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a5">KSEG0_ADDRESS</a>(MemoryBlock1 + (1 * KERNEL_STACK_SIZE));
00182 
00183         <span class="comment">//</span>
00184         <span class="comment">// Set address of idle thread kernel stack in loader parameter block.</span>
00185         <span class="comment">//</span>
00186 
00187         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o3">KernelStack</a> =
00188                         <a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a5">KSEG0_ADDRESS</a>(MemoryBlock1 + (2 * KERNEL_STACK_SIZE));
00189 
00190         ProcessorState.ContextFrame.IntSp =
00191                             (ULONGLONG)(LONG_PTR)<a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o3">KernelStack</a>;
00192 
00193         <span class="comment">//</span>
00194         <span class="comment">// Set address of panic stack in loader parameter block.</span>
00195         <span class="comment">//</span>
00196 
00197         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">u</a>.Alpha.DpcStack =
00198                         <a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a5">KSEG0_ADDRESS</a>(MemoryBlock1 + (3 * KERNEL_STACK_SIZE));
00199 
00200         <span class="comment">//</span>
00201         <span class="comment">// Set the page frame of the PCR page in the loader parameter block.</span>
00202         <span class="comment">//</span>
00203 
00204         PcrPage = <a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a4">KSEG_PFN</a>(MemoryBlock1 + (3 * KERNEL_STACK_SIZE));
00205         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o23">u</a>.Alpha.PcrPage = PcrPage;
00206 
00207         <span class="comment">//</span>
00208         <span class="comment">// Set the address of the processor block and executive thread in the</span>
00209         <span class="comment">// loader parameter block.</span>
00210         <span class="comment">//</span>
00211 
00212         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o4">Prcb</a> = <a class="code" href="../../d4/d6/alpha_2allproc_8c.html#a5">KSEG0_ADDRESS</a>((MemoryBlock2  + 63) &amp; ~63);
00213         <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o6">Thread</a> = <a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o4">Prcb</a> + <a class="code" href="../../d6/d0/hive_8h.html#a2">ROUND_UP</a>(KPRCB);
00214 
00215         <span class="comment">//</span>
00216         <span class="comment">// Attempt to start the next processor. If attempt is successful,</span>
00217         <span class="comment">// then wait for the processor to get initialized. Otherwise,</span>
00218         <span class="comment">// deallocate the processor resources and terminate the loop.</span>
00219         <span class="comment">//</span>
00220 
00221         Started = <a class="code" href="../../d2/d7/hal_8h.html#a197">HalStartNextProcessor</a>(KeLoaderBlock, &amp;ProcessorState);
00222         <span class="keywordflow">if</span> (Started == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00223             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>((PVOID)MemoryBlock1);
00224             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>((PVOID)MemoryBlock2);
00225             <span class="keywordflow">break</span>;
00226 
00227         } <span class="keywordflow">else</span> {
00228 
00229             <span class="comment">//</span>
00230             <span class="comment">// Wait until boot is finished on the target processor before</span>
00231             <span class="comment">// starting the next processor. Booting is considered to be</span>
00232             <span class="comment">// finished when a processor completes its initialization and</span>
00233             <span class="comment">// drops into the idle loop.</span>
00234             <span class="comment">//</span>
00235 
00236             Prcb = (PKPRCB)(<a class="code" href="../../d4/d9/ke_8h.html#a130">KeLoaderBlock</a>-&gt;<a class="code" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html#o4">Prcb</a>);
00237             RestartBlock = Prcb-&gt;RestartBlock;
00238             <span class="keywordflow">while</span> (RestartBlock-&gt;BootStatus.BootFinished == 0) {
00239                 KiMb();
00240             }
00241         }
00242 
00243         Number += 1;
00244     }
00245 
00246 <span class="preprocessor">#endif</span>
00247 <span class="preprocessor"></span>
00248     <span class="comment">//</span>
00249     <span class="comment">// Reset and synchronize the performance counters of all processors, by</span>
00250     <span class="comment">// applying a null adjustment to the interrupt time</span>
00251     <span class="comment">//</span>
00252 
00253     <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a8">KiAdjustInterruptTime</a>(0);
00254     <span class="keywordflow">return</span>;
00255 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a275" doxytag="ke.h::KeStartProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeStartProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Profile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/profobj_8c-source.html#l00289">289</a> of file <a class="el" href="../../d1/d7/profobj_8c-source.html">profobj.c</a>.
<p>
References <a class="el" href="../../d1/d7/profobj_8c-source.html#l00044">_KACTIVE_PROFILE_SOURCE::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00034">ASSERT_PROFILE</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a173">HalStartProfileInterrupt()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01094">KiEnableAlignmentExceptions</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00458">KiProfileAlignmentFixup</a>, <a class="el" href="../../d8/d2/i386init_8c-source.html#l00037">KiProfileIrql</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00484">KiProfileListHead</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00066">KiProfileLock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00451">KiProfileSourceListHead</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00772">KiStartProfileInterrupt()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00042">_KACTIVE_PROFILE_SOURCE::ListEntry</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d8/profobj_8c.html#a2">PKACTIVE_PROFILE_SOURCE</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00045">_KACTIVE_PROFILE_SOURCE::ProcessorCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00699">_KPROCESS::ProfileListHead</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00043">_KACTIVE_PROFILE_SOURCE::Source</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00517">NtStartProfile()</a>.
<p>
<pre class="fragment"><div>00296                    :
00297 
00298     This function starts profile data gathering on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified profile
00299     object. The profile object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> marked started, and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> registered with
00300     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile interrupt <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a>.
00301 
00302     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of active profile objects was previously zero, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00303     profile interrupt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> enabled.
00304 
00305     N.B. For <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current implementation, an arbitrary number of profile
00306         objects may be active at once. This can present a large system
00307         overhead. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> assumed that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller appropriately limits <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00308         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of active profiles.
00309 
00310 Arguments:
00311 
00312     Profile - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> profile.
00313 
00314     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> - Supplies a pointer to an array of counters, which record
00315         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of hits in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> corresponding bucket.
00316 
00317 Return Value:
00318 
00319     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> profiling was previously stopped <span class="keywordflow">for</span>
00320     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified profile object. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00321 
00322 --*/
00323 
00324 {
00325 
00326     KIRQL OldIrql, OldIrql2;
00327     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00328     BOOLEAN Started;
00329     KAFFINITY TargetProcessors;
00330     PKPRCB Prcb;
00331     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">PKACTIVE_PROFILE_SOURCE</a> ActiveSource = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00332     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">PKACTIVE_PROFILE_SOURCE</a> CurrentActiveSource;
00333     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">PKACTIVE_PROFILE_SOURCE</a> AllocatedPool;
00334     PLIST_ENTRY ListEntry;
00335     ULONG SourceSize;
00336     KAFFINITY AffinitySet;
00337     PULONG Reference;
00338 
00339     <a class="code" href="../../d0/d8/profobj_8c.html#a0">ASSERT_PROFILE</a>(Profile);
00340     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00341 
00342     <span class="comment">//</span>
00343     <span class="comment">// Allocate pool that may be required before raising to PROFILE_LEVEL.</span>
00344     <span class="comment">//</span>
00345 
00346     SourceSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">KACTIVE_PROFILE_SOURCE</a>) + <span class="keyword">sizeof</span>(ULONG) *
00347                  (<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a> - 1);
00348     AllocatedPool = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPool, SourceSize, 'forP');
00349     <span class="keywordflow">if</span> (AllocatedPool == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00350         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00351     }
00352 
00353     <span class="comment">//</span>
00354     <span class="comment">// Raise to dispatch level</span>
00355     <span class="comment">//</span>
00356 
00357     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a> (DISPATCH_LEVEL, &amp;OldIrql);
00358     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00359 
00360     <span class="comment">//</span>
00361     <span class="comment">// Raise IRQL to PROFILE_LEVEL and acquire the profile lock.</span>
00362     <span class="comment">//</span>
00363 
00364     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(KiProfileIrql, &amp;OldIrql2);
00365     KiAcquireSpinLock(&amp;KiProfileLock);
00366 
00367     <span class="comment">//</span>
00368     <span class="comment">// Assume object already started</span>
00369     <span class="comment">//</span>
00370 
00371     Started = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00372     AffinitySet = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00373     TargetProcessors = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00374 
00375     <span class="comment">//</span>
00376     <span class="comment">// If the specified profile object is not started, set started to TRUE,</span>
00377     <span class="comment">// set the address of the profile buffer, set the profile object to started,</span>
00378     <span class="comment">// insert the profile object in the appropriate profile list, and start</span>
00379     <span class="comment">// profile interrupts if the number of active profile objects was previously zero.</span>
00380     <span class="comment">//</span>
00381 
00382     <span class="keywordflow">if</span> (Profile-&gt;Started == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00383 
00384         Started = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00385         Profile-&gt;Buffer = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
00386         Profile-&gt;Started = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00387         Process = Profile-&gt;Process;
00388         <span class="keywordflow">if</span> (Process != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00389             InsertTailList(&amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o1">ProfileListHead</a>, &amp;Profile-&gt;ProfileListEntry);
00390 
00391         } <span class="keywordflow">else</span> {
00392             InsertTailList(&amp;KiProfileListHead, &amp;Profile-&gt;ProfileListEntry);
00393         }
00394 
00395         <span class="comment">//</span>
00396         <span class="comment">// Check the profile source list to see if this profile source is</span>
00397         <span class="comment">// already started. If so, update the reference counts. If not,</span>
00398         <span class="comment">// allocate a profile source object, initialize the reference</span>
00399         <span class="comment">// counts, and add it to the list.</span>
00400         <span class="comment">//</span>
00401 
00402         ListEntry = <a class="code" href="../../d5/d9/kernldat_8c.html#a51">KiProfileSourceListHead</a>.Flink;
00403         <span class="keywordflow">while</span> (ListEntry != &amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a51">KiProfileSourceListHead</a>) {
00404             CurrentActiveSource = CONTAINING_RECORD(ListEntry,
00405                                                     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">KACTIVE_PROFILE_SOURCE</a>,
00406                                                     ListEntry);
00407 
00408             <span class="keywordflow">if</span> (CurrentActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o1">Source</a> == Profile-&gt;Source) {
00409                 ActiveSource = CurrentActiveSource;
00410                 <span class="keywordflow">break</span>;
00411             }
00412             ListEntry = ListEntry-&gt;Flink;
00413         }
00414 
00415         <span class="keywordflow">if</span> (ActiveSource == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00416 
00417             <span class="comment">//</span>
00418             <span class="comment">// This source was not found, allocate and initialize a new entry and add</span>
00419             <span class="comment">// it to the head of the list.</span>
00420             <span class="comment">//</span>
00421 
00422             ActiveSource = AllocatedPool;
00423             AllocatedPool = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00424             RtlZeroMemory(ActiveSource, SourceSize);
00425             ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o1">Source</a> = Profile-&gt;Source;
00426             InsertHeadList(&amp;KiProfileSourceListHead, &amp;ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o0">ListEntry</a>);
00427             <span class="keywordflow">if</span> (Profile-&gt;Source == ProfileAlignmentFixup) {
00428                 <a class="code" href="../../d5/d9/kernldat_8c.html#a52">KiProfileAlignmentFixup</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00429             }
00430         }
00431 
00432         <span class="comment">//</span>
00433         <span class="comment">// Increment the reference counts for each processor in the</span>
00434         <span class="comment">// affinity set.</span>
00435         <span class="comment">//</span>
00436 
00437         AffinitySet = Profile-&gt;Affinity;
00438         Reference = &amp;ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o3">ProcessorCount</a>[0];
00439         <span class="keywordflow">while</span> (AffinitySet != 0) {
00440             <span class="keywordflow">if</span> (AffinitySet &amp; 1) {
00441                 *Reference = *Reference + 1;
00442             }
00443 
00444             AffinitySet = AffinitySet &gt;&gt; 1;
00445             Reference = Reference + 1;
00446         }
00447 
00448         <span class="comment">//</span>
00449         <span class="comment">// Compute the processors which the profile interrupt is</span>
00450         <span class="comment">// required and not already started</span>
00451         <span class="comment">//</span>
00452 
00453         AffinitySet = Profile-&gt;Affinity &amp; ~ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o2">Affinity</a>;
00454         TargetProcessors = AffinitySet &amp; ~Prcb-&gt;SetMember;
00455 
00456         <span class="comment">//</span>
00457         <span class="comment">// Update set of processors on which this source is active.</span>
00458         <span class="comment">//</span>
00459 
00460         ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o2">Affinity</a> |= Profile-&gt;Affinity;
00461     }
00462 
00463     <span class="comment">//</span>
00464     <span class="comment">// Release the profile lock, lower IRQL to its previous value, and</span>
00465     <span class="comment">// return whether profiling was started.</span>
00466     <span class="comment">//</span>
00467 
00468     KiReleaseSpinLock(&amp;KiProfileLock);
00469     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql2);
00470 
00471     <span class="comment">//</span>
00472     <span class="comment">// Start profile interrupt on pending processors</span>
00473     <span class="comment">//</span>
00474 
00475 <span class="preprocessor">#if !defined(NT_UP)</span>
00476 <span class="preprocessor"></span>
00477     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00478         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00479                         KiStartProfileInterrupt,
00480                         (PVOID)Profile-&gt;Source,
00481                         NULL,
00482                         NULL);
00483     }
00484 
00485 <span class="preprocessor">#endif</span>
00486 <span class="preprocessor"></span>
00487     <span class="keywordflow">if</span> (AffinitySet &amp; Prcb-&gt;SetMember) {
00488         <span class="keywordflow">if</span> (Profile-&gt;Source == ProfileAlignmentFixup) {
00489             <a class="code" href="../../d0/d0/ki_8h.html#a28">KiEnableAlignmentExceptions</a>();
00490         }
00491         <a class="code" href="../../d2/d7/hal_8h.html#a173">HalStartProfileInterrupt</a>(Profile-&gt;Source);
00492     }
00493 
00494 <span class="preprocessor">#if !defined(NT_UP)</span>
00495 <span class="preprocessor"></span>
00496     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00497         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00498     }
00499 
00500 <span class="preprocessor">#endif</span>
00501 <span class="preprocessor"></span>
00502     <span class="comment">//</span>
00503     <span class="comment">// Lower to original IRQL</span>
00504     <span class="comment">//</span>
00505 
00506     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00507 
00508     <span class="comment">//</span>
00509     <span class="comment">// If the allocated pool was not used, free it now.</span>
00510     <span class="comment">//</span>
00511 
00512     <span class="keywordflow">if</span> (AllocatedPool != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00513         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(AllocatedPool);
00514     }
00515 
00516     <span class="keywordflow">return</span> Started;
00517 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a276" doxytag="ke.h::KeStopProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeStopProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d7/struct__KPROFILE.html">PKPROFILE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Profile</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/profobj_8c-source.html#l00520">520</a> of file <a class="el" href="../../d1/d7/profobj_8c-source.html">profobj.c</a>.
<p>
References <a class="el" href="../../d1/d7/profobj_8c-source.html#l00044">_KACTIVE_PROFILE_SOURCE::Affinity</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00034">ASSERT_PROFILE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a174">HalStopProfileInterrupt()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01095">KiDisableAlignmentExceptions</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00458">KiProfileAlignmentFixup</a>, <a class="el" href="../../d8/d2/i386init_8c-source.html#l00037">KiProfileIrql</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00066">KiProfileLock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00451">KiProfileSourceListHead</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00724">KiStopProfileInterrupt()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00042">_KACTIVE_PROFILE_SOURCE::ListEntry</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d8/profobj_8c.html#a2">PKACTIVE_PROFILE_SOURCE</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00045">_KACTIVE_PROFILE_SOURCE::ProcessorCount</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00043">_KACTIVE_PROFILE_SOURCE::Source</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00145">ExpProfileDelete()</a>, and <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00680">NtStopProfile()</a>.
<p>
<pre class="fragment"><div>00526                    :
00527 
00528     This function stops profile data gathering on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified profile
00529     object. The object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> marked stopped, and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> removed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> active
00530     profile list.
00531 
00532     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of active profile objects goes to zero, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> profile
00533     interrupt <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disabled.
00534 
00535 Arguments:
00536 
00537     Profile - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> profile.
00538 
00539 Return Value:
00540 
00541     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> profiling was previously started <span class="keywordflow">for</span>
00542     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified profile object. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00543 
00544 --*/
00545 
00546 {
00547 
00548     KIRQL OldIrql, OldIrql2;
00549     BOOLEAN Stopped;
00550     KAFFINITY TargetProcessors;
00551     PKPRCB Prcb;
00552     BOOLEAN StopInterrupt = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00553     PLIST_ENTRY ListEntry;
00554     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">PKACTIVE_PROFILE_SOURCE</a> ActiveSource;
00555     <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">PKACTIVE_PROFILE_SOURCE</a> PoolToFree=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00556     KAFFINITY AffinitySet = 0;
00557     KAFFINITY CurrentProcessor;
00558     PULONG Reference;
00559 
00560     <a class="code" href="../../d0/d8/profobj_8c.html#a0">ASSERT_PROFILE</a>(Profile);
00561     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00562 
00563     <span class="comment">//</span>
00564     <span class="comment">// Raise to disaptch level</span>
00565     <span class="comment">//</span>
00566 
00567     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a> (DISPATCH_LEVEL, &amp;OldIrql);
00568     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00569 
00570     <span class="comment">//</span>
00571     <span class="comment">// Raise IRQL to PROFILE_LEVEL and acquire the profile lock.</span>
00572     <span class="comment">//</span>
00573 
00574     <a class="code" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql</a>(KiProfileIrql, &amp;OldIrql2);
00575     KiAcquireSpinLock(&amp;KiProfileLock);
00576 
00577     <span class="comment">//</span>
00578     <span class="comment">// Assume object already stopped</span>
00579     <span class="comment">//</span>
00580 
00581     Stopped = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00582     AffinitySet = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00583     TargetProcessors = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00584 
00585     <span class="comment">//</span>
00586     <span class="comment">// If the specified profile object is not stopped, set stopped to TRUE, set</span>
00587     <span class="comment">// the profile object to stopped, remove the profile object object from the</span>
00588     <span class="comment">// appropriate profilelist, and stop profile interrupts if the number of</span>
00589     <span class="comment">// active profile objects is zero.</span>
00590     <span class="comment">//</span>
00591 
00592     <span class="keywordflow">if</span> (Profile-&gt;Started != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00593 
00594         Stopped = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00595         Profile-&gt;Started = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00596         RemoveEntryList(&amp;Profile-&gt;ProfileListEntry);
00597 
00598         <span class="comment">//</span>
00599         <span class="comment">// Search the profile source list to find the entry for this</span>
00600         <span class="comment">// profile source.</span>
00601         <span class="comment">//</span>
00602 
00603         ListEntry = <a class="code" href="../../d5/d9/kernldat_8c.html#a51">KiProfileSourceListHead</a>.Flink;
00604         <span class="keywordflow">do</span> {
00605             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(ListEntry != &amp;KiProfileSourceListHead);
00606             ActiveSource = CONTAINING_RECORD(ListEntry,
00607                                              <a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html">KACTIVE_PROFILE_SOURCE</a>,
00608                                              ListEntry);
00609             ListEntry = ListEntry-&gt;Flink;
00610         } <span class="keywordflow">while</span> ( ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o1">Source</a> != Profile-&gt;Source );
00611 
00612         <span class="comment">//</span>
00613         <span class="comment">// Decrement the reference counts for each processor in the</span>
00614         <span class="comment">// affinity set and build up a mask of the processors that</span>
00615         <span class="comment">// now have a reference count of zero.</span>
00616         <span class="comment">//</span>
00617 
00618         CurrentProcessor = 1;
00619         TargetProcessors = 0;
00620         AffinitySet = Profile-&gt;Affinity;
00621         Reference = &amp;ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o3">ProcessorCount</a>[0];
00622         <span class="keywordflow">while</span> (AffinitySet != 0) {
00623             <span class="keywordflow">if</span> (AffinitySet &amp; 1) {
00624                 *Reference = *Reference - 1;
00625                 <span class="keywordflow">if</span> (*Reference == 0) {
00626                     TargetProcessors = TargetProcessors | CurrentProcessor;
00627                 }
00628             }
00629 
00630             AffinitySet = AffinitySet &gt;&gt; 1;
00631             Reference = Reference + 1;
00632             CurrentProcessor = CurrentProcessor &lt;&lt; 1;
00633         }
00634 
00635         <span class="comment">//</span>
00636         <span class="comment">// Compute the processors whose profile interrupt reference</span>
00637         <span class="comment">// count has dropped to zero.</span>
00638         <span class="comment">//</span>
00639 
00640         AffinitySet = TargetProcessors;
00641         TargetProcessors = AffinitySet &amp; ~Prcb-&gt;SetMember;
00642 
00643         <span class="comment">//</span>
00644         <span class="comment">// Update set of processors on which this source is active.</span>
00645         <span class="comment">//</span>
00646 
00647         ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o2">Affinity</a> &amp;= ~AffinitySet;
00648 
00649         <span class="comment">//</span>
00650         <span class="comment">// Determine whether this profile source is stopped on all</span>
00651         <span class="comment">// processors. If so, remove it from the list and free it.</span>
00652         <span class="comment">//</span>
00653 
00654         <span class="keywordflow">if</span> (ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o2">Affinity</a> == 0) {
00655             RemoveEntryList(&amp;ActiveSource-&gt;<a class="code" href="../../d0/d5/struct__KACTIVE__PROFILE__SOURCE.html#o0">ListEntry</a>);
00656             PoolToFree = ActiveSource;
00657             <span class="keywordflow">if</span> (Profile-&gt;Source == ProfileAlignmentFixup) {
00658                 <a class="code" href="../../d5/d9/kernldat_8c.html#a52">KiProfileAlignmentFixup</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00659             }
00660         }
00661     }
00662 
00663     <span class="comment">//</span>
00664     <span class="comment">// Release the profile lock, lower IRQL to its previous value, and</span>
00665     <span class="comment">// return whether profiling was stopped.</span>
00666     <span class="comment">//</span>
00667 
00668     KiReleaseSpinLock(&amp;KiProfileLock);
00669     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql2);
00670 
00671     <span class="comment">//</span>
00672     <span class="comment">// Stop profile interrupt on pending processors</span>
00673     <span class="comment">//</span>
00674 
00675 <span class="preprocessor">#if !defined(NT_UP)</span>
00676 <span class="preprocessor"></span>
00677     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00678         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00679                         KiStopProfileInterrupt,
00680                         (PVOID)Profile-&gt;Source,
00681                         NULL,
00682                         NULL);
00683     }
00684 
00685 <span class="preprocessor">#endif</span>
00686 <span class="preprocessor"></span>
00687     <span class="keywordflow">if</span> (AffinitySet &amp; Prcb-&gt;SetMember) {
00688         <span class="keywordflow">if</span> (Profile-&gt;Source == ProfileAlignmentFixup) {
00689             <a class="code" href="../../d0/d0/ki_8h.html#a29">KiDisableAlignmentExceptions</a>();
00690         }
00691         <a class="code" href="../../d2/d7/hal_8h.html#a174">HalStopProfileInterrupt</a>(Profile-&gt;Source);
00692     }
00693 
00694 <span class="preprocessor">#if !defined(NT_UP)</span>
00695 <span class="preprocessor"></span>
00696     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00697         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00698     }
00699 
00700 <span class="preprocessor">#endif</span>
00701 <span class="preprocessor"></span>
00702     <span class="comment">//</span>
00703     <span class="comment">// Lower to original IRQL</span>
00704     <span class="comment">//</span>
00705 
00706     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a> (OldIrql);
00707 
00708     <span class="comment">//</span>
00709     <span class="comment">// Now that IRQL has been lowered, free the profile source if</span>
00710     <span class="comment">// necessary.</span>
00711     <span class="comment">//</span>
00712 
00713     <span class="keywordflow">if</span> (PoolToFree != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00714         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(PoolToFree);
00715     }
00716 
00717     <span class="keywordflow">return</span> Stopped;
00718 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a337" doxytag="ke.h::KeSuspendThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG KeSuspendThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PKTHREAD</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01912">1912</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/alpha_2thredini_8c-source.html#l00052">ASSERT_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/apcsup_8c-source.html#l00223">KiInsertQueueApc()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00033">NtSuspendThread()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.
<p>
<pre class="fragment"><div>01918                    :
01919 
01920     This function suspends <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of a thread. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> suspend count
01921     overflows <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum suspend count, then a condition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
01922 
01923 Arguments:
01924 
01925     Thread  - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
01926 
01927 Return Value:
01928 
01929     The previous suspend count.
01930 
01931 --*/
01932 
01933 {
01934 
01935     ULONG OldCount;
01936     KIRQL OldIrql;
01937 
01938     <a class="code" href="../../d4/d1/alpha_2thredini_8c.html#a1">ASSERT_THREAD</a>(Thread);
01939     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
01940 
01941     <span class="comment">//</span>
01942     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
01943     <span class="comment">//</span>
01944 
01945     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01946 
01947     <span class="comment">//</span>
01948     <span class="comment">// Capture the current suspend count.</span>
01949     <span class="comment">//</span>
01950 
01951     OldCount = Thread-&gt;SuspendCount;
01952 
01953     <span class="comment">//</span>
01954     <span class="comment">// If the suspend count is at its maximum value, then unlock dispatcher</span>
01955     <span class="comment">// database, lower IRQL to its previous value, and raise an error</span>
01956     <span class="comment">// condition.</span>
01957     <span class="comment">//</span>
01958 
01959     <span class="keywordflow">if</span> (OldCount == MAXIMUM_SUSPEND_COUNT) {
01960 
01961         <span class="comment">//</span>
01962         <span class="comment">// Unlock the dispatcher database and raise an exception.</span>
01963         <span class="comment">//</span>
01964 
01965         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01966         <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_SUSPEND_COUNT_EXCEEDED);
01967     }
01968 
01969     <span class="comment">//</span>
01970     <span class="comment">// Increment the suspend count. If the thread was not previously suspended,</span>
01971     <span class="comment">// then queue the thread's suspend APC.</span>
01972     <span class="comment">//</span>
01973 
01974     Thread-&gt;SuspendCount += 1;
01975     <span class="keywordflow">if</span> ((OldCount == 0) &amp;&amp; (Thread-&gt;FreezeCount == 0)) {
01976         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/ki_8h.html#a123">KiInsertQueueApc</a>(&amp;Thread-&gt;SuspendApc, RESUME_INCREMENT) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01977             Thread-&gt;SuspendSemaphore.Header.SignalState -= 1;
01978         }
01979     }
01980 
01981     <span class="comment">//</span>
01982     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
01983     <span class="comment">// value.</span>
01984     <span class="comment">//</span>
01985 
01986     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01987 
01988     <span class="comment">//</span>
01989     <span class="comment">// Return the previous suspend count.</span>
01990     <span class="comment">//</span>
01991 
01992     <span class="keywordflow">return</span> OldCount;
01993 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a393" doxytag="ke.h::KeSwapProcessOrStack" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeSwapProcessOrStack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00322">322</a> of file <a class="el" href="../../d0/d0/balmgr_8c-source.html">balmgr.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00623">Executive</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">KeSetPriorityThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00431">KiInSwapKernelStacks()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00483">KiInSwapProcesses()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00544">KiOutSwapKernelStacks()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00644">KiOutSwapProcesses()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00428">KiProcessInSwapListHead</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00435">KiProcessOutSwapListHead</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00444">KiStackInSwapListHead</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00139">KiStackOutSwapRequest</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00421">KiSwapEvent</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>.
<p>
<pre class="fragment"><div>00328                    :
00329 
00330     This thread controls <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> swapping of processes and kernel stacks. The
00331     order of evaluation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>:
00332 
00333         Outswap kernel stacks
00334         Outswap processes
00335         Inswap processes
00336         Inswap kernel stacks
00337 
00338 Arguments:
00339 
00340     Context - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine context - not used.
00341 
00342 Return Value:
00343 
00344     None.
00345 
00346 --*/
00347 
00348 {
00349 
00350     KIRQL OldIrql;
00351     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00352 
00353     <span class="comment">//</span>
00354     <span class="comment">// Raise the thread priority to the lowest realtime level + 7 (i.e.,</span>
00355     <span class="comment">// priority 23).</span>
00356     <span class="comment">//</span>
00357 
00358     <a class="code" href="../../d9/d1/thredobj_8c.html#a24">KeSetPriorityThread</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>(), LOW_REALTIME_PRIORITY + 7);
00359 
00360     <span class="comment">//</span>
00361     <span class="comment">// Loop for ever processing swap events.</span>
00362     <span class="comment">//</span>
00363 
00364     <span class="keywordflow">do</span> {
00365 
00366         <span class="comment">//</span>
00367         <span class="comment">// Wait for a swap event to occur.</span>
00368         <span class="comment">//</span>
00369 
00370         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d7/wait_8c.html#a4">KeWaitForSingleObject</a>(&amp;KiSwapEvent,
00371                                        Executive,
00372                                        KernelMode,
00373                                        FALSE,
00374                                        NULL);
00375 
00376         <span class="comment">//</span>
00377         <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00378         <span class="comment">//</span>
00379 
00380         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00381 
00382         <span class="comment">//</span>
00383         <span class="comment">// Loop until all of the four possible actions cannot be initiated.</span>
00384         <span class="comment">//</span>
00385 
00386         <span class="keywordflow">do</span> {
00387 
00388             <span class="comment">//</span>
00389             <span class="comment">// If a request has been made to out swap kernel stacks, then</span>
00390             <span class="comment">// attempt to outswap kernel stacks. Otherwise, if the process</span>
00391             <span class="comment">// out swap list is not empty, then initiate process outswapping.</span>
00392             <span class="comment">// Otherwise, if the process inswap list is not empty, then start</span>
00393             <span class="comment">// process inswapping. Otherwise, if the kernal stack inswap list</span>
00394             <span class="comment">// is not active, then initiate kernel stack inswapping. Otherwise,</span>
00395             <span class="comment">// no work is available.</span>
00396             <span class="comment">//</span>
00397 
00398             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d0/balmgr_8c.html#a15">KiStackOutSwapRequest</a> != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00399                 <a class="code" href="../../d9/d0/balmgr_8c.html#a15">KiStackOutSwapRequest</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00400                 <a class="code" href="../../d9/d0/balmgr_8c.html#a21">KiOutSwapKernelStacks</a>(OldIrql);
00401                 <span class="keywordflow">continue</span>;
00402 
00403             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsListEmpty(&amp;KiProcessOutSwapListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00404                 <a class="code" href="../../d9/d0/balmgr_8c.html#a22">KiOutSwapProcesses</a>(OldIrql);
00405                 <span class="keywordflow">continue</span>;
00406 
00407             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsListEmpty(&amp;KiProcessInSwapListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00408                 <a class="code" href="../../d9/d0/balmgr_8c.html#a20">KiInSwapProcesses</a>(OldIrql);
00409                 <span class="keywordflow">continue</span>;
00410 
00411             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsListEmpty(&amp;KiStackInSwapListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00412                 <a class="code" href="../../d9/d0/balmgr_8c.html#a19">KiInSwapKernelStacks</a>(OldIrql);
00413                 <span class="keywordflow">continue</span>;
00414 
00415             } <span class="keywordflow">else</span> {
00416                 <span class="keywordflow">break</span>;
00417             }
00418         } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00419 
00420         <span class="comment">//</span>
00421         <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00422         <span class="comment">// value.</span>
00423         <span class="comment">//</span>
00424 
00425         <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00426     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00427     <span class="keywordflow">return</span>;
00428 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a379" doxytag="ke.h::KeSwitchFrozenProcessor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/ke_8h.html#a408">KCONTINUE_STATUS</a> KeSwitchFrozenProcessor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ProcessorNumber</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00334">334</a> of file <a class="el" href="../../d0/d4/ke_2debug_8c-source.html">ke/debug.c</a>.
<p>
References <a class="el" href="../../d4/d9/ke_8h.html#a408a226">ContinueError</a>, <a class="el" href="../../d4/d9/ke_8h.html#a408a229">ContinueNextProcessor</a>, <a class="el" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00039">FREEZE_ACTIVE</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00036">FREEZE_OWNER</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00030">FrozenState</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, and <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00034">TARGET_FROZEN</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00847">KdpSendWaitContinue()</a>.
<p>
<pre class="fragment"><div>00337 {
00338 <span class="preprocessor">#if !defined(NT_UP)</span>
00339 <span class="preprocessor"></span>    PKPRCB TargetPrcb, CurrentPrcb;
00340 
00341     <span class="comment">//</span>
00342     <span class="comment">// If Processor number is out of range, reselect current processor</span>
00343     <span class="comment">//</span>
00344 
00345     <span class="keywordflow">if</span> (ProcessorNumber &gt;= (ULONG) <a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>) {
00346         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>;
00347     }
00348 
00349     TargetPrcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[ProcessorNumber];
00350     CurrentPrcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00351 
00352     <span class="comment">//</span>
00353     <span class="comment">// Move active flag to correct processor.</span>
00354     <span class="comment">//</span>
00355 
00356     CurrentPrcb-&gt;IpiFrozen &amp;= ~<a class="code" href="../../d9/d4/ke_2debug_8c.html#a6">FREEZE_ACTIVE</a>;
00357     TargetPrcb-&gt;IpiFrozen  |= <a class="code" href="../../d9/d4/ke_2debug_8c.html#a6">FREEZE_ACTIVE</a>;
00358 
00359     <span class="comment">//</span>
00360     <span class="comment">// If this processor is frozen in KiFreezeTargetExecution, return to it</span>
00361     <span class="comment">//</span>
00362 
00363     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d4/ke_2debug_8c.html#a1">FrozenState</a>(CurrentPrcb-&gt;IpiFrozen) == <a class="code" href="../../d9/d4/ke_2debug_8c.html#a3">TARGET_FROZEN</a>) {
00364         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a408a229">ContinueNextProcessor</a>;
00365     }
00366 
00367     <span class="comment">//</span>
00368     <span class="comment">// This processor must be FREEZE_OWNER, wait to be reselected as the</span>
00369     <span class="comment">// active processor</span>
00370     <span class="comment">//</span>
00371 
00372     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d4/ke_2debug_8c.html#a1">FrozenState</a>(CurrentPrcb-&gt;IpiFrozen) != <a class="code" href="../../d9/d4/ke_2debug_8c.html#a5">FREEZE_OWNER</a>) {
00373         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a408a226">ContinueError</a>;
00374     }
00375 
00376     <span class="keywordflow">while</span> (!(CurrentPrcb-&gt;IpiFrozen &amp; <a class="code" href="../../d9/d4/ke_2debug_8c.html#a6">FREEZE_ACTIVE</a>)) {
00377         KeYieldProcessor();
00378     }
00379 
00380 <span class="preprocessor">#endif  // !defined(NT_UP)</span>
00381 <span class="preprocessor"></span>
00382     <span class="comment">//</span>
00383     <span class="comment">// Reselect this processor</span>
00384     <span class="comment">//</span>
00385 
00386     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/ke_8h.html#a408a228">ContinueProcessorReselected</a>;
00387 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a395" doxytag="ke.h::KeSwitchKernelStack" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID KeSwitchKernelStack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>StackBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>StackLimit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03964">PsConvertToGuiThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a273" doxytag="ke.h::KeSynchronizeExecution" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN KeSynchronizeExecution           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d7/struct__KINTERRUPT.html">PKINTERRUPT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Interrupt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a44">PKSYNCHRONIZE_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SynchronizeRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SynchronizeContext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d5/verifier_8c-source.html#l02993">VerifierSynchronizeExecution()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a338" doxytag="ke.h::KeTerminateThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeTerminateThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN KPRIORITY&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Increment</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">1996</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00036">BALANCE_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00086">ExWorkerQueue</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00413">_KEVENT::Header</a>, <a class="el" href="../../d5/d8/ex_8h.html#a332a207">HyperCriticalWorkQueue</a>, <a class="el" href="../../d7/d3/rtl_2random_8c-source.html#l00032">Increment</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00649">KiActivateWaiterQueue()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00710">KiInsertQueue()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00435">KiProcessOutSwapListHead</a>, <a class="el" href="../../d0/d9/mips_8h-source.html#l01576">KiRundownThread</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00421">KiSwapEvent</a>, <a class="el" href="../../d0/d0/ki_8h.html#a138">KiSwapThread()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01955">_WORK_QUEUE_ITEM::List</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00589">PsReaperActive</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00590">PsReaperListHead</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00591">PsReaperWorkItem</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00767">_KPROCESS::StackCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00771">_KPROCESS::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00763">_KPROCESS::SwapListEntry</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a195">Terminated</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00453">_ETHREAD::ThreadListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00764">_KPROCESS::ThreadListHead</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.
<p>
<pre class="fragment"><div>02002                    :
02003 
02004     This function terminates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread, sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02005     signal state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread to Signaled, and attempts to satisfy as many
02006     Waits as possible. The scheduling state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to terminated,
02007     and a <span class="keyword">new</span> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> selected to run on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current processor. There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no
02008     <span class="keywordflow">return</span> from <span class="keyword">this</span> function.
02009 
02010 Arguments:
02011 
02012     None.
02013 
02014 Return Value:
02015 
02016     None.
02017 
02018 --*/
02019 
02020 {
02021 
02022     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> NextThread;
02023     KIRQL OldIrql;
02024     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
02025     <a class="code" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue;
02026     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
02027 
02028     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
02029 
02030     <span class="comment">//</span>
02031     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
02032     <span class="comment">//</span>
02033 
02034     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
02035     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
02036 
02037     <span class="comment">//</span>
02038     <span class="comment">// Insert the thread in the reaper list.</span>
02039     <span class="comment">//</span>
02040     <span class="comment">// If a reaper thread is not currently active, then insert a work item in</span>
02041     <span class="comment">// the hyper critical work queue.</span>
02042     <span class="comment">//</span>
02043     <span class="comment">// N.B. This code has knowledge of the reaper data structures and how</span>
02044     <span class="comment">//      worker threads are implemented.</span>
02045     <span class="comment">//</span>
02046     <span class="comment">// N.B. The dispatcher database lock is used to synchronize access to the</span>
02047     <span class="comment">//      reaper list.</span>
02048     <span class="comment">//</span>
02049 
02050     InsertTailList(&amp;PsReaperListHead, &amp;((<a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a>)Thread)-&gt;TerminationPortList);
02051     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/ps_8h.html#a63">PsReaperActive</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02052         <a class="code" href="../../d1/d9/ps_8h.html#a63">PsReaperActive</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02053         <a class="code" href="../../d8/d3/queueobj_8c.html#a8">KiInsertQueue</a>(&amp;ExWorkerQueue[HyperCriticalWorkQueue].WorkerQueue,
02054                       &amp;<a class="code" href="../../d1/d9/ps_8h.html#a65">PsReaperWorkItem</a>.<a class="code" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html#o0">List</a>,
02055                       FALSE);
02056     }
02057 
02058     <span class="comment">//</span>
02059     <span class="comment">// If the current thread is processing a queue entry, then remove</span>
02060     <span class="comment">// the thrread from the queue object thread list and attempt to</span>
02061     <span class="comment">// activate another thread that is blocked on the queue object.</span>
02062     <span class="comment">//</span>
02063 
02064     Queue = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a>;
02065     <span class="keywordflow">if</span> (Queue != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02066         RemoveEntryList(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o40">QueueListEntry</a>);
02067         <a class="code" href="../../d8/d3/queueobj_8c.html#a7">KiActivateWaiterQueue</a>(Queue);
02068     }
02069 
02070     <span class="comment">//</span>
02071     <span class="comment">// Set the state of the current thread object to Signaled, and attempt</span>
02072     <span class="comment">// to satisfy as many Waits as possible.</span>
02073     <span class="comment">//</span>
02074 
02075     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02076     <span class="keywordflow">if</span> (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>) != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
02077         <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>((PVOID)Thread, Increment);
02078     }
02079 
02080     <span class="comment">//</span>
02081     <span class="comment">// Remove thread from its parent process' thread list.</span>
02082     <span class="comment">//</span>
02083 
02084     RemoveEntryList(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o64">ThreadListEntry</a>);
02085 
02086     <span class="comment">//</span>
02087     <span class="comment">// Set thread scheduling state to terminated, decrement the process'</span>
02088     <span class="comment">// stack count, select a new thread to run on the current processor,</span>
02089     <span class="comment">// and swap context to the new thread.</span>
02090     <span class="comment">//</span>
02091 
02092     Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a195">Terminated</a>;
02093     Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
02094     Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> -= 1;
02095     <span class="keywordflow">if</span> (Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> == 0) {
02096         <span class="keywordflow">if</span> (Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>.Flink != &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>) {
02097             Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o15">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>;
02098             InsertTailList(&amp;KiProcessOutSwapListHead, &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o7">SwapListEntry</a>);
02099             <a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> = 1;
02100             <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02101                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;KiSwapEvent, BALANCE_INCREMENT);
02102             }
02103         }
02104     }
02105 
02106     <span class="comment">//</span>
02107     <span class="comment">// Rundown any architectural specific structures</span>
02108     <span class="comment">//</span>
02109 
02110     <a class="code" href="../../d9/d9/mips_8h.html#a2">KiRundownThread</a>(Thread);
02111 
02112     <span class="comment">//</span>
02113     <span class="comment">// Get off the processor for the last time.</span>
02114     <span class="comment">//</span>
02115 
02116     <a class="code" href="../../d0/d0/ki_8h.html#a138">KiSwapThread</a>();
02117     <span class="keywordflow">return</span>;
02118 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a339" doxytag="ke.h::KeTestAlertThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeTestAlertThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>KPROCESSOR_MODE</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l02121">2121</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00570">_KTHREAD::Alerted</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00243">_KAPC_STATE::ApcListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00613">_KTHREAD::ApcQueueLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00247">_KAPC_STATE::UserApcPending</a>, and <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>.
<p>
Referenced by <a class="el" href="../../d7/d6/apcsup_8c-source.html#l00030">KiDeliverApc()</a>, and <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00345">NtTestAlert()</a>.
<p>
<pre class="fragment"><div>02127                    :
02128 
02129     This function tests to determine <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> alerted variable <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02130     specified processor mode has a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> or whether a user mode
02131     APC should be delivered to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread.
02132 
02133 Arguments:
02134 
02135     AlertMode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be tested
02136         <span class="keywordflow">for</span> an alerted condition.
02137 
02138 Return Value:
02139 
02140     The previous state of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> alerted variable <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified processor
02141     mode.
02142 
02143 --*/
02144 
02145 {
02146 
02147     BOOLEAN Alerted;
02148     KIRQL OldIrql;
02149     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
02150 
02151     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
02152 
02153     <span class="comment">//</span>
02154     <span class="comment">// Raise IRQL to dispatcher level, lock dispatcher database, and lock</span>
02155     <span class="comment">// APC queue.</span>
02156     <span class="comment">//</span>
02157 
02158     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
02159     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
02160     KiAcquireSpinLock(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o38">ApcQueueLock</a>);
02161 
02162     <span class="comment">//</span>
02163     <span class="comment">// If the current thread is alerted for the specified processor mode,</span>
02164     <span class="comment">// then clear the alerted state. Else if the specified processor mode</span>
02165     <span class="comment">// is user and the current thread's user mode APC queue contains an entry,</span>
02166     <span class="comment">// then set user APC pending.</span>
02167     <span class="comment">//</span>
02168 
02169     Alerted = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o9">Alerted</a>[AlertMode];
02170     <span class="keywordflow">if</span> (Alerted == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
02171         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o9">Alerted</a>[AlertMode] = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02172 
02173     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((AlertMode == <a class="code" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>) &amp;&amp;
02174               (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[UserMode]) != <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>)) {
02175         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o4">UserApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02176     }
02177 
02178     <span class="comment">//</span>
02179     <span class="comment">// Unlock APC queue, unlock dispatcher database, lower IRQL to its</span>
02180     <span class="comment">// previous value, and return the previous alerted state for the</span>
02181     <span class="comment">// specified mode.</span>
02182     <span class="comment">//</span>
02183 
02184     KiReleaseSpinLock(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o38">ApcQueueLock</a>);
02185     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
02186     <span class="keywordflow">return</span> Alerted;
02187 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a340" doxytag="ke.h::KeThawAllThreads" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeThawAllThreads           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d1/thredobj_8c-source.html#l02190">2190</a> of file <a class="el" href="../../d0/d1/thredobj_8c-source.html">thredobj.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00679">_KTHREAD::FreezeCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00512">_KSEMAPHORE::Header</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00037">RESUME_INCREMENT</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00680">_KTHREAD::SuspendCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00669">_KTHREAD::SuspendSemaphore</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00764">_KPROCESS::ThreadListHead</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00086">DbgkpResumeProcess()</a>.
<p>
<pre class="fragment"><div>02196                    :
02197 
02198     This function resumes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of all suspended froozen threads
02199     in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process.
02200 
02201 Arguments:
02202 
02203     None.
02204 
02205 Return Value:
02206 
02207     None.
02208 
02209 --*/
02210 
02211 {
02212 
02213     PLIST_ENTRY ListHead;
02214     PLIST_ENTRY NextEntry;
02215     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
02216     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
02217     ULONG OldCount;
02218     KIRQL OldIrql;
02219 
02220     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
02221 
02222     <span class="comment">//</span>
02223     <span class="comment">// Get the address of the current current process object, raise IRQL</span>
02224     <span class="comment">// to dispatch level, lock dispatcher database, and thaw the execution</span>
02225     <span class="comment">// of all threads in the current process that have been frozzen.</span>
02226     <span class="comment">//</span>
02227 
02228     Process = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process;
02229     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
02230     ListHead = &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>;
02231     NextEntry = ListHead-&gt;Flink;
02232     <span class="keywordflow">do</span> {
02233 
02234         <span class="comment">//</span>
02235         <span class="comment">// Get the address of the next thread and thaw its execution if</span>
02236         <span class="comment">// if was previously froozen.</span>
02237         <span class="comment">//</span>
02238 
02239         Thread = CONTAINING_RECORD(NextEntry, <a class="code" href="../../d1/d8/struct__KTHREAD.html">KTHREAD</a>, ThreadListEntry);
02240         OldCount = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a>;
02241         <span class="keywordflow">if</span> (OldCount != 0) {
02242             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a> -= 1;
02243 
02244             <span class="comment">//</span>
02245             <span class="comment">// If the resultant suspend count is zero and the freeze count is</span>
02246             <span class="comment">// zero, then resume the thread by releasing its suspend semaphore.</span>
02247             <span class="comment">//</span>
02248 
02249             <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o66">SuspendCount</a> == 0) &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o65">FreezeCount</a> == 0)) {
02250                 Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o63">SuspendSemaphore</a>.<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> += 1;
02251                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o63">SuspendSemaphore</a>, RESUME_INCREMENT);
02252             }
02253         }
02254 
02255         NextEntry = NextEntry-&gt;Flink;
02256     } <span class="keywordflow">while</span> (NextEntry != ListHead);
02257 
02258     <span class="comment">//</span>
02259     <span class="comment">// Unlock dispatcher database and lower IRQL to its previous</span>
02260     <span class="comment">// value.</span>
02261     <span class="comment">//</span>
02262 
02263     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
02264     <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
02265     <span class="keywordflow">return</span>;
02266 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a389" doxytag="ke.h::KeThawExecution" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeThawExecution           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Enable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00391">391</a> of file <a class="el" href="../../d0/d4/ke_2debug_8c-source.html">ke/debug.c</a>.
<p>
References <a class="el" href="../../d1/d9/ki_8h-source.html#l00058">ClearMember</a>, <a class="el" href="../../d8/d2/kd_8h-source.html#l00040">FREEZE_BACKUP</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00030">FrozenState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02293">KeFindFirstSetRightMember</a>, <a class="el" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00062">KiFreezeExecutionLock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00389">KiFreezeFlag</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00063">KiFreezeLockBackup</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00046">KiOldIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d0/d0/ki_8h.html#a107">KiRestoreInterrupts()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00033">RUNNING</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00034">TARGET_FROZEN</a>, and <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00035">TARGET_THAW</a>.
<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00381">KdExitDebugger()</a>.
<p>
<pre class="fragment"><div>00397                    :
00398 
00399     This function thaws <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of all other processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host
00400     configuration and then returns to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller. It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> intended <span class="keywordflow">for</span> use by
00401     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel debugger.
00402 
00403 Arguments:
00404 
00405     Enable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> previous interrupt enable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be restored
00406         after having thawed <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> execution of all other processors.
00407 
00408 Return Value:
00409 
00410     None.
00411 
00412 --*/
00413 
00414 {
00415 <span class="preprocessor">#if !defined(NT_UP)</span>
00416 <span class="preprocessor"></span>
00417     KIRQL OldIrql;
00418     ULONG TargetSet;
00419     ULONG BitNumber;
00420     ULONG Flag;
00421     PKPRCB Prcb;
00422 
00423     <span class="comment">//</span>
00424     <span class="comment">// Before releasing FreezeExecutionLock clear any all targets IpiFrozen</span>
00425     <span class="comment">// flag.</span>
00426     <span class="comment">//</span>
00427 
00428     <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;IpiFrozen = <a class="code" href="../../d9/d4/ke_2debug_8c.html#a2">RUNNING</a>;
00429 
00430     TargetSet = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a> &amp; ~(1 &lt;&lt; <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>()-&gt;Number);
00431     <span class="keywordflow">while</span> (TargetSet != 0) {
00432         BitNumber = <a class="code" href="../../d4/d9/ke_8h.html#a39">KeFindFirstSetRightMember</a>(TargetSet);
00433         <a class="code" href="../../d0/d0/ki_8h.html#a6">ClearMember</a>(BitNumber, TargetSet);
00434         Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[BitNumber];
00435 <span class="preprocessor">#if IDBG</span>
00436 <span class="preprocessor"></span>        <span class="comment">//</span>
00437         <span class="comment">// If the target processor was not forzen, then don't wait</span>
00438         <span class="comment">// for target to unfreeze.</span>
00439         <span class="comment">//</span>
00440 
00441         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d4/ke_2debug_8c.html#a1">FrozenState</a>(Prcb-&gt;IpiFrozen) != <a class="code" href="../../d9/d4/ke_2debug_8c.html#a3">TARGET_FROZEN</a>) {
00442             Prcb-&gt;IpiFrozen = <a class="code" href="../../d9/d4/ke_2debug_8c.html#a2">RUNNING</a>;
00443             <span class="keywordflow">continue</span>;
00444         }
00445 <span class="preprocessor">#endif</span>
00446 <span class="preprocessor"></span>
00447         Prcb-&gt;IpiFrozen = <a class="code" href="../../d9/d4/ke_2debug_8c.html#a4">TARGET_THAW</a>;
00448         <span class="keywordflow">while</span> (Prcb-&gt;IpiFrozen == <a class="code" href="../../d9/d4/ke_2debug_8c.html#a4">TARGET_THAW</a>) {
00449             KeYieldProcessor();
00450         }
00451     }
00452 
00453     <span class="comment">//</span>
00454     <span class="comment">// Capture the previous IRQL before releasing the freeze lock.</span>
00455     <span class="comment">//</span>
00456 
00457     OldIrql = <a class="code" href="../../d9/d4/ke_2debug_8c.html#a7">KiOldIrql</a>;
00458 
00459 <span class="preprocessor">#if IDBG</span>
00460 <span class="preprocessor"></span>
00461     Flag = <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a>;
00462     <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a> = 0;
00463 
00464     <span class="keywordflow">if</span> ((Flag &amp; <a class="code" href="../../d7/d3/kd_8h.html#a3">FREEZE_BACKUP</a>) != 0) {
00465         KiReleaseSpinLock(&amp;KiFreezeLockBackup);
00466     } <span class="keywordflow">else</span> {
00467         KiReleaseSpinLock(&amp;KiFreezeExecutionLock);
00468     }
00469 
00470 <span class="preprocessor">#else</span>
00471 <span class="preprocessor"></span>
00472     <a class="code" href="../../d5/d9/kernldat_8c.html#a43">KiFreezeFlag</a> = 0;
00473     KiReleaseSpinLock(&amp;KiFreezeExecutionLock);
00474 
00475 <span class="preprocessor">#endif</span>
00476 <span class="preprocessor"></span><span class="preprocessor">#endif  // !defined (NT_UP)</span>
00477 <span class="preprocessor"></span>
00478 
00479     <span class="comment">//</span>
00480     <span class="comment">// Flush the current TB, instruction cache, and data cache.</span>
00481     <span class="comment">//</span>
00482 
00483     <a class="code" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb</a>();
00484     KeSweepCurrentIcache();
00485     KeSweepCurrentDcache();
00486 
00487     <span class="comment">//</span>
00488     <span class="comment">// Lower IRQL and restore interrupt enable</span>
00489     <span class="comment">//</span>
00490 
00491 <span class="preprocessor">#if !defined(NT_UP)</span>
00492 <span class="preprocessor"></span>    <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00493 <span class="preprocessor">#endif</span>
00494 <span class="preprocessor"></span>    <a class="code" href="../../d0/d0/ki_8h.html#a107">KiRestoreInterrupts</a>(Enable);
00495     <span class="keywordflow">return</span>;
00496 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a360" doxytag="ke.h::KeTryToAcquireSpinLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN KeTryToAcquireSpinLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>SpinLock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PKIRQL&nbsp;</td>
          <td class="mdname" nowrap> <em>OldIrql</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02986">MmTrimAllSystemPagableMemory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a304" doxytag="ke.h::KeUnstackDetachProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID KeUnstackDetachProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d3/d5/struct__KAPC__STATE.html">PRKAPC_STATE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ApcState</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d4/procobj_8c-source.html#l00512">512</a> of file <a class="el" href="../../d4/d4/procobj_8c-source.html">procobj.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00243">_KAPC_STATE::ApcListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00658">_KTHREAD::ApcStateIndex</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00638">_KTHREAD::ApcStatePointer</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00036">BALANCE_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00413">_KEVENT::Header</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00245">_KAPC_STATE::KernelApcInProgress</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l01092">KiMoveApcState()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00435">KiProcessOutSwapListHead</a>, <a class="el" href="../../d0/d4/intsupc_8c-source.html#l00159">KiRequestSoftwareInterrupt()</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00421">KiSwapEvent</a>, <a class="el" href="../../d0/d0/ki_8h.html#a137">KiSwapProcess()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00277">KiWaitTest()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00656">_KTHREAD::SavedApcState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00767">_KPROCESS::StackCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00771">_KPROCESS::State</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00763">_KPROCESS::SwapListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00764">_KPROCESS::ThreadListHead</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d9/ntosdef_8h.html#a76a70">UserMode</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02160">ObpCreateHandle()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02507">ObpCreateUnnamedHandle()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>.
<p>
<pre class="fragment"><div>00518                    :
00519 
00520     This function detaches a thread from another process' address space
00521     and restores previous attach state.
00522 
00523 Arguments:
00524 
00525     ApcState - Supplies a pointer to an APC state structure that was returned
00526         from a previous call to stack attach process.
00527 
00528 Return Value:
00529 
00530     None.
00531 
00532 --*/
00533 
00534 {
00535 
00536     KIRQL OldIrql;
00537     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00538     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00539 
00540     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00541 
00542     <span class="comment">//</span>
00543     <span class="comment">// Raise IRQL to dispatcher level and lock dispatcher database.</span>
00544     <span class="comment">//</span>
00545 
00546     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00547     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
00548 
00549     <span class="comment">//</span>
00550     <span class="comment">// If the APC state has a distinguished process pointer value, then no</span>
00551     <span class="comment">// attach was performed on the paired call to stack attach process.</span>
00552     <span class="comment">//</span>
00553 
00554     <span class="keywordflow">if</span> (ApcState-&gt;Process != (<a class="code" href="../../d5/d7/struct__KPROCESS.html">PRKPROCESS</a>)1) {
00555 
00556         <span class="comment">//</span>
00557         <span class="comment">// If the current thread is not attached to another process, a kernel</span>
00558         <span class="comment">// APC is in progress, or either the kernel or user mode APC queues</span>
00559         <span class="comment">// are not empty, then call bug check.</span>
00560         <span class="comment">//</span>
00561 
00562         <span class="keywordflow">if</span> ((Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> == 0) ||
00563              (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o2">KernelApcInProgress</a>) ||
00564              (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[KernelMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) ||
00565              (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[UserMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00566             <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(INVALID_PROCESS_DETACH_ATTEMPT);
00567         }
00568 
00569         <span class="comment">//</span>
00570         <span class="comment">// Unbias current process stack count and check if the process should</span>
00571         <span class="comment">// be swapped out of memory.</span>
00572         <span class="comment">//</span>
00573 
00574         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00575         Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> -= 1;
00576         <span class="keywordflow">if</span> ((Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o11">StackCount</a> == 0) &amp;&amp;
00577             (IsListEmpty(&amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o8">ThreadListHead</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00578             Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o15">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a405a188">ProcessInTransition</a>;
00579             InsertTailList(&amp;KiProcessOutSwapListHead, &amp;Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o7">SwapListEntry</a>);
00580             <a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> = 1;
00581             <span class="keywordflow">if</span> (IsListEmpty(&amp;<a class="code" href="../../d5/d9/kernldat_8c.html#a47">KiSwapEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00582                 <a class="code" href="../../d2/d7/waitsup_8c.html#a3">KiWaitTest</a>(&amp;KiSwapEvent, BALANCE_INCREMENT);
00583             }
00584         }
00585 
00586         <span class="comment">//</span>
00587         <span class="comment">// Restore APC state and check whether the kernel APC queue contains</span>
00588         <span class="comment">// an entry. If the kernel APC queue contains an entry then set kernel</span>
00589         <span class="comment">// APC pending and request a software interrupt at APC_LEVEL.</span>
00590         <span class="comment">//</span>
00591 
00592         <span class="keywordflow">if</span> (ApcState-&gt;Process != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00593             <a class="code" href="../../d3/d5/procobj_8c.html#a2">KiMoveApcState</a>(ApcState, &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>);
00594 
00595         } <span class="keywordflow">else</span> {
00596             <a class="code" href="../../d3/d5/procobj_8c.html#a2">KiMoveApcState</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>, &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>);
00597             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a> = (<a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00598             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o49">ApcStatePointer</a>[0] = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>;
00599             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o49">ApcStatePointer</a>[1] = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o56">SavedApcState</a>;
00600             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o58">ApcStateIndex</a> = 0;
00601         }
00602 
00603         <span class="keywordflow">if</span> (IsListEmpty(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o0">ApcListHead</a>[KernelMode]) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00604             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00605             <a class="code" href="../../d9/d4/intsupc_8c.html#a3">KiRequestSoftwareInterrupt</a>(APC_LEVEL);
00606         }
00607 
00608         <span class="comment">//</span>
00609         <span class="comment">// Swap the address space back to the parent process.</span>
00610         <span class="comment">//</span>
00611 
00612         <a class="code" href="../../d0/d0/ki_8h.html#a137">KiSwapProcess</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>, Process);
00613     }
00614 
00615     <span class="comment">//</span>
00616     <span class="comment">// Lower IRQL to its previous value and return.</span>
00617     <span class="comment">//</span>
00618 
00619     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
00620     <span class="keywordflow">return</span>;
00621 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a394" doxytag="ke.h::KeUserModeCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS KeUserModeCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ApiNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>InputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>InputLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a351" doxytag="ke.h::KeWaitForMultipleObjects" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS KeWaitForMultipleObjects           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Object</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN WAIT_TYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitReason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Alertable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER Timeout&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> WaitBlockArray&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">395</a> of file <a class="el" href="../../d2/d6/wait_8c-source.html">wait.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00657">_KTHREAD::Alertable</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00051">Count</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00523">_KTIMER::DueTime</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00485">_KMUTANT::Header</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00649">KiActivateWaiterQueue()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00079">KiAdjustQuantumThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01175">KiComputeWaitInterval()</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00042">KiInsertTreeTimer()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00225">KiInsertWaitList</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a138">KiSwapThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d3/d6/waitsup_8c-source.html#l00228">KiWaitSatisfyAll()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00960">KiWaitSatisfyMutant</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00997">KiWaitSatisfyOther</a>, <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00283">_KWAIT_BLOCK::NextWaitBlock</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00282">_KWAIT_BLOCK::Object</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00487">_KMUTANT::OwnerThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00612">_KTHREAD::Queue</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00057">TestForAlertPending</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00281">_KWAIT_BLOCK::Thread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00079">THREAD_WAIT_OBJECTS</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00614">_KTHREAD::Timer</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00084">TIMER_WAIT_BLOCK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00258">_DISPATCHER_HEADER::Type</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00594">_KTHREAD::WaitBlock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00587">_KTHREAD::WaitBlockList</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00280">_KWAIT_BLOCK::WaitListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00584">_KTHREAD::WaitMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00586">_KTHREAD::WaitReason</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00582">_KTHREAD::WaitStatus</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00589">_KTHREAD::WaitTime</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00516">CmpFileWrite()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00431">ExpWorkerThreadBalanceManager()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02146">InitiateWin32kCleanup()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00598">MemPrintWriteThread()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02831">MiModifiedPageWriterWorker()</a>, <a class="el" href="../../d8/d0/zeropage_8c-source.html#l00029">MmZeroPageThread()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l04271">xxxMsgWaitForMultipleObjects()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05481">xxxPollAndWaitForSingleObject()</a>, and <a class="el" href="../../d7/d8/taskman_8c-source.html#l00252">xxxSleepTask()</a>.
<p>
<pre class="fragment"><div>00408                    :
00409 
00410     This function waits until <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified objects attain a state of
00411     Signaled. The wait can be specified to wait until all of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> objects
00412     attain a state of Signaled or until one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> objects attains a state
00413     of Signaled. An optional timeout can also be specified. If a timeout
00414     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not specified, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait will not be satisfied until <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> objects
00415     attain a state of Signaled. If a timeout <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> objects
00416     have not attained a state of Signaled when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> timeout expires, then
00417     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> automatically satisfied. If an <span class="keyword">explicit</span> timeout value of
00418     zero <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified, then no wait will occur <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait cannot be satisfied
00419     immediately. The wait can also be specified as alertable.
00420 
00421 Arguments:
00422 
00423     <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> - Supplies a count of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of objects that are to be waited
00424         on.
00425 
00426     Object[] - Supplies an array of pointers to dispatcher objects.
00427 
00428     WaitType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of wait to perform (WaitAll, WaitAny).
00429 
00430     WaitReason - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait.
00431 
00432     WaitMode  - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode in which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00433 
00434     Alertable - Supplies a <span class="keywordtype">boolean</span> value that specifies whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00435         alertable.
00436 
00437     Timeout - Supplies a pointer to an optional absolute of relative time over
00438         which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
00439 
00440     WaitBlockArray - Supplies an optional pointer to an array of wait blocks
00441         that are to used to describe <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait operation.
00442 
00443 Return Value:
00444 
00445     The wait completion status. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_TIMEOUT <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> a
00446     timeout occurred. The index of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> object (zero based) in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> object
00447     pointer array <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> an object satisfied <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of
00448     STATUS_ALERTED <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait was aborted to deliver an alert
00449     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_USER_APC <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00450     wait was aborted to deliver a user APC to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread.
00451 
00452 --*/
00453 
00454 {
00455 
00456     LARGE_INTEGER DueTime;
00457     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00458     LARGE_INTEGER NewTime;
00459     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> NextThread;
00460     <a class="code" href="../../d3/d7/struct__KMUTANT.html">PKMUTANT</a> Objectx;
00461     PLARGE_INTEGER OriginalTime;
00462     <a class="code" href="../../d7/d7/struct__KQUEUE.html">PRKQUEUE</a> Queue;
00463     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread;
00464     <a class="code" href="../../d3/d8/struct__KTIMER.html">PRKTIMER</a> Timer;
00465     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PRKWAIT_BLOCK</a> WaitBlock;
00466     BOOLEAN WaitSatisfied;
00467     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> WaitStatus;
00468     <a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> WaitTimer;
00469 
00470     <span class="comment">//</span>
00471     <span class="comment">// If the dispatcher database lock is not already held, then set the wait</span>
00472     <span class="comment">// IRQL and lock the dispatcher database. Else set boolean wait variable</span>
00473     <span class="comment">// to FALSE.</span>
00474     <span class="comment">//</span>
00475 
00476     Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00477     <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a>) {
00478         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o19">WaitNext</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00479 
00480     } <span class="keywordflow">else</span> {
00481         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00482     }
00483 
00484     <span class="comment">//</span>
00485     <span class="comment">// If a wait block array has been specified, then the maximum number of</span>
00486     <span class="comment">// objects that can be waited on is specified by MAXIMUM_WAIT_OBJECTS.</span>
00487     <span class="comment">// Otherwise the builtin wait blocks in the thread object are used and</span>
00488     <span class="comment">// the maximum number of objects that can be waited on is specified by</span>
00489     <span class="comment">// THREAD_WAIT_OBJECTS. If the specified number of objects is not within</span>
00490     <span class="comment">// limits, then bug check.</span>
00491     <span class="comment">//</span>
00492 
00493     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(WaitBlockArray)) {
00494         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> &gt; MAXIMUM_WAIT_OBJECTS) {
00495             <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(MAXIMUM_WAIT_OBJECTS_EXCEEDED);
00496         }
00497 
00498     } <span class="keywordflow">else</span> {
00499         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a> &gt; <a class="code" href="../../d4/d9/ke_8h.html#a6">THREAD_WAIT_OBJECTS</a>) {
00500             <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(MAXIMUM_WAIT_OBJECTS_EXCEEDED);
00501         }
00502 
00503         WaitBlockArray = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[0];
00504     }
00505 
00506     <span class="comment">//</span>
00507     <span class="comment">// Start of wait loop.</span>
00508     <span class="comment">//</span>
00509     <span class="comment">// Note this loop is repeated if a kernel APC is delivered in the middle</span>
00510     <span class="comment">// of the wait or a kernel APC is pending on the first attempt through</span>
00511     <span class="comment">// the loop.</span>
00512     <span class="comment">//</span>
00513 
00514     OriginalTime = Timeout;
00515     <span class="keywordflow">do</span> {
00516 
00517         <span class="comment">//</span>
00518         <span class="comment">// Set address of wait block list in thread object.</span>
00519         <span class="comment">//</span>
00520 
00521         Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o21">WaitBlockList</a> = WaitBlockArray;
00522 
00523         <span class="comment">//</span>
00524         <span class="comment">// Test to determine if a kernel APC is pending.</span>
00525         <span class="comment">//</span>
00526         <span class="comment">// If a kernel APC is pending and the previous IRQL was less than</span>
00527         <span class="comment">// APC_LEVEL, then a kernel APC was queued by another processor just</span>
00528         <span class="comment">// after IRQL was raised to DISPATCH_LEVEL, but before the dispatcher</span>
00529         <span class="comment">// database was locked.</span>
00530         <span class="comment">//</span>
00531         <span class="comment">// N.B. that this can only happen in a multiprocessor system.</span>
00532         <span class="comment">//</span>
00533 
00534         <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o3">KernelApcPending</a> &amp;&amp; (Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>)) {
00535 
00536             <span class="comment">//</span>
00537             <span class="comment">// Unlock the dispatcher database and lower IRQL to its previous</span>
00538             <span class="comment">// value. An APC interrupt will immediately occur which will result</span>
00539             <span class="comment">// in the delivery of the kernel APC if possible.</span>
00540             <span class="comment">//</span>
00541 
00542             <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00543 
00544         } <span class="keywordflow">else</span> {
00545 
00546             <span class="comment">//</span>
00547             <span class="comment">// Construct wait blocks and check to determine if the wait is</span>
00548             <span class="comment">// already satisfied. If the wait is satisfied, then perform</span>
00549             <span class="comment">// wait completion and return. Else put current thread in a wait</span>
00550             <span class="comment">// state if an explicit timeout value of zero is not specified.</span>
00551             <span class="comment">//</span>
00552 
00553             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o16">WaitStatus</a> = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)0;
00554             WaitSatisfied = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00555             <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; <a class="code" href="../../d4/d0/cmconfig_8c.html#a6">Count</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00556 
00557                 <span class="comment">//</span>
00558                 <span class="comment">// Test if wait can be satisfied immediately.</span>
00559                 <span class="comment">//</span>
00560 
00561                 Objectx = (<a class="code" href="../../d3/d7/struct__KMUTANT.html">PKMUTANT</a>)Object[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00562 
00563                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> != QueueObject);
00564 
00565                 <span class="keywordflow">if</span> (WaitType == WaitAny) {
00566 
00567                     <span class="comment">//</span>
00568                     <span class="comment">// If the object is a mutant object and the mutant object</span>
00569                     <span class="comment">// has been recursively acquired MINLONG times, then raise</span>
00570                     <span class="comment">// an exception. Otherwise if the signal state of the mutant</span>
00571                     <span class="comment">// object is greater than zero, or the current thread is</span>
00572                     <span class="comment">// the owner of the mutant object, then satisfy the wait.</span>
00573                     <span class="comment">//</span>
00574 
00575                     <span class="keywordflow">if</span> (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> == <a class="code" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>) {
00576                         <span class="keywordflow">if</span> ((Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> &gt; 0) ||
00577                             (Thread == Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o2">OwnerThread</a>)) {
00578                             <span class="keywordflow">if</span> (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> != MINLONG) {
00579                                 <a class="code" href="../../d0/d0/ki_8h.html#a26">KiWaitSatisfyMutant</a>(Objectx, Thread);
00580                                 WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)(<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> | Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o16">WaitStatus</a>);
00581                                 <span class="keywordflow">goto</span> NoWait;
00582 
00583                             } <span class="keywordflow">else</span> {
00584                                 <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00585                                 <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_MUTANT_LIMIT_EXCEEDED);
00586                             }
00587                         }
00588 
00589                     <span class="comment">//</span>
00590                     <span class="comment">// If the signal state is greater than zero, then satisfy</span>
00591                     <span class="comment">// the wait.</span>
00592                     <span class="comment">//</span>
00593 
00594                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> &gt; 0) {
00595                         <a class="code" href="../../d0/d0/ki_8h.html#a27">KiWaitSatisfyOther</a>(Objectx);
00596                         WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)(<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>);
00597                         <span class="keywordflow">goto</span> NoWait;
00598                     }
00599 
00600                 } <span class="keywordflow">else</span> {
00601 
00602                     <span class="comment">//</span>
00603                     <span class="comment">// If the object is a mutant object and the mutant object</span>
00604                     <span class="comment">// has been recursively acquired MAXLONG times, then raise</span>
00605                     <span class="comment">// an exception. Otherwise if the signal state of the mutant</span>
00606                     <span class="comment">// object is less than or equal to zero and the current</span>
00607                     <span class="comment">// thread is not the  owner of the mutant object, then the</span>
00608                     <span class="comment">// wait cannot be satisfied.</span>
00609                     <span class="comment">//</span>
00610 
00611                     <span class="keywordflow">if</span> (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o0">Type</a> == <a class="code" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>) {
00612                         <span class="keywordflow">if</span> ((Thread == Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o2">OwnerThread</a>) &amp;&amp;
00613                             (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> == MINLONG)) {
00614                             <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00615                             <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_MUTANT_LIMIT_EXCEEDED);
00616 
00617                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> &lt;= 0) &amp;&amp;
00618                                   (Thread != Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o2">OwnerThread</a>)) {
00619                             WaitSatisfied = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00620                         }
00621 
00622                     <span class="comment">//</span>
00623                     <span class="comment">// If the signal state is less than or equal to zero, then</span>
00624                     <span class="comment">// the wait cannot be satisfied.</span>
00625                     <span class="comment">//</span>
00626 
00627                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o4">SignalState</a> &lt;= 0) {
00628                         WaitSatisfied = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00629                     }
00630                 }
00631 
00632                 <span class="comment">//</span>
00633                 <span class="comment">// Construct wait block for the current object.</span>
00634                 <span class="comment">//</span>
00635 
00636                 WaitBlock = &amp;WaitBlockArray[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00637                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o2">Object</a> = (PVOID)Objectx;
00638                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o4">WaitKey</a> = (CSHORT)(<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>);
00639                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o5">WaitType</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)WaitType;
00640                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o1">Thread</a> = Thread;
00641                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = &amp;WaitBlockArray[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> + 1];
00642             }
00643 
00644             <span class="comment">//</span>
00645             <span class="comment">// If the wait type is wait all, then check to determine if the</span>
00646             <span class="comment">// wait can be satisfied immediately.</span>
00647             <span class="comment">//</span>
00648 
00649             <span class="keywordflow">if</span> ((WaitType == WaitAll) &amp;&amp; (WaitSatisfied)) {
00650                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = &amp;WaitBlockArray[0];
00651                 <a class="code" href="../../d2/d7/waitsup_8c.html#a2">KiWaitSatisfyAll</a>(WaitBlock);
00652                 WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o16">WaitStatus</a>;
00653                 <span class="keywordflow">goto</span> NoWait;
00654             }
00655 
00656             <span class="comment">//</span>
00657             <span class="comment">// Test for alert pending.</span>
00658             <span class="comment">//</span>
00659 
00660             <a class="code" href="../../d1/d7/wait_8c.html#a0">TestForAlertPending</a>(Alertable);
00661 
00662             <span class="comment">//</span>
00663             <span class="comment">// The wait cannot be satisifed immediately. Check to determine if</span>
00664             <span class="comment">// a timeout value is specified.</span>
00665             <span class="comment">//</span>
00666 
00667             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Timeout)) {
00668 
00669                 <span class="comment">//</span>
00670                 <span class="comment">// If the timeout value is zero, then return immediately without</span>
00671                 <span class="comment">// waiting.</span>
00672                 <span class="comment">//</span>
00673 
00674                 <span class="keywordflow">if</span> (!(Timeout-&gt;LowPart | Timeout-&gt;HighPart)) {
00675                     WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)(STATUS_TIMEOUT);
00676                     <span class="keywordflow">goto</span> NoWait;
00677                 }
00678 
00679                 <span class="comment">//</span>
00680                 <span class="comment">// Initialize a wait block for the thread specific timer,</span>
00681                 <span class="comment">// initialize timer wait list head, insert the timer in the</span>
00682                 <span class="comment">// timer tree, and increment the number of wait objects.</span>
00683                 <span class="comment">//</span>
00684                 <span class="comment">// N.B. The timer wait block is initialized when the respective</span>
00685                 <span class="comment">//      thread is initialized. Thus the constant fields are not</span>
00686                 <span class="comment">//      reinitialized. These include the wait object, wait key,</span>
00687                 <span class="comment">//      wait type, and the wait list entry link pointers.</span>
00688                 <span class="comment">//</span>
00689 
00690                 WaitTimer = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o28">WaitBlock</a>[<a class="code" href="../../d4/d9/ke_8h.html#a9">TIMER_WAIT_BLOCK</a>];
00691                 WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = WaitTimer;
00692                 WaitBlock = WaitTimer;
00693                 Timer = &amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o39">Timer</a>;
00694                 InitializeListHead(&amp;Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>);
00695                 <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/timersup_8c.html#a1">KiInsertTreeTimer</a>(Timer, *Timeout) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00696                     WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)STATUS_TIMEOUT;
00697                     <span class="keywordflow">goto</span> NoWait;
00698                 }
00699 
00700                 DueTime.QuadPart = Timer-&gt;<a class="code" href="../../d3/d8/struct__KTIMER.html#o1">DueTime</a>.QuadPart;
00701             }
00702 
00703             <span class="comment">//</span>
00704             <span class="comment">// Close up the circular list of wait control blocks.</span>
00705             <span class="comment">//</span>
00706 
00707             WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a> = &amp;WaitBlockArray[0];
00708 
00709             <span class="comment">//</span>
00710             <span class="comment">// Insert wait blocks in object wait lists.</span>
00711             <span class="comment">//</span>
00712 
00713             WaitBlock = &amp;WaitBlockArray[0];
00714             <span class="keywordflow">do</span> {
00715                 Objectx = (<a class="code" href="../../d3/d7/struct__KMUTANT.html">PKMUTANT</a>)WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o2">Object</a>;
00716                 InsertTailList(&amp;Objectx-&gt;<a class="code" href="../../d3/d7/struct__KMUTANT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a>, &amp;WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o0">WaitListEntry</a>);
00717                 WaitBlock = WaitBlock-&gt;<a class="code" href="../../d4/d8/struct__KWAIT__BLOCK.html#o3">NextWaitBlock</a>;
00718             } <span class="keywordflow">while</span> (WaitBlock != &amp;WaitBlockArray[0]);
00719 
00720             <span class="comment">//</span>
00721             <span class="comment">// If the current thread is processing a queue entry, then attempt</span>
00722             <span class="comment">// to activate another thread that is blocked on the queue object.</span>
00723             <span class="comment">//</span>
00724 
00725             Queue = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o37">Queue</a>;
00726             <span class="keywordflow">if</span> (Queue != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00727                 <a class="code" href="../../d8/d3/queueobj_8c.html#a7">KiActivateWaiterQueue</a>(Queue);
00728             }
00729 
00730             <span class="comment">//</span>
00731             <span class="comment">// Set the thread wait parameters, set the thread dispatcher state</span>
00732             <span class="comment">// to Waiting, and insert the thread in the wait list.</span>
00733             <span class="comment">//</span>
00734 
00735             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o57">Alertable</a> = Alertable;
00736             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o18">WaitMode</a> = WaitMode;
00737             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o20">WaitReason</a> = (UCHAR)WaitReason;
00738             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o23">WaitTime</a>= KiQueryLowTickCount();
00739             Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>;
00740             <a class="code" href="../../d0/d0/ki_8h.html#a15">KiInsertWaitList</a>(WaitMode, Thread);
00741 
00742             <span class="comment">//</span>
00743             <span class="comment">// Switch context to selected thread.</span>
00744             <span class="comment">//</span>
00745             <span class="comment">// Control is returned at the original IRQL.</span>
00746             <span class="comment">//</span>
00747 
00748             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a> &lt;= DISPATCH_LEVEL);
00749 
00750             WaitStatus = (<a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>)<a class="code" href="../../d0/d0/ki_8h.html#a138">KiSwapThread</a>();
00751 
00752             <span class="comment">//</span>
00753             <span class="comment">// If the thread was not awakened to deliver a kernel mode APC,</span>
00754             <span class="comment">// then the wait status.</span>
00755             <span class="comment">//</span>
00756 
00757             <span class="keywordflow">if</span> (WaitStatus != STATUS_KERNEL_APC) {
00758                 <span class="keywordflow">return</span> WaitStatus;
00759             }
00760 
00761             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(Timeout)) {
00762 
00763                 <span class="comment">//</span>
00764                 <span class="comment">// Reduce the amount of time remaining before timeout occurs.</span>
00765                 <span class="comment">//</span>
00766 
00767                 Timeout = <a class="code" href="../../d1/d7/wait_8c.html#a6">KiComputeWaitInterval</a>(OriginalTime,
00768                                                 &amp;DueTime,
00769                                                 &amp;NewTime);
00770             }
00771         }
00772 
00773         <span class="comment">//</span>
00774         <span class="comment">// Raise IRQL to DISPATCH_LEVEL and lock the dispatcher database.</span>
00775         <span class="comment">//</span>
00776 
00777         <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00778     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00779 
00780     <span class="comment">//</span>
00781     <span class="comment">// The thread is alerted or a user APC should be delivered. Unlock the</span>
00782     <span class="comment">// dispatcher database, lower IRQL to its previous value, and return</span>
00783     <span class="comment">// the wait status.</span>
00784     <span class="comment">//</span>
00785 
00786     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00787     <span class="keywordflow">return</span> WaitStatus;
00788 
00789     <span class="comment">//</span>
00790     <span class="comment">// The wait has been satisfied without actually waiting.</span>
00791     <span class="comment">//</span>
00792     <span class="comment">// If the thread priority that is less than time critical, then reduce</span>
00793     <span class="comment">// the thread quantum. If a quantum end occurs, then reduce the thread</span>
00794     <span class="comment">// priority.</span>
00795     <span class="comment">//</span>
00796 
00797 NoWait:
00798     <a class="code" href="../../d1/d7/wait_8c.html#a1">KiAdjustQuantumThread</a>(Thread);
00799 
00800     <span class="comment">//</span>
00801     <span class="comment">// Unlock the dispatcher database, lower IRQL to its previous value, and</span>
00802     <span class="comment">// return the wait status.</span>
00803     <span class="comment">//</span>
00804 
00805     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o17">WaitIrql</a>);
00806     <span class="keywordflow">return</span> WaitStatus;
00807 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a352" doxytag="ke.h::KeWaitForSingleObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS KeWaitForSingleObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Object</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitReason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Alertable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLARGE_INTEGER Timeout&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00163">163</a> of file <a class="el" href="../../d7/d2/cmwraper_8c-source.html">cmwraper.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00657">_KTHREAD::Alertable</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00523">_KTIMER::DueTime</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00485">_KMUTANT::Header</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00522">_KTIMER::Header</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00246">_KAPC_STATE::KernelApcPending</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00649">KiActivateWaiterQueue()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00079">KiAdjustQuantumThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01175">KiComputeWaitInterval()</a>, <a class="el" href="../../d6/d1/timersup_8c-source.html#l00042">KiInsertTreeTimer()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00225">KiInsertWaitList</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a138">KiSwapThread()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00960">KiWaitSatisfyMutant</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00997">KiWaitSatisfyOther</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l01152">KiWaitSingleCallData</a>, <a class="el" href="../../d4/d9/ke_8h.html#a53">KWAIT_REASON</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a159">MutantObject</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00283">_KWAIT_BLOCK::NextWaitBlock</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00282">_KWAIT_BLOCK::Object</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00487">_KMUTANT::OwnerThread</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00612">_KTHREAD::Queue</a>, <a class="el" href="../../d4/d9/ke_8h.html#a402a161">QueueObject</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00054">RECORD_CALL_DATA</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00262">_DISPATCHER_HEADER::SignalState</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00057">TestForAlertPending</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00614">_KTHREAD::Timer</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00084">TIMER_WAIT_BLOCK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00258">_DISPATCHER_HEADER::Type</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00594">_KTHREAD::WaitBlock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00587">_KTHREAD::WaitBlockList</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a196">Waiting</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00583">_KTHREAD::WaitIrql</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00284">_KWAIT_BLOCK::WaitKey</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00280">_KWAIT_BLOCK::WaitListEntry</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00584">_KTHREAD::WaitMode</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00585">_KTHREAD::WaitNext</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00586">_KTHREAD::WaitReason</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00582">_KTHREAD::WaitStatus</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00589">_KTHREAD::WaitTime</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00285">_KWAIT_BLOCK::WaitType</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/copysup_8c-source.html#l01790">CcCanIWrite()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l02717">CcSetValidData()</a>, <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00158">CcWaitForCurrentLazyWriterActivity()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01062">CcWaitOnActiveCount()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02952">CcZeroData()</a>, <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00351">CmpFileRead()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00046">CmpOpenHiveFiles()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01706">DoResourceTest()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00413">ExAllocatePool()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00970">ExFreePool()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00190">ExLockPool()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02506">ExpWaitForResource()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00463">ExpWaitForResourceDdk()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00479">ExUnregisterCallback()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00703">FsRecGetDeviceSectors()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00800">FsRecGetDeviceSectorSize()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00579">FsRecLoadFileSystem()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00907">FsRecReadBlock()</a>, <a class="el" href="../../d8/d0/faulttol_8c-source.html#l00031">FsRtlBalanceReads()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00418">FsRtlDeregisterUncProvider()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02691">FsRtlGetFileSize()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00247">FsRtlRegisterUncProvider()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02864">FsRtlSetFileSize()</a>, <a class="el" href="../../d8/d0/faulttol_8c-source.html#l00096">FsRtlSyncVolumes()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03025">FsRtlWaitOnIrp()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00162">GetDeviceChangeInfo()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01022">HalpEnableAutomaticDriveLetterAssignment()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03735">HalpGetFullGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01171">HalpIsOldStyleFloppy()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00851">HalpNextMountLetter()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00792">HalpQueryDriveLayout()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00706">HalpQueryPartitionType()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01078">HalpSetMountLetter()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02146">InitiateWin32kCleanup()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12535">IoCancelFileOpen()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01300">IoFreeDumpStack()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11641">IoGetBootDiskInformation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l08307">IoGetDmaAdapter()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00181">IopAcquireFileObjectLock()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07141">IopAllocateBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l00720">IopAllocateResources()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00417">IopCancelAlertedRequest()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00036">IopCloseFile()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04061">IopCompleteDumpInitialization()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00657">IopCompleteUnloadOrDelete()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l01047">IopCreateArcNames()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00417">IopDeleteFile()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l03255">IopFilterResourceRequirementsCall()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02256">IopGetFileName()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02718">IopGetSetObjectId()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02851">IopGetVolumeId()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02977">IopHardErrorThread()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00103">IopHardwareProfileBeginTransition()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06180">IopLegacyResourceAllocation()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04077">IopLoadFileSystemDriver()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01080">IopLockMountedDeviceForRemove()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09221">IoPnPDeliverServicePowerNotification()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00821">IopProcessStartDevices()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00912">IopProcessStartDevicesWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07717">IopQueryConflictList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l04667">IopQueryRebalanceWorker()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05397">IopQueryXxxInformation()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05215">IopRebalance()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06672">IopRequestHwProfileChangeNotification()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06716">IopSetRemoteLink()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06926">IopSynchronousApiServiceTail()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00381">IopSynchronousCall()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l07030">IopSynchronousServiceTail()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01233">IopUnlockMountedDeviceForRemove()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04617">IopWaitForBootDevicesDeleted()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04508">IopWaitForBootDevicesStarted()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00422">IopWarmEjectDevice()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00394">IoReleaseRemoveLockAndWaitEx()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06017">IoReportTargetDeviceChange()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09835">IoSetInformation()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01291">IoSynchronousInvalidateDeviceRelations()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11389">IoVerifyVolume()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02499">IovpInternalCompleteAfterWait()</a>, <a class="el" href="../../d8/d3/flunkirp_8c-source.html#l01531">IovpThrowBogusSynchronousIrp()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00454">KeSetAutoAlignmentThread()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00322">KeSwapProcessOrStack()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l01126">KiSetServerWaitClientEvent()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00770">KiSuspendThread()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l00706">LfsCloseLogFile()</a>, <a class="el" href="../../d8/d0/lbcbsup_8c-source.html#l00037">LfsFlushLbcb()</a>, <a class="el" href="../../d8/d4/logrcsup_8c-source.html#l00055">LfsWriteLogRecordIntoLogPage()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l01407">LpcRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02149">MiCheckControlAreaStatus()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00166">MiCheckPageFilePath()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02809">MiCheckPurgeAndUpMapCount()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01075">MiCleanSection()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l01424">MiCreateImageFileMap()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01544">MiDereferenceSession()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02715">MiEmptyAllWorkingSets()</a>, <a class="el" href="../../d8/d4/pfnlist_8c-source.html#l00941">MiEnsureAvailablePageOrWait()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01014">MiFlushSectionInternal()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l03701">MiGatherPagefilePages()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04911">MiIssuePageExtendRequest()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05287">MiMakeOutswappedPageResident()</a>, <a class="el" href="../../d8/d1/alpha_2hypermap_8c-source.html#l00153">MiMapImageHeaderInHyperSpace()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l04239">MiMappedPageWriter()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02831">MiModifiedPageWriterWorker()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l02335">MiWaitForInPageComplete()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04046">MmGetVerifierInformation()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06284">MmLockPagableSectionByHandle()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l01548">MmPurgeSection()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04226">MmSetVerifierInformation()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00375">NtReplyWaitReplyPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l01235">NtSetLdtEntries()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00517">NtStartProfile()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00680">NtStopProfile()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01234">ObFindHandleForObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01022">ObKillProcess()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00837">ObWaitForSingleObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l01061">PspQueryDescriptorThread()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00108">PspQueryLdtInformation()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00503">PspSetLdtInformation()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00308">PspSetLdtSize()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00076">QueuePowerRequest()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01535">RequestDeviceChange()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00328">RtlReleaseRemoveLockAndWait()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00580">RtlVolumeDeviceToDosName()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d7/d5/vmcbsup_8c-source.html#l00637">UdfAddVmcbMapping()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l00573">UdfPerformDevIoCtrl()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00194">UdfPnpQueryRemove()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00350">UdfPnpRemove()</a>, <a class="el" href="../../d5/d8/udfs_2pnp_8c-source.html#l00500">UdfPnpSurpriseRemove()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l00685">UdfReadSectors()</a>, <a class="el" href="../../d7/d5/vmcbsup_8c-source.html#l00867">UdfRemoveVmcbMapping()</a>, <a class="el" href="../../d7/d5/vmcbsup_8c-source.html#l00553">UdfVmcbLbnToVbn()</a>, <a class="el" href="../../d7/d5/vmcbsup_8c-source.html#l00461">UdfVmcbVbnToLbn()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01740">UdfWaitSync()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00777">VdmDispatchStringIoToHandler()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00190">xHalExamineMBR()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00382">xHalGetPartialGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03486">xHalIoClearPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01739">xHalIoReadPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02879">xHalIoWritePartitionTable()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00114">xxxDesktopThread()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00140">xxxInitInput()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00026">xxxInitTerminal()</a>, <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00188">xxxRemoteDisconnect()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l04382">xxxSleepThread()</a>.
<p>
<pre class="fragment"><div>00170 {
00171     <span class="keywordflow">return</span>(STATUS_SUCCESS);
00172 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a353" doxytag="ke.h::KiSetPriorityThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FASTCALL KiSetPriorityThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Priority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">576</a> of file <a class="el" href="../../d1/d1/thredsup_8c-source.html">thredsup.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00058">ClearMember</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00036">KiDispatcherReadyListHead</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00095">KiFindReadyThread()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, <a class="el" href="../../d6/d8/kernldat_8c-source.html#l00052">KiReadySummary</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00270">KiReadyThread()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00782">KiRequestDispatchInterrupt</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a193">Running</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00065">SetMember</a>, <a class="el" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00569">_KTHREAD::State</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02453">ExpBoostOwnerThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00140">KeDelayExecutionThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01532">KeSetBasePriorityThread()</a>, <a class="el" href="../../d4/d4/procobj_8c-source.html#l00738">KeSetPriorityProcess()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01838">KeSetPriorityThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00079">KiAdjustQuantumThread()</a>, and <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00043">KiQuantumEnd()</a>.
<p>
<pre class="fragment"><div>00583                    :
00584 
00585     This function set <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> priority of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00586     value. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> standby or running state, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor
00587     may be redispatched. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ready state, then some other
00588     thread may be preempted.
00589 
00590 Arguments:
00591 
00592     Thread - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> thread.
00593 
00594     Priority - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> thread priority value.
00595 
00596 Return Value:
00597 
00598     None.
00599 
00600 --*/
00601 
00602 {
00603 
00604     PRKPRCB Prcb;
00605     ULONG Processor;
00606     KPRIORITY ThreadPriority;
00607     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> Thread1;
00608 
00609     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Priority &lt;= HIGH_PRIORITY);
00610 
00611     <span class="comment">//</span>
00612     <span class="comment">// Capture the current priority of the specified thread.</span>
00613     <span class="comment">//</span>
00614 
00615     ThreadPriority = Thread-&gt;Priority;
00616 
00617     <span class="comment">//</span>
00618     <span class="comment">// If the new priority is not equal to the old priority, then set the</span>
00619     <span class="comment">// new priority of the thread and redispatch a processor if necessary.</span>
00620     <span class="comment">//</span>
00621 
00622     <span class="keywordflow">if</span> (Priority != ThreadPriority) {
00623         Thread-&gt;Priority = (SCHAR)Priority;
00624 
00625         <span class="comment">//</span>
00626         <span class="comment">// Case on the thread state.</span>
00627         <span class="comment">//</span>
00628 
00629         <span class="keywordflow">switch</span> (Thread-&gt;State) {
00630 
00631             <span class="comment">//</span>
00632             <span class="comment">// Ready case - If the thread is not in the process ready queue,</span>
00633             <span class="comment">// then remove it from its current dispatcher ready queue. If the</span>
00634             <span class="comment">// new priority is less than the old priority, then insert the</span>
00635             <span class="comment">// thread at the tail of the dispatcher ready queue selected by</span>
00636             <span class="comment">// the new priority. Else reready the thread for execution.</span>
00637             <span class="comment">//</span>
00638 
00639         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a192">Ready</a>:
00640             <span class="keywordflow">if</span> (Thread-&gt;ProcessReadyQueue == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00641                 RemoveEntryList(&amp;Thread-&gt;WaitListEntry);
00642                 <span class="keywordflow">if</span> (IsListEmpty(&amp;KiDispatcherReadyListHead[ThreadPriority])) {
00643                     <a class="code" href="../../d0/d0/ki_8h.html#a6">ClearMember</a>(ThreadPriority, KiReadySummary);
00644                 }
00645 
00646                 <span class="keywordflow">if</span> (Priority &lt; ThreadPriority) {
00647                     InsertTailList(&amp;KiDispatcherReadyListHead[Priority],
00648                                    &amp;Thread-&gt;WaitListEntry);
00649                     <a class="code" href="../../d0/d0/ki_8h.html#a7">SetMember</a>(Priority, KiReadySummary);
00650 
00651                 } <span class="keywordflow">else</span> {
00652                     <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
00653                 }
00654             }
00655 
00656             <span class="keywordflow">break</span>;
00657 
00658             <span class="comment">//</span>
00659             <span class="comment">// Standby case - If the thread's priority is being lowered, then</span>
00660             <span class="comment">// attempt to find another thread to execute. If a new thread is</span>
00661             <span class="comment">// found, then put the new thread in the standby state, and reready</span>
00662             <span class="comment">// the old thread.</span>
00663             <span class="comment">//</span>
00664 
00665         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>:
00666 
00667 <span class="preprocessor">#if !defined(NT_UP)</span>
00668 <span class="preprocessor"></span>
00669             Processor = Thread-&gt;NextProcessor;
00670 
00671 <span class="preprocessor">#endif</span>
00672 <span class="preprocessor"></span>
00673             <span class="keywordflow">if</span> (Priority &lt; ThreadPriority) {
00674 
00675 <span class="preprocessor">#if !defined(NT_UP)</span>
00676 <span class="preprocessor"></span>
00677                 Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a2">KiFindReadyThread</a>(Processor, Priority);
00678 
00679 <span class="preprocessor">#else</span>
00680 <span class="preprocessor"></span>
00681                 Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a2">KiFindReadyThread</a>(0, Priority);
00682 
00683 <span class="preprocessor">#endif</span>
00684 <span class="preprocessor"></span>
00685                 <span class="keywordflow">if</span> (Thread1 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00686 
00687 <span class="preprocessor">#if !defined(NT_UP)</span>
00688 <span class="preprocessor"></span>
00689                     Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[Processor];
00690 
00691 <span class="preprocessor">#else</span>
00692 <span class="preprocessor"></span>
00693                     Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[0];
00694 
00695 <span class="preprocessor">#endif</span>
00696 <span class="preprocessor"></span>
00697                     Thread1-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
00698                     Prcb-&gt;NextThread = Thread1;
00699                     <a class="code" href="../../d0/d2/thredsup_8c.html#a3">KiReadyThread</a>(Thread);
00700                 }
00701             }
00702 
00703             <span class="keywordflow">break</span>;
00704 
00705             <span class="comment">//</span>
00706             <span class="comment">// Running case - If there is not a thread in the standby state</span>
00707             <span class="comment">// on the thread's processor and the thread's priority is being</span>
00708             <span class="comment">// lowered, then attempt to find another thread to execute. If</span>
00709             <span class="comment">// a new thread is found, then put the new thread in the standby</span>
00710             <span class="comment">// state, and request a redispatch on the thread's processor.</span>
00711             <span class="comment">//</span>
00712 
00713         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/ke_8h.html#a406a193">Running</a>:
00714 
00715 <span class="preprocessor">#if !defined(NT_UP)</span>
00716 <span class="preprocessor"></span>
00717             Processor = Thread-&gt;NextProcessor;
00718             Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[Processor];
00719 
00720 <span class="preprocessor">#else</span>
00721 <span class="preprocessor"></span>
00722             Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[0];
00723 
00724 <span class="preprocessor">#endif</span>
00725 <span class="preprocessor"></span>
00726             <span class="keywordflow">if</span> (Prcb-&gt;NextThread == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00727                 <span class="keywordflow">if</span> (Priority &lt; ThreadPriority) {
00728 
00729 <span class="preprocessor">#if !defined(NT_UP)</span>
00730 <span class="preprocessor"></span>
00731                     Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a2">KiFindReadyThread</a>(Processor, Priority);
00732 
00733 <span class="preprocessor">#else</span>
00734 <span class="preprocessor"></span>
00735                     Thread1 = <a class="code" href="../../d0/d2/thredsup_8c.html#a2">KiFindReadyThread</a>(0, Priority);
00736 
00737 <span class="preprocessor">#endif</span>
00738 <span class="preprocessor"></span>
00739                     <span class="keywordflow">if</span> (Thread1 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00740                         Thread1-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o8">State</a> = <a class="code" href="../../d4/d9/ke_8h.html#a406a194">Standby</a>;
00741                         Prcb-&gt;NextThread = Thread1;
00742 
00743 <span class="preprocessor">#if !defined(NT_UP)</span>
00744 <span class="preprocessor"></span>
00745                         <a class="code" href="../../d0/d0/ki_8h.html#a24">KiRequestDispatchInterrupt</a>(Processor);
00746 
00747 <span class="preprocessor">#endif</span>
00748 <span class="preprocessor"></span>
00749                     }
00750                 }
00751             }
00752 
00753             <span class="keywordflow">break</span>;
00754 
00755             <span class="comment">//</span>
00756             <span class="comment">// Initialized, Terminated, Waiting, Transition case - For</span>
00757             <span class="comment">// these states it is sufficient to just set the new thread</span>
00758             <span class="comment">// priority.</span>
00759             <span class="comment">//</span>
00760 
00761         <span class="keywordflow">default</span>:
00762             <span class="keywordflow">break</span>;
00763         }
00764     }
00765 
00766     <span class="keywordflow">return</span>;
00767 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a350" doxytag="ke.h::KiSetServerWaitClientEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KiSetServerWaitClientEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SeverEvent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ClientEvent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d6/wait_8c-source.html#l01126">1126</a> of file <a class="el" href="../../d2/d6/wait_8c-source.html">wait.c</a>.
<p>
References <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00034">EVENT_INCREMENT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00174">KPROCESSOR_MODE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d9/ke_8h.html#a407a212">WrEventPair</a>.
<p>
<pre class="fragment"><div>01134                    :
01135 
01136     This function sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified server event and waits on specified
01137     client event. The wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed such that an optimal <span class="keywordflow">switch</span> to
01138     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> waiting thread occurs <span class="keywordflow">if</span> possible. No timeout <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> associated with
01139     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait, and thus, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> issuing thread will wait until <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> client event
01140     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> signaled or an APC <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> delivered.
01141 
01142 Arguments:
01143 
01144     ServerEvent - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
01145 
01146     ClientEvent - Supplies a pointer to a dispatcher object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> event.
01147 
01148     WaitMode  - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> processor mode in which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to occur.
01149 
01150 Return Value:
01151 
01152     The wait completion status. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_SUCCESS <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span>
01153     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified object satisfied <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait. <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of STATUS_USER_APC <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01154     returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> wait was aborted to deliver a user APC to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current
01155     thread.
01156 
01157 --*/
01158 
01159 {
01160 
01161     <span class="comment">//</span>
01162     <span class="comment">// Set sever event and wait on client event atomically.</span>
01163     <span class="comment">//</span>
01164 
01165     <a class="code" href="../../d2/d8/eventobj_8c.html#a8">KeSetEvent</a>(ServerEvent, EVENT_INCREMENT, TRUE);
01166     <span class="keywordflow">return</span> <a class="code" href="../../d1/d7/wait_8c.html#a4">KeWaitForSingleObject</a>(ClientEvent,
01167                                  WrEventPair,
01168                                  (KPROCESSOR_MODE)WaitMode,
01169                                  FALSE,
01170                                  NULL);
01171 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a123" doxytag="ke.h::KeActiveProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KAFFINITY <a class="el" href="../../d5/d9/kernldat_8c.html#a7">KeActiveProcessors</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">2766</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03665">IoConnectInterrupt()</a>, <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00080">Ke386SetIoAccessMap()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d4/mips_2flush_8c-source.html#l00074">KeChangeColorPage()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00543">KeDetachSessionSpace()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00086">KeFlushEntireTb()</a>, <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00374">KeFlushIoBuffers()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00231">KeFlushMultipleTb()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00587">KeFlushMultipleTb64()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00420">KeFlushSingleTb()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00797">KeFlushSingleTb64()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00055">KeFreezeExecution()</a>, <a class="el" href="../../d0/d8/i386_2gdtsup_8c-source.html#l00117">KeI386SetGdtSelector()</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00069">KeInitializeProfile()</a>, <a class="el" href="../../d1/d4/i386_2flush_8c-source.html#l00187">KeInvalidateAllCaches()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l01004">KeQueryActiveProcessors()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d2/d4/ia64_2flush_8c-source.html#l00453">KeSweepCacheRange()</a>, <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00071">KeSweepDcache()</a>, <a class="el" href="../../d2/d4/ia64_2flush_8c-source.html#l00674">KeSweepDcacheRange()</a>, <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00202">KeSweepIcache()</a>, <a class="el" href="../../d2/d4/ia64_2flush_8c-source.html#l00559">KeSweepIcacheRange()</a>, <a class="el" href="../../d0/d4/alpha_2flush_8c-source.html#l00561">KeSynchronizeMemoryAccess()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00391">KeThawExecution()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01112">KiCompleteEffectiveRangeChange()</a>, <a class="el" href="../../d9/d4/i386_2flushtb_8c-source.html#l00589">KiFlushSingleTbSynchronous()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00733">KiGetNewRid()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d0/d3/pat_8c-source.html#l00119">KiInitializePAT()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00040">KiIpiGenericCall()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d8/d5/ke_2ia64_2region_8c-source.html#l00122">KiSyncNewRegionId()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, and <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a124" doxytag="ke.h::KeBootTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d5/d9/kernldat_8c.html#a8">KeBootTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02767">2767</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01168">ViInjectResourceFailure()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a125" doxytag="ke.h::KeBootTimeBias" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONGLONG <a class="el" href="../../d5/d9/kernldat_8c.html#a9">KeBootTimeBias</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02768">2768</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00335">KeSetSystemTime()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a127" doxytag="ke.h::KeBugCheckCallbackListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d5/d9/kernldat_8c.html#a11">KeBugCheckCallbackListHead</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02770">2770</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01123">KeRegisterBugCheckCallback()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01207">KiScanBugCheckCallbackList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a128" doxytag="ke.h::KeBugCheckCallbackLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d5/d9/kernldat_8c.html#a12">KeBugCheckCallbackLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02771">2771</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01064">KeDeregisterBugCheckCallback()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l01123">KeRegisterBugCheckCallback()</a>, and <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a137" doxytag="ke.h::KeFeatureBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d9/kernldat_8c.html#a24">KeFeatureBits</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02780">2780</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00526">KeRestoreMtrr()</a>, <a class="el" href="../../d0/d3/pat_8c-source.html#l00094">KeRestorePAT()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00576">KeSetPhysicalCacheTypeRange()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, <a class="el" href="../../d0/d3/pat_8c-source.html#l00119">KiInitializePAT()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01796">KiLoadMTRR()</a>, <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03415">MmMapIoSpace()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a129" doxytag="ke.h::KeGdiFlushUserBatch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/ke_8h.html#a117">PGDI_BATCHFLUSH_ROUTINE</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a15">KeGdiFlushUserBatch</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02772">2772</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00028">KeUserModeCallback()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03855">PsEstablishWin32Callouts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a126" doxytag="ke.h::KeInterruptTimeBias" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONGLONG <a class="el" href="../../d5/d9/kernldat_8c.html#a10">KeInterruptTimeBias</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02769">2769</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a143" doxytag="ke.h::KeLicensedProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d9/kernldat_8c.html#a20">KeLicensedProcessors</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02789">2789</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a130" doxytag="ke.h::KeLoaderBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d2/struct__LOADER__PARAMETER__BLOCK.html">PLOADER_PARAMETER_BLOCK</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a16">KeLoaderBlock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02773">2773</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l02529">CmpCreateHwProfileFriendlyName()</a>, <a class="el" href="../../d8/d9/mips_2dmpstate_8c-source.html#l00059">KeDumpMachineState()</a>, <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00078">KeStartAllProcessors()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00659">KiInitializeAbios()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d8/d2/i386init_8c-source.html#l00201">KiInitializeMachineType()</a>, and <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00220">KiPcToFileHeader()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a131" doxytag="ke.h::KeMaximumIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d9/ke_8h.html#a131">KeMaximumIncrement</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02774">2774</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03375">ExpCopyProcessInfo()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03427">ExpCopyThreadInfo()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00211">KeQueryTimeIncrement()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00779">KeSetTimeIncrement()</a>, <a class="el" href="../../d2/d8/clock_8c-source.html#l00122">KeUpdateSystemTime()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01232">PspExitProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02632">PspFoldProcessAccountingIntoJob()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a132" doxytag="ke.h::KeMinimumIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d9/kernldat_8c.html#a17">KeMinimumIncrement</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02775">2775</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00779">KeSetTimeIncrement()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a133" doxytag="ke.h::KeNumberProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CCHAR <a class="el" href="../../d5/d9/kernldat_8c.html#a18">KeNumberProcessors</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">2776</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01986">CmpConfigureProcessors()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02894">ExpCheckForResource()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04580">IopInitializeDCB()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01461">KdpGetContext()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00725">KdpGetStateChange()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00786">KdpReadControlSpace()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02434">KdpReportLoadSymbolsStateChange()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01521">KdpSetContext()</a>, <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00098">KdpSetStateChange()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00874">KdpWriteControlSpace()</a>, <a class="el" href="../../d0/d1/cyrix_8c-source.html#l00270">Ke386ConfigureCyrixProcessor()</a>, <a class="el" href="../../d4/d3/alpha_2intobj_8c-source.html#l00154">KeConnectInterrupt()</a>, <a class="el" href="../../d4/d4/ppc_2flush_8c-source.html#l00693">KeFlushIoBuffers()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">KeI386FlatToGdtSelector()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00036">KeInitializeQueue()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01735">KeSetIdealProcessorThread()</a>, <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00289">KeStartProfile()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00334">KeSwitchFrozenProcessor()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00544">KiAdjustInterruptTime()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01993">KiSynchronizeMTRRLoad()</a>, <a class="el" href="../../d0/d3/pat_8c-source.html#l00447">KiSynchronizePATLoad()</a>, <a class="el" href="../../d6/d0/dpcsup_8c-source.html#l00217">KiTimerExpiration()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l08083">MmSetKernelDumpRange()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04923">MmVerifyImageIsOkForMpUse()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a134" doxytag="ke.h::KeProcessorArchitecture" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a21">KeProcessorArchitecture</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02777">2777</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04580">IopInitializeDCB()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a135" doxytag="ke.h::KeProcessorLevel" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a22">KeProcessorLevel</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02778">2778</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00030">KdpPrintString()</a>, <a class="el" href="../../d1/d5/kddbgio_8c-source.html#l00110">KdpPromptString()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02434">KdpReportLoadSymbolsStateChange()</a>, <a class="el" href="../../d2/d4/alpha_2kdcpuapi_8c-source.html#l00098">KdpSetStateChange()</a>, <a class="el" href="../../d5/d4/alpha_2alignem_8c-source.html#l00125">KiDisableAlignmentExceptions()</a>, <a class="el" href="../../d5/d4/alpha_2alignem_8c-source.html#l00095">KiEnableAlignmentExceptions()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d0/d5/alpha_2debugsup_8c-source.html#l00342">MmDbgTranslatePhysicalAddress64()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a136" doxytag="ke.h::KeProcessorRevision" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a23">KeProcessorRevision</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02779">2779</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a151" doxytag="ke.h::KeRaiseUserExceptionDispatcher" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d5/d9/kernldat_8c.html#a33">KeRaiseUserExceptionDispatcher</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02811">2811</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l01024">KeRaiseUserException()</a>, and <a class="el" href="../../d0/d0/kulookup_8c-source.html#l00026">PspLookupKernelUserEntryPoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a142" doxytag="ke.h::KeRegisteredProcessors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d9/kernldat_8c.html#a19">KeRegisteredProcessors</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02788">2788</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00078">KeStartAllProcessors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a144" doxytag="ke.h::KeServiceCountTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PULONG <a class="el" href="../../d4/d9/ke_8h.html#a144">KeServiceCountTable</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02793">2793</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a145" doxytag="ke.h::KeServiceDescriptorTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">KSERVICE_TABLE_DESCRIPTOR</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a25">KeServiceDescriptorTable</a>[NUMBER_SERVICE_TABLES]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02794">2794</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00815">KeAddSystemServiceTable()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l00043">KeInitializeThread()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00143">NtW32Call()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03964">PsConvertToGuiThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a146" doxytag="ke.h::KeServiceDescriptorTableShadow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__KSERVICE__TABLE__DESCRIPTOR.html">KSERVICE_TABLE_DESCRIPTOR</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a26">KeServiceDescriptorTableShadow</a>[NUMBER_SERVICE_TABLES]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02795">2795</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00815">KeAddSystemServiceTable()</a>, <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03964">PsConvertToGuiThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a141" doxytag="ke.h::KeThreadSwitchCounters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d2/d8/struct__KTHREAD__SWITCH__COUNTERS.html">KTHREAD_SWITCH_COUNTERS</a> <a class="el" href="../../d5/d9/kernldat_8c.html#a27">KeThreadSwitchCounters</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02784">2784</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a147" doxytag="ke.h::KeTickCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> volatile KSYSTEM_TIME <a class="el" href="../../d4/d9/ke_8h.html#a147">KeTickCount</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02797">2797</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01071">IoCreateDriver()</a>, <a class="el" href="../../d2/d8/clock_8c-source.html#l00122">KeUpdateSystemTime()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, and <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a152" doxytag="ke.h::KeTimeAdjustment" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d9/ke_8h.html#a152">KeTimeAdjustment</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02812">2812</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00779">KeSetTimeIncrement()</a>, <a class="el" href="../../d2/d8/clock_8c-source.html#l00122">KeUpdateSystemTime()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a153" doxytag="ke.h::KeTimeIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d9/kernldat_8c.html#a28">KeTimeIncrement</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02813">2813</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00779">KeSetTimeIncrement()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00592">KiCalibrateTimeAdjustment()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a154" doxytag="ke.h::KeTimeSynchronization" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d9/kernldat_8c.html#a29">KeTimeSynchronization</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02814">2814</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a148" doxytag="ke.h::KeUserApcDispatcher" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d5/d9/kernldat_8c.html#a30">KeUserApcDispatcher</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02808">2808</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d6/alpha_2apcuser_8c-source.html#l00033">KiInitializeUserApc()</a>, and <a class="el" href="../../d0/d0/kulookup_8c-source.html#l00026">PspLookupKernelUserEntryPoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a149" doxytag="ke.h::KeUserCallbackDispatcher" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d5/d9/kernldat_8c.html#a31">KeUserCallbackDispatcher</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02809">2809</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l02838">KdpGetVersion()</a>, <a class="el" href="../../d6/d5/4_2kdinit_8c-source.html#l00038">KdUpdateDataBlock()</a>, and <a class="el" href="../../d0/d0/kulookup_8c-source.html#l00026">PspLookupKernelUserEntryPoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a150" doxytag="ke.h::KeUserExceptionDispatcher" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d5/d9/kernldat_8c.html#a32">KeUserExceptionDispatcher</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02810">2810</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>, and <a class="el" href="../../d0/d0/kulookup_8c-source.html#l00026">PspLookupKernelUserEntryPoints()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a138" doxytag="ke.h::KiFindFirstSetRight" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CCHAR <a class="el" href="../../d5/d9/kernldat_8c.html#a39">KiFindFirstSetRight</a>[256]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02781">2781</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a139" doxytag="ke.h::KiProcessorBlock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PKPRCB <a class="el" href="../../d5/d9/kernldat_8c.html#a46">KiProcessorBlock</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">2782</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01461">KdpGetContext()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00725">KdpGetStateChange()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00786">KdpReadControlSpace()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l01521">KdpSetContext()</a>, <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l00874">KdpWriteControlSpace()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00055">KeFreezeExecution()</a>, <a class="el" href="../../d0/d8/i386_2gdtsup_8c-source.html#l00117">KeI386SetGdtSelector()</a>, <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00089">KeInsertQueueDpc()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01302">KeSetAffinityThread()</a>, <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00334">KeSwitchFrozenProcessor()</a>, <a class="el" href="../../d0/d4/ke_2debug_8c-source.html#l00391">KeThawExecution()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00644">KiFlushForwardProgressTbBuffer()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00065">KiInitializeKernel()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00749">KiInitializePcr()</a>, <a class="el" href="../../d0/d5/ia64_2flushtb_8c-source.html#l00595">KiInvalidateForwardProgressTbBuffer()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00253">KiIpiSend()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00270">KiReadyThread()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00479">KiSelectNextThread()</a>, <a class="el" href="../../d1/d1/thredsup_8c-source.html#l00576">KiSetPriorityThread()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l08083">MmSetKernelDumpRange()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a140" doxytag="ke.h::KiStackProtectTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d0/balmgr_8c.html#a13">KiStackProtectTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/ke_8h-source.html#l02783">2783</a> of file <a class="el" href="../../d5/d8/ke_8h-source.html">ke.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>, <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00544">KiOutSwapKernelStacks()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03448">MiApplyDriverVerifier()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03625">MiVerifyingDriverUnloading()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:28 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
