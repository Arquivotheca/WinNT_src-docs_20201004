<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: resrcsup.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>resrcsup.c File Reference</h1><code>#include "UdfProcs.h"</code><br>

<p>
<a href="../../d5/d8/resrcsup_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a0">BugCheckFileId</a>&nbsp;&nbsp;&nbsp;(UDFS_BUG_CHECK_RESRCSUP)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a1">Dbg</a>&nbsp;&nbsp;&nbsp;(UDFS_DEBUG_LEVEL_RESRCSUP)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a2">UdfAcquireResource</a> (IN <a class="el" href="../../d0/d3/struct__IRP__CONTEXT.html">PIRP_CONTEXT</a> IrpContext, IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN BOOLEAN IgnoreWait, IN <a class="el" href="../../d3/d8/udfprocs_8h.html#a111">TYPE_OF_ACQUIRE</a> Type)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a3">UdfAcquireForCache</a> (IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> Fcb, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a4">UdfReleaseFromCache</a> (IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> Fcb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a5">UdfNoopAcquire</a> (IN PVOID Fcb, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a6">UdfNoopRelease</a> (IN PVOID Fcb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a7">UdfAcquireForCreateSection</a> (IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/resrcsup_8c.html#a8">UdfReleaseForCreateSection</a> (IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="resrcsup.c::BugCheckFileId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BugCheckFileId&nbsp;&nbsp;&nbsp;(UDFS_BUG_CHECK_RESRCSUP)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00027">27</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="resrcsup.c::Dbg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Dbg&nbsp;&nbsp;&nbsp;(UDFS_DEBUG_LEVEL_RESRCSUP)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00033">33</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a3" doxytag="resrcsup.c::UdfAcquireForCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN UdfAcquireForCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Fcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00136">136</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02474">ExAcquireResourceShared</a>, <a class="el" href="../../d2/d7/fsrtl_8h-source.html#l00283">FSRTL_CACHE_TOP_LEVEL_IRP</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07409">IoGetTopLevelIrp()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10321">IoSetTopLevelIrp()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00143                    :
00144 
00145     The address of <span class="keyword">this</span> routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified when creating a CacheMap <span class="keywordflow">for</span>
00146     a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> subsequently called by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Lazy <a class="code" href="../../d4/d0/tex_8c.html#a44">Writer</a> <span class="keywordflow">for</span> synchronization.
00147 
00148 Arguments:
00149 
00150     Fcb -  The pointer supplied as context to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cache initialization
00151            routine.
00152 
00153     Wait - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> willing to block.
00154 
00155 Return Value:
00156 
00157     None
00158 
00159 --*/
00160 
00161 {
00162     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00163 
00164     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d6/iosubs_8c.html#a79">IoGetTopLevelIrp</a>() == NULL);
00165     <a class="code" href="../../d4/d6/iosubs_8c.html#a109">IoSetTopLevelIrp</a>((<a class="code" href="../../d0/d2/struct__IRP.html">PIRP</a>)FSRTL_CACHE_TOP_LEVEL_IRP);
00166 
00167     <span class="keywordflow">return</span> <a class="code" href="../../d5/d8/ex_8h.html#a69">ExAcquireResourceShared</a>( Fcb-&gt;Resource, Wait );
00168 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="resrcsup.c::UdfAcquireForCreateSection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UdfAcquireForCreateSection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>FileObject</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00267">267</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00273                    :
00274 
00275     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback routine <span class="keywordflow">for</span> MM to use to acquire <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> exclusively.
00276 
00277 Arguments:
00278 
00279     FileObject - <a class="code" href="../../d1/d9/icmui_8def.html#a0">File</a> object <span class="keywordflow">for</span> a Udffs stream.
00280 
00281 Return Value:
00282 
00283     None
00284 
00285 --*/
00286 
00287 {
00288     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00289 
00290     <span class="comment">//</span>
00291     <span class="comment">//  Get the file resource exclusively.</span>
00292     <span class="comment">//</span>
00293 
00294     <a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>( &amp;((<a class="code" href="../../d7/d9/struct__FCB.html">PFCB</a>) FileObject-&gt;FsContext)-&gt;FcbNonpaged-&gt;FcbResource,
00295                                 TRUE );
00296 
00297     <span class="keywordflow">return</span>;
00298 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="resrcsup.c::UdfAcquireResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN UdfAcquireResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d3/struct__IRP__CONTEXT.html">PIRP_CONTEXT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>IrpContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>IgnoreWait</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d3/d8/udfprocs_8h.html#a111">TYPE_OF_ACQUIRE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00047">47</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d3/d8/udfprocs_8h.html#a264a119">AcquireExclusive</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a264a120">AcquireShared</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a264a121">AcquireSharedStarveExclusive</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02474">ExAcquireResourceShared</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01014">ExAcquireSharedStarveExclusive()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00497">FlagOn</a>, <a class="el" href="../../d7/d7/udfstruc_8h-source.html#l01235">IRP_CONTEXT_FLAG_WAIT</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a111">TYPE_OF_ACQUIRE</a>, and <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00406">UdfRaiseStatus()</a>.
<p>
<pre class="fragment"><div>00056                    :
00057 
00058     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> single routine used to acquire <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> system resources.  It
00059     looks at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> IgnoreWait flag to determine whether to <span class="keywordflow">try</span> to acquire <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00060     resource without waiting.  Returning <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>/<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> to indicate success or
00061     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>.  Otherwise <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> driven by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> WAIT flag in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> IrpContext and
00062     will raise CANT_WAIT on a <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>.
00063 
00064 Arguments:
00065 
00066     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to <span class="keywordflow">try</span> and acquire.
00067 
00068     IgnoreWait - If <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> then <span class="keyword">this</span> routine will not wait to acquire <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00069         resource and will <span class="keywordflow">return</span> a <span class="keywordtype">boolean</span> indicating whether <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource was
00070         acquired.  Otherwise we use <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> flag in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> IrpContext and raise
00071         <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not acquired.
00072 
00073     Type - Indicates how we should <span class="keywordflow">try</span> to get <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource.
00074 
00075 Return Value:
00076 
00077     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired.  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> not acquired and
00078         IgnoreWait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified.  Otherwise we raise CANT_WAIT.
00079 
00080 --*/
00081 
00082 {
00083     BOOLEAN Wait = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00084     BOOLEAN Acquired;
00085     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00086 
00087     <span class="comment">//</span>
00088     <span class="comment">//  We look first at the IgnoreWait flag, next at the flag in the Irp</span>
00089     <span class="comment">//  Context to decide how to acquire this resource.</span>
00090     <span class="comment">//</span>
00091 
00092     <span class="keywordflow">if</span> (!IgnoreWait &amp;&amp; <a class="code" href="../../d5/d5/cc_8h.html#a58">FlagOn</a>( IrpContext-&gt;Flags, IRP_CONTEXT_FLAG_WAIT )) {
00093 
00094         Wait = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00095     }
00096 
00097     <span class="comment">//</span>
00098     <span class="comment">//  Attempt to acquire the resource either shared or exclusively.</span>
00099     <span class="comment">//</span>
00100 
00101     <span class="keywordflow">switch</span> (Type) {
00102         <span class="keywordflow">case</span> <a class="code" href="../../d3/d8/udfprocs_8h.html#a264a119">AcquireExclusive</a>:
00103         
00104             Acquired = <a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>( Resource, Wait );
00105             <span class="keywordflow">break</span>;
00106 
00107         <span class="keywordflow">case</span> <a class="code" href="../../d3/d8/udfprocs_8h.html#a264a120">AcquireShared</a>:
00108             
00109             Acquired = <a class="code" href="../../d5/d8/ex_8h.html#a69">ExAcquireResourceShared</a>( Resource, Wait );
00110             <span class="keywordflow">break</span>;
00111 
00112         <span class="keywordflow">case</span> <a class="code" href="../../d3/d8/udfprocs_8h.html#a264a121">AcquireSharedStarveExclusive</a>:
00113             
00114             Acquired = <a class="code" href="../../d5/d8/ex_8h.html#a270">ExAcquireSharedStarveExclusive</a>( Resource, Wait );
00115             <span class="keywordflow">break</span>;
00116 
00117         <span class="keywordflow">default</span>:
00118             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( FALSE );
00119     }
00120 
00121     <span class="comment">//</span>
00122     <span class="comment">//  If not acquired and the user didn't specifiy IgnoreWait then</span>
00123     <span class="comment">//  raise CANT_WAIT.</span>
00124     <span class="comment">//</span>
00125 
00126     <span class="keywordflow">if</span> (!Acquired &amp;&amp; !IgnoreWait) {
00127 
00128         <a class="code" href="../../d3/d8/udfprocs_8h.html#a122">UdfRaiseStatus</a>( IrpContext, STATUS_CANT_WAIT );
00129     }
00130 
00131     <span class="keywordflow">return</span> Acquired;
00132 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="resrcsup.c::UdfNoopAcquire" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN UdfNoopAcquire           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Fcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00208">208</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00215                    :
00216 
00217     This routine does nothing.
00218 
00219 Arguments:
00220 
00221     Fcb - The Fcb/Vcb which was specified as a context parameter <span class="keywordflow">for</span> <span class="keyword">this</span>
00222           routine.
00223 
00224     Wait - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> willing to block.
00225 
00226 Return Value:
00227 
00228     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>
00229 
00230 --*/
00231 
00232 {
00233     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00234     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00235 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="resrcsup.c::UdfNoopRelease" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UdfNoopRelease           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Fcb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00239">239</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00245                    :
00246 
00247     This routine does nothing.
00248 
00249 Arguments:
00250 
00251     Fcb - The Fcb/Vcb which was specified as a context parameter <span class="keywordflow">for</span> <span class="keyword">this</span>
00252           routine.
00253 
00254 Return Value:
00255 
00256     None
00257 
00258 --*/
00259 
00260 {
00261     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00262     <span class="keywordflow">return</span>;
00263 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="resrcsup.c::UdfReleaseForCreateSection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UdfReleaseForCreateSection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>FileObject</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00302">302</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00308                    :
00309 
00310     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback routine <span class="keywordflow">for</span> MM to use to release a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> acquired with
00311     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> AcquireForCreateSection call above.
00312 
00313 Arguments:
00314 
00315     FileObject - <a class="code" href="../../d1/d9/icmui_8def.html#a0">File</a> object <span class="keywordflow">for</span> a Udffs stream.
00316 
00317 Return Value:
00318 
00319     None
00320 
00321 --*/
00322 
00323 {
00324     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00325 
00326     <span class="comment">//</span>
00327     <span class="comment">//  Release the resource in the Fcb.</span>
00328     <span class="comment">//</span>
00329 
00330     <a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( &amp;((<a class="code" href="../../d7/d9/struct__FCB.html">PFCB</a>) FileObject-&gt;FsContext)-&gt;FcbNonpaged-&gt;FcbResource );
00331 
00332     <span class="keywordflow">return</span>;
00333 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="resrcsup.c::UdfReleaseFromCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UdfReleaseFromCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Fcb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00172">172</a> of file <a class="el" href="../../d5/d8/resrcsup_8c-source.html">resrcsup.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d2/d7/fsrtl_8h-source.html#l00283">FSRTL_CACHE_TOP_LEVEL_IRP</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07409">IoGetTopLevelIrp()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10321">IoSetTopLevelIrp()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.
<p>
<pre class="fragment"><div>00178                    :
00179 
00180     The address of <span class="keyword">this</span> routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> specified when creating a CacheMap <span class="keywordflow">for</span>
00181     a <span class="keyword">virtual</span> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> subsequently called by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Lazy <a class="code" href="../../d4/d0/tex_8c.html#a44">Writer</a> to release
00182     a resource acquired above.
00183 
00184 Arguments:
00185 
00186     Fcb -  The pointer supplied as context to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cache initialization
00187            routine.
00188 
00189 Return Value:
00190 
00191     None
00192 
00193 --*/
00194 
00195 {
00196     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00197 
00198     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d6/iosubs_8c.html#a79">IoGetTopLevelIrp</a>() == (<a class="code" href="../../d0/d2/struct__IRP.html">PIRP</a>)FSRTL_CACHE_TOP_LEVEL_IRP);
00199     <a class="code" href="../../d4/d6/iosubs_8c.html#a109">IoSetTopLevelIrp</a>( NULL );
00200 
00201     <a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( Fcb-&gt;Resource );
00202 
00203     <span class="keywordflow">return</span>;
00204 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:29 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
